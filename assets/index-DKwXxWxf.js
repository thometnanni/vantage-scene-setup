var Mf=Object.defineProperty;var Ef=(h,t,e)=>t in h?Mf(h,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):h[t]=e;var zt=(h,t,e)=>Ef(h,typeof t!="symbol"?t+"":t,e);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function e(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=e(i);fetch(i.href,s)}})();const Gl=!1;var Ca=Array.isArray,Tf=Array.prototype.indexOf,rl=Array.from,Sf=Object.defineProperty,Yr=Object.getOwnPropertyDescriptor,kf=Object.getOwnPropertyDescriptors,Af=Object.prototype,Pf=Array.prototype,nc=Object.getPrototypeOf;const jr=()=>{};function Cf(h){return h()}function Nh(h){for(var t=0;t<h.length;t++)h[t]()}const Pi=2,rc=4,Ks=8,sl=16,Ci=32,Qs=64,Fh=128,ar=256,ga=512,Ye=1024,In=2048,to=4096,Ui=8192,Qr=16384,zf=32768,ol=65536,If=1<<17,Of=1<<19,sc=1<<20,ir=Symbol("$state"),Rf=Symbol("legacy props");function oc(h){return h===this.v}function ac(h,t){return h!=h?t==t:h!==t||h!==null&&typeof h=="object"||typeof h=="function"}function al(h){return!ac(h,this.v)}function Df(h){throw new Error("https://svelte.dev/e/effect_in_teardown")}function Bf(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function Nf(h){throw new Error("https://svelte.dev/e/effect_orphan")}function Ff(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function Uf(h){throw new Error("https://svelte.dev/e/props_invalid_value")}function Zf(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function Gf(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function Hf(){throw new Error("https://svelte.dev/e/state_unsafe_local_read")}function Wf(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}let ts=!1,Vf=!1;function qf(){ts=!0}const Yf=1,jf=2,Xf=16,Jf=1,$f=2,Kf=4,Qf=8,td=16,ed=2,He=Symbol();function ti(h,t){var e={f:0,v:h,reactions:null,equals:oc,rv:0,wv:0};return e}function za(h,t=!1){var r;const e=ti(h);return t||(e.equals=al),ts&&ne!==null&&ne.l!==null&&((r=ne.l).s??(r.s=[])).push(e),e}function Xr(h,t=!1){return id(za(h,t))}function id(h){return ee!==null&&ee.f&Pi&&(Zi===null?dd([h]):Zi.push(h)),h}function de(h,t){return ee!==null&&pl()&&ee.f&(Pi|sl)&&(Zi===null||!Zi.includes(h))&&Wf(),hc(h,t)}function hc(h,t){return h.equals(t)||(h.v,h.v=t,h.wv=Pc(),lc(h,In),pl()&&Yt!==null&&Yt.f&Ye&&!(Yt.f&Ci)&&(Oe!==null&&Oe.includes(h)?(zi(Yt,In),Ra(Yt)):Pn===null?pd([h]):Pn.push(h))),t}function lc(h,t){var e=h.reactions;if(e!==null)for(var r=pl(),i=e.length,s=0;s<i;s++){var o=e[s],l=o.f;l&In||!r&&o===Yt||(zi(o,t),l&(Ye|ar)&&(l&Pi?lc(o,to):Ra(o)))}}let nd=!1;function Hr(h,t=null,e){if(typeof h!="object"||h===null||ir in h)return h;const r=nc(h);if(r!==Af&&r!==Pf)return h;var i=new Map,s=Ca(h),o=ti(0);s&&i.set("length",ti(h.length));var l;return new Proxy(h,{defineProperty(u,f,d){(!("value"in d)||d.configurable===!1||d.enumerable===!1||d.writable===!1)&&Zf();var p=i.get(f);return p===void 0?(p=ti(d.value),i.set(f,p)):de(p,Hr(d.value,l)),!0},deleteProperty(u,f){var d=i.get(f);if(d===void 0)f in u&&i.set(f,ti(He));else{if(s&&typeof f=="string"){var p=i.get("length"),g=Number(f);Number.isInteger(g)&&g<p.v&&de(p,g)}de(d,He),Hl(o)}return!0},get(u,f,d){var x;if(f===ir)return h;var p=i.get(f),g=f in u;if(p===void 0&&(!g||(x=Yr(u,f))!=null&&x.writable)&&(p=ti(Hr(g?u[f]:He,l)),i.set(f,p)),p!==void 0){var m=Bt(p);return m===He?void 0:m}return Reflect.get(u,f,d)},getOwnPropertyDescriptor(u,f){var d=Reflect.getOwnPropertyDescriptor(u,f);if(d&&"value"in d){var p=i.get(f);p&&(d.value=Bt(p))}else if(d===void 0){var g=i.get(f),m=g==null?void 0:g.v;if(g!==void 0&&m!==He)return{enumerable:!0,configurable:!0,value:m,writable:!0}}return d},has(u,f){var m;if(f===ir)return!0;var d=i.get(f),p=d!==void 0&&d.v!==He||Reflect.has(u,f);if(d!==void 0||Yt!==null&&(!p||(m=Yr(u,f))!=null&&m.writable)){d===void 0&&(d=ti(p?Hr(u[f],l):He),i.set(f,d));var g=Bt(d);if(g===He)return!1}return p},set(u,f,d,p){var B;var g=i.get(f),m=f in u;if(s&&f==="length")for(var x=d;x<g.v;x+=1){var v=i.get(x+"");v!==void 0?de(v,He):x in u&&(v=ti(He),i.set(x+"",v))}g===void 0?(!m||(B=Yr(u,f))!=null&&B.writable)&&(g=ti(void 0),de(g,Hr(d,l)),i.set(f,g)):(m=g.v!==He,de(g,Hr(d,l)));var b=Reflect.getOwnPropertyDescriptor(u,f);if(b!=null&&b.set&&b.set.call(p,d),!m){if(s&&typeof f=="string"){var P=i.get("length"),A=Number(f);Number.isInteger(A)&&A>=P.v&&de(P,A+1)}Hl(o)}return!0},ownKeys(u){Bt(o);var f=Reflect.ownKeys(u).filter(g=>{var m=i.get(g);return m===void 0||m.v!==He});for(var[d,p]of i)p.v!==He&&!(d in u)&&f.push(d);return f},setPrototypeOf(){Gf()}})}function Hl(h,t=1){de(h,h.v+t)}var Wl,uc,cc;function rd(){if(Wl===void 0){Wl=window;var h=Element.prototype,t=Node.prototype;uc=Yr(t,"firstChild").get,cc=Yr(t,"nextSibling").get,h.__click=void 0,h.__className="",h.__attributes=null,h.__styles=null,h.__e=void 0,Text.prototype.__t=void 0}}function fc(h=""){return document.createTextNode(h)}function dc(h){return uc.call(h)}function hl(h){return cc.call(h)}function ya(h,t){return dc(h)}function kn(h,t=1,e=!1){let r=h;for(;t--;)r=hl(r);return r}function sd(h){h.textContent=""}function va(h){var t=Pi|In;Yt===null?t|=ar:Yt.f|=sc;var e=ee!==null&&ee.f&Pi?ee:null;const r={children:null,ctx:ne,deps:null,equals:oc,f:t,fn:h,reactions:null,rv:0,v:null,wv:0,parent:e??Yt};return e!==null&&(e.children??(e.children=[])).push(r),r}function od(h){const t=va(h);return t.equals=al,t}function pc(h){var t=h.children;if(t!==null){h.children=null;for(var e=0;e<t.length;e+=1){var r=t[e];r.f&Pi?ll(r):On(r)}}}function ad(h){for(var t=h.parent;t!==null;){if(!(t.f&Pi))return t;t=t.parent}return null}function mc(h){var t,e=Yt;Hi(ad(h));try{pc(h),t=Cc(h)}finally{Hi(e)}return t}function _c(h){var t=mc(h),e=(er||h.f&ar)&&h.deps!==null?to:Ye;zi(h,e),h.equals(t)||(h.v=t,h.wv=Pc())}function ll(h){pc(h),js(h,0),zi(h,Qr),h.v=h.children=h.deps=h.ctx=h.reactions=null}function gc(h){Yt===null&&ee===null&&Nf(),ee!==null&&ee.f&ar&&Bf(),dl&&Df()}function hd(h,t){var e=t.last;e===null?t.last=t.first=h:(e.next=h,h.prev=e,t.last=h)}function es(h,t,e,r=!0){var i=(h&Qs)!==0,s=Yt,o={ctx:ne,deps:null,deriveds:null,nodes_start:null,nodes_end:null,f:h|In,first:null,fn:t,last:null,next:null,parent:i?null:s,prev:null,teardown:null,transitions:null,wv:0};if(e){var l=Jr;try{Vl(!0),eo(o),o.f|=zf}catch(d){throw On(o),d}finally{Vl(l)}}else t!==null&&Ra(o);var u=e&&o.deps===null&&o.first===null&&o.nodes_start===null&&o.teardown===null&&(o.f&sc)===0;if(!u&&!i&&r&&(s!==null&&hd(o,s),ee!==null&&ee.f&Pi)){var f=ee;(f.children??(f.children=[])).push(o)}return o}function yc(h){const t=es(Ks,null,!1);return zi(t,Ye),t.teardown=h,t}function Uh(h){gc();var t=Yt!==null&&(Yt.f&Ci)!==0&&ne!==null&&!ne.m;if(t){var e=ne;(e.e??(e.e=[])).push({fn:h,effect:Yt,reaction:ee})}else{var r=ul(h);return r}}function ld(h){return gc(),Ia(h)}function ud(h){const t=es(Qs,h,!0);return(e={})=>new Promise(r=>{e.outro?xa(t,()=>{On(t),r(void 0)}):(On(t),r(void 0))})}function ul(h){return es(rc,h,!1)}function ca(h,t){var e=ne,r={effect:null,ran:!1};e.l.r1.push(r),r.effect=Ia(()=>{h(),!r.ran&&(r.ran=!0,de(e.l.r2,!0),rr(t))})}function vc(){var h=ne;Ia(()=>{if(Bt(h.l.r2)){for(var t of h.l.r1){var e=t.effect;e.f&Ye&&zi(e,to),is(e)&&eo(e),t.ran=!1}h.l.r2.v=!1}})}function Ia(h){return es(Ks,h,!0)}function xc(h){return cl(h)}function cl(h,t=0){return es(Ks|sl|t,h,!0)}function Ys(h,t=!0){return es(Ks|Ci,h,!0,t)}function wc(h){var t=h.teardown;if(t!==null){const e=dl,r=ee;ql(!0),Rn(null);try{t.call(null)}finally{ql(e),Rn(r)}}}function bc(h){var t=h.deriveds;if(t!==null){h.deriveds=null;for(var e=0;e<t.length;e+=1)ll(t[e])}}function Lc(h,t=!1){var e=h.first;for(h.first=h.last=null;e!==null;){var r=e.next;On(e,t),e=r}}function cd(h){for(var t=h.first;t!==null;){var e=t.next;t.f&Ci||On(t),t=e}}function On(h,t=!0){var e=!1;if((t||h.f&Of)&&h.nodes_start!==null){for(var r=h.nodes_start,i=h.nodes_end;r!==null;){var s=r===i?null:hl(r);r.remove(),r=s}e=!0}Lc(h,t&&!e),bc(h),js(h,0),zi(h,Qr);var o=h.transitions;if(o!==null)for(const u of o)u.stop();wc(h);var l=h.parent;l!==null&&l.first!==null&&Mc(h),h.next=h.prev=h.teardown=h.ctx=h.deps=h.fn=h.nodes_start=h.nodes_end=null}function Mc(h){var t=h.parent,e=h.prev,r=h.next;e!==null&&(e.next=r),r!==null&&(r.prev=e),t!==null&&(t.first===h&&(t.first=r),t.last===h&&(t.last=e))}function xa(h,t){var e=[];fl(h,e,!0),Ec(e,()=>{On(h),t&&t()})}function Ec(h,t){var e=h.length;if(e>0){var r=()=>--e||t();for(var i of h)i.out(r)}else t()}function fl(h,t,e){if(!(h.f&Ui)){if(h.f^=Ui,h.transitions!==null)for(const o of h.transitions)(o.is_global||e)&&t.push(o);for(var r=h.first;r!==null;){var i=r.next,s=(r.f&ol)!==0||(r.f&Ci)!==0;fl(r,t,s?e:!1),r=i}}}function wa(h){Tc(h,!0)}function Tc(h,t){if(h.f&Ui){is(h)&&eo(h),h.f^=Ui;for(var e=h.first;e!==null;){var r=e.next,i=(e.f&ol)!==0||(e.f&Ci)!==0;Tc(e,i?t:!1),e=r}if(h.transitions!==null)for(const s of h.transitions)(s.is_global||t)&&s.in()}}let Zh=!1,Gh=[];function fd(){Zh=!1;const h=Gh.slice();Gh=[],Nh(h)}function Sc(h){Zh||(Zh=!0,queueMicrotask(fd)),Gh.push(h)}function kc(h){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}let fa=!1,ba=!1,La=null,Jr=!1,dl=!1;function Vl(h){Jr=h}function ql(h){dl=h}let Hh=[],Gs=0;let ee=null;function Rn(h){ee=h}let Yt=null;function Hi(h){Yt=h}let Zi=null;function dd(h){Zi=h}let Oe=null,Qe=0,Pn=null;function pd(h){Pn=h}let Ac=1,Ma=0,er=!1,ne=null;function Pc(){return++Ac}function pl(){return!ts||ne!==null&&ne.l===null}function is(h){var f;var t=h.f;if(t&In)return!0;if(t&to){var e=h.deps,r=(t&ar)!==0;if(e!==null){var i,s,o=(t&ga)!==0,l=r&&Yt!==null&&!er,u=e.length;if(o||l){for(i=0;i<u;i++)s=e[i],(o||!((f=s==null?void 0:s.reactions)!=null&&f.includes(h)))&&(s.reactions??(s.reactions=[])).push(h);o&&(h.f^=ga)}for(i=0;i<u;i++)if(s=e[i],is(s)&&_c(s),s.wv>h.wv)return!0}(!r||Yt!==null&&!er)&&zi(h,Ye)}return!1}function md(h,t){for(var e=t;e!==null;){if(e.f&Fh)try{e.fn(h);return}catch{e.f^=Fh}e=e.parent}throw fa=!1,h}function _d(h){return(h.f&Qr)===0&&(h.parent===null||(h.parent.f&Fh)===0)}function Oa(h,t,e,r){if(fa){if(e===null&&(fa=!1),_d(t))throw h;return}e!==null&&(fa=!0);{md(h,t);return}}function Cc(h){var g;var t=Oe,e=Qe,r=Pn,i=ee,s=er,o=Zi,l=ne,u=h.f;Oe=null,Qe=0,Pn=null,ee=u&(Ci|Qs)?null:h,er=!Jr&&(u&ar)!==0,Zi=null,ne=h.ctx,Ma++;try{var f=(0,h.fn)(),d=h.deps;if(Oe!==null){var p;if(js(h,Qe),d!==null&&Qe>0)for(d.length=Qe+Oe.length,p=0;p<Oe.length;p++)d[Qe+p]=Oe[p];else h.deps=d=Oe;if(!er)for(p=Qe;p<d.length;p++)((g=d[p]).reactions??(g.reactions=[])).push(h)}else d!==null&&Qe<d.length&&(js(h,Qe),d.length=Qe);return i!==null&&Ma++,f}finally{Oe=t,Qe=e,Pn=r,ee=i,er=s,Zi=o,ne=l}}function gd(h,t){let e=t.reactions;if(e!==null){var r=Tf.call(e,h);if(r!==-1){var i=e.length-1;i===0?e=t.reactions=null:(e[r]=e[i],e.pop())}}e===null&&t.f&Pi&&(Oe===null||!Oe.includes(t))&&(zi(t,to),t.f&(ar|ga)||(t.f^=ga),js(t,0))}function js(h,t){var e=h.deps;if(e!==null)for(var r=t;r<e.length;r++)gd(h,e[r])}function eo(h){var t=h.f;if(!(t&Qr)){zi(h,Ye);var e=Yt,r=ne;Yt=h;try{t&sl?cd(h):Lc(h),bc(h),wc(h);var i=Cc(h);h.teardown=typeof i=="function"?i:null,h.wv=Ac;var s=h.deps,o;Gl&&Vf&&h.f&In}catch(l){Oa(l,h,e,r||h.ctx)}finally{Yt=e}}}function yd(){if(Gs>1e3){Gs=0;try{Ff()}catch(h){if(La!==null)Oa(h,La,null);else throw h}}Gs++}function vd(h){var t=h.length;if(t!==0){yd();var e=Jr;Jr=!0;try{for(var r=0;r<t;r++){var i=h[r];i.f&Ye||(i.f^=Ye);var s=[];zc(i,s),xd(s)}}finally{Jr=e}}}function xd(h){var t=h.length;if(t!==0)for(var e=0;e<t;e++){var r=h[e];if(!(r.f&(Qr|Ui)))try{is(r)&&(eo(r),r.deps===null&&r.first===null&&r.nodes_start===null&&(r.teardown===null?Mc(r):r.fn=null))}catch(i){Oa(i,r,null,r.ctx)}}}function wd(){if(ba=!1,Gs>1001)return;const h=Hh;Hh=[],vd(h),ba||(Gs=0,La=null)}function Ra(h){ba||(ba=!0,queueMicrotask(wd)),La=h;for(var t=h;t.parent!==null;){t=t.parent;var e=t.f;if(e&(Qs|Ci)){if(!(e&Ye))return;t.f^=Ye}}Hh.push(t)}function zc(h,t){var e=h.first,r=[];t:for(;e!==null;){var i=e.f,s=(i&Ci)!==0,o=s&&(i&Ye)!==0,l=e.next;if(!o&&!(i&Ui))if(i&Ks){if(s)e.f^=Ye;else try{is(e)&&eo(e)}catch(p){Oa(p,e,null,e.ctx)}var u=e.first;if(u!==null){e=u;continue}}else i&rc&&r.push(e);if(l===null){let p=e.parent;for(;p!==null;){if(h===p)break t;var f=p.next;if(f!==null){e=f;continue t}p=p.parent}}e=l}for(var d=0;d<r.length;d++)u=r[d],t.push(u),zc(u,t)}function Bt(h){var d;var t=h.f,e=(t&Pi)!==0;if(e&&t&Qr){var r=mc(h);return ll(h),r}if(ee!==null){Zi!==null&&Zi.includes(h)&&Hf();var i=ee.deps;h.rv<Ma&&(h.rv=Ma,Oe===null&&i!==null&&i[Qe]===h?Qe++:Oe===null?Oe=[h]:Oe.push(h),Pn!==null&&Yt!==null&&Yt.f&Ye&&!(Yt.f&Ci)&&Pn.includes(h)&&(zi(Yt,In),Ra(Yt)))}else if(e&&h.deps===null)for(var s=h,o=s.parent,l=s;o!==null;)if(o.f&Pi){var u=o;l=u,o=u.parent}else{var f=o;(d=f.deriveds)!=null&&d.includes(l)||(f.deriveds??(f.deriveds=[])).push(l);break}return e&&(s=h,is(s)&&_c(s)),h.v}function rr(h){const t=ee;try{return ee=null,h()}finally{ee=t}}const bd=-7169;function zi(h,t){h.f=h.f&bd|t}function Da(h,t=!1,e){ne={p:ne,c:null,e:null,m:!1,s:h,x:null,l:null},ts&&!t&&(ne.l={s:null,u:null,r1:[],r2:ti(!1)})}function Ba(h){const t=ne;if(t!==null){const o=t.e;if(o!==null){var e=Yt,r=ee;t.e=null;try{for(var i=0;i<o.length;i++){var s=o[i];Hi(s.effect),Rn(s.reaction),ul(s.fn)}}finally{Hi(e),Rn(r)}}ne=t.p,t.m=!0}return{}}function ml(h){if(!(typeof h!="object"||!h||h instanceof EventTarget)){if(ir in h)Wh(h);else if(!Array.isArray(h))for(let t in h){const e=h[t];typeof e=="object"&&e&&ir in e&&Wh(e)}}}function Wh(h,t=new Set){if(typeof h=="object"&&h!==null&&!(h instanceof EventTarget)&&!t.has(h)){t.add(h),h instanceof Date&&h.getTime();for(let r in h)try{Wh(h[r],t)}catch{}const e=nc(h);if(e!==Object.prototype&&e!==Array.prototype&&e!==Map.prototype&&e!==Set.prototype&&e!==Date.prototype){const r=kf(e);for(let i in r){const s=r[i].get;if(s)try{s.call(h)}catch{}}}}}const Ld=["touchstart","touchmove"];function Md(h){return Ld.includes(h)}function Ed(h){var t=ee,e=Yt;Rn(null),Hi(null);try{return h()}finally{Rn(t),Hi(e)}}const Td=new Set,Yl=new Set;function Sd(h,t,e,r){function i(s){if(r.capture||Rs.call(t,s),!s.cancelBubble)return Ed(()=>e.call(this,s))}return h.startsWith("pointer")||h.startsWith("touch")||h==="wheel"?Sc(()=>{t.addEventListener(h,i,r)}):t.addEventListener(h,i,r),i}function da(h,t,e,r,i){var s={capture:r,passive:i},o=Sd(h,t,e,s);(t===document.body||t===window||t===document)&&yc(()=>{t.removeEventListener(h,o,s)})}function Rs(h){var A;var t=this,e=t.ownerDocument,r=h.type,i=((A=h.composedPath)==null?void 0:A.call(h))||[],s=i[0]||h.target,o=0,l=h.__root;if(l){var u=i.indexOf(l);if(u!==-1&&(t===document||t===window)){h.__root=t;return}var f=i.indexOf(t);if(f===-1)return;u<=f&&(o=u)}if(s=i[o]||h.target,s!==t){Sf(h,"currentTarget",{configurable:!0,get(){return s||e}});var d=ee,p=Yt;Rn(null),Hi(null);try{for(var g,m=[];s!==null;){var x=s.assignedSlot||s.parentNode||s.host||null;try{var v=s["__"+r];if(v!==void 0&&!s.disabled)if(Ca(v)){var[b,...P]=v;b.apply(s,[h,...P])}else v.call(s,h)}catch(B){g?m.push(B):g=B}if(h.cancelBubble||x===t||x===null)break;s=x}if(g){for(let B of m)queueMicrotask(()=>{throw B});throw g}}finally{h.__root=t,delete h.currentTarget,Rn(d),Hi(p)}}}function kd(h){var t=document.createElement("template");return t.innerHTML=h,t.content}function Ad(h,t){var e=Yt;e.nodes_start===null&&(e.nodes_start=h,e.nodes_end=t)}function hr(h,t){var e=(t&ed)!==0,r,i=!h.startsWith("<!>");return()=>{r===void 0&&(r=kd(i?h:"<!>"+h),r=dc(r));var s=e?document.importNode(r,!0):r.cloneNode(!0);return Ad(s,s),s}}function nr(h,t){h!==null&&h.before(t)}function Pd(h,t){var e=t==null?"":typeof t=="object"?t+"":t;e!==(h.__t??(h.__t=h.nodeValue))&&(h.__t=e,h.nodeValue=e==null?"":e+"")}function Cd(h,t){return zd(h,t)}const Pr=new Map;function zd(h,{target:t,anchor:e,props:r={},events:i,context:s,intro:o=!0}){rd();var l=new Set,u=p=>{for(var g=0;g<p.length;g++){var m=p[g];if(!l.has(m)){l.add(m);var x=Md(m);t.addEventListener(m,Rs,{passive:x});var v=Pr.get(m);v===void 0?(document.addEventListener(m,Rs,{passive:x}),Pr.set(m,1)):Pr.set(m,v+1)}}};u(rl(Td)),Yl.add(u);var f=void 0,d=ud(()=>{var p=e??t.appendChild(fc());return Ys(()=>{if(s){Da({});var g=ne;g.c=s}i&&(r.$$events=i),f=h(p,r)||{},s&&Ba()}),()=>{var x;for(var g of l){t.removeEventListener(g,Rs);var m=Pr.get(g);--m===0?(document.removeEventListener(g,Rs),Pr.delete(g)):Pr.set(g,m)}Yl.delete(u),p!==e&&((x=p.parentNode)==null||x.removeChild(p))}});return Id.set(f,d),f}let Id=new WeakMap;function jl(h,t,e=!1){var r=h,i=null,s=null,o=He,l=e?ol:0,u=!1;const f=(p,g=!0)=>{u=!0,d(g,p)},d=(p,g)=>{o!==(o=p)&&(o?(i?wa(i):g&&(i=Ys(()=>g(r))),s&&xa(s,()=>{s=null})):(s?wa(s):g&&(s=Ys(()=>g(r))),i&&xa(i,()=>{i=null})))};cl(()=>{u=!1,t(f),u||d(null,null)},l)}function Od(h,t){return t}function Rd(h,t,e,r){for(var i=[],s=t.length,o=0;o<s;o++)fl(t[o].e,i,!0);var l=s>0&&i.length===0&&e!==null;if(l){var u=e.parentNode;sd(u),u.append(e),r.clear(),Sn(h,t[0].prev,t[s-1].next)}Ec(i,()=>{for(var f=0;f<s;f++){var d=t[f];l||(r.delete(d.k),Sn(h,d.prev,d.next)),On(d.e,!l)}})}function Dd(h,t,e,r,i,s=null){var o=h,l={flags:t,items:new Map,first:null};{var u=h;o=u.appendChild(fc())}var f=null,d=!1;cl(()=>{var p=e(),g=Ca(p)?p:p==null?[]:rl(p),m=g.length;if(!(d&&m===0)){d=m===0;{var x=ee;Bd(g,l,o,i,t,(x.f&Ui)!==0,r)}s!==null&&(m===0?f?wa(f):f=Ys(()=>s(o)):f!==null&&xa(f,()=>{f=null}))}})}function Bd(h,t,e,r,i,s,o,l){var u=h.length,f=t.items,d=t.first,p=d,g,m=null,x=[],v=[],b,P,A,B;for(B=0;B<u;B+=1){if(b=h[B],P=o(b,B),A=f.get(P),A===void 0){var Z=p?p.e.nodes_start:e;m=Fd(Z,t,m,m===null?t.first:m.next,b,P,B,r,i),f.set(P,m),x=[],v=[],p=m.next;continue}if(Nd(A,b,B),A.e.f&Ui&&wa(A.e),A!==p){if(g!==void 0&&g.has(A)){if(x.length<v.length){var I=v[0],K;m=I.prev;var V=x[0],S=x[x.length-1];for(K=0;K<x.length;K+=1)Xl(x[K],I,e);for(K=0;K<v.length;K+=1)g.delete(v[K]);Sn(t,V.prev,S.next),Sn(t,m,V),Sn(t,S,I),p=I,m=S,B-=1,x=[],v=[]}else g.delete(A),Xl(A,p,e),Sn(t,A.prev,A.next),Sn(t,A,m===null?t.first:m.next),Sn(t,m,A),m=A;continue}for(x=[],v=[];p!==null&&p.k!==P;)(s||!(p.e.f&Ui))&&(g??(g=new Set)).add(p),v.push(p),p=p.next;if(p===null)continue;A=p}x.push(A),m=A,p=A.next}if(p!==null||g!==void 0){for(var k=g===void 0?[]:rl(g);p!==null;)(s||!(p.e.f&Ui))&&k.push(p),p=p.next;var O=k.length;if(O>0){var N=u===0?e:null;Rd(t,k,N,f)}}Yt.first=t.first&&t.first.e,Yt.last=m&&m.e}function Nd(h,t,e,r){hc(h.v,t),h.i=e}function Fd(h,t,e,r,i,s,o,l,u,f){var d=(u&Yf)!==0,p=(u&Xf)===0,g=d?p?za(i):ti(i):i,m=u&jf?ti(o):o,x={i:m,v:g,k:s,a:null,e:null,prev:e,next:r};try{return x.e=Ys(()=>l(h,g,m),nd),x.e.prev=e&&e.e,x.e.next=r&&r.e,e===null?t.first=x:(e.next=x,e.e.next=x.e),r!==null&&(r.prev=x,r.e.prev=x.e),x}finally{}}function Xl(h,t,e){for(var r=h.next?h.next.e.nodes_start:e,i=t?t.e.nodes_start:e,s=h.e.nodes_start;s!==r;){var o=hl(s);i.before(s),s=o}}function Sn(h,t,e){t===null?h.first=e:(t.next=e,t.e.next=e&&e.e),e!==null&&(e.prev=t,e.e.prev=t&&t.e)}function Ud(h,t){t?h.hasAttribute("selected")||h.setAttribute("selected",""):h.removeAttribute("selected")}function Jl(h,t){return h===t||(h==null?void 0:h[ir])===t}function Zd(h={},t,e,r){return ul(()=>{var i,s;return Ia(()=>{i=s,s=[],rr(()=>{h!==e(...s)&&(t(h,...s),i&&Jl(e(...i),h)&&t(null,...i))})}),()=>{Sc(()=>{s&&Jl(e(...s),h)&&t(null,...s)})}}),h}function _l(h=!1){const t=ne,e=t.l.u;if(!e)return;let r=()=>ml(t.s);if(h){let i=0,s={};const o=va(()=>{let l=!1;const u=t.s;for(const f in u)u[f]!==s[f]&&(s[f]=u[f],l=!0);return l&&i++,i});r=()=>Bt(o)}e.b.length&&ld(()=>{$l(t,r),Nh(e.b)}),Uh(()=>{const i=rr(()=>e.m.map(Cf));return()=>{for(const s of i)typeof s=="function"&&s()}}),e.a.length&&Uh(()=>{$l(t,r),Nh(e.a)})}function $l(h,t){if(h.l.s)for(const e of h.l.s)Bt(e);t()}function Gd(h){var t=ti(0);return function(){return arguments.length===1?(de(t,Bt(t)+1),arguments[0]):(Bt(t),h())}}function Hd(h,t,e){if(h==null)return t(void 0),jr;const r=rr(()=>h.subscribe(t,e));return r.unsubscribe?()=>r.unsubscribe():r}let Uo=!1;function Kl(h,t,e){const r=e[t]??(e[t]={store:null,source:za(void 0),unsubscribe:jr});if(r.store!==h)if(r.unsubscribe(),r.store=h??null,h==null)r.source.v=void 0,r.unsubscribe=jr;else{var i=!0;r.unsubscribe=Hd(h,s=>{i?r.source.v=s:de(r.source,s)}),i=!1}return Bt(r.source)}function Wd(h,t){return h.set(t),t}function Ic(){const h={};return yc(()=>{for(var t in h)h[t].unsubscribe()}),h}function Vd(h){var t=Uo;try{return Uo=!1,[h(),Uo]}finally{Uo=t}}function Ql(h){for(var t=Yt,e=Yt;t!==null&&!(t.f&(Ci|Qs));)t=t.parent;try{return Hi(t),h()}finally{Hi(e)}}function Hs(h,t,e,r){var V;var i=(e&Jf)!==0,s=!ts||(e&$f)!==0,o=(e&Qf)!==0,l=(e&td)!==0,u=!1,f;o?[f,u]=Vd(()=>h[t]):f=h[t];var d=ir in h||Rf in h,p=o&&(((V=Yr(h,t))==null?void 0:V.set)??(d&&t in h&&(S=>h[t]=S)))||void 0,g=r,m=!0,x=!1,v=()=>(x=!0,m&&(m=!1,l?g=rr(r):g=r),g);f===void 0&&r!==void 0&&(p&&s&&Uf(),f=v(),p&&p(f));var b;if(s)b=()=>{var S=h[t];return S===void 0?v():(m=!0,x=!1,S)};else{var P=Ql(()=>(i?va:od)(()=>h[t]));P.f|=If,b=()=>{var S=Bt(P);return S!==void 0&&(g=void 0),S===void 0?g:S}}if(!(e&Kf))return b;if(p){var A=h.$$legacy;return function(S,k){return arguments.length>0?((!s||!k||A||u)&&p(k?b():S),S):b()}}var B=!1,Z=!1,I=za(f),K=Ql(()=>va(()=>{var S=b(),k=Bt(I);return B?(B=!1,Z=!0,k):(Z=!1,I.v=S)}));return i||(K.equals=al),function(S,k){if(arguments.length>0){const O=k?Bt(K):s&&o?Hr(S):S;return K.equals(O)||(B=!0,de(I,O),x&&g!==void 0&&(g=O),rr(()=>Bt(K))),S}return Bt(K)}}function qd(h){ne===null&&kc(),ts&&ne.l!==null?jd(ne).m.push(h):Uh(()=>{const t=rr(h);if(typeof t=="function")return t})}function Yd(h,t,{bubbles:e=!1,cancelable:r=!1}={}){return new CustomEvent(h,{detail:t,bubbles:e,cancelable:r})}function Oc(){const h=ne;return h===null&&kc(),(t,e,r)=>{var s;const i=(s=h.s.$$events)==null?void 0:s[t];if(i){const o=Ca(i)?i.slice():[i],l=Yd(t,e,r);for(const u of o)u.call(h.x,l);return!l.defaultPrevented}return!0}}function jd(h){var t=h.l;return t.u??(t.u={a:[],b:[],m:[]})}const Xd="5";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(Xd);qf();const Cr=[];function Rc(h,t=jr){let e=null;const r=new Set;function i(l){if(ac(h,l)&&(h=l,e)){const u=!Cr.length;for(const f of r)f[1](),Cr.push(f,h);if(u){for(let f=0;f<Cr.length;f+=2)Cr[f][0](Cr[f+1]);Cr.length=0}}}function s(l){i(l(h))}function o(l,u=jr){const f=[l,u];return r.add(f),r.size===1&&(e=t(i,s)||jr),l(h),()=>{r.delete(f),r.size===0&&e&&(e(),e=null)}}return{set:i,update:s,subscribe:o}}const pa=Rc(null),Ea=Rc(null);var Jd=hr("<option> </option>"),$d=hr('<div class="svelte-1lvjhsb"><label for="layer-selector">Select Map Layer:</label> <select id="layer-selector"></select></div>');function Kd(h,t){Da(t,!1);const e=[{label:"OpenStreetMap Default",value:"https://tile.openstreetmap.org/{z}/{x}/{y}.png",attribution:"&copy; OpenStreetMap contributors"},{label:"CartoDB Positron",value:"https://basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png",attribution:"&copy; OpenStreetMap contributors &copy; CartoDB"},{label:"CartoDB Dark Matter",value:"https://basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png",attribution:"&copy; OpenStreetMap contributors &copy; CartoDB"},{label:"OpenTopoMap",value:"https://tile.opentopomap.org/{z}/{x}/{y}.png",attribution:"&copy; OpenStreetMap contributors &copy; OpenTopoMap"},{label:"ESRI Satellite",value:"https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}",attribution:"Tiles &copy; Esri &mdash; Source: Esri, i-cubed, USDA, USGS, AEX, GeoEye, Getmapping, Aerogrid, IGN, IGP, UPR-EGP, and the GIS User Community"},{label:"ESRI World Imagery",value:"https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}",attribution:"Tiles &copy; Esri &mdash; Source: Esri, i-cubed, USDA, USGS, AEX, GeoEye, Getmapping, Aerogrid, IGN, IGP, UPR-EGP, and the GIS User Community"},{label:"ESRI World Street Map",value:"https://server.arcgisonline.com/ArcGIS/rest/services/World_Street_Map/MapServer/tile/{z}/{y}/{x}",attribution:"Tiles &copy; Esri &mdash; Source: Esri, DeLorme, NAVTEQ"},{label:"ESRI World Topo Map",value:"https://server.arcgisonline.com/ArcGIS/rest/services/World_Topo_Map/MapServer/tile/{z}/{y}/{x}",attribution:"Tiles &copy; Esri &mdash; Source: Esri, DeLorme, NAVTEQ"}];let r=Hs(t,"selectedLayer",28,()=>e[0]);const i=Oc(),s=u=>{r(u),i("change",{layer:u})};_l();var o=$d(),l=kn(ya(o),2);Dd(l,5,()=>e,Od,(u,f)=>{var d=Jd(),p={},g=ya(d);xc(()=>{p!==(p=Bt(f).value)&&(d.value=(d.__value=Bt(f).value)==null?"":Bt(f).value),Ud(d,Bt(f)===r()),Pd(g,Bt(f).label)}),nr(u,d)}),da("change",l,u=>s(e[u.target.selectedIndex])),nr(h,o),Ba()}var An=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function gl(h){return h&&h.__esModule&&Object.prototype.hasOwnProperty.call(h,"default")?h.default:h}var Ds={exports:{}};/* @preserve
 * Leaflet 1.9.4, a JS library for interactive maps. https://leafletjs.com
 * (c) 2010-2023 Vladimir Agafonkin, (c) 2010-2011 CloudMade
 */var Qd=Ds.exports,tu;function tp(){return tu||(tu=1,function(h,t){(function(e,r){r(t)})(Qd,function(e){var r="1.9.4";function i(n){var a,c,_,T;for(c=1,_=arguments.length;c<_;c++){T=arguments[c];for(a in T)n[a]=T[a]}return n}var s=Object.create||function(){function n(){}return function(a){return n.prototype=a,new n}}();function o(n,a){var c=Array.prototype.slice;if(n.bind)return n.bind.apply(n,c.call(arguments,1));var _=c.call(arguments,2);return function(){return n.apply(a,_.length?_.concat(c.call(arguments)):arguments)}}var l=0;function u(n){return"_leaflet_id"in n||(n._leaflet_id=++l),n._leaflet_id}function f(n,a,c){var _,T,R,$;return $=function(){_=!1,T&&(R.apply(c,T),T=!1)},R=function(){_?T=arguments:(n.apply(c,arguments),setTimeout($,a),_=!0)},R}function d(n,a,c){var _=a[1],T=a[0],R=_-T;return n===_&&c?n:((n-T)%R+R)%R+T}function p(){return!1}function g(n,a){if(a===!1)return n;var c=Math.pow(10,a===void 0?6:a);return Math.round(n*c)/c}function m(n){return n.trim?n.trim():n.replace(/^\s+|\s+$/g,"")}function x(n){return m(n).split(/\s+/)}function v(n,a){Object.prototype.hasOwnProperty.call(n,"options")||(n.options=n.options?s(n.options):{});for(var c in a)n.options[c]=a[c];return n.options}function b(n,a,c){var _=[];for(var T in n)_.push(encodeURIComponent(c?T.toUpperCase():T)+"="+encodeURIComponent(n[T]));return(!a||a.indexOf("?")===-1?"?":"&")+_.join("&")}var P=/\{ *([\w_ -]+) *\}/g;function A(n,a){return n.replace(P,function(c,_){var T=a[_];if(T===void 0)throw new Error("No value provided for variable "+c);return typeof T=="function"&&(T=T(a)),T})}var B=Array.isArray||function(n){return Object.prototype.toString.call(n)==="[object Array]"};function Z(n,a){for(var c=0;c<n.length;c++)if(n[c]===a)return c;return-1}var I="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function K(n){return window["webkit"+n]||window["moz"+n]||window["ms"+n]}var V=0;function S(n){var a=+new Date,c=Math.max(0,16-(a-V));return V=a+c,window.setTimeout(n,c)}var k=window.requestAnimationFrame||K("RequestAnimationFrame")||S,O=window.cancelAnimationFrame||K("CancelAnimationFrame")||K("CancelRequestAnimationFrame")||function(n){window.clearTimeout(n)};function N(n,a,c){if(c&&k===S)n.call(a);else return k.call(window,o(n,a))}function E(n){n&&O.call(window,n)}var C={__proto__:null,extend:i,create:s,bind:o,get lastId(){return l},stamp:u,throttle:f,wrapNum:d,falseFn:p,formatNum:g,trim:m,splitWords:x,setOptions:v,getParamString:b,template:A,isArray:B,indexOf:Z,emptyImageUrl:I,requestFn:k,cancelFn:O,requestAnimFrame:N,cancelAnimFrame:E};function y(){}y.extend=function(n){var a=function(){v(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},c=a.__super__=this.prototype,_=s(c);_.constructor=a,a.prototype=_;for(var T in this)Object.prototype.hasOwnProperty.call(this,T)&&T!=="prototype"&&T!=="__super__"&&(a[T]=this[T]);return n.statics&&i(a,n.statics),n.includes&&(z(n.includes),i.apply(null,[_].concat(n.includes))),i(_,n),delete _.statics,delete _.includes,_.options&&(_.options=c.options?s(c.options):{},i(_.options,n.options)),_._initHooks=[],_.callInitHooks=function(){if(!this._initHooksCalled){c.callInitHooks&&c.callInitHooks.call(this),this._initHooksCalled=!0;for(var R=0,$=_._initHooks.length;R<$;R++)_._initHooks[R].call(this)}},a},y.include=function(n){var a=this.prototype.options;return i(this.prototype,n),n.options&&(this.prototype.options=a,this.mergeOptions(n.options)),this},y.mergeOptions=function(n){return i(this.prototype.options,n),this},y.addInitHook=function(n){var a=Array.prototype.slice.call(arguments,1),c=typeof n=="function"?n:function(){this[n].apply(this,a)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(c),this};function z(n){if(!(typeof L>"u"||!L||!L.Mixin)){n=B(n)?n:[n];for(var a=0;a<n.length;a++)n[a]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",new Error().stack)}}var H={on:function(n,a,c){if(typeof n=="object")for(var _ in n)this._on(_,n[_],a);else{n=x(n);for(var T=0,R=n.length;T<R;T++)this._on(n[T],a,c)}return this},off:function(n,a,c){if(!arguments.length)delete this._events;else if(typeof n=="object")for(var _ in n)this._off(_,n[_],a);else{n=x(n);for(var T=arguments.length===1,R=0,$=n.length;R<$;R++)T?this._off(n[R]):this._off(n[R],a,c)}return this},_on:function(n,a,c,_){if(typeof a!="function"){console.warn("wrong listener type: "+typeof a);return}if(this._listens(n,a,c)===!1){c===this&&(c=void 0);var T={fn:a,ctx:c};_&&(T.once=!0),this._events=this._events||{},this._events[n]=this._events[n]||[],this._events[n].push(T)}},_off:function(n,a,c){var _,T,R;if(this._events&&(_=this._events[n],!!_)){if(arguments.length===1){if(this._firingCount)for(T=0,R=_.length;T<R;T++)_[T].fn=p;delete this._events[n];return}if(typeof a!="function"){console.warn("wrong listener type: "+typeof a);return}var $=this._listens(n,a,c);if($!==!1){var nt=_[$];this._firingCount&&(nt.fn=p,this._events[n]=_=_.slice()),_.splice($,1)}}},fire:function(n,a,c){if(!this.listens(n,c))return this;var _=i({},a,{type:n,target:this,sourceTarget:a&&a.sourceTarget||this});if(this._events){var T=this._events[n];if(T){this._firingCount=this._firingCount+1||1;for(var R=0,$=T.length;R<$;R++){var nt=T[R],st=nt.fn;nt.once&&this.off(n,st,nt.ctx),st.call(nt.ctx||this,_)}this._firingCount--}}return c&&this._propagateEvent(_),this},listens:function(n,a,c,_){typeof n!="string"&&console.warn('"string" type argument expected');var T=a;typeof a!="function"&&(_=!!a,T=void 0,c=void 0);var R=this._events&&this._events[n];if(R&&R.length&&this._listens(n,T,c)!==!1)return!0;if(_){for(var $ in this._eventParents)if(this._eventParents[$].listens(n,a,c,_))return!0}return!1},_listens:function(n,a,c){if(!this._events)return!1;var _=this._events[n]||[];if(!a)return!!_.length;c===this&&(c=void 0);for(var T=0,R=_.length;T<R;T++)if(_[T].fn===a&&_[T].ctx===c)return T;return!1},once:function(n,a,c){if(typeof n=="object")for(var _ in n)this._on(_,n[_],a,!0);else{n=x(n);for(var T=0,R=n.length;T<R;T++)this._on(n[T],a,c,!0)}return this},addEventParent:function(n){return this._eventParents=this._eventParents||{},this._eventParents[u(n)]=n,this},removeEventParent:function(n){return this._eventParents&&delete this._eventParents[u(n)],this},_propagateEvent:function(n){for(var a in this._eventParents)this._eventParents[a].fire(n.type,i({layer:n.target,propagatedFrom:n.target},n),!0)}};H.addEventListener=H.on,H.removeEventListener=H.clearAllEventListeners=H.off,H.addOneTimeEventListener=H.once,H.fireEvent=H.fire,H.hasEventListeners=H.listens;var G=y.extend(H);function W(n,a,c){this.x=c?Math.round(n):n,this.y=c?Math.round(a):a}var X=Math.trunc||function(n){return n>0?Math.floor(n):Math.ceil(n)};W.prototype={clone:function(){return new W(this.x,this.y)},add:function(n){return this.clone()._add(tt(n))},_add:function(n){return this.x+=n.x,this.y+=n.y,this},subtract:function(n){return this.clone()._subtract(tt(n))},_subtract:function(n){return this.x-=n.x,this.y-=n.y,this},divideBy:function(n){return this.clone()._divideBy(n)},_divideBy:function(n){return this.x/=n,this.y/=n,this},multiplyBy:function(n){return this.clone()._multiplyBy(n)},_multiplyBy:function(n){return this.x*=n,this.y*=n,this},scaleBy:function(n){return new W(this.x*n.x,this.y*n.y)},unscaleBy:function(n){return new W(this.x/n.x,this.y/n.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=X(this.x),this.y=X(this.y),this},distanceTo:function(n){n=tt(n);var a=n.x-this.x,c=n.y-this.y;return Math.sqrt(a*a+c*c)},equals:function(n){return n=tt(n),n.x===this.x&&n.y===this.y},contains:function(n){return n=tt(n),Math.abs(n.x)<=Math.abs(this.x)&&Math.abs(n.y)<=Math.abs(this.y)},toString:function(){return"Point("+g(this.x)+", "+g(this.y)+")"}};function tt(n,a,c){return n instanceof W?n:B(n)?new W(n[0],n[1]):n==null?n:typeof n=="object"&&"x"in n&&"y"in n?new W(n.x,n.y):new W(n,a,c)}function q(n,a){if(n)for(var c=a?[n,a]:n,_=0,T=c.length;_<T;_++)this.extend(c[_])}q.prototype={extend:function(n){var a,c;if(!n)return this;if(n instanceof W||typeof n[0]=="number"||"x"in n)a=c=tt(n);else if(n=Q(n),a=n.min,c=n.max,!a||!c)return this;return!this.min&&!this.max?(this.min=a.clone(),this.max=c.clone()):(this.min.x=Math.min(a.x,this.min.x),this.max.x=Math.max(c.x,this.max.x),this.min.y=Math.min(a.y,this.min.y),this.max.y=Math.max(c.y,this.max.y)),this},getCenter:function(n){return tt((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,n)},getBottomLeft:function(){return tt(this.min.x,this.max.y)},getTopRight:function(){return tt(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(n){var a,c;return typeof n[0]=="number"||n instanceof W?n=tt(n):n=Q(n),n instanceof q?(a=n.min,c=n.max):a=c=n,a.x>=this.min.x&&c.x<=this.max.x&&a.y>=this.min.y&&c.y<=this.max.y},intersects:function(n){n=Q(n);var a=this.min,c=this.max,_=n.min,T=n.max,R=T.x>=a.x&&_.x<=c.x,$=T.y>=a.y&&_.y<=c.y;return R&&$},overlaps:function(n){n=Q(n);var a=this.min,c=this.max,_=n.min,T=n.max,R=T.x>a.x&&_.x<c.x,$=T.y>a.y&&_.y<c.y;return R&&$},isValid:function(){return!!(this.min&&this.max)},pad:function(n){var a=this.min,c=this.max,_=Math.abs(a.x-c.x)*n,T=Math.abs(a.y-c.y)*n;return Q(tt(a.x-_,a.y-T),tt(c.x+_,c.y+T))},equals:function(n){return n?(n=Q(n),this.min.equals(n.getTopLeft())&&this.max.equals(n.getBottomRight())):!1}};function Q(n,a){return!n||n instanceof q?n:new q(n,a)}function dt(n,a){if(n)for(var c=a?[n,a]:n,_=0,T=c.length;_<T;_++)this.extend(c[_])}dt.prototype={extend:function(n){var a=this._southWest,c=this._northEast,_,T;if(n instanceof rt)_=n,T=n;else if(n instanceof dt){if(_=n._southWest,T=n._northEast,!_||!T)return this}else return n?this.extend(mt(n)||ct(n)):this;return!a&&!c?(this._southWest=new rt(_.lat,_.lng),this._northEast=new rt(T.lat,T.lng)):(a.lat=Math.min(_.lat,a.lat),a.lng=Math.min(_.lng,a.lng),c.lat=Math.max(T.lat,c.lat),c.lng=Math.max(T.lng,c.lng)),this},pad:function(n){var a=this._southWest,c=this._northEast,_=Math.abs(a.lat-c.lat)*n,T=Math.abs(a.lng-c.lng)*n;return new dt(new rt(a.lat-_,a.lng-T),new rt(c.lat+_,c.lng+T))},getCenter:function(){return new rt((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new rt(this.getNorth(),this.getWest())},getSouthEast:function(){return new rt(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(n){typeof n[0]=="number"||n instanceof rt||"lat"in n?n=mt(n):n=ct(n);var a=this._southWest,c=this._northEast,_,T;return n instanceof dt?(_=n.getSouthWest(),T=n.getNorthEast()):_=T=n,_.lat>=a.lat&&T.lat<=c.lat&&_.lng>=a.lng&&T.lng<=c.lng},intersects:function(n){n=ct(n);var a=this._southWest,c=this._northEast,_=n.getSouthWest(),T=n.getNorthEast(),R=T.lat>=a.lat&&_.lat<=c.lat,$=T.lng>=a.lng&&_.lng<=c.lng;return R&&$},overlaps:function(n){n=ct(n);var a=this._southWest,c=this._northEast,_=n.getSouthWest(),T=n.getNorthEast(),R=T.lat>a.lat&&_.lat<c.lat,$=T.lng>a.lng&&_.lng<c.lng;return R&&$},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(n,a){return n?(n=ct(n),this._southWest.equals(n.getSouthWest(),a)&&this._northEast.equals(n.getNorthEast(),a)):!1},isValid:function(){return!!(this._southWest&&this._northEast)}};function ct(n,a){return n instanceof dt?n:new dt(n,a)}function rt(n,a,c){if(isNaN(n)||isNaN(a))throw new Error("Invalid LatLng object: ("+n+", "+a+")");this.lat=+n,this.lng=+a,c!==void 0&&(this.alt=+c)}rt.prototype={equals:function(n,a){if(!n)return!1;n=mt(n);var c=Math.max(Math.abs(this.lat-n.lat),Math.abs(this.lng-n.lng));return c<=(a===void 0?1e-9:a)},toString:function(n){return"LatLng("+g(this.lat,n)+", "+g(this.lng,n)+")"},distanceTo:function(n){return St.distance(this,mt(n))},wrap:function(){return St.wrapLatLng(this)},toBounds:function(n){var a=180*n/40075017,c=a/Math.cos(Math.PI/180*this.lat);return ct([this.lat-a,this.lng-c],[this.lat+a,this.lng+c])},clone:function(){return new rt(this.lat,this.lng,this.alt)}};function mt(n,a,c){return n instanceof rt?n:B(n)&&typeof n[0]!="object"?n.length===3?new rt(n[0],n[1],n[2]):n.length===2?new rt(n[0],n[1]):null:n==null?n:typeof n=="object"&&"lat"in n?new rt(n.lat,"lng"in n?n.lng:n.lon,n.alt):a===void 0?null:new rt(n,a,c)}var Et={latLngToPoint:function(n,a){var c=this.projection.project(n),_=this.scale(a);return this.transformation._transform(c,_)},pointToLatLng:function(n,a){var c=this.scale(a),_=this.transformation.untransform(n,c);return this.projection.unproject(_)},project:function(n){return this.projection.project(n)},unproject:function(n){return this.projection.unproject(n)},scale:function(n){return 256*Math.pow(2,n)},zoom:function(n){return Math.log(n/256)/Math.LN2},getProjectedBounds:function(n){if(this.infinite)return null;var a=this.projection.bounds,c=this.scale(n),_=this.transformation.transform(a.min,c),T=this.transformation.transform(a.max,c);return new q(_,T)},infinite:!1,wrapLatLng:function(n){var a=this.wrapLng?d(n.lng,this.wrapLng,!0):n.lng,c=this.wrapLat?d(n.lat,this.wrapLat,!0):n.lat,_=n.alt;return new rt(c,a,_)},wrapLatLngBounds:function(n){var a=n.getCenter(),c=this.wrapLatLng(a),_=a.lat-c.lat,T=a.lng-c.lng;if(_===0&&T===0)return n;var R=n.getSouthWest(),$=n.getNorthEast(),nt=new rt(R.lat-_,R.lng-T),st=new rt($.lat-_,$.lng-T);return new dt(nt,st)}},St=i({},Et,{wrapLng:[-180,180],R:6371e3,distance:function(n,a){var c=Math.PI/180,_=n.lat*c,T=a.lat*c,R=Math.sin((a.lat-n.lat)*c/2),$=Math.sin((a.lng-n.lng)*c/2),nt=R*R+Math.cos(_)*Math.cos(T)*$*$,st=2*Math.atan2(Math.sqrt(nt),Math.sqrt(1-nt));return this.R*st}}),Ot=6378137,bt={R:Ot,MAX_LATITUDE:85.0511287798,project:function(n){var a=Math.PI/180,c=this.MAX_LATITUDE,_=Math.max(Math.min(c,n.lat),-c),T=Math.sin(_*a);return new W(this.R*n.lng*a,this.R*Math.log((1+T)/(1-T))/2)},unproject:function(n){var a=180/Math.PI;return new rt((2*Math.atan(Math.exp(n.y/this.R))-Math.PI/2)*a,n.x*a/this.R)},bounds:function(){var n=Ot*Math.PI;return new q([-n,-n],[n,n])}()};function vt(n,a,c,_){if(B(n)){this._a=n[0],this._b=n[1],this._c=n[2],this._d=n[3];return}this._a=n,this._b=a,this._c=c,this._d=_}vt.prototype={transform:function(n,a){return this._transform(n.clone(),a)},_transform:function(n,a){return a=a||1,n.x=a*(this._a*n.x+this._b),n.y=a*(this._c*n.y+this._d),n},untransform:function(n,a){return a=a||1,new W((n.x/a-this._b)/this._a,(n.y/a-this._d)/this._c)}};function ht(n,a,c,_){return new vt(n,a,c,_)}var ft=i({},St,{code:"EPSG:3857",projection:bt,transformation:function(){var n=.5/(Math.PI*bt.R);return ht(n,.5,-n,.5)}()}),M=i({},ft,{code:"EPSG:900913"});function et(n){return document.createElementNS("http://www.w3.org/2000/svg",n)}function j(n,a){var c="",_,T,R,$,nt,st;for(_=0,R=n.length;_<R;_++){for(nt=n[_],T=0,$=nt.length;T<$;T++)st=nt[T],c+=(T?"L":"M")+st.x+" "+st.y;c+=a?At.svg?"z":"x":""}return c||"M0 0"}var U=document.documentElement.style,F="ActiveXObject"in window,J=F&&!document.addEventListener,at="msLaunchUri"in navigator&&!("documentMode"in document),lt=si("webkit"),it=si("android"),_t=si("android 2")||si("android 3"),xt=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),gt=it&&si("Google")&&xt<537&&!("AudioNode"in window),Tt=!!window.opera,Wt=!at&&si("chrome"),kt=si("gecko")&&!lt&&!Tt&&!F,$t=!Wt&&si("safari"),ce=si("phantom"),se="OTransition"in U,ye=navigator.platform.indexOf("Win")===0,Jt=F&&"transition"in U,ve="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!_t,oe="MozPerspective"in U,xe=!window.L_DISABLE_3D&&(Jt||ve||oe)&&!se&&!ce,Fe=typeof orientation<"u"||si("mobile"),ii=Fe&&lt,ni=Fe&&ve,yi=!window.PointerEvent&&window.MSPointerEvent,je=!!(window.PointerEvent||yi),ie="ontouchstart"in window||!!window.TouchEvent,Ii=!window.L_NO_TOUCH&&(ie||je),ri=Fe&&Tt,ss=Fe&&kt,ro=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,so=function(){var n=!1;try{var a=Object.defineProperty({},"passive",{get:function(){n=!0}});window.addEventListener("testPassiveEventSupport",p,a),window.removeEventListener("testPassiveEventSupport",p,a)}catch{}return n}(),cr=function(){return!!document.createElement("canvas").getContext}(),fr=!!(document.createElementNS&&et("svg").createSVGRect),Za=!!fr&&function(){var n=document.createElement("div");return n.innerHTML="<svg/>",(n.firstChild&&n.firstChild.namespaceURI)==="http://www.w3.org/2000/svg"}(),oo=!fr&&function(){try{var n=document.createElement("div");n.innerHTML='<v:shape adj="1"/>';var a=n.firstChild;return a.style.behavior="url(#default#VML)",a&&typeof a.adj=="object"}catch{return!1}}(),Ga=navigator.platform.indexOf("Mac")===0,ao=navigator.platform.indexOf("Linux")===0;function si(n){return navigator.userAgent.toLowerCase().indexOf(n)>=0}var At={ie:F,ielt9:J,edge:at,webkit:lt,android:it,android23:_t,androidStock:gt,opera:Tt,chrome:Wt,gecko:kt,safari:$t,phantom:ce,opera12:se,win:ye,ie3d:Jt,webkit3d:ve,gecko3d:oe,any3d:xe,mobile:Fe,mobileWebkit:ii,mobileWebkit3d:ni,msPointer:yi,pointer:je,touch:Ii,touchNative:ie,mobileOpera:ri,mobileGecko:ss,retina:ro,passiveEvents:so,canvas:cr,svg:fr,vml:oo,inlineSvg:Za,mac:Ga,linux:ao},os=At.msPointer?"MSPointerDown":"pointerdown",dr=At.msPointer?"MSPointerMove":"pointermove",fn=At.msPointer?"MSPointerUp":"pointerup",pr=At.msPointer?"MSPointerCancel":"pointercancel",Nn={touchstart:os,touchmove:dr,touchend:fn,touchcancel:pr},mr={touchstart:uo,touchmove:Oi,touchend:Oi,touchcancel:Oi},oi={},ho=!1;function Ha(n,a,c){return a==="touchstart"&&_r(),mr[a]?(c=mr[a].bind(this,c),n.addEventListener(Nn[a],c,!1),c):(console.warn("wrong event specified:",a),p)}function Wa(n,a,c){if(!Nn[a]){console.warn("wrong event specified:",a);return}n.removeEventListener(Nn[a],c,!1)}function Va(n){oi[n.pointerId]=n}function qa(n){oi[n.pointerId]&&(oi[n.pointerId]=n)}function lo(n){delete oi[n.pointerId]}function _r(){ho||(document.addEventListener(os,Va,!0),document.addEventListener(dr,qa,!0),document.addEventListener(fn,lo,!0),document.addEventListener(pr,lo,!0),ho=!0)}function Oi(n,a){if(a.pointerType!==(a.MSPOINTER_TYPE_MOUSE||"mouse")){a.touches=[];for(var c in oi)a.touches.push(oi[c]);a.changedTouches=[a],n(a)}}function uo(n,a){a.MSPOINTER_TYPE_TOUCH&&a.pointerType===a.MSPOINTER_TYPE_TOUCH&&be(a),Oi(n,a)}function Zt(n){var a={},c,_;for(_ in n)c=n[_],a[_]=c&&c.bind?c.bind(n):c;return n=a,a.type="dblclick",a.detail=2,a.isTrusted=!1,a._simulated=!0,a}var Vi=200;function Ya(n,a){n.addEventListener("dblclick",a);var c=0,_;function T(R){if(R.detail!==1){_=R.detail;return}if(!(R.pointerType==="mouse"||R.sourceCapabilities&&!R.sourceCapabilities.firesTouchEvents)){var $=mo(R);if(!($.some(function(st){return st instanceof HTMLLabelElement&&st.attributes.for})&&!$.some(function(st){return st instanceof HTMLInputElement||st instanceof HTMLSelectElement}))){var nt=Date.now();nt-c<=Vi?(_++,_===2&&a(Zt(R))):_=1,c=nt}}}return n.addEventListener("click",T),{dblclick:a,simDblclick:T}}function ja(n,a){n.removeEventListener("dblclick",a.dblclick),n.removeEventListener("click",a.simDblclick)}var as=vr(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),Fn=vr(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),co=Fn==="webkitTransition"||Fn==="OTransition"?Fn+"End":"transitionend";function ai(n){return typeof n=="string"?document.getElementById(n):n}function Un(n,a){var c=n.style[a]||n.currentStyle&&n.currentStyle[a];if((!c||c==="auto")&&document.defaultView){var _=document.defaultView.getComputedStyle(n,null);c=_?_[a]:null}return c==="auto"?null:c}function jt(n,a,c){var _=document.createElement(n);return _.className=a||"",c&&c.appendChild(_),_}function re(n){var a=n.parentNode;a&&a.removeChild(n)}function gr(n){for(;n.firstChild;)n.removeChild(n.firstChild)}function dn(n){var a=n.parentNode;a&&a.lastChild!==n&&a.appendChild(n)}function Ae(n){var a=n.parentNode;a&&a.firstChild!==n&&a.insertBefore(n,a.firstChild)}function hs(n,a){if(n.classList!==void 0)return n.classList.contains(a);var c=yr(n);return c.length>0&&new RegExp("(^|\\s)"+a+"(\\s|$)").test(c)}function Ft(n,a){if(n.classList!==void 0)for(var c=x(a),_=0,T=c.length;_<T;_++)n.classList.add(c[_]);else if(!hs(n,a)){var R=yr(n);ls(n,(R?R+" ":"")+a)}}function ae(n,a){n.classList!==void 0?n.classList.remove(a):ls(n,m((" "+yr(n)+" ").replace(" "+a+" "," ")))}function ls(n,a){n.className.baseVal===void 0?n.className=a:n.className.baseVal=a}function yr(n){return n.correspondingElement&&(n=n.correspondingElement),n.className.baseVal===void 0?n.className:n.className.baseVal}function Se(n,a){"opacity"in n.style?n.style.opacity=a:"filter"in n.style&&Xa(n,a)}function Xa(n,a){var c=!1,_="DXImageTransform.Microsoft.Alpha";try{c=n.filters.item(_)}catch{if(a===1)return}a=Math.round(a*100),c?(c.Enabled=a!==100,c.Opacity=a):n.style.filter+=" progid:"+_+"(opacity="+a+")"}function vr(n){for(var a=document.documentElement.style,c=0;c<n.length;c++)if(n[c]in a)return n[c];return!1}function we(n,a,c){var _=a||new W(0,0);n.style[as]=(At.ie3d?"translate("+_.x+"px,"+_.y+"px)":"translate3d("+_.x+"px,"+_.y+"px,0)")+(c?" scale("+c+")":"")}function ue(n,a){n._leaflet_pos=a,At.any3d?we(n,a):(n.style.left=a.x+"px",n.style.top=a.y+"px")}function qi(n){return n._leaflet_pos||new W(0,0)}var Zn,Gn,us;if("onselectstart"in document)Zn=function(){Rt(window,"selectstart",be)},Gn=function(){Kt(window,"selectstart",be)};else{var pn=vr(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);Zn=function(){if(pn){var n=document.documentElement.style;us=n[pn],n[pn]="none"}},Gn=function(){pn&&(document.documentElement.style[pn]=us,us=void 0)}}function Hn(){Rt(window,"dragstart",be)}function xr(){Kt(window,"dragstart",be)}var Yi,cs;function Ri(n){for(;n.tabIndex===-1;)n=n.parentNode;n.style&&(wr(),Yi=n,cs=n.style.outlineStyle,n.style.outlineStyle="none",Rt(window,"keydown",wr))}function wr(){Yi&&(Yi.style.outlineStyle=cs,Yi=void 0,cs=void 0,Kt(window,"keydown",wr))}function fo(n){do n=n.parentNode;while((!n.offsetWidth||!n.offsetHeight)&&n!==document.body);return n}function fs(n){var a=n.getBoundingClientRect();return{x:a.width/n.offsetWidth||1,y:a.height/n.offsetHeight||1,boundingClientRect:a}}var Ja={__proto__:null,TRANSFORM:as,TRANSITION:Fn,TRANSITION_END:co,get:ai,getStyle:Un,create:jt,remove:re,empty:gr,toFront:dn,toBack:Ae,hasClass:hs,addClass:Ft,removeClass:ae,setClass:ls,getClass:yr,setOpacity:Se,testProp:vr,setTransform:we,setPosition:ue,getPosition:qi,get disableTextSelection(){return Zn},get enableTextSelection(){return Gn},disableImageDrag:Hn,enableImageDrag:xr,preventOutline:Ri,restoreOutline:wr,getSizedParentNode:fo,getScale:fs};function Rt(n,a,c,_){if(a&&typeof a=="object")for(var T in a)ds(n,T,a[T],c);else{a=x(a);for(var R=0,$=a.length;R<$;R++)ds(n,a[R],c,_)}return this}var hi="_leaflet_events";function Kt(n,a,c,_){if(arguments.length===1)po(n),delete n[hi];else if(a&&typeof a=="object")for(var T in a)ps(n,T,a[T],c);else if(a=x(a),arguments.length===2)po(n,function(nt){return Z(a,nt)!==-1});else for(var R=0,$=a.length;R<$;R++)ps(n,a[R],c,_);return this}function po(n,a){for(var c in n[hi]){var _=c.split(/\d/)[0];(!a||a(_))&&ps(n,_,null,null,c)}}var Wn={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function ds(n,a,c,_){var T=a+u(c)+(_?"_"+u(_):"");if(n[hi]&&n[hi][T])return this;var R=function(nt){return c.call(_||n,nt||window.event)},$=R;!At.touchNative&&At.pointer&&a.indexOf("touch")===0?R=Ha(n,a,R):At.touch&&a==="dblclick"?R=Ya(n,R):"addEventListener"in n?a==="touchstart"||a==="touchmove"||a==="wheel"||a==="mousewheel"?n.addEventListener(Wn[a]||a,R,At.passiveEvents?{passive:!1}:!1):a==="mouseenter"||a==="mouseleave"?(R=function(nt){nt=nt||window.event,_s(n,nt)&&$(nt)},n.addEventListener(Wn[a],R,!1)):n.addEventListener(a,$,!1):n.attachEvent("on"+a,R),n[hi]=n[hi]||{},n[hi][T]=R}function ps(n,a,c,_,T){T=T||a+u(c)+(_?"_"+u(_):"");var R=n[hi]&&n[hi][T];if(!R)return this;!At.touchNative&&At.pointer&&a.indexOf("touch")===0?Wa(n,a,R):At.touch&&a==="dblclick"?ja(n,R):"removeEventListener"in n?n.removeEventListener(Wn[a]||a,R,!1):n.detachEvent("on"+a,R),n[hi][T]=null}function ji(n){return n.stopPropagation?n.stopPropagation():n.originalEvent?n.originalEvent._stopped=!0:n.cancelBubble=!0,this}function ms(n){return ds(n,"wheel",ji),this}function mn(n){return Rt(n,"mousedown touchstart dblclick contextmenu",ji),n._leaflet_disable_click=!0,this}function be(n){return n.preventDefault?n.preventDefault():n.returnValue=!1,this}function Di(n){return be(n),ji(n),this}function mo(n){if(n.composedPath)return n.composedPath();for(var a=[],c=n.target;c;)a.push(c),c=c.parentNode;return a}function _o(n,a){if(!a)return new W(n.clientX,n.clientY);var c=fs(a),_=c.boundingClientRect;return new W((n.clientX-_.left)/c.x-a.clientLeft,(n.clientY-_.top)/c.y-a.clientTop)}var go=At.linux&&At.chrome?window.devicePixelRatio:At.mac?window.devicePixelRatio*3:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function yo(n){return At.edge?n.wheelDeltaY/2:n.deltaY&&n.deltaMode===0?-n.deltaY/go:n.deltaY&&n.deltaMode===1?-n.deltaY*20:n.deltaY&&n.deltaMode===2?-n.deltaY*60:n.deltaX||n.deltaZ?0:n.wheelDelta?(n.wheelDeltaY||n.wheelDelta)/2:n.detail&&Math.abs(n.detail)<32765?-n.detail*20:n.detail?n.detail/-32765*60:0}function _s(n,a){var c=a.relatedTarget;if(!c)return!0;try{for(;c&&c!==n;)c=c.parentNode}catch{return!1}return c!==n}var $a={__proto__:null,on:Rt,off:Kt,stopPropagation:ji,disableScrollPropagation:ms,disableClickPropagation:mn,preventDefault:be,stop:Di,getPropagationPath:mo,getMousePosition:_o,getWheelDelta:yo,isExternalTarget:_s,addListener:Rt,removeListener:Kt},vo=G.extend({run:function(n,a,c,_){this.stop(),this._el=n,this._inProgress=!0,this._duration=c||.25,this._easeOutPower=1/Math.max(_||.5,.2),this._startPos=qi(n),this._offset=a.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=N(this._animate,this),this._step()},_step:function(n){var a=+new Date-this._startTime,c=this._duration*1e3;a<c?this._runFrame(this._easeOut(a/c),n):(this._runFrame(1),this._complete())},_runFrame:function(n,a){var c=this._startPos.add(this._offset.multiplyBy(n));a&&c._round(),ue(this._el,c),this.fire("step")},_complete:function(){E(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(n){return 1-Math.pow(1-n,this._easeOutPower)}}),Vt=G.extend({options:{crs:ft,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(n,a){a=v(this,a),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(n),this._initLayout(),this._onResize=o(this._onResize,this),this._initEvents(),a.maxBounds&&this.setMaxBounds(a.maxBounds),a.zoom!==void 0&&(this._zoom=this._limitZoom(a.zoom)),a.center&&a.zoom!==void 0&&this.setView(mt(a.center),a.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=Fn&&At.any3d&&!At.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),Rt(this._proxy,co,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(n,a,c){if(a=a===void 0?this._zoom:this._limitZoom(a),n=this._limitCenter(mt(n),a,this.options.maxBounds),c=c||{},this._stop(),this._loaded&&!c.reset&&c!==!0){c.animate!==void 0&&(c.zoom=i({animate:c.animate},c.zoom),c.pan=i({animate:c.animate,duration:c.duration},c.pan));var _=this._zoom!==a?this._tryAnimatedZoom&&this._tryAnimatedZoom(n,a,c.zoom):this._tryAnimatedPan(n,c.pan);if(_)return clearTimeout(this._sizeTimer),this}return this._resetView(n,a,c.pan&&c.pan.noMoveStart),this},setZoom:function(n,a){return this._loaded?this.setView(this.getCenter(),n,{zoom:a}):(this._zoom=n,this)},zoomIn:function(n,a){return n=n||(At.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+n,a)},zoomOut:function(n,a){return n=n||(At.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-n,a)},setZoomAround:function(n,a,c){var _=this.getZoomScale(a),T=this.getSize().divideBy(2),R=n instanceof W?n:this.latLngToContainerPoint(n),$=R.subtract(T).multiplyBy(1-1/_),nt=this.containerPointToLatLng(T.add($));return this.setView(nt,a,{zoom:c})},_getBoundsCenterZoom:function(n,a){a=a||{},n=n.getBounds?n.getBounds():ct(n);var c=tt(a.paddingTopLeft||a.padding||[0,0]),_=tt(a.paddingBottomRight||a.padding||[0,0]),T=this.getBoundsZoom(n,!1,c.add(_));if(T=typeof a.maxZoom=="number"?Math.min(a.maxZoom,T):T,T===1/0)return{center:n.getCenter(),zoom:T};var R=_.subtract(c).divideBy(2),$=this.project(n.getSouthWest(),T),nt=this.project(n.getNorthEast(),T),st=this.unproject($.add(nt).divideBy(2).add(R),T);return{center:st,zoom:T}},fitBounds:function(n,a){if(n=ct(n),!n.isValid())throw new Error("Bounds are not valid.");var c=this._getBoundsCenterZoom(n,a);return this.setView(c.center,c.zoom,a)},fitWorld:function(n){return this.fitBounds([[-90,-180],[90,180]],n)},panTo:function(n,a){return this.setView(n,this._zoom,{pan:a})},panBy:function(n,a){if(n=tt(n).round(),a=a||{},!n.x&&!n.y)return this.fire("moveend");if(a.animate!==!0&&!this.getSize().contains(n))return this._resetView(this.unproject(this.project(this.getCenter()).add(n)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new vo,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),a.noMoveStart||this.fire("movestart"),a.animate!==!1){Ft(this._mapPane,"leaflet-pan-anim");var c=this._getMapPanePos().subtract(n).round();this._panAnim.run(this._mapPane,c,a.duration||.25,a.easeLinearity)}else this._rawPanBy(n),this.fire("move").fire("moveend");return this},flyTo:function(n,a,c){if(c=c||{},c.animate===!1||!At.any3d)return this.setView(n,a,c);this._stop();var _=this.project(this.getCenter()),T=this.project(n),R=this.getSize(),$=this._zoom;n=mt(n),a=a===void 0?$:a;var nt=Math.max(R.x,R.y),st=nt*this.getZoomScale($,a),pt=T.distanceTo(_)||1,Mt=1.42,It=Mt*Mt;function Gt(_e){var Fo=_e?-1:1,xf=_e?st:nt,wf=st*st-nt*nt+Fo*It*It*pt*pt,bf=2*xf*It*pt,rh=wf/bf,Zl=Math.sqrt(rh*rh+1)-rh,Lf=Zl<1e-9?-18:Math.log(Zl);return Lf}function De(_e){return(Math.exp(_e)-Math.exp(-_e))/2}function Ee(_e){return(Math.exp(_e)+Math.exp(-_e))/2}function fi(_e){return De(_e)/Ee(_e)}var Ge=Gt(0);function Ar(_e){return nt*(Ee(Ge)/Ee(Ge+Mt*_e))}function _f(_e){return nt*(Ee(Ge)*fi(Ge+Mt*_e)-De(Ge))/It}function gf(_e){return 1-Math.pow(1-_e,1.5)}var yf=Date.now(),Fl=(Gt(1)-Ge)/Mt,vf=c.duration?1e3*c.duration:1e3*Fl*.8;function Ul(){var _e=(Date.now()-yf)/vf,Fo=gf(_e)*Fl;_e<=1?(this._flyToFrame=N(Ul,this),this._move(this.unproject(_.add(T.subtract(_).multiplyBy(_f(Fo)/pt)),$),this.getScaleZoom(nt/Ar(Fo),$),{flyTo:!0})):this._move(n,a)._moveEnd(!0)}return this._moveStart(!0,c.noMoveStart),Ul.call(this),this},flyToBounds:function(n,a){var c=this._getBoundsCenterZoom(n,a);return this.flyTo(c.center,c.zoom,a)},setMaxBounds:function(n){return n=ct(n),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),n.isValid()?(this.options.maxBounds=n,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(n){var a=this.options.minZoom;return this.options.minZoom=n,this._loaded&&a!==n&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(n):this},setMaxZoom:function(n){var a=this.options.maxZoom;return this.options.maxZoom=n,this._loaded&&a!==n&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(n):this},panInsideBounds:function(n,a){this._enforcingBounds=!0;var c=this.getCenter(),_=this._limitCenter(c,this._zoom,ct(n));return c.equals(_)||this.panTo(_,a),this._enforcingBounds=!1,this},panInside:function(n,a){a=a||{};var c=tt(a.paddingTopLeft||a.padding||[0,0]),_=tt(a.paddingBottomRight||a.padding||[0,0]),T=this.project(this.getCenter()),R=this.project(n),$=this.getPixelBounds(),nt=Q([$.min.add(c),$.max.subtract(_)]),st=nt.getSize();if(!nt.contains(R)){this._enforcingBounds=!0;var pt=R.subtract(nt.getCenter()),Mt=nt.extend(R).getSize().subtract(st);T.x+=pt.x<0?-Mt.x:Mt.x,T.y+=pt.y<0?-Mt.y:Mt.y,this.panTo(this.unproject(T),a),this._enforcingBounds=!1}return this},invalidateSize:function(n){if(!this._loaded)return this;n=i({animate:!1,pan:!0},n===!0?{animate:!0}:n);var a=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var c=this.getSize(),_=a.divideBy(2).round(),T=c.divideBy(2).round(),R=_.subtract(T);return!R.x&&!R.y?this:(n.animate&&n.pan?this.panBy(R):(n.pan&&this._rawPanBy(R),this.fire("move"),n.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(o(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:a,newSize:c}))},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(n){if(n=this._locateOptions=i({timeout:1e4,watch:!1},n),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var a=o(this._handleGeolocationResponse,this),c=o(this._handleGeolocationError,this);return n.watch?this._locationWatchId=navigator.geolocation.watchPosition(a,c,n):navigator.geolocation.getCurrentPosition(a,c,n),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(n){if(this._container._leaflet_id){var a=n.code,c=n.message||(a===1?"permission denied":a===2?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:a,message:"Geolocation error: "+c+"."})}},_handleGeolocationResponse:function(n){if(this._container._leaflet_id){var a=n.coords.latitude,c=n.coords.longitude,_=new rt(a,c),T=_.toBounds(n.coords.accuracy*2),R=this._locateOptions;if(R.setView){var $=this.getBoundsZoom(T);this.setView(_,R.maxZoom?Math.min($,R.maxZoom):$)}var nt={latlng:_,bounds:T,timestamp:n.timestamp};for(var st in n.coords)typeof n.coords[st]=="number"&&(nt[st]=n.coords[st]);this.fire("locationfound",nt)}},addHandler:function(n,a){if(!a)return this;var c=this[n]=new a(this);return this._handlers.push(c),this.options[n]&&c.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch{this._container._leaflet_id=void 0,this._containerId=void 0}this._locationWatchId!==void 0&&this.stopLocate(),this._stop(),re(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(E(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload");var n;for(n in this._layers)this._layers[n].remove();for(n in this._panes)re(this._panes[n]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(n,a){var c="leaflet-pane"+(n?" leaflet-"+n.replace("Pane","")+"-pane":""),_=jt("div",c,a||this._mapPane);return n&&(this._panes[n]=_),_},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var n=this.getPixelBounds(),a=this.unproject(n.getBottomLeft()),c=this.unproject(n.getTopRight());return new dt(a,c)},getMinZoom:function(){return this.options.minZoom===void 0?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===void 0?this._layersMaxZoom===void 0?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(n,a,c){n=ct(n),c=tt(c||[0,0]);var _=this.getZoom()||0,T=this.getMinZoom(),R=this.getMaxZoom(),$=n.getNorthWest(),nt=n.getSouthEast(),st=this.getSize().subtract(c),pt=Q(this.project(nt,_),this.project($,_)).getSize(),Mt=At.any3d?this.options.zoomSnap:1,It=st.x/pt.x,Gt=st.y/pt.y,De=a?Math.max(It,Gt):Math.min(It,Gt);return _=this.getScaleZoom(De,_),Mt&&(_=Math.round(_/(Mt/100))*(Mt/100),_=a?Math.ceil(_/Mt)*Mt:Math.floor(_/Mt)*Mt),Math.max(T,Math.min(R,_))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new W(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(n,a){var c=this._getTopLeftPoint(n,a);return new q(c,c.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(n){return this.options.crs.getProjectedBounds(n===void 0?this.getZoom():n)},getPane:function(n){return typeof n=="string"?this._panes[n]:n},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(n,a){var c=this.options.crs;return a=a===void 0?this._zoom:a,c.scale(n)/c.scale(a)},getScaleZoom:function(n,a){var c=this.options.crs;a=a===void 0?this._zoom:a;var _=c.zoom(n*c.scale(a));return isNaN(_)?1/0:_},project:function(n,a){return a=a===void 0?this._zoom:a,this.options.crs.latLngToPoint(mt(n),a)},unproject:function(n,a){return a=a===void 0?this._zoom:a,this.options.crs.pointToLatLng(tt(n),a)},layerPointToLatLng:function(n){var a=tt(n).add(this.getPixelOrigin());return this.unproject(a)},latLngToLayerPoint:function(n){var a=this.project(mt(n))._round();return a._subtract(this.getPixelOrigin())},wrapLatLng:function(n){return this.options.crs.wrapLatLng(mt(n))},wrapLatLngBounds:function(n){return this.options.crs.wrapLatLngBounds(ct(n))},distance:function(n,a){return this.options.crs.distance(mt(n),mt(a))},containerPointToLayerPoint:function(n){return tt(n).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(n){return tt(n).add(this._getMapPanePos())},containerPointToLatLng:function(n){var a=this.containerPointToLayerPoint(tt(n));return this.layerPointToLatLng(a)},latLngToContainerPoint:function(n){return this.layerPointToContainerPoint(this.latLngToLayerPoint(mt(n)))},mouseEventToContainerPoint:function(n){return _o(n,this._container)},mouseEventToLayerPoint:function(n){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(n))},mouseEventToLatLng:function(n){return this.layerPointToLatLng(this.mouseEventToLayerPoint(n))},_initContainer:function(n){var a=this._container=ai(n);if(a){if(a._leaflet_id)throw new Error("Map container is already initialized.")}else throw new Error("Map container not found.");Rt(a,"scroll",this._onScroll,this),this._containerId=u(a)},_initLayout:function(){var n=this._container;this._fadeAnimated=this.options.fadeAnimation&&At.any3d,Ft(n,"leaflet-container"+(At.touch?" leaflet-touch":"")+(At.retina?" leaflet-retina":"")+(At.ielt9?" leaflet-oldie":"")+(At.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var a=Un(n,"position");a!=="absolute"&&a!=="relative"&&a!=="fixed"&&a!=="sticky"&&(n.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var n=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),ue(this._mapPane,new W(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(Ft(n.markerPane,"leaflet-zoom-hide"),Ft(n.shadowPane,"leaflet-zoom-hide"))},_resetView:function(n,a,c){ue(this._mapPane,new W(0,0));var _=!this._loaded;this._loaded=!0,a=this._limitZoom(a),this.fire("viewprereset");var T=this._zoom!==a;this._moveStart(T,c)._move(n,a)._moveEnd(T),this.fire("viewreset"),_&&this.fire("load")},_moveStart:function(n,a){return n&&this.fire("zoomstart"),a||this.fire("movestart"),this},_move:function(n,a,c,_){a===void 0&&(a=this._zoom);var T=this._zoom!==a;return this._zoom=a,this._lastCenter=n,this._pixelOrigin=this._getNewPixelOrigin(n),_?c&&c.pinch&&this.fire("zoom",c):((T||c&&c.pinch)&&this.fire("zoom",c),this.fire("move",c)),this},_moveEnd:function(n){return n&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return E(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(n){ue(this._mapPane,this._getMapPanePos().subtract(n))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(n){this._targets={},this._targets[u(this._container)]=this;var a=n?Kt:Rt;a(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&a(window,"resize",this._onResize,this),At.any3d&&this.options.transform3DLimit&&(n?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){E(this._resizeRequest),this._resizeRequest=N(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var n=this._getMapPanePos();Math.max(Math.abs(n.x),Math.abs(n.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(n,a){for(var c=[],_,T=a==="mouseout"||a==="mouseover",R=n.target||n.srcElement,$=!1;R;){if(_=this._targets[u(R)],_&&(a==="click"||a==="preclick")&&this._draggableMoved(_)){$=!0;break}if(_&&_.listens(a,!0)&&(T&&!_s(R,n)||(c.push(_),T))||R===this._container)break;R=R.parentNode}return!c.length&&!$&&!T&&this.listens(a,!0)&&(c=[this]),c},_isClickDisabled:function(n){for(;n&&n!==this._container;){if(n._leaflet_disable_click)return!0;n=n.parentNode}},_handleDOMEvent:function(n){var a=n.target||n.srcElement;if(!(!this._loaded||a._leaflet_disable_events||n.type==="click"&&this._isClickDisabled(a))){var c=n.type;c==="mousedown"&&Ri(a),this._fireDOMEvent(n,c)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(n,a,c){if(n.type==="click"){var _=i({},n);_.type="preclick",this._fireDOMEvent(_,_.type,c)}var T=this._findEventTargets(n,a);if(c){for(var R=[],$=0;$<c.length;$++)c[$].listens(a,!0)&&R.push(c[$]);T=R.concat(T)}if(T.length){a==="contextmenu"&&be(n);var nt=T[0],st={originalEvent:n};if(n.type!=="keypress"&&n.type!=="keydown"&&n.type!=="keyup"){var pt=nt.getLatLng&&(!nt._radius||nt._radius<=10);st.containerPoint=pt?this.latLngToContainerPoint(nt.getLatLng()):this.mouseEventToContainerPoint(n),st.layerPoint=this.containerPointToLayerPoint(st.containerPoint),st.latlng=pt?nt.getLatLng():this.layerPointToLatLng(st.layerPoint)}for($=0;$<T.length;$++)if(T[$].fire(a,st,!0),st.originalEvent._stopped||T[$].options.bubblingMouseEvents===!1&&Z(this._mouseEvents,a)!==-1)return}},_draggableMoved:function(n){return n=n.dragging&&n.dragging.enabled()?n:this,n.dragging&&n.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var n=0,a=this._handlers.length;n<a;n++)this._handlers[n].disable()},whenReady:function(n,a){return this._loaded?n.call(a||this,{target:this}):this.on("load",n,a),this},_getMapPanePos:function(){return qi(this._mapPane)||new W(0,0)},_moved:function(){var n=this._getMapPanePos();return n&&!n.equals([0,0])},_getTopLeftPoint:function(n,a){var c=n&&a!==void 0?this._getNewPixelOrigin(n,a):this.getPixelOrigin();return c.subtract(this._getMapPanePos())},_getNewPixelOrigin:function(n,a){var c=this.getSize()._divideBy(2);return this.project(n,a)._subtract(c)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(n,a,c){var _=this._getNewPixelOrigin(c,a);return this.project(n,a)._subtract(_)},_latLngBoundsToNewLayerBounds:function(n,a,c){var _=this._getNewPixelOrigin(c,a);return Q([this.project(n.getSouthWest(),a)._subtract(_),this.project(n.getNorthWest(),a)._subtract(_),this.project(n.getSouthEast(),a)._subtract(_),this.project(n.getNorthEast(),a)._subtract(_)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(n){return this.latLngToLayerPoint(n).subtract(this._getCenterLayerPoint())},_limitCenter:function(n,a,c){if(!c)return n;var _=this.project(n,a),T=this.getSize().divideBy(2),R=new q(_.subtract(T),_.add(T)),$=this._getBoundsOffset(R,c,a);return Math.abs($.x)<=1&&Math.abs($.y)<=1?n:this.unproject(_.add($),a)},_limitOffset:function(n,a){if(!a)return n;var c=this.getPixelBounds(),_=new q(c.min.add(n),c.max.add(n));return n.add(this._getBoundsOffset(_,a))},_getBoundsOffset:function(n,a,c){var _=Q(this.project(a.getNorthEast(),c),this.project(a.getSouthWest(),c)),T=_.min.subtract(n.min),R=_.max.subtract(n.max),$=this._rebound(T.x,-R.x),nt=this._rebound(T.y,-R.y);return new W($,nt)},_rebound:function(n,a){return n+a>0?Math.round(n-a)/2:Math.max(0,Math.ceil(n))-Math.max(0,Math.floor(a))},_limitZoom:function(n){var a=this.getMinZoom(),c=this.getMaxZoom(),_=At.any3d?this.options.zoomSnap:1;return _&&(n=Math.round(n/_)*_),Math.max(a,Math.min(c,n))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){ae(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(n,a){var c=this._getCenterOffset(n)._trunc();return(a&&a.animate)!==!0&&!this.getSize().contains(c)?!1:(this.panBy(c,a),!0)},_createAnimProxy:function(){var n=this._proxy=jt("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(n),this.on("zoomanim",function(a){var c=as,_=this._proxy.style[c];we(this._proxy,this.project(a.center,a.zoom),this.getZoomScale(a.zoom,1)),_===this._proxy.style[c]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){re(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var n=this.getCenter(),a=this.getZoom();we(this._proxy,this.project(n,a),this.getZoomScale(a,1))},_catchTransitionEnd:function(n){this._animatingZoom&&n.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(n,a,c){if(this._animatingZoom)return!0;if(c=c||{},!this._zoomAnimated||c.animate===!1||this._nothingToAnimate()||Math.abs(a-this._zoom)>this.options.zoomAnimationThreshold)return!1;var _=this.getZoomScale(a),T=this._getCenterOffset(n)._divideBy(1-1/_);return c.animate!==!0&&!this.getSize().contains(T)?!1:(N(function(){this._moveStart(!0,c.noMoveStart||!1)._animateZoom(n,a,!0)},this),!0)},_animateZoom:function(n,a,c,_){this._mapPane&&(c&&(this._animatingZoom=!0,this._animateToCenter=n,this._animateToZoom=a,Ft(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:n,zoom:a,noUpdate:_}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(o(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&ae(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});function Ka(n,a){return new Vt(n,a)}var Re=y.extend({options:{position:"topright"},initialize:function(n){v(this,n)},getPosition:function(){return this.options.position},setPosition:function(n){var a=this._map;return a&&a.removeControl(this),this.options.position=n,a&&a.addControl(this),this},getContainer:function(){return this._container},addTo:function(n){this.remove(),this._map=n;var a=this._container=this.onAdd(n),c=this.getPosition(),_=n._controlCorners[c];return Ft(a,"leaflet-control"),c.indexOf("bottom")!==-1?_.insertBefore(a,_.firstChild):_.appendChild(a),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(re(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(n){this._map&&n&&n.screenX>0&&n.screenY>0&&this._map.getContainer().focus()}}),Vn=function(n){return new Re(n)};Vt.include({addControl:function(n){return n.addTo(this),this},removeControl:function(n){return n.remove(),this},_initControlPos:function(){var n=this._controlCorners={},a="leaflet-",c=this._controlContainer=jt("div",a+"control-container",this._container);function _(T,R){var $=a+T+" "+a+R;n[T+R]=jt("div",$,c)}_("top","left"),_("top","right"),_("bottom","left"),_("bottom","right")},_clearControlPos:function(){for(var n in this._controlCorners)re(this._controlCorners[n]);re(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var xo=Re.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(n,a,c,_){return c<_?-1:_<c?1:0}},initialize:function(n,a,c){v(this,c),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._preventClick=!1;for(var _ in n)this._addLayer(n[_],_);for(_ in a)this._addLayer(a[_],_,!0)},onAdd:function(n){this._initLayout(),this._update(),this._map=n,n.on("zoomend",this._checkDisabledLayers,this);for(var a=0;a<this._layers.length;a++)this._layers[a].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(n){return Re.prototype.addTo.call(this,n),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var n=0;n<this._layers.length;n++)this._layers[n].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(n,a){return this._addLayer(n,a),this._map?this._update():this},addOverlay:function(n,a){return this._addLayer(n,a,!0),this._map?this._update():this},removeLayer:function(n){n.off("add remove",this._onLayerChange,this);var a=this._getLayer(u(n));return a&&this._layers.splice(this._layers.indexOf(a),1),this._map?this._update():this},expand:function(){Ft(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var n=this._map.getSize().y-(this._container.offsetTop+50);return n<this._section.clientHeight?(Ft(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=n+"px"):ae(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return ae(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var n="leaflet-control-layers",a=this._container=jt("div",n),c=this.options.collapsed;a.setAttribute("aria-haspopup",!0),mn(a),ms(a);var _=this._section=jt("section",n+"-list");c&&(this._map.on("click",this.collapse,this),Rt(a,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var T=this._layersLink=jt("a",n+"-toggle",a);T.href="#",T.title="Layers",T.setAttribute("role","button"),Rt(T,{keydown:function(R){R.keyCode===13&&this._expandSafely()},click:function(R){be(R),this._expandSafely()}},this),c||this.expand(),this._baseLayersList=jt("div",n+"-base",_),this._separator=jt("div",n+"-separator",_),this._overlaysList=jt("div",n+"-overlays",_),a.appendChild(_)},_getLayer:function(n){for(var a=0;a<this._layers.length;a++)if(this._layers[a]&&u(this._layers[a].layer)===n)return this._layers[a]},_addLayer:function(n,a,c){this._map&&n.on("add remove",this._onLayerChange,this),this._layers.push({layer:n,name:a,overlay:c}),this.options.sortLayers&&this._layers.sort(o(function(_,T){return this.options.sortFunction(_.layer,T.layer,_.name,T.name)},this)),this.options.autoZIndex&&n.setZIndex&&(this._lastZIndex++,n.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;gr(this._baseLayersList),gr(this._overlaysList),this._layerControlInputs=[];var n,a,c,_,T=0;for(c=0;c<this._layers.length;c++)_=this._layers[c],this._addItem(_),a=a||_.overlay,n=n||!_.overlay,T+=_.overlay?0:1;return this.options.hideSingleBase&&(n=n&&T>1,this._baseLayersList.style.display=n?"":"none"),this._separator.style.display=a&&n?"":"none",this},_onLayerChange:function(n){this._handlingClick||this._update();var a=this._getLayer(u(n.target)),c=a.overlay?n.type==="add"?"overlayadd":"overlayremove":n.type==="add"?"baselayerchange":null;c&&this._map.fire(c,a)},_createRadioElement:function(n,a){var c='<input type="radio" class="leaflet-control-layers-selector" name="'+n+'"'+(a?' checked="checked"':"")+"/>",_=document.createElement("div");return _.innerHTML=c,_.firstChild},_addItem:function(n){var a=document.createElement("label"),c=this._map.hasLayer(n.layer),_;n.overlay?(_=document.createElement("input"),_.type="checkbox",_.className="leaflet-control-layers-selector",_.defaultChecked=c):_=this._createRadioElement("leaflet-base-layers_"+u(this),c),this._layerControlInputs.push(_),_.layerId=u(n.layer),Rt(_,"click",this._onInputClick,this);var T=document.createElement("span");T.innerHTML=" "+n.name;var R=document.createElement("span");a.appendChild(R),R.appendChild(_),R.appendChild(T);var $=n.overlay?this._overlaysList:this._baseLayersList;return $.appendChild(a),this._checkDisabledLayers(),a},_onInputClick:function(){if(!this._preventClick){var n=this._layerControlInputs,a,c,_=[],T=[];this._handlingClick=!0;for(var R=n.length-1;R>=0;R--)a=n[R],c=this._getLayer(a.layerId).layer,a.checked?_.push(c):a.checked||T.push(c);for(R=0;R<T.length;R++)this._map.hasLayer(T[R])&&this._map.removeLayer(T[R]);for(R=0;R<_.length;R++)this._map.hasLayer(_[R])||this._map.addLayer(_[R]);this._handlingClick=!1,this._refocusOnMap()}},_checkDisabledLayers:function(){for(var n=this._layerControlInputs,a,c,_=this._map.getZoom(),T=n.length-1;T>=0;T--)a=n[T],c=this._getLayer(a.layerId).layer,a.disabled=c.options.minZoom!==void 0&&_<c.options.minZoom||c.options.maxZoom!==void 0&&_>c.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var n=this._section;this._preventClick=!0,Rt(n,"click",be),this.expand();var a=this;setTimeout(function(){Kt(n,"click",be),a._preventClick=!1})}}),Qa=function(n,a,c){return new xo(n,a,c)},gs=Re.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(n){var a="leaflet-control-zoom",c=jt("div",a+" leaflet-bar"),_=this.options;return this._zoomInButton=this._createButton(_.zoomInText,_.zoomInTitle,a+"-in",c,this._zoomIn),this._zoomOutButton=this._createButton(_.zoomOutText,_.zoomOutTitle,a+"-out",c,this._zoomOut),this._updateDisabled(),n.on("zoomend zoomlevelschange",this._updateDisabled,this),c},onRemove:function(n){n.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(n){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(n.shiftKey?3:1))},_zoomOut:function(n){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(n.shiftKey?3:1))},_createButton:function(n,a,c,_,T){var R=jt("a",c,_);return R.innerHTML=n,R.href="#",R.title=a,R.setAttribute("role","button"),R.setAttribute("aria-label",a),mn(R),Rt(R,"click",Di),Rt(R,"click",T,this),Rt(R,"click",this._refocusOnMap,this),R},_updateDisabled:function(){var n=this._map,a="leaflet-disabled";ae(this._zoomInButton,a),ae(this._zoomOutButton,a),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||n._zoom===n.getMinZoom())&&(Ft(this._zoomOutButton,a),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||n._zoom===n.getMaxZoom())&&(Ft(this._zoomInButton,a),this._zoomInButton.setAttribute("aria-disabled","true"))}});Vt.mergeOptions({zoomControl:!0}),Vt.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new gs,this.addControl(this.zoomControl))});var th=function(n){return new gs(n)},wo=Re.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(n){var a="leaflet-control-scale",c=jt("div",a),_=this.options;return this._addScales(_,a+"-line",c),n.on(_.updateWhenIdle?"moveend":"move",this._update,this),n.whenReady(this._update,this),c},onRemove:function(n){n.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(n,a,c){n.metric&&(this._mScale=jt("div",a,c)),n.imperial&&(this._iScale=jt("div",a,c))},_update:function(){var n=this._map,a=n.getSize().y/2,c=n.distance(n.containerPointToLatLng([0,a]),n.containerPointToLatLng([this.options.maxWidth,a]));this._updateScales(c)},_updateScales:function(n){this.options.metric&&n&&this._updateMetric(n),this.options.imperial&&n&&this._updateImperial(n)},_updateMetric:function(n){var a=this._getRoundNum(n),c=a<1e3?a+" m":a/1e3+" km";this._updateScale(this._mScale,c,a/n)},_updateImperial:function(n){var a=n*3.2808399,c,_,T;a>5280?(c=a/5280,_=this._getRoundNum(c),this._updateScale(this._iScale,_+" mi",_/c)):(T=this._getRoundNum(a),this._updateScale(this._iScale,T+" ft",T/a))},_updateScale:function(n,a,c){n.style.width=Math.round(this.options.maxWidth*c)+"px",n.innerHTML=a},_getRoundNum:function(n){var a=Math.pow(10,(Math.floor(n)+"").length-1),c=n/a;return c=c>=10?10:c>=5?5:c>=3?3:c>=2?2:1,a*c}}),bo=function(n){return new wo(n)},ys='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg>',vs=Re.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(At.inlineSvg?ys+" ":"")+"Leaflet</a>"},initialize:function(n){v(this,n),this._attributions={}},onAdd:function(n){n.attributionControl=this,this._container=jt("div","leaflet-control-attribution"),mn(this._container);for(var a in n._layers)n._layers[a].getAttribution&&this.addAttribution(n._layers[a].getAttribution());return this._update(),n.on("layeradd",this._addAttribution,this),this._container},onRemove:function(n){n.off("layeradd",this._addAttribution,this)},_addAttribution:function(n){n.layer.getAttribution&&(this.addAttribution(n.layer.getAttribution()),n.layer.once("remove",function(){this.removeAttribution(n.layer.getAttribution())},this))},setPrefix:function(n){return this.options.prefix=n,this._update(),this},addAttribution:function(n){return n?(this._attributions[n]||(this._attributions[n]=0),this._attributions[n]++,this._update(),this):this},removeAttribution:function(n){return n?(this._attributions[n]&&(this._attributions[n]--,this._update()),this):this},_update:function(){if(this._map){var n=[];for(var a in this._attributions)this._attributions[a]&&n.push(a);var c=[];this.options.prefix&&c.push(this.options.prefix),n.length&&c.push(n.join(", ")),this._container.innerHTML=c.join(' <span aria-hidden="true">|</span> ')}}});Vt.mergeOptions({attributionControl:!0}),Vt.addInitHook(function(){this.options.attributionControl&&new vs().addTo(this)});var eh=function(n){return new vs(n)};Re.Layers=xo,Re.Zoom=gs,Re.Scale=wo,Re.Attribution=vs,Vn.layers=Qa,Vn.zoom=th,Vn.scale=bo,Vn.attribution=eh;var li=y.extend({initialize:function(n){this._map=n},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});li.addTo=function(n,a){return n.addHandler(a,this),this};var ih={Events:H},xs=At.touch?"touchstart mousedown":"mousedown",Bi=G.extend({options:{clickTolerance:3},initialize:function(n,a,c,_){v(this,_),this._element=n,this._dragStartTarget=a||n,this._preventOutline=c},enable:function(){this._enabled||(Rt(this._dragStartTarget,xs,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(Bi._dragging===this&&this.finishDrag(!0),Kt(this._dragStartTarget,xs,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(n){if(this._enabled&&(this._moved=!1,!hs(this._element,"leaflet-zoom-anim"))){if(n.touches&&n.touches.length!==1){Bi._dragging===this&&this.finishDrag();return}if(!(Bi._dragging||n.shiftKey||n.which!==1&&n.button!==1&&!n.touches)&&(Bi._dragging=this,this._preventOutline&&Ri(this._element),Hn(),Zn(),!this._moving)){this.fire("down");var a=n.touches?n.touches[0]:n,c=fo(this._element);this._startPoint=new W(a.clientX,a.clientY),this._startPos=qi(this._element),this._parentScale=fs(c);var _=n.type==="mousedown";Rt(document,_?"mousemove":"touchmove",this._onMove,this),Rt(document,_?"mouseup":"touchend touchcancel",this._onUp,this)}}},_onMove:function(n){if(this._enabled){if(n.touches&&n.touches.length>1){this._moved=!0;return}var a=n.touches&&n.touches.length===1?n.touches[0]:n,c=new W(a.clientX,a.clientY)._subtract(this._startPoint);!c.x&&!c.y||Math.abs(c.x)+Math.abs(c.y)<this.options.clickTolerance||(c.x/=this._parentScale.x,c.y/=this._parentScale.y,be(n),this._moved||(this.fire("dragstart"),this._moved=!0,Ft(document.body,"leaflet-dragging"),this._lastTarget=n.target||n.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),Ft(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(c),this._moving=!0,this._lastEvent=n,this._updatePosition())}},_updatePosition:function(){var n={originalEvent:this._lastEvent};this.fire("predrag",n),ue(this._element,this._newPos),this.fire("drag",n)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(n){ae(document.body,"leaflet-dragging"),this._lastTarget&&(ae(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),Kt(document,"mousemove touchmove",this._onMove,this),Kt(document,"mouseup touchend touchcancel",this._onUp,this),xr(),Gn();var a=this._moved&&this._moving;this._moving=!1,Bi._dragging=!1,a&&this.fire("dragend",{noInertia:n,distance:this._newPos.distanceTo(this._startPos)})}});function Lo(n,a,c){var _,T=[1,4,2,8],R,$,nt,st,pt,Mt,It,Gt;for(R=0,Mt=n.length;R<Mt;R++)n[R]._code=Ji(n[R],a);for(nt=0;nt<4;nt++){for(It=T[nt],_=[],R=0,Mt=n.length,$=Mt-1;R<Mt;$=R++)st=n[R],pt=n[$],st._code&It?pt._code&It||(Gt=_n(pt,st,It,a,c),Gt._code=Ji(Gt,a),_.push(Gt)):(pt._code&It&&(Gt=_n(pt,st,It,a,c),Gt._code=Ji(Gt,a),_.push(Gt)),_.push(st));n=_}return n}function Mo(n,a){var c,_,T,R,$,nt,st,pt,Mt;if(!n||n.length===0)throw new Error("latlngs not passed");Ue(n)||(console.warn("latlngs are not flat! Only the first ring will be used"),n=n[0]);var It=mt([0,0]),Gt=ct(n),De=Gt.getNorthWest().distanceTo(Gt.getSouthWest())*Gt.getNorthEast().distanceTo(Gt.getNorthWest());De<1700&&(It=ws(n));var Ee=n.length,fi=[];for(c=0;c<Ee;c++){var Ge=mt(n[c]);fi.push(a.project(mt([Ge.lat-It.lat,Ge.lng-It.lng])))}for(nt=st=pt=0,c=0,_=Ee-1;c<Ee;_=c++)T=fi[c],R=fi[_],$=T.y*R.x-R.y*T.x,st+=(T.x+R.x)*$,pt+=(T.y+R.y)*$,nt+=$*3;nt===0?Mt=fi[0]:Mt=[st/nt,pt/nt];var Ar=a.unproject(tt(Mt));return mt([Ar.lat+It.lat,Ar.lng+It.lng])}function ws(n){for(var a=0,c=0,_=0,T=0;T<n.length;T++){var R=mt(n[T]);a+=R.lat,c+=R.lng,_++}return mt([a/_,c/_])}var br={__proto__:null,clipPolygon:Lo,polygonCenter:Mo,centroid:ws};function Eo(n,a){if(!a||!n.length)return n.slice();var c=a*a;return n=nh(n,c),n=ui(n,c),n}function Xi(n,a,c){return Math.sqrt(qn(n,a,c,!0))}function To(n,a,c){return qn(n,a,c)}function ui(n,a){var c=n.length,_=typeof Uint8Array<"u"?Uint8Array:Array,T=new _(c);T[0]=T[c-1]=1,bs(n,T,a,0,c-1);var R,$=[];for(R=0;R<c;R++)T[R]&&$.push(n[R]);return $}function bs(n,a,c,_,T){var R=0,$,nt,st;for(nt=_+1;nt<=T-1;nt++)st=qn(n[nt],n[_],n[T],!0),st>R&&($=nt,R=st);R>c&&(a[$]=1,bs(n,a,c,_,$),bs(n,a,c,$,T))}function nh(n,a){for(var c=[n[0]],_=1,T=0,R=n.length;_<R;_++)Lr(n[_],n[T])>a&&(c.push(n[_]),T=_);return T<R-1&&c.push(n[R-1]),c}var So;function ko(n,a,c,_,T){var R=_?So:Ji(n,c),$=Ji(a,c),nt,st,pt;for(So=$;;){if(!(R|$))return[n,a];if(R&$)return!1;nt=R||$,st=_n(n,a,nt,c,T),pt=Ji(st,c),nt===R?(n=st,R=pt):(a=st,$=pt)}}function _n(n,a,c,_,T){var R=a.x-n.x,$=a.y-n.y,nt=_.min,st=_.max,pt,Mt;return c&8?(pt=n.x+R*(st.y-n.y)/$,Mt=st.y):c&4?(pt=n.x+R*(nt.y-n.y)/$,Mt=nt.y):c&2?(pt=st.x,Mt=n.y+$*(st.x-n.x)/R):c&1&&(pt=nt.x,Mt=n.y+$*(nt.x-n.x)/R),new W(pt,Mt,T)}function Ji(n,a){var c=0;return n.x<a.min.x?c|=1:n.x>a.max.x&&(c|=2),n.y<a.min.y?c|=4:n.y>a.max.y&&(c|=8),c}function Lr(n,a){var c=a.x-n.x,_=a.y-n.y;return c*c+_*_}function qn(n,a,c,_){var T=a.x,R=a.y,$=c.x-T,nt=c.y-R,st=$*$+nt*nt,pt;return st>0&&(pt=((n.x-T)*$+(n.y-R)*nt)/st,pt>1?(T=c.x,R=c.y):pt>0&&(T+=$*pt,R+=nt*pt)),$=n.x-T,nt=n.y-R,_?$*$+nt*nt:new W(T,R)}function Ue(n){return!B(n[0])||typeof n[0][0]!="object"&&typeof n[0][0]<"u"}function Yn(n){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),Ue(n)}function Ls(n,a){var c,_,T,R,$,nt,st,pt;if(!n||n.length===0)throw new Error("latlngs not passed");Ue(n)||(console.warn("latlngs are not flat! Only the first ring will be used"),n=n[0]);var Mt=mt([0,0]),It=ct(n),Gt=It.getNorthWest().distanceTo(It.getSouthWest())*It.getNorthEast().distanceTo(It.getNorthWest());Gt<1700&&(Mt=ws(n));var De=n.length,Ee=[];for(c=0;c<De;c++){var fi=mt(n[c]);Ee.push(a.project(mt([fi.lat-Mt.lat,fi.lng-Mt.lng])))}for(c=0,_=0;c<De-1;c++)_+=Ee[c].distanceTo(Ee[c+1])/2;if(_===0)pt=Ee[0];else for(c=0,R=0;c<De-1;c++)if($=Ee[c],nt=Ee[c+1],T=$.distanceTo(nt),R+=T,R>_){st=(R-_)/T,pt=[nt.x-st*(nt.x-$.x),nt.y-st*(nt.y-$.y)];break}var Ge=a.unproject(tt(pt));return mt([Ge.lat+Mt.lat,Ge.lng+Mt.lng])}var Ao={__proto__:null,simplify:Eo,pointToSegmentDistance:Xi,closestPointOnSegment:To,clipSegment:ko,_getEdgeIntersection:_n,_getBitCode:Ji,_sqClosestPointOnSegment:qn,isFlat:Ue,_flat:Yn,polylineCenter:Ls},Ms={project:function(n){return new W(n.lng,n.lat)},unproject:function(n){return new rt(n.y,n.x)},bounds:new q([-180,-90],[180,90])},Es={R:6378137,R_MINOR:6356752314245179e-9,bounds:new q([-2003750834279e-5,-1549657073972e-5],[2003750834279e-5,1876465623138e-5]),project:function(n){var a=Math.PI/180,c=this.R,_=n.lat*a,T=this.R_MINOR/c,R=Math.sqrt(1-T*T),$=R*Math.sin(_),nt=Math.tan(Math.PI/4-_/2)/Math.pow((1-$)/(1+$),R/2);return _=-c*Math.log(Math.max(nt,1e-10)),new W(n.lng*a*c,_)},unproject:function(n){for(var a=180/Math.PI,c=this.R,_=this.R_MINOR/c,T=Math.sqrt(1-_*_),R=Math.exp(-n.y/c),$=Math.PI/2-2*Math.atan(R),nt=0,st=.1,pt;nt<15&&Math.abs(st)>1e-7;nt++)pt=T*Math.sin($),pt=Math.pow((1-pt)/(1+pt),T/2),st=Math.PI/2-2*Math.atan(R*pt)-$,$+=st;return new rt($*a,n.x*a/c)}},Mr={__proto__:null,LonLat:Ms,Mercator:Es,SphericalMercator:bt},$i=i({},St,{code:"EPSG:3395",projection:Es,transformation:function(){var n=.5/(Math.PI*Es.R);return ht(n,.5,-n,.5)}()}),Po=i({},St,{code:"EPSG:4326",projection:Ms,transformation:ht(1/180,1,-1/180,.5)}),Co=i({},Et,{projection:Ms,transformation:ht(1,0,-1,0),scale:function(n){return Math.pow(2,n)},zoom:function(n){return Math.log(n)/Math.LN2},distance:function(n,a){var c=a.lng-n.lng,_=a.lat-n.lat;return Math.sqrt(c*c+_*_)},infinite:!0});Et.Earth=St,Et.EPSG3395=$i,Et.EPSG3857=ft,Et.EPSG900913=M,Et.EPSG4326=Po,Et.Simple=Co;var Pe=G.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(n){return n.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(n){return n&&n.removeLayer(this),this},getPane:function(n){return this._map.getPane(n?this.options[n]||n:this.options.pane)},addInteractiveTarget:function(n){return this._map._targets[u(n)]=this,this},removeInteractiveTarget:function(n){return delete this._map._targets[u(n)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(n){var a=n.target;if(a.hasLayer(this)){if(this._map=a,this._zoomAnimated=a._zoomAnimated,this.getEvents){var c=this.getEvents();a.on(c,this),this.once("remove",function(){a.off(c,this)},this)}this.onAdd(a),this.fire("add"),a.fire("layeradd",{layer:this})}}});Vt.include({addLayer:function(n){if(!n._layerAdd)throw new Error("The provided object is not a Layer.");var a=u(n);return this._layers[a]?this:(this._layers[a]=n,n._mapToAdd=this,n.beforeAdd&&n.beforeAdd(this),this.whenReady(n._layerAdd,n),this)},removeLayer:function(n){var a=u(n);return this._layers[a]?(this._loaded&&n.onRemove(this),delete this._layers[a],this._loaded&&(this.fire("layerremove",{layer:n}),n.fire("remove")),n._map=n._mapToAdd=null,this):this},hasLayer:function(n){return u(n)in this._layers},eachLayer:function(n,a){for(var c in this._layers)n.call(a,this._layers[c]);return this},_addLayers:function(n){n=n?B(n)?n:[n]:[];for(var a=0,c=n.length;a<c;a++)this.addLayer(n[a])},_addZoomLimit:function(n){(!isNaN(n.options.maxZoom)||!isNaN(n.options.minZoom))&&(this._zoomBoundLayers[u(n)]=n,this._updateZoomLevels())},_removeZoomLimit:function(n){var a=u(n);this._zoomBoundLayers[a]&&(delete this._zoomBoundLayers[a],this._updateZoomLevels())},_updateZoomLevels:function(){var n=1/0,a=-1/0,c=this._getZoomSpan();for(var _ in this._zoomBoundLayers){var T=this._zoomBoundLayers[_].options;n=T.minZoom===void 0?n:Math.min(n,T.minZoom),a=T.maxZoom===void 0?a:Math.max(a,T.maxZoom)}this._layersMaxZoom=a===-1/0?void 0:a,this._layersMinZoom=n===1/0?void 0:n,c!==this._getZoomSpan()&&this.fire("zoomlevelschange"),this.options.maxZoom===void 0&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),this.options.minZoom===void 0&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var gn=Pe.extend({initialize:function(n,a){v(this,a),this._layers={};var c,_;if(n)for(c=0,_=n.length;c<_;c++)this.addLayer(n[c])},addLayer:function(n){var a=this.getLayerId(n);return this._layers[a]=n,this._map&&this._map.addLayer(n),this},removeLayer:function(n){var a=n in this._layers?n:this.getLayerId(n);return this._map&&this._layers[a]&&this._map.removeLayer(this._layers[a]),delete this._layers[a],this},hasLayer:function(n){var a=typeof n=="number"?n:this.getLayerId(n);return a in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(n){var a=Array.prototype.slice.call(arguments,1),c,_;for(c in this._layers)_=this._layers[c],_[n]&&_[n].apply(_,a);return this},onAdd:function(n){this.eachLayer(n.addLayer,n)},onRemove:function(n){this.eachLayer(n.removeLayer,n)},eachLayer:function(n,a){for(var c in this._layers)n.call(a,this._layers[c]);return this},getLayer:function(n){return this._layers[n]},getLayers:function(){var n=[];return this.eachLayer(n.push,n),n},setZIndex:function(n){return this.invoke("setZIndex",n)},getLayerId:function(n){return u(n)}}),yn=function(n,a){return new gn(n,a)},Ce=gn.extend({addLayer:function(n){return this.hasLayer(n)?this:(n.addEventParent(this),gn.prototype.addLayer.call(this,n),this.fire("layeradd",{layer:n}))},removeLayer:function(n){return this.hasLayer(n)?(n in this._layers&&(n=this._layers[n]),n.removeEventParent(this),gn.prototype.removeLayer.call(this,n),this.fire("layerremove",{layer:n})):this},setStyle:function(n){return this.invoke("setStyle",n)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var n=new dt;for(var a in this._layers){var c=this._layers[a];n.extend(c.getBounds?c.getBounds():c.getLatLng())}return n}}),ke=function(n,a){return new Ce(n,a)},Ze=y.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(n){v(this,n)},createIcon:function(n){return this._createIcon("icon",n)},createShadow:function(n){return this._createIcon("shadow",n)},_createIcon:function(n,a){var c=this._getIconUrl(n);if(!c){if(n==="icon")throw new Error("iconUrl not set in Icon options (see the docs).");return null}var _=this._createImg(c,a&&a.tagName==="IMG"?a:null);return this._setIconStyles(_,n),(this.options.crossOrigin||this.options.crossOrigin==="")&&(_.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),_},_setIconStyles:function(n,a){var c=this.options,_=c[a+"Size"];typeof _=="number"&&(_=[_,_]);var T=tt(_),R=tt(a==="shadow"&&c.shadowAnchor||c.iconAnchor||T&&T.divideBy(2,!0));n.className="leaflet-marker-"+a+" "+(c.className||""),R&&(n.style.marginLeft=-R.x+"px",n.style.marginTop=-R.y+"px"),T&&(n.style.width=T.x+"px",n.style.height=T.y+"px")},_createImg:function(n,a){return a=a||document.createElement("img"),a.src=n,a},_getIconUrl:function(n){return At.retina&&this.options[n+"RetinaUrl"]||this.options[n+"Url"]}});function Ts(n){return new Ze(n)}var Ki=Ze.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(n){return typeof Ki.imagePath!="string"&&(Ki.imagePath=this._detectIconPath()),(this.options.imagePath||Ki.imagePath)+Ze.prototype._getIconUrl.call(this,n)},_stripUrl:function(n){var a=function(c,_,T){var R=_.exec(c);return R&&R[T]};return n=a(n,/^url\((['"])?(.+)\1\)$/,2),n&&a(n,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var n=jt("div","leaflet-default-icon-path",document.body),a=Un(n,"background-image")||Un(n,"backgroundImage");if(document.body.removeChild(n),a=this._stripUrl(a),a)return a;var c=document.querySelector('link[href$="leaflet.css"]');return c?c.href.substring(0,c.href.length-11-1):""}}),zo=li.extend({initialize:function(n){this._marker=n},addHooks:function(){var n=this._marker._icon;this._draggable||(this._draggable=new Bi(n,n,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),Ft(n,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&ae(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(n){var a=this._marker,c=a._map,_=this._marker.options.autoPanSpeed,T=this._marker.options.autoPanPadding,R=qi(a._icon),$=c.getPixelBounds(),nt=c.getPixelOrigin(),st=Q($.min._subtract(nt).add(T),$.max._subtract(nt).subtract(T));if(!st.contains(R)){var pt=tt((Math.max(st.max.x,R.x)-st.max.x)/($.max.x-st.max.x)-(Math.min(st.min.x,R.x)-st.min.x)/($.min.x-st.min.x),(Math.max(st.max.y,R.y)-st.max.y)/($.max.y-st.max.y)-(Math.min(st.min.y,R.y)-st.min.y)/($.min.y-st.min.y)).multiplyBy(_);c.panBy(pt,{animate:!1}),this._draggable._newPos._add(pt),this._draggable._startPos._add(pt),ue(a._icon,this._draggable._newPos),this._onDrag(n),this._panRequest=N(this._adjustPan.bind(this,n))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(n){this._marker.options.autoPan&&(E(this._panRequest),this._panRequest=N(this._adjustPan.bind(this,n)))},_onDrag:function(n){var a=this._marker,c=a._shadow,_=qi(a._icon),T=a._map.layerPointToLatLng(_);c&&ue(c,_),a._latlng=T,n.latlng=T,n.oldLatLng=this._oldLatLng,a.fire("move",n).fire("drag",n)},_onDragEnd:function(n){E(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",n)}}),Qi=Pe.extend({options:{icon:new Ki,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(n,a){v(this,a),this._latlng=mt(n)},onAdd:function(n){this._zoomAnimated=this._zoomAnimated&&n.options.markerZoomAnimation,this._zoomAnimated&&n.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(n){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&n.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(n){var a=this._latlng;return this._latlng=mt(n),this.update(),this.fire("move",{oldLatLng:a,latlng:this._latlng})},setZIndexOffset:function(n){return this.options.zIndexOffset=n,this.update()},getIcon:function(){return this.options.icon},setIcon:function(n){return this.options.icon=n,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var n=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(n)}return this},_initIcon:function(){var n=this.options,a="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),c=n.icon.createIcon(this._icon),_=!1;c!==this._icon&&(this._icon&&this._removeIcon(),_=!0,n.title&&(c.title=n.title),c.tagName==="IMG"&&(c.alt=n.alt||"")),Ft(c,a),n.keyboard&&(c.tabIndex="0",c.setAttribute("role","button")),this._icon=c,n.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&Rt(c,"focus",this._panOnFocus,this);var T=n.icon.createShadow(this._shadow),R=!1;T!==this._shadow&&(this._removeShadow(),R=!0),T&&(Ft(T,a),T.alt=""),this._shadow=T,n.opacity<1&&this._updateOpacity(),_&&this.getPane().appendChild(this._icon),this._initInteraction(),T&&R&&this.getPane(n.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&Kt(this._icon,"focus",this._panOnFocus,this),re(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&re(this._shadow),this._shadow=null},_setPos:function(n){this._icon&&ue(this._icon,n),this._shadow&&ue(this._shadow,n),this._zIndex=n.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(n){this._icon&&(this._icon.style.zIndex=this._zIndex+n)},_animateZoom:function(n){var a=this._map._latLngToNewLayerPoint(this._latlng,n.zoom,n.center).round();this._setPos(a)},_initInteraction:function(){if(this.options.interactive&&(Ft(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),zo)){var n=this.options.draggable;this.dragging&&(n=this.dragging.enabled(),this.dragging.disable()),this.dragging=new zo(this),n&&this.dragging.enable()}},setOpacity:function(n){return this.options.opacity=n,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var n=this.options.opacity;this._icon&&Se(this._icon,n),this._shadow&&Se(this._shadow,n)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var n=this._map;if(n){var a=this.options.icon.options,c=a.iconSize?tt(a.iconSize):tt(0,0),_=a.iconAnchor?tt(a.iconAnchor):tt(0,0);n.panInside(this._latlng,{paddingTopLeft:_,paddingBottomRight:c.subtract(_)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function Er(n,a){return new Qi(n,a)}var pe=Pe.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(n){this._renderer=n.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(n){return v(this,n),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&n&&Object.prototype.hasOwnProperty.call(n,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),vi=pe.extend({options:{fill:!0,radius:10},initialize:function(n,a){v(this,a),this._latlng=mt(n),this._radius=this.options.radius},setLatLng:function(n){var a=this._latlng;return this._latlng=mt(n),this.redraw(),this.fire("move",{oldLatLng:a,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(n){return this.options.radius=this._radius=n,this.redraw()},getRadius:function(){return this._radius},setStyle:function(n){var a=n&&n.radius||this._radius;return pe.prototype.setStyle.call(this,n),this.setRadius(a),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var n=this._radius,a=this._radiusY||n,c=this._clickTolerance(),_=[n+c,a+c];this._pxBounds=new q(this._point.subtract(_),this._point.add(_))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(n){return n.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function Io(n,a){return new vi(n,a)}var vn=vi.extend({initialize:function(n,a,c){if(typeof a=="number"&&(a=i({},c,{radius:a})),v(this,a),this._latlng=mt(n),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(n){return this._mRadius=n,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var n=[this._radius,this._radiusY||this._radius];return new dt(this._map.layerPointToLatLng(this._point.subtract(n)),this._map.layerPointToLatLng(this._point.add(n)))},setStyle:pe.prototype.setStyle,_project:function(){var n=this._latlng.lng,a=this._latlng.lat,c=this._map,_=c.options.crs;if(_.distance===St.distance){var T=Math.PI/180,R=this._mRadius/St.R/T,$=c.project([a+R,n]),nt=c.project([a-R,n]),st=$.add(nt).divideBy(2),pt=c.unproject(st).lat,Mt=Math.acos((Math.cos(R*T)-Math.sin(a*T)*Math.sin(pt*T))/(Math.cos(a*T)*Math.cos(pt*T)))/T;(isNaN(Mt)||Mt===0)&&(Mt=R/Math.cos(Math.PI/180*a)),this._point=st.subtract(c.getPixelOrigin()),this._radius=isNaN(Mt)?0:st.x-c.project([pt,n-Mt]).x,this._radiusY=st.y-$.y}else{var It=_.unproject(_.project(this._latlng).subtract([this._mRadius,0]));this._point=c.latLngToLayerPoint(this._latlng),this._radius=this._point.x-c.latLngToLayerPoint(It).x}this._updateBounds()}});function Tr(n,a,c){return new vn(n,a,c)}var ci=pe.extend({options:{smoothFactor:1,noClip:!1},initialize:function(n,a){v(this,a),this._setLatLngs(n)},getLatLngs:function(){return this._latlngs},setLatLngs:function(n){return this._setLatLngs(n),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(n){for(var a=1/0,c=null,_=qn,T,R,$=0,nt=this._parts.length;$<nt;$++)for(var st=this._parts[$],pt=1,Mt=st.length;pt<Mt;pt++){T=st[pt-1],R=st[pt];var It=_(n,T,R,!0);It<a&&(a=It,c=_(n,T,R))}return c&&(c.distance=Math.sqrt(a)),c},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return Ls(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(n,a){return a=a||this._defaultShape(),n=mt(n),a.push(n),this._bounds.extend(n),this.redraw()},_setLatLngs:function(n){this._bounds=new dt,this._latlngs=this._convertLatLngs(n)},_defaultShape:function(){return Ue(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(n){for(var a=[],c=Ue(n),_=0,T=n.length;_<T;_++)c?(a[_]=mt(n[_]),this._bounds.extend(a[_])):a[_]=this._convertLatLngs(n[_]);return a},_project:function(){var n=new q;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,n),this._bounds.isValid()&&n.isValid()&&(this._rawPxBounds=n,this._updateBounds())},_updateBounds:function(){var n=this._clickTolerance(),a=new W(n,n);this._rawPxBounds&&(this._pxBounds=new q([this._rawPxBounds.min.subtract(a),this._rawPxBounds.max.add(a)]))},_projectLatlngs:function(n,a,c){var _=n[0]instanceof rt,T=n.length,R,$;if(_){for($=[],R=0;R<T;R++)$[R]=this._map.latLngToLayerPoint(n[R]),c.extend($[R]);a.push($)}else for(R=0;R<T;R++)this._projectLatlngs(n[R],a,c)},_clipPoints:function(){var n=this._renderer._bounds;if(this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(n))){if(this.options.noClip){this._parts=this._rings;return}var a=this._parts,c,_,T,R,$,nt,st;for(c=0,T=0,R=this._rings.length;c<R;c++)for(st=this._rings[c],_=0,$=st.length;_<$-1;_++)nt=ko(st[_],st[_+1],n,_,!0),nt&&(a[T]=a[T]||[],a[T].push(nt[0]),(nt[1]!==st[_+1]||_===$-2)&&(a[T].push(nt[1]),T++))}},_simplifyPoints:function(){for(var n=this._parts,a=this.options.smoothFactor,c=0,_=n.length;c<_;c++)n[c]=Eo(n[c],a)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(n,a){var c,_,T,R,$,nt,st=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(n))return!1;for(c=0,R=this._parts.length;c<R;c++)for(nt=this._parts[c],_=0,$=nt.length,T=$-1;_<$;T=_++)if(!(!a&&_===0)&&Xi(n,nt[T],nt[_])<=st)return!0;return!1}});function Oo(n,a){return new ci(n,a)}ci._flat=Yn;var tn=ci.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return Mo(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(n){var a=ci.prototype._convertLatLngs.call(this,n),c=a.length;return c>=2&&a[0]instanceof rt&&a[0].equals(a[c-1])&&a.pop(),a},_setLatLngs:function(n){ci.prototype._setLatLngs.call(this,n),Ue(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return Ue(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var n=this._renderer._bounds,a=this.options.weight,c=new W(a,a);if(n=new q(n.min.subtract(c),n.max.add(c)),this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(n))){if(this.options.noClip){this._parts=this._rings;return}for(var _=0,T=this._rings.length,R;_<T;_++)R=Lo(this._rings[_],n,!0),R.length&&this._parts.push(R)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(n){var a=!1,c,_,T,R,$,nt,st,pt;if(!this._pxBounds||!this._pxBounds.contains(n))return!1;for(R=0,st=this._parts.length;R<st;R++)for(c=this._parts[R],$=0,pt=c.length,nt=pt-1;$<pt;nt=$++)_=c[$],T=c[nt],_.y>n.y!=T.y>n.y&&n.x<(T.x-_.x)*(n.y-_.y)/(T.y-_.y)+_.x&&(a=!a);return a||ci.prototype._containsPoint.call(this,n,!0)}});function Ro(n,a){return new tn(n,a)}var Me=Ce.extend({initialize:function(n,a){v(this,a),this._layers={},n&&this.addData(n)},addData:function(n){var a=B(n)?n:n.features,c,_,T;if(a){for(c=0,_=a.length;c<_;c++)T=a[c],(T.geometries||T.geometry||T.features||T.coordinates)&&this.addData(T);return this}var R=this.options;if(R.filter&&!R.filter(n))return this;var $=jn(n,R);return $?($.feature=w(n),$.defaultOptions=$.options,this.resetStyle($),R.onEachFeature&&R.onEachFeature(n,$),this.addLayer($)):this},resetStyle:function(n){return n===void 0?this.eachLayer(this.resetStyle,this):(n.options=i({},n.defaultOptions),this._setLayerStyle(n,this.options.style),this)},setStyle:function(n){return this.eachLayer(function(a){this._setLayerStyle(a,n)},this)},_setLayerStyle:function(n,a){n.setStyle&&(typeof a=="function"&&(a=a(n.feature)),n.setStyle(a))}});function jn(n,a){var c=n.type==="Feature"?n.geometry:n,_=c?c.coordinates:null,T=[],R=a&&a.pointToLayer,$=a&&a.coordsToLatLng||Sr,nt,st,pt,Mt;if(!_&&!c)return null;switch(c.type){case"Point":return nt=$(_),Do(R,n,nt,a);case"MultiPoint":for(pt=0,Mt=_.length;pt<Mt;pt++)nt=$(_[pt]),T.push(Do(R,n,nt,a));return new Ce(T);case"LineString":case"MultiLineString":return st=xn(_,c.type==="LineString"?0:1,$),new ci(st,a);case"Polygon":case"MultiPolygon":return st=xn(_,c.type==="Polygon"?1:2,$),new tn(st,a);case"GeometryCollection":for(pt=0,Mt=c.geometries.length;pt<Mt;pt++){var It=jn({geometry:c.geometries[pt],type:"Feature",properties:n.properties},a);It&&T.push(It)}return new Ce(T);case"FeatureCollection":for(pt=0,Mt=c.features.length;pt<Mt;pt++){var Gt=jn(c.features[pt],a);Gt&&T.push(Gt)}return new Ce(T);default:throw new Error("Invalid GeoJSON object.")}}function Do(n,a,c,_){return n?n(a,c):new Qi(c,_&&_.markersInheritOptions&&_)}function Sr(n){return new rt(n[1],n[0],n[2])}function xn(n,a,c){for(var _=[],T=0,R=n.length,$;T<R;T++)$=a?xn(n[T],a-1,c):(c||Sr)(n[T]),_.push($);return _}function kr(n,a){return n=mt(n),n.alt!==void 0?[g(n.lng,a),g(n.lat,a),g(n.alt,a)]:[g(n.lng,a),g(n.lat,a)]}function Xn(n,a,c,_){for(var T=[],R=0,$=n.length;R<$;R++)T.push(a?Xn(n[R],Ue(n[R])?0:a-1,c,_):kr(n[R],_));return!a&&c&&T.length>0&&T.push(T[0].slice()),T}function en(n,a){return n.feature?i({},n.feature,{geometry:a}):w(a)}function w(n){return n.type==="Feature"||n.type==="FeatureCollection"?n:{type:"Feature",properties:{},geometry:n}}var D={toGeoJSON:function(n){return en(this,{type:"Point",coordinates:kr(this.getLatLng(),n)})}};Qi.include(D),vn.include(D),vi.include(D),ci.include({toGeoJSON:function(n){var a=!Ue(this._latlngs),c=Xn(this._latlngs,a?1:0,!1,n);return en(this,{type:(a?"Multi":"")+"LineString",coordinates:c})}}),tn.include({toGeoJSON:function(n){var a=!Ue(this._latlngs),c=a&&!Ue(this._latlngs[0]),_=Xn(this._latlngs,c?2:a?1:0,!0,n);return a||(_=[_]),en(this,{type:(c?"Multi":"")+"Polygon",coordinates:_})}}),gn.include({toMultiPoint:function(n){var a=[];return this.eachLayer(function(c){a.push(c.toGeoJSON(n).geometry.coordinates)}),en(this,{type:"MultiPoint",coordinates:a})},toGeoJSON:function(n){var a=this.feature&&this.feature.geometry&&this.feature.geometry.type;if(a==="MultiPoint")return this.toMultiPoint(n);var c=a==="GeometryCollection",_=[];return this.eachLayer(function(T){if(T.toGeoJSON){var R=T.toGeoJSON(n);if(c)_.push(R.geometry);else{var $=w(R);$.type==="FeatureCollection"?_.push.apply(_,$.features):_.push($)}}}),c?en(this,{geometries:_,type:"GeometryCollection"}):{type:"FeatureCollection",features:_}}});function Y(n,a){return new Me(n,a)}var ot=Y,wt=Pe.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(n,a,c){this._url=n,this._bounds=ct(a),v(this,c)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(Ft(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){re(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(n){return this.options.opacity=n,this._image&&this._updateOpacity(),this},setStyle:function(n){return n.opacity&&this.setOpacity(n.opacity),this},bringToFront:function(){return this._map&&dn(this._image),this},bringToBack:function(){return this._map&&Ae(this._image),this},setUrl:function(n){return this._url=n,this._image&&(this._image.src=n),this},setBounds:function(n){return this._bounds=ct(n),this._map&&this._reset(),this},getEvents:function(){var n={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(n.zoomanim=this._animateZoom),n},setZIndex:function(n){return this.options.zIndex=n,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var n=this._url.tagName==="IMG",a=this._image=n?this._url:jt("img");if(Ft(a,"leaflet-image-layer"),this._zoomAnimated&&Ft(a,"leaflet-zoom-animated"),this.options.className&&Ft(a,this.options.className),a.onselectstart=p,a.onmousemove=p,a.onload=o(this.fire,this,"load"),a.onerror=o(this._overlayOnError,this,"error"),(this.options.crossOrigin||this.options.crossOrigin==="")&&(a.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),n){this._url=a.src;return}a.src=this._url,a.alt=this.options.alt},_animateZoom:function(n){var a=this._map.getZoomScale(n.zoom),c=this._map._latLngBoundsToNewLayerBounds(this._bounds,n.zoom,n.center).min;we(this._image,c,a)},_reset:function(){var n=this._image,a=new q(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),c=a.getSize();ue(n,a.min),n.style.width=c.x+"px",n.style.height=c.y+"px"},_updateOpacity:function(){Se(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var n=this.options.errorOverlayUrl;n&&this._url!==n&&(this._url=n,this._image.src=n)},getCenter:function(){return this._bounds.getCenter()}}),yt=function(n,a,c){return new wt(n,a,c)},Lt=wt.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var n=this._url.tagName==="VIDEO",a=this._image=n?this._url:jt("video");if(Ft(a,"leaflet-image-layer"),this._zoomAnimated&&Ft(a,"leaflet-zoom-animated"),this.options.className&&Ft(a,this.options.className),a.onselectstart=p,a.onmousemove=p,a.onloadeddata=o(this.fire,this,"load"),n){for(var c=a.getElementsByTagName("source"),_=[],T=0;T<c.length;T++)_.push(c[T].src);this._url=c.length>0?_:[a.src];return}B(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(a.style,"objectFit")&&(a.style.objectFit="fill"),a.autoplay=!!this.options.autoplay,a.loop=!!this.options.loop,a.muted=!!this.options.muted,a.playsInline=!!this.options.playsInline;for(var R=0;R<this._url.length;R++){var $=jt("source");$.src=this._url[R],a.appendChild($)}}});function Ct(n,a,c){return new Lt(n,a,c)}var Dt=wt.extend({_initImage:function(){var n=this._image=this._url;Ft(n,"leaflet-image-layer"),this._zoomAnimated&&Ft(n,"leaflet-zoom-animated"),this.options.className&&Ft(n,this.options.className),n.onselectstart=p,n.onmousemove=p}});function Qt(n,a,c){return new Dt(n,a,c)}var Ut=Pe.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(n,a){n&&(n instanceof rt||B(n))?(this._latlng=mt(n),v(this,a)):(v(this,n),this._source=a),this.options.content&&(this._content=this.options.content)},openOn:function(n){return n=arguments.length?n:this._source._map,n.hasLayer(this)||n.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(n){return this._map?this.close():(arguments.length?this._source=n:n=this._source,this._prepareOpen(),this.openOn(n._map)),this},onAdd:function(n){this._zoomAnimated=n._zoomAnimated,this._container||this._initLayout(),n._fadeAnimated&&Se(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),n._fadeAnimated&&Se(this._container,1),this.bringToFront(),this.options.interactive&&(Ft(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(n){n._fadeAnimated?(Se(this._container,0),this._removeTimeout=setTimeout(o(re,void 0,this._container),200)):re(this._container),this.options.interactive&&(ae(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(n){return this._latlng=mt(n),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(n){return this._content=n,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var n={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(n.zoomanim=this._animateZoom),n},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&dn(this._container),this},bringToBack:function(){return this._map&&Ae(this._container),this},_prepareOpen:function(n){var a=this._source;if(!a._map)return!1;if(a instanceof Ce){a=null;var c=this._source._layers;for(var _ in c)if(c[_]._map){a=c[_];break}if(!a)return!1;this._source=a}if(!n)if(a.getCenter)n=a.getCenter();else if(a.getLatLng)n=a.getLatLng();else if(a.getBounds)n=a.getBounds().getCenter();else throw new Error("Unable to get source layer LatLng.");return this.setLatLng(n),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var n=this._contentNode,a=typeof this._content=="function"?this._content(this._source||this):this._content;if(typeof a=="string")n.innerHTML=a;else{for(;n.hasChildNodes();)n.removeChild(n.firstChild);n.appendChild(a)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var n=this._map.latLngToLayerPoint(this._latlng),a=tt(this.options.offset),c=this._getAnchor();this._zoomAnimated?ue(this._container,n.add(c)):a=a.add(n).add(c);var _=this._containerBottom=-a.y,T=this._containerLeft=-Math.round(this._containerWidth/2)+a.x;this._container.style.bottom=_+"px",this._container.style.left=T+"px"}},_getAnchor:function(){return[0,0]}});Vt.include({_initOverlay:function(n,a,c,_){var T=a;return T instanceof n||(T=new n(_).setContent(a)),c&&T.setLatLng(c),T}}),Pe.include({_initOverlay:function(n,a,c,_){var T=c;return T instanceof n?(v(T,_),T._source=this):(T=a&&!_?a:new n(_,this),T.setContent(c)),T}});var te=Ut.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(n){return n=arguments.length?n:this._source._map,!n.hasLayer(this)&&n._popup&&n._popup.options.autoClose&&n.removeLayer(n._popup),n._popup=this,Ut.prototype.openOn.call(this,n)},onAdd:function(n){Ut.prototype.onAdd.call(this,n),n.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof pe||this._source.on("preclick",ji))},onRemove:function(n){Ut.prototype.onRemove.call(this,n),n.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof pe||this._source.off("preclick",ji))},getEvents:function(){var n=Ut.prototype.getEvents.call(this);return(this.options.closeOnClick!==void 0?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(n.preclick=this.close),this.options.keepInView&&(n.moveend=this._adjustPan),n},_initLayout:function(){var n="leaflet-popup",a=this._container=jt("div",n+" "+(this.options.className||"")+" leaflet-zoom-animated"),c=this._wrapper=jt("div",n+"-content-wrapper",a);if(this._contentNode=jt("div",n+"-content",c),mn(a),ms(this._contentNode),Rt(a,"contextmenu",ji),this._tipContainer=jt("div",n+"-tip-container",a),this._tip=jt("div",n+"-tip",this._tipContainer),this.options.closeButton){var _=this._closeButton=jt("a",n+"-close-button",a);_.setAttribute("role","button"),_.setAttribute("aria-label","Close popup"),_.href="#close",_.innerHTML='<span aria-hidden="true">&#215;</span>',Rt(_,"click",function(T){be(T),this.close()},this)}},_updateLayout:function(){var n=this._contentNode,a=n.style;a.width="",a.whiteSpace="nowrap";var c=n.offsetWidth;c=Math.min(c,this.options.maxWidth),c=Math.max(c,this.options.minWidth),a.width=c+1+"px",a.whiteSpace="",a.height="";var _=n.offsetHeight,T=this.options.maxHeight,R="leaflet-popup-scrolled";T&&_>T?(a.height=T+"px",Ft(n,R)):ae(n,R),this._containerWidth=this._container.offsetWidth},_animateZoom:function(n){var a=this._map._latLngToNewLayerPoint(this._latlng,n.zoom,n.center),c=this._getAnchor();ue(this._container,a.add(c))},_adjustPan:function(){if(this.options.autoPan){if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning){this._autopanning=!1;return}var n=this._map,a=parseInt(Un(this._container,"marginBottom"),10)||0,c=this._container.offsetHeight+a,_=this._containerWidth,T=new W(this._containerLeft,-c-this._containerBottom);T._add(qi(this._container));var R=n.layerPointToContainerPoint(T),$=tt(this.options.autoPanPadding),nt=tt(this.options.autoPanPaddingTopLeft||$),st=tt(this.options.autoPanPaddingBottomRight||$),pt=n.getSize(),Mt=0,It=0;R.x+_+st.x>pt.x&&(Mt=R.x+_-pt.x+st.x),R.x-Mt-nt.x<0&&(Mt=R.x-nt.x),R.y+c+st.y>pt.y&&(It=R.y+c-pt.y+st.y),R.y-It-nt.y<0&&(It=R.y-nt.y),(Mt||It)&&(this.options.keepInView&&(this._autopanning=!0),n.fire("autopanstart").panBy([Mt,It]))}},_getAnchor:function(){return tt(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),me=function(n,a){return new te(n,a)};Vt.mergeOptions({closePopupOnClick:!0}),Vt.include({openPopup:function(n,a,c){return this._initOverlay(te,n,a,c).openOn(this),this},closePopup:function(n){return n=arguments.length?n:this._popup,n&&n.close(),this}}),Pe.include({bindPopup:function(n,a){return this._popup=this._initOverlay(te,this._popup,n,a),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(n){return this._popup&&(this instanceof Ce||(this._popup._source=this),this._popup._prepareOpen(n||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return this._popup?this._popup.isOpen():!1},setPopupContent:function(n){return this._popup&&this._popup.setContent(n),this},getPopup:function(){return this._popup},_openPopup:function(n){if(!(!this._popup||!this._map)){Di(n);var a=n.layer||n.target;if(this._popup._source===a&&!(a instanceof pe)){this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(n.latlng);return}this._popup._source=a,this.openPopup(n.latlng)}},_movePopup:function(n){this._popup.setLatLng(n.latlng)},_onKeyPress:function(n){n.originalEvent.keyCode===13&&this._openPopup(n)}});var fe=Ut.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(n){Ut.prototype.onAdd.call(this,n),this.setOpacity(this.options.opacity),n.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(n){Ut.prototype.onRemove.call(this,n),n.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var n=Ut.prototype.getEvents.call(this);return this.options.permanent||(n.preclick=this.close),n},_initLayout:function(){var n="leaflet-tooltip",a=n+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=jt("div",a),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+u(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(n){var a,c,_=this._map,T=this._container,R=_.latLngToContainerPoint(_.getCenter()),$=_.layerPointToContainerPoint(n),nt=this.options.direction,st=T.offsetWidth,pt=T.offsetHeight,Mt=tt(this.options.offset),It=this._getAnchor();nt==="top"?(a=st/2,c=pt):nt==="bottom"?(a=st/2,c=0):nt==="center"?(a=st/2,c=pt/2):nt==="right"?(a=0,c=pt/2):nt==="left"?(a=st,c=pt/2):$.x<R.x?(nt="right",a=0,c=pt/2):(nt="left",a=st+(Mt.x+It.x)*2,c=pt/2),n=n.subtract(tt(a,c,!0)).add(Mt).add(It),ae(T,"leaflet-tooltip-right"),ae(T,"leaflet-tooltip-left"),ae(T,"leaflet-tooltip-top"),ae(T,"leaflet-tooltip-bottom"),Ft(T,"leaflet-tooltip-"+nt),ue(T,n)},_updatePosition:function(){var n=this._map.latLngToLayerPoint(this._latlng);this._setPosition(n)},setOpacity:function(n){this.options.opacity=n,this._container&&Se(this._container,n)},_animateZoom:function(n){var a=this._map._latLngToNewLayerPoint(this._latlng,n.zoom,n.center);this._setPosition(a)},_getAnchor:function(){return tt(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),Le=function(n,a){return new fe(n,a)};Vt.include({openTooltip:function(n,a,c){return this._initOverlay(fe,n,a,c).openOn(this),this},closeTooltip:function(n){return n.close(),this}}),Pe.include({bindTooltip:function(n,a){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(fe,this._tooltip,n,a),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(n){if(!(!n&&this._tooltipHandlersAdded)){var a=n?"off":"on",c={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?c.add=this._openTooltip:(c.mouseover=this._openTooltip,c.mouseout=this.closeTooltip,c.click=this._openTooltip,this._map?this._addFocusListeners():c.add=this._addFocusListeners),this._tooltip.options.sticky&&(c.mousemove=this._moveTooltip),this[a](c),this._tooltipHandlersAdded=!n}},openTooltip:function(n){return this._tooltip&&(this instanceof Ce||(this._tooltip._source=this),this._tooltip._prepareOpen(n)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(n){return this._tooltip&&this._tooltip.setContent(n),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(n){var a=typeof n.getElement=="function"&&n.getElement();a&&(Rt(a,"focus",function(){this._tooltip._source=n,this.openTooltip()},this),Rt(a,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(n){var a=typeof n.getElement=="function"&&n.getElement();a&&a.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(n){if(!(!this._tooltip||!this._map)){if(this._map.dragging&&this._map.dragging.moving()&&!this._openOnceFlag){this._openOnceFlag=!0;var a=this;this._map.once("moveend",function(){a._openOnceFlag=!1,a._openTooltip(n)});return}this._tooltip._source=n.layer||n.target,this.openTooltip(this._tooltip.options.sticky?n.latlng:void 0)}},_moveTooltip:function(n){var a=n.latlng,c,_;this._tooltip.options.sticky&&n.originalEvent&&(c=this._map.mouseEventToContainerPoint(n.originalEvent),_=this._map.containerPointToLayerPoint(c),a=this._map.layerPointToLatLng(_)),this._tooltip.setLatLng(a)}});var xi=Ze.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(n){var a=n&&n.tagName==="DIV"?n:document.createElement("div"),c=this.options;if(c.html instanceof Element?(gr(a),a.appendChild(c.html)):a.innerHTML=c.html!==!1?c.html:"",c.bgPos){var _=tt(c.bgPos);a.style.backgroundPosition=-_.x+"px "+-_.y+"px"}return this._setIconStyles(a,"icon"),a},createShadow:function(){return null}});function wi(n){return new xi(n)}Ze.Default=Ki;var Xe=Pe.extend({options:{tileSize:256,opacity:1,updateWhenIdle:At.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(n){v(this,n)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(n){n._addZoomLimit(this)},onRemove:function(n){this._removeAllTiles(),re(this._container),n._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(dn(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(Ae(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(n){return this.options.opacity=n,this._updateOpacity(),this},setZIndex:function(n){return this.options.zIndex=n,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var n=this._clampZoom(this._map.getZoom());n!==this._tileZoom&&(this._tileZoom=n,this._updateLevels()),this._update()}return this},getEvents:function(){var n={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=f(this._onMoveEnd,this.options.updateInterval,this)),n.move=this._onMove),this._zoomAnimated&&(n.zoomanim=this._animateZoom),n},createTile:function(){return document.createElement("div")},getTileSize:function(){var n=this.options.tileSize;return n instanceof W?n:new W(n,n)},_updateZIndex:function(){this._container&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(n){for(var a=this.getPane().children,c=-n(-1/0,1/0),_=0,T=a.length,R;_<T;_++)R=a[_].style.zIndex,a[_]!==this._container&&R&&(c=n(c,+R));isFinite(c)&&(this.options.zIndex=c+n(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!At.ielt9){Se(this._container,this.options.opacity);var n=+new Date,a=!1,c=!1;for(var _ in this._tiles){var T=this._tiles[_];if(!(!T.current||!T.loaded)){var R=Math.min(1,(n-T.loaded)/200);Se(T.el,R),R<1?a=!0:(T.active?c=!0:this._onOpaqueTile(T),T.active=!0)}}c&&!this._noPrune&&this._pruneTiles(),a&&(E(this._fadeFrame),this._fadeFrame=N(this._updateOpacity,this))}},_onOpaqueTile:p,_initContainer:function(){this._container||(this._container=jt("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var n=this._tileZoom,a=this.options.maxZoom;if(n!==void 0){for(var c in this._levels)c=Number(c),this._levels[c].el.children.length||c===n?(this._levels[c].el.style.zIndex=a-Math.abs(n-c),this._onUpdateLevel(c)):(re(this._levels[c].el),this._removeTilesAtZoom(c),this._onRemoveLevel(c),delete this._levels[c]);var _=this._levels[n],T=this._map;return _||(_=this._levels[n]={},_.el=jt("div","leaflet-tile-container leaflet-zoom-animated",this._container),_.el.style.zIndex=a,_.origin=T.project(T.unproject(T.getPixelOrigin()),n).round(),_.zoom=n,this._setZoomTransform(_,T.getCenter(),T.getZoom()),p(_.el.offsetWidth),this._onCreateLevel(_)),this._level=_,_}},_onUpdateLevel:p,_onRemoveLevel:p,_onCreateLevel:p,_pruneTiles:function(){if(this._map){var n,a,c=this._map.getZoom();if(c>this.options.maxZoom||c<this.options.minZoom){this._removeAllTiles();return}for(n in this._tiles)a=this._tiles[n],a.retain=a.current;for(n in this._tiles)if(a=this._tiles[n],a.current&&!a.active){var _=a.coords;this._retainParent(_.x,_.y,_.z,_.z-5)||this._retainChildren(_.x,_.y,_.z,_.z+2)}for(n in this._tiles)this._tiles[n].retain||this._removeTile(n)}},_removeTilesAtZoom:function(n){for(var a in this._tiles)this._tiles[a].coords.z===n&&this._removeTile(a)},_removeAllTiles:function(){for(var n in this._tiles)this._removeTile(n)},_invalidateAll:function(){for(var n in this._levels)re(this._levels[n].el),this._onRemoveLevel(Number(n)),delete this._levels[n];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(n,a,c,_){var T=Math.floor(n/2),R=Math.floor(a/2),$=c-1,nt=new W(+T,+R);nt.z=+$;var st=this._tileCoordsToKey(nt),pt=this._tiles[st];return pt&&pt.active?(pt.retain=!0,!0):(pt&&pt.loaded&&(pt.retain=!0),$>_?this._retainParent(T,R,$,_):!1)},_retainChildren:function(n,a,c,_){for(var T=2*n;T<2*n+2;T++)for(var R=2*a;R<2*a+2;R++){var $=new W(T,R);$.z=c+1;var nt=this._tileCoordsToKey($),st=this._tiles[nt];if(st&&st.active){st.retain=!0;continue}else st&&st.loaded&&(st.retain=!0);c+1<_&&this._retainChildren(T,R,c+1,_)}},_resetView:function(n){var a=n&&(n.pinch||n.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),a,a)},_animateZoom:function(n){this._setView(n.center,n.zoom,!0,n.noUpdate)},_clampZoom:function(n){var a=this.options;return a.minNativeZoom!==void 0&&n<a.minNativeZoom?a.minNativeZoom:a.maxNativeZoom!==void 0&&a.maxNativeZoom<n?a.maxNativeZoom:n},_setView:function(n,a,c,_){var T=Math.round(a);this.options.maxZoom!==void 0&&T>this.options.maxZoom||this.options.minZoom!==void 0&&T<this.options.minZoom?T=void 0:T=this._clampZoom(T);var R=this.options.updateWhenZooming&&T!==this._tileZoom;(!_||R)&&(this._tileZoom=T,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),T!==void 0&&this._update(n),c||this._pruneTiles(),this._noPrune=!!c),this._setZoomTransforms(n,a)},_setZoomTransforms:function(n,a){for(var c in this._levels)this._setZoomTransform(this._levels[c],n,a)},_setZoomTransform:function(n,a,c){var _=this._map.getZoomScale(c,n.zoom),T=n.origin.multiplyBy(_).subtract(this._map._getNewPixelOrigin(a,c)).round();At.any3d?we(n.el,T,_):ue(n.el,T)},_resetGrid:function(){var n=this._map,a=n.options.crs,c=this._tileSize=this.getTileSize(),_=this._tileZoom,T=this._map.getPixelWorldBounds(this._tileZoom);T&&(this._globalTileRange=this._pxBoundsToTileRange(T)),this._wrapX=a.wrapLng&&!this.options.noWrap&&[Math.floor(n.project([0,a.wrapLng[0]],_).x/c.x),Math.ceil(n.project([0,a.wrapLng[1]],_).x/c.y)],this._wrapY=a.wrapLat&&!this.options.noWrap&&[Math.floor(n.project([a.wrapLat[0],0],_).y/c.x),Math.ceil(n.project([a.wrapLat[1],0],_).y/c.y)]},_onMoveEnd:function(){!this._map||this._map._animatingZoom||this._update()},_getTiledPixelBounds:function(n){var a=this._map,c=a._animatingZoom?Math.max(a._animateToZoom,a.getZoom()):a.getZoom(),_=a.getZoomScale(c,this._tileZoom),T=a.project(n,this._tileZoom).floor(),R=a.getSize().divideBy(_*2);return new q(T.subtract(R),T.add(R))},_update:function(n){var a=this._map;if(a){var c=this._clampZoom(a.getZoom());if(n===void 0&&(n=a.getCenter()),this._tileZoom!==void 0){var _=this._getTiledPixelBounds(n),T=this._pxBoundsToTileRange(_),R=T.getCenter(),$=[],nt=this.options.keepBuffer,st=new q(T.getBottomLeft().subtract([nt,-nt]),T.getTopRight().add([nt,-nt]));if(!(isFinite(T.min.x)&&isFinite(T.min.y)&&isFinite(T.max.x)&&isFinite(T.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var pt in this._tiles){var Mt=this._tiles[pt].coords;(Mt.z!==this._tileZoom||!st.contains(new W(Mt.x,Mt.y)))&&(this._tiles[pt].current=!1)}if(Math.abs(c-this._tileZoom)>1){this._setView(n,c);return}for(var It=T.min.y;It<=T.max.y;It++)for(var Gt=T.min.x;Gt<=T.max.x;Gt++){var De=new W(Gt,It);if(De.z=this._tileZoom,!!this._isValidTile(De)){var Ee=this._tiles[this._tileCoordsToKey(De)];Ee?Ee.current=!0:$.push(De)}}if($.sort(function(Ge,Ar){return Ge.distanceTo(R)-Ar.distanceTo(R)}),$.length!==0){this._loading||(this._loading=!0,this.fire("loading"));var fi=document.createDocumentFragment();for(Gt=0;Gt<$.length;Gt++)this._addTile($[Gt],fi);this._level.el.appendChild(fi)}}}},_isValidTile:function(n){var a=this._map.options.crs;if(!a.infinite){var c=this._globalTileRange;if(!a.wrapLng&&(n.x<c.min.x||n.x>c.max.x)||!a.wrapLat&&(n.y<c.min.y||n.y>c.max.y))return!1}if(!this.options.bounds)return!0;var _=this._tileCoordsToBounds(n);return ct(this.options.bounds).overlaps(_)},_keyToBounds:function(n){return this._tileCoordsToBounds(this._keyToTileCoords(n))},_tileCoordsToNwSe:function(n){var a=this._map,c=this.getTileSize(),_=n.scaleBy(c),T=_.add(c),R=a.unproject(_,n.z),$=a.unproject(T,n.z);return[R,$]},_tileCoordsToBounds:function(n){var a=this._tileCoordsToNwSe(n),c=new dt(a[0],a[1]);return this.options.noWrap||(c=this._map.wrapLatLngBounds(c)),c},_tileCoordsToKey:function(n){return n.x+":"+n.y+":"+n.z},_keyToTileCoords:function(n){var a=n.split(":"),c=new W(+a[0],+a[1]);return c.z=+a[2],c},_removeTile:function(n){var a=this._tiles[n];a&&(re(a.el),delete this._tiles[n],this.fire("tileunload",{tile:a.el,coords:this._keyToTileCoords(n)}))},_initTile:function(n){Ft(n,"leaflet-tile");var a=this.getTileSize();n.style.width=a.x+"px",n.style.height=a.y+"px",n.onselectstart=p,n.onmousemove=p,At.ielt9&&this.options.opacity<1&&Se(n,this.options.opacity)},_addTile:function(n,a){var c=this._getTilePos(n),_=this._tileCoordsToKey(n),T=this.createTile(this._wrapCoords(n),o(this._tileReady,this,n));this._initTile(T),this.createTile.length<2&&N(o(this._tileReady,this,n,null,T)),ue(T,c),this._tiles[_]={el:T,coords:n,current:!0},a.appendChild(T),this.fire("tileloadstart",{tile:T,coords:n})},_tileReady:function(n,a,c){a&&this.fire("tileerror",{error:a,tile:c,coords:n});var _=this._tileCoordsToKey(n);c=this._tiles[_],c&&(c.loaded=+new Date,this._map._fadeAnimated?(Se(c.el,0),E(this._fadeFrame),this._fadeFrame=N(this._updateOpacity,this)):(c.active=!0,this._pruneTiles()),a||(Ft(c.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:c.el,coords:n})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),At.ielt9||!this._map._fadeAnimated?N(this._pruneTiles,this):setTimeout(o(this._pruneTiles,this),250)))},_getTilePos:function(n){return n.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(n){var a=new W(this._wrapX?d(n.x,this._wrapX):n.x,this._wrapY?d(n.y,this._wrapY):n.y);return a.z=n.z,a},_pxBoundsToTileRange:function(n){var a=this.getTileSize();return new q(n.min.unscaleBy(a).floor(),n.max.unscaleBy(a).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var n in this._tiles)if(!this._tiles[n].loaded)return!1;return!0}});function Bo(n){return new Xe(n)}var bi=Xe.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(n,a){this._url=n,a=v(this,a),a.detectRetina&&At.retina&&a.maxZoom>0?(a.tileSize=Math.floor(a.tileSize/2),a.zoomReverse?(a.zoomOffset--,a.minZoom=Math.min(a.maxZoom,a.minZoom+1)):(a.zoomOffset++,a.maxZoom=Math.max(a.minZoom,a.maxZoom-1)),a.minZoom=Math.max(0,a.minZoom)):a.zoomReverse?a.minZoom=Math.min(a.maxZoom,a.minZoom):a.maxZoom=Math.max(a.minZoom,a.maxZoom),typeof a.subdomains=="string"&&(a.subdomains=a.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(n,a){return this._url===n&&a===void 0&&(a=!0),this._url=n,a||this.redraw(),this},createTile:function(n,a){var c=document.createElement("img");return Rt(c,"load",o(this._tileOnLoad,this,a,c)),Rt(c,"error",o(this._tileOnError,this,a,c)),(this.options.crossOrigin||this.options.crossOrigin==="")&&(c.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),typeof this.options.referrerPolicy=="string"&&(c.referrerPolicy=this.options.referrerPolicy),c.alt="",c.src=this.getTileUrl(n),c},getTileUrl:function(n){var a={r:At.retina?"@2x":"",s:this._getSubdomain(n),x:n.x,y:n.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var c=this._globalTileRange.max.y-n.y;this.options.tms&&(a.y=c),a["-y"]=c}return A(this._url,i(a,this.options))},_tileOnLoad:function(n,a){At.ielt9?setTimeout(o(n,this,null,a),0):n(null,a)},_tileOnError:function(n,a,c){var _=this.options.errorTileUrl;_&&a.getAttribute("src")!==_&&(a.src=_),n(c,a)},_onTileRemove:function(n){n.tile.onload=null},_getZoomForUrl:function(){var n=this._tileZoom,a=this.options.maxZoom,c=this.options.zoomReverse,_=this.options.zoomOffset;return c&&(n=a-n),n+_},_getSubdomain:function(n){var a=Math.abs(n.x+n.y)%this.options.subdomains.length;return this.options.subdomains[a]},_abortLoading:function(){var n,a;for(n in this._tiles)if(this._tiles[n].coords.z!==this._tileZoom&&(a=this._tiles[n].el,a.onload=p,a.onerror=p,!a.complete)){a.src=I;var c=this._tiles[n].coords;re(a),delete this._tiles[n],this.fire("tileabort",{tile:a,coords:c})}},_removeTile:function(n){var a=this._tiles[n];if(a)return a.el.setAttribute("src",I),Xe.prototype._removeTile.call(this,n)},_tileReady:function(n,a,c){if(!(!this._map||c&&c.getAttribute("src")===I))return Xe.prototype._tileReady.call(this,n,a,c)}});function Jn(n,a){return new bi(n,a)}var Sl=bi.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(n,a){this._url=n;var c=i({},this.defaultWmsParams);for(var _ in a)_ in this.options||(c[_]=a[_]);a=v(this,a);var T=a.detectRetina&&At.retina?2:1,R=this.getTileSize();c.width=R.x*T,c.height=R.y*T,this.wmsParams=c},onAdd:function(n){this._crs=this.options.crs||n.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var a=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[a]=this._crs.code,bi.prototype.onAdd.call(this,n)},getTileUrl:function(n){var a=this._tileCoordsToNwSe(n),c=this._crs,_=Q(c.project(a[0]),c.project(a[1])),T=_.min,R=_.max,$=(this._wmsVersion>=1.3&&this._crs===Po?[T.y,T.x,R.y,R.x]:[T.x,T.y,R.x,R.y]).join(","),nt=bi.prototype.getTileUrl.call(this,n);return nt+b(this.wmsParams,nt,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+$},setParams:function(n,a){return i(this.wmsParams,n),a||this.redraw(),this}});function cf(n,a){return new Sl(n,a)}bi.WMS=Sl,Jn.wms=cf;var nn=Pe.extend({options:{padding:.1},initialize:function(n){v(this,n),u(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),Ft(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var n={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(n.zoomanim=this._onAnimZoom),n},_onAnimZoom:function(n){this._updateTransform(n.center,n.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(n,a){var c=this._map.getZoomScale(a,this._zoom),_=this._map.getSize().multiplyBy(.5+this.options.padding),T=this._map.project(this._center,a),R=_.multiplyBy(-c).add(T).subtract(this._map._getNewPixelOrigin(n,a));At.any3d?we(this._container,R,c):ue(this._container,R)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var n in this._layers)this._layers[n]._reset()},_onZoomEnd:function(){for(var n in this._layers)this._layers[n]._project()},_updatePaths:function(){for(var n in this._layers)this._layers[n]._update()},_update:function(){var n=this.options.padding,a=this._map.getSize(),c=this._map.containerPointToLayerPoint(a.multiplyBy(-n)).round();this._bounds=new q(c,c.add(a.multiplyBy(1+n*2)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),kl=nn.extend({options:{tolerance:0},getEvents:function(){var n=nn.prototype.getEvents.call(this);return n.viewprereset=this._onViewPreReset,n},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){nn.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var n=this._container=document.createElement("canvas");Rt(n,"mousemove",this._onMouseMove,this),Rt(n,"click dblclick mousedown mouseup contextmenu",this._onClick,this),Rt(n,"mouseout",this._handleMouseOut,this),n._leaflet_disable_events=!0,this._ctx=n.getContext("2d")},_destroyContainer:function(){E(this._redrawRequest),delete this._ctx,re(this._container),Kt(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){var n;this._redrawBounds=null;for(var a in this._layers)n=this._layers[a],n._update();this._redraw()}},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){nn.prototype._update.call(this);var n=this._bounds,a=this._container,c=n.getSize(),_=At.retina?2:1;ue(a,n.min),a.width=_*c.x,a.height=_*c.y,a.style.width=c.x+"px",a.style.height=c.y+"px",At.retina&&this._ctx.scale(2,2),this._ctx.translate(-n.min.x,-n.min.y),this.fire("update")}},_reset:function(){nn.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(n){this._updateDashArray(n),this._layers[u(n)]=n;var a=n._order={layer:n,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=a),this._drawLast=a,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(n){this._requestRedraw(n)},_removePath:function(n){var a=n._order,c=a.next,_=a.prev;c?c.prev=_:this._drawLast=_,_?_.next=c:this._drawFirst=c,delete n._order,delete this._layers[u(n)],this._requestRedraw(n)},_updatePath:function(n){this._extendRedrawBounds(n),n._project(),n._update(),this._requestRedraw(n)},_updateStyle:function(n){this._updateDashArray(n),this._requestRedraw(n)},_updateDashArray:function(n){if(typeof n.options.dashArray=="string"){var a=n.options.dashArray.split(/[, ]+/),c=[],_,T;for(T=0;T<a.length;T++){if(_=Number(a[T]),isNaN(_))return;c.push(_)}n.options._dashArray=c}else n.options._dashArray=n.options.dashArray},_requestRedraw:function(n){this._map&&(this._extendRedrawBounds(n),this._redrawRequest=this._redrawRequest||N(this._redraw,this))},_extendRedrawBounds:function(n){if(n._pxBounds){var a=(n.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new q,this._redrawBounds.extend(n._pxBounds.min.subtract([a,a])),this._redrawBounds.extend(n._pxBounds.max.add([a,a]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var n=this._redrawBounds;if(n){var a=n.getSize();this._ctx.clearRect(n.min.x,n.min.y,a.x,a.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var n,a=this._redrawBounds;if(this._ctx.save(),a){var c=a.getSize();this._ctx.beginPath(),this._ctx.rect(a.min.x,a.min.y,c.x,c.y),this._ctx.clip()}this._drawing=!0;for(var _=this._drawFirst;_;_=_.next)n=_.layer,(!a||n._pxBounds&&n._pxBounds.intersects(a))&&n._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(n,a){if(this._drawing){var c,_,T,R,$=n._parts,nt=$.length,st=this._ctx;if(nt){for(st.beginPath(),c=0;c<nt;c++){for(_=0,T=$[c].length;_<T;_++)R=$[c][_],st[_?"lineTo":"moveTo"](R.x,R.y);a&&st.closePath()}this._fillStroke(st,n)}}},_updateCircle:function(n){if(!(!this._drawing||n._empty())){var a=n._point,c=this._ctx,_=Math.max(Math.round(n._radius),1),T=(Math.max(Math.round(n._radiusY),1)||_)/_;T!==1&&(c.save(),c.scale(1,T)),c.beginPath(),c.arc(a.x,a.y/T,_,0,Math.PI*2,!1),T!==1&&c.restore(),this._fillStroke(c,n)}},_fillStroke:function(n,a){var c=a.options;c.fill&&(n.globalAlpha=c.fillOpacity,n.fillStyle=c.fillColor||c.color,n.fill(c.fillRule||"evenodd")),c.stroke&&c.weight!==0&&(n.setLineDash&&n.setLineDash(a.options&&a.options._dashArray||[]),n.globalAlpha=c.opacity,n.lineWidth=c.weight,n.strokeStyle=c.color,n.lineCap=c.lineCap,n.lineJoin=c.lineJoin,n.stroke())},_onClick:function(n){for(var a=this._map.mouseEventToLayerPoint(n),c,_,T=this._drawFirst;T;T=T.next)c=T.layer,c.options.interactive&&c._containsPoint(a)&&(!(n.type==="click"||n.type==="preclick")||!this._map._draggableMoved(c))&&(_=c);this._fireEvent(_?[_]:!1,n)},_onMouseMove:function(n){if(!(!this._map||this._map.dragging.moving()||this._map._animatingZoom)){var a=this._map.mouseEventToLayerPoint(n);this._handleMouseHover(n,a)}},_handleMouseOut:function(n){var a=this._hoveredLayer;a&&(ae(this._container,"leaflet-interactive"),this._fireEvent([a],n,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(n,a){if(!this._mouseHoverThrottled){for(var c,_,T=this._drawFirst;T;T=T.next)c=T.layer,c.options.interactive&&c._containsPoint(a)&&(_=c);_!==this._hoveredLayer&&(this._handleMouseOut(n),_&&(Ft(this._container,"leaflet-interactive"),this._fireEvent([_],n,"mouseover"),this._hoveredLayer=_)),this._fireEvent(this._hoveredLayer?[this._hoveredLayer]:!1,n),this._mouseHoverThrottled=!0,setTimeout(o(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(n,a,c){this._map._fireDOMEvent(a,c||a.type,n)},_bringToFront:function(n){var a=n._order;if(a){var c=a.next,_=a.prev;if(c)c.prev=_;else return;_?_.next=c:c&&(this._drawFirst=c),a.prev=this._drawLast,this._drawLast.next=a,a.next=null,this._drawLast=a,this._requestRedraw(n)}},_bringToBack:function(n){var a=n._order;if(a){var c=a.next,_=a.prev;if(_)_.next=c;else return;c?c.prev=_:_&&(this._drawLast=_),a.prev=null,a.next=this._drawFirst,this._drawFirst.prev=a,this._drawFirst=a,this._requestRedraw(n)}}});function Al(n){return At.canvas?new kl(n):null}var Ss=function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(n){return document.createElement("<lvml:"+n+' class="lvml">')}}catch{}return function(n){return document.createElement("<"+n+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}(),ff={_initContainer:function(){this._container=jt("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(nn.prototype._update.call(this),this.fire("update"))},_initPath:function(n){var a=n._container=Ss("shape");Ft(a,"leaflet-vml-shape "+(this.options.className||"")),a.coordsize="1 1",n._path=Ss("path"),a.appendChild(n._path),this._updateStyle(n),this._layers[u(n)]=n},_addPath:function(n){var a=n._container;this._container.appendChild(a),n.options.interactive&&n.addInteractiveTarget(a)},_removePath:function(n){var a=n._container;re(a),n.removeInteractiveTarget(a),delete this._layers[u(n)]},_updateStyle:function(n){var a=n._stroke,c=n._fill,_=n.options,T=n._container;T.stroked=!!_.stroke,T.filled=!!_.fill,_.stroke?(a||(a=n._stroke=Ss("stroke")),T.appendChild(a),a.weight=_.weight+"px",a.color=_.color,a.opacity=_.opacity,_.dashArray?a.dashStyle=B(_.dashArray)?_.dashArray.join(" "):_.dashArray.replace(/( *, *)/g," "):a.dashStyle="",a.endcap=_.lineCap.replace("butt","flat"),a.joinstyle=_.lineJoin):a&&(T.removeChild(a),n._stroke=null),_.fill?(c||(c=n._fill=Ss("fill")),T.appendChild(c),c.color=_.fillColor||_.color,c.opacity=_.fillOpacity):c&&(T.removeChild(c),n._fill=null)},_updateCircle:function(n){var a=n._point.round(),c=Math.round(n._radius),_=Math.round(n._radiusY||c);this._setPath(n,n._empty()?"M0 0":"AL "+a.x+","+a.y+" "+c+","+_+" 0,"+65535*360)},_setPath:function(n,a){n._path.v=a},_bringToFront:function(n){dn(n._container)},_bringToBack:function(n){Ae(n._container)}},No=At.vml?Ss:et,ks=nn.extend({_initContainer:function(){this._container=No("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=No("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){re(this._container),Kt(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){nn.prototype._update.call(this);var n=this._bounds,a=n.getSize(),c=this._container;(!this._svgSize||!this._svgSize.equals(a))&&(this._svgSize=a,c.setAttribute("width",a.x),c.setAttribute("height",a.y)),ue(c,n.min),c.setAttribute("viewBox",[n.min.x,n.min.y,a.x,a.y].join(" ")),this.fire("update")}},_initPath:function(n){var a=n._path=No("path");n.options.className&&Ft(a,n.options.className),n.options.interactive&&Ft(a,"leaflet-interactive"),this._updateStyle(n),this._layers[u(n)]=n},_addPath:function(n){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(n._path),n.addInteractiveTarget(n._path)},_removePath:function(n){re(n._path),n.removeInteractiveTarget(n._path),delete this._layers[u(n)]},_updatePath:function(n){n._project(),n._update()},_updateStyle:function(n){var a=n._path,c=n.options;a&&(c.stroke?(a.setAttribute("stroke",c.color),a.setAttribute("stroke-opacity",c.opacity),a.setAttribute("stroke-width",c.weight),a.setAttribute("stroke-linecap",c.lineCap),a.setAttribute("stroke-linejoin",c.lineJoin),c.dashArray?a.setAttribute("stroke-dasharray",c.dashArray):a.removeAttribute("stroke-dasharray"),c.dashOffset?a.setAttribute("stroke-dashoffset",c.dashOffset):a.removeAttribute("stroke-dashoffset")):a.setAttribute("stroke","none"),c.fill?(a.setAttribute("fill",c.fillColor||c.color),a.setAttribute("fill-opacity",c.fillOpacity),a.setAttribute("fill-rule",c.fillRule||"evenodd")):a.setAttribute("fill","none"))},_updatePoly:function(n,a){this._setPath(n,j(n._parts,a))},_updateCircle:function(n){var a=n._point,c=Math.max(Math.round(n._radius),1),_=Math.max(Math.round(n._radiusY),1)||c,T="a"+c+","+_+" 0 1,0 ",R=n._empty()?"M0 0":"M"+(a.x-c)+","+a.y+T+c*2+",0 "+T+-c*2+",0 ";this._setPath(n,R)},_setPath:function(n,a){n._path.setAttribute("d",a)},_bringToFront:function(n){dn(n._path)},_bringToBack:function(n){Ae(n._path)}});At.vml&&ks.include(ff);function Pl(n){return At.svg||At.vml?new ks(n):null}Vt.include({getRenderer:function(n){var a=n.options.renderer||this._getPaneRenderer(n.options.pane)||this.options.renderer||this._renderer;return a||(a=this._renderer=this._createRenderer()),this.hasLayer(a)||this.addLayer(a),a},_getPaneRenderer:function(n){if(n==="overlayPane"||n===void 0)return!1;var a=this._paneRenderers[n];return a===void 0&&(a=this._createRenderer({pane:n}),this._paneRenderers[n]=a),a},_createRenderer:function(n){return this.options.preferCanvas&&Al(n)||Pl(n)}});var Cl=tn.extend({initialize:function(n,a){tn.prototype.initialize.call(this,this._boundsToLatLngs(n),a)},setBounds:function(n){return this.setLatLngs(this._boundsToLatLngs(n))},_boundsToLatLngs:function(n){return n=ct(n),[n.getSouthWest(),n.getNorthWest(),n.getNorthEast(),n.getSouthEast()]}});function df(n,a){return new Cl(n,a)}ks.create=No,ks.pointsToPath=j,Me.geometryToLayer=jn,Me.coordsToLatLng=Sr,Me.coordsToLatLngs=xn,Me.latLngToCoords=kr,Me.latLngsToCoords=Xn,Me.getFeature=en,Me.asFeature=w,Vt.mergeOptions({boxZoom:!0});var zl=li.extend({initialize:function(n){this._map=n,this._container=n._container,this._pane=n._panes.overlayPane,this._resetStateTimeout=0,n.on("unload",this._destroy,this)},addHooks:function(){Rt(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){Kt(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){re(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){this._resetStateTimeout!==0&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(n){if(!n.shiftKey||n.which!==1&&n.button!==1)return!1;this._clearDeferredResetState(),this._resetState(),Zn(),Hn(),this._startPoint=this._map.mouseEventToContainerPoint(n),Rt(document,{contextmenu:Di,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(n){this._moved||(this._moved=!0,this._box=jt("div","leaflet-zoom-box",this._container),Ft(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(n);var a=new q(this._point,this._startPoint),c=a.getSize();ue(this._box,a.min),this._box.style.width=c.x+"px",this._box.style.height=c.y+"px"},_finish:function(){this._moved&&(re(this._box),ae(this._container,"leaflet-crosshair")),Gn(),xr(),Kt(document,{contextmenu:Di,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(n){if(!(n.which!==1&&n.button!==1)&&(this._finish(),!!this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(o(this._resetState,this),0);var a=new dt(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(a).fire("boxzoomend",{boxZoomBounds:a})}},_onKeyDown:function(n){n.keyCode===27&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});Vt.addInitHook("addHandler","boxZoom",zl),Vt.mergeOptions({doubleClickZoom:!0});var Il=li.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(n){var a=this._map,c=a.getZoom(),_=a.options.zoomDelta,T=n.originalEvent.shiftKey?c-_:c+_;a.options.doubleClickZoom==="center"?a.setZoom(T):a.setZoomAround(n.containerPoint,T)}});Vt.addInitHook("addHandler","doubleClickZoom",Il),Vt.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var Ol=li.extend({addHooks:function(){if(!this._draggable){var n=this._map;this._draggable=new Bi(n._mapPane,n._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),n.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),n.on("zoomend",this._onZoomEnd,this),n.whenReady(this._onZoomEnd,this))}Ft(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){ae(this._map._container,"leaflet-grab"),ae(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var n=this._map;if(n._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var a=ct(this._map.options.maxBounds);this._offsetLimit=Q(this._map.latLngToContainerPoint(a.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(a.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;n.fire("movestart").fire("dragstart"),n.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(n){if(this._map.options.inertia){var a=this._lastTime=+new Date,c=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(c),this._times.push(a),this._prunePositions(a)}this._map.fire("move",n).fire("drag",n)},_prunePositions:function(n){for(;this._positions.length>1&&n-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var n=this._map.getSize().divideBy(2),a=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=a.subtract(n).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(n,a){return n-(n-a)*this._viscosity},_onPreDragLimit:function(){if(!(!this._viscosity||!this._offsetLimit)){var n=this._draggable._newPos.subtract(this._draggable._startPos),a=this._offsetLimit;n.x<a.min.x&&(n.x=this._viscousLimit(n.x,a.min.x)),n.y<a.min.y&&(n.y=this._viscousLimit(n.y,a.min.y)),n.x>a.max.x&&(n.x=this._viscousLimit(n.x,a.max.x)),n.y>a.max.y&&(n.y=this._viscousLimit(n.y,a.max.y)),this._draggable._newPos=this._draggable._startPos.add(n)}},_onPreDragWrap:function(){var n=this._worldWidth,a=Math.round(n/2),c=this._initialWorldOffset,_=this._draggable._newPos.x,T=(_-a+c)%n+a-c,R=(_+a+c)%n-a-c,$=Math.abs(T+c)<Math.abs(R+c)?T:R;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=$},_onDragEnd:function(n){var a=this._map,c=a.options,_=!c.inertia||n.noInertia||this._times.length<2;if(a.fire("dragend",n),_)a.fire("moveend");else{this._prunePositions(+new Date);var T=this._lastPos.subtract(this._positions[0]),R=(this._lastTime-this._times[0])/1e3,$=c.easeLinearity,nt=T.multiplyBy($/R),st=nt.distanceTo([0,0]),pt=Math.min(c.inertiaMaxSpeed,st),Mt=nt.multiplyBy(pt/st),It=pt/(c.inertiaDeceleration*$),Gt=Mt.multiplyBy(-It/2).round();!Gt.x&&!Gt.y?a.fire("moveend"):(Gt=a._limitOffset(Gt,a.options.maxBounds),N(function(){a.panBy(Gt,{duration:It,easeLinearity:$,noMoveStart:!0,animate:!0})}))}}});Vt.addInitHook("addHandler","dragging",Ol),Vt.mergeOptions({keyboard:!0,keyboardPanDelta:80});var Rl=li.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(n){this._map=n,this._setPanDelta(n.options.keyboardPanDelta),this._setZoomDelta(n.options.zoomDelta)},addHooks:function(){var n=this._map._container;n.tabIndex<=0&&(n.tabIndex="0"),Rt(n,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),Kt(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var n=document.body,a=document.documentElement,c=n.scrollTop||a.scrollTop,_=n.scrollLeft||a.scrollLeft;this._map._container.focus(),window.scrollTo(_,c)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(n){var a=this._panKeys={},c=this.keyCodes,_,T;for(_=0,T=c.left.length;_<T;_++)a[c.left[_]]=[-1*n,0];for(_=0,T=c.right.length;_<T;_++)a[c.right[_]]=[n,0];for(_=0,T=c.down.length;_<T;_++)a[c.down[_]]=[0,n];for(_=0,T=c.up.length;_<T;_++)a[c.up[_]]=[0,-1*n]},_setZoomDelta:function(n){var a=this._zoomKeys={},c=this.keyCodes,_,T;for(_=0,T=c.zoomIn.length;_<T;_++)a[c.zoomIn[_]]=n;for(_=0,T=c.zoomOut.length;_<T;_++)a[c.zoomOut[_]]=-n},_addHooks:function(){Rt(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){Kt(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(n){if(!(n.altKey||n.ctrlKey||n.metaKey)){var a=n.keyCode,c=this._map,_;if(a in this._panKeys){if(!c._panAnim||!c._panAnim._inProgress)if(_=this._panKeys[a],n.shiftKey&&(_=tt(_).multiplyBy(3)),c.options.maxBounds&&(_=c._limitOffset(tt(_),c.options.maxBounds)),c.options.worldCopyJump){var T=c.wrapLatLng(c.unproject(c.project(c.getCenter()).add(_)));c.panTo(T)}else c.panBy(_)}else if(a in this._zoomKeys)c.setZoom(c.getZoom()+(n.shiftKey?3:1)*this._zoomKeys[a]);else if(a===27&&c._popup&&c._popup.options.closeOnEscapeKey)c.closePopup();else return;Di(n)}}});Vt.addInitHook("addHandler","keyboard",Rl),Vt.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var Dl=li.extend({addHooks:function(){Rt(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){Kt(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(n){var a=yo(n),c=this._map.options.wheelDebounceTime;this._delta+=a,this._lastMousePos=this._map.mouseEventToContainerPoint(n),this._startTime||(this._startTime=+new Date);var _=Math.max(c-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(o(this._performZoom,this),_),Di(n)},_performZoom:function(){var n=this._map,a=n.getZoom(),c=this._map.options.zoomSnap||0;n._stop();var _=this._delta/(this._map.options.wheelPxPerZoomLevel*4),T=4*Math.log(2/(1+Math.exp(-Math.abs(_))))/Math.LN2,R=c?Math.ceil(T/c)*c:T,$=n._limitZoom(a+(this._delta>0?R:-R))-a;this._delta=0,this._startTime=null,$&&(n.options.scrollWheelZoom==="center"?n.setZoom(a+$):n.setZoomAround(this._lastMousePos,a+$))}});Vt.addInitHook("addHandler","scrollWheelZoom",Dl);var pf=600;Vt.mergeOptions({tapHold:At.touchNative&&At.safari&&At.mobile,tapTolerance:15});var Bl=li.extend({addHooks:function(){Rt(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){Kt(this._map._container,"touchstart",this._onDown,this)},_onDown:function(n){if(clearTimeout(this._holdTimeout),n.touches.length===1){var a=n.touches[0];this._startPos=this._newPos=new W(a.clientX,a.clientY),this._holdTimeout=setTimeout(o(function(){this._cancel(),this._isTapValid()&&(Rt(document,"touchend",be),Rt(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",a))},this),pf),Rt(document,"touchend touchcancel contextmenu",this._cancel,this),Rt(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function n(){Kt(document,"touchend",be),Kt(document,"touchend touchcancel",n)},_cancel:function(){clearTimeout(this._holdTimeout),Kt(document,"touchend touchcancel contextmenu",this._cancel,this),Kt(document,"touchmove",this._onMove,this)},_onMove:function(n){var a=n.touches[0];this._newPos=new W(a.clientX,a.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(n,a){var c=new MouseEvent(n,{bubbles:!0,cancelable:!0,view:window,screenX:a.screenX,screenY:a.screenY,clientX:a.clientX,clientY:a.clientY});c._simulated=!0,a.target.dispatchEvent(c)}});Vt.addInitHook("addHandler","tapHold",Bl),Vt.mergeOptions({touchZoom:At.touch,bounceAtZoomLimits:!0});var Nl=li.extend({addHooks:function(){Ft(this._map._container,"leaflet-touch-zoom"),Rt(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){ae(this._map._container,"leaflet-touch-zoom"),Kt(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(n){var a=this._map;if(!(!n.touches||n.touches.length!==2||a._animatingZoom||this._zooming)){var c=a.mouseEventToContainerPoint(n.touches[0]),_=a.mouseEventToContainerPoint(n.touches[1]);this._centerPoint=a.getSize()._divideBy(2),this._startLatLng=a.containerPointToLatLng(this._centerPoint),a.options.touchZoom!=="center"&&(this._pinchStartLatLng=a.containerPointToLatLng(c.add(_)._divideBy(2))),this._startDist=c.distanceTo(_),this._startZoom=a.getZoom(),this._moved=!1,this._zooming=!0,a._stop(),Rt(document,"touchmove",this._onTouchMove,this),Rt(document,"touchend touchcancel",this._onTouchEnd,this),be(n)}},_onTouchMove:function(n){if(!(!n.touches||n.touches.length!==2||!this._zooming)){var a=this._map,c=a.mouseEventToContainerPoint(n.touches[0]),_=a.mouseEventToContainerPoint(n.touches[1]),T=c.distanceTo(_)/this._startDist;if(this._zoom=a.getScaleZoom(T,this._startZoom),!a.options.bounceAtZoomLimits&&(this._zoom<a.getMinZoom()&&T<1||this._zoom>a.getMaxZoom()&&T>1)&&(this._zoom=a._limitZoom(this._zoom)),a.options.touchZoom==="center"){if(this._center=this._startLatLng,T===1)return}else{var R=c._add(_)._divideBy(2)._subtract(this._centerPoint);if(T===1&&R.x===0&&R.y===0)return;this._center=a.unproject(a.project(this._pinchStartLatLng,this._zoom).subtract(R),this._zoom)}this._moved||(a._moveStart(!0,!1),this._moved=!0),E(this._animRequest);var $=o(a._move,a,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=N($,this,!0),be(n)}},_onTouchEnd:function(){if(!this._moved||!this._zooming){this._zooming=!1;return}this._zooming=!1,E(this._animRequest),Kt(document,"touchmove",this._onTouchMove,this),Kt(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))}});Vt.addInitHook("addHandler","touchZoom",Nl),Vt.BoxZoom=zl,Vt.DoubleClickZoom=Il,Vt.Drag=Ol,Vt.Keyboard=Rl,Vt.ScrollWheelZoom=Dl,Vt.TapHold=Bl,Vt.TouchZoom=Nl,e.Bounds=q,e.Browser=At,e.CRS=Et,e.Canvas=kl,e.Circle=vn,e.CircleMarker=vi,e.Class=y,e.Control=Re,e.DivIcon=xi,e.DivOverlay=Ut,e.DomEvent=$a,e.DomUtil=Ja,e.Draggable=Bi,e.Evented=G,e.FeatureGroup=Ce,e.GeoJSON=Me,e.GridLayer=Xe,e.Handler=li,e.Icon=Ze,e.ImageOverlay=wt,e.LatLng=rt,e.LatLngBounds=dt,e.Layer=Pe,e.LayerGroup=gn,e.LineUtil=Ao,e.Map=Vt,e.Marker=Qi,e.Mixin=ih,e.Path=pe,e.Point=W,e.PolyUtil=br,e.Polygon=tn,e.Polyline=ci,e.Popup=te,e.PosAnimation=vo,e.Projection=Mr,e.Rectangle=Cl,e.Renderer=nn,e.SVG=ks,e.SVGOverlay=Dt,e.TileLayer=bi,e.Tooltip=fe,e.Transformation=vt,e.Util=C,e.VideoOverlay=Lt,e.bind=o,e.bounds=Q,e.canvas=Al,e.circle=Tr,e.circleMarker=Io,e.control=Vn,e.divIcon=wi,e.extend=i,e.featureGroup=ke,e.geoJSON=Y,e.geoJson=ot,e.gridLayer=Bo,e.icon=Ts,e.imageOverlay=yt,e.latLng=mt,e.latLngBounds=ct,e.layerGroup=yn,e.map=Ka,e.marker=Er,e.point=tt,e.polygon=Ro,e.polyline=Oo,e.popup=me,e.rectangle=df,e.setOptions=v,e.stamp=u,e.svg=Pl,e.svgOverlay=Qt,e.tileLayer=Jn,e.tooltip=Le,e.transformation=ht,e.version=r,e.videoOverlay=Ct;var mf=window.L;e.noConflict=function(){return window.L=mf,this},window.L=e})}(Ds,Ds.exports)),Ds.exports}var ep=tp();const ip=gl(ep);(function(h,t,e){function r(i,s){for(;(i=i.parentElement)&&!i.classList.contains(s););return i}L.drawVersion="1.0.4",L.Draw={},L.drawLocal={draw:{toolbar:{actions:{title:"Cancel drawing",text:"Cancel"},finish:{title:"Finish drawing",text:"Finish"},undo:{title:"Delete last point drawn",text:"Delete last point"},buttons:{polyline:"Draw a polyline",polygon:"Draw a polygon",rectangle:"Draw a rectangle",circle:"Draw a circle",marker:"Draw a marker",circlemarker:"Draw a circlemarker"}},handlers:{circle:{tooltip:{start:"Click and drag to draw circle."},radius:"Radius"},circlemarker:{tooltip:{start:"Click map to place circle marker."}},marker:{tooltip:{start:"Click map to place marker."}},polygon:{tooltip:{start:"Click to start drawing shape.",cont:"Click to continue drawing shape.",end:"Click first point to close this shape."}},polyline:{error:"<strong>Error:</strong> shape edges cannot cross!",tooltip:{start:"Click to start drawing line.",cont:"Click to continue drawing line.",end:"Click last point to finish line."}},rectangle:{tooltip:{start:"Click and drag to draw rectangle."}},simpleshape:{tooltip:{end:"Release mouse to finish drawing."}}}},edit:{toolbar:{actions:{save:{title:"Save changes",text:"Save"},cancel:{title:"Cancel editing, discards all changes",text:"Cancel"},clearAll:{title:"Clear all layers",text:"Clear All"}},buttons:{edit:"Edit layers",editDisabled:"No layers to edit",remove:"Delete layers",removeDisabled:"No layers to delete"}},handlers:{edit:{tooltip:{text:"Drag handles or markers to edit features.",subtext:"Click cancel to undo changes."}},remove:{tooltip:{text:"Click on a feature to remove."}}}}},L.Draw.Event={},L.Draw.Event.CREATED="draw:created",L.Draw.Event.EDITED="draw:edited",L.Draw.Event.DELETED="draw:deleted",L.Draw.Event.DRAWSTART="draw:drawstart",L.Draw.Event.DRAWSTOP="draw:drawstop",L.Draw.Event.DRAWVERTEX="draw:drawvertex",L.Draw.Event.EDITSTART="draw:editstart",L.Draw.Event.EDITMOVE="draw:editmove",L.Draw.Event.EDITRESIZE="draw:editresize",L.Draw.Event.EDITVERTEX="draw:editvertex",L.Draw.Event.EDITSTOP="draw:editstop",L.Draw.Event.DELETESTART="draw:deletestart",L.Draw.Event.DELETESTOP="draw:deletestop",L.Draw.Event.TOOLBAROPENED="draw:toolbaropened",L.Draw.Event.TOOLBARCLOSED="draw:toolbarclosed",L.Draw.Event.MARKERCONTEXT="draw:markercontext",L.Draw=L.Draw||{},L.Draw.Feature=L.Handler.extend({initialize:function(i,s){this._map=i,this._container=i._container,this._overlayPane=i._panes.overlayPane,this._popupPane=i._panes.popupPane,s&&s.shapeOptions&&(s.shapeOptions=L.Util.extend({},this.options.shapeOptions,s.shapeOptions)),L.setOptions(this,s);var o=L.version.split(".");parseInt(o[0],10)===1&&parseInt(o[1],10)>=2?L.Draw.Feature.include(L.Evented.prototype):L.Draw.Feature.include(L.Mixin.Events)},enable:function(){this._enabled||(L.Handler.prototype.enable.call(this),this.fire("enabled",{handler:this.type}),this._map.fire(L.Draw.Event.DRAWSTART,{layerType:this.type}))},disable:function(){this._enabled&&(L.Handler.prototype.disable.call(this),this._map.fire(L.Draw.Event.DRAWSTOP,{layerType:this.type}),this.fire("disabled",{handler:this.type}))},addHooks:function(){var i=this._map;i&&(L.DomUtil.disableTextSelection(),i.getContainer().focus(),this._tooltip=new L.Draw.Tooltip(this._map),L.DomEvent.on(this._container,"keyup",this._cancelDrawing,this))},removeHooks:function(){this._map&&(L.DomUtil.enableTextSelection(),this._tooltip.dispose(),this._tooltip=null,L.DomEvent.off(this._container,"keyup",this._cancelDrawing,this))},setOptions:function(i){L.setOptions(this,i)},_fireCreatedEvent:function(i){this._map.fire(L.Draw.Event.CREATED,{layer:i,layerType:this.type})},_cancelDrawing:function(i){i.keyCode===27&&(this._map.fire("draw:canceled",{layerType:this.type}),this.disable())}}),L.Draw.Polyline=L.Draw.Feature.extend({statics:{TYPE:"polyline"},Poly:L.Polyline,options:{allowIntersection:!0,repeatMode:!1,drawError:{color:"#b00b00",timeout:2500},icon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon"}),touchIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-touch-icon"}),guidelineDistance:20,maxGuideLineLength:4e3,shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!1,clickable:!0},metric:!0,feet:!0,nautic:!1,showLength:!0,zIndexOffset:2e3,factor:1,maxPoints:0},initialize:function(i,s){L.Browser.touch&&(this.options.icon=this.options.touchIcon),this.options.drawError.message=L.drawLocal.draw.handlers.polyline.error,s&&s.drawError&&(s.drawError=L.Util.extend({},this.options.drawError,s.drawError)),this.type=L.Draw.Polyline.TYPE,L.Draw.Feature.prototype.initialize.call(this,i,s)},addHooks:function(){L.Draw.Feature.prototype.addHooks.call(this),this._map&&(this._markers=[],this._markerGroup=new L.LayerGroup,this._map.addLayer(this._markerGroup),this._poly=new L.Polyline([],this.options.shapeOptions),this._tooltip.updateContent(this._getTooltipText()),this._mouseMarker||(this._mouseMarker=L.marker(this._map.getCenter(),{icon:L.divIcon({className:"leaflet-mouse-marker",iconAnchor:[20,20],iconSize:[40,40]}),opacity:0,zIndexOffset:this.options.zIndexOffset})),this._mouseMarker.on("mouseout",this._onMouseOut,this).on("mousemove",this._onMouseMove,this).on("mousedown",this._onMouseDown,this).on("mouseup",this._onMouseUp,this).addTo(this._map),this._map.on("mouseup",this._onMouseUp,this).on("mousemove",this._onMouseMove,this).on("zoomlevelschange",this._onZoomEnd,this).on("touchstart",this._onTouch,this).on("zoomend",this._onZoomEnd,this))},removeHooks:function(){L.Draw.Feature.prototype.removeHooks.call(this),this._clearHideErrorTimeout(),this._cleanUpShape(),this._map.removeLayer(this._markerGroup),delete this._markerGroup,delete this._markers,this._map.removeLayer(this._poly),delete this._poly,this._mouseMarker.off("mousedown",this._onMouseDown,this).off("mouseout",this._onMouseOut,this).off("mouseup",this._onMouseUp,this).off("mousemove",this._onMouseMove,this),this._map.removeLayer(this._mouseMarker),delete this._mouseMarker,this._clearGuides(),this._map.off("mouseup",this._onMouseUp,this).off("mousemove",this._onMouseMove,this).off("zoomlevelschange",this._onZoomEnd,this).off("zoomend",this._onZoomEnd,this).off("touchstart",this._onTouch,this).off("click",this._onTouch,this)},deleteLastVertex:function(){if(!(this._markers.length<=1)){var i=this._markers.pop(),s=this._poly,o=s.getLatLngs(),l=o.splice(-1,1)[0];this._poly.setLatLngs(o),this._markerGroup.removeLayer(i),s.getLatLngs().length<2&&this._map.removeLayer(s),this._vertexChanged(l,!1)}},addVertex:function(i){if(this._markers.length>=2&&!this.options.allowIntersection&&this._poly.newLatLngIntersects(i))return void this._showErrorTooltip();this._errorShown&&this._hideErrorTooltip(),this._markers.push(this._createMarker(i)),this._poly.addLatLng(i),this._poly.getLatLngs().length===2&&this._map.addLayer(this._poly),this._vertexChanged(i,!0)},completeShape:function(){this._markers.length<=1||!this._shapeIsValid()||(this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable())},_finishShape:function(){var i=this._poly._defaultShape?this._poly._defaultShape():this._poly.getLatLngs(),s=this._poly.newLatLngIntersects(i[i.length-1]);if(!this.options.allowIntersection&&s||!this._shapeIsValid())return void this._showErrorTooltip();this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable()},_shapeIsValid:function(){return!0},_onZoomEnd:function(){this._markers!==null&&this._updateGuide()},_onMouseMove:function(i){var s=this._map.mouseEventToLayerPoint(i.originalEvent),o=this._map.layerPointToLatLng(s);this._currentLatLng=o,this._updateTooltip(o),this._updateGuide(s),this._mouseMarker.setLatLng(o),L.DomEvent.preventDefault(i.originalEvent)},_vertexChanged:function(i,s){this._map.fire(L.Draw.Event.DRAWVERTEX,{layers:this._markerGroup}),this._updateFinishHandler(),this._updateRunningMeasure(i,s),this._clearGuides(),this._updateTooltip()},_onMouseDown:function(i){if(!this._clickHandled&&!this._touchHandled&&!this._disableMarkers){this._onMouseMove(i),this._clickHandled=!0,this._disableNewMarkers();var s=i.originalEvent,o=s.clientX,l=s.clientY;this._startPoint.call(this,o,l)}},_startPoint:function(i,s){this._mouseDownOrigin=L.point(i,s)},_onMouseUp:function(i){var s=i.originalEvent,o=s.clientX,l=s.clientY;this._endPoint.call(this,o,l,i),this._clickHandled=null},_endPoint:function(i,s,o){if(this._mouseDownOrigin){var l=L.point(i,s).distanceTo(this._mouseDownOrigin),u=this._calculateFinishDistance(o.latlng);this.options.maxPoints>1&&this.options.maxPoints==this._markers.length+1?(this.addVertex(o.latlng),this._finishShape()):u<10&&L.Browser.touch?this._finishShape():Math.abs(l)<9*(h.devicePixelRatio||1)&&this.addVertex(o.latlng),this._enableNewMarkers()}this._mouseDownOrigin=null},_onTouch:function(i){var s,o,l=i.originalEvent;!l.touches||!l.touches[0]||this._clickHandled||this._touchHandled||this._disableMarkers||(s=l.touches[0].clientX,o=l.touches[0].clientY,this._disableNewMarkers(),this._touchHandled=!0,this._startPoint.call(this,s,o),this._endPoint.call(this,s,o,i),this._touchHandled=null),this._clickHandled=null},_onMouseOut:function(){this._tooltip&&this._tooltip._onMouseOut.call(this._tooltip)},_calculateFinishDistance:function(i){var s;if(this._markers.length>0){var o;if(this.type===L.Draw.Polyline.TYPE)o=this._markers[this._markers.length-1];else{if(this.type!==L.Draw.Polygon.TYPE)return 1/0;o=this._markers[0]}var l=this._map.latLngToContainerPoint(o.getLatLng()),u=new L.Marker(i,{icon:this.options.icon,zIndexOffset:2*this.options.zIndexOffset}),f=this._map.latLngToContainerPoint(u.getLatLng());s=l.distanceTo(f)}else s=1/0;return s},_updateFinishHandler:function(){var i=this._markers.length;i>1&&this._markers[i-1].on("click",this._finishShape,this),i>2&&this._markers[i-2].off("click",this._finishShape,this)},_createMarker:function(i){var s=new L.Marker(i,{icon:this.options.icon,zIndexOffset:2*this.options.zIndexOffset});return this._markerGroup.addLayer(s),s},_updateGuide:function(i){var s=this._markers?this._markers.length:0;s>0&&(i=i||this._map.latLngToLayerPoint(this._currentLatLng),this._clearGuides(),this._drawGuide(this._map.latLngToLayerPoint(this._markers[s-1].getLatLng()),i))},_updateTooltip:function(i){var s=this._getTooltipText();i&&this._tooltip.updatePosition(i),this._errorShown||this._tooltip.updateContent(s)},_drawGuide:function(i,s){var o,l,u,f=Math.floor(Math.sqrt(Math.pow(s.x-i.x,2)+Math.pow(s.y-i.y,2))),d=this.options.guidelineDistance,p=this.options.maxGuideLineLength,g=f>p?f-p:d;for(this._guidesContainer||(this._guidesContainer=L.DomUtil.create("div","leaflet-draw-guides",this._overlayPane));g<f;g+=this.options.guidelineDistance)o=g/f,l={x:Math.floor(i.x*(1-o)+o*s.x),y:Math.floor(i.y*(1-o)+o*s.y)},u=L.DomUtil.create("div","leaflet-draw-guide-dash",this._guidesContainer),u.style.backgroundColor=this._errorShown?this.options.drawError.color:this.options.shapeOptions.color,L.DomUtil.setPosition(u,l)},_updateGuideColor:function(i){if(this._guidesContainer)for(var s=0,o=this._guidesContainer.childNodes.length;s<o;s++)this._guidesContainer.childNodes[s].style.backgroundColor=i},_clearGuides:function(){if(this._guidesContainer)for(;this._guidesContainer.firstChild;)this._guidesContainer.removeChild(this._guidesContainer.firstChild)},_getTooltipText:function(){var i,s,o=this.options.showLength;return this._markers.length===0?i={text:L.drawLocal.draw.handlers.polyline.tooltip.start}:(s=o?this._getMeasurementString():"",i=this._markers.length===1?{text:L.drawLocal.draw.handlers.polyline.tooltip.cont,subtext:s}:{text:L.drawLocal.draw.handlers.polyline.tooltip.end,subtext:s}),i},_updateRunningMeasure:function(i,s){var o,l,u=this._markers.length;this._markers.length===1?this._measurementRunningTotal=0:(o=u-(s?2:1),l=L.GeometryUtil.isVersion07x()?i.distanceTo(this._markers[o].getLatLng())*(this.options.factor||1):this._map.distance(i,this._markers[o].getLatLng())*(this.options.factor||1),this._measurementRunningTotal+=l*(s?1:-1))},_getMeasurementString:function(){var i,s=this._currentLatLng,o=this._markers[this._markers.length-1].getLatLng();return i=L.GeometryUtil.isVersion07x()?o&&s&&s.distanceTo?this._measurementRunningTotal+s.distanceTo(o)*(this.options.factor||1):this._measurementRunningTotal||0:o&&s?this._measurementRunningTotal+this._map.distance(s,o)*(this.options.factor||1):this._measurementRunningTotal||0,L.GeometryUtil.readableDistance(i,this.options.metric,this.options.feet,this.options.nautic,this.options.precision)},_showErrorTooltip:function(){this._errorShown=!0,this._tooltip.showAsError().updateContent({text:this.options.drawError.message}),this._updateGuideColor(this.options.drawError.color),this._poly.setStyle({color:this.options.drawError.color}),this._clearHideErrorTimeout(),this._hideErrorTimeout=setTimeout(L.Util.bind(this._hideErrorTooltip,this),this.options.drawError.timeout)},_hideErrorTooltip:function(){this._errorShown=!1,this._clearHideErrorTimeout(),this._tooltip.removeError().updateContent(this._getTooltipText()),this._updateGuideColor(this.options.shapeOptions.color),this._poly.setStyle({color:this.options.shapeOptions.color})},_clearHideErrorTimeout:function(){this._hideErrorTimeout&&(clearTimeout(this._hideErrorTimeout),this._hideErrorTimeout=null)},_disableNewMarkers:function(){this._disableMarkers=!0},_enableNewMarkers:function(){setTimeout((function(){this._disableMarkers=!1}).bind(this),50)},_cleanUpShape:function(){this._markers.length>1&&this._markers[this._markers.length-1].off("click",this._finishShape,this)},_fireCreatedEvent:function(){var i=new this.Poly(this._poly.getLatLngs(),this.options.shapeOptions);L.Draw.Feature.prototype._fireCreatedEvent.call(this,i)}}),L.Draw.Polygon=L.Draw.Polyline.extend({statics:{TYPE:"polygon"},Poly:L.Polygon,options:{showArea:!1,showLength:!1,shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0},metric:!0,feet:!0,nautic:!1,precision:{}},initialize:function(i,s){L.Draw.Polyline.prototype.initialize.call(this,i,s),this.type=L.Draw.Polygon.TYPE},_updateFinishHandler:function(){var i=this._markers.length;i===1&&this._markers[0].on("click",this._finishShape,this),i>2&&(this._markers[i-1].on("dblclick",this._finishShape,this),i>3&&this._markers[i-2].off("dblclick",this._finishShape,this))},_getTooltipText:function(){var i,s;return this._markers.length===0?i=L.drawLocal.draw.handlers.polygon.tooltip.start:this._markers.length<3?(i=L.drawLocal.draw.handlers.polygon.tooltip.cont,s=this._getMeasurementString()):(i=L.drawLocal.draw.handlers.polygon.tooltip.end,s=this._getMeasurementString()),{text:i,subtext:s}},_getMeasurementString:function(){var i=this._area,s="";return i||this.options.showLength?(this.options.showLength&&(s=L.Draw.Polyline.prototype._getMeasurementString.call(this)),i&&(s+="<br>"+L.GeometryUtil.readableArea(i,this.options.metric,this.options.precision)),s):null},_shapeIsValid:function(){return this._markers.length>=3},_vertexChanged:function(i,s){var o;!this.options.allowIntersection&&this.options.showArea&&(o=this._poly.getLatLngs(),this._area=L.GeometryUtil.geodesicArea(o)),L.Draw.Polyline.prototype._vertexChanged.call(this,i,s)},_cleanUpShape:function(){var i=this._markers.length;i>0&&(this._markers[0].off("click",this._finishShape,this),i>2&&this._markers[i-1].off("dblclick",this._finishShape,this))}}),L.SimpleShape={},L.Draw.SimpleShape=L.Draw.Feature.extend({options:{repeatMode:!1},initialize:function(i,s){this._endLabelText=L.drawLocal.draw.handlers.simpleshape.tooltip.end,L.Draw.Feature.prototype.initialize.call(this,i,s)},addHooks:function(){L.Draw.Feature.prototype.addHooks.call(this),this._map&&(this._mapDraggable=this._map.dragging.enabled(),this._mapDraggable&&this._map.dragging.disable(),this._container.style.cursor="crosshair",this._tooltip.updateContent({text:this._initialLabelText}),this._map.on("mousedown",this._onMouseDown,this).on("mousemove",this._onMouseMove,this).on("touchstart",this._onMouseDown,this).on("touchmove",this._onMouseMove,this),t.addEventListener("touchstart",L.DomEvent.preventDefault,{passive:!1}))},removeHooks:function(){L.Draw.Feature.prototype.removeHooks.call(this),this._map&&(this._mapDraggable&&this._map.dragging.enable(),this._container.style.cursor="",this._map.off("mousedown",this._onMouseDown,this).off("mousemove",this._onMouseMove,this).off("touchstart",this._onMouseDown,this).off("touchmove",this._onMouseMove,this),L.DomEvent.off(t,"mouseup",this._onMouseUp,this),L.DomEvent.off(t,"touchend",this._onMouseUp,this),t.removeEventListener("touchstart",L.DomEvent.preventDefault),this._shape&&(this._map.removeLayer(this._shape),delete this._shape)),this._isDrawing=!1},_getTooltipText:function(){return{text:this._endLabelText}},_onMouseDown:function(i){this._isDrawing=!0,this._startLatLng=i.latlng,L.DomEvent.on(t,"mouseup",this._onMouseUp,this).on(t,"touchend",this._onMouseUp,this).preventDefault(i.originalEvent)},_onMouseMove:function(i){var s=i.latlng;this._tooltip.updatePosition(s),this._isDrawing&&(this._tooltip.updateContent(this._getTooltipText()),this._drawShape(s))},_onMouseUp:function(){this._shape&&this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable()}}),L.Draw.Rectangle=L.Draw.SimpleShape.extend({statics:{TYPE:"rectangle"},options:{shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0},showArea:!0,metric:!0},initialize:function(i,s){this.type=L.Draw.Rectangle.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.rectangle.tooltip.start,L.Draw.SimpleShape.prototype.initialize.call(this,i,s)},disable:function(){this._enabled&&(this._isCurrentlyTwoClickDrawing=!1,L.Draw.SimpleShape.prototype.disable.call(this))},_onMouseUp:function(i){if(!this._shape&&!this._isCurrentlyTwoClickDrawing)return void(this._isCurrentlyTwoClickDrawing=!0);this._isCurrentlyTwoClickDrawing&&!r(i.target,"leaflet-pane")||L.Draw.SimpleShape.prototype._onMouseUp.call(this)},_drawShape:function(i){this._shape?this._shape.setBounds(new L.LatLngBounds(this._startLatLng,i)):(this._shape=new L.Rectangle(new L.LatLngBounds(this._startLatLng,i),this.options.shapeOptions),this._map.addLayer(this._shape))},_fireCreatedEvent:function(){var i=new L.Rectangle(this._shape.getBounds(),this.options.shapeOptions);L.Draw.SimpleShape.prototype._fireCreatedEvent.call(this,i)},_getTooltipText:function(){var i,s,o,l=L.Draw.SimpleShape.prototype._getTooltipText.call(this),u=this._shape,f=this.options.showArea;return u&&(i=this._shape._defaultShape?this._shape._defaultShape():this._shape.getLatLngs(),s=L.GeometryUtil.geodesicArea(i),o=f?L.GeometryUtil.readableArea(s,this.options.metric):""),{text:l.text,subtext:o}}}),L.Draw.Marker=L.Draw.Feature.extend({statics:{TYPE:"marker"},options:{icon:new L.Icon.Default,repeatMode:!1,zIndexOffset:2e3},initialize:function(i,s){this.type=L.Draw.Marker.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.marker.tooltip.start,L.Draw.Feature.prototype.initialize.call(this,i,s)},addHooks:function(){L.Draw.Feature.prototype.addHooks.call(this),this._map&&(this._tooltip.updateContent({text:this._initialLabelText}),this._mouseMarker||(this._mouseMarker=L.marker(this._map.getCenter(),{icon:L.divIcon({className:"leaflet-mouse-marker",iconAnchor:[20,20],iconSize:[40,40]}),opacity:0,zIndexOffset:this.options.zIndexOffset})),this._mouseMarker.on("click",this._onClick,this).addTo(this._map),this._map.on("mousemove",this._onMouseMove,this),this._map.on("click",this._onTouch,this))},removeHooks:function(){L.Draw.Feature.prototype.removeHooks.call(this),this._map&&(this._map.off("click",this._onClick,this).off("click",this._onTouch,this),this._marker&&(this._marker.off("click",this._onClick,this),this._map.removeLayer(this._marker),delete this._marker),this._mouseMarker.off("click",this._onClick,this),this._map.removeLayer(this._mouseMarker),delete this._mouseMarker,this._map.off("mousemove",this._onMouseMove,this))},_onMouseMove:function(i){var s=i.latlng;this._tooltip.updatePosition(s),this._mouseMarker.setLatLng(s),this._marker?(s=this._mouseMarker.getLatLng(),this._marker.setLatLng(s)):(this._marker=this._createMarker(s),this._marker.on("click",this._onClick,this),this._map.on("click",this._onClick,this).addLayer(this._marker))},_createMarker:function(i){return new L.Marker(i,{icon:this.options.icon,zIndexOffset:this.options.zIndexOffset})},_onClick:function(){this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable()},_onTouch:function(i){this._onMouseMove(i),this._onClick()},_fireCreatedEvent:function(){var i=new L.Marker.Touch(this._marker.getLatLng(),{icon:this.options.icon});L.Draw.Feature.prototype._fireCreatedEvent.call(this,i)}}),L.Draw.CircleMarker=L.Draw.Marker.extend({statics:{TYPE:"circlemarker"},options:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0,zIndexOffset:2e3},initialize:function(i,s){this.type=L.Draw.CircleMarker.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.circlemarker.tooltip.start,L.Draw.Feature.prototype.initialize.call(this,i,s)},_fireCreatedEvent:function(){var i=new L.CircleMarker(this._marker.getLatLng(),this.options);L.Draw.Feature.prototype._fireCreatedEvent.call(this,i)},_createMarker:function(i){return new L.CircleMarker(i,this.options)}}),L.Draw.Circle=L.Draw.SimpleShape.extend({statics:{TYPE:"circle"},options:{shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0},showRadius:!0,metric:!0,feet:!0,nautic:!1},initialize:function(i,s){this.type=L.Draw.Circle.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.circle.tooltip.start,L.Draw.SimpleShape.prototype.initialize.call(this,i,s)},_drawShape:function(i){if(L.GeometryUtil.isVersion07x())var s=this._startLatLng.distanceTo(i);else var s=this._map.distance(this._startLatLng,i);this._shape?this._shape.setRadius(s):(this._shape=new L.Circle(this._startLatLng,s,this.options.shapeOptions),this._map.addLayer(this._shape))},_fireCreatedEvent:function(){var i=new L.Circle(this._startLatLng,this._shape.getRadius(),this.options.shapeOptions);L.Draw.SimpleShape.prototype._fireCreatedEvent.call(this,i)},_onMouseMove:function(i){var s,o=i.latlng,l=this.options.showRadius,u=this.options.metric;if(this._tooltip.updatePosition(o),this._isDrawing){this._drawShape(o),s=this._shape.getRadius().toFixed(1);var f="";l&&(f=L.drawLocal.draw.handlers.circle.radius+": "+L.GeometryUtil.readableDistance(s,u,this.options.feet,this.options.nautic)),this._tooltip.updateContent({text:this._endLabelText,subtext:f})}}}),L.Edit=L.Edit||{},L.Edit.Marker=L.Handler.extend({initialize:function(i,s){this._marker=i,L.setOptions(this,s)},addHooks:function(){var i=this._marker;i.dragging.enable(),i.on("dragend",this._onDragEnd,i),this._toggleMarkerHighlight()},removeHooks:function(){var i=this._marker;i.dragging.disable(),i.off("dragend",this._onDragEnd,i),this._toggleMarkerHighlight()},_onDragEnd:function(i){var s=i.target;s.edited=!0,this._map.fire(L.Draw.Event.EDITMOVE,{layer:s})},_toggleMarkerHighlight:function(){var i=this._marker._icon;i&&(i.style.display="none",L.DomUtil.hasClass(i,"leaflet-edit-marker-selected")?(L.DomUtil.removeClass(i,"leaflet-edit-marker-selected"),this._offsetMarker(i,-4)):(L.DomUtil.addClass(i,"leaflet-edit-marker-selected"),this._offsetMarker(i,4)),i.style.display="")},_offsetMarker:function(i,s){var o=parseInt(i.style.marginTop,10)-s,l=parseInt(i.style.marginLeft,10)-s;i.style.marginTop=o+"px",i.style.marginLeft=l+"px"}}),L.Marker.addInitHook(function(){L.Edit.Marker&&(this.editing=new L.Edit.Marker(this),this.options.editable&&this.editing.enable())}),L.Edit=L.Edit||{},L.Edit.Poly=L.Handler.extend({initialize:function(i){this.latlngs=[i._latlngs],i._holes&&(this.latlngs=this.latlngs.concat(i._holes)),this._poly=i,this._poly.on("revert-edited",this._updateLatLngs,this)},_defaultShape:function(){return L.Polyline._flat?L.Polyline._flat(this._poly._latlngs)?this._poly._latlngs:this._poly._latlngs[0]:this._poly._latlngs},_eachVertexHandler:function(i){for(var s=0;s<this._verticesHandlers.length;s++)i(this._verticesHandlers[s])},addHooks:function(){this._initHandlers(),this._eachVertexHandler(function(i){i.addHooks()})},removeHooks:function(){this._eachVertexHandler(function(i){i.removeHooks()})},updateMarkers:function(){this._eachVertexHandler(function(i){i.updateMarkers()})},_initHandlers:function(){this._verticesHandlers=[];for(var i=0;i<this.latlngs.length;i++)this._verticesHandlers.push(new L.Edit.PolyVerticesEdit(this._poly,this.latlngs[i],this._poly.options.poly))},_updateLatLngs:function(i){this.latlngs=[i.layer._latlngs],i.layer._holes&&(this.latlngs=this.latlngs.concat(i.layer._holes))}}),L.Edit.PolyVerticesEdit=L.Handler.extend({options:{icon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon"}),touchIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-touch-icon"}),drawError:{color:"#b00b00",timeout:1e3}},initialize:function(i,s,o){L.Browser.touch&&(this.options.icon=this.options.touchIcon),this._poly=i,o&&o.drawError&&(o.drawError=L.Util.extend({},this.options.drawError,o.drawError)),this._latlngs=s,L.setOptions(this,o)},_defaultShape:function(){return L.Polyline._flat?L.Polyline._flat(this._latlngs)?this._latlngs:this._latlngs[0]:this._latlngs},addHooks:function(){var i=this._poly,s=i._path;i instanceof L.Polygon||(i.options.fill=!1,i.options.editing&&(i.options.editing.fill=!1)),s&&i.options.editing&&i.options.editing.className&&(i.options.original.className&&i.options.original.className.split(" ").forEach(function(o){L.DomUtil.removeClass(s,o)}),i.options.editing.className.split(" ").forEach(function(o){L.DomUtil.addClass(s,o)})),i.setStyle(i.options.editing),this._poly._map&&(this._map=this._poly._map,this._markerGroup||this._initMarkers(),this._poly._map.addLayer(this._markerGroup))},removeHooks:function(){var i=this._poly,s=i._path;s&&i.options.editing&&i.options.editing.className&&(i.options.editing.className.split(" ").forEach(function(o){L.DomUtil.removeClass(s,o)}),i.options.original.className&&i.options.original.className.split(" ").forEach(function(o){L.DomUtil.addClass(s,o)})),i.setStyle(i.options.original),i._map&&(i._map.removeLayer(this._markerGroup),delete this._markerGroup,delete this._markers)},updateMarkers:function(){this._markerGroup.clearLayers(),this._initMarkers()},_initMarkers:function(){this._markerGroup||(this._markerGroup=new L.LayerGroup),this._markers=[];var i,s,o,l,u=this._defaultShape();for(i=0,o=u.length;i<o;i++)l=this._createMarker(u[i],i),l.on("click",this._onMarkerClick,this),l.on("contextmenu",this._onContextMenu,this),this._markers.push(l);var f,d;for(i=0,s=o-1;i<o;s=i++)(i!==0||L.Polygon&&this._poly instanceof L.Polygon)&&(f=this._markers[s],d=this._markers[i],this._createMiddleMarker(f,d),this._updatePrevNext(f,d))},_createMarker:function(i,s){var o=new L.Marker.Touch(i,{draggable:!0,icon:this.options.icon});return o._origLatLng=i,o._index=s,o.on("dragstart",this._onMarkerDragStart,this).on("drag",this._onMarkerDrag,this).on("dragend",this._fireEdit,this).on("touchmove",this._onTouchMove,this).on("touchend",this._fireEdit,this).on("MSPointerMove",this._onTouchMove,this).on("MSPointerUp",this._fireEdit,this),this._markerGroup.addLayer(o),o},_onMarkerDragStart:function(){this._poly.fire("editstart")},_spliceLatLngs:function(){var i=this._defaultShape(),s=[].splice.apply(i,arguments);return this._poly._convertLatLngs(i,!0),this._poly.redraw(),s},_removeMarker:function(i){var s=i._index;this._markerGroup.removeLayer(i),this._markers.splice(s,1),this._spliceLatLngs(s,1),this._updateIndexes(s,-1),i.off("dragstart",this._onMarkerDragStart,this).off("drag",this._onMarkerDrag,this).off("dragend",this._fireEdit,this).off("touchmove",this._onMarkerDrag,this).off("touchend",this._fireEdit,this).off("click",this._onMarkerClick,this).off("MSPointerMove",this._onTouchMove,this).off("MSPointerUp",this._fireEdit,this)},_fireEdit:function(){this._poly.edited=!0,this._poly.fire("edit"),this._poly._map.fire(L.Draw.Event.EDITVERTEX,{layers:this._markerGroup,poly:this._poly})},_onMarkerDrag:function(i){var s=i.target,o=this._poly,l=L.LatLngUtil.cloneLatLng(s._origLatLng);if(L.extend(s._origLatLng,s._latlng),o.options.poly){var u=o._map._editTooltip;if(!o.options.poly.allowIntersection&&o.intersects()){L.extend(s._origLatLng,l),s.setLatLng(l);var f=o.options.color;o.setStyle({color:this.options.drawError.color}),u&&u.updateContent({text:L.drawLocal.draw.handlers.polyline.error}),setTimeout(function(){o.setStyle({color:f}),u&&u.updateContent({text:L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.edit.handlers.edit.tooltip.subtext})},1e3)}}s._middleLeft&&s._middleLeft.setLatLng(this._getMiddleLatLng(s._prev,s)),s._middleRight&&s._middleRight.setLatLng(this._getMiddleLatLng(s,s._next)),this._poly._bounds._southWest=L.latLng(1/0,1/0),this._poly._bounds._northEast=L.latLng(-1/0,-1/0);var d=this._poly.getLatLngs();this._poly._convertLatLngs(d,!0),this._poly.redraw(),this._poly.fire("editdrag")},_onMarkerClick:function(i){var s=L.Polygon&&this._poly instanceof L.Polygon?4:3,o=i.target;this._defaultShape().length<s||(this._removeMarker(o),this._updatePrevNext(o._prev,o._next),o._middleLeft&&this._markerGroup.removeLayer(o._middleLeft),o._middleRight&&this._markerGroup.removeLayer(o._middleRight),o._prev&&o._next?this._createMiddleMarker(o._prev,o._next):o._prev?o._next||(o._prev._middleRight=null):o._next._middleLeft=null,this._fireEdit())},_onContextMenu:function(i){var s=i.target;this._poly,this._poly._map.fire(L.Draw.Event.MARKERCONTEXT,{marker:s,layers:this._markerGroup,poly:this._poly}),L.DomEvent.stopPropagation},_onTouchMove:function(i){var s=this._map.mouseEventToLayerPoint(i.originalEvent.touches[0]),o=this._map.layerPointToLatLng(s),l=i.target;L.extend(l._origLatLng,o),l._middleLeft&&l._middleLeft.setLatLng(this._getMiddleLatLng(l._prev,l)),l._middleRight&&l._middleRight.setLatLng(this._getMiddleLatLng(l,l._next)),this._poly.redraw(),this.updateMarkers()},_updateIndexes:function(i,s){this._markerGroup.eachLayer(function(o){o._index>i&&(o._index+=s)})},_createMiddleMarker:function(i,s){var o,l,u,f=this._getMiddleLatLng(i,s),d=this._createMarker(f);d.setOpacity(.6),i._middleRight=s._middleLeft=d,l=function(){d.off("touchmove",l,this);var p=s._index;d._index=p,d.off("click",o,this).on("click",this._onMarkerClick,this),f.lat=d.getLatLng().lat,f.lng=d.getLatLng().lng,this._spliceLatLngs(p,0,f),this._markers.splice(p,0,d),d.setOpacity(1),this._updateIndexes(p,1),s._index++,this._updatePrevNext(i,d),this._updatePrevNext(d,s),this._poly.fire("editstart")},u=function(){d.off("dragstart",l,this),d.off("dragend",u,this),d.off("touchmove",l,this),this._createMiddleMarker(i,d),this._createMiddleMarker(d,s)},o=function(){l.call(this),u.call(this),this._fireEdit()},d.on("click",o,this).on("dragstart",l,this).on("dragend",u,this).on("touchmove",l,this),this._markerGroup.addLayer(d)},_updatePrevNext:function(i,s){i&&(i._next=s),s&&(s._prev=i)},_getMiddleLatLng:function(i,s){var o=this._poly._map,l=o.project(i.getLatLng()),u=o.project(s.getLatLng());return o.unproject(l._add(u)._divideBy(2))}}),L.Polyline.addInitHook(function(){this.editing||(L.Edit.Poly&&(this.editing=new L.Edit.Poly(this),this.options.editable&&this.editing.enable()),this.on("add",function(){this.editing&&this.editing.enabled()&&this.editing.addHooks()}),this.on("remove",function(){this.editing&&this.editing.enabled()&&this.editing.removeHooks()}))}),L.Edit=L.Edit||{},L.Edit.SimpleShape=L.Handler.extend({options:{moveIcon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-move"}),resizeIcon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-resize"}),touchMoveIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-move leaflet-touch-icon"}),touchResizeIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-resize leaflet-touch-icon"})},initialize:function(i,s){L.Browser.touch&&(this.options.moveIcon=this.options.touchMoveIcon,this.options.resizeIcon=this.options.touchResizeIcon),this._shape=i,L.Util.setOptions(this,s)},addHooks:function(){var i=this._shape;this._shape._map&&(this._map=this._shape._map,i.setStyle(i.options.editing),i._map&&(this._map=i._map,this._markerGroup||this._initMarkers(),this._map.addLayer(this._markerGroup)))},removeHooks:function(){var i=this._shape;if(i.setStyle(i.options.original),i._map){this._unbindMarker(this._moveMarker);for(var s=0,o=this._resizeMarkers.length;s<o;s++)this._unbindMarker(this._resizeMarkers[s]);this._resizeMarkers=null,this._map.removeLayer(this._markerGroup),delete this._markerGroup}this._map=null},updateMarkers:function(){this._markerGroup.clearLayers(),this._initMarkers()},_initMarkers:function(){this._markerGroup||(this._markerGroup=new L.LayerGroup),this._createMoveMarker(),this._createResizeMarker()},_createMoveMarker:function(){},_createResizeMarker:function(){},_createMarker:function(i,s){var o=new L.Marker.Touch(i,{draggable:!0,icon:s,zIndexOffset:10});return this._bindMarker(o),this._markerGroup.addLayer(o),o},_bindMarker:function(i){i.on("dragstart",this._onMarkerDragStart,this).on("drag",this._onMarkerDrag,this).on("dragend",this._onMarkerDragEnd,this).on("touchstart",this._onTouchStart,this).on("touchmove",this._onTouchMove,this).on("MSPointerMove",this._onTouchMove,this).on("touchend",this._onTouchEnd,this).on("MSPointerUp",this._onTouchEnd,this)},_unbindMarker:function(i){i.off("dragstart",this._onMarkerDragStart,this).off("drag",this._onMarkerDrag,this).off("dragend",this._onMarkerDragEnd,this).off("touchstart",this._onTouchStart,this).off("touchmove",this._onTouchMove,this).off("MSPointerMove",this._onTouchMove,this).off("touchend",this._onTouchEnd,this).off("MSPointerUp",this._onTouchEnd,this)},_onMarkerDragStart:function(i){i.target.setOpacity(0),this._shape.fire("editstart")},_fireEdit:function(){this._shape.edited=!0,this._shape.fire("edit")},_onMarkerDrag:function(i){var s=i.target,o=s.getLatLng();s===this._moveMarker?this._move(o):this._resize(o),this._shape.redraw(),this._shape.fire("editdrag")},_onMarkerDragEnd:function(i){i.target.setOpacity(1),this._fireEdit()},_onTouchStart:function(i){if(L.Edit.SimpleShape.prototype._onMarkerDragStart.call(this,i),typeof this._getCorners=="function"){var s=this._getCorners(),o=i.target,l=o._cornerIndex;o.setOpacity(0),this._oppositeCorner=s[(l+2)%4],this._toggleCornerMarkers(0,l)}this._shape.fire("editstart")},_onTouchMove:function(i){var s=this._map.mouseEventToLayerPoint(i.originalEvent.touches[0]),o=this._map.layerPointToLatLng(s);return i.target===this._moveMarker?this._move(o):this._resize(o),this._shape.redraw(),!1},_onTouchEnd:function(i){i.target.setOpacity(1),this.updateMarkers(),this._fireEdit()},_move:function(){},_resize:function(){}}),L.Edit=L.Edit||{},L.Edit.Rectangle=L.Edit.SimpleShape.extend({_createMoveMarker:function(){var i=this._shape.getBounds(),s=i.getCenter();this._moveMarker=this._createMarker(s,this.options.moveIcon)},_createResizeMarker:function(){var i=this._getCorners();this._resizeMarkers=[];for(var s=0,o=i.length;s<o;s++)this._resizeMarkers.push(this._createMarker(i[s],this.options.resizeIcon)),this._resizeMarkers[s]._cornerIndex=s},_onMarkerDragStart:function(i){L.Edit.SimpleShape.prototype._onMarkerDragStart.call(this,i);var s=this._getCorners(),o=i.target,l=o._cornerIndex;this._oppositeCorner=s[(l+2)%4],this._toggleCornerMarkers(0,l)},_onMarkerDragEnd:function(i){var s,o,l=i.target;l===this._moveMarker&&(s=this._shape.getBounds(),o=s.getCenter(),l.setLatLng(o)),this._toggleCornerMarkers(1),this._repositionCornerMarkers(),L.Edit.SimpleShape.prototype._onMarkerDragEnd.call(this,i)},_move:function(i){for(var s,o=this._shape._defaultShape?this._shape._defaultShape():this._shape.getLatLngs(),l=this._shape.getBounds(),u=l.getCenter(),f=[],d=0,p=o.length;d<p;d++)s=[o[d].lat-u.lat,o[d].lng-u.lng],f.push([i.lat+s[0],i.lng+s[1]]);this._shape.setLatLngs(f),this._repositionCornerMarkers(),this._map.fire(L.Draw.Event.EDITMOVE,{layer:this._shape})},_resize:function(i){var s;this._shape.setBounds(L.latLngBounds(i,this._oppositeCorner)),s=this._shape.getBounds(),this._moveMarker.setLatLng(s.getCenter()),this._map.fire(L.Draw.Event.EDITRESIZE,{layer:this._shape})},_getCorners:function(){var i=this._shape.getBounds();return[i.getNorthWest(),i.getNorthEast(),i.getSouthEast(),i.getSouthWest()]},_toggleCornerMarkers:function(i){for(var s=0,o=this._resizeMarkers.length;s<o;s++)this._resizeMarkers[s].setOpacity(i)},_repositionCornerMarkers:function(){for(var i=this._getCorners(),s=0,o=this._resizeMarkers.length;s<o;s++)this._resizeMarkers[s].setLatLng(i[s])}}),L.Rectangle.addInitHook(function(){L.Edit.Rectangle&&(this.editing=new L.Edit.Rectangle(this),this.options.editable&&this.editing.enable())}),L.Edit=L.Edit||{},L.Edit.CircleMarker=L.Edit.SimpleShape.extend({_createMoveMarker:function(){var i=this._shape.getLatLng();this._moveMarker=this._createMarker(i,this.options.moveIcon)},_createResizeMarker:function(){this._resizeMarkers=[]},_move:function(i){if(this._resizeMarkers.length){var s=this._getResizeMarkerPoint(i);this._resizeMarkers[0].setLatLng(s)}this._shape.setLatLng(i),this._map.fire(L.Draw.Event.EDITMOVE,{layer:this._shape})}}),L.CircleMarker.addInitHook(function(){L.Edit.CircleMarker&&(this.editing=new L.Edit.CircleMarker(this),this.options.editable&&this.editing.enable()),this.on("add",function(){this.editing&&this.editing.enabled()&&this.editing.addHooks()}),this.on("remove",function(){this.editing&&this.editing.enabled()&&this.editing.removeHooks()})}),L.Edit=L.Edit||{},L.Edit.Circle=L.Edit.CircleMarker.extend({_createResizeMarker:function(){var i=this._shape.getLatLng(),s=this._getResizeMarkerPoint(i);this._resizeMarkers=[],this._resizeMarkers.push(this._createMarker(s,this.options.resizeIcon))},_getResizeMarkerPoint:function(i){var s=this._shape._radius*Math.cos(Math.PI/4),o=this._map.project(i);return this._map.unproject([o.x+s,o.y-s])},_resize:function(i){var s=this._moveMarker.getLatLng();L.GeometryUtil.isVersion07x()?radius=s.distanceTo(i):radius=this._map.distance(s,i),this._shape.setRadius(radius),this._map.editTooltip&&this._map._editTooltip.updateContent({text:L.drawLocal.edit.handlers.edit.tooltip.subtext+"<br />"+L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.draw.handlers.circle.radius+": "+L.GeometryUtil.readableDistance(radius,!0,this.options.feet,this.options.nautic)}),this._shape.setRadius(radius),this._map.fire(L.Draw.Event.EDITRESIZE,{layer:this._shape})}}),L.Circle.addInitHook(function(){L.Edit.Circle&&(this.editing=new L.Edit.Circle(this),this.options.editable&&this.editing.enable())}),L.Map.mergeOptions({touchExtend:!0}),L.Map.TouchExtend=L.Handler.extend({initialize:function(i){this._map=i,this._container=i._container,this._pane=i._panes.overlayPane},addHooks:function(){L.DomEvent.on(this._container,"touchstart",this._onTouchStart,this),L.DomEvent.on(this._container,"touchend",this._onTouchEnd,this),L.DomEvent.on(this._container,"touchmove",this._onTouchMove,this),this._detectIE()?(L.DomEvent.on(this._container,"MSPointerDown",this._onTouchStart,this),L.DomEvent.on(this._container,"MSPointerUp",this._onTouchEnd,this),L.DomEvent.on(this._container,"MSPointerMove",this._onTouchMove,this),L.DomEvent.on(this._container,"MSPointerCancel",this._onTouchCancel,this)):(L.DomEvent.on(this._container,"touchcancel",this._onTouchCancel,this),L.DomEvent.on(this._container,"touchleave",this._onTouchLeave,this))},removeHooks:function(){L.DomEvent.off(this._container,"touchstart",this._onTouchStart,this),L.DomEvent.off(this._container,"touchend",this._onTouchEnd,this),L.DomEvent.off(this._container,"touchmove",this._onTouchMove,this),this._detectIE()?(L.DomEvent.off(this._container,"MSPointerDown",this._onTouchStart,this),L.DomEvent.off(this._container,"MSPointerUp",this._onTouchEnd,this),L.DomEvent.off(this._container,"MSPointerMove",this._onTouchMove,this),L.DomEvent.off(this._container,"MSPointerCancel",this._onTouchCancel,this)):(L.DomEvent.off(this._container,"touchcancel",this._onTouchCancel,this),L.DomEvent.off(this._container,"touchleave",this._onTouchLeave,this))},_touchEvent:function(i,s){var o={};if(i.touches!==void 0){if(!i.touches.length)return;o=i.touches[0]}else if(i.pointerType!=="touch"||(o=i,!this._filterClick(i)))return;var l=this._map.mouseEventToContainerPoint(o),u=this._map.mouseEventToLayerPoint(o),f=this._map.layerPointToLatLng(u);this._map.fire(s,{latlng:f,layerPoint:u,containerPoint:l,pageX:o.pageX,pageY:o.pageY,originalEvent:i})},_filterClick:function(i){var s=i.timeStamp||i.originalEvent.timeStamp,o=L.DomEvent._lastClick&&s-L.DomEvent._lastClick;return o&&o>100&&o<500||i.target._simulatedClick&&!i._simulated?(L.DomEvent.stop(i),!1):(L.DomEvent._lastClick=s,!0)},_onTouchStart:function(i){this._map._loaded&&this._touchEvent(i,"touchstart")},_onTouchEnd:function(i){this._map._loaded&&this._touchEvent(i,"touchend")},_onTouchCancel:function(i){if(this._map._loaded){var s="touchcancel";this._detectIE()&&(s="pointercancel"),this._touchEvent(i,s)}},_onTouchLeave:function(i){this._map._loaded&&this._touchEvent(i,"touchleave")},_onTouchMove:function(i){this._map._loaded&&this._touchEvent(i,"touchmove")},_detectIE:function(){var i=h.navigator.userAgent,s=i.indexOf("MSIE ");if(s>0)return parseInt(i.substring(s+5,i.indexOf(".",s)),10);if(i.indexOf("Trident/")>0){var o=i.indexOf("rv:");return parseInt(i.substring(o+3,i.indexOf(".",o)),10)}var l=i.indexOf("Edge/");return l>0&&parseInt(i.substring(l+5,i.indexOf(".",l)),10)}}),L.Map.addInitHook("addHandler","touchExtend",L.Map.TouchExtend),L.Marker.Touch=L.Marker.extend({_initInteraction:function(){return this.addInteractiveTarget?L.Marker.prototype._initInteraction.apply(this):this._initInteractionLegacy()},_initInteractionLegacy:function(){if(this.options.clickable){var i=this._icon,s=["dblclick","mousedown","mouseover","mouseout","contextmenu","touchstart","touchend","touchmove"];this._detectIE?s.concat(["MSPointerDown","MSPointerUp","MSPointerMove","MSPointerCancel"]):s.concat(["touchcancel"]),L.DomUtil.addClass(i,"leaflet-clickable"),L.DomEvent.on(i,"click",this._onMouseClick,this),L.DomEvent.on(i,"keypress",this._onKeyPress,this);for(var o=0;o<s.length;o++)L.DomEvent.on(i,s[o],this._fireMouseEvent,this);L.Handler.MarkerDrag&&(this.dragging=new L.Handler.MarkerDrag(this),this.options.draggable&&this.dragging.enable())}},_detectIE:function(){var i=h.navigator.userAgent,s=i.indexOf("MSIE ");if(s>0)return parseInt(i.substring(s+5,i.indexOf(".",s)),10);if(i.indexOf("Trident/")>0){var o=i.indexOf("rv:");return parseInt(i.substring(o+3,i.indexOf(".",o)),10)}var l=i.indexOf("Edge/");return l>0&&parseInt(i.substring(l+5,i.indexOf(".",l)),10)}}),L.LatLngUtil={cloneLatLngs:function(i){for(var s=[],o=0,l=i.length;o<l;o++)Array.isArray(i[o])?s.push(L.LatLngUtil.cloneLatLngs(i[o])):s.push(this.cloneLatLng(i[o]));return s},cloneLatLng:function(i){return L.latLng(i.lat,i.lng)}},function(){var i={km:2,ha:2,m:0,mi:2,ac:2,yd:0,ft:0,nm:2};L.GeometryUtil=L.extend(L.GeometryUtil||{},{geodesicArea:function(s){var o,l,u=s.length,f=0,d=Math.PI/180;if(u>2){for(var p=0;p<u;p++)o=s[p],l=s[(p+1)%u],f+=(l.lng-o.lng)*d*(2+Math.sin(o.lat*d)+Math.sin(l.lat*d));f=6378137*f*6378137/2}return Math.abs(f)},formattedNumber:function(s,o){var l=parseFloat(s).toFixed(o),u=L.drawLocal.format&&L.drawLocal.format.numeric,f=u&&u.delimiters,d=f&&f.thousands,p=f&&f.decimal;if(d||p){var g=l.split(".");l=d?g[0].replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1"+d):g[0],p=p||".",g.length>1&&(l=l+p+g[1])}return l},readableArea:function(s,o,d){var u,f,d=L.Util.extend({},i,d);return o?(f=["ha","m"],type=typeof o,type==="string"?f=[o]:type!=="boolean"&&(f=o),u=s>=1e6&&f.indexOf("km")!==-1?L.GeometryUtil.formattedNumber(1e-6*s,d.km)+" km²":s>=1e4&&f.indexOf("ha")!==-1?L.GeometryUtil.formattedNumber(1e-4*s,d.ha)+" ha":L.GeometryUtil.formattedNumber(s,d.m)+" m²"):(s/=.836127,u=s>=3097600?L.GeometryUtil.formattedNumber(s/3097600,d.mi)+" mi²":s>=4840?L.GeometryUtil.formattedNumber(s/4840,d.ac)+" acres":L.GeometryUtil.formattedNumber(s,d.yd)+" yd²"),u},readableDistance:function(s,o,l,u,p){var d,p=L.Util.extend({},i,p);switch(o?typeof o=="string"?o:"metric":l?"feet":u?"nauticalMile":"yards"){case"metric":d=s>1e3?L.GeometryUtil.formattedNumber(s/1e3,p.km)+" km":L.GeometryUtil.formattedNumber(s,p.m)+" m";break;case"feet":s*=3.28083,d=L.GeometryUtil.formattedNumber(s,p.ft)+" ft";break;case"nauticalMile":s*=.53996,d=L.GeometryUtil.formattedNumber(s/1e3,p.nm)+" nm";break;case"yards":default:s*=1.09361,d=s>1760?L.GeometryUtil.formattedNumber(s/1760,p.mi)+" miles":L.GeometryUtil.formattedNumber(s,p.yd)+" yd"}return d},isVersion07x:function(){var s=L.version.split(".");return parseInt(s[0],10)===0&&parseInt(s[1],10)===7}})}(),L.Util.extend(L.LineUtil,{segmentsIntersect:function(i,s,o,l){return this._checkCounterclockwise(i,o,l)!==this._checkCounterclockwise(s,o,l)&&this._checkCounterclockwise(i,s,o)!==this._checkCounterclockwise(i,s,l)},_checkCounterclockwise:function(i,s,o){return(o.y-i.y)*(s.x-i.x)>(s.y-i.y)*(o.x-i.x)}}),L.Polyline.include({intersects:function(){var i,s,o,l=this._getProjectedPoints(),u=l?l.length:0;if(this._tooFewPointsForIntersection())return!1;for(i=u-1;i>=3;i--)if(s=l[i-1],o=l[i],this._lineSegmentsIntersectsRange(s,o,i-2))return!0;return!1},newLatLngIntersects:function(i,s){return!!this._map&&this.newPointIntersects(this._map.latLngToLayerPoint(i),s)},newPointIntersects:function(i,s){var o=this._getProjectedPoints(),l=o?o.length:0,u=o?o[l-1]:null,f=l-2;return!this._tooFewPointsForIntersection(1)&&this._lineSegmentsIntersectsRange(u,i,f,s?1:0)},_tooFewPointsForIntersection:function(i){var s=this._getProjectedPoints(),o=s?s.length:0;return o+=i||0,!s||o<=3},_lineSegmentsIntersectsRange:function(i,s,o,l){var u,f,d=this._getProjectedPoints();l=l||0;for(var p=o;p>l;p--)if(u=d[p-1],f=d[p],L.LineUtil.segmentsIntersect(i,s,u,f))return!0;return!1},_getProjectedPoints:function(){if(!this._defaultShape)return this._originalPoints;for(var i=[],s=this._defaultShape(),o=0;o<s.length;o++)i.push(this._map.latLngToLayerPoint(s[o]));return i}}),L.Polygon.include({intersects:function(){var i,s,o,l,u=this._getProjectedPoints();return!this._tooFewPointsForIntersection()&&(!!L.Polyline.prototype.intersects.call(this)||(i=u.length,s=u[0],o=u[i-1],l=i-2,this._lineSegmentsIntersectsRange(o,s,l,1)))}}),L.Control.Draw=L.Control.extend({options:{position:"topleft",draw:{},edit:!1},initialize:function(i){if(L.version<"0.7")throw new Error("Leaflet.draw 0.2.3+ requires Leaflet 0.7.0+. Download latest from https://github.com/Leaflet/Leaflet/");L.Control.prototype.initialize.call(this,i);var s;this._toolbars={},L.DrawToolbar&&this.options.draw&&(s=new L.DrawToolbar(this.options.draw),this._toolbars[L.DrawToolbar.TYPE]=s,this._toolbars[L.DrawToolbar.TYPE].on("enable",this._toolbarEnabled,this)),L.EditToolbar&&this.options.edit&&(s=new L.EditToolbar(this.options.edit),this._toolbars[L.EditToolbar.TYPE]=s,this._toolbars[L.EditToolbar.TYPE].on("enable",this._toolbarEnabled,this)),L.toolbar=this},onAdd:function(i){var s,o=L.DomUtil.create("div","leaflet-draw"),l=!1;for(var u in this._toolbars)this._toolbars.hasOwnProperty(u)&&(s=this._toolbars[u].addToolbar(i))&&(l||(L.DomUtil.hasClass(s,"leaflet-draw-toolbar-top")||L.DomUtil.addClass(s.childNodes[0],"leaflet-draw-toolbar-top"),l=!0),o.appendChild(s));return o},onRemove:function(){for(var i in this._toolbars)this._toolbars.hasOwnProperty(i)&&this._toolbars[i].removeToolbar()},setDrawingOptions:function(i){for(var s in this._toolbars)this._toolbars[s]instanceof L.DrawToolbar&&this._toolbars[s].setOptions(i)},_toolbarEnabled:function(i){var s=i.target;for(var o in this._toolbars)this._toolbars[o]!==s&&this._toolbars[o].disable()}}),L.Map.mergeOptions({drawControlTooltips:!0,drawControl:!1}),L.Map.addInitHook(function(){this.options.drawControl&&(this.drawControl=new L.Control.Draw,this.addControl(this.drawControl))}),L.Toolbar=L.Class.extend({initialize:function(i){L.setOptions(this,i),this._modes={},this._actionButtons=[],this._activeMode=null;var s=L.version.split(".");parseInt(s[0],10)===1&&parseInt(s[1],10)>=2?L.Toolbar.include(L.Evented.prototype):L.Toolbar.include(L.Mixin.Events)},enabled:function(){return this._activeMode!==null},disable:function(){this.enabled()&&this._activeMode.handler.disable()},addToolbar:function(i){var s,o=L.DomUtil.create("div","leaflet-draw-section"),l=0,u=this._toolbarClass||"",f=this.getModeHandlers(i);for(this._toolbarContainer=L.DomUtil.create("div","leaflet-draw-toolbar leaflet-bar"),this._map=i,s=0;s<f.length;s++)f[s].enabled&&this._initModeHandler(f[s].handler,this._toolbarContainer,l++,u,f[s].title);if(l)return this._lastButtonIndex=--l,this._actionsContainer=L.DomUtil.create("ul","leaflet-draw-actions"),o.appendChild(this._toolbarContainer),o.appendChild(this._actionsContainer),o},removeToolbar:function(){for(var i in this._modes)this._modes.hasOwnProperty(i)&&(this._disposeButton(this._modes[i].button,this._modes[i].handler.enable,this._modes[i].handler),this._modes[i].handler.disable(),this._modes[i].handler.off("enabled",this._handlerActivated,this).off("disabled",this._handlerDeactivated,this));this._modes={};for(var s=0,o=this._actionButtons.length;s<o;s++)this._disposeButton(this._actionButtons[s].button,this._actionButtons[s].callback,this);this._actionButtons=[],this._actionsContainer=null},_initModeHandler:function(i,s,o,l,u){var f=i.type;this._modes[f]={},this._modes[f].handler=i,this._modes[f].button=this._createButton({type:f,title:u,className:l+"-"+f,container:s,callback:this._modes[f].handler.enable,context:this._modes[f].handler}),this._modes[f].buttonIndex=o,this._modes[f].handler.on("enabled",this._handlerActivated,this).on("disabled",this._handlerDeactivated,this)},_detectIOS:function(){return/iPad|iPhone|iPod/.test(navigator.userAgent)&&!h.MSStream},_createButton:function(i){var s=L.DomUtil.create("a",i.className||"",i.container),o=L.DomUtil.create("span","sr-only",i.container);s.href="#",s.appendChild(o),i.title&&(s.title=i.title,o.innerHTML=i.title),i.text&&(s.innerHTML=i.text,o.innerHTML=i.text);var l=this._detectIOS()?"touchstart":"click";return L.DomEvent.on(s,"click",L.DomEvent.stopPropagation).on(s,"mousedown",L.DomEvent.stopPropagation).on(s,"dblclick",L.DomEvent.stopPropagation).on(s,"touchstart",L.DomEvent.stopPropagation).on(s,"click",L.DomEvent.preventDefault).on(s,l,i.callback,i.context),s},_disposeButton:function(i,s){var o=this._detectIOS()?"touchstart":"click";L.DomEvent.off(i,"click",L.DomEvent.stopPropagation).off(i,"mousedown",L.DomEvent.stopPropagation).off(i,"dblclick",L.DomEvent.stopPropagation).off(i,"touchstart",L.DomEvent.stopPropagation).off(i,"click",L.DomEvent.preventDefault).off(i,o,s)},_handlerActivated:function(i){this.disable(),this._activeMode=this._modes[i.handler],L.DomUtil.addClass(this._activeMode.button,"leaflet-draw-toolbar-button-enabled"),this._showActionsToolbar(),this.fire("enable")},_handlerDeactivated:function(){this._hideActionsToolbar(),L.DomUtil.removeClass(this._activeMode.button,"leaflet-draw-toolbar-button-enabled"),this._activeMode=null,this.fire("disable")},_createActions:function(i){var s,o,l,u,f=this._actionsContainer,d=this.getActions(i),p=d.length;for(o=0,l=this._actionButtons.length;o<l;o++)this._disposeButton(this._actionButtons[o].button,this._actionButtons[o].callback);for(this._actionButtons=[];f.firstChild;)f.removeChild(f.firstChild);for(var g=0;g<p;g++)"enabled"in d[g]&&!d[g].enabled||(s=L.DomUtil.create("li","",f),u=this._createButton({title:d[g].title,text:d[g].text,container:s,callback:d[g].callback,context:d[g].context}),this._actionButtons.push({button:u,callback:d[g].callback}))},_showActionsToolbar:function(){var i=this._activeMode.buttonIndex,s=this._lastButtonIndex,o=this._activeMode.button.offsetTop-1;this._createActions(this._activeMode.handler),this._actionsContainer.style.top=o+"px",i===0&&(L.DomUtil.addClass(this._toolbarContainer,"leaflet-draw-toolbar-notop"),L.DomUtil.addClass(this._actionsContainer,"leaflet-draw-actions-top")),i===s&&(L.DomUtil.addClass(this._toolbarContainer,"leaflet-draw-toolbar-nobottom"),L.DomUtil.addClass(this._actionsContainer,"leaflet-draw-actions-bottom")),this._actionsContainer.style.display="block",this._map.fire(L.Draw.Event.TOOLBAROPENED)},_hideActionsToolbar:function(){this._actionsContainer.style.display="none",L.DomUtil.removeClass(this._toolbarContainer,"leaflet-draw-toolbar-notop"),L.DomUtil.removeClass(this._toolbarContainer,"leaflet-draw-toolbar-nobottom"),L.DomUtil.removeClass(this._actionsContainer,"leaflet-draw-actions-top"),L.DomUtil.removeClass(this._actionsContainer,"leaflet-draw-actions-bottom"),this._map.fire(L.Draw.Event.TOOLBARCLOSED)}}),L.Draw=L.Draw||{},L.Draw.Tooltip=L.Class.extend({initialize:function(i){this._map=i,this._popupPane=i._panes.popupPane,this._visible=!1,this._container=i.options.drawControlTooltips?L.DomUtil.create("div","leaflet-draw-tooltip",this._popupPane):null,this._singleLineLabel=!1,this._map.on("mouseout",this._onMouseOut,this)},dispose:function(){this._map.off("mouseout",this._onMouseOut,this),this._container&&(this._popupPane.removeChild(this._container),this._container=null)},updateContent:function(i){return this._container?(i.subtext=i.subtext||"",i.subtext.length!==0||this._singleLineLabel?i.subtext.length>0&&this._singleLineLabel&&(L.DomUtil.removeClass(this._container,"leaflet-draw-tooltip-single"),this._singleLineLabel=!1):(L.DomUtil.addClass(this._container,"leaflet-draw-tooltip-single"),this._singleLineLabel=!0),this._container.innerHTML=(i.subtext.length>0?'<span class="leaflet-draw-tooltip-subtext">'+i.subtext+"</span><br />":"")+"<span>"+i.text+"</span>",i.text||i.subtext?(this._visible=!0,this._container.style.visibility="inherit"):(this._visible=!1,this._container.style.visibility="hidden"),this):this},updatePosition:function(i){var s=this._map.latLngToLayerPoint(i),o=this._container;return this._container&&(this._visible&&(o.style.visibility="inherit"),L.DomUtil.setPosition(o,s)),this},showAsError:function(){return this._container&&L.DomUtil.addClass(this._container,"leaflet-error-draw-tooltip"),this},removeError:function(){return this._container&&L.DomUtil.removeClass(this._container,"leaflet-error-draw-tooltip"),this},_onMouseOut:function(){this._container&&(this._container.style.visibility="hidden")}}),L.DrawToolbar=L.Toolbar.extend({statics:{TYPE:"draw"},options:{polyline:{},polygon:{},rectangle:{},circle:{},marker:{},circlemarker:{}},initialize:function(i){for(var s in this.options)this.options.hasOwnProperty(s)&&i[s]&&(i[s]=L.extend({},this.options[s],i[s]));this._toolbarClass="leaflet-draw-draw",L.Toolbar.prototype.initialize.call(this,i)},getModeHandlers:function(i){return[{enabled:this.options.polyline,handler:new L.Draw.Polyline(i,this.options.polyline),title:L.drawLocal.draw.toolbar.buttons.polyline},{enabled:this.options.polygon,handler:new L.Draw.Polygon(i,this.options.polygon),title:L.drawLocal.draw.toolbar.buttons.polygon},{enabled:this.options.rectangle,handler:new L.Draw.Rectangle(i,this.options.rectangle),title:L.drawLocal.draw.toolbar.buttons.rectangle},{enabled:this.options.circle,handler:new L.Draw.Circle(i,this.options.circle),title:L.drawLocal.draw.toolbar.buttons.circle},{enabled:this.options.marker,handler:new L.Draw.Marker(i,this.options.marker),title:L.drawLocal.draw.toolbar.buttons.marker},{enabled:this.options.circlemarker,handler:new L.Draw.CircleMarker(i,this.options.circlemarker),title:L.drawLocal.draw.toolbar.buttons.circlemarker}]},getActions:function(i){return[{enabled:i.completeShape,title:L.drawLocal.draw.toolbar.finish.title,text:L.drawLocal.draw.toolbar.finish.text,callback:i.completeShape,context:i},{enabled:i.deleteLastVertex,title:L.drawLocal.draw.toolbar.undo.title,text:L.drawLocal.draw.toolbar.undo.text,callback:i.deleteLastVertex,context:i},{title:L.drawLocal.draw.toolbar.actions.title,text:L.drawLocal.draw.toolbar.actions.text,callback:this.disable,context:this}]},setOptions:function(i){L.setOptions(this,i);for(var s in this._modes)this._modes.hasOwnProperty(s)&&i.hasOwnProperty(s)&&this._modes[s].handler.setOptions(i[s])}}),L.EditToolbar=L.Toolbar.extend({statics:{TYPE:"edit"},options:{edit:{selectedPathOptions:{dashArray:"10, 10",fill:!0,fillColor:"#fe57a1",fillOpacity:.1,maintainColor:!1}},remove:{},poly:null,featureGroup:null},initialize:function(i){i.edit&&(i.edit.selectedPathOptions===void 0&&(i.edit.selectedPathOptions=this.options.edit.selectedPathOptions),i.edit.selectedPathOptions=L.extend({},this.options.edit.selectedPathOptions,i.edit.selectedPathOptions)),i.remove&&(i.remove=L.extend({},this.options.remove,i.remove)),i.poly&&(i.poly=L.extend({},this.options.poly,i.poly)),this._toolbarClass="leaflet-draw-edit",L.Toolbar.prototype.initialize.call(this,i),this._selectedFeatureCount=0},getModeHandlers:function(i){var s=this.options.featureGroup;return[{enabled:this.options.edit,handler:new L.EditToolbar.Edit(i,{featureGroup:s,selectedPathOptions:this.options.edit.selectedPathOptions,poly:this.options.poly}),title:L.drawLocal.edit.toolbar.buttons.edit},{enabled:this.options.remove,handler:new L.EditToolbar.Delete(i,{featureGroup:s}),title:L.drawLocal.edit.toolbar.buttons.remove}]},getActions:function(i){var s=[{title:L.drawLocal.edit.toolbar.actions.save.title,text:L.drawLocal.edit.toolbar.actions.save.text,callback:this._save,context:this},{title:L.drawLocal.edit.toolbar.actions.cancel.title,text:L.drawLocal.edit.toolbar.actions.cancel.text,callback:this.disable,context:this}];return i.removeAllLayers&&s.push({title:L.drawLocal.edit.toolbar.actions.clearAll.title,text:L.drawLocal.edit.toolbar.actions.clearAll.text,callback:this._clearAllLayers,context:this}),s},addToolbar:function(i){var s=L.Toolbar.prototype.addToolbar.call(this,i);return this._checkDisabled(),this.options.featureGroup.on("layeradd layerremove",this._checkDisabled,this),s},removeToolbar:function(){this.options.featureGroup.off("layeradd layerremove",this._checkDisabled,this),L.Toolbar.prototype.removeToolbar.call(this)},disable:function(){this.enabled()&&(this._activeMode.handler.revertLayers(),L.Toolbar.prototype.disable.call(this))},_save:function(){this._activeMode.handler.save(),this._activeMode&&this._activeMode.handler.disable()},_clearAllLayers:function(){this._activeMode.handler.removeAllLayers(),this._activeMode&&this._activeMode.handler.disable()},_checkDisabled:function(){var i,s=this.options.featureGroup,o=s.getLayers().length!==0;this.options.edit&&(i=this._modes[L.EditToolbar.Edit.TYPE].button,o?L.DomUtil.removeClass(i,"leaflet-disabled"):L.DomUtil.addClass(i,"leaflet-disabled"),i.setAttribute("title",o?L.drawLocal.edit.toolbar.buttons.edit:L.drawLocal.edit.toolbar.buttons.editDisabled)),this.options.remove&&(i=this._modes[L.EditToolbar.Delete.TYPE].button,o?L.DomUtil.removeClass(i,"leaflet-disabled"):L.DomUtil.addClass(i,"leaflet-disabled"),i.setAttribute("title",o?L.drawLocal.edit.toolbar.buttons.remove:L.drawLocal.edit.toolbar.buttons.removeDisabled))}}),L.EditToolbar.Edit=L.Handler.extend({statics:{TYPE:"edit"},initialize:function(i,s){if(L.Handler.prototype.initialize.call(this,i),L.setOptions(this,s),this._featureGroup=s.featureGroup,!(this._featureGroup instanceof L.FeatureGroup))throw new Error("options.featureGroup must be a L.FeatureGroup");this._uneditedLayerProps={},this.type=L.EditToolbar.Edit.TYPE;var o=L.version.split(".");parseInt(o[0],10)===1&&parseInt(o[1],10)>=2?L.EditToolbar.Edit.include(L.Evented.prototype):L.EditToolbar.Edit.include(L.Mixin.Events)},enable:function(){!this._enabled&&this._hasAvailableLayers()&&(this.fire("enabled",{handler:this.type}),this._map.fire(L.Draw.Event.EDITSTART,{handler:this.type}),L.Handler.prototype.enable.call(this),this._featureGroup.on("layeradd",this._enableLayerEdit,this).on("layerremove",this._disableLayerEdit,this))},disable:function(){this._enabled&&(this._featureGroup.off("layeradd",this._enableLayerEdit,this).off("layerremove",this._disableLayerEdit,this),L.Handler.prototype.disable.call(this),this._map.fire(L.Draw.Event.EDITSTOP,{handler:this.type}),this.fire("disabled",{handler:this.type}))},addHooks:function(){var i=this._map;i&&(i.getContainer().focus(),this._featureGroup.eachLayer(this._enableLayerEdit,this),this._tooltip=new L.Draw.Tooltip(this._map),this._tooltip.updateContent({text:L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.edit.handlers.edit.tooltip.subtext}),i._editTooltip=this._tooltip,this._updateTooltip(),this._map.on("mousemove",this._onMouseMove,this).on("touchmove",this._onMouseMove,this).on("MSPointerMove",this._onMouseMove,this).on(L.Draw.Event.EDITVERTEX,this._updateTooltip,this))},removeHooks:function(){this._map&&(this._featureGroup.eachLayer(this._disableLayerEdit,this),this._uneditedLayerProps={},this._tooltip.dispose(),this._tooltip=null,this._map.off("mousemove",this._onMouseMove,this).off("touchmove",this._onMouseMove,this).off("MSPointerMove",this._onMouseMove,this).off(L.Draw.Event.EDITVERTEX,this._updateTooltip,this))},revertLayers:function(){this._featureGroup.eachLayer(function(i){this._revertLayer(i)},this)},save:function(){var i=new L.LayerGroup;this._featureGroup.eachLayer(function(s){s.edited&&(i.addLayer(s),s.edited=!1)}),this._map.fire(L.Draw.Event.EDITED,{layers:i})},_backupLayer:function(i){var s=L.Util.stamp(i);this._uneditedLayerProps[s]||(i instanceof L.Polyline||i instanceof L.Polygon||i instanceof L.Rectangle?this._uneditedLayerProps[s]={latlngs:L.LatLngUtil.cloneLatLngs(i.getLatLngs())}:i instanceof L.Circle?this._uneditedLayerProps[s]={latlng:L.LatLngUtil.cloneLatLng(i.getLatLng()),radius:i.getRadius()}:(i instanceof L.Marker||i instanceof L.CircleMarker)&&(this._uneditedLayerProps[s]={latlng:L.LatLngUtil.cloneLatLng(i.getLatLng())}))},_getTooltipText:function(){return{text:L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.edit.handlers.edit.tooltip.subtext}},_updateTooltip:function(){this._tooltip.updateContent(this._getTooltipText())},_revertLayer:function(i){var s=L.Util.stamp(i);i.edited=!1,this._uneditedLayerProps.hasOwnProperty(s)&&(i instanceof L.Polyline||i instanceof L.Polygon||i instanceof L.Rectangle?i.setLatLngs(this._uneditedLayerProps[s].latlngs):i instanceof L.Circle?(i.setLatLng(this._uneditedLayerProps[s].latlng),i.setRadius(this._uneditedLayerProps[s].radius)):(i instanceof L.Marker||i instanceof L.CircleMarker)&&i.setLatLng(this._uneditedLayerProps[s].latlng),i.fire("revert-edited",{layer:i}))},_enableLayerEdit:function(i){var s,o,l=i.layer||i.target||i;this._backupLayer(l),this.options.poly&&(o=L.Util.extend({},this.options.poly),l.options.poly=o),this.options.selectedPathOptions&&(s=L.Util.extend({},this.options.selectedPathOptions),s.maintainColor&&(s.color=l.options.color,s.fillColor=l.options.fillColor),l.options.original=L.extend({},l.options),l.options.editing=s),l instanceof L.Marker?(l.editing&&l.editing.enable(),l.dragging.enable(),l.on("dragend",this._onMarkerDragEnd).on("touchmove",this._onTouchMove,this).on("MSPointerMove",this._onTouchMove,this).on("touchend",this._onMarkerDragEnd,this).on("MSPointerUp",this._onMarkerDragEnd,this)):l.editing.enable()},_disableLayerEdit:function(i){var s=i.layer||i.target||i;s.edited=!1,s.editing&&s.editing.disable(),delete s.options.editing,delete s.options.original,this._selectedPathOptions&&(s instanceof L.Marker?this._toggleMarkerHighlight(s):(s.setStyle(s.options.previousOptions),delete s.options.previousOptions)),s instanceof L.Marker?(s.dragging.disable(),s.off("dragend",this._onMarkerDragEnd,this).off("touchmove",this._onTouchMove,this).off("MSPointerMove",this._onTouchMove,this).off("touchend",this._onMarkerDragEnd,this).off("MSPointerUp",this._onMarkerDragEnd,this)):s.editing.disable()},_onMouseMove:function(i){this._tooltip.updatePosition(i.latlng)},_onMarkerDragEnd:function(i){var s=i.target;s.edited=!0,this._map.fire(L.Draw.Event.EDITMOVE,{layer:s})},_onTouchMove:function(i){var s=i.originalEvent.changedTouches[0],o=this._map.mouseEventToLayerPoint(s),l=this._map.layerPointToLatLng(o);i.target.setLatLng(l)},_hasAvailableLayers:function(){return this._featureGroup.getLayers().length!==0}}),L.EditToolbar.Delete=L.Handler.extend({statics:{TYPE:"remove"},initialize:function(i,s){if(L.Handler.prototype.initialize.call(this,i),L.Util.setOptions(this,s),this._deletableLayers=this.options.featureGroup,!(this._deletableLayers instanceof L.FeatureGroup))throw new Error("options.featureGroup must be a L.FeatureGroup");this.type=L.EditToolbar.Delete.TYPE;var o=L.version.split(".");parseInt(o[0],10)===1&&parseInt(o[1],10)>=2?L.EditToolbar.Delete.include(L.Evented.prototype):L.EditToolbar.Delete.include(L.Mixin.Events)},enable:function(){!this._enabled&&this._hasAvailableLayers()&&(this.fire("enabled",{handler:this.type}),this._map.fire(L.Draw.Event.DELETESTART,{handler:this.type}),L.Handler.prototype.enable.call(this),this._deletableLayers.on("layeradd",this._enableLayerDelete,this).on("layerremove",this._disableLayerDelete,this))},disable:function(){this._enabled&&(this._deletableLayers.off("layeradd",this._enableLayerDelete,this).off("layerremove",this._disableLayerDelete,this),L.Handler.prototype.disable.call(this),this._map.fire(L.Draw.Event.DELETESTOP,{handler:this.type}),this.fire("disabled",{handler:this.type}))},addHooks:function(){var i=this._map;i&&(i.getContainer().focus(),this._deletableLayers.eachLayer(this._enableLayerDelete,this),this._deletedLayers=new L.LayerGroup,this._tooltip=new L.Draw.Tooltip(this._map),this._tooltip.updateContent({text:L.drawLocal.edit.handlers.remove.tooltip.text}),this._map.on("mousemove",this._onMouseMove,this))},removeHooks:function(){this._map&&(this._deletableLayers.eachLayer(this._disableLayerDelete,this),this._deletedLayers=null,this._tooltip.dispose(),this._tooltip=null,this._map.off("mousemove",this._onMouseMove,this))},revertLayers:function(){this._deletedLayers.eachLayer(function(i){this._deletableLayers.addLayer(i),i.fire("revert-deleted",{layer:i})},this)},save:function(){this._map.fire(L.Draw.Event.DELETED,{layers:this._deletedLayers})},removeAllLayers:function(){this._deletableLayers.eachLayer(function(i){this._removeLayer({layer:i})},this),this.save()},_enableLayerDelete:function(i){(i.layer||i.target||i).on("click",this._removeLayer,this)},_disableLayerDelete:function(i){var s=i.layer||i.target||i;s.off("click",this._removeLayer,this),this._deletedLayers.removeLayer(s)},_removeLayer:function(i){var s=i.layer||i.target||i;this._deletableLayers.removeLayer(s),this._deletedLayers.addLayer(s),s.fire("deleted")},_onMouseMove:function(i){this._tooltip.updatePosition(i.latlng)},_hasAvailableLayers:function(){return this._deletableLayers.getLayers().length!==0}})})(window,document);var Li=Gd(()=>ip),np=hr('<div style="height: 600px; width: 100%;" class="svelte-1ymq5l"></div>');function rp(h,t){Da(t,!1);let e=Hs(t,"selectedLayer",8),r=Xr(),i=Xr(null),s=null,o=null;const l=Oc(),u=p=>{Bt(i)&&(s&&Bt(i).removeLayer(s),p?(s=Li().tileLayer(p.value,{attribution:p.attribution}),s.addTo(Bt(i))):(s=Li().tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:"&copy; OpenStreetMap contributors"}),s.addTo(Bt(i))))},f=p=>{o&&Bt(i).removeLayer(o),o=Li().geoJSON(p,{style:{color:"blue",fillColor:"blue",fillOpacity:.6,weight:2}}).addTo(Bt(i))};qd(()=>{Li().GeometryUtil&&Li(Li().GeometryUtil.readableArea=function(m,x){const v=x?["m²","ha","km²"]:["ft²","ac","mi²"],b=x?[1e4,1e6]:[43560,27878400];let P=0;for(;m>b[P]&&P<b.length-1;)m/=b[P],P++;return`${m.toFixed(2)} ${v[P]}`}),de(i,Li().map(Bt(r)).setView([52.474,13.43],13)),u(e());const p=new(Li()).FeatureGroup;Bt(i).addLayer(p);const g=new(Li()).Control.Draw({draw:{polyline:!1,polygon:{shapeOptions:{color:"var(--highlite)",fillColor:"var(--highlite)",fillOpacity:.2,weight:2}},rectangle:{shapeOptions:{color:"var(--highlite)",fillColor:"var(--highlite)",fillOpacity:.2,weight:2}},circle:!1,marker:!1,circlemarker:!1},edit:{featureGroup:p,edit:{selectedPathOptions:{color:"var(--stroke)",fillColor:"var(--highlite)",fillOpacity:.2,weight:2}}}});Bt(i).addControl(g),Bt(i).on(Li().Draw.Event.CREATED,m=>{const{layer:x}=m;p.clearLayers(),x.setStyle({color:"var(--stroke)",fillColor:"var(--highlite)",fillOpacity:.2,weight:2}),p.addLayer(x),l("shapeDrawn",{layer:x})}),Bt(i).on("draw:edited",m=>{m.layers.eachLayer(v=>{const b=Li().GeometryUtil.geodesicArea(v.getLatLngs()[0]),P=v.getLatLngs()[0];l("shapeEdited",{layer:v,area:b,latlngs:P})})}),Bt(i).on("zoomend",()=>{l("mapZoomed",{zoom:Bt(i).getZoom()})})}),ca(()=>Bt(i),()=>{pa.subscribe(p=>{p&&Bt(i)&&f(p)})}),ca(()=>Bt(i),()=>{Ea.subscribe(p=>{p&&Bt(i)&&f(p)})}),ca(()=>ml(e()),()=>{e()&&u(e())}),vc(),_l();var d=np();Zd(d,p=>de(r,p),()=>Bt(r)),nr(h,d),Ba()}function Zo(h){throw new Error('Could not dynamically require "'+h+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var sh={exports:{}};/*!

JSZip v3.10.1 - A JavaScript class for generating and reading zip files
<http://stuartk.com/jszip>

(c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.

JSZip uses the library pako released under the MIT license :
https://github.com/nodeca/pako/blob/main/LICENSE
*/var eu;function sp(){return eu||(eu=1,function(h,t){(function(e){h.exports=e()})(function(){return function e(r,i,s){function o(f,d){if(!i[f]){if(!r[f]){var p=typeof Zo=="function"&&Zo;if(!d&&p)return p(f,!0);if(l)return l(f,!0);var g=new Error("Cannot find module '"+f+"'");throw g.code="MODULE_NOT_FOUND",g}var m=i[f]={exports:{}};r[f][0].call(m.exports,function(x){var v=r[f][1][x];return o(v||x)},m,m.exports,e,r,i,s)}return i[f].exports}for(var l=typeof Zo=="function"&&Zo,u=0;u<s.length;u++)o(s[u]);return o}({1:[function(e,r,i){var s=e("./utils"),o=e("./support"),l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";i.encode=function(u){for(var f,d,p,g,m,x,v,b=[],P=0,A=u.length,B=A,Z=s.getTypeOf(u)!=="string";P<u.length;)B=A-P,p=Z?(f=u[P++],d=P<A?u[P++]:0,P<A?u[P++]:0):(f=u.charCodeAt(P++),d=P<A?u.charCodeAt(P++):0,P<A?u.charCodeAt(P++):0),g=f>>2,m=(3&f)<<4|d>>4,x=1<B?(15&d)<<2|p>>6:64,v=2<B?63&p:64,b.push(l.charAt(g)+l.charAt(m)+l.charAt(x)+l.charAt(v));return b.join("")},i.decode=function(u){var f,d,p,g,m,x,v=0,b=0,P="data:";if(u.substr(0,P.length)===P)throw new Error("Invalid base64 input, it looks like a data url.");var A,B=3*(u=u.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(u.charAt(u.length-1)===l.charAt(64)&&B--,u.charAt(u.length-2)===l.charAt(64)&&B--,B%1!=0)throw new Error("Invalid base64 input, bad content length.");for(A=o.uint8array?new Uint8Array(0|B):new Array(0|B);v<u.length;)f=l.indexOf(u.charAt(v++))<<2|(g=l.indexOf(u.charAt(v++)))>>4,d=(15&g)<<4|(m=l.indexOf(u.charAt(v++)))>>2,p=(3&m)<<6|(x=l.indexOf(u.charAt(v++))),A[b++]=f,m!==64&&(A[b++]=d),x!==64&&(A[b++]=p);return A}},{"./support":30,"./utils":32}],2:[function(e,r,i){var s=e("./external"),o=e("./stream/DataWorker"),l=e("./stream/Crc32Probe"),u=e("./stream/DataLengthProbe");function f(d,p,g,m,x){this.compressedSize=d,this.uncompressedSize=p,this.crc32=g,this.compression=m,this.compressedContent=x}f.prototype={getContentWorker:function(){var d=new o(s.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new u("data_length")),p=this;return d.on("end",function(){if(this.streamInfo.data_length!==p.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),d},getCompressedWorker:function(){return new o(s.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},f.createWorkerFrom=function(d,p,g){return d.pipe(new l).pipe(new u("uncompressedSize")).pipe(p.compressWorker(g)).pipe(new u("compressedSize")).withStreamInfo("compression",p)},r.exports=f},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(e,r,i){var s=e("./stream/GenericWorker");i.STORE={magic:"\0\0",compressWorker:function(){return new s("STORE compression")},uncompressWorker:function(){return new s("STORE decompression")}},i.DEFLATE=e("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(e,r,i){var s=e("./utils"),o=function(){for(var l,u=[],f=0;f<256;f++){l=f;for(var d=0;d<8;d++)l=1&l?3988292384^l>>>1:l>>>1;u[f]=l}return u}();r.exports=function(l,u){return l!==void 0&&l.length?s.getTypeOf(l)!=="string"?function(f,d,p,g){var m=o,x=g+p;f^=-1;for(var v=g;v<x;v++)f=f>>>8^m[255&(f^d[v])];return-1^f}(0|u,l,l.length,0):function(f,d,p,g){var m=o,x=g+p;f^=-1;for(var v=g;v<x;v++)f=f>>>8^m[255&(f^d.charCodeAt(v))];return-1^f}(0|u,l,l.length,0):0}},{"./utils":32}],5:[function(e,r,i){i.base64=!1,i.binary=!1,i.dir=!1,i.createFolders=!0,i.date=null,i.compression=null,i.compressionOptions=null,i.comment=null,i.unixPermissions=null,i.dosPermissions=null},{}],6:[function(e,r,i){var s=null;s=typeof Promise<"u"?Promise:e("lie"),r.exports={Promise:s}},{lie:37}],7:[function(e,r,i){var s=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",o=e("pako"),l=e("./utils"),u=e("./stream/GenericWorker"),f=s?"uint8array":"array";function d(p,g){u.call(this,"FlateWorker/"+p),this._pako=null,this._pakoAction=p,this._pakoOptions=g,this.meta={}}i.magic="\b\0",l.inherits(d,u),d.prototype.processChunk=function(p){this.meta=p.meta,this._pako===null&&this._createPako(),this._pako.push(l.transformTo(f,p.data),!1)},d.prototype.flush=function(){u.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},d.prototype.cleanUp=function(){u.prototype.cleanUp.call(this),this._pako=null},d.prototype._createPako=function(){this._pako=new o[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var p=this;this._pako.onData=function(g){p.push({data:g,meta:p.meta})}},i.compressWorker=function(p){return new d("Deflate",p)},i.uncompressWorker=function(){return new d("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(e,r,i){function s(m,x){var v,b="";for(v=0;v<x;v++)b+=String.fromCharCode(255&m),m>>>=8;return b}function o(m,x,v,b,P,A){var B,Z,I=m.file,K=m.compression,V=A!==f.utf8encode,S=l.transformTo("string",A(I.name)),k=l.transformTo("string",f.utf8encode(I.name)),O=I.comment,N=l.transformTo("string",A(O)),E=l.transformTo("string",f.utf8encode(O)),C=k.length!==I.name.length,y=E.length!==O.length,z="",H="",G="",W=I.dir,X=I.date,tt={crc32:0,compressedSize:0,uncompressedSize:0};x&&!v||(tt.crc32=m.crc32,tt.compressedSize=m.compressedSize,tt.uncompressedSize=m.uncompressedSize);var q=0;x&&(q|=8),V||!C&&!y||(q|=2048);var Q=0,dt=0;W&&(Q|=16),P==="UNIX"?(dt=798,Q|=function(rt,mt){var Et=rt;return rt||(Et=mt?16893:33204),(65535&Et)<<16}(I.unixPermissions,W)):(dt=20,Q|=function(rt){return 63&(rt||0)}(I.dosPermissions)),B=X.getUTCHours(),B<<=6,B|=X.getUTCMinutes(),B<<=5,B|=X.getUTCSeconds()/2,Z=X.getUTCFullYear()-1980,Z<<=4,Z|=X.getUTCMonth()+1,Z<<=5,Z|=X.getUTCDate(),C&&(H=s(1,1)+s(d(S),4)+k,z+="up"+s(H.length,2)+H),y&&(G=s(1,1)+s(d(N),4)+E,z+="uc"+s(G.length,2)+G);var ct="";return ct+=`
\0`,ct+=s(q,2),ct+=K.magic,ct+=s(B,2),ct+=s(Z,2),ct+=s(tt.crc32,4),ct+=s(tt.compressedSize,4),ct+=s(tt.uncompressedSize,4),ct+=s(S.length,2),ct+=s(z.length,2),{fileRecord:p.LOCAL_FILE_HEADER+ct+S+z,dirRecord:p.CENTRAL_FILE_HEADER+s(dt,2)+ct+s(N.length,2)+"\0\0\0\0"+s(Q,4)+s(b,4)+S+z+N}}var l=e("../utils"),u=e("../stream/GenericWorker"),f=e("../utf8"),d=e("../crc32"),p=e("../signature");function g(m,x,v,b){u.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=x,this.zipPlatform=v,this.encodeFileName=b,this.streamFiles=m,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}l.inherits(g,u),g.prototype.push=function(m){var x=m.meta.percent||0,v=this.entriesCount,b=this._sources.length;this.accumulate?this.contentBuffer.push(m):(this.bytesWritten+=m.data.length,u.prototype.push.call(this,{data:m.data,meta:{currentFile:this.currentFile,percent:v?(x+100*(v-b-1))/v:100}}))},g.prototype.openedSource=function(m){this.currentSourceOffset=this.bytesWritten,this.currentFile=m.file.name;var x=this.streamFiles&&!m.file.dir;if(x){var v=o(m,x,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:v.fileRecord,meta:{percent:0}})}else this.accumulate=!0},g.prototype.closedSource=function(m){this.accumulate=!1;var x=this.streamFiles&&!m.file.dir,v=o(m,x,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(v.dirRecord),x)this.push({data:function(b){return p.DATA_DESCRIPTOR+s(b.crc32,4)+s(b.compressedSize,4)+s(b.uncompressedSize,4)}(m),meta:{percent:100}});else for(this.push({data:v.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},g.prototype.flush=function(){for(var m=this.bytesWritten,x=0;x<this.dirRecords.length;x++)this.push({data:this.dirRecords[x],meta:{percent:100}});var v=this.bytesWritten-m,b=function(P,A,B,Z,I){var K=l.transformTo("string",I(Z));return p.CENTRAL_DIRECTORY_END+"\0\0\0\0"+s(P,2)+s(P,2)+s(A,4)+s(B,4)+s(K.length,2)+K}(this.dirRecords.length,v,m,this.zipComment,this.encodeFileName);this.push({data:b,meta:{percent:100}})},g.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},g.prototype.registerPrevious=function(m){this._sources.push(m);var x=this;return m.on("data",function(v){x.processChunk(v)}),m.on("end",function(){x.closedSource(x.previous.streamInfo),x._sources.length?x.prepareNextSource():x.end()}),m.on("error",function(v){x.error(v)}),this},g.prototype.resume=function(){return!!u.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},g.prototype.error=function(m){var x=this._sources;if(!u.prototype.error.call(this,m))return!1;for(var v=0;v<x.length;v++)try{x[v].error(m)}catch{}return!0},g.prototype.lock=function(){u.prototype.lock.call(this);for(var m=this._sources,x=0;x<m.length;x++)m[x].lock()},r.exports=g},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(e,r,i){var s=e("../compressions"),o=e("./ZipFileWorker");i.generateWorker=function(l,u,f){var d=new o(u.streamFiles,f,u.platform,u.encodeFileName),p=0;try{l.forEach(function(g,m){p++;var x=function(A,B){var Z=A||B,I=s[Z];if(!I)throw new Error(Z+" is not a valid compression method !");return I}(m.options.compression,u.compression),v=m.options.compressionOptions||u.compressionOptions||{},b=m.dir,P=m.date;m._compressWorker(x,v).withStreamInfo("file",{name:g,dir:b,date:P,comment:m.comment||"",unixPermissions:m.unixPermissions,dosPermissions:m.dosPermissions}).pipe(d)}),d.entriesCount=p}catch(g){d.error(g)}return d}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(e,r,i){function s(){if(!(this instanceof s))return new s;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var o=new s;for(var l in this)typeof this[l]!="function"&&(o[l]=this[l]);return o}}(s.prototype=e("./object")).loadAsync=e("./load"),s.support=e("./support"),s.defaults=e("./defaults"),s.version="3.10.1",s.loadAsync=function(o,l){return new s().loadAsync(o,l)},s.external=e("./external"),r.exports=s},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(e,r,i){var s=e("./utils"),o=e("./external"),l=e("./utf8"),u=e("./zipEntries"),f=e("./stream/Crc32Probe"),d=e("./nodejsUtils");function p(g){return new o.Promise(function(m,x){var v=g.decompressed.getContentWorker().pipe(new f);v.on("error",function(b){x(b)}).on("end",function(){v.streamInfo.crc32!==g.decompressed.crc32?x(new Error("Corrupted zip : CRC32 mismatch")):m()}).resume()})}r.exports=function(g,m){var x=this;return m=s.extend(m||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:l.utf8decode}),d.isNode&&d.isStream(g)?o.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):s.prepareContent("the loaded zip file",g,!0,m.optimizedBinaryString,m.base64).then(function(v){var b=new u(m);return b.load(v),b}).then(function(v){var b=[o.Promise.resolve(v)],P=v.files;if(m.checkCRC32)for(var A=0;A<P.length;A++)b.push(p(P[A]));return o.Promise.all(b)}).then(function(v){for(var b=v.shift(),P=b.files,A=0;A<P.length;A++){var B=P[A],Z=B.fileNameStr,I=s.resolve(B.fileNameStr);x.file(I,B.decompressed,{binary:!0,optimizedBinaryString:!0,date:B.date,dir:B.dir,comment:B.fileCommentStr.length?B.fileCommentStr:null,unixPermissions:B.unixPermissions,dosPermissions:B.dosPermissions,createFolders:m.createFolders}),B.dir||(x.file(I).unsafeOriginalName=Z)}return b.zipComment.length&&(x.comment=b.zipComment),x})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(e,r,i){var s=e("../utils"),o=e("../stream/GenericWorker");function l(u,f){o.call(this,"Nodejs stream input adapter for "+u),this._upstreamEnded=!1,this._bindStream(f)}s.inherits(l,o),l.prototype._bindStream=function(u){var f=this;(this._stream=u).pause(),u.on("data",function(d){f.push({data:d,meta:{percent:0}})}).on("error",function(d){f.isPaused?this.generatedError=d:f.error(d)}).on("end",function(){f.isPaused?f._upstreamEnded=!0:f.end()})},l.prototype.pause=function(){return!!o.prototype.pause.call(this)&&(this._stream.pause(),!0)},l.prototype.resume=function(){return!!o.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},r.exports=l},{"../stream/GenericWorker":28,"../utils":32}],13:[function(e,r,i){var s=e("readable-stream").Readable;function o(l,u,f){s.call(this,u),this._helper=l;var d=this;l.on("data",function(p,g){d.push(p)||d._helper.pause(),f&&f(g)}).on("error",function(p){d.emit("error",p)}).on("end",function(){d.push(null)})}e("../utils").inherits(o,s),o.prototype._read=function(){this._helper.resume()},r.exports=o},{"../utils":32,"readable-stream":16}],14:[function(e,r,i){r.exports={isNode:typeof Buffer<"u",newBufferFrom:function(s,o){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(s,o);if(typeof s=="number")throw new Error('The "data" argument must not be a number');return new Buffer(s,o)},allocBuffer:function(s){if(Buffer.alloc)return Buffer.alloc(s);var o=new Buffer(s);return o.fill(0),o},isBuffer:function(s){return Buffer.isBuffer(s)},isStream:function(s){return s&&typeof s.on=="function"&&typeof s.pause=="function"&&typeof s.resume=="function"}}},{}],15:[function(e,r,i){function s(I,K,V){var S,k=l.getTypeOf(K),O=l.extend(V||{},d);O.date=O.date||new Date,O.compression!==null&&(O.compression=O.compression.toUpperCase()),typeof O.unixPermissions=="string"&&(O.unixPermissions=parseInt(O.unixPermissions,8)),O.unixPermissions&&16384&O.unixPermissions&&(O.dir=!0),O.dosPermissions&&16&O.dosPermissions&&(O.dir=!0),O.dir&&(I=P(I)),O.createFolders&&(S=b(I))&&A.call(this,S,!0);var N=k==="string"&&O.binary===!1&&O.base64===!1;V&&V.binary!==void 0||(O.binary=!N),(K instanceof p&&K.uncompressedSize===0||O.dir||!K||K.length===0)&&(O.base64=!1,O.binary=!0,K="",O.compression="STORE",k="string");var E=null;E=K instanceof p||K instanceof u?K:x.isNode&&x.isStream(K)?new v(I,K):l.prepareContent(I,K,O.binary,O.optimizedBinaryString,O.base64);var C=new g(I,E,O);this.files[I]=C}var o=e("./utf8"),l=e("./utils"),u=e("./stream/GenericWorker"),f=e("./stream/StreamHelper"),d=e("./defaults"),p=e("./compressedObject"),g=e("./zipObject"),m=e("./generate"),x=e("./nodejsUtils"),v=e("./nodejs/NodejsStreamInputAdapter"),b=function(I){I.slice(-1)==="/"&&(I=I.substring(0,I.length-1));var K=I.lastIndexOf("/");return 0<K?I.substring(0,K):""},P=function(I){return I.slice(-1)!=="/"&&(I+="/"),I},A=function(I,K){return K=K!==void 0?K:d.createFolders,I=P(I),this.files[I]||s.call(this,I,null,{dir:!0,createFolders:K}),this.files[I]};function B(I){return Object.prototype.toString.call(I)==="[object RegExp]"}var Z={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(I){var K,V,S;for(K in this.files)S=this.files[K],(V=K.slice(this.root.length,K.length))&&K.slice(0,this.root.length)===this.root&&I(V,S)},filter:function(I){var K=[];return this.forEach(function(V,S){I(V,S)&&K.push(S)}),K},file:function(I,K,V){if(arguments.length!==1)return I=this.root+I,s.call(this,I,K,V),this;if(B(I)){var S=I;return this.filter(function(O,N){return!N.dir&&S.test(O)})}var k=this.files[this.root+I];return k&&!k.dir?k:null},folder:function(I){if(!I)return this;if(B(I))return this.filter(function(k,O){return O.dir&&I.test(k)});var K=this.root+I,V=A.call(this,K),S=this.clone();return S.root=V.name,S},remove:function(I){I=this.root+I;var K=this.files[I];if(K||(I.slice(-1)!=="/"&&(I+="/"),K=this.files[I]),K&&!K.dir)delete this.files[I];else for(var V=this.filter(function(k,O){return O.name.slice(0,I.length)===I}),S=0;S<V.length;S++)delete this.files[V[S].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(I){var K,V={};try{if((V=l.extend(I||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:o.utf8encode})).type=V.type.toLowerCase(),V.compression=V.compression.toUpperCase(),V.type==="binarystring"&&(V.type="string"),!V.type)throw new Error("No output type specified.");l.checkSupport(V.type),V.platform!=="darwin"&&V.platform!=="freebsd"&&V.platform!=="linux"&&V.platform!=="sunos"||(V.platform="UNIX"),V.platform==="win32"&&(V.platform="DOS");var S=V.comment||this.comment||"";K=m.generateWorker(this,V,S)}catch(k){(K=new u("error")).error(k)}return new f(K,V.type||"string",V.mimeType)},generateAsync:function(I,K){return this.generateInternalStream(I).accumulate(K)},generateNodeStream:function(I,K){return(I=I||{}).type||(I.type="nodebuffer"),this.generateInternalStream(I).toNodejsStream(K)}};r.exports=Z},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(e,r,i){r.exports=e("stream")},{stream:void 0}],17:[function(e,r,i){var s=e("./DataReader");function o(l){s.call(this,l);for(var u=0;u<this.data.length;u++)l[u]=255&l[u]}e("../utils").inherits(o,s),o.prototype.byteAt=function(l){return this.data[this.zero+l]},o.prototype.lastIndexOfSignature=function(l){for(var u=l.charCodeAt(0),f=l.charCodeAt(1),d=l.charCodeAt(2),p=l.charCodeAt(3),g=this.length-4;0<=g;--g)if(this.data[g]===u&&this.data[g+1]===f&&this.data[g+2]===d&&this.data[g+3]===p)return g-this.zero;return-1},o.prototype.readAndCheckSignature=function(l){var u=l.charCodeAt(0),f=l.charCodeAt(1),d=l.charCodeAt(2),p=l.charCodeAt(3),g=this.readData(4);return u===g[0]&&f===g[1]&&d===g[2]&&p===g[3]},o.prototype.readData=function(l){if(this.checkOffset(l),l===0)return[];var u=this.data.slice(this.zero+this.index,this.zero+this.index+l);return this.index+=l,u},r.exports=o},{"../utils":32,"./DataReader":18}],18:[function(e,r,i){var s=e("../utils");function o(l){this.data=l,this.length=l.length,this.index=0,this.zero=0}o.prototype={checkOffset:function(l){this.checkIndex(this.index+l)},checkIndex:function(l){if(this.length<this.zero+l||l<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+l+"). Corrupted zip ?")},setIndex:function(l){this.checkIndex(l),this.index=l},skip:function(l){this.setIndex(this.index+l)},byteAt:function(){},readInt:function(l){var u,f=0;for(this.checkOffset(l),u=this.index+l-1;u>=this.index;u--)f=(f<<8)+this.byteAt(u);return this.index+=l,f},readString:function(l){return s.transformTo("string",this.readData(l))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var l=this.readInt(4);return new Date(Date.UTC(1980+(l>>25&127),(l>>21&15)-1,l>>16&31,l>>11&31,l>>5&63,(31&l)<<1))}},r.exports=o},{"../utils":32}],19:[function(e,r,i){var s=e("./Uint8ArrayReader");function o(l){s.call(this,l)}e("../utils").inherits(o,s),o.prototype.readData=function(l){this.checkOffset(l);var u=this.data.slice(this.zero+this.index,this.zero+this.index+l);return this.index+=l,u},r.exports=o},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(e,r,i){var s=e("./DataReader");function o(l){s.call(this,l)}e("../utils").inherits(o,s),o.prototype.byteAt=function(l){return this.data.charCodeAt(this.zero+l)},o.prototype.lastIndexOfSignature=function(l){return this.data.lastIndexOf(l)-this.zero},o.prototype.readAndCheckSignature=function(l){return l===this.readData(4)},o.prototype.readData=function(l){this.checkOffset(l);var u=this.data.slice(this.zero+this.index,this.zero+this.index+l);return this.index+=l,u},r.exports=o},{"../utils":32,"./DataReader":18}],21:[function(e,r,i){var s=e("./ArrayReader");function o(l){s.call(this,l)}e("../utils").inherits(o,s),o.prototype.readData=function(l){if(this.checkOffset(l),l===0)return new Uint8Array(0);var u=this.data.subarray(this.zero+this.index,this.zero+this.index+l);return this.index+=l,u},r.exports=o},{"../utils":32,"./ArrayReader":17}],22:[function(e,r,i){var s=e("../utils"),o=e("../support"),l=e("./ArrayReader"),u=e("./StringReader"),f=e("./NodeBufferReader"),d=e("./Uint8ArrayReader");r.exports=function(p){var g=s.getTypeOf(p);return s.checkSupport(g),g!=="string"||o.uint8array?g==="nodebuffer"?new f(p):o.uint8array?new d(s.transformTo("uint8array",p)):new l(s.transformTo("array",p)):new u(p)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(e,r,i){i.LOCAL_FILE_HEADER="PK",i.CENTRAL_FILE_HEADER="PK",i.CENTRAL_DIRECTORY_END="PK",i.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",i.ZIP64_CENTRAL_DIRECTORY_END="PK",i.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(e,r,i){var s=e("./GenericWorker"),o=e("../utils");function l(u){s.call(this,"ConvertWorker to "+u),this.destType=u}o.inherits(l,s),l.prototype.processChunk=function(u){this.push({data:o.transformTo(this.destType,u.data),meta:u.meta})},r.exports=l},{"../utils":32,"./GenericWorker":28}],25:[function(e,r,i){var s=e("./GenericWorker"),o=e("../crc32");function l(){s.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}e("../utils").inherits(l,s),l.prototype.processChunk=function(u){this.streamInfo.crc32=o(u.data,this.streamInfo.crc32||0),this.push(u)},r.exports=l},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(e,r,i){var s=e("../utils"),o=e("./GenericWorker");function l(u){o.call(this,"DataLengthProbe for "+u),this.propName=u,this.withStreamInfo(u,0)}s.inherits(l,o),l.prototype.processChunk=function(u){if(u){var f=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=f+u.data.length}o.prototype.processChunk.call(this,u)},r.exports=l},{"../utils":32,"./GenericWorker":28}],27:[function(e,r,i){var s=e("../utils"),o=e("./GenericWorker");function l(u){o.call(this,"DataWorker");var f=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,u.then(function(d){f.dataIsReady=!0,f.data=d,f.max=d&&d.length||0,f.type=s.getTypeOf(d),f.isPaused||f._tickAndRepeat()},function(d){f.error(d)})}s.inherits(l,o),l.prototype.cleanUp=function(){o.prototype.cleanUp.call(this),this.data=null},l.prototype.resume=function(){return!!o.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,s.delay(this._tickAndRepeat,[],this)),!0)},l.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(s.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},l.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var u=null,f=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":u=this.data.substring(this.index,f);break;case"uint8array":u=this.data.subarray(this.index,f);break;case"array":case"nodebuffer":u=this.data.slice(this.index,f)}return this.index=f,this.push({data:u,meta:{percent:this.max?this.index/this.max*100:0}})},r.exports=l},{"../utils":32,"./GenericWorker":28}],28:[function(e,r,i){function s(o){this.name=o||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}s.prototype={push:function(o){this.emit("data",o)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(o){this.emit("error",o)}return!0},error:function(o){return!this.isFinished&&(this.isPaused?this.generatedError=o:(this.isFinished=!0,this.emit("error",o),this.previous&&this.previous.error(o),this.cleanUp()),!0)},on:function(o,l){return this._listeners[o].push(l),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(o,l){if(this._listeners[o])for(var u=0;u<this._listeners[o].length;u++)this._listeners[o][u].call(this,l)},pipe:function(o){return o.registerPrevious(this)},registerPrevious:function(o){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=o.streamInfo,this.mergeStreamInfo(),this.previous=o;var l=this;return o.on("data",function(u){l.processChunk(u)}),o.on("end",function(){l.end()}),o.on("error",function(u){l.error(u)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var o=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),o=!0),this.previous&&this.previous.resume(),!o},flush:function(){},processChunk:function(o){this.push(o)},withStreamInfo:function(o,l){return this.extraStreamInfo[o]=l,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var o in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,o)&&(this.streamInfo[o]=this.extraStreamInfo[o])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var o="Worker "+this.name;return this.previous?this.previous+" -> "+o:o}},r.exports=s},{}],29:[function(e,r,i){var s=e("../utils"),o=e("./ConvertWorker"),l=e("./GenericWorker"),u=e("../base64"),f=e("../support"),d=e("../external"),p=null;if(f.nodestream)try{p=e("../nodejs/NodejsStreamOutputAdapter")}catch{}function g(x,v){return new d.Promise(function(b,P){var A=[],B=x._internalType,Z=x._outputType,I=x._mimeType;x.on("data",function(K,V){A.push(K),v&&v(V)}).on("error",function(K){A=[],P(K)}).on("end",function(){try{var K=function(V,S,k){switch(V){case"blob":return s.newBlob(s.transformTo("arraybuffer",S),k);case"base64":return u.encode(S);default:return s.transformTo(V,S)}}(Z,function(V,S){var k,O=0,N=null,E=0;for(k=0;k<S.length;k++)E+=S[k].length;switch(V){case"string":return S.join("");case"array":return Array.prototype.concat.apply([],S);case"uint8array":for(N=new Uint8Array(E),k=0;k<S.length;k++)N.set(S[k],O),O+=S[k].length;return N;case"nodebuffer":return Buffer.concat(S);default:throw new Error("concat : unsupported type '"+V+"'")}}(B,A),I);b(K)}catch(V){P(V)}A=[]}).resume()})}function m(x,v,b){var P=v;switch(v){case"blob":case"arraybuffer":P="uint8array";break;case"base64":P="string"}try{this._internalType=P,this._outputType=v,this._mimeType=b,s.checkSupport(P),this._worker=x.pipe(new o(P)),x.lock()}catch(A){this._worker=new l("error"),this._worker.error(A)}}m.prototype={accumulate:function(x){return g(this,x)},on:function(x,v){var b=this;return x==="data"?this._worker.on(x,function(P){v.call(b,P.data,P.meta)}):this._worker.on(x,function(){s.delay(v,arguments,b)}),this},resume:function(){return s.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(x){if(s.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new p(this,{objectMode:this._outputType!=="nodebuffer"},x)}},r.exports=m},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(e,r,i){if(i.base64=!0,i.array=!0,i.string=!0,i.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",i.nodebuffer=typeof Buffer<"u",i.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")i.blob=!1;else{var s=new ArrayBuffer(0);try{i.blob=new Blob([s],{type:"application/zip"}).size===0}catch{try{var o=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);o.append(s),i.blob=o.getBlob("application/zip").size===0}catch{i.blob=!1}}}try{i.nodestream=!!e("readable-stream").Readable}catch{i.nodestream=!1}},{"readable-stream":16}],31:[function(e,r,i){for(var s=e("./utils"),o=e("./support"),l=e("./nodejsUtils"),u=e("./stream/GenericWorker"),f=new Array(256),d=0;d<256;d++)f[d]=252<=d?6:248<=d?5:240<=d?4:224<=d?3:192<=d?2:1;f[254]=f[254]=1;function p(){u.call(this,"utf-8 decode"),this.leftOver=null}function g(){u.call(this,"utf-8 encode")}i.utf8encode=function(m){return o.nodebuffer?l.newBufferFrom(m,"utf-8"):function(x){var v,b,P,A,B,Z=x.length,I=0;for(A=0;A<Z;A++)(64512&(b=x.charCodeAt(A)))==55296&&A+1<Z&&(64512&(P=x.charCodeAt(A+1)))==56320&&(b=65536+(b-55296<<10)+(P-56320),A++),I+=b<128?1:b<2048?2:b<65536?3:4;for(v=o.uint8array?new Uint8Array(I):new Array(I),A=B=0;B<I;A++)(64512&(b=x.charCodeAt(A)))==55296&&A+1<Z&&(64512&(P=x.charCodeAt(A+1)))==56320&&(b=65536+(b-55296<<10)+(P-56320),A++),b<128?v[B++]=b:(b<2048?v[B++]=192|b>>>6:(b<65536?v[B++]=224|b>>>12:(v[B++]=240|b>>>18,v[B++]=128|b>>>12&63),v[B++]=128|b>>>6&63),v[B++]=128|63&b);return v}(m)},i.utf8decode=function(m){return o.nodebuffer?s.transformTo("nodebuffer",m).toString("utf-8"):function(x){var v,b,P,A,B=x.length,Z=new Array(2*B);for(v=b=0;v<B;)if((P=x[v++])<128)Z[b++]=P;else if(4<(A=f[P]))Z[b++]=65533,v+=A-1;else{for(P&=A===2?31:A===3?15:7;1<A&&v<B;)P=P<<6|63&x[v++],A--;1<A?Z[b++]=65533:P<65536?Z[b++]=P:(P-=65536,Z[b++]=55296|P>>10&1023,Z[b++]=56320|1023&P)}return Z.length!==b&&(Z.subarray?Z=Z.subarray(0,b):Z.length=b),s.applyFromCharCode(Z)}(m=s.transformTo(o.uint8array?"uint8array":"array",m))},s.inherits(p,u),p.prototype.processChunk=function(m){var x=s.transformTo(o.uint8array?"uint8array":"array",m.data);if(this.leftOver&&this.leftOver.length){if(o.uint8array){var v=x;(x=new Uint8Array(v.length+this.leftOver.length)).set(this.leftOver,0),x.set(v,this.leftOver.length)}else x=this.leftOver.concat(x);this.leftOver=null}var b=function(A,B){var Z;for((B=B||A.length)>A.length&&(B=A.length),Z=B-1;0<=Z&&(192&A[Z])==128;)Z--;return Z<0||Z===0?B:Z+f[A[Z]]>B?Z:B}(x),P=x;b!==x.length&&(o.uint8array?(P=x.subarray(0,b),this.leftOver=x.subarray(b,x.length)):(P=x.slice(0,b),this.leftOver=x.slice(b,x.length))),this.push({data:i.utf8decode(P),meta:m.meta})},p.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:i.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},i.Utf8DecodeWorker=p,s.inherits(g,u),g.prototype.processChunk=function(m){this.push({data:i.utf8encode(m.data),meta:m.meta})},i.Utf8EncodeWorker=g},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(e,r,i){var s=e("./support"),o=e("./base64"),l=e("./nodejsUtils"),u=e("./external");function f(v){return v}function d(v,b){for(var P=0;P<v.length;++P)b[P]=255&v.charCodeAt(P);return b}e("setimmediate"),i.newBlob=function(v,b){i.checkSupport("blob");try{return new Blob([v],{type:b})}catch{try{var P=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return P.append(v),P.getBlob(b)}catch{throw new Error("Bug : can't construct the Blob.")}}};var p={stringifyByChunk:function(v,b,P){var A=[],B=0,Z=v.length;if(Z<=P)return String.fromCharCode.apply(null,v);for(;B<Z;)b==="array"||b==="nodebuffer"?A.push(String.fromCharCode.apply(null,v.slice(B,Math.min(B+P,Z)))):A.push(String.fromCharCode.apply(null,v.subarray(B,Math.min(B+P,Z)))),B+=P;return A.join("")},stringifyByChar:function(v){for(var b="",P=0;P<v.length;P++)b+=String.fromCharCode(v[P]);return b},applyCanBeUsed:{uint8array:function(){try{return s.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}}(),nodebuffer:function(){try{return s.nodebuffer&&String.fromCharCode.apply(null,l.allocBuffer(1)).length===1}catch{return!1}}()}};function g(v){var b=65536,P=i.getTypeOf(v),A=!0;if(P==="uint8array"?A=p.applyCanBeUsed.uint8array:P==="nodebuffer"&&(A=p.applyCanBeUsed.nodebuffer),A)for(;1<b;)try{return p.stringifyByChunk(v,P,b)}catch{b=Math.floor(b/2)}return p.stringifyByChar(v)}function m(v,b){for(var P=0;P<v.length;P++)b[P]=v[P];return b}i.applyFromCharCode=g;var x={};x.string={string:f,array:function(v){return d(v,new Array(v.length))},arraybuffer:function(v){return x.string.uint8array(v).buffer},uint8array:function(v){return d(v,new Uint8Array(v.length))},nodebuffer:function(v){return d(v,l.allocBuffer(v.length))}},x.array={string:g,array:f,arraybuffer:function(v){return new Uint8Array(v).buffer},uint8array:function(v){return new Uint8Array(v)},nodebuffer:function(v){return l.newBufferFrom(v)}},x.arraybuffer={string:function(v){return g(new Uint8Array(v))},array:function(v){return m(new Uint8Array(v),new Array(v.byteLength))},arraybuffer:f,uint8array:function(v){return new Uint8Array(v)},nodebuffer:function(v){return l.newBufferFrom(new Uint8Array(v))}},x.uint8array={string:g,array:function(v){return m(v,new Array(v.length))},arraybuffer:function(v){return v.buffer},uint8array:f,nodebuffer:function(v){return l.newBufferFrom(v)}},x.nodebuffer={string:g,array:function(v){return m(v,new Array(v.length))},arraybuffer:function(v){return x.nodebuffer.uint8array(v).buffer},uint8array:function(v){return m(v,new Uint8Array(v.length))},nodebuffer:f},i.transformTo=function(v,b){if(b=b||"",!v)return b;i.checkSupport(v);var P=i.getTypeOf(b);return x[P][v](b)},i.resolve=function(v){for(var b=v.split("/"),P=[],A=0;A<b.length;A++){var B=b[A];B==="."||B===""&&A!==0&&A!==b.length-1||(B===".."?P.pop():P.push(B))}return P.join("/")},i.getTypeOf=function(v){return typeof v=="string"?"string":Object.prototype.toString.call(v)==="[object Array]"?"array":s.nodebuffer&&l.isBuffer(v)?"nodebuffer":s.uint8array&&v instanceof Uint8Array?"uint8array":s.arraybuffer&&v instanceof ArrayBuffer?"arraybuffer":void 0},i.checkSupport=function(v){if(!s[v.toLowerCase()])throw new Error(v+" is not supported by this platform")},i.MAX_VALUE_16BITS=65535,i.MAX_VALUE_32BITS=-1,i.pretty=function(v){var b,P,A="";for(P=0;P<(v||"").length;P++)A+="\\x"+((b=v.charCodeAt(P))<16?"0":"")+b.toString(16).toUpperCase();return A},i.delay=function(v,b,P){setImmediate(function(){v.apply(P||null,b||[])})},i.inherits=function(v,b){function P(){}P.prototype=b.prototype,v.prototype=new P},i.extend=function(){var v,b,P={};for(v=0;v<arguments.length;v++)for(b in arguments[v])Object.prototype.hasOwnProperty.call(arguments[v],b)&&P[b]===void 0&&(P[b]=arguments[v][b]);return P},i.prepareContent=function(v,b,P,A,B){return u.Promise.resolve(b).then(function(Z){return s.blob&&(Z instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(Z))!==-1)&&typeof FileReader<"u"?new u.Promise(function(I,K){var V=new FileReader;V.onload=function(S){I(S.target.result)},V.onerror=function(S){K(S.target.error)},V.readAsArrayBuffer(Z)}):Z}).then(function(Z){var I=i.getTypeOf(Z);return I?(I==="arraybuffer"?Z=i.transformTo("uint8array",Z):I==="string"&&(B?Z=o.decode(Z):P&&A!==!0&&(Z=function(K){return d(K,s.uint8array?new Uint8Array(K.length):new Array(K.length))}(Z))),Z):u.Promise.reject(new Error("Can't read the data of '"+v+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(e,r,i){var s=e("./reader/readerFor"),o=e("./utils"),l=e("./signature"),u=e("./zipEntry"),f=e("./support");function d(p){this.files=[],this.loadOptions=p}d.prototype={checkSignature:function(p){if(!this.reader.readAndCheckSignature(p)){this.reader.index-=4;var g=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+o.pretty(g)+", expected "+o.pretty(p)+")")}},isSignature:function(p,g){var m=this.reader.index;this.reader.setIndex(p);var x=this.reader.readString(4)===g;return this.reader.setIndex(m),x},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var p=this.reader.readData(this.zipCommentLength),g=f.uint8array?"uint8array":"array",m=o.transformTo(g,p);this.zipComment=this.loadOptions.decodeFileName(m)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var p,g,m,x=this.zip64EndOfCentralSize-44;0<x;)p=this.reader.readInt(2),g=this.reader.readInt(4),m=this.reader.readData(g),this.zip64ExtensibleData[p]={id:p,length:g,value:m}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var p,g;for(p=0;p<this.files.length;p++)g=this.files[p],this.reader.setIndex(g.localHeaderOffset),this.checkSignature(l.LOCAL_FILE_HEADER),g.readLocalPart(this.reader),g.handleUTF8(),g.processAttributes()},readCentralDir:function(){var p;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(l.CENTRAL_FILE_HEADER);)(p=new u({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(p);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var p=this.reader.lastIndexOfSignature(l.CENTRAL_DIRECTORY_END);if(p<0)throw this.isSignature(0,l.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(p);var g=p;if(this.checkSignature(l.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===o.MAX_VALUE_16BITS||this.diskWithCentralDirStart===o.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===o.MAX_VALUE_16BITS||this.centralDirRecords===o.MAX_VALUE_16BITS||this.centralDirSize===o.MAX_VALUE_32BITS||this.centralDirOffset===o.MAX_VALUE_32BITS){if(this.zip64=!0,(p=this.reader.lastIndexOfSignature(l.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(p),this.checkSignature(l.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,l.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(l.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(l.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var m=this.centralDirOffset+this.centralDirSize;this.zip64&&(m+=20,m+=12+this.zip64EndOfCentralSize);var x=g-m;if(0<x)this.isSignature(g,l.CENTRAL_FILE_HEADER)||(this.reader.zero=x);else if(x<0)throw new Error("Corrupted zip: missing "+Math.abs(x)+" bytes.")},prepareReader:function(p){this.reader=s(p)},load:function(p){this.prepareReader(p),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},r.exports=d},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(e,r,i){var s=e("./reader/readerFor"),o=e("./utils"),l=e("./compressedObject"),u=e("./crc32"),f=e("./utf8"),d=e("./compressions"),p=e("./support");function g(m,x){this.options=m,this.loadOptions=x}g.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(m){var x,v;if(m.skip(22),this.fileNameLength=m.readInt(2),v=m.readInt(2),this.fileName=m.readData(this.fileNameLength),m.skip(v),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((x=function(b){for(var P in d)if(Object.prototype.hasOwnProperty.call(d,P)&&d[P].magic===b)return d[P];return null}(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+o.pretty(this.compressionMethod)+" unknown (inner file : "+o.transformTo("string",this.fileName)+")");this.decompressed=new l(this.compressedSize,this.uncompressedSize,this.crc32,x,m.readData(this.compressedSize))},readCentralPart:function(m){this.versionMadeBy=m.readInt(2),m.skip(2),this.bitFlag=m.readInt(2),this.compressionMethod=m.readString(2),this.date=m.readDate(),this.crc32=m.readInt(4),this.compressedSize=m.readInt(4),this.uncompressedSize=m.readInt(4);var x=m.readInt(2);if(this.extraFieldsLength=m.readInt(2),this.fileCommentLength=m.readInt(2),this.diskNumberStart=m.readInt(2),this.internalFileAttributes=m.readInt(2),this.externalFileAttributes=m.readInt(4),this.localHeaderOffset=m.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");m.skip(x),this.readExtraFields(m),this.parseZIP64ExtraField(m),this.fileComment=m.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var m=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),m==0&&(this.dosPermissions=63&this.externalFileAttributes),m==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var m=s(this.extraFields[1].value);this.uncompressedSize===o.MAX_VALUE_32BITS&&(this.uncompressedSize=m.readInt(8)),this.compressedSize===o.MAX_VALUE_32BITS&&(this.compressedSize=m.readInt(8)),this.localHeaderOffset===o.MAX_VALUE_32BITS&&(this.localHeaderOffset=m.readInt(8)),this.diskNumberStart===o.MAX_VALUE_32BITS&&(this.diskNumberStart=m.readInt(4))}},readExtraFields:function(m){var x,v,b,P=m.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});m.index+4<P;)x=m.readInt(2),v=m.readInt(2),b=m.readData(v),this.extraFields[x]={id:x,length:v,value:b};m.setIndex(P)},handleUTF8:function(){var m=p.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=f.utf8decode(this.fileName),this.fileCommentStr=f.utf8decode(this.fileComment);else{var x=this.findExtraFieldUnicodePath();if(x!==null)this.fileNameStr=x;else{var v=o.transformTo(m,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(v)}var b=this.findExtraFieldUnicodeComment();if(b!==null)this.fileCommentStr=b;else{var P=o.transformTo(m,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(P)}}},findExtraFieldUnicodePath:function(){var m=this.extraFields[28789];if(m){var x=s(m.value);return x.readInt(1)!==1||u(this.fileName)!==x.readInt(4)?null:f.utf8decode(x.readData(m.length-5))}return null},findExtraFieldUnicodeComment:function(){var m=this.extraFields[25461];if(m){var x=s(m.value);return x.readInt(1)!==1||u(this.fileComment)!==x.readInt(4)?null:f.utf8decode(x.readData(m.length-5))}return null}},r.exports=g},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(e,r,i){function s(x,v,b){this.name=x,this.dir=b.dir,this.date=b.date,this.comment=b.comment,this.unixPermissions=b.unixPermissions,this.dosPermissions=b.dosPermissions,this._data=v,this._dataBinary=b.binary,this.options={compression:b.compression,compressionOptions:b.compressionOptions}}var o=e("./stream/StreamHelper"),l=e("./stream/DataWorker"),u=e("./utf8"),f=e("./compressedObject"),d=e("./stream/GenericWorker");s.prototype={internalStream:function(x){var v=null,b="string";try{if(!x)throw new Error("No output type specified.");var P=(b=x.toLowerCase())==="string"||b==="text";b!=="binarystring"&&b!=="text"||(b="string"),v=this._decompressWorker();var A=!this._dataBinary;A&&!P&&(v=v.pipe(new u.Utf8EncodeWorker)),!A&&P&&(v=v.pipe(new u.Utf8DecodeWorker))}catch(B){(v=new d("error")).error(B)}return new o(v,b,"")},async:function(x,v){return this.internalStream(x).accumulate(v)},nodeStream:function(x,v){return this.internalStream(x||"nodebuffer").toNodejsStream(v)},_compressWorker:function(x,v){if(this._data instanceof f&&this._data.compression.magic===x.magic)return this._data.getCompressedWorker();var b=this._decompressWorker();return this._dataBinary||(b=b.pipe(new u.Utf8EncodeWorker)),f.createWorkerFrom(b,x,v)},_decompressWorker:function(){return this._data instanceof f?this._data.getContentWorker():this._data instanceof d?this._data:new l(this._data)}};for(var p=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],g=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},m=0;m<p.length;m++)s.prototype[p[m]]=g;r.exports=s},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(e,r,i){(function(s){var o,l,u=s.MutationObserver||s.WebKitMutationObserver;if(u){var f=0,d=new u(x),p=s.document.createTextNode("");d.observe(p,{characterData:!0}),o=function(){p.data=f=++f%2}}else if(s.setImmediate||s.MessageChannel===void 0)o="document"in s&&"onreadystatechange"in s.document.createElement("script")?function(){var v=s.document.createElement("script");v.onreadystatechange=function(){x(),v.onreadystatechange=null,v.parentNode.removeChild(v),v=null},s.document.documentElement.appendChild(v)}:function(){setTimeout(x,0)};else{var g=new s.MessageChannel;g.port1.onmessage=x,o=function(){g.port2.postMessage(0)}}var m=[];function x(){var v,b;l=!0;for(var P=m.length;P;){for(b=m,m=[],v=-1;++v<P;)b[v]();P=m.length}l=!1}r.exports=function(v){m.push(v)!==1||l||o()}}).call(this,typeof An<"u"?An:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(e,r,i){var s=e("immediate");function o(){}var l={},u=["REJECTED"],f=["FULFILLED"],d=["PENDING"];function p(P){if(typeof P!="function")throw new TypeError("resolver must be a function");this.state=d,this.queue=[],this.outcome=void 0,P!==o&&v(this,P)}function g(P,A,B){this.promise=P,typeof A=="function"&&(this.onFulfilled=A,this.callFulfilled=this.otherCallFulfilled),typeof B=="function"&&(this.onRejected=B,this.callRejected=this.otherCallRejected)}function m(P,A,B){s(function(){var Z;try{Z=A(B)}catch(I){return l.reject(P,I)}Z===P?l.reject(P,new TypeError("Cannot resolve promise with itself")):l.resolve(P,Z)})}function x(P){var A=P&&P.then;if(P&&(typeof P=="object"||typeof P=="function")&&typeof A=="function")return function(){A.apply(P,arguments)}}function v(P,A){var B=!1;function Z(V){B||(B=!0,l.reject(P,V))}function I(V){B||(B=!0,l.resolve(P,V))}var K=b(function(){A(I,Z)});K.status==="error"&&Z(K.value)}function b(P,A){var B={};try{B.value=P(A),B.status="success"}catch(Z){B.status="error",B.value=Z}return B}(r.exports=p).prototype.finally=function(P){if(typeof P!="function")return this;var A=this.constructor;return this.then(function(B){return A.resolve(P()).then(function(){return B})},function(B){return A.resolve(P()).then(function(){throw B})})},p.prototype.catch=function(P){return this.then(null,P)},p.prototype.then=function(P,A){if(typeof P!="function"&&this.state===f||typeof A!="function"&&this.state===u)return this;var B=new this.constructor(o);return this.state!==d?m(B,this.state===f?P:A,this.outcome):this.queue.push(new g(B,P,A)),B},g.prototype.callFulfilled=function(P){l.resolve(this.promise,P)},g.prototype.otherCallFulfilled=function(P){m(this.promise,this.onFulfilled,P)},g.prototype.callRejected=function(P){l.reject(this.promise,P)},g.prototype.otherCallRejected=function(P){m(this.promise,this.onRejected,P)},l.resolve=function(P,A){var B=b(x,A);if(B.status==="error")return l.reject(P,B.value);var Z=B.value;if(Z)v(P,Z);else{P.state=f,P.outcome=A;for(var I=-1,K=P.queue.length;++I<K;)P.queue[I].callFulfilled(A)}return P},l.reject=function(P,A){P.state=u,P.outcome=A;for(var B=-1,Z=P.queue.length;++B<Z;)P.queue[B].callRejected(A);return P},p.resolve=function(P){return P instanceof this?P:l.resolve(new this(o),P)},p.reject=function(P){var A=new this(o);return l.reject(A,P)},p.all=function(P){var A=this;if(Object.prototype.toString.call(P)!=="[object Array]")return this.reject(new TypeError("must be an array"));var B=P.length,Z=!1;if(!B)return this.resolve([]);for(var I=new Array(B),K=0,V=-1,S=new this(o);++V<B;)k(P[V],V);return S;function k(O,N){A.resolve(O).then(function(E){I[N]=E,++K!==B||Z||(Z=!0,l.resolve(S,I))},function(E){Z||(Z=!0,l.reject(S,E))})}},p.race=function(P){var A=this;if(Object.prototype.toString.call(P)!=="[object Array]")return this.reject(new TypeError("must be an array"));var B=P.length,Z=!1;if(!B)return this.resolve([]);for(var I=-1,K=new this(o);++I<B;)V=P[I],A.resolve(V).then(function(S){Z||(Z=!0,l.resolve(K,S))},function(S){Z||(Z=!0,l.reject(K,S))});var V;return K}},{immediate:36}],38:[function(e,r,i){var s={};(0,e("./lib/utils/common").assign)(s,e("./lib/deflate"),e("./lib/inflate"),e("./lib/zlib/constants")),r.exports=s},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(e,r,i){var s=e("./zlib/deflate"),o=e("./utils/common"),l=e("./utils/strings"),u=e("./zlib/messages"),f=e("./zlib/zstream"),d=Object.prototype.toString,p=0,g=-1,m=0,x=8;function v(P){if(!(this instanceof v))return new v(P);this.options=o.assign({level:g,method:x,chunkSize:16384,windowBits:15,memLevel:8,strategy:m,to:""},P||{});var A=this.options;A.raw&&0<A.windowBits?A.windowBits=-A.windowBits:A.gzip&&0<A.windowBits&&A.windowBits<16&&(A.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new f,this.strm.avail_out=0;var B=s.deflateInit2(this.strm,A.level,A.method,A.windowBits,A.memLevel,A.strategy);if(B!==p)throw new Error(u[B]);if(A.header&&s.deflateSetHeader(this.strm,A.header),A.dictionary){var Z;if(Z=typeof A.dictionary=="string"?l.string2buf(A.dictionary):d.call(A.dictionary)==="[object ArrayBuffer]"?new Uint8Array(A.dictionary):A.dictionary,(B=s.deflateSetDictionary(this.strm,Z))!==p)throw new Error(u[B]);this._dict_set=!0}}function b(P,A){var B=new v(A);if(B.push(P,!0),B.err)throw B.msg||u[B.err];return B.result}v.prototype.push=function(P,A){var B,Z,I=this.strm,K=this.options.chunkSize;if(this.ended)return!1;Z=A===~~A?A:A===!0?4:0,typeof P=="string"?I.input=l.string2buf(P):d.call(P)==="[object ArrayBuffer]"?I.input=new Uint8Array(P):I.input=P,I.next_in=0,I.avail_in=I.input.length;do{if(I.avail_out===0&&(I.output=new o.Buf8(K),I.next_out=0,I.avail_out=K),(B=s.deflate(I,Z))!==1&&B!==p)return this.onEnd(B),!(this.ended=!0);I.avail_out!==0&&(I.avail_in!==0||Z!==4&&Z!==2)||(this.options.to==="string"?this.onData(l.buf2binstring(o.shrinkBuf(I.output,I.next_out))):this.onData(o.shrinkBuf(I.output,I.next_out)))}while((0<I.avail_in||I.avail_out===0)&&B!==1);return Z===4?(B=s.deflateEnd(this.strm),this.onEnd(B),this.ended=!0,B===p):Z!==2||(this.onEnd(p),!(I.avail_out=0))},v.prototype.onData=function(P){this.chunks.push(P)},v.prototype.onEnd=function(P){P===p&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=o.flattenChunks(this.chunks)),this.chunks=[],this.err=P,this.msg=this.strm.msg},i.Deflate=v,i.deflate=b,i.deflateRaw=function(P,A){return(A=A||{}).raw=!0,b(P,A)},i.gzip=function(P,A){return(A=A||{}).gzip=!0,b(P,A)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(e,r,i){var s=e("./zlib/inflate"),o=e("./utils/common"),l=e("./utils/strings"),u=e("./zlib/constants"),f=e("./zlib/messages"),d=e("./zlib/zstream"),p=e("./zlib/gzheader"),g=Object.prototype.toString;function m(v){if(!(this instanceof m))return new m(v);this.options=o.assign({chunkSize:16384,windowBits:0,to:""},v||{});var b=this.options;b.raw&&0<=b.windowBits&&b.windowBits<16&&(b.windowBits=-b.windowBits,b.windowBits===0&&(b.windowBits=-15)),!(0<=b.windowBits&&b.windowBits<16)||v&&v.windowBits||(b.windowBits+=32),15<b.windowBits&&b.windowBits<48&&!(15&b.windowBits)&&(b.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new d,this.strm.avail_out=0;var P=s.inflateInit2(this.strm,b.windowBits);if(P!==u.Z_OK)throw new Error(f[P]);this.header=new p,s.inflateGetHeader(this.strm,this.header)}function x(v,b){var P=new m(b);if(P.push(v,!0),P.err)throw P.msg||f[P.err];return P.result}m.prototype.push=function(v,b){var P,A,B,Z,I,K,V=this.strm,S=this.options.chunkSize,k=this.options.dictionary,O=!1;if(this.ended)return!1;A=b===~~b?b:b===!0?u.Z_FINISH:u.Z_NO_FLUSH,typeof v=="string"?V.input=l.binstring2buf(v):g.call(v)==="[object ArrayBuffer]"?V.input=new Uint8Array(v):V.input=v,V.next_in=0,V.avail_in=V.input.length;do{if(V.avail_out===0&&(V.output=new o.Buf8(S),V.next_out=0,V.avail_out=S),(P=s.inflate(V,u.Z_NO_FLUSH))===u.Z_NEED_DICT&&k&&(K=typeof k=="string"?l.string2buf(k):g.call(k)==="[object ArrayBuffer]"?new Uint8Array(k):k,P=s.inflateSetDictionary(this.strm,K)),P===u.Z_BUF_ERROR&&O===!0&&(P=u.Z_OK,O=!1),P!==u.Z_STREAM_END&&P!==u.Z_OK)return this.onEnd(P),!(this.ended=!0);V.next_out&&(V.avail_out!==0&&P!==u.Z_STREAM_END&&(V.avail_in!==0||A!==u.Z_FINISH&&A!==u.Z_SYNC_FLUSH)||(this.options.to==="string"?(B=l.utf8border(V.output,V.next_out),Z=V.next_out-B,I=l.buf2string(V.output,B),V.next_out=Z,V.avail_out=S-Z,Z&&o.arraySet(V.output,V.output,B,Z,0),this.onData(I)):this.onData(o.shrinkBuf(V.output,V.next_out)))),V.avail_in===0&&V.avail_out===0&&(O=!0)}while((0<V.avail_in||V.avail_out===0)&&P!==u.Z_STREAM_END);return P===u.Z_STREAM_END&&(A=u.Z_FINISH),A===u.Z_FINISH?(P=s.inflateEnd(this.strm),this.onEnd(P),this.ended=!0,P===u.Z_OK):A!==u.Z_SYNC_FLUSH||(this.onEnd(u.Z_OK),!(V.avail_out=0))},m.prototype.onData=function(v){this.chunks.push(v)},m.prototype.onEnd=function(v){v===u.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=o.flattenChunks(this.chunks)),this.chunks=[],this.err=v,this.msg=this.strm.msg},i.Inflate=m,i.inflate=x,i.inflateRaw=function(v,b){return(b=b||{}).raw=!0,x(v,b)},i.ungzip=x},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(e,r,i){var s=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";i.assign=function(u){for(var f=Array.prototype.slice.call(arguments,1);f.length;){var d=f.shift();if(d){if(typeof d!="object")throw new TypeError(d+"must be non-object");for(var p in d)d.hasOwnProperty(p)&&(u[p]=d[p])}}return u},i.shrinkBuf=function(u,f){return u.length===f?u:u.subarray?u.subarray(0,f):(u.length=f,u)};var o={arraySet:function(u,f,d,p,g){if(f.subarray&&u.subarray)u.set(f.subarray(d,d+p),g);else for(var m=0;m<p;m++)u[g+m]=f[d+m]},flattenChunks:function(u){var f,d,p,g,m,x;for(f=p=0,d=u.length;f<d;f++)p+=u[f].length;for(x=new Uint8Array(p),f=g=0,d=u.length;f<d;f++)m=u[f],x.set(m,g),g+=m.length;return x}},l={arraySet:function(u,f,d,p,g){for(var m=0;m<p;m++)u[g+m]=f[d+m]},flattenChunks:function(u){return[].concat.apply([],u)}};i.setTyped=function(u){u?(i.Buf8=Uint8Array,i.Buf16=Uint16Array,i.Buf32=Int32Array,i.assign(i,o)):(i.Buf8=Array,i.Buf16=Array,i.Buf32=Array,i.assign(i,l))},i.setTyped(s)},{}],42:[function(e,r,i){var s=e("./common"),o=!0,l=!0;try{String.fromCharCode.apply(null,[0])}catch{o=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{l=!1}for(var u=new s.Buf8(256),f=0;f<256;f++)u[f]=252<=f?6:248<=f?5:240<=f?4:224<=f?3:192<=f?2:1;function d(p,g){if(g<65537&&(p.subarray&&l||!p.subarray&&o))return String.fromCharCode.apply(null,s.shrinkBuf(p,g));for(var m="",x=0;x<g;x++)m+=String.fromCharCode(p[x]);return m}u[254]=u[254]=1,i.string2buf=function(p){var g,m,x,v,b,P=p.length,A=0;for(v=0;v<P;v++)(64512&(m=p.charCodeAt(v)))==55296&&v+1<P&&(64512&(x=p.charCodeAt(v+1)))==56320&&(m=65536+(m-55296<<10)+(x-56320),v++),A+=m<128?1:m<2048?2:m<65536?3:4;for(g=new s.Buf8(A),v=b=0;b<A;v++)(64512&(m=p.charCodeAt(v)))==55296&&v+1<P&&(64512&(x=p.charCodeAt(v+1)))==56320&&(m=65536+(m-55296<<10)+(x-56320),v++),m<128?g[b++]=m:(m<2048?g[b++]=192|m>>>6:(m<65536?g[b++]=224|m>>>12:(g[b++]=240|m>>>18,g[b++]=128|m>>>12&63),g[b++]=128|m>>>6&63),g[b++]=128|63&m);return g},i.buf2binstring=function(p){return d(p,p.length)},i.binstring2buf=function(p){for(var g=new s.Buf8(p.length),m=0,x=g.length;m<x;m++)g[m]=p.charCodeAt(m);return g},i.buf2string=function(p,g){var m,x,v,b,P=g||p.length,A=new Array(2*P);for(m=x=0;m<P;)if((v=p[m++])<128)A[x++]=v;else if(4<(b=u[v]))A[x++]=65533,m+=b-1;else{for(v&=b===2?31:b===3?15:7;1<b&&m<P;)v=v<<6|63&p[m++],b--;1<b?A[x++]=65533:v<65536?A[x++]=v:(v-=65536,A[x++]=55296|v>>10&1023,A[x++]=56320|1023&v)}return d(A,x)},i.utf8border=function(p,g){var m;for((g=g||p.length)>p.length&&(g=p.length),m=g-1;0<=m&&(192&p[m])==128;)m--;return m<0||m===0?g:m+u[p[m]]>g?m:g}},{"./common":41}],43:[function(e,r,i){r.exports=function(s,o,l,u){for(var f=65535&s|0,d=s>>>16&65535|0,p=0;l!==0;){for(l-=p=2e3<l?2e3:l;d=d+(f=f+o[u++]|0)|0,--p;);f%=65521,d%=65521}return f|d<<16|0}},{}],44:[function(e,r,i){r.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(e,r,i){var s=function(){for(var o,l=[],u=0;u<256;u++){o=u;for(var f=0;f<8;f++)o=1&o?3988292384^o>>>1:o>>>1;l[u]=o}return l}();r.exports=function(o,l,u,f){var d=s,p=f+u;o^=-1;for(var g=f;g<p;g++)o=o>>>8^d[255&(o^l[g])];return-1^o}},{}],46:[function(e,r,i){var s,o=e("../utils/common"),l=e("./trees"),u=e("./adler32"),f=e("./crc32"),d=e("./messages"),p=0,g=4,m=0,x=-2,v=-1,b=4,P=2,A=8,B=9,Z=286,I=30,K=19,V=2*Z+1,S=15,k=3,O=258,N=O+k+1,E=42,C=113,y=1,z=2,H=3,G=4;function W(M,et){return M.msg=d[et],et}function X(M){return(M<<1)-(4<M?9:0)}function tt(M){for(var et=M.length;0<=--et;)M[et]=0}function q(M){var et=M.state,j=et.pending;j>M.avail_out&&(j=M.avail_out),j!==0&&(o.arraySet(M.output,et.pending_buf,et.pending_out,j,M.next_out),M.next_out+=j,et.pending_out+=j,M.total_out+=j,M.avail_out-=j,et.pending-=j,et.pending===0&&(et.pending_out=0))}function Q(M,et){l._tr_flush_block(M,0<=M.block_start?M.block_start:-1,M.strstart-M.block_start,et),M.block_start=M.strstart,q(M.strm)}function dt(M,et){M.pending_buf[M.pending++]=et}function ct(M,et){M.pending_buf[M.pending++]=et>>>8&255,M.pending_buf[M.pending++]=255&et}function rt(M,et){var j,U,F=M.max_chain_length,J=M.strstart,at=M.prev_length,lt=M.nice_match,it=M.strstart>M.w_size-N?M.strstart-(M.w_size-N):0,_t=M.window,xt=M.w_mask,gt=M.prev,Tt=M.strstart+O,Wt=_t[J+at-1],kt=_t[J+at];M.prev_length>=M.good_match&&(F>>=2),lt>M.lookahead&&(lt=M.lookahead);do if(_t[(j=et)+at]===kt&&_t[j+at-1]===Wt&&_t[j]===_t[J]&&_t[++j]===_t[J+1]){J+=2,j++;do;while(_t[++J]===_t[++j]&&_t[++J]===_t[++j]&&_t[++J]===_t[++j]&&_t[++J]===_t[++j]&&_t[++J]===_t[++j]&&_t[++J]===_t[++j]&&_t[++J]===_t[++j]&&_t[++J]===_t[++j]&&J<Tt);if(U=O-(Tt-J),J=Tt-O,at<U){if(M.match_start=et,lt<=(at=U))break;Wt=_t[J+at-1],kt=_t[J+at]}}while((et=gt[et&xt])>it&&--F!=0);return at<=M.lookahead?at:M.lookahead}function mt(M){var et,j,U,F,J,at,lt,it,_t,xt,gt=M.w_size;do{if(F=M.window_size-M.lookahead-M.strstart,M.strstart>=gt+(gt-N)){for(o.arraySet(M.window,M.window,gt,gt,0),M.match_start-=gt,M.strstart-=gt,M.block_start-=gt,et=j=M.hash_size;U=M.head[--et],M.head[et]=gt<=U?U-gt:0,--j;);for(et=j=gt;U=M.prev[--et],M.prev[et]=gt<=U?U-gt:0,--j;);F+=gt}if(M.strm.avail_in===0)break;if(at=M.strm,lt=M.window,it=M.strstart+M.lookahead,_t=F,xt=void 0,xt=at.avail_in,_t<xt&&(xt=_t),j=xt===0?0:(at.avail_in-=xt,o.arraySet(lt,at.input,at.next_in,xt,it),at.state.wrap===1?at.adler=u(at.adler,lt,xt,it):at.state.wrap===2&&(at.adler=f(at.adler,lt,xt,it)),at.next_in+=xt,at.total_in+=xt,xt),M.lookahead+=j,M.lookahead+M.insert>=k)for(J=M.strstart-M.insert,M.ins_h=M.window[J],M.ins_h=(M.ins_h<<M.hash_shift^M.window[J+1])&M.hash_mask;M.insert&&(M.ins_h=(M.ins_h<<M.hash_shift^M.window[J+k-1])&M.hash_mask,M.prev[J&M.w_mask]=M.head[M.ins_h],M.head[M.ins_h]=J,J++,M.insert--,!(M.lookahead+M.insert<k)););}while(M.lookahead<N&&M.strm.avail_in!==0)}function Et(M,et){for(var j,U;;){if(M.lookahead<N){if(mt(M),M.lookahead<N&&et===p)return y;if(M.lookahead===0)break}if(j=0,M.lookahead>=k&&(M.ins_h=(M.ins_h<<M.hash_shift^M.window[M.strstart+k-1])&M.hash_mask,j=M.prev[M.strstart&M.w_mask]=M.head[M.ins_h],M.head[M.ins_h]=M.strstart),j!==0&&M.strstart-j<=M.w_size-N&&(M.match_length=rt(M,j)),M.match_length>=k)if(U=l._tr_tally(M,M.strstart-M.match_start,M.match_length-k),M.lookahead-=M.match_length,M.match_length<=M.max_lazy_match&&M.lookahead>=k){for(M.match_length--;M.strstart++,M.ins_h=(M.ins_h<<M.hash_shift^M.window[M.strstart+k-1])&M.hash_mask,j=M.prev[M.strstart&M.w_mask]=M.head[M.ins_h],M.head[M.ins_h]=M.strstart,--M.match_length!=0;);M.strstart++}else M.strstart+=M.match_length,M.match_length=0,M.ins_h=M.window[M.strstart],M.ins_h=(M.ins_h<<M.hash_shift^M.window[M.strstart+1])&M.hash_mask;else U=l._tr_tally(M,0,M.window[M.strstart]),M.lookahead--,M.strstart++;if(U&&(Q(M,!1),M.strm.avail_out===0))return y}return M.insert=M.strstart<k-1?M.strstart:k-1,et===g?(Q(M,!0),M.strm.avail_out===0?H:G):M.last_lit&&(Q(M,!1),M.strm.avail_out===0)?y:z}function St(M,et){for(var j,U,F;;){if(M.lookahead<N){if(mt(M),M.lookahead<N&&et===p)return y;if(M.lookahead===0)break}if(j=0,M.lookahead>=k&&(M.ins_h=(M.ins_h<<M.hash_shift^M.window[M.strstart+k-1])&M.hash_mask,j=M.prev[M.strstart&M.w_mask]=M.head[M.ins_h],M.head[M.ins_h]=M.strstart),M.prev_length=M.match_length,M.prev_match=M.match_start,M.match_length=k-1,j!==0&&M.prev_length<M.max_lazy_match&&M.strstart-j<=M.w_size-N&&(M.match_length=rt(M,j),M.match_length<=5&&(M.strategy===1||M.match_length===k&&4096<M.strstart-M.match_start)&&(M.match_length=k-1)),M.prev_length>=k&&M.match_length<=M.prev_length){for(F=M.strstart+M.lookahead-k,U=l._tr_tally(M,M.strstart-1-M.prev_match,M.prev_length-k),M.lookahead-=M.prev_length-1,M.prev_length-=2;++M.strstart<=F&&(M.ins_h=(M.ins_h<<M.hash_shift^M.window[M.strstart+k-1])&M.hash_mask,j=M.prev[M.strstart&M.w_mask]=M.head[M.ins_h],M.head[M.ins_h]=M.strstart),--M.prev_length!=0;);if(M.match_available=0,M.match_length=k-1,M.strstart++,U&&(Q(M,!1),M.strm.avail_out===0))return y}else if(M.match_available){if((U=l._tr_tally(M,0,M.window[M.strstart-1]))&&Q(M,!1),M.strstart++,M.lookahead--,M.strm.avail_out===0)return y}else M.match_available=1,M.strstart++,M.lookahead--}return M.match_available&&(U=l._tr_tally(M,0,M.window[M.strstart-1]),M.match_available=0),M.insert=M.strstart<k-1?M.strstart:k-1,et===g?(Q(M,!0),M.strm.avail_out===0?H:G):M.last_lit&&(Q(M,!1),M.strm.avail_out===0)?y:z}function Ot(M,et,j,U,F){this.good_length=M,this.max_lazy=et,this.nice_length=j,this.max_chain=U,this.func=F}function bt(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=A,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new o.Buf16(2*V),this.dyn_dtree=new o.Buf16(2*(2*I+1)),this.bl_tree=new o.Buf16(2*(2*K+1)),tt(this.dyn_ltree),tt(this.dyn_dtree),tt(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new o.Buf16(S+1),this.heap=new o.Buf16(2*Z+1),tt(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new o.Buf16(2*Z+1),tt(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function vt(M){var et;return M&&M.state?(M.total_in=M.total_out=0,M.data_type=P,(et=M.state).pending=0,et.pending_out=0,et.wrap<0&&(et.wrap=-et.wrap),et.status=et.wrap?E:C,M.adler=et.wrap===2?0:1,et.last_flush=p,l._tr_init(et),m):W(M,x)}function ht(M){var et=vt(M);return et===m&&function(j){j.window_size=2*j.w_size,tt(j.head),j.max_lazy_match=s[j.level].max_lazy,j.good_match=s[j.level].good_length,j.nice_match=s[j.level].nice_length,j.max_chain_length=s[j.level].max_chain,j.strstart=0,j.block_start=0,j.lookahead=0,j.insert=0,j.match_length=j.prev_length=k-1,j.match_available=0,j.ins_h=0}(M.state),et}function ft(M,et,j,U,F,J){if(!M)return x;var at=1;if(et===v&&(et=6),U<0?(at=0,U=-U):15<U&&(at=2,U-=16),F<1||B<F||j!==A||U<8||15<U||et<0||9<et||J<0||b<J)return W(M,x);U===8&&(U=9);var lt=new bt;return(M.state=lt).strm=M,lt.wrap=at,lt.gzhead=null,lt.w_bits=U,lt.w_size=1<<lt.w_bits,lt.w_mask=lt.w_size-1,lt.hash_bits=F+7,lt.hash_size=1<<lt.hash_bits,lt.hash_mask=lt.hash_size-1,lt.hash_shift=~~((lt.hash_bits+k-1)/k),lt.window=new o.Buf8(2*lt.w_size),lt.head=new o.Buf16(lt.hash_size),lt.prev=new o.Buf16(lt.w_size),lt.lit_bufsize=1<<F+6,lt.pending_buf_size=4*lt.lit_bufsize,lt.pending_buf=new o.Buf8(lt.pending_buf_size),lt.d_buf=1*lt.lit_bufsize,lt.l_buf=3*lt.lit_bufsize,lt.level=et,lt.strategy=J,lt.method=j,ht(M)}s=[new Ot(0,0,0,0,function(M,et){var j=65535;for(j>M.pending_buf_size-5&&(j=M.pending_buf_size-5);;){if(M.lookahead<=1){if(mt(M),M.lookahead===0&&et===p)return y;if(M.lookahead===0)break}M.strstart+=M.lookahead,M.lookahead=0;var U=M.block_start+j;if((M.strstart===0||M.strstart>=U)&&(M.lookahead=M.strstart-U,M.strstart=U,Q(M,!1),M.strm.avail_out===0)||M.strstart-M.block_start>=M.w_size-N&&(Q(M,!1),M.strm.avail_out===0))return y}return M.insert=0,et===g?(Q(M,!0),M.strm.avail_out===0?H:G):(M.strstart>M.block_start&&(Q(M,!1),M.strm.avail_out),y)}),new Ot(4,4,8,4,Et),new Ot(4,5,16,8,Et),new Ot(4,6,32,32,Et),new Ot(4,4,16,16,St),new Ot(8,16,32,32,St),new Ot(8,16,128,128,St),new Ot(8,32,128,256,St),new Ot(32,128,258,1024,St),new Ot(32,258,258,4096,St)],i.deflateInit=function(M,et){return ft(M,et,A,15,8,0)},i.deflateInit2=ft,i.deflateReset=ht,i.deflateResetKeep=vt,i.deflateSetHeader=function(M,et){return M&&M.state?M.state.wrap!==2?x:(M.state.gzhead=et,m):x},i.deflate=function(M,et){var j,U,F,J;if(!M||!M.state||5<et||et<0)return M?W(M,x):x;if(U=M.state,!M.output||!M.input&&M.avail_in!==0||U.status===666&&et!==g)return W(M,M.avail_out===0?-5:x);if(U.strm=M,j=U.last_flush,U.last_flush=et,U.status===E)if(U.wrap===2)M.adler=0,dt(U,31),dt(U,139),dt(U,8),U.gzhead?(dt(U,(U.gzhead.text?1:0)+(U.gzhead.hcrc?2:0)+(U.gzhead.extra?4:0)+(U.gzhead.name?8:0)+(U.gzhead.comment?16:0)),dt(U,255&U.gzhead.time),dt(U,U.gzhead.time>>8&255),dt(U,U.gzhead.time>>16&255),dt(U,U.gzhead.time>>24&255),dt(U,U.level===9?2:2<=U.strategy||U.level<2?4:0),dt(U,255&U.gzhead.os),U.gzhead.extra&&U.gzhead.extra.length&&(dt(U,255&U.gzhead.extra.length),dt(U,U.gzhead.extra.length>>8&255)),U.gzhead.hcrc&&(M.adler=f(M.adler,U.pending_buf,U.pending,0)),U.gzindex=0,U.status=69):(dt(U,0),dt(U,0),dt(U,0),dt(U,0),dt(U,0),dt(U,U.level===9?2:2<=U.strategy||U.level<2?4:0),dt(U,3),U.status=C);else{var at=A+(U.w_bits-8<<4)<<8;at|=(2<=U.strategy||U.level<2?0:U.level<6?1:U.level===6?2:3)<<6,U.strstart!==0&&(at|=32),at+=31-at%31,U.status=C,ct(U,at),U.strstart!==0&&(ct(U,M.adler>>>16),ct(U,65535&M.adler)),M.adler=1}if(U.status===69)if(U.gzhead.extra){for(F=U.pending;U.gzindex<(65535&U.gzhead.extra.length)&&(U.pending!==U.pending_buf_size||(U.gzhead.hcrc&&U.pending>F&&(M.adler=f(M.adler,U.pending_buf,U.pending-F,F)),q(M),F=U.pending,U.pending!==U.pending_buf_size));)dt(U,255&U.gzhead.extra[U.gzindex]),U.gzindex++;U.gzhead.hcrc&&U.pending>F&&(M.adler=f(M.adler,U.pending_buf,U.pending-F,F)),U.gzindex===U.gzhead.extra.length&&(U.gzindex=0,U.status=73)}else U.status=73;if(U.status===73)if(U.gzhead.name){F=U.pending;do{if(U.pending===U.pending_buf_size&&(U.gzhead.hcrc&&U.pending>F&&(M.adler=f(M.adler,U.pending_buf,U.pending-F,F)),q(M),F=U.pending,U.pending===U.pending_buf_size)){J=1;break}J=U.gzindex<U.gzhead.name.length?255&U.gzhead.name.charCodeAt(U.gzindex++):0,dt(U,J)}while(J!==0);U.gzhead.hcrc&&U.pending>F&&(M.adler=f(M.adler,U.pending_buf,U.pending-F,F)),J===0&&(U.gzindex=0,U.status=91)}else U.status=91;if(U.status===91)if(U.gzhead.comment){F=U.pending;do{if(U.pending===U.pending_buf_size&&(U.gzhead.hcrc&&U.pending>F&&(M.adler=f(M.adler,U.pending_buf,U.pending-F,F)),q(M),F=U.pending,U.pending===U.pending_buf_size)){J=1;break}J=U.gzindex<U.gzhead.comment.length?255&U.gzhead.comment.charCodeAt(U.gzindex++):0,dt(U,J)}while(J!==0);U.gzhead.hcrc&&U.pending>F&&(M.adler=f(M.adler,U.pending_buf,U.pending-F,F)),J===0&&(U.status=103)}else U.status=103;if(U.status===103&&(U.gzhead.hcrc?(U.pending+2>U.pending_buf_size&&q(M),U.pending+2<=U.pending_buf_size&&(dt(U,255&M.adler),dt(U,M.adler>>8&255),M.adler=0,U.status=C)):U.status=C),U.pending!==0){if(q(M),M.avail_out===0)return U.last_flush=-1,m}else if(M.avail_in===0&&X(et)<=X(j)&&et!==g)return W(M,-5);if(U.status===666&&M.avail_in!==0)return W(M,-5);if(M.avail_in!==0||U.lookahead!==0||et!==p&&U.status!==666){var lt=U.strategy===2?function(it,_t){for(var xt;;){if(it.lookahead===0&&(mt(it),it.lookahead===0)){if(_t===p)return y;break}if(it.match_length=0,xt=l._tr_tally(it,0,it.window[it.strstart]),it.lookahead--,it.strstart++,xt&&(Q(it,!1),it.strm.avail_out===0))return y}return it.insert=0,_t===g?(Q(it,!0),it.strm.avail_out===0?H:G):it.last_lit&&(Q(it,!1),it.strm.avail_out===0)?y:z}(U,et):U.strategy===3?function(it,_t){for(var xt,gt,Tt,Wt,kt=it.window;;){if(it.lookahead<=O){if(mt(it),it.lookahead<=O&&_t===p)return y;if(it.lookahead===0)break}if(it.match_length=0,it.lookahead>=k&&0<it.strstart&&(gt=kt[Tt=it.strstart-1])===kt[++Tt]&&gt===kt[++Tt]&&gt===kt[++Tt]){Wt=it.strstart+O;do;while(gt===kt[++Tt]&&gt===kt[++Tt]&&gt===kt[++Tt]&&gt===kt[++Tt]&&gt===kt[++Tt]&&gt===kt[++Tt]&&gt===kt[++Tt]&&gt===kt[++Tt]&&Tt<Wt);it.match_length=O-(Wt-Tt),it.match_length>it.lookahead&&(it.match_length=it.lookahead)}if(it.match_length>=k?(xt=l._tr_tally(it,1,it.match_length-k),it.lookahead-=it.match_length,it.strstart+=it.match_length,it.match_length=0):(xt=l._tr_tally(it,0,it.window[it.strstart]),it.lookahead--,it.strstart++),xt&&(Q(it,!1),it.strm.avail_out===0))return y}return it.insert=0,_t===g?(Q(it,!0),it.strm.avail_out===0?H:G):it.last_lit&&(Q(it,!1),it.strm.avail_out===0)?y:z}(U,et):s[U.level].func(U,et);if(lt!==H&&lt!==G||(U.status=666),lt===y||lt===H)return M.avail_out===0&&(U.last_flush=-1),m;if(lt===z&&(et===1?l._tr_align(U):et!==5&&(l._tr_stored_block(U,0,0,!1),et===3&&(tt(U.head),U.lookahead===0&&(U.strstart=0,U.block_start=0,U.insert=0))),q(M),M.avail_out===0))return U.last_flush=-1,m}return et!==g?m:U.wrap<=0?1:(U.wrap===2?(dt(U,255&M.adler),dt(U,M.adler>>8&255),dt(U,M.adler>>16&255),dt(U,M.adler>>24&255),dt(U,255&M.total_in),dt(U,M.total_in>>8&255),dt(U,M.total_in>>16&255),dt(U,M.total_in>>24&255)):(ct(U,M.adler>>>16),ct(U,65535&M.adler)),q(M),0<U.wrap&&(U.wrap=-U.wrap),U.pending!==0?m:1)},i.deflateEnd=function(M){var et;return M&&M.state?(et=M.state.status)!==E&&et!==69&&et!==73&&et!==91&&et!==103&&et!==C&&et!==666?W(M,x):(M.state=null,et===C?W(M,-3):m):x},i.deflateSetDictionary=function(M,et){var j,U,F,J,at,lt,it,_t,xt=et.length;if(!M||!M.state||(J=(j=M.state).wrap)===2||J===1&&j.status!==E||j.lookahead)return x;for(J===1&&(M.adler=u(M.adler,et,xt,0)),j.wrap=0,xt>=j.w_size&&(J===0&&(tt(j.head),j.strstart=0,j.block_start=0,j.insert=0),_t=new o.Buf8(j.w_size),o.arraySet(_t,et,xt-j.w_size,j.w_size,0),et=_t,xt=j.w_size),at=M.avail_in,lt=M.next_in,it=M.input,M.avail_in=xt,M.next_in=0,M.input=et,mt(j);j.lookahead>=k;){for(U=j.strstart,F=j.lookahead-(k-1);j.ins_h=(j.ins_h<<j.hash_shift^j.window[U+k-1])&j.hash_mask,j.prev[U&j.w_mask]=j.head[j.ins_h],j.head[j.ins_h]=U,U++,--F;);j.strstart=U,j.lookahead=k-1,mt(j)}return j.strstart+=j.lookahead,j.block_start=j.strstart,j.insert=j.lookahead,j.lookahead=0,j.match_length=j.prev_length=k-1,j.match_available=0,M.next_in=lt,M.input=it,M.avail_in=at,j.wrap=J,m},i.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(e,r,i){r.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(e,r,i){r.exports=function(s,o){var l,u,f,d,p,g,m,x,v,b,P,A,B,Z,I,K,V,S,k,O,N,E,C,y,z;l=s.state,u=s.next_in,y=s.input,f=u+(s.avail_in-5),d=s.next_out,z=s.output,p=d-(o-s.avail_out),g=d+(s.avail_out-257),m=l.dmax,x=l.wsize,v=l.whave,b=l.wnext,P=l.window,A=l.hold,B=l.bits,Z=l.lencode,I=l.distcode,K=(1<<l.lenbits)-1,V=(1<<l.distbits)-1;t:do{B<15&&(A+=y[u++]<<B,B+=8,A+=y[u++]<<B,B+=8),S=Z[A&K];e:for(;;){if(A>>>=k=S>>>24,B-=k,(k=S>>>16&255)===0)z[d++]=65535&S;else{if(!(16&k)){if(!(64&k)){S=Z[(65535&S)+(A&(1<<k)-1)];continue e}if(32&k){l.mode=12;break t}s.msg="invalid literal/length code",l.mode=30;break t}O=65535&S,(k&=15)&&(B<k&&(A+=y[u++]<<B,B+=8),O+=A&(1<<k)-1,A>>>=k,B-=k),B<15&&(A+=y[u++]<<B,B+=8,A+=y[u++]<<B,B+=8),S=I[A&V];i:for(;;){if(A>>>=k=S>>>24,B-=k,!(16&(k=S>>>16&255))){if(!(64&k)){S=I[(65535&S)+(A&(1<<k)-1)];continue i}s.msg="invalid distance code",l.mode=30;break t}if(N=65535&S,B<(k&=15)&&(A+=y[u++]<<B,(B+=8)<k&&(A+=y[u++]<<B,B+=8)),m<(N+=A&(1<<k)-1)){s.msg="invalid distance too far back",l.mode=30;break t}if(A>>>=k,B-=k,(k=d-p)<N){if(v<(k=N-k)&&l.sane){s.msg="invalid distance too far back",l.mode=30;break t}if(C=P,(E=0)===b){if(E+=x-k,k<O){for(O-=k;z[d++]=P[E++],--k;);E=d-N,C=z}}else if(b<k){if(E+=x+b-k,(k-=b)<O){for(O-=k;z[d++]=P[E++],--k;);if(E=0,b<O){for(O-=k=b;z[d++]=P[E++],--k;);E=d-N,C=z}}}else if(E+=b-k,k<O){for(O-=k;z[d++]=P[E++],--k;);E=d-N,C=z}for(;2<O;)z[d++]=C[E++],z[d++]=C[E++],z[d++]=C[E++],O-=3;O&&(z[d++]=C[E++],1<O&&(z[d++]=C[E++]))}else{for(E=d-N;z[d++]=z[E++],z[d++]=z[E++],z[d++]=z[E++],2<(O-=3););O&&(z[d++]=z[E++],1<O&&(z[d++]=z[E++]))}break}}break}}while(u<f&&d<g);u-=O=B>>3,A&=(1<<(B-=O<<3))-1,s.next_in=u,s.next_out=d,s.avail_in=u<f?f-u+5:5-(u-f),s.avail_out=d<g?g-d+257:257-(d-g),l.hold=A,l.bits=B}},{}],49:[function(e,r,i){var s=e("../utils/common"),o=e("./adler32"),l=e("./crc32"),u=e("./inffast"),f=e("./inftrees"),d=1,p=2,g=0,m=-2,x=1,v=852,b=592;function P(E){return(E>>>24&255)+(E>>>8&65280)+((65280&E)<<8)+((255&E)<<24)}function A(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new s.Buf16(320),this.work=new s.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function B(E){var C;return E&&E.state?(C=E.state,E.total_in=E.total_out=C.total=0,E.msg="",C.wrap&&(E.adler=1&C.wrap),C.mode=x,C.last=0,C.havedict=0,C.dmax=32768,C.head=null,C.hold=0,C.bits=0,C.lencode=C.lendyn=new s.Buf32(v),C.distcode=C.distdyn=new s.Buf32(b),C.sane=1,C.back=-1,g):m}function Z(E){var C;return E&&E.state?((C=E.state).wsize=0,C.whave=0,C.wnext=0,B(E)):m}function I(E,C){var y,z;return E&&E.state?(z=E.state,C<0?(y=0,C=-C):(y=1+(C>>4),C<48&&(C&=15)),C&&(C<8||15<C)?m:(z.window!==null&&z.wbits!==C&&(z.window=null),z.wrap=y,z.wbits=C,Z(E))):m}function K(E,C){var y,z;return E?(z=new A,(E.state=z).window=null,(y=I(E,C))!==g&&(E.state=null),y):m}var V,S,k=!0;function O(E){if(k){var C;for(V=new s.Buf32(512),S=new s.Buf32(32),C=0;C<144;)E.lens[C++]=8;for(;C<256;)E.lens[C++]=9;for(;C<280;)E.lens[C++]=7;for(;C<288;)E.lens[C++]=8;for(f(d,E.lens,0,288,V,0,E.work,{bits:9}),C=0;C<32;)E.lens[C++]=5;f(p,E.lens,0,32,S,0,E.work,{bits:5}),k=!1}E.lencode=V,E.lenbits=9,E.distcode=S,E.distbits=5}function N(E,C,y,z){var H,G=E.state;return G.window===null&&(G.wsize=1<<G.wbits,G.wnext=0,G.whave=0,G.window=new s.Buf8(G.wsize)),z>=G.wsize?(s.arraySet(G.window,C,y-G.wsize,G.wsize,0),G.wnext=0,G.whave=G.wsize):(z<(H=G.wsize-G.wnext)&&(H=z),s.arraySet(G.window,C,y-z,H,G.wnext),(z-=H)?(s.arraySet(G.window,C,y-z,z,0),G.wnext=z,G.whave=G.wsize):(G.wnext+=H,G.wnext===G.wsize&&(G.wnext=0),G.whave<G.wsize&&(G.whave+=H))),0}i.inflateReset=Z,i.inflateReset2=I,i.inflateResetKeep=B,i.inflateInit=function(E){return K(E,15)},i.inflateInit2=K,i.inflate=function(E,C){var y,z,H,G,W,X,tt,q,Q,dt,ct,rt,mt,Et,St,Ot,bt,vt,ht,ft,M,et,j,U,F=0,J=new s.Buf8(4),at=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!E||!E.state||!E.output||!E.input&&E.avail_in!==0)return m;(y=E.state).mode===12&&(y.mode=13),W=E.next_out,H=E.output,tt=E.avail_out,G=E.next_in,z=E.input,X=E.avail_in,q=y.hold,Q=y.bits,dt=X,ct=tt,et=g;t:for(;;)switch(y.mode){case x:if(y.wrap===0){y.mode=13;break}for(;Q<16;){if(X===0)break t;X--,q+=z[G++]<<Q,Q+=8}if(2&y.wrap&&q===35615){J[y.check=0]=255&q,J[1]=q>>>8&255,y.check=l(y.check,J,2,0),Q=q=0,y.mode=2;break}if(y.flags=0,y.head&&(y.head.done=!1),!(1&y.wrap)||(((255&q)<<8)+(q>>8))%31){E.msg="incorrect header check",y.mode=30;break}if((15&q)!=8){E.msg="unknown compression method",y.mode=30;break}if(Q-=4,M=8+(15&(q>>>=4)),y.wbits===0)y.wbits=M;else if(M>y.wbits){E.msg="invalid window size",y.mode=30;break}y.dmax=1<<M,E.adler=y.check=1,y.mode=512&q?10:12,Q=q=0;break;case 2:for(;Q<16;){if(X===0)break t;X--,q+=z[G++]<<Q,Q+=8}if(y.flags=q,(255&y.flags)!=8){E.msg="unknown compression method",y.mode=30;break}if(57344&y.flags){E.msg="unknown header flags set",y.mode=30;break}y.head&&(y.head.text=q>>8&1),512&y.flags&&(J[0]=255&q,J[1]=q>>>8&255,y.check=l(y.check,J,2,0)),Q=q=0,y.mode=3;case 3:for(;Q<32;){if(X===0)break t;X--,q+=z[G++]<<Q,Q+=8}y.head&&(y.head.time=q),512&y.flags&&(J[0]=255&q,J[1]=q>>>8&255,J[2]=q>>>16&255,J[3]=q>>>24&255,y.check=l(y.check,J,4,0)),Q=q=0,y.mode=4;case 4:for(;Q<16;){if(X===0)break t;X--,q+=z[G++]<<Q,Q+=8}y.head&&(y.head.xflags=255&q,y.head.os=q>>8),512&y.flags&&(J[0]=255&q,J[1]=q>>>8&255,y.check=l(y.check,J,2,0)),Q=q=0,y.mode=5;case 5:if(1024&y.flags){for(;Q<16;){if(X===0)break t;X--,q+=z[G++]<<Q,Q+=8}y.length=q,y.head&&(y.head.extra_len=q),512&y.flags&&(J[0]=255&q,J[1]=q>>>8&255,y.check=l(y.check,J,2,0)),Q=q=0}else y.head&&(y.head.extra=null);y.mode=6;case 6:if(1024&y.flags&&(X<(rt=y.length)&&(rt=X),rt&&(y.head&&(M=y.head.extra_len-y.length,y.head.extra||(y.head.extra=new Array(y.head.extra_len)),s.arraySet(y.head.extra,z,G,rt,M)),512&y.flags&&(y.check=l(y.check,z,rt,G)),X-=rt,G+=rt,y.length-=rt),y.length))break t;y.length=0,y.mode=7;case 7:if(2048&y.flags){if(X===0)break t;for(rt=0;M=z[G+rt++],y.head&&M&&y.length<65536&&(y.head.name+=String.fromCharCode(M)),M&&rt<X;);if(512&y.flags&&(y.check=l(y.check,z,rt,G)),X-=rt,G+=rt,M)break t}else y.head&&(y.head.name=null);y.length=0,y.mode=8;case 8:if(4096&y.flags){if(X===0)break t;for(rt=0;M=z[G+rt++],y.head&&M&&y.length<65536&&(y.head.comment+=String.fromCharCode(M)),M&&rt<X;);if(512&y.flags&&(y.check=l(y.check,z,rt,G)),X-=rt,G+=rt,M)break t}else y.head&&(y.head.comment=null);y.mode=9;case 9:if(512&y.flags){for(;Q<16;){if(X===0)break t;X--,q+=z[G++]<<Q,Q+=8}if(q!==(65535&y.check)){E.msg="header crc mismatch",y.mode=30;break}Q=q=0}y.head&&(y.head.hcrc=y.flags>>9&1,y.head.done=!0),E.adler=y.check=0,y.mode=12;break;case 10:for(;Q<32;){if(X===0)break t;X--,q+=z[G++]<<Q,Q+=8}E.adler=y.check=P(q),Q=q=0,y.mode=11;case 11:if(y.havedict===0)return E.next_out=W,E.avail_out=tt,E.next_in=G,E.avail_in=X,y.hold=q,y.bits=Q,2;E.adler=y.check=1,y.mode=12;case 12:if(C===5||C===6)break t;case 13:if(y.last){q>>>=7&Q,Q-=7&Q,y.mode=27;break}for(;Q<3;){if(X===0)break t;X--,q+=z[G++]<<Q,Q+=8}switch(y.last=1&q,Q-=1,3&(q>>>=1)){case 0:y.mode=14;break;case 1:if(O(y),y.mode=20,C!==6)break;q>>>=2,Q-=2;break t;case 2:y.mode=17;break;case 3:E.msg="invalid block type",y.mode=30}q>>>=2,Q-=2;break;case 14:for(q>>>=7&Q,Q-=7&Q;Q<32;){if(X===0)break t;X--,q+=z[G++]<<Q,Q+=8}if((65535&q)!=(q>>>16^65535)){E.msg="invalid stored block lengths",y.mode=30;break}if(y.length=65535&q,Q=q=0,y.mode=15,C===6)break t;case 15:y.mode=16;case 16:if(rt=y.length){if(X<rt&&(rt=X),tt<rt&&(rt=tt),rt===0)break t;s.arraySet(H,z,G,rt,W),X-=rt,G+=rt,tt-=rt,W+=rt,y.length-=rt;break}y.mode=12;break;case 17:for(;Q<14;){if(X===0)break t;X--,q+=z[G++]<<Q,Q+=8}if(y.nlen=257+(31&q),q>>>=5,Q-=5,y.ndist=1+(31&q),q>>>=5,Q-=5,y.ncode=4+(15&q),q>>>=4,Q-=4,286<y.nlen||30<y.ndist){E.msg="too many length or distance symbols",y.mode=30;break}y.have=0,y.mode=18;case 18:for(;y.have<y.ncode;){for(;Q<3;){if(X===0)break t;X--,q+=z[G++]<<Q,Q+=8}y.lens[at[y.have++]]=7&q,q>>>=3,Q-=3}for(;y.have<19;)y.lens[at[y.have++]]=0;if(y.lencode=y.lendyn,y.lenbits=7,j={bits:y.lenbits},et=f(0,y.lens,0,19,y.lencode,0,y.work,j),y.lenbits=j.bits,et){E.msg="invalid code lengths set",y.mode=30;break}y.have=0,y.mode=19;case 19:for(;y.have<y.nlen+y.ndist;){for(;Ot=(F=y.lencode[q&(1<<y.lenbits)-1])>>>16&255,bt=65535&F,!((St=F>>>24)<=Q);){if(X===0)break t;X--,q+=z[G++]<<Q,Q+=8}if(bt<16)q>>>=St,Q-=St,y.lens[y.have++]=bt;else{if(bt===16){for(U=St+2;Q<U;){if(X===0)break t;X--,q+=z[G++]<<Q,Q+=8}if(q>>>=St,Q-=St,y.have===0){E.msg="invalid bit length repeat",y.mode=30;break}M=y.lens[y.have-1],rt=3+(3&q),q>>>=2,Q-=2}else if(bt===17){for(U=St+3;Q<U;){if(X===0)break t;X--,q+=z[G++]<<Q,Q+=8}Q-=St,M=0,rt=3+(7&(q>>>=St)),q>>>=3,Q-=3}else{for(U=St+7;Q<U;){if(X===0)break t;X--,q+=z[G++]<<Q,Q+=8}Q-=St,M=0,rt=11+(127&(q>>>=St)),q>>>=7,Q-=7}if(y.have+rt>y.nlen+y.ndist){E.msg="invalid bit length repeat",y.mode=30;break}for(;rt--;)y.lens[y.have++]=M}}if(y.mode===30)break;if(y.lens[256]===0){E.msg="invalid code -- missing end-of-block",y.mode=30;break}if(y.lenbits=9,j={bits:y.lenbits},et=f(d,y.lens,0,y.nlen,y.lencode,0,y.work,j),y.lenbits=j.bits,et){E.msg="invalid literal/lengths set",y.mode=30;break}if(y.distbits=6,y.distcode=y.distdyn,j={bits:y.distbits},et=f(p,y.lens,y.nlen,y.ndist,y.distcode,0,y.work,j),y.distbits=j.bits,et){E.msg="invalid distances set",y.mode=30;break}if(y.mode=20,C===6)break t;case 20:y.mode=21;case 21:if(6<=X&&258<=tt){E.next_out=W,E.avail_out=tt,E.next_in=G,E.avail_in=X,y.hold=q,y.bits=Q,u(E,ct),W=E.next_out,H=E.output,tt=E.avail_out,G=E.next_in,z=E.input,X=E.avail_in,q=y.hold,Q=y.bits,y.mode===12&&(y.back=-1);break}for(y.back=0;Ot=(F=y.lencode[q&(1<<y.lenbits)-1])>>>16&255,bt=65535&F,!((St=F>>>24)<=Q);){if(X===0)break t;X--,q+=z[G++]<<Q,Q+=8}if(Ot&&!(240&Ot)){for(vt=St,ht=Ot,ft=bt;Ot=(F=y.lencode[ft+((q&(1<<vt+ht)-1)>>vt)])>>>16&255,bt=65535&F,!(vt+(St=F>>>24)<=Q);){if(X===0)break t;X--,q+=z[G++]<<Q,Q+=8}q>>>=vt,Q-=vt,y.back+=vt}if(q>>>=St,Q-=St,y.back+=St,y.length=bt,Ot===0){y.mode=26;break}if(32&Ot){y.back=-1,y.mode=12;break}if(64&Ot){E.msg="invalid literal/length code",y.mode=30;break}y.extra=15&Ot,y.mode=22;case 22:if(y.extra){for(U=y.extra;Q<U;){if(X===0)break t;X--,q+=z[G++]<<Q,Q+=8}y.length+=q&(1<<y.extra)-1,q>>>=y.extra,Q-=y.extra,y.back+=y.extra}y.was=y.length,y.mode=23;case 23:for(;Ot=(F=y.distcode[q&(1<<y.distbits)-1])>>>16&255,bt=65535&F,!((St=F>>>24)<=Q);){if(X===0)break t;X--,q+=z[G++]<<Q,Q+=8}if(!(240&Ot)){for(vt=St,ht=Ot,ft=bt;Ot=(F=y.distcode[ft+((q&(1<<vt+ht)-1)>>vt)])>>>16&255,bt=65535&F,!(vt+(St=F>>>24)<=Q);){if(X===0)break t;X--,q+=z[G++]<<Q,Q+=8}q>>>=vt,Q-=vt,y.back+=vt}if(q>>>=St,Q-=St,y.back+=St,64&Ot){E.msg="invalid distance code",y.mode=30;break}y.offset=bt,y.extra=15&Ot,y.mode=24;case 24:if(y.extra){for(U=y.extra;Q<U;){if(X===0)break t;X--,q+=z[G++]<<Q,Q+=8}y.offset+=q&(1<<y.extra)-1,q>>>=y.extra,Q-=y.extra,y.back+=y.extra}if(y.offset>y.dmax){E.msg="invalid distance too far back",y.mode=30;break}y.mode=25;case 25:if(tt===0)break t;if(rt=ct-tt,y.offset>rt){if((rt=y.offset-rt)>y.whave&&y.sane){E.msg="invalid distance too far back",y.mode=30;break}mt=rt>y.wnext?(rt-=y.wnext,y.wsize-rt):y.wnext-rt,rt>y.length&&(rt=y.length),Et=y.window}else Et=H,mt=W-y.offset,rt=y.length;for(tt<rt&&(rt=tt),tt-=rt,y.length-=rt;H[W++]=Et[mt++],--rt;);y.length===0&&(y.mode=21);break;case 26:if(tt===0)break t;H[W++]=y.length,tt--,y.mode=21;break;case 27:if(y.wrap){for(;Q<32;){if(X===0)break t;X--,q|=z[G++]<<Q,Q+=8}if(ct-=tt,E.total_out+=ct,y.total+=ct,ct&&(E.adler=y.check=y.flags?l(y.check,H,ct,W-ct):o(y.check,H,ct,W-ct)),ct=tt,(y.flags?q:P(q))!==y.check){E.msg="incorrect data check",y.mode=30;break}Q=q=0}y.mode=28;case 28:if(y.wrap&&y.flags){for(;Q<32;){if(X===0)break t;X--,q+=z[G++]<<Q,Q+=8}if(q!==(4294967295&y.total)){E.msg="incorrect length check",y.mode=30;break}Q=q=0}y.mode=29;case 29:et=1;break t;case 30:et=-3;break t;case 31:return-4;case 32:default:return m}return E.next_out=W,E.avail_out=tt,E.next_in=G,E.avail_in=X,y.hold=q,y.bits=Q,(y.wsize||ct!==E.avail_out&&y.mode<30&&(y.mode<27||C!==4))&&N(E,E.output,E.next_out,ct-E.avail_out)?(y.mode=31,-4):(dt-=E.avail_in,ct-=E.avail_out,E.total_in+=dt,E.total_out+=ct,y.total+=ct,y.wrap&&ct&&(E.adler=y.check=y.flags?l(y.check,H,ct,E.next_out-ct):o(y.check,H,ct,E.next_out-ct)),E.data_type=y.bits+(y.last?64:0)+(y.mode===12?128:0)+(y.mode===20||y.mode===15?256:0),(dt==0&&ct===0||C===4)&&et===g&&(et=-5),et)},i.inflateEnd=function(E){if(!E||!E.state)return m;var C=E.state;return C.window&&(C.window=null),E.state=null,g},i.inflateGetHeader=function(E,C){var y;return E&&E.state&&2&(y=E.state).wrap?((y.head=C).done=!1,g):m},i.inflateSetDictionary=function(E,C){var y,z=C.length;return E&&E.state?(y=E.state).wrap!==0&&y.mode!==11?m:y.mode===11&&o(1,C,z,0)!==y.check?-3:N(E,C,z,z)?(y.mode=31,-4):(y.havedict=1,g):m},i.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(e,r,i){var s=e("../utils/common"),o=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],l=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],u=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],f=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];r.exports=function(d,p,g,m,x,v,b,P){var A,B,Z,I,K,V,S,k,O,N=P.bits,E=0,C=0,y=0,z=0,H=0,G=0,W=0,X=0,tt=0,q=0,Q=null,dt=0,ct=new s.Buf16(16),rt=new s.Buf16(16),mt=null,Et=0;for(E=0;E<=15;E++)ct[E]=0;for(C=0;C<m;C++)ct[p[g+C]]++;for(H=N,z=15;1<=z&&ct[z]===0;z--);if(z<H&&(H=z),z===0)return x[v++]=20971520,x[v++]=20971520,P.bits=1,0;for(y=1;y<z&&ct[y]===0;y++);for(H<y&&(H=y),E=X=1;E<=15;E++)if(X<<=1,(X-=ct[E])<0)return-1;if(0<X&&(d===0||z!==1))return-1;for(rt[1]=0,E=1;E<15;E++)rt[E+1]=rt[E]+ct[E];for(C=0;C<m;C++)p[g+C]!==0&&(b[rt[p[g+C]]++]=C);if(V=d===0?(Q=mt=b,19):d===1?(Q=o,dt-=257,mt=l,Et-=257,256):(Q=u,mt=f,-1),E=y,K=v,W=C=q=0,Z=-1,I=(tt=1<<(G=H))-1,d===1&&852<tt||d===2&&592<tt)return 1;for(;;){for(S=E-W,O=b[C]<V?(k=0,b[C]):b[C]>V?(k=mt[Et+b[C]],Q[dt+b[C]]):(k=96,0),A=1<<E-W,y=B=1<<G;x[K+(q>>W)+(B-=A)]=S<<24|k<<16|O|0,B!==0;);for(A=1<<E-1;q&A;)A>>=1;if(A!==0?(q&=A-1,q+=A):q=0,C++,--ct[E]==0){if(E===z)break;E=p[g+b[C]]}if(H<E&&(q&I)!==Z){for(W===0&&(W=H),K+=y,X=1<<(G=E-W);G+W<z&&!((X-=ct[G+W])<=0);)G++,X<<=1;if(tt+=1<<G,d===1&&852<tt||d===2&&592<tt)return 1;x[Z=q&I]=H<<24|G<<16|K-v|0}}return q!==0&&(x[K+q]=E-W<<24|64<<16|0),P.bits=H,0}},{"../utils/common":41}],51:[function(e,r,i){r.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(e,r,i){var s=e("../utils/common"),o=0,l=1;function u(F){for(var J=F.length;0<=--J;)F[J]=0}var f=0,d=29,p=256,g=p+1+d,m=30,x=19,v=2*g+1,b=15,P=16,A=7,B=256,Z=16,I=17,K=18,V=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],S=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],k=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],O=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],N=new Array(2*(g+2));u(N);var E=new Array(2*m);u(E);var C=new Array(512);u(C);var y=new Array(256);u(y);var z=new Array(d);u(z);var H,G,W,X=new Array(m);function tt(F,J,at,lt,it){this.static_tree=F,this.extra_bits=J,this.extra_base=at,this.elems=lt,this.max_length=it,this.has_stree=F&&F.length}function q(F,J){this.dyn_tree=F,this.max_code=0,this.stat_desc=J}function Q(F){return F<256?C[F]:C[256+(F>>>7)]}function dt(F,J){F.pending_buf[F.pending++]=255&J,F.pending_buf[F.pending++]=J>>>8&255}function ct(F,J,at){F.bi_valid>P-at?(F.bi_buf|=J<<F.bi_valid&65535,dt(F,F.bi_buf),F.bi_buf=J>>P-F.bi_valid,F.bi_valid+=at-P):(F.bi_buf|=J<<F.bi_valid&65535,F.bi_valid+=at)}function rt(F,J,at){ct(F,at[2*J],at[2*J+1])}function mt(F,J){for(var at=0;at|=1&F,F>>>=1,at<<=1,0<--J;);return at>>>1}function Et(F,J,at){var lt,it,_t=new Array(b+1),xt=0;for(lt=1;lt<=b;lt++)_t[lt]=xt=xt+at[lt-1]<<1;for(it=0;it<=J;it++){var gt=F[2*it+1];gt!==0&&(F[2*it]=mt(_t[gt]++,gt))}}function St(F){var J;for(J=0;J<g;J++)F.dyn_ltree[2*J]=0;for(J=0;J<m;J++)F.dyn_dtree[2*J]=0;for(J=0;J<x;J++)F.bl_tree[2*J]=0;F.dyn_ltree[2*B]=1,F.opt_len=F.static_len=0,F.last_lit=F.matches=0}function Ot(F){8<F.bi_valid?dt(F,F.bi_buf):0<F.bi_valid&&(F.pending_buf[F.pending++]=F.bi_buf),F.bi_buf=0,F.bi_valid=0}function bt(F,J,at,lt){var it=2*J,_t=2*at;return F[it]<F[_t]||F[it]===F[_t]&&lt[J]<=lt[at]}function vt(F,J,at){for(var lt=F.heap[at],it=at<<1;it<=F.heap_len&&(it<F.heap_len&&bt(J,F.heap[it+1],F.heap[it],F.depth)&&it++,!bt(J,lt,F.heap[it],F.depth));)F.heap[at]=F.heap[it],at=it,it<<=1;F.heap[at]=lt}function ht(F,J,at){var lt,it,_t,xt,gt=0;if(F.last_lit!==0)for(;lt=F.pending_buf[F.d_buf+2*gt]<<8|F.pending_buf[F.d_buf+2*gt+1],it=F.pending_buf[F.l_buf+gt],gt++,lt===0?rt(F,it,J):(rt(F,(_t=y[it])+p+1,J),(xt=V[_t])!==0&&ct(F,it-=z[_t],xt),rt(F,_t=Q(--lt),at),(xt=S[_t])!==0&&ct(F,lt-=X[_t],xt)),gt<F.last_lit;);rt(F,B,J)}function ft(F,J){var at,lt,it,_t=J.dyn_tree,xt=J.stat_desc.static_tree,gt=J.stat_desc.has_stree,Tt=J.stat_desc.elems,Wt=-1;for(F.heap_len=0,F.heap_max=v,at=0;at<Tt;at++)_t[2*at]!==0?(F.heap[++F.heap_len]=Wt=at,F.depth[at]=0):_t[2*at+1]=0;for(;F.heap_len<2;)_t[2*(it=F.heap[++F.heap_len]=Wt<2?++Wt:0)]=1,F.depth[it]=0,F.opt_len--,gt&&(F.static_len-=xt[2*it+1]);for(J.max_code=Wt,at=F.heap_len>>1;1<=at;at--)vt(F,_t,at);for(it=Tt;at=F.heap[1],F.heap[1]=F.heap[F.heap_len--],vt(F,_t,1),lt=F.heap[1],F.heap[--F.heap_max]=at,F.heap[--F.heap_max]=lt,_t[2*it]=_t[2*at]+_t[2*lt],F.depth[it]=(F.depth[at]>=F.depth[lt]?F.depth[at]:F.depth[lt])+1,_t[2*at+1]=_t[2*lt+1]=it,F.heap[1]=it++,vt(F,_t,1),2<=F.heap_len;);F.heap[--F.heap_max]=F.heap[1],function(kt,$t){var ce,se,ye,Jt,ve,oe,xe=$t.dyn_tree,Fe=$t.max_code,ii=$t.stat_desc.static_tree,ni=$t.stat_desc.has_stree,yi=$t.stat_desc.extra_bits,je=$t.stat_desc.extra_base,ie=$t.stat_desc.max_length,Ii=0;for(Jt=0;Jt<=b;Jt++)kt.bl_count[Jt]=0;for(xe[2*kt.heap[kt.heap_max]+1]=0,ce=kt.heap_max+1;ce<v;ce++)ie<(Jt=xe[2*xe[2*(se=kt.heap[ce])+1]+1]+1)&&(Jt=ie,Ii++),xe[2*se+1]=Jt,Fe<se||(kt.bl_count[Jt]++,ve=0,je<=se&&(ve=yi[se-je]),oe=xe[2*se],kt.opt_len+=oe*(Jt+ve),ni&&(kt.static_len+=oe*(ii[2*se+1]+ve)));if(Ii!==0){do{for(Jt=ie-1;kt.bl_count[Jt]===0;)Jt--;kt.bl_count[Jt]--,kt.bl_count[Jt+1]+=2,kt.bl_count[ie]--,Ii-=2}while(0<Ii);for(Jt=ie;Jt!==0;Jt--)for(se=kt.bl_count[Jt];se!==0;)Fe<(ye=kt.heap[--ce])||(xe[2*ye+1]!==Jt&&(kt.opt_len+=(Jt-xe[2*ye+1])*xe[2*ye],xe[2*ye+1]=Jt),se--)}}(F,J),Et(_t,Wt,F.bl_count)}function M(F,J,at){var lt,it,_t=-1,xt=J[1],gt=0,Tt=7,Wt=4;for(xt===0&&(Tt=138,Wt=3),J[2*(at+1)+1]=65535,lt=0;lt<=at;lt++)it=xt,xt=J[2*(lt+1)+1],++gt<Tt&&it===xt||(gt<Wt?F.bl_tree[2*it]+=gt:it!==0?(it!==_t&&F.bl_tree[2*it]++,F.bl_tree[2*Z]++):gt<=10?F.bl_tree[2*I]++:F.bl_tree[2*K]++,_t=it,Wt=(gt=0)===xt?(Tt=138,3):it===xt?(Tt=6,3):(Tt=7,4))}function et(F,J,at){var lt,it,_t=-1,xt=J[1],gt=0,Tt=7,Wt=4;for(xt===0&&(Tt=138,Wt=3),lt=0;lt<=at;lt++)if(it=xt,xt=J[2*(lt+1)+1],!(++gt<Tt&&it===xt)){if(gt<Wt)for(;rt(F,it,F.bl_tree),--gt!=0;);else it!==0?(it!==_t&&(rt(F,it,F.bl_tree),gt--),rt(F,Z,F.bl_tree),ct(F,gt-3,2)):gt<=10?(rt(F,I,F.bl_tree),ct(F,gt-3,3)):(rt(F,K,F.bl_tree),ct(F,gt-11,7));_t=it,Wt=(gt=0)===xt?(Tt=138,3):it===xt?(Tt=6,3):(Tt=7,4)}}u(X);var j=!1;function U(F,J,at,lt){ct(F,(f<<1)+(lt?1:0),3),function(it,_t,xt,gt){Ot(it),dt(it,xt),dt(it,~xt),s.arraySet(it.pending_buf,it.window,_t,xt,it.pending),it.pending+=xt}(F,J,at)}i._tr_init=function(F){j||(function(){var J,at,lt,it,_t,xt=new Array(b+1);for(it=lt=0;it<d-1;it++)for(z[it]=lt,J=0;J<1<<V[it];J++)y[lt++]=it;for(y[lt-1]=it,it=_t=0;it<16;it++)for(X[it]=_t,J=0;J<1<<S[it];J++)C[_t++]=it;for(_t>>=7;it<m;it++)for(X[it]=_t<<7,J=0;J<1<<S[it]-7;J++)C[256+_t++]=it;for(at=0;at<=b;at++)xt[at]=0;for(J=0;J<=143;)N[2*J+1]=8,J++,xt[8]++;for(;J<=255;)N[2*J+1]=9,J++,xt[9]++;for(;J<=279;)N[2*J+1]=7,J++,xt[7]++;for(;J<=287;)N[2*J+1]=8,J++,xt[8]++;for(Et(N,g+1,xt),J=0;J<m;J++)E[2*J+1]=5,E[2*J]=mt(J,5);H=new tt(N,V,p+1,g,b),G=new tt(E,S,0,m,b),W=new tt(new Array(0),k,0,x,A)}(),j=!0),F.l_desc=new q(F.dyn_ltree,H),F.d_desc=new q(F.dyn_dtree,G),F.bl_desc=new q(F.bl_tree,W),F.bi_buf=0,F.bi_valid=0,St(F)},i._tr_stored_block=U,i._tr_flush_block=function(F,J,at,lt){var it,_t,xt=0;0<F.level?(F.strm.data_type===2&&(F.strm.data_type=function(gt){var Tt,Wt=4093624447;for(Tt=0;Tt<=31;Tt++,Wt>>>=1)if(1&Wt&&gt.dyn_ltree[2*Tt]!==0)return o;if(gt.dyn_ltree[18]!==0||gt.dyn_ltree[20]!==0||gt.dyn_ltree[26]!==0)return l;for(Tt=32;Tt<p;Tt++)if(gt.dyn_ltree[2*Tt]!==0)return l;return o}(F)),ft(F,F.l_desc),ft(F,F.d_desc),xt=function(gt){var Tt;for(M(gt,gt.dyn_ltree,gt.l_desc.max_code),M(gt,gt.dyn_dtree,gt.d_desc.max_code),ft(gt,gt.bl_desc),Tt=x-1;3<=Tt&&gt.bl_tree[2*O[Tt]+1]===0;Tt--);return gt.opt_len+=3*(Tt+1)+5+5+4,Tt}(F),it=F.opt_len+3+7>>>3,(_t=F.static_len+3+7>>>3)<=it&&(it=_t)):it=_t=at+5,at+4<=it&&J!==-1?U(F,J,at,lt):F.strategy===4||_t===it?(ct(F,2+(lt?1:0),3),ht(F,N,E)):(ct(F,4+(lt?1:0),3),function(gt,Tt,Wt,kt){var $t;for(ct(gt,Tt-257,5),ct(gt,Wt-1,5),ct(gt,kt-4,4),$t=0;$t<kt;$t++)ct(gt,gt.bl_tree[2*O[$t]+1],3);et(gt,gt.dyn_ltree,Tt-1),et(gt,gt.dyn_dtree,Wt-1)}(F,F.l_desc.max_code+1,F.d_desc.max_code+1,xt+1),ht(F,F.dyn_ltree,F.dyn_dtree)),St(F),lt&&Ot(F)},i._tr_tally=function(F,J,at){return F.pending_buf[F.d_buf+2*F.last_lit]=J>>>8&255,F.pending_buf[F.d_buf+2*F.last_lit+1]=255&J,F.pending_buf[F.l_buf+F.last_lit]=255&at,F.last_lit++,J===0?F.dyn_ltree[2*at]++:(F.matches++,J--,F.dyn_ltree[2*(y[at]+p+1)]++,F.dyn_dtree[2*Q(J)]++),F.last_lit===F.lit_bufsize-1},i._tr_align=function(F){ct(F,2,3),rt(F,B,N),function(J){J.bi_valid===16?(dt(J,J.bi_buf),J.bi_buf=0,J.bi_valid=0):8<=J.bi_valid&&(J.pending_buf[J.pending++]=255&J.bi_buf,J.bi_buf>>=8,J.bi_valid-=8)}(F)}},{"../utils/common":41}],53:[function(e,r,i){r.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(e,r,i){(function(s){(function(o,l){if(!o.setImmediate){var u,f,d,p,g=1,m={},x=!1,v=o.document,b=Object.getPrototypeOf&&Object.getPrototypeOf(o);b=b&&b.setTimeout?b:o,u={}.toString.call(o.process)==="[object process]"?function(Z){process.nextTick(function(){A(Z)})}:function(){if(o.postMessage&&!o.importScripts){var Z=!0,I=o.onmessage;return o.onmessage=function(){Z=!1},o.postMessage("","*"),o.onmessage=I,Z}}()?(p="setImmediate$"+Math.random()+"$",o.addEventListener?o.addEventListener("message",B,!1):o.attachEvent("onmessage",B),function(Z){o.postMessage(p+Z,"*")}):o.MessageChannel?((d=new MessageChannel).port1.onmessage=function(Z){A(Z.data)},function(Z){d.port2.postMessage(Z)}):v&&"onreadystatechange"in v.createElement("script")?(f=v.documentElement,function(Z){var I=v.createElement("script");I.onreadystatechange=function(){A(Z),I.onreadystatechange=null,f.removeChild(I),I=null},f.appendChild(I)}):function(Z){setTimeout(A,0,Z)},b.setImmediate=function(Z){typeof Z!="function"&&(Z=new Function(""+Z));for(var I=new Array(arguments.length-1),K=0;K<I.length;K++)I[K]=arguments[K+1];var V={callback:Z,args:I};return m[g]=V,u(g),g++},b.clearImmediate=P}function P(Z){delete m[Z]}function A(Z){if(x)setTimeout(A,0,Z);else{var I=m[Z];if(I){x=!0;try{(function(K){var V=K.callback,S=K.args;switch(S.length){case 0:V();break;case 1:V(S[0]);break;case 2:V(S[0],S[1]);break;case 3:V(S[0],S[1],S[2]);break;default:V.apply(l,S)}})(I)}finally{P(Z),x=!1}}}}function B(Z){Z.source===o&&typeof Z.data=="string"&&Z.data.indexOf(p)===0&&A(+Z.data.slice(p.length))}})(typeof self>"u"?s===void 0?this:s:self)}).call(this,typeof An<"u"?An:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})}(sh)),sh.exports}var op=sp();const ap=gl(op);var Bs={exports:{}};/**
 * @license
 * lodash (Custom Build) <https://lodash.com/>
 * Build: `lodash exports="node" include="clone,merge,isEmpty,isArray,compact,each" -d`
 * Copyright jQuery Foundation and other contributors <https://jquery.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */var hp=Bs.exports,iu;function lp(){return iu||(iu=1,function(h,t){(function(){var e,r="4.15.0",i=200,s="Expected a function",o="__lodash_hash_undefined__",l=1,u=2,f=9007199254740991,d="[object Arguments]",p="[object Array]",g="[object Boolean]",m="[object Date]",x="[object Error]",v="[object Function]",b="[object GeneratorFunction]",P="[object Map]",A="[object Number]",B="[object Object]",Z="[object Promise]",I="[object RegExp]",K="[object Set]",V="[object String]",S="[object Symbol]",k="[object WeakMap]",O="[object ArrayBuffer]",N="[object DataView]",E="[object Float32Array]",C="[object Float64Array]",y="[object Int8Array]",z="[object Int16Array]",H="[object Int32Array]",G="[object Uint8Array]",W="[object Uint8ClampedArray]",X="[object Uint16Array]",tt="[object Uint32Array]",q=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Q=/^\w*$/,dt=/^\./,ct=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,rt=/[\\^$.*+?()[\]{}|]/g,mt=/\\(\\)?/g,Et=/\w*$/,St=/^\[object .+?Constructor\]$/,Ot=/^(?:0|[1-9]\d*)$/,bt={};bt[E]=bt[C]=bt[y]=bt[z]=bt[H]=bt[G]=bt[W]=bt[X]=bt[tt]=!0,bt[d]=bt[p]=bt[O]=bt[g]=bt[N]=bt[m]=bt[x]=bt[v]=bt[P]=bt[A]=bt[B]=bt[I]=bt[K]=bt[V]=bt[k]=!1;var vt={};vt[d]=vt[p]=vt[O]=vt[N]=vt[g]=vt[m]=vt[E]=vt[C]=vt[y]=vt[z]=vt[H]=vt[P]=vt[A]=vt[B]=vt[I]=vt[K]=vt[V]=vt[S]=vt[G]=vt[W]=vt[X]=vt[tt]=!0,vt[x]=vt[v]=vt[k]=!1;var ht=typeof An=="object"&&An&&An.Object===Object&&An,ft=typeof self=="object"&&self&&self.Object===Object&&self,M=ht||ft||Function("return this")(),et=t&&!t.nodeType&&t,j=et&&!0&&h&&!h.nodeType&&h,U=j&&j.exports===et,F=U&&ht.process,J=function(){try{return F&&F.binding("util")}catch{}}(),at=J&&J.isTypedArray;function lt(w,D){return w.set(D[0],D[1]),w}function it(w,D){return w.add(D),w}function _t(w,D,Y){switch(Y.length){case 0:return w.call(D);case 1:return w.call(D,Y[0]);case 2:return w.call(D,Y[0],Y[1]);case 3:return w.call(D,Y[0],Y[1],Y[2])}return w.apply(D,Y)}function xt(w,D){for(var Y=-1,ot=w?w.length:0;++Y<ot&&D(w[Y],Y,w)!==!1;);return w}function gt(w,D){for(var Y=-1,ot=D.length,wt=w.length;++Y<ot;)w[wt+Y]=D[Y];return w}function Tt(w,D,Y,ot){for(var wt=-1,yt=w?w.length:0;++wt<yt;)Y=D(Y,w[wt],wt,w);return Y}function Wt(w,D){for(var Y=-1,ot=w?w.length:0;++Y<ot;)if(D(w[Y],Y,w))return!0;return!1}function kt(w){return function(D){return D==null?e:D[w]}}function $t(w,D){for(var Y=-1,ot=Array(w);++Y<w;)ot[Y]=D(Y);return ot}function ce(w){return function(D){return w(D)}}function se(w,D){return w==null?e:w[D]}function ye(w){var D=!1;if(w!=null&&typeof w.toString!="function")try{D=!!(w+"")}catch{}return D}function Jt(w){var D=-1,Y=Array(w.size);return w.forEach(function(ot,wt){Y[++D]=[wt,ot]}),Y}function ve(w,D){return function(Y){return w(D(Y))}}function oe(w){var D=-1,Y=Array(w.size);return w.forEach(function(ot){Y[++D]=ot}),Y}var xe=Array.prototype,Fe=Function.prototype,ii=Object.prototype,ni=M["__core-js_shared__"],yi=function(){var w=/[^.]+$/.exec(ni&&ni.keys&&ni.keys.IE_PROTO||"");return w?"Symbol(src)_1."+w:""}(),je=Fe.toString,ie=ii.hasOwnProperty,Ii=je.call(Object),ri=ii.toString,ss=RegExp("^"+je.call(ie).replace(rt,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),ro=U?M.Buffer:e,so=M.Symbol,cr=M.Uint8Array,fr=ve(Object.getPrototypeOf,Object),Za=Object.create,oo=ii.propertyIsEnumerable,Ga=xe.splice,ao=Object.getOwnPropertySymbols,si=ro?ro.isBuffer:e,At=ve(Object.keys,Object),os=Math.max,dr=Xi(M,"DataView"),fn=Xi(M,"Map"),pr=Xi(M,"Promise"),Nn=Xi(M,"Set"),mr=Xi(M,"WeakMap"),oi=Xi(Object,"create"),ho=!oo.call({valueOf:1},"valueOf"),Ha=$i(dr),Wa=$i(fn),Va=$i(pr),qa=$i(Nn),lo=$i(mr),_r=so?so.prototype:e,Oi=_r?_r.valueOf:e,uo=_r?_r.toString:e;function Zt(){}function Vi(w){var D=-1,Y=w?w.length:0;for(this.clear();++D<Y;){var ot=w[D];this.set(ot[0],ot[1])}}function Ya(){this.__data__=oi?oi(null):{}}function ja(w){return this.has(w)&&delete this.__data__[w]}function as(w){var D=this.__data__;if(oi){var Y=D[w];return Y===o?e:Y}return ie.call(D,w)?D[w]:e}function Fn(w){var D=this.__data__;return oi?D[w]!==e:ie.call(D,w)}function co(w,D){var Y=this.__data__;return Y[w]=oi&&D===e?o:D,this}Vi.prototype.clear=Ya,Vi.prototype.delete=ja,Vi.prototype.get=as,Vi.prototype.has=Fn,Vi.prototype.set=co;function ai(w){var D=-1,Y=w?w.length:0;for(this.clear();++D<Y;){var ot=w[D];this.set(ot[0],ot[1])}}function Un(){this.__data__=[]}function jt(w){var D=this.__data__,Y=Yi(D,w);if(Y<0)return!1;var ot=D.length-1;return Y==ot?D.pop():Ga.call(D,Y,1),!0}function re(w){var D=this.__data__,Y=Yi(D,w);return Y<0?e:D[Y][1]}function gr(w){return Yi(this.__data__,w)>-1}function dn(w,D){var Y=this.__data__,ot=Yi(Y,w);return ot<0?Y.push([w,D]):Y[ot][1]=D,this}ai.prototype.clear=Un,ai.prototype.delete=jt,ai.prototype.get=re,ai.prototype.has=gr,ai.prototype.set=dn;function Ae(w){var D=-1,Y=w?w.length:0;for(this.clear();++D<Y;){var ot=w[D];this.set(ot[0],ot[1])}}function hs(){this.__data__={hash:new Vi,map:new(fn||ai),string:new Vi}}function Ft(w){return br(this,w).delete(w)}function ae(w){return br(this,w).get(w)}function ls(w){return br(this,w).has(w)}function yr(w,D){return br(this,w).set(w,D),this}Ae.prototype.clear=hs,Ae.prototype.delete=Ft,Ae.prototype.get=ae,Ae.prototype.has=ls,Ae.prototype.set=yr;function Se(w){var D=-1,Y=w?w.length:0;for(this.__data__=new Ae;++D<Y;)this.add(w[D])}function Xa(w){return this.__data__.set(w,o),this}function vr(w){return this.__data__.has(w)}Se.prototype.add=Se.prototype.push=Xa,Se.prototype.has=vr;function we(w){this.__data__=new ai(w)}function ue(){this.__data__=new ai}function qi(w){return this.__data__.delete(w)}function Zn(w){return this.__data__.get(w)}function Gn(w){return this.__data__.has(w)}function us(w,D){var Y=this.__data__;if(Y instanceof ai){var ot=Y.__data__;if(!fn||ot.length<i-1)return ot.push([w,D]),this;Y=this.__data__=new Ae(ot)}return Y.set(w,D),this}we.prototype.clear=ue,we.prototype.delete=qi,we.prototype.get=Zn,we.prototype.has=Gn,we.prototype.set=us;function pn(w,D){var Y=ke(w)||Ce(w)?$t(w.length,String):[],ot=Y.length,wt=!!ot;for(var yt in w)(D||ie.call(w,yt))&&!(wt&&(yt=="length"||_n(yt,ot)))&&Y.push(yt);return Y}function Hn(w,D,Y){(Y!==e&&!yn(w[D],Y)||typeof D=="number"&&Y===e&&!(D in w))&&(w[D]=Y)}function xr(w,D,Y){var ot=w[D];(!(ie.call(w,D)&&yn(ot,Y))||Y===e&&!(D in w))&&(w[D]=Y)}function Yi(w,D){for(var Y=w.length;Y--;)if(yn(w[Y][0],D))return Y;return-1}function cs(w,D){return w&&ys(D,Me(D),w)}function Ri(w,D,Y,ot,wt,yt,Lt){var Ct;if(ot&&(Ct=yt?ot(w,wt,yt,Lt):ot(w)),Ct!==e)return Ct;if(!pe(w))return w;var Dt=ke(w);if(Dt){if(Ct=nh(w),!D)return bo(w,Ct)}else{var Qt=ui(w),Ut=Qt==v||Qt==b;if(Ki(w))return Ka(w,D);if(Qt==B||Qt==d||Ut&&!yt){if(ye(w))return yt?w:{};if(Ct=So(Ut?{}:w),!D)return vs(w,cs(Ct,w))}else{if(!vt[Qt])return yt?w:{};Ct=ko(w,Qt,Ri,D)}}Lt||(Lt=new we);var te=Lt.get(w);if(te)return te;if(Lt.set(w,Ct),!Dt)var me=Y?Mo(w):Me(w);return xt(me||w,function(fe,Le){me&&(Le=fe,fe=w[Le]),xr(Ct,Le,Ri(fe,D,Y,ot,Le,w,Lt))}),Ct}function wr(w){return pe(w)?Za(w):{}}var fo=li(Ja),fs=ih();function Ja(w,D){return w&&fs(w,D,Me)}function Rt(w,D){D=Lr(D,w)?[D]:Vt(D);for(var Y=0,ot=D.length;w!=null&&Y<ot;)w=w[Mr(D[Y++])];return Y&&Y==ot?w:e}function hi(w,D,Y){var ot=D(w);return ke(w)?ot:gt(ot,Y(w))}function Kt(w){return ri.call(w)}function po(w,D){return w!=null&&D in Object(w)}function Wn(w,D,Y,ot,wt){return w===D?!0:w==null||D==null||!pe(w)&&!vi(D)?w!==w&&D!==D:ds(w,D,Wn,Y,ot,wt)}function ds(w,D,Y,ot,wt,yt){var Lt=ke(w),Ct=ke(D),Dt=p,Qt=p;Lt||(Dt=ui(w),Dt=Dt==d?B:Dt),Ct||(Qt=ui(D),Qt=Qt==d?B:Qt);var Ut=Dt==B&&!ye(w),te=Qt==B&&!ye(D),me=Dt==Qt;if(me&&!Ut)return yt||(yt=new we),Lt||Tr(w)?xs(w,D,Y,ot,wt,yt):Bi(w,D,Dt,Y,ot,wt,yt);if(!(wt&u)){var fe=Ut&&ie.call(w,"__wrapped__"),Le=te&&ie.call(D,"__wrapped__");if(fe||Le){var xi=fe?w.value():w,wi=Le?D.value():D;return yt||(yt=new we),Y(xi,wi,ot,wt,yt)}}return me?(yt||(yt=new we),Lo(w,D,Y,ot,wt,yt)):!1}function ps(w,D,Y,ot){var wt=Y.length,yt=wt;if(w==null)return!yt;for(w=Object(w);wt--;){var Lt=Y[wt];if(Lt[2]?Lt[1]!==w[Lt[0]]:!(Lt[0]in w))return!1}for(;++wt<yt;){Lt=Y[wt];var Ct=Lt[0],Dt=w[Ct],Qt=Lt[1];if(Lt[2]){if(Dt===e&&!(Ct in w))return!1}else{var Ut=new we,te;if(!(te===e?Wn(Qt,Dt,ot,l|u,Ut):te))return!1}}return!0}function ji(w){if(!pe(w)||Ue(w))return!1;var D=Qi(w)||ye(w)?ss:St;return D.test($i(w))}function ms(w){return vi(w)&&Er(w.length)&&!!bt[ri.call(w)]}function mn(w){return typeof w=="function"?w:w==null?Sr:typeof w=="object"?ke(w)?_o(w[0],w[1]):mo(w):kr(w)}function be(w){if(!Yn(w))return At(w);var D=[];for(var Y in Object(w))ie.call(w,Y)&&Y!="constructor"&&D.push(Y);return D}function Di(w){if(!pe(w))return Ms(w);var D=Yn(w),Y=[];for(var ot in w)ot=="constructor"&&(D||!ie.call(w,ot))||Y.push(ot);return Y}function mo(w){var D=Eo(w);return D.length==1&&D[0][2]?Ao(D[0][0],D[0][1]):function(Y){return Y===w||ps(Y,w,D)}}function _o(w,D){return Lr(w)&&Ls(D)?Ao(Mr(w),D):function(Y){var ot=tn(Y,w);return ot===e&&ot===D?Ro(Y,w):Wn(D,ot,e,l|u)}}function go(w,D,Y,ot,wt){if(w!==D){if(!(ke(D)||Tr(D)))var yt=Di(D);xt(yt||D,function(Lt,Ct){if(yt&&(Ct=Lt,Lt=D[Ct]),pe(Lt))wt||(wt=new we),yo(w,D,Ct,Y,go,ot,wt);else{var Dt=ot?ot(w[Ct],Lt,Ct+"",w,D,wt):e;Dt===e&&(Dt=Lt),Hn(w,Ct,Dt)}})}}function yo(w,D,Y,ot,wt,yt,Lt){var Ct=w[Y],Dt=D[Y],Qt=Lt.get(Dt);if(Qt){Hn(w,Y,Qt);return}var Ut=yt?yt(Ct,Dt,Y+"",w,D,Lt):e,te=Ut===e;te&&(Ut=Dt,ke(Dt)||Tr(Dt)?ke(Ct)?Ut=Ct:Ts(Ct)?Ut=bo(Ct):(te=!1,Ut=Ri(Dt,!0)):Io(Dt)||Ce(Dt)?Ce(Ct)?Ut=ci(Ct):!pe(Ct)||ot&&Qi(Ct)?(te=!1,Ut=Ri(Dt,!0)):Ut=Ct:te=!1),te&&(Lt.set(Dt,Ut),wt(Ut,Dt,ot,yt,Lt),Lt.delete(Dt)),Hn(w,Y,Ut)}function _s(w){return function(D){return Rt(D,w)}}function $a(w,D){return D=os(D===e?w.length-1:D,0),function(){for(var Y=arguments,ot=-1,wt=os(Y.length-D,0),yt=Array(wt);++ot<wt;)yt[ot]=Y[D+ot];ot=-1;for(var Lt=Array(D+1);++ot<D;)Lt[ot]=Y[ot];return Lt[D]=yt,_t(w,this,Lt)}}function vo(w){if(typeof w=="string")return w;if(vn(w))return uo?uo.call(w):"";var D=w+"";return D=="0"&&1/w==-1/0?"-0":D}function Vt(w){return ke(w)?w:Es(w)}function Ka(w,D){if(D)return w.slice();var Y=new w.constructor(w.length);return w.copy(Y),Y}function Re(w){var D=new w.constructor(w.byteLength);return new cr(D).set(new cr(w)),D}function Vn(w,D){var Y=D?Re(w.buffer):w.buffer;return new w.constructor(Y,w.byteOffset,w.byteLength)}function xo(w,D,Y){var ot=D?Y(Jt(w),!0):Jt(w);return Tt(ot,lt,new w.constructor)}function Qa(w){var D=new w.constructor(w.source,Et.exec(w));return D.lastIndex=w.lastIndex,D}function gs(w,D,Y){var ot=D?Y(oe(w),!0):oe(w);return Tt(ot,it,new w.constructor)}function th(w){return Oi?Object(Oi.call(w)):{}}function wo(w,D){var Y=D?Re(w.buffer):w.buffer;return new w.constructor(Y,w.byteOffset,w.length)}function bo(w,D){var Y=-1,ot=w.length;for(D||(D=Array(ot));++Y<ot;)D[Y]=w[Y];return D}function ys(w,D,Y,ot){Y||(Y={});for(var wt=-1,yt=D.length;++wt<yt;){var Lt=D[wt],Ct=e;xr(Y,Lt,Ct===e?w[Lt]:Ct)}return Y}function vs(w,D){return ys(w,To(w),D)}function eh(w){return $a(function(D,Y){var ot=-1,wt=Y.length,yt=wt>1?Y[wt-1]:e,Lt=wt>2?Y[2]:e;for(yt=w.length>3&&typeof yt=="function"?(wt--,yt):e,Lt&&Ji(Y[0],Y[1],Lt)&&(yt=wt<3?e:yt,wt=1),D=Object(D);++ot<wt;){var Ct=Y[ot];Ct&&w(D,Ct,ot,yt)}return D})}function li(w,D){return function(Y,ot){if(Y==null)return Y;if(!Ze(Y))return w(Y,ot);for(var wt=Y.length,yt=-1,Lt=Object(Y);++yt<wt&&ot(Lt[yt],yt,Lt)!==!1;);return Y}}function ih(w){return function(D,Y,ot){for(var wt=-1,yt=Object(D),Lt=ot(D),Ct=Lt.length;Ct--;){var Dt=Lt[++wt];if(Y(yt[Dt],Dt,yt)===!1)break}return D}}function xs(w,D,Y,ot,wt,yt){var Lt=wt&u,Ct=w.length,Dt=D.length;if(Ct!=Dt&&!(Lt&&Dt>Ct))return!1;var Qt=yt.get(w);if(Qt&&yt.get(D))return Qt==D;var Ut=-1,te=!0,me=wt&l?new Se:e;for(yt.set(w,D),yt.set(D,w);++Ut<Ct;){var fe=w[Ut],Le=D[Ut];if(ot)var xi=Lt?ot(Le,fe,Ut,D,w,yt):ot(fe,Le,Ut,w,D,yt);if(xi!==e){if(xi)continue;te=!1;break}if(me){if(!Wt(D,function(wi,Xe){if(!me.has(Xe)&&(fe===wi||Y(fe,wi,ot,wt,yt)))return me.add(Xe)})){te=!1;break}}else if(!(fe===Le||Y(fe,Le,ot,wt,yt))){te=!1;break}}return yt.delete(w),yt.delete(D),te}function Bi(w,D,Y,ot,wt,yt,Lt){switch(Y){case N:if(w.byteLength!=D.byteLength||w.byteOffset!=D.byteOffset)return!1;w=w.buffer,D=D.buffer;case O:return!(w.byteLength!=D.byteLength||!ot(new cr(w),new cr(D)));case g:case m:case A:return yn(+w,+D);case x:return w.name==D.name&&w.message==D.message;case I:case V:return w==D+"";case P:var Ct=Jt;case K:var Dt=yt&u;if(Ct||(Ct=oe),w.size!=D.size&&!Dt)return!1;var Qt=Lt.get(w);if(Qt)return Qt==D;yt|=l,Lt.set(w,D);var Ut=xs(Ct(w),Ct(D),ot,wt,yt,Lt);return Lt.delete(w),Ut;case S:if(Oi)return Oi.call(w)==Oi.call(D)}return!1}function Lo(w,D,Y,ot,wt,yt){var Lt=wt&u,Ct=Me(w),Dt=Ct.length,Qt=Me(D),Ut=Qt.length;if(Dt!=Ut&&!Lt)return!1;for(var te=Dt;te--;){var me=Ct[te];if(!(Lt?me in D:ie.call(D,me)))return!1}var fe=yt.get(w);if(fe&&yt.get(D))return fe==D;var Le=!0;yt.set(w,D),yt.set(D,w);for(var xi=Lt;++te<Dt;){me=Ct[te];var wi=w[me],Xe=D[me];if(ot)var Bo=Lt?ot(Xe,wi,me,D,w,yt):ot(wi,Xe,me,w,D,yt);if(!(Bo===e?wi===Xe||Y(wi,Xe,ot,wt,yt):Bo)){Le=!1;break}xi||(xi=me=="constructor")}if(Le&&!xi){var bi=w.constructor,Jn=D.constructor;bi!=Jn&&"constructor"in w&&"constructor"in D&&!(typeof bi=="function"&&bi instanceof bi&&typeof Jn=="function"&&Jn instanceof Jn)&&(Le=!1)}return yt.delete(w),yt.delete(D),Le}function Mo(w){return hi(w,Me,To)}function ws(){var w=Zt.iteratee||xn;return w=w===xn?mn:w,arguments.length?w(arguments[0],arguments[1]):w}function br(w,D){var Y=w.__data__;return qn(D)?Y[typeof D=="string"?"string":"hash"]:Y.map}function Eo(w){for(var D=Me(w),Y=D.length;Y--;){var ot=D[Y],wt=w[ot];D[Y]=[ot,wt,Ls(wt)]}return D}function Xi(w,D){var Y=se(w,D);return ji(Y)?Y:e}var To=ao?ve(ao,Object):Xn,ui=Kt;(dr&&ui(new dr(new ArrayBuffer(1)))!=N||fn&&ui(new fn)!=P||pr&&ui(pr.resolve())!=Z||Nn&&ui(new Nn)!=K||mr&&ui(new mr)!=k)&&(ui=function(w){var D=ri.call(w),Y=D==B?w.constructor:e,ot=Y?$i(Y):e;if(ot)switch(ot){case Ha:return N;case Wa:return P;case Va:return Z;case qa:return K;case lo:return k}return D});function bs(w,D,Y){D=Lr(D,w)?[D]:Vt(D);for(var ot,wt=-1,Lt=D.length;++wt<Lt;){var yt=Mr(D[wt]);if(!(ot=w!=null&&Y(w,yt)))break;w=w[yt]}if(ot)return ot;var Lt=w?w.length:0;return!!Lt&&Er(Lt)&&_n(yt,Lt)&&(ke(w)||Ce(w))}function nh(w){var D=w.length,Y=w.constructor(D);return D&&typeof w[0]=="string"&&ie.call(w,"index")&&(Y.index=w.index,Y.input=w.input),Y}function So(w){return typeof w.constructor=="function"&&!Yn(w)?wr(fr(w)):{}}function ko(w,D,Y,ot){var wt=w.constructor;switch(D){case O:return Re(w);case g:case m:return new wt(+w);case N:return Vn(w,ot);case E:case C:case y:case z:case H:case G:case W:case X:case tt:return wo(w,ot);case P:return xo(w,ot,Y);case A:case V:return new wt(w);case I:return Qa(w);case K:return gs(w,ot,Y);case S:return th(w)}}function _n(w,D){return D=D??f,!!D&&(typeof w=="number"||Ot.test(w))&&w>-1&&w%1==0&&w<D}function Ji(w,D,Y){if(!pe(Y))return!1;var ot=typeof D;return(ot=="number"?Ze(Y)&&_n(D,Y.length):ot=="string"&&D in Y)?yn(Y[D],w):!1}function Lr(w,D){if(ke(w))return!1;var Y=typeof w;return Y=="number"||Y=="symbol"||Y=="boolean"||w==null||vn(w)?!0:Q.test(w)||!q.test(w)||D!=null&&w in Object(D)}function qn(w){var D=typeof w;return D=="string"||D=="number"||D=="symbol"||D=="boolean"?w!=="__proto__":w===null}function Ue(w){return!!yi&&yi in w}function Yn(w){var D=w&&w.constructor,Y=typeof D=="function"&&D.prototype||ii;return w===Y}function Ls(w){return w===w&&!pe(w)}function Ao(w,D){return function(Y){return Y==null?!1:Y[w]===D&&(D!==e||w in Object(Y))}}function Ms(w){var D=[];if(w!=null)for(var Y in Object(w))D.push(Y);return D}var Es=Pe(function(w){w=Oo(w);var D=[];return dt.test(w)&&D.push(""),w.replace(ct,function(Y,ot,wt,yt){D.push(wt?yt.replace(mt,"$1"):ot||Y)}),D});function Mr(w){if(typeof w=="string"||vn(w))return w;var D=w+"";return D=="0"&&1/w==-1/0?"-0":D}function $i(w){if(w!=null){try{return je.call(w)}catch{}try{return w+""}catch{}}return""}function Po(w){for(var D=-1,Y=w?w.length:0,ot=0,wt=[];++D<Y;){var yt=w[D];yt&&(wt[ot++]=yt)}return wt}function Co(w,D){var Y=ke(w)?xt:fo;return Y(w,ws(D,3))}function Pe(w,D){if(typeof w!="function"||D&&typeof D!="function")throw new TypeError(s);var Y=function(){var ot=arguments,wt=D?D.apply(this,ot):ot[0],yt=Y.cache;if(yt.has(wt))return yt.get(wt);var Lt=w.apply(this,ot);return Y.cache=yt.set(wt,Lt),Lt};return Y.cache=new(Pe.Cache||Ae),Y}Pe.Cache=Ae;function gn(w){return Ri(w,!1,!0)}function yn(w,D){return w===D||w!==w&&D!==D}function Ce(w){return Ts(w)&&ie.call(w,"callee")&&(!oo.call(w,"callee")||ri.call(w)==d)}var ke=Array.isArray;function Ze(w){return w!=null&&Er(w.length)&&!Qi(w)}function Ts(w){return vi(w)&&Ze(w)}var Ki=si||en;function zo(w){if(Ze(w)&&(ke(w)||typeof w=="string"||typeof w.splice=="function"||Ki(w)||Ce(w)))return!w.length;var D=ui(w);if(D==P||D==K)return!w.size;if(ho||Yn(w))return!At(w).length;for(var Y in w)if(ie.call(w,Y))return!1;return!0}function Qi(w){var D=pe(w)?ri.call(w):"";return D==v||D==b}function Er(w){return typeof w=="number"&&w>-1&&w%1==0&&w<=f}function pe(w){var D=typeof w;return!!w&&(D=="object"||D=="function")}function vi(w){return!!w&&typeof w=="object"}function Io(w){if(!vi(w)||ri.call(w)!=B||ye(w))return!1;var D=fr(w);if(D===null)return!0;var Y=ie.call(D,"constructor")&&D.constructor;return typeof Y=="function"&&Y instanceof Y&&je.call(Y)==Ii}function vn(w){return typeof w=="symbol"||vi(w)&&ri.call(w)==S}var Tr=at?ce(at):ms;function ci(w){return ys(w,jn(w))}function Oo(w){return w==null?"":vo(w)}function tn(w,D,Y){var ot=w==null?e:Rt(w,D);return ot===e?Y:ot}function Ro(w,D){return w!=null&&bs(w,D,po)}function Me(w){return Ze(w)?pn(w):be(w)}function jn(w){return Ze(w)?pn(w,!0):Di(w)}var Do=eh(function(w,D,Y){go(w,D,Y)});function Sr(w){return w}function xn(w){return mn(typeof w=="function"?w:Ri(w,!0))}function kr(w){return Lr(w)?kt(Mr(w)):_s(w)}function Xn(){return[]}function en(){return!1}Zt.compact=Po,Zt.iteratee=xn,Zt.keys=Me,Zt.keysIn=jn,Zt.memoize=Pe,Zt.merge=Do,Zt.property=kr,Zt.toPlainObject=ci,Zt.clone=gn,Zt.eq=yn,Zt.forEach=Co,Zt.get=tn,Zt.hasIn=Ro,Zt.identity=Sr,Zt.isArguments=Ce,Zt.isArray=ke,Zt.isArrayLike=Ze,Zt.isArrayLikeObject=Ts,Zt.isBuffer=Ki,Zt.isEmpty=zo,Zt.isFunction=Qi,Zt.isLength=Er,Zt.isObject=pe,Zt.isObjectLike=vi,Zt.isPlainObject=Io,Zt.isSymbol=vn,Zt.isTypedArray=Tr,Zt.stubArray=Xn,Zt.stubFalse=en,Zt.toString=Oo,Zt.each=Co,Zt.VERSION=r,j&&((j.exports=Zt)._=Zt,et._=Zt)}).call(hp)}(Bs,Bs.exports)),Bs.exports}var oh,nu;function up(){if(nu)return oh;nu=1,oh=h;function h(r,i){var s=r&&r.type,o;if(s==="FeatureCollection")for(o=0;o<r.features.length;o++)h(r.features[o],i);else if(s==="GeometryCollection")for(o=0;o<r.geometries.length;o++)h(r.geometries[o],i);else if(s==="Feature")h(r.geometry,i);else if(s==="Polygon")t(r.coordinates,i);else if(s==="MultiPolygon")for(o=0;o<r.coordinates.length;o++)t(r.coordinates[o],i);return r}function t(r,i){if(r.length!==0){e(r[0],i);for(var s=1;s<r.length;s++)e(r[s],!i)}}function e(r,i){for(var s=0,o=0,l=0,u=r.length,f=u-1;l<u;f=l++){var d=(r[l][0]-r[f][0])*(r[f][1]+r[l][1]),p=s+d;o+=Math.abs(s)>=Math.abs(d)?s-p+d:d-p+s,s=p}s+o>=0!=!!i&&r.reverse()}return oh}const cp=[{key:"building",polygon:"all"},{key:"highway",polygon:"whitelist",values:["services","rest_area","escape","elevator"]},{key:"natural",polygon:"blacklist",values:["coastline","cliff","ridge","arete","tree_row"]},{key:"landuse",polygon:"all"},{key:"waterway",polygon:"whitelist",values:["riverbank","dock","boatyard","dam"]},{key:"amenity",polygon:"all"},{key:"leisure",polygon:"all"},{key:"barrier",polygon:"whitelist",values:["city_wall","ditch","hedge","retaining_wall","wall","spikes"]},{key:"railway",polygon:"whitelist",values:["station","turntable","roundhouse","platform"]},{key:"area",polygon:"all"},{key:"boundary",polygon:"all"},{key:"man_made",polygon:"blacklist",values:["cutline","embankment","pipeline"]},{key:"power",polygon:"whitelist",values:["plant","substation","generator","transformer"]},{key:"place",polygon:"all"},{key:"shop",polygon:"all"},{key:"aeroway",polygon:"blacklist",values:["taxiway"]},{key:"tourism",polygon:"all"},{key:"historic",polygon:"all"},{key:"public_transport",polygon:"all"},{key:"office",polygon:"all"},{key:"building:part",polygon:"all"},{key:"military",polygon:"all"},{key:"ruins",polygon:"all"},{key:"area:highway",polygon:"all"},{key:"craft",polygon:"all"},{key:"golf",polygon:"all"},{key:"indoor",polygon:"all"}];var ah,ru;function fp(){return ru||(ru=1,ah=cp),ah}var hh,su;function dp(){if(su)return hh;su=1;var h=lp(),t=up(),e={};fp().forEach(function(o){if(o.polygon==="all")e[o.key]=!0;else{var l=o.polygon==="whitelist"?"included_values":"excluded_values",u={};o.values.forEach(function(f){u[f]=!0}),e[o.key]={},e[o.key][l]=u}});function r(o,l){return(o.version||l.version)&&o.version!==l.version?(+o.version||0)>(+l.version||0)?o:l:h.merge(o,l)}var i={};i=function(o,l,u){l=h.merge({verbose:!1,flatProperties:!0,uninterestingTags:{source:!0,source_ref:!0,"source:ref":!0,history:!0,attribution:!0,created_by:!0,"tiger:county":!0,"tiger:tlid":!0,"tiger:upload_uuid":!0},polygonFeatures:e,deduplicator:r},l);var f;return typeof XMLDocument<"u"&&o instanceof XMLDocument||typeof XMLDocument>"u"&&o.childNodes?f=p(o):f=d(o),f;function d(x){var v=new Array,b=new Array,P=new Array;function A(N){var E=h.clone(N);E.lat=N.center.lat,E.lon=N.center.lon,E.__is_center_placeholder=!0,v.push(E)}function B(N){var E=h.clone(N);E.nodes=[];function C(y,z,H){var G={type:"node",id:"_"+E.type+"/"+E.id+"bounds"+H,lat:y,lon:z};E.nodes.push(G.id),v.push(G)}C(E.bounds.minlat,E.bounds.minlon,1),C(E.bounds.maxlat,E.bounds.minlon,2),C(E.bounds.maxlat,E.bounds.maxlon,3),C(E.bounds.minlat,E.bounds.maxlon,4),E.nodes.push(E.nodes[0]),E.__is_bounds_placeholder=!0,b.push(E)}function Z(N){function E(C,y,z){var H={type:"node",id:z,lat:C,lon:y};v.push(H)}h.isArray(N.nodes)||(N.nodes=N.geometry.map(function(C){return C!==null?"_anonymous@"+C.lat+"/"+C.lon:"_anonymous@unknown_location"})),N.geometry.forEach(function(C,y){C&&E(C.lat,C.lon,N.nodes[y])})}function I(N){function E(y,z,H){var G={type:"node",id:H,lat:y,lon:z};v.push(G)}function C(y,z){if(b.some(function(W){return W.type=="way"&&W.id==z}))return;var H={type:"way",id:z,nodes:[]};function G(W,X){var tt={type:"node",id:"_anonymous@"+W+"/"+X,lat:W,lon:X};H.nodes.push(tt.id),v.push(tt)}y.forEach(function(W){W?G(W.lat,W.lon):H.nodes.push(void 0)}),b.push(H)}N.members.forEach(function(y,z){y.type=="node"?y.lat&&E(y.lat,y.lon,y.ref):y.type=="way"&&y.geometry&&(y.ref="_fullGeom"+y.ref,C(y.geometry,y.ref))})}for(var K=0;K<x.elements.length;K++)switch(x.elements[K].type){case"node":var V=x.elements[K];v.push(V);break;case"way":var S=h.clone(x.elements[K]);S.nodes=h.clone(S.nodes),b.push(S),S.center&&A(S),S.geometry?Z(S):S.bounds&&B(S);break;case"relation":var k=h.clone(x.elements[K]);k.members=h.clone(k.members),P.push(k);var O=k.members&&k.members.some(function(N){return N.type=="node"&&N.lat||N.type=="way"&&N.geometry&&N.geometry.length>0});k.center&&A(k),O?I(k):k.bounds&&B(k);break}return g(v,b,P)}function p(x){var v=new Array,b=new Array,P=new Array;function A(k,O,N){k.hasAttribute(N)&&(O[N]=k.getAttribute(N))}function B(k,O){var N=h.clone(k);A(O,N,"lat"),A(O,N,"lon"),N.__is_center_placeholder=!0,v.push(N)}function Z(k,O){var N=h.clone(k);N.nodes=[];function E(C,y,z){var H={type:"node",id:"_"+N.type+"/"+N.id+"bounds"+z,lat:C,lon:y};N.nodes.push(H.id),v.push(H)}E(O.getAttribute("minlat"),O.getAttribute("minlon"),1),E(O.getAttribute("maxlat"),O.getAttribute("minlon"),2),E(O.getAttribute("maxlat"),O.getAttribute("maxlon"),3),E(O.getAttribute("minlat"),O.getAttribute("maxlon"),4),N.nodes.push(N.nodes[0]),N.__is_bounds_placeholder=!0,b.push(N)}function I(k,O){function N(E,C,y){var z={type:"node",id:y,lat:E,lon:C};return v.push(z),z.id}h.isArray(k.nodes)||(k.nodes=[],h.each(O,function(E,C){k.nodes.push("_anonymous@"+E.getAttribute("lat")+"/"+E.getAttribute("lon"))})),h.each(O,function(E,C){E.getAttribute("lat")&&N(E.getAttribute("lat"),E.getAttribute("lon"),k.nodes[C])})}function K(k,O){function N(C,y,z){var H={type:"node",id:z,lat:C,lon:y};v.push(H)}function E(C,y){if(b.some(function(G){return G.type=="way"&&G.id==y}))return;var z={type:"way",id:y,nodes:[]};function H(G,W){var X={type:"node",id:"_anonymous@"+G+"/"+W,lat:G,lon:W};z.nodes.push(X.id),v.push(X)}h.each(C,function(G){G.getAttribute("lat")?H(G.getAttribute("lat"),G.getAttribute("lon")):z.nodes.push(void 0)}),b.push(z)}h.each(O,function(C,y){k.members[y].type=="node"?C.getAttribute("lat")&&N(C.getAttribute("lat"),C.getAttribute("lon"),k.members[y].ref):k.members[y].type=="way"&&C.getElementsByTagName("nd").length>0&&(k.members[y].ref="_fullGeom"+k.members[y].ref,E(C.getElementsByTagName("nd"),k.members[y].ref))})}h.each(x.getElementsByTagName("node"),function(k,O){var N={};h.each(k.getElementsByTagName("tag"),function(C){N[C.getAttribute("k")]=C.getAttribute("v")});var E={type:"node"};A(k,E,"id"),A(k,E,"lat"),A(k,E,"lon"),A(k,E,"version"),A(k,E,"timestamp"),A(k,E,"changeset"),A(k,E,"uid"),A(k,E,"user"),h.isEmpty(N)||(E.tags=N),v.push(E)});var V,S;return h.each(x.getElementsByTagName("way"),function(k,O){var N={},E=[];h.each(k.getElementsByTagName("tag"),function(z){N[z.getAttribute("k")]=z.getAttribute("v")});var C=!1;h.each(k.getElementsByTagName("nd"),function(z,H){var G;(G=z.getAttribute("ref"))&&(E[H]=G),!C&&z.getAttribute("lat")&&(C=!0)});var y={type:"way"};A(k,y,"id"),A(k,y,"version"),A(k,y,"timestamp"),A(k,y,"changeset"),A(k,y,"uid"),A(k,y,"user"),E.length>0&&(y.nodes=E),h.isEmpty(N)||(y.tags=N),(V=k.getElementsByTagName("center")[0])&&B(y,V),C?I(y,k.getElementsByTagName("nd")):(S=k.getElementsByTagName("bounds")[0])&&Z(y,S),b.push(y)}),h.each(x.getElementsByTagName("relation"),function(k,O){var N={},E=[];h.each(k.getElementsByTagName("tag"),function(z){N[z.getAttribute("k")]=z.getAttribute("v")});var C=!1;h.each(k.getElementsByTagName("member"),function(z,H){E[H]={},A(z,E[H],"ref"),A(z,E[H],"role"),A(z,E[H],"type"),(!C&&E[H].type=="node"&&z.getAttribute("lat")||E[H].type=="way"&&z.getElementsByTagName("nd").length>0)&&(C=!0)});var y={type:"relation"};A(k,y,"id"),A(k,y,"version"),A(k,y,"timestamp"),A(k,y,"changeset"),A(k,y,"uid"),A(k,y,"user"),E.length>0&&(y.members=E),h.isEmpty(N)||(y.tags=N),(V=k.getElementsByTagName("center")[0])&&B(y,V),C?K(y,k.getElementsByTagName("member")):(S=k.getElementsByTagName("bounds")[0])&&Z(y,S),P.push(y)}),g(v,b,P)}function g(x,v,b){function P(bt,vt){if(typeof vt!="object"&&(vt={}),typeof l.uninterestingTags=="function")return!l.uninterestingTags(bt,vt);for(var ht in bt)if(l.uninterestingTags[ht]!==!0&&!(vt[ht]===!0||vt[ht]===bt[ht]))return!0;return!1}function A(bt){var vt={timestamp:bt.timestamp,version:bt.version,changeset:bt.changeset,user:bt.user,uid:bt.uid};for(var ht in vt)vt[ht]===void 0&&delete vt[ht];return vt}for(var B=new Object,Z=new Object,I=0;I<x.length;I++){var K=x[I];B[K.id]!==void 0&&(K=l.deduplicator(K,B[K.id])),B[K.id]=K,typeof K.tags<"u"&&P(K.tags)&&(Z[K.id]=!0)}for(var I=0;I<b.length;I++)if(h.isArray(b[I].members))for(var V=0;V<b[I].members.length;V++)b[I].members[V].type=="node"&&(Z[b[I].members[V].ref]=!0);for(var S=new Object,k=new Object,I=0;I<v.length;I++){var O=v[I];if(S[O.id]&&(O=l.deduplicator(O,S[O.id])),S[O.id]=O,h.isArray(O.nodes))for(var V=0;V<O.nodes.length;V++)typeof O.nodes[V]!="object"&&(k[O.nodes[V]]=!0,O.nodes[V]=B[O.nodes[V]])}var N=new Array;for(var E in B){var K=B[E];(!k[E]||Z[E])&&N.push(K)}for(var C=new Array,I=0;I<b.length;I++){var y=b[I];C[y.id]&&(y=l.deduplicator(y,C[y.id])),C[y.id]=y}var z={node:{},way:{},relation:{}};for(var E in C){var y=C[E];if(!h.isArray(y.members)){l.verbose&&console.warn("Relation",y.type+"/"+y.id,"ignored because it has no members");continue}for(var V=0;V<y.members.length;V++){var H=y.members[V].type,G=y.members[V].ref;if(typeof G!="number"&&(G=G.replace("_fullGeom","")),!z[H]){l.verbose&&console.warn("Relation",y.type+"/"+y.id,"member",H+"/"+G,"ignored because it has an invalid type");continue}typeof z[H][G]>"u"&&(z[H][G]=[]),z[H][G].push({role:y.members[V].role,rel:y.id,reltags:y.tags})}}var W,X=[];for(I=0;I<N.length;I++){if(typeof N[I].lon>"u"||typeof N[I].lat>"u"){l.verbose&&console.warn("POI",N[I].type+"/"+N[I].id,"ignored because it lacks coordinates");continue}var tt={type:"Feature",id:N[I].type+"/"+N[I].id,properties:{type:N[I].type,id:N[I].id,tags:N[I].tags||{},relations:z.node[N[I].id]||[],meta:A(N[I])},geometry:{type:"Point",coordinates:[+N[I].lon,+N[I].lat]}};N[I].__is_center_placeholder&&(tt.properties.geometry="center"),u?u(tt):X.push(tt)}for(var q=[],Q=[],I=0;I<b.length;I++)if(C[b[I].id]===b[I]){if(typeof b[I].tags<"u"&&(b[I].tags.type=="route"||b[I].tags.type=="waterway")){let vt=function(ht){var ft=!1,M;M=ht.members.filter(function(F){return F.type==="way"}),M=M.map(function(F){var J=S[F.ref];if(J===void 0||J.nodes===void 0){l.verbose&&console.warn("Route "+ht.type+"/"+ht.id,"tainted by a missing or incomplete  way",F.type+"/"+F.ref),ft=!0;return}return{id:F.ref,role:F.role,way:J,nodes:J.nodes.filter(function(at){return at!==void 0?!0:(ft=!0,l.verbose&&console.warn("Route",ht.type+"/"+ht.id,"tainted by a way",F.type+"/"+F.ref,"with a missing node"),!1)})}}),M=h.compact(M);var et;et=s(M);var j=[];if(j=h.compact(et.map(function(F){return h.compact(F.map(function(J){return[+J.lon,+J.lat]}))})),j.length==0)return l.verbose&&console.warn("Route",ht.type+"/"+ht.id,"contains no coordinates"),!1;var U={type:"Feature",id:ht.type+"/"+ht.id,properties:{type:ht.type,id:ht.id,tags:ht.tags||{},relations:z[ht.type][ht.id]||[],meta:A(ht)},geometry:{type:j.length===1?"LineString":"MultiLineString",coordinates:j.length===1?j[0]:j}};return ft&&(l.verbose&&console.warn("Route",ht.type+"/"+ht.id,"is tainted"),U.properties.tainted=!0),U};var St=vt;if(!h.isArray(b[I].members)){l.verbose&&console.warn("Route",b[I].type+"/"+b[I].id,"ignored because it has no members");continue}if(b[I].members.forEach(function(ht){S[ht.ref]&&!P(S[ht.ref].tags)&&(S[ht.ref].is_skippablerelationmember=!0)}),tt=vt(b[I]),tt===!1){l.verbose&&console.warn("Route relation",b[I].type+"/"+b[I].id,"ignored because it has invalid geometry");continue}u?u(t(tt)):Q.push(tt)}if(typeof b[I].tags<"u"&&(b[I].tags.type=="multipolygon"||b[I].tags.type=="boundary")){let ht=function(ft,M){var et=!1,j=ct?"way":"relation",U=typeof ft.id=="number"?ft.id:+ft.id.replace("_fullGeom",""),F;F=M.members.filter(function(kt){return kt.type==="way"}),F=F.map(function(kt){var $t=S[kt.ref];if($t===void 0||$t.nodes===void 0){l.verbose&&console.warn("Multipolygon",j+"/"+U,"tainted by a missing or incomplete way",kt.type+"/"+kt.ref),et=!0;return}return{id:kt.ref,role:kt.role||"outer",way:$t,nodes:$t.nodes.filter(function(ce){return ce!==void 0?!0:(et=!0,l.verbose&&console.warn("Multipolygon",j+"/"+U,"tainted by a way",kt.type+"/"+kt.ref,"with a missing node"),!1)})}}),F=h.compact(F);var J,at;J=s(F.filter(function(kt){return kt.role==="outer"})),at=s(F.filter(function(kt){return kt.role==="inner"}));var lt;function it(kt){var $t=function(ve,oe){for(var xe=0;xe<oe.length;xe++)if(se(oe[xe],ve))return!0;return!1},ce=function(ve){return ve.map(function(oe){return[+oe.lat,+oe.lon]})},se=function(ve,oe){for(var xe=ve[0],Fe=ve[1],ii=!1,ni=0,yi=oe.length-1;ni<oe.length;yi=ni++){var je=oe[ni][0],ie=oe[ni][1],Ii=oe[yi][0],ri=oe[yi][1],ss=ie>Fe!=ri>Fe&&xe<(Ii-je)*(Fe-ie)/(ri-ie)+je;ss&&(ii=!ii)}return ii},ye,Jt;for(kt=ce(kt),ye=0;ye<J.length;ye++)if(Jt=ce(J[ye]),$t(Jt,kt))return ye}lt=J.map(function(kt){return[kt]});for(var _t=0;_t<at.length;_t++){var xt=it(at[_t]);xt!==void 0?lt[xt].push(at[_t]):l.verbose&&console.warn("Multipolygon",j+"/"+U,"contains an inner ring with no containing outer")}var gt=[];if(gt=h.compact(lt.map(function(kt){var $t=h.compact(kt.map(function(ce){if(ce.length<4){l.verbose&&console.warn("Multipolygon",j+"/"+U,"contains a ring with less than four nodes");return}return h.compact(ce.map(function(se){return[+se.lon,+se.lat]}))}));if($t.length==0){l.verbose&&console.warn("Multipolygon",j+"/"+U,"contains an empty ring cluster");return}return $t})),gt.length==0)return l.verbose&&console.warn("Multipolygon",j+"/"+U,"contains no coordinates"),!1;var Tt="MultiPolygon";gt.length===1&&(Tt="Polygon",gt=gt[0]);var Wt={type:"Feature",id:ft.type+"/"+U,properties:{type:ft.type,id:U,tags:ft.tags||{},relations:z[ft.type][ft.id]||[],meta:A(ft)},geometry:{type:Tt,coordinates:gt}};return et&&(l.verbose&&console.warn("Multipolygon",j+"/"+U,"is tainted"),Wt.properties.tainted=!0),Wt};var Ot=ht;if(!h.isArray(b[I].members)){l.verbose&&console.warn("Multipolygon",b[I].type+"/"+b[I].id,"ignored because it has no members");continue}for(var dt=0,V=0;V<b[I].members.length;V++)b[I].members[V].role=="outer"?dt++:l.verbose&&b[I].members[V].role!="inner"&&console.warn("Multipolygon",b[I].type+"/"+b[I].id,"member",b[I].members[V].type+"/"+b[I].members[V].ref,'ignored because it has an invalid role: "'+b[I].members[V].role+'"');if(b[I].members.forEach(function(ft){S[ft.ref]&&(ft.role==="outer"&&!P(S[ft.ref].tags,b[I].tags)&&(S[ft.ref].is_skippablerelationmember=!0),ft.role==="inner"&&!P(S[ft.ref].tags)&&(S[ft.ref].is_skippablerelationmember=!0))}),dt==0){l.verbose&&console.warn("Multipolygon relation",b[I].type+"/"+b[I].id,"ignored because it has no outer ways");continue}var ct=!1;dt==1&&!P(b[I].tags,{type:!0})&&(ct=!0);var tt=null;if(!ct)tt=ht(b[I],b[I]);else{var rt=b[I].members.filter(function(ft){return ft.role==="outer"})[0];if(rt=S[rt.ref],rt===void 0){l.verbose&&console.warn("Multipolygon relation",b[I].type+"/"+b[I].id,"ignored because outer way",rt.type+"/"+rt.ref,"is missing");continue}rt.is_skippablerelationmember=!0,tt=ht(rt,b[I])}if(tt===!1){l.verbose&&console.warn("Multipolygon relation",b[I].type+"/"+b[I].id,"ignored because it has invalid geometry");continue}u?u(t(tt)):Q.push(tt)}}for(var I=0;I<v.length;I++)if(S[v[I].id]===v[I]){if(!h.isArray(v[I].nodes)){l.verbose&&console.warn("Way",v[I].type+"/"+v[I].id,"ignored because it has no nodes");continue}if(!v[I].is_skippablerelationmember){typeof v[I].id!="number"&&(v[I].id=+v[I].id.replace("_fullGeom","")),v[I].tainted=!1,v[I].hidden=!1;var mt=new Array;for(V=0;V<v[I].nodes.length;V++)typeof v[I].nodes[V]=="object"?mt.push([+v[I].nodes[V].lon,+v[I].nodes[V].lat]):(l.verbose&&console.warn("Way",v[I].type+"/"+v[I].id,"is tainted by an invalid node"),v[I].tainted=!0);if(mt.length<=1){l.verbose&&console.warn("Way",v[I].type+"/"+v[I].id,"ignored because it contains too few nodes");continue}var Et="LineString";typeof v[I].nodes[0]<"u"&&typeof v[I].nodes[v[I].nodes.length-1]<"u"&&v[I].nodes[0].id===v[I].nodes[v[I].nodes.length-1].id&&(typeof v[I].tags<"u"&&m(v[I].tags)||v[I].__is_bounds_placeholder)&&(Et="Polygon",mt=[mt]);var tt={type:"Feature",id:v[I].type+"/"+v[I].id,properties:{type:v[I].type,id:v[I].id,tags:v[I].tags||{},relations:z.way[v[I].id]||[],meta:A(v[I])},geometry:{type:Et,coordinates:mt}};v[I].tainted&&(l.verbose&&console.warn("Way",v[I].type+"/"+v[I].id,"is tainted"),tt.properties.tainted=!0),v[I].__is_bounds_placeholder&&(tt.properties.geometry="bounds"),u?u(t(tt)):Et=="LineString"?q.push(tt):Q.push(tt)}}return u?!0:(W={type:"FeatureCollection",features:[]},W.features=W.features.concat(Q),W.features=W.features.concat(q),W.features=W.features.concat(X),l.flatProperties&&W.features.forEach(function(bt){bt.properties=h.merge(bt.properties.meta,bt.properties.tags,{id:bt.properties.type+"/"+bt.properties.id})}),W=t(W),W)}function m(x){var v=l.polygonFeatures;if(typeof v=="function")return v(x);if(x.area==="no")return!1;for(var b in x){var P=x[b],A=v[b];if(!(typeof A>"u")&&P!=="no"&&(A===!0||A.included_values&&A.included_values[P]===!0||A.excluded_values&&A.excluded_values[P]!==!0))return!0}return!1}};function s(o){for(var l=function(P){return P[0]},u=function(P){return P[P.length-1]},f=function(P,A){return P!==void 0&&A!==void 0&&P.id===A.id},d=[],p,g,m,x,v,b;o.length;)for(p=o.pop().nodes.slice(),d.push(p);o.length&&!f(l(p),u(p));){for(g=l(p),m=u(p),x=0;x<o.length;x++)if(b=o[x].nodes,f(m,l(b))){v=p.push,b=b.slice(1);break}else if(f(m,u(b))){v=p.push,b=b.slice(0,-1).reverse();break}else if(f(g,u(b))){v=p.unshift,b=b.slice(0,-1);break}else if(f(g,l(b))){v=p.unshift,b=b.slice(1).reverse();break}else b=v=null;if(!b)break;o.splice(x,1),v.apply(p,b)}return d}return i.toGeojson=i,hh=i,hh}var pp=dp();const mp=gl(pp);var We=63710088e-1,Dc={centimeters:We*100,centimetres:We*100,degrees:360/(2*Math.PI),feet:We*3.28084,inches:We*39.37,kilometers:We/1e3,kilometres:We/1e3,meters:We,metres:We,miles:We/1609.344,millimeters:We*1e3,millimetres:We*1e3,nauticalmiles:We/1852,radians:1,yards:We*1.0936};function lr(h,t,e={}){const r={type:"Feature"};return(e.id===0||e.id)&&(r.id=e.id),e.bbox&&(r.bbox=e.bbox),r.properties=t||{},r.geometry=h,r}function _p(h,t,e={}){switch(h){case"Point":return Bc(t).geometry;case"LineString":return gp(t).geometry;case"Polygon":return Na(t).geometry;case"MultiPoint":return xp(t).geometry;case"MultiLineString":return vp(t).geometry;case"MultiPolygon":return Nc(t).geometry;default:throw new Error(h+" is invalid")}}function Bc(h,t,e={}){if(!h)throw new Error("coordinates is required");if(!Array.isArray(h))throw new Error("coordinates must be an Array");if(h.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!ou(h[0])||!ou(h[1]))throw new Error("coordinates must contain numbers");return lr({type:"Point",coordinates:h},t,e)}function Na(h,t,e={}){for(const i of h){if(i.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");if(i[i.length-1].length!==i[0].length)throw new Error("First and last Position are not equivalent.");for(let s=0;s<i[i.length-1].length;s++)if(i[i.length-1][s]!==i[0][s])throw new Error("First and last Position are not equivalent.")}return lr({type:"Polygon",coordinates:h},t,e)}function gp(h,t,e={}){if(h.length<2)throw new Error("coordinates must be an array of two or more positions");return lr({type:"LineString",coordinates:h},t,e)}function yp(h,t={}){const e={type:"FeatureCollection"};return t.id&&(e.id=t.id),t.bbox&&(e.bbox=t.bbox),e.features=h,e}function vp(h,t,e={}){return lr({type:"MultiLineString",coordinates:h},t,e)}function xp(h,t,e={}){return lr({type:"MultiPoint",coordinates:h},t,e)}function Nc(h,t,e={}){return lr({type:"MultiPolygon",coordinates:h},t,e)}function wp(h,t="kilometers"){const e=Dc[t];if(!e)throw new Error(t+" units is invalid");return h*e}function bp(h,t="kilometers"){const e=Dc[t];if(!e)throw new Error(t+" units is invalid");return h/e}function Lp(h){return h%(2*Math.PI)*180/Math.PI}function lh(h){return h%360*Math.PI/180}function Mp(h,t="kilometers",e="kilometers"){if(!(h>=0))throw new Error("length must be a positive number");return wp(bp(h,t),e)}function ou(h){return!isNaN(h)&&h!==null&&!Array.isArray(h)}function Vr(h){if(!h)throw new Error("coord is required");if(!Array.isArray(h)){if(h.type==="Feature"&&h.geometry!==null&&h.geometry.type==="Point")return[...h.geometry.coordinates];if(h.type==="Point")return[...h.coordinates]}if(Array.isArray(h)&&h.length>=2&&!Array.isArray(h[0])&&!Array.isArray(h[1]))return[...h];throw new Error("coord must be GeoJSON Point or an Array of numbers")}function Ep(h,t,e={}){let r;return e.final?r=au(Vr(t),Vr(h)):r=au(Vr(h),Vr(t)),r>180?-(360-r):r}function au(h,t){const e=lh(h[1]),r=lh(t[1]);let i=lh(t[0]-h[0]);i>Math.PI&&(i-=2*Math.PI),i<-Math.PI&&(i+=2*Math.PI);const s=Math.log(Math.tan(r/2+Math.PI/4)/Math.tan(e/2+Math.PI/4)),o=Math.atan2(i,s);return(Lp(o)+360)%360}function Fc(h,t,e){if(h!==null)for(var r,i,s,o,l,u,f,d=0,p=0,g,m=h.type,x=m==="FeatureCollection",v=m==="Feature",b=x?h.features.length:1,P=0;P<b;P++){f=x?h.features[P].geometry:v?h.geometry:h,g=f?f.type==="GeometryCollection":!1,l=g?f.geometries.length:1;for(var A=0;A<l;A++){var B=0,Z=0;if(o=g?f.geometries[A]:f,o!==null){u=o.coordinates;var I=o.type;switch(d=I==="Polygon"||I==="MultiPolygon"?1:0,I){case null:break;case"Point":if(t(u,p,P,B,Z)===!1)return!1;p++,B++;break;case"LineString":case"MultiPoint":for(r=0;r<u.length;r++){if(t(u[r],p,P,B,Z)===!1)return!1;p++,I==="MultiPoint"&&B++}I==="LineString"&&B++;break;case"Polygon":case"MultiLineString":for(r=0;r<u.length;r++){for(i=0;i<u[r].length-d;i++){if(t(u[r][i],p,P,B,Z)===!1)return!1;p++}I==="MultiLineString"&&B++,I==="Polygon"&&Z++}I==="Polygon"&&B++;break;case"MultiPolygon":for(r=0;r<u.length;r++){for(Z=0,i=0;i<u[r].length;i++){for(s=0;s<u[r][i].length-d;s++){if(t(u[r][i][s],p,P,B,Z)===!1)return!1;p++}Z++}B++}break;case"GeometryCollection":for(r=0;r<o.geometries.length;r++)if(Fc(o.geometries[r],t)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function Tp(h,t){var e,r,i,s,o,l,u,f,d,p,g=0,m=h.type==="FeatureCollection",x=h.type==="Feature",v=m?h.features.length:1;for(e=0;e<v;e++){for(l=m?h.features[e].geometry:x?h.geometry:h,f=m?h.features[e].properties:x?h.properties:{},d=m?h.features[e].bbox:x?h.bbox:void 0,p=m?h.features[e].id:x?h.id:void 0,u=l?l.type==="GeometryCollection":!1,o=u?l.geometries.length:1,i=0;i<o;i++){if(s=u?l.geometries[i]:l,s===null){if(t(null,g,f,d,p)===!1)return!1;continue}switch(s.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(t(s,g,f,d,p)===!1)return!1;break}case"GeometryCollection":{for(r=0;r<s.geometries.length;r++)if(t(s.geometries[r],g,f,d,p)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}g++}}function Sp(h,t={}){const e=Number(h[0]),r=Number(h[1]),i=Number(h[2]),s=Number(h[3]);if(h.length===6)throw new Error("@turf/bbox-polygon does not support BBox with 6 positions");const o=[e,r];return Na([[o,[i,r],[i,s],[e,s],o]],t.properties,{bbox:h,id:t.id})}function Go(h,t={}){let e=0,r=0,i=0;return Fc(h,function(s){e+=s[0],r+=s[1],i++}),Bc([e/i,r/i],t.properties)}var kp=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,uh=Math.ceil,mi=Math.floor,Ve="[BigNumber Error] ",hu=Ve+"Number primitive has more than 15 significant digits: ",Mi=1e14,Nt=14,lu=9007199254740991,ch=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],wn=1e7,Je=1e9;function Uc(h){var t,e,r,i=A.prototype={constructor:A,toString:null,valueOf:null},s=new A(1),o=20,l=4,u=-7,f=21,d=-1e7,p=1e7,g=!1,m=1,x=0,v={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:" ",suffix:""},b="0123456789abcdefghijklmnopqrstuvwxyz",P=!0;function A(S,k){var O,N,E,C,y,z,H,G,W=this;if(!(W instanceof A))return new A(S,k);if(k==null){if(S&&S._isBigNumber===!0){W.s=S.s,!S.c||S.e>p?W.c=W.e=null:S.e<d?W.c=[W.e=0]:(W.e=S.e,W.c=S.c.slice());return}if((z=typeof S=="number")&&S*0==0){if(W.s=1/S<0?(S=-S,-1):1,S===~~S){for(C=0,y=S;y>=10;y/=10,C++);C>p?W.c=W.e=null:(W.e=C,W.c=[S]);return}G=String(S)}else{if(!kp.test(G=String(S)))return r(W,G,z);W.s=G.charCodeAt(0)==45?(G=G.slice(1),-1):1}(C=G.indexOf("."))>-1&&(G=G.replace(".","")),(y=G.search(/e/i))>0?(C<0&&(C=y),C+=+G.slice(y+1),G=G.substring(0,y)):C<0&&(C=G.length)}else{if(he(k,2,b.length,"Base"),k==10&&P)return W=new A(S),K(W,o+W.e+1,l);if(G=String(S),z=typeof S=="number"){if(S*0!=0)return r(W,G,z,k);if(W.s=1/S<0?(G=G.slice(1),-1):1,A.DEBUG&&G.replace(/^0\.0*|\./,"").length>15)throw Error(hu+S)}else W.s=G.charCodeAt(0)===45?(G=G.slice(1),-1):1;for(O=b.slice(0,k),C=y=0,H=G.length;y<H;y++)if(O.indexOf(N=G.charAt(y))<0){if(N=="."){if(y>C){C=H;continue}}else if(!E&&(G==G.toUpperCase()&&(G=G.toLowerCase())||G==G.toLowerCase()&&(G=G.toUpperCase()))){E=!0,y=-1,C=0;continue}return r(W,String(S),z,k)}z=!1,G=e(G,k,10,W.s),(C=G.indexOf("."))>-1?G=G.replace(".",""):C=G.length}for(y=0;G.charCodeAt(y)===48;y++);for(H=G.length;G.charCodeAt(--H)===48;);if(G=G.slice(y,++H)){if(H-=y,z&&A.DEBUG&&H>15&&(S>lu||S!==mi(S)))throw Error(hu+W.s*S);if((C=C-y-1)>p)W.c=W.e=null;else if(C<d)W.c=[W.e=0];else{if(W.e=C,W.c=[],y=(C+1)%Nt,C<0&&(y+=Nt),y<H){for(y&&W.c.push(+G.slice(0,y)),H-=Nt;y<H;)W.c.push(+G.slice(y,y+=Nt));y=Nt-(G=G.slice(y)).length}else y-=H;for(;y--;G+="0");W.c.push(+G)}}else W.c=[W.e=0]}A.clone=Uc,A.ROUND_UP=0,A.ROUND_DOWN=1,A.ROUND_CEIL=2,A.ROUND_FLOOR=3,A.ROUND_HALF_UP=4,A.ROUND_HALF_DOWN=5,A.ROUND_HALF_EVEN=6,A.ROUND_HALF_CEIL=7,A.ROUND_HALF_FLOOR=8,A.EUCLID=9,A.config=A.set=function(S){var k,O;if(S!=null)if(typeof S=="object"){if(S.hasOwnProperty(k="DECIMAL_PLACES")&&(O=S[k],he(O,0,Je,k),o=O),S.hasOwnProperty(k="ROUNDING_MODE")&&(O=S[k],he(O,0,8,k),l=O),S.hasOwnProperty(k="EXPONENTIAL_AT")&&(O=S[k],O&&O.pop?(he(O[0],-1e9,0,k),he(O[1],0,Je,k),u=O[0],f=O[1]):(he(O,-1e9,Je,k),u=-(f=O<0?-O:O))),S.hasOwnProperty(k="RANGE"))if(O=S[k],O&&O.pop)he(O[0],-1e9,-1,k),he(O[1],1,Je,k),d=O[0],p=O[1];else if(he(O,-1e9,Je,k),O)d=-(p=O<0?-O:O);else throw Error(Ve+k+" cannot be zero: "+O);if(S.hasOwnProperty(k="CRYPTO"))if(O=S[k],O===!!O)if(O)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))g=O;else throw g=!O,Error(Ve+"crypto unavailable");else g=O;else throw Error(Ve+k+" not true or false: "+O);if(S.hasOwnProperty(k="MODULO_MODE")&&(O=S[k],he(O,0,9,k),m=O),S.hasOwnProperty(k="POW_PRECISION")&&(O=S[k],he(O,0,Je,k),x=O),S.hasOwnProperty(k="FORMAT"))if(O=S[k],typeof O=="object")v=O;else throw Error(Ve+k+" not an object: "+O);if(S.hasOwnProperty(k="ALPHABET"))if(O=S[k],typeof O=="string"&&!/^.?$|[+\-.\s]|(.).*\1/.test(O))P=O.slice(0,10)=="0123456789",b=O;else throw Error(Ve+k+" invalid: "+O)}else throw Error(Ve+"Object expected: "+S);return{DECIMAL_PLACES:o,ROUNDING_MODE:l,EXPONENTIAL_AT:[u,f],RANGE:[d,p],CRYPTO:g,MODULO_MODE:m,POW_PRECISION:x,FORMAT:v,ALPHABET:b}},A.isBigNumber=function(S){if(!S||S._isBigNumber!==!0)return!1;if(!A.DEBUG)return!0;var k,O,N=S.c,E=S.e,C=S.s;t:if({}.toString.call(N)=="[object Array]"){if((C===1||C===-1)&&E>=-1e9&&E<=Je&&E===mi(E)){if(N[0]===0){if(E===0&&N.length===1)return!0;break t}if(k=(E+1)%Nt,k<1&&(k+=Nt),String(N[0]).length==k){for(k=0;k<N.length;k++)if(O=N[k],O<0||O>=Mi||O!==mi(O))break t;if(O!==0)return!0}}}else if(N===null&&E===null&&(C===null||C===1||C===-1))return!0;throw Error(Ve+"Invalid BigNumber: "+S)},A.maximum=A.max=function(){return Z(arguments,-1)},A.minimum=A.min=function(){return Z(arguments,1)},A.random=function(){var S=9007199254740992,k=Math.random()*S&2097151?function(){return mi(Math.random()*S)}:function(){return(Math.random()*1073741824|0)*8388608+(Math.random()*8388608|0)};return function(O){var N,E,C,y,z,H=0,G=[],W=new A(s);if(O==null?O=o:he(O,0,Je),y=uh(O/Nt),g)if(crypto.getRandomValues){for(N=crypto.getRandomValues(new Uint32Array(y*=2));H<y;)z=N[H]*131072+(N[H+1]>>>11),z>=9e15?(E=crypto.getRandomValues(new Uint32Array(2)),N[H]=E[0],N[H+1]=E[1]):(G.push(z%1e14),H+=2);H=y/2}else if(crypto.randomBytes){for(N=crypto.randomBytes(y*=7);H<y;)z=(N[H]&31)*281474976710656+N[H+1]*1099511627776+N[H+2]*4294967296+N[H+3]*16777216+(N[H+4]<<16)+(N[H+5]<<8)+N[H+6],z>=9e15?crypto.randomBytes(7).copy(N,H):(G.push(z%1e14),H+=7);H=y/7}else throw g=!1,Error(Ve+"crypto unavailable");if(!g)for(;H<y;)z=k(),z<9e15&&(G[H++]=z%1e14);for(y=G[--H],O%=Nt,y&&O&&(z=ch[Nt-O],G[H]=mi(y/z)*z);G[H]===0;G.pop(),H--);if(H<0)G=[C=0];else{for(C=-1;G[0]===0;G.splice(0,1),C-=Nt);for(H=1,z=G[0];z>=10;z/=10,H++);H<Nt&&(C-=Nt-H)}return W.e=C,W.c=G,W}}(),A.sum=function(){for(var S=1,k=arguments,O=new A(k[0]);S<k.length;)O=O.plus(k[S++]);return O},e=function(){var S="0123456789";function k(O,N,E,C){for(var y,z=[0],H,G=0,W=O.length;G<W;){for(H=z.length;H--;z[H]*=N);for(z[0]+=C.indexOf(O.charAt(G++)),y=0;y<z.length;y++)z[y]>E-1&&(z[y+1]==null&&(z[y+1]=0),z[y+1]+=z[y]/E|0,z[y]%=E)}return z.reverse()}return function(O,N,E,C,y){var z,H,G,W,X,tt,q,Q,dt=O.indexOf("."),ct=o,rt=l;for(dt>=0&&(W=x,x=0,O=O.replace(".",""),Q=new A(N),tt=Q.pow(O.length-dt),x=W,Q.c=k(rn(di(tt.c),tt.e,"0"),10,E,S),Q.e=Q.c.length),q=k(O,N,E,y?(z=b,S):(z=S,b)),G=W=q.length;q[--W]==0;q.pop());if(!q[0])return z.charAt(0);if(dt<0?--G:(tt.c=q,tt.e=G,tt.s=C,tt=t(tt,Q,ct,rt,E),q=tt.c,X=tt.r,G=tt.e),H=G+ct+1,dt=q[H],W=E/2,X=X||H<0||q[H+1]!=null,X=rt<4?(dt!=null||X)&&(rt==0||rt==(tt.s<0?3:2)):dt>W||dt==W&&(rt==4||X||rt==6&&q[H-1]&1||rt==(tt.s<0?8:7)),H<1||!q[0])O=X?rn(z.charAt(1),-ct,z.charAt(0)):z.charAt(0);else{if(q.length=H,X)for(--E;++q[--H]>E;)q[H]=0,H||(++G,q=[1].concat(q));for(W=q.length;!q[--W];);for(dt=0,O="";dt<=W;O+=z.charAt(q[dt++]));O=rn(O,G,z.charAt(0))}return O}}(),t=function(){function S(N,E,C){var y,z,H,G,W=0,X=N.length,tt=E%wn,q=E/wn|0;for(N=N.slice();X--;)H=N[X]%wn,G=N[X]/wn|0,y=q*H+G*tt,z=tt*H+y%wn*wn+W,W=(z/C|0)+(y/wn|0)+q*G,N[X]=z%C;return W&&(N=[W].concat(N)),N}function k(N,E,C,y){var z,H;if(C!=y)H=C>y?1:-1;else for(z=H=0;z<C;z++)if(N[z]!=E[z]){H=N[z]>E[z]?1:-1;break}return H}function O(N,E,C,y){for(var z=0;C--;)N[C]-=z,z=N[C]<E[C]?1:0,N[C]=z*y+N[C]-E[C];for(;!N[0]&&N.length>1;N.splice(0,1));}return function(N,E,C,y,z){var H,G,W,X,tt,q,Q,dt,ct,rt,mt,Et,St,Ot,bt,vt,ht,ft=N.s==E.s?1:-1,M=N.c,et=E.c;if(!M||!M[0]||!et||!et[0])return new A(!N.s||!E.s||(M?et&&M[0]==et[0]:!et)?NaN:M&&M[0]==0||!et?ft*0:ft/0);for(dt=new A(ft),ct=dt.c=[],G=N.e-E.e,ft=C+G+1,z||(z=Mi,G=_i(N.e/Nt)-_i(E.e/Nt),ft=ft/Nt|0),W=0;et[W]==(M[W]||0);W++);if(et[W]>(M[W]||0)&&G--,ft<0)ct.push(1),X=!0;else{for(Ot=M.length,vt=et.length,W=0,ft+=2,tt=mi(z/(et[0]+1)),tt>1&&(et=S(et,tt,z),M=S(M,tt,z),vt=et.length,Ot=M.length),St=vt,rt=M.slice(0,vt),mt=rt.length;mt<vt;rt[mt++]=0);ht=et.slice(),ht=[0].concat(ht),bt=et[0],et[1]>=z/2&&bt++;do{if(tt=0,H=k(et,rt,vt,mt),H<0){if(Et=rt[0],vt!=mt&&(Et=Et*z+(rt[1]||0)),tt=mi(Et/bt),tt>1)for(tt>=z&&(tt=z-1),q=S(et,tt,z),Q=q.length,mt=rt.length;k(q,rt,Q,mt)==1;)tt--,O(q,vt<Q?ht:et,Q,z),Q=q.length,H=1;else tt==0&&(H=tt=1),q=et.slice(),Q=q.length;if(Q<mt&&(q=[0].concat(q)),O(rt,q,mt,z),mt=rt.length,H==-1)for(;k(et,rt,vt,mt)<1;)tt++,O(rt,vt<mt?ht:et,mt,z),mt=rt.length}else H===0&&(tt++,rt=[0]);ct[W++]=tt,rt[0]?rt[mt++]=M[St]||0:(rt=[M[St]],mt=1)}while((St++<Ot||rt[0]!=null)&&ft--);X=rt[0]!=null,ct[0]||ct.splice(0,1)}if(z==Mi){for(W=1,ft=ct[0];ft>=10;ft/=10,W++);K(dt,C+(dt.e=W+G*Nt-1)+1,y,X)}else dt.e=G,dt.r=+X;return dt}}();function B(S,k,O,N){var E,C,y,z,H;if(O==null?O=l:he(O,0,8),!S.c)return S.toString();if(E=S.c[0],y=S.e,k==null)H=di(S.c),H=N==1||N==2&&(y<=u||y>=f)?Wo(H,y):rn(H,y,"0");else if(S=K(new A(S),k,O),C=S.e,H=di(S.c),z=H.length,N==1||N==2&&(k<=C||C<=u)){for(;z<k;H+="0",z++);H=Wo(H,C)}else if(k-=y,H=rn(H,C,"0"),C+1>z){if(--k>0)for(H+=".";k--;H+="0");}else if(k+=C-z,k>0)for(C+1==z&&(H+=".");k--;H+="0");return S.s<0&&E?"-"+H:H}function Z(S,k){for(var O,N,E=1,C=new A(S[0]);E<S.length;E++)N=new A(S[E]),(!N.s||(O=$n(C,N))===k||O===0&&C.s===k)&&(C=N);return C}function I(S,k,O){for(var N=1,E=k.length;!k[--E];k.pop());for(E=k[0];E>=10;E/=10,N++);return(O=N+O*Nt-1)>p?S.c=S.e=null:O<d?S.c=[S.e=0]:(S.e=O,S.c=k),S}r=function(){var S=/^(-?)0([xbo])(?=\w[\w.]*$)/i,k=/^([^.]+)\.$/,O=/^\.([^.]+)$/,N=/^-?(Infinity|NaN)$/,E=/^\s*\+(?=[\w.])|^\s+|\s+$/g;return function(C,y,z,H){var G,W=z?y:y.replace(E,"");if(N.test(W))C.s=isNaN(W)?null:W<0?-1:1;else{if(!z&&(W=W.replace(S,function(X,tt,q){return G=(q=q.toLowerCase())=="x"?16:q=="b"?2:8,!H||H==G?tt:X}),H&&(G=H,W=W.replace(k,"$1").replace(O,"0.$1")),y!=W))return new A(W,G);if(A.DEBUG)throw Error(Ve+"Not a"+(H?" base "+H:"")+" number: "+y);C.s=null}C.c=C.e=null}}();function K(S,k,O,N){var E,C,y,z,H,G,W,X=S.c,tt=ch;if(X){t:{for(E=1,z=X[0];z>=10;z/=10,E++);if(C=k-E,C<0)C+=Nt,y=k,H=X[G=0],W=mi(H/tt[E-y-1]%10);else if(G=uh((C+1)/Nt),G>=X.length)if(N){for(;X.length<=G;X.push(0));H=W=0,E=1,C%=Nt,y=C-Nt+1}else break t;else{for(H=z=X[G],E=1;z>=10;z/=10,E++);C%=Nt,y=C-Nt+E,W=y<0?0:mi(H/tt[E-y-1]%10)}if(N=N||k<0||X[G+1]!=null||(y<0?H:H%tt[E-y-1]),N=O<4?(W||N)&&(O==0||O==(S.s<0?3:2)):W>5||W==5&&(O==4||N||O==6&&(C>0?y>0?H/tt[E-y]:0:X[G-1])%10&1||O==(S.s<0?8:7)),k<1||!X[0])return X.length=0,N?(k-=S.e+1,X[0]=tt[(Nt-k%Nt)%Nt],S.e=-k||0):X[0]=S.e=0,S;if(C==0?(X.length=G,z=1,G--):(X.length=G+1,z=tt[Nt-C],X[G]=y>0?mi(H/tt[E-y]%tt[y])*z:0),N)for(;;)if(G==0){for(C=1,y=X[0];y>=10;y/=10,C++);for(y=X[0]+=z,z=1;y>=10;y/=10,z++);C!=z&&(S.e++,X[0]==Mi&&(X[0]=1));break}else{if(X[G]+=z,X[G]!=Mi)break;X[G--]=0,z=1}for(C=X.length;X[--C]===0;X.pop());}S.e>p?S.c=S.e=null:S.e<d&&(S.c=[S.e=0])}return S}function V(S){var k,O=S.e;return O===null?S.toString():(k=di(S.c),k=O<=u||O>=f?Wo(k,O):rn(k,O,"0"),S.s<0?"-"+k:k)}return i.absoluteValue=i.abs=function(){var S=new A(this);return S.s<0&&(S.s=1),S},i.comparedTo=function(S,k){return $n(this,new A(S,k))},i.decimalPlaces=i.dp=function(S,k){var O,N,E,C=this;if(S!=null)return he(S,0,Je),k==null?k=l:he(k,0,8),K(new A(C),S+C.e+1,k);if(!(O=C.c))return null;if(N=((E=O.length-1)-_i(this.e/Nt))*Nt,E=O[E])for(;E%10==0;E/=10,N--);return N<0&&(N=0),N},i.dividedBy=i.div=function(S,k){return t(this,new A(S,k),o,l)},i.dividedToIntegerBy=i.idiv=function(S,k){return t(this,new A(S,k),0,1)},i.exponentiatedBy=i.pow=function(S,k){var O,N,E,C,y,z,H,G,W,X=this;if(S=new A(S),S.c&&!S.isInteger())throw Error(Ve+"Exponent not an integer: "+V(S));if(k!=null&&(k=new A(k)),z=S.e>14,!X.c||!X.c[0]||X.c[0]==1&&!X.e&&X.c.length==1||!S.c||!S.c[0])return W=new A(Math.pow(+V(X),z?S.s*(2-Ho(S)):+V(S))),k?W.mod(k):W;if(H=S.s<0,k){if(k.c?!k.c[0]:!k.s)return new A(NaN);N=!H&&X.isInteger()&&k.isInteger(),N&&(X=X.mod(k))}else{if(S.e>9&&(X.e>0||X.e<-1||(X.e==0?X.c[0]>1||z&&X.c[1]>=24e7:X.c[0]<8e13||z&&X.c[0]<=9999975e7)))return C=X.s<0&&Ho(S)?-0:0,X.e>-1&&(C=1/C),new A(H?1/C:C);x&&(C=uh(x/Nt+2))}for(z?(O=new A(.5),H&&(S.s=1),G=Ho(S)):(E=Math.abs(+V(S)),G=E%2),W=new A(s);;){if(G){if(W=W.times(X),!W.c)break;C?W.c.length>C&&(W.c.length=C):N&&(W=W.mod(k))}if(E){if(E=mi(E/2),E===0)break;G=E%2}else if(S=S.times(O),K(S,S.e+1,1),S.e>14)G=Ho(S);else{if(E=+V(S),E===0)break;G=E%2}X=X.times(X),C?X.c&&X.c.length>C&&(X.c.length=C):N&&(X=X.mod(k))}return N?W:(H&&(W=s.div(W)),k?W.mod(k):C?K(W,x,l,y):W)},i.integerValue=function(S){var k=new A(this);return S==null?S=l:he(S,0,8),K(k,k.e+1,S)},i.isEqualTo=i.eq=function(S,k){return $n(this,new A(S,k))===0},i.isFinite=function(){return!!this.c},i.isGreaterThan=i.gt=function(S,k){return $n(this,new A(S,k))>0},i.isGreaterThanOrEqualTo=i.gte=function(S,k){return(k=$n(this,new A(S,k)))===1||k===0},i.isInteger=function(){return!!this.c&&_i(this.e/Nt)>this.c.length-2},i.isLessThan=i.lt=function(S,k){return $n(this,new A(S,k))<0},i.isLessThanOrEqualTo=i.lte=function(S,k){return(k=$n(this,new A(S,k)))===-1||k===0},i.isNaN=function(){return!this.s},i.isNegative=function(){return this.s<0},i.isPositive=function(){return this.s>0},i.isZero=function(){return!!this.c&&this.c[0]==0},i.minus=function(S,k){var O,N,E,C,y=this,z=y.s;if(S=new A(S,k),k=S.s,!z||!k)return new A(NaN);if(z!=k)return S.s=-k,y.plus(S);var H=y.e/Nt,G=S.e/Nt,W=y.c,X=S.c;if(!H||!G){if(!W||!X)return W?(S.s=-k,S):new A(X?y:NaN);if(!W[0]||!X[0])return X[0]?(S.s=-k,S):new A(W[0]?y:l==3?-0:0)}if(H=_i(H),G=_i(G),W=W.slice(),z=H-G){for((C=z<0)?(z=-z,E=W):(G=H,E=X),E.reverse(),k=z;k--;E.push(0));E.reverse()}else for(N=(C=(z=W.length)<(k=X.length))?z:k,z=k=0;k<N;k++)if(W[k]!=X[k]){C=W[k]<X[k];break}if(C&&(E=W,W=X,X=E,S.s=-S.s),k=(N=X.length)-(O=W.length),k>0)for(;k--;W[O++]=0);for(k=Mi-1;N>z;){if(W[--N]<X[N]){for(O=N;O&&!W[--O];W[O]=k);--W[O],W[N]+=Mi}W[N]-=X[N]}for(;W[0]==0;W.splice(0,1),--G);return W[0]?I(S,W,G):(S.s=l==3?-1:1,S.c=[S.e=0],S)},i.modulo=i.mod=function(S,k){var O,N,E=this;return S=new A(S,k),!E.c||!S.s||S.c&&!S.c[0]?new A(NaN):!S.c||E.c&&!E.c[0]?new A(E):(m==9?(N=S.s,S.s=1,O=t(E,S,0,3),S.s=N,O.s*=N):O=t(E,S,0,m),S=E.minus(O.times(S)),!S.c[0]&&m==1&&(S.s=E.s),S)},i.multipliedBy=i.times=function(S,k){var O,N,E,C,y,z,H,G,W,X,tt,q,Q,dt,ct,rt=this,mt=rt.c,Et=(S=new A(S,k)).c;if(!mt||!Et||!mt[0]||!Et[0])return!rt.s||!S.s||mt&&!mt[0]&&!Et||Et&&!Et[0]&&!mt?S.c=S.e=S.s=null:(S.s*=rt.s,!mt||!Et?S.c=S.e=null:(S.c=[0],S.e=0)),S;for(N=_i(rt.e/Nt)+_i(S.e/Nt),S.s*=rt.s,H=mt.length,X=Et.length,H<X&&(Q=mt,mt=Et,Et=Q,E=H,H=X,X=E),E=H+X,Q=[];E--;Q.push(0));for(dt=Mi,ct=wn,E=X;--E>=0;){for(O=0,tt=Et[E]%ct,q=Et[E]/ct|0,y=H,C=E+y;C>E;)G=mt[--y]%ct,W=mt[y]/ct|0,z=q*G+W*tt,G=tt*G+z%ct*ct+Q[C]+O,O=(G/dt|0)+(z/ct|0)+q*W,Q[C--]=G%dt;Q[C]=O}return O?++N:Q.splice(0,1),I(S,Q,N)},i.negated=function(){var S=new A(this);return S.s=-S.s||null,S},i.plus=function(S,k){var O,N=this,E=N.s;if(S=new A(S,k),k=S.s,!E||!k)return new A(NaN);if(E!=k)return S.s=-k,N.minus(S);var C=N.e/Nt,y=S.e/Nt,z=N.c,H=S.c;if(!C||!y){if(!z||!H)return new A(E/0);if(!z[0]||!H[0])return H[0]?S:new A(z[0]?N:E*0)}if(C=_i(C),y=_i(y),z=z.slice(),E=C-y){for(E>0?(y=C,O=H):(E=-E,O=z),O.reverse();E--;O.push(0));O.reverse()}for(E=z.length,k=H.length,E-k<0&&(O=H,H=z,z=O,k=E),E=0;k;)E=(z[--k]=z[k]+H[k]+E)/Mi|0,z[k]=Mi===z[k]?0:z[k]%Mi;return E&&(z=[E].concat(z),++y),I(S,z,y)},i.precision=i.sd=function(S,k){var O,N,E,C=this;if(S!=null&&S!==!!S)return he(S,1,Je),k==null?k=l:he(k,0,8),K(new A(C),S,k);if(!(O=C.c))return null;if(E=O.length-1,N=E*Nt+1,E=O[E]){for(;E%10==0;E/=10,N--);for(E=O[0];E>=10;E/=10,N++);}return S&&C.e+1>N&&(N=C.e+1),N},i.shiftedBy=function(S){return he(S,-9007199254740991,lu),this.times("1e"+S)},i.squareRoot=i.sqrt=function(){var S,k,O,N,E,C=this,y=C.c,z=C.s,H=C.e,G=o+4,W=new A("0.5");if(z!==1||!y||!y[0])return new A(!z||z<0&&(!y||y[0])?NaN:y?C:1/0);if(z=Math.sqrt(+V(C)),z==0||z==1/0?(k=di(y),(k.length+H)%2==0&&(k+="0"),z=Math.sqrt(+k),H=_i((H+1)/2)-(H<0||H%2),z==1/0?k="5e"+H:(k=z.toExponential(),k=k.slice(0,k.indexOf("e")+1)+H),O=new A(k)):O=new A(z+""),O.c[0]){for(H=O.e,z=H+G,z<3&&(z=0);;)if(E=O,O=W.times(E.plus(t(C,E,G,1))),di(E.c).slice(0,z)===(k=di(O.c)).slice(0,z))if(O.e<H&&--z,k=k.slice(z-3,z+1),k=="9999"||!N&&k=="4999"){if(!N&&(K(E,E.e+o+2,0),E.times(E).eq(C))){O=E;break}G+=4,z+=4,N=1}else{(!+k||!+k.slice(1)&&k.charAt(0)=="5")&&(K(O,O.e+o+2,1),S=!O.times(O).eq(C));break}}return K(O,O.e+o+1,l,S)},i.toExponential=function(S,k){return S!=null&&(he(S,0,Je),S++),B(this,S,k,1)},i.toFixed=function(S,k){return S!=null&&(he(S,0,Je),S=S+this.e+1),B(this,S,k)},i.toFormat=function(S,k,O){var N,E=this;if(O==null)S!=null&&k&&typeof k=="object"?(O=k,k=null):S&&typeof S=="object"?(O=S,S=k=null):O=v;else if(typeof O!="object")throw Error(Ve+"Argument not an object: "+O);if(N=E.toFixed(S,k),E.c){var C,y=N.split("."),z=+O.groupSize,H=+O.secondaryGroupSize,G=O.groupSeparator||"",W=y[0],X=y[1],tt=E.s<0,q=tt?W.slice(1):W,Q=q.length;if(H&&(C=z,z=H,H=C,Q-=C),z>0&&Q>0){for(C=Q%z||z,W=q.substr(0,C);C<Q;C+=z)W+=G+q.substr(C,z);H>0&&(W+=G+q.slice(C)),tt&&(W="-"+W)}N=X?W+(O.decimalSeparator||"")+((H=+O.fractionGroupSize)?X.replace(new RegExp("\\d{"+H+"}\\B","g"),"$&"+(O.fractionGroupSeparator||"")):X):W}return(O.prefix||"")+N+(O.suffix||"")},i.toFraction=function(S){var k,O,N,E,C,y,z,H,G,W,X,tt,q=this,Q=q.c;if(S!=null&&(z=new A(S),!z.isInteger()&&(z.c||z.s!==1)||z.lt(s)))throw Error(Ve+"Argument "+(z.isInteger()?"out of range: ":"not an integer: ")+V(z));if(!Q)return new A(q);for(k=new A(s),G=O=new A(s),N=H=new A(s),tt=di(Q),C=k.e=tt.length-q.e-1,k.c[0]=ch[(y=C%Nt)<0?Nt+y:y],S=!S||z.comparedTo(k)>0?C>0?k:G:z,y=p,p=1/0,z=new A(tt),H.c[0]=0;W=t(z,k,0,1),E=O.plus(W.times(N)),E.comparedTo(S)!=1;)O=N,N=E,G=H.plus(W.times(E=G)),H=E,k=z.minus(W.times(E=k)),z=E;return E=t(S.minus(O),N,0,1),H=H.plus(E.times(G)),O=O.plus(E.times(N)),H.s=G.s=q.s,C=C*2,X=t(G,N,C,l).minus(q).abs().comparedTo(t(H,O,C,l).minus(q).abs())<1?[G,N]:[H,O],p=y,X},i.toNumber=function(){return+V(this)},i.toPrecision=function(S,k){return S!=null&&he(S,1,Je),B(this,S,k,2)},i.toString=function(S){var k,O=this,N=O.s,E=O.e;return E===null?N?(k="Infinity",N<0&&(k="-"+k)):k="NaN":(S==null?k=E<=u||E>=f?Wo(di(O.c),E):rn(di(O.c),E,"0"):S===10&&P?(O=K(new A(O),o+E+1,l),k=rn(di(O.c),O.e,"0")):(he(S,2,b.length,"Base"),k=e(rn(di(O.c),E,"0"),10,S,N,!0)),N<0&&O.c[0]&&(k="-"+k)),k},i.valueOf=i.toJSON=function(){return V(this)},i._isBigNumber=!0,i[Symbol.toStringTag]="BigNumber",i[Symbol.for("nodejs.util.inspect.custom")]=i.valueOf,h!=null&&A.set(h),A}function _i(h){var t=h|0;return h>0||h===t?t:t-1}function di(h){for(var t,e,r=1,i=h.length,s=h[0]+"";r<i;){for(t=h[r++]+"",e=Nt-t.length;e--;t="0"+t);s+=t}for(i=s.length;s.charCodeAt(--i)===48;);return s.slice(0,i+1||1)}function $n(h,t){var e,r,i=h.c,s=t.c,o=h.s,l=t.s,u=h.e,f=t.e;if(!o||!l)return null;if(e=i&&!i[0],r=s&&!s[0],e||r)return e?r?0:-l:o;if(o!=l)return o;if(e=o<0,r=u==f,!i||!s)return r?0:!i^e?1:-1;if(!r)return u>f^e?1:-1;for(l=(u=i.length)<(f=s.length)?u:f,o=0;o<l;o++)if(i[o]!=s[o])return i[o]>s[o]^e?1:-1;return u==f?0:u>f^e?1:-1}function he(h,t,e,r){if(h<t||h>e||h!==mi(h))throw Error(Ve+(r||"Argument")+(typeof h=="number"?h<t||h>e?" out of range: ":" not an integer: ":" not a primitive number: ")+String(h))}function Ho(h){var t=h.c.length-1;return _i(h.e/Nt)==t&&h.c[t]%2!=0}function Wo(h,t){return(h.length>1?h.charAt(0)+"."+h.slice(1):h)+(t<0?"e":"e+")+t}function rn(h,t,e){var r,i;if(t<0){for(i=e+".";++t;i+=e);h=i+h}else if(r=h.length,++t>r){for(i=e,t-=r;--t;i+=e);h+=i}else t<r&&(h=h.slice(0,t)+"."+h.slice(t));return h}var Fi=Uc(),Ap=class{constructor(h){zt(this,"key");zt(this,"left",null);zt(this,"right",null);this.key=h}},As=class extends Ap{constructor(h){super(h)}},Pp=class{constructor(){zt(this,"size",0);zt(this,"modificationCount",0);zt(this,"splayCount",0)}splay(h){const t=this.root;if(t==null)return this.compare(h,h),-1;let e=null,r=null,i=null,s=null,o=t;const l=this.compare;let u;for(;;)if(u=l(o.key,h),u>0){let f=o.left;if(f==null||(u=l(f.key,h),u>0&&(o.left=f.right,f.right=o,o=f,f=o.left,f==null)))break;e==null?r=o:e.left=o,e=o,o=f}else if(u<0){let f=o.right;if(f==null||(u=l(f.key,h),u<0&&(o.right=f.left,f.left=o,o=f,f=o.right,f==null)))break;i==null?s=o:i.right=o,i=o,o=f}else break;return i!=null&&(i.right=o.left,o.left=s),e!=null&&(e.left=o.right,o.right=r),this.root!==o&&(this.root=o,this.splayCount++),u}splayMin(h){let t=h,e=t.left;for(;e!=null;){const r=e;t.left=r.right,r.right=t,t=r,e=t.left}return t}splayMax(h){let t=h,e=t.right;for(;e!=null;){const r=e;t.right=r.left,r.left=t,t=r,e=t.right}return t}_delete(h){if(this.root==null||this.splay(h)!=0)return null;let e=this.root;const r=e,i=e.left;if(this.size--,i==null)this.root=e.right;else{const s=e.right;e=this.splayMax(i),e.right=s,this.root=e}return this.modificationCount++,r}addNewRoot(h,t){this.size++,this.modificationCount++;const e=this.root;if(e==null){this.root=h;return}t<0?(h.left=e,h.right=e.right,e.right=null):(h.right=e,h.left=e.left,e.left=null),this.root=h}_first(){const h=this.root;return h==null?null:(this.root=this.splayMin(h),this.root)}_last(){const h=this.root;return h==null?null:(this.root=this.splayMax(h),this.root)}clear(){this.root=null,this.size=0,this.modificationCount++}has(h){return this.validKey(h)&&this.splay(h)==0}defaultCompare(){return(h,t)=>h<t?-1:h>t?1:0}wrap(){return{getRoot:()=>this.root,setRoot:h=>{this.root=h},getSize:()=>this.size,getModificationCount:()=>this.modificationCount,getSplayCount:()=>this.splayCount,setSplayCount:h=>{this.splayCount=h},splay:h=>this.splay(h),has:h=>this.has(h)}}},ec,ic,Ta=class Ns extends Pp{constructor(e,r){super();zt(this,"root",null);zt(this,"compare");zt(this,"validKey");zt(this,ec,"[object Set]");this.compare=e??this.defaultCompare(),this.validKey=r??(i=>i!=null&&i!=null)}delete(e){return this.validKey(e)?this._delete(e)!=null:!1}deleteAll(e){for(const r of e)this.delete(r)}forEach(e){const r=this[Symbol.iterator]();let i;for(;i=r.next(),!i.done;)e(i.value,i.value,this)}add(e){const r=this.splay(e);return r!=0&&this.addNewRoot(new As(e),r),this}addAndReturn(e){const r=this.splay(e);return r!=0&&this.addNewRoot(new As(e),r),this.root.key}addAll(e){for(const r of e)this.add(r)}isEmpty(){return this.root==null}isNotEmpty(){return this.root!=null}single(){if(this.size==0)throw"Bad state: No element";if(this.size>1)throw"Bad state: Too many element";return this.root.key}first(){if(this.size==0)throw"Bad state: No element";return this._first().key}last(){if(this.size==0)throw"Bad state: No element";return this._last().key}lastBefore(e){if(e==null)throw"Invalid arguments(s)";if(this.root==null)return null;if(this.splay(e)<0)return this.root.key;let i=this.root.left;if(i==null)return null;let s=i.right;for(;s!=null;)i=s,s=i.right;return i.key}firstAfter(e){if(e==null)throw"Invalid arguments(s)";if(this.root==null)return null;if(this.splay(e)>0)return this.root.key;let i=this.root.right;if(i==null)return null;let s=i.left;for(;s!=null;)i=s,s=i.left;return i.key}retainAll(e){const r=new Ns(this.compare,this.validKey),i=this.modificationCount;for(const s of e){if(i!=this.modificationCount)throw"Concurrent modification during iteration.";this.validKey(s)&&this.splay(s)==0&&r.add(this.root.key)}r.size!=this.size&&(this.root=r.root,this.size=r.size,this.modificationCount++)}lookup(e){return!this.validKey(e)||this.splay(e)!=0?null:this.root.key}intersection(e){const r=new Ns(this.compare,this.validKey);for(const i of this)e.has(i)&&r.add(i);return r}difference(e){const r=new Ns(this.compare,this.validKey);for(const i of this)e.has(i)||r.add(i);return r}union(e){const r=this.clone();return r.addAll(e),r}clone(){const e=new Ns(this.compare,this.validKey);return e.size=this.size,e.root=this.copyNode(this.root),e}copyNode(e){if(e==null)return null;function r(s,o){let l,u;do{if(l=s.left,u=s.right,l!=null){const f=new As(l.key);o.left=f,r(l,f)}if(u!=null){const f=new As(u.key);o.right=f,s=u,o=f}}while(u!=null)}const i=new As(e.key);return r(e,i),i}toSet(){return this.clone()}entries(){return new zp(this.wrap())}keys(){return this[Symbol.iterator]()}values(){return this[Symbol.iterator]()}[(ic=Symbol.iterator,ec=Symbol.toStringTag,ic)](){return new Cp(this.wrap())}},Zc=class{constructor(h){zt(this,"tree");zt(this,"path",new Array);zt(this,"modificationCount",null);zt(this,"splayCount");this.tree=h,this.splayCount=h.getSplayCount()}[Symbol.iterator](){return this}next(){return this.moveNext()?{done:!1,value:this.current()}:{done:!0,value:null}}current(){if(!this.path.length)return null;const h=this.path[this.path.length-1];return this.getValue(h)}rebuildPath(h){this.path.splice(0,this.path.length),this.tree.splay(h),this.path.push(this.tree.getRoot()),this.splayCount=this.tree.getSplayCount()}findLeftMostDescendent(h){for(;h!=null;)this.path.push(h),h=h.left}moveNext(){if(this.modificationCount!=this.tree.getModificationCount()){if(this.modificationCount==null){this.modificationCount=this.tree.getModificationCount();let e=this.tree.getRoot();for(;e!=null;)this.path.push(e),e=e.left;return this.path.length>0}throw"Concurrent modification during iteration."}if(!this.path.length)return!1;this.splayCount!=this.tree.getSplayCount()&&this.rebuildPath(this.path[this.path.length-1].key);let h=this.path[this.path.length-1],t=h.right;if(t!=null){for(;t!=null;)this.path.push(t),t=t.left;return!0}for(this.path.pop();this.path.length&&this.path[this.path.length-1].right===h;)h=this.path.pop();return this.path.length>0}},Cp=class extends Zc{getValue(h){return h.key}},zp=class extends Zc{getValue(h){return[h.key,h.key]}},Gc=h=>()=>h,Vh=h=>{const t=h?(e,r)=>r.minus(e).abs().isLessThanOrEqualTo(h):Gc(!1);return(e,r)=>t(e,r)?0:e.comparedTo(r)};function Ip(h){const t=h?(e,r,i,s,o)=>e.exponentiatedBy(2).isLessThanOrEqualTo(s.minus(r).exponentiatedBy(2).plus(o.minus(i).exponentiatedBy(2)).times(h)):Gc(!1);return(e,r,i)=>{const s=e.x,o=e.y,l=i.x,u=i.y,f=o.minus(u).times(r.x.minus(l)).minus(s.minus(l).times(r.y.minus(u)));return t(f,s,o,l,u)?0:f.comparedTo(0)}}var Op=h=>h,Rp=h=>{if(h){const t=new Ta(Vh(h)),e=new Ta(Vh(h)),r=(s,o)=>o.addAndReturn(s),i=s=>({x:r(s.x,t),y:r(s.y,e)});return i({x:new Fi(0),y:new Fi(0)}),i}return Op},qh=h=>({set:t=>{cn=qh(t)},reset:()=>qh(h),compare:Vh(h),snap:Rp(h),orient:Ip(h)}),cn=qh(),Ps=(h,t)=>h.ll.x.isLessThanOrEqualTo(t.x)&&t.x.isLessThanOrEqualTo(h.ur.x)&&h.ll.y.isLessThanOrEqualTo(t.y)&&t.y.isLessThanOrEqualTo(h.ur.y),Yh=(h,t)=>{if(t.ur.x.isLessThan(h.ll.x)||h.ur.x.isLessThan(t.ll.x)||t.ur.y.isLessThan(h.ll.y)||h.ur.y.isLessThan(t.ll.y))return null;const e=h.ll.x.isLessThan(t.ll.x)?t.ll.x:h.ll.x,r=h.ur.x.isLessThan(t.ur.x)?h.ur.x:t.ur.x,i=h.ll.y.isLessThan(t.ll.y)?t.ll.y:h.ll.y,s=h.ur.y.isLessThan(t.ur.y)?h.ur.y:t.ur.y;return{ll:{x:e,y:i},ur:{x:r,y:s}}},ma=(h,t)=>h.x.times(t.y).minus(h.y.times(t.x)),Hc=(h,t)=>h.x.times(t.x).plus(h.y.times(t.y)),Sa=h=>Hc(h,h).sqrt(),Dp=(h,t,e)=>{const r={x:t.x.minus(h.x),y:t.y.minus(h.y)},i={x:e.x.minus(h.x),y:e.y.minus(h.y)};return ma(i,r).div(Sa(i)).div(Sa(r))},Bp=(h,t,e)=>{const r={x:t.x.minus(h.x),y:t.y.minus(h.y)},i={x:e.x.minus(h.x),y:e.y.minus(h.y)};return Hc(i,r).div(Sa(i)).div(Sa(r))},uu=(h,t,e)=>t.y.isZero()?null:{x:h.x.plus(t.x.div(t.y).times(e.minus(h.y))),y:e},cu=(h,t,e)=>t.x.isZero()?null:{x:e,y:h.y.plus(t.y.div(t.x).times(e.minus(h.x)))},Np=(h,t,e,r)=>{if(t.x.isZero())return cu(e,r,h.x);if(r.x.isZero())return cu(h,t,e.x);if(t.y.isZero())return uu(e,r,h.y);if(r.y.isZero())return uu(h,t,e.y);const i=ma(t,r);if(i.isZero())return null;const s={x:e.x.minus(h.x),y:e.y.minus(h.y)},o=ma(s,t).div(i),l=ma(s,r).div(i),u=h.x.plus(l.times(t.x)),f=e.x.plus(o.times(r.x)),d=h.y.plus(l.times(t.y)),p=e.y.plus(o.times(r.y)),g=u.plus(f).div(2),m=d.plus(p).div(2);return{x:g,y:m}},Ni=class Wc{constructor(t,e){zt(this,"point");zt(this,"isLeft");zt(this,"segment");zt(this,"otherSE");zt(this,"consumedBy");t.events===void 0?t.events=[this]:t.events.push(this),this.point=t,this.isLeft=e}static compare(t,e){const r=Wc.comparePoints(t.point,e.point);return r!==0?r:(t.point!==e.point&&t.link(e),t.isLeft!==e.isLeft?t.isLeft?1:-1:ka.compare(t.segment,e.segment))}static comparePoints(t,e){return t.x.isLessThan(e.x)?-1:t.x.isGreaterThan(e.x)?1:t.y.isLessThan(e.y)?-1:t.y.isGreaterThan(e.y)?1:0}link(t){if(t.point===this.point)throw new Error("Tried to link already linked events");const e=t.point.events;for(let r=0,i=e.length;r<i;r++){const s=e[r];this.point.events.push(s),s.point=this.point}this.checkForConsuming()}checkForConsuming(){const t=this.point.events.length;for(let e=0;e<t;e++){const r=this.point.events[e];if(r.segment.consumedBy===void 0)for(let i=e+1;i<t;i++){const s=this.point.events[i];s.consumedBy===void 0&&r.otherSE.point.events===s.otherSE.point.events&&r.segment.consume(s.segment)}}}getAvailableLinkedEvents(){const t=[];for(let e=0,r=this.point.events.length;e<r;e++){const i=this.point.events[e];i!==this&&!i.segment.ringOut&&i.segment.isInResult()&&t.push(i)}return t}getLeftmostComparator(t){const e=new Map,r=i=>{const s=i.otherSE;e.set(i,{sine:Dp(this.point,t.point,s.point),cosine:Bp(this.point,t.point,s.point)})};return(i,s)=>{e.has(i)||r(i),e.has(s)||r(s);const{sine:o,cosine:l}=e.get(i),{sine:u,cosine:f}=e.get(s);return o.isGreaterThanOrEqualTo(0)&&u.isGreaterThanOrEqualTo(0)?l.isLessThan(f)?1:l.isGreaterThan(f)?-1:0:o.isLessThan(0)&&u.isLessThan(0)?l.isLessThan(f)?-1:l.isGreaterThan(f)?1:0:u.isLessThan(o)?-1:u.isGreaterThan(o)?1:0}}},Fp=class jh{constructor(t){zt(this,"events");zt(this,"poly");zt(this,"_isExteriorRing");zt(this,"_enclosingRing");this.events=t;for(let e=0,r=t.length;e<r;e++)t[e].segment.ringOut=this;this.poly=null}static factory(t){const e=[];for(let r=0,i=t.length;r<i;r++){const s=t[r];if(!s.isInResult()||s.ringOut)continue;let o=null,l=s.leftSE,u=s.rightSE;const f=[l],d=l.point,p=[];for(;o=l,l=u,f.push(l),l.point!==d;)for(;;){const g=l.getAvailableLinkedEvents();if(g.length===0){const v=f[0].point,b=f[f.length-1].point;throw new Error(`Unable to complete output ring starting at [${v.x}, ${v.y}]. Last matching segment found ends at [${b.x}, ${b.y}].`)}if(g.length===1){u=g[0].otherSE;break}let m=null;for(let v=0,b=p.length;v<b;v++)if(p[v].point===l.point){m=v;break}if(m!==null){const v=p.splice(m)[0],b=f.splice(v.index);b.unshift(b[0].otherSE),e.push(new jh(b.reverse()));continue}p.push({index:f.length,point:l.point});const x=l.getLeftmostComparator(o);u=g.sort(x)[0].otherSE;break}e.push(new jh(f))}return e}getGeom(){let t=this.events[0].point;const e=[t];for(let f=1,d=this.events.length-1;f<d;f++){const p=this.events[f].point,g=this.events[f+1].point;cn.orient(p,t,g)!==0&&(e.push(p),t=p)}if(e.length===1)return null;const r=e[0],i=e[1];cn.orient(r,t,i)===0&&e.shift(),e.push(e[0]);const s=this.isExteriorRing()?1:-1,o=this.isExteriorRing()?0:e.length-1,l=this.isExteriorRing()?e.length:-1,u=[];for(let f=o;f!=l;f+=s)u.push([e[f].x.toNumber(),e[f].y.toNumber()]);return u}isExteriorRing(){if(this._isExteriorRing===void 0){const t=this.enclosingRing();this._isExteriorRing=t?!t.isExteriorRing():!0}return this._isExteriorRing}enclosingRing(){return this._enclosingRing===void 0&&(this._enclosingRing=this._calcEnclosingRing()),this._enclosingRing}_calcEnclosingRing(){var i,s;let t=this.events[0];for(let o=1,l=this.events.length;o<l;o++){const u=this.events[o];Ni.compare(t,u)>0&&(t=u)}let e=t.segment.prevInResult(),r=e?e.prevInResult():null;for(;;){if(!e)return null;if(!r)return e.ringOut;if(r.ringOut!==e.ringOut)return((i=r.ringOut)==null?void 0:i.enclosingRing())!==e.ringOut?e.ringOut:(s=e.ringOut)==null?void 0:s.enclosingRing();e=r.prevInResult(),r=e?e.prevInResult():null}}},fu=class{constructor(h){zt(this,"exteriorRing");zt(this,"interiorRings");this.exteriorRing=h,h.poly=this,this.interiorRings=[]}addInterior(h){this.interiorRings.push(h),h.poly=this}getGeom(){const h=this.exteriorRing.getGeom();if(h===null)return null;const t=[h];for(let e=0,r=this.interiorRings.length;e<r;e++){const i=this.interiorRings[e].getGeom();i!==null&&t.push(i)}return t}},Up=class{constructor(h){zt(this,"rings");zt(this,"polys");this.rings=h,this.polys=this._composePolys(h)}getGeom(){const h=[];for(let t=0,e=this.polys.length;t<e;t++){const r=this.polys[t].getGeom();r!==null&&h.push(r)}return h}_composePolys(h){var e;const t=[];for(let r=0,i=h.length;r<i;r++){const s=h[r];if(!s.poly)if(s.isExteriorRing())t.push(new fu(s));else{const o=s.enclosingRing();o!=null&&o.poly||t.push(new fu(o)),(e=o==null?void 0:o.poly)==null||e.addInterior(s)}}return t}},Zp=class{constructor(h,t=ka.compare){zt(this,"queue");zt(this,"tree");zt(this,"segments");this.queue=h,this.tree=new Ta(t),this.segments=[]}process(h){const t=h.segment,e=[];if(h.consumedBy)return h.isLeft?this.queue.delete(h.otherSE):this.tree.delete(t),e;h.isLeft&&this.tree.add(t);let r=t,i=t;do r=this.tree.lastBefore(r);while(r!=null&&r.consumedBy!=null);do i=this.tree.firstAfter(i);while(i!=null&&i.consumedBy!=null);if(h.isLeft){let s=null;if(r){const l=r.getIntersection(t);if(l!==null&&(t.isAnEndpoint(l)||(s=l),!r.isAnEndpoint(l))){const u=this._splitSafely(r,l);for(let f=0,d=u.length;f<d;f++)e.push(u[f])}}let o=null;if(i){const l=i.getIntersection(t);if(l!==null&&(t.isAnEndpoint(l)||(o=l),!i.isAnEndpoint(l))){const u=this._splitSafely(i,l);for(let f=0,d=u.length;f<d;f++)e.push(u[f])}}if(s!==null||o!==null){let l=null;s===null?l=o:o===null?l=s:l=Ni.comparePoints(s,o)<=0?s:o,this.queue.delete(t.rightSE),e.push(t.rightSE);const u=t.split(l);for(let f=0,d=u.length;f<d;f++)e.push(u[f])}e.length>0?(this.tree.delete(t),e.push(h)):(this.segments.push(t),t.prev=r)}else{if(r&&i){const s=r.getIntersection(i);if(s!==null){if(!r.isAnEndpoint(s)){const o=this._splitSafely(r,s);for(let l=0,u=o.length;l<u;l++)e.push(o[l])}if(!i.isAnEndpoint(s)){const o=this._splitSafely(i,s);for(let l=0,u=o.length;l<u;l++)e.push(o[l])}}}this.tree.delete(t)}return e}_splitSafely(h,t){this.tree.delete(h);const e=h.rightSE;this.queue.delete(e);const r=h.split(t);return r.push(e),h.consumedBy===void 0&&this.tree.add(h),r}},Gp=class{constructor(){zt(this,"type");zt(this,"numMultiPolys")}run(h,t,e){Fs.type=h;const r=[new pu(t,!0)];for(let f=0,d=e.length;f<d;f++)r.push(new pu(e[f],!1));if(Fs.numMultiPolys=r.length,Fs.type==="difference"){const f=r[0];let d=1;for(;d<r.length;)Yh(r[d].bbox,f.bbox)!==null?d++:r.splice(d,1)}if(Fs.type==="intersection")for(let f=0,d=r.length;f<d;f++){const p=r[f];for(let g=f+1,m=r.length;g<m;g++)if(Yh(p.bbox,r[g].bbox)===null)return[]}const i=new Ta(Ni.compare);for(let f=0,d=r.length;f<d;f++){const p=r[f].getSweepEvents();for(let g=0,m=p.length;g<m;g++)i.add(p[g])}const s=new Zp(i);let o=null;for(i.size!=0&&(o=i.first(),i.delete(o));o;){const f=s.process(o);for(let d=0,p=f.length;d<p;d++){const g=f[d];g.consumedBy===void 0&&i.add(g)}i.size!=0?(o=i.first(),i.delete(o)):o=null}cn.reset();const l=Fp.factory(s.segments);return new Up(l).getGeom()}},Fs=new Gp,Xh=Fs,Hp=0,ka=class _a{constructor(t,e,r,i){zt(this,"id");zt(this,"leftSE");zt(this,"rightSE");zt(this,"rings");zt(this,"windings");zt(this,"ringOut");zt(this,"consumedBy");zt(this,"prev");zt(this,"_prevInResult");zt(this,"_beforeState");zt(this,"_afterState");zt(this,"_isInResult");this.id=++Hp,this.leftSE=t,t.segment=this,t.otherSE=e,this.rightSE=e,e.segment=this,e.otherSE=t,this.rings=r,this.windings=i}static compare(t,e){const r=t.leftSE.point.x,i=e.leftSE.point.x,s=t.rightSE.point.x,o=e.rightSE.point.x;if(o.isLessThan(r))return 1;if(s.isLessThan(i))return-1;const l=t.leftSE.point.y,u=e.leftSE.point.y,f=t.rightSE.point.y,d=e.rightSE.point.y;if(r.isLessThan(i)){if(u.isLessThan(l)&&u.isLessThan(f))return 1;if(u.isGreaterThan(l)&&u.isGreaterThan(f))return-1;const p=t.comparePoint(e.leftSE.point);if(p<0)return 1;if(p>0)return-1;const g=e.comparePoint(t.rightSE.point);return g!==0?g:-1}if(r.isGreaterThan(i)){if(l.isLessThan(u)&&l.isLessThan(d))return-1;if(l.isGreaterThan(u)&&l.isGreaterThan(d))return 1;const p=e.comparePoint(t.leftSE.point);if(p!==0)return p;const g=t.comparePoint(e.rightSE.point);return g<0?1:g>0?-1:1}if(l.isLessThan(u))return-1;if(l.isGreaterThan(u))return 1;if(s.isLessThan(o)){const p=e.comparePoint(t.rightSE.point);if(p!==0)return p}if(s.isGreaterThan(o)){const p=t.comparePoint(e.rightSE.point);if(p<0)return 1;if(p>0)return-1}if(!s.eq(o)){const p=f.minus(l),g=s.minus(r),m=d.minus(u),x=o.minus(i);if(p.isGreaterThan(g)&&m.isLessThan(x))return 1;if(p.isLessThan(g)&&m.isGreaterThan(x))return-1}return s.isGreaterThan(o)?1:s.isLessThan(o)||f.isLessThan(d)?-1:f.isGreaterThan(d)?1:t.id<e.id?-1:t.id>e.id?1:0}static fromRing(t,e,r){let i,s,o;const l=Ni.comparePoints(t,e);if(l<0)i=t,s=e,o=1;else if(l>0)i=e,s=t,o=-1;else throw new Error(`Tried to create degenerate segment at [${t.x}, ${t.y}]`);const u=new Ni(i,!0),f=new Ni(s,!1);return new _a(u,f,[r],[o])}replaceRightSE(t){this.rightSE=t,this.rightSE.segment=this,this.rightSE.otherSE=this.leftSE,this.leftSE.otherSE=this.rightSE}bbox(){const t=this.leftSE.point.y,e=this.rightSE.point.y;return{ll:{x:this.leftSE.point.x,y:t.isLessThan(e)?t:e},ur:{x:this.rightSE.point.x,y:t.isGreaterThan(e)?t:e}}}vector(){return{x:this.rightSE.point.x.minus(this.leftSE.point.x),y:this.rightSE.point.y.minus(this.leftSE.point.y)}}isAnEndpoint(t){return t.x.eq(this.leftSE.point.x)&&t.y.eq(this.leftSE.point.y)||t.x.eq(this.rightSE.point.x)&&t.y.eq(this.rightSE.point.y)}comparePoint(t){return cn.orient(this.leftSE.point,t,this.rightSE.point)}getIntersection(t){const e=this.bbox(),r=t.bbox(),i=Yh(e,r);if(i===null)return null;const s=this.leftSE.point,o=this.rightSE.point,l=t.leftSE.point,u=t.rightSE.point,f=Ps(e,l)&&this.comparePoint(l)===0,d=Ps(r,s)&&t.comparePoint(s)===0,p=Ps(e,u)&&this.comparePoint(u)===0,g=Ps(r,o)&&t.comparePoint(o)===0;if(d&&f)return g&&!p?o:!g&&p?u:null;if(d)return p&&s.x.eq(u.x)&&s.y.eq(u.y)?null:s;if(f)return g&&o.x.eq(l.x)&&o.y.eq(l.y)?null:l;if(g&&p)return null;if(g)return o;if(p)return u;const m=Np(s,this.vector(),l,t.vector());return m===null||!Ps(i,m)?null:cn.snap(m)}split(t){const e=[],r=t.events!==void 0,i=new Ni(t,!0),s=new Ni(t,!1),o=this.rightSE;this.replaceRightSE(s),e.push(s),e.push(i);const l=new _a(i,o,this.rings.slice(),this.windings.slice());return Ni.comparePoints(l.leftSE.point,l.rightSE.point)>0&&l.swapEvents(),Ni.comparePoints(this.leftSE.point,this.rightSE.point)>0&&this.swapEvents(),r&&(i.checkForConsuming(),s.checkForConsuming()),e}swapEvents(){const t=this.rightSE;this.rightSE=this.leftSE,this.leftSE=t,this.leftSE.isLeft=!0,this.rightSE.isLeft=!1;for(let e=0,r=this.windings.length;e<r;e++)this.windings[e]*=-1}consume(t){let e=this,r=t;for(;e.consumedBy;)e=e.consumedBy;for(;r.consumedBy;)r=r.consumedBy;const i=_a.compare(e,r);if(i!==0){if(i>0){const s=e;e=r,r=s}if(e.prev===r){const s=e;e=r,r=s}for(let s=0,o=r.rings.length;s<o;s++){const l=r.rings[s],u=r.windings[s],f=e.rings.indexOf(l);f===-1?(e.rings.push(l),e.windings.push(u)):e.windings[f]+=u}r.rings=null,r.windings=null,r.consumedBy=e,r.leftSE.consumedBy=e.leftSE,r.rightSE.consumedBy=e.rightSE}}prevInResult(){return this._prevInResult!==void 0?this._prevInResult:(this.prev?this.prev.isInResult()?this._prevInResult=this.prev:this._prevInResult=this.prev.prevInResult():this._prevInResult=null,this._prevInResult)}beforeState(){if(this._beforeState!==void 0)return this._beforeState;if(!this.prev)this._beforeState={rings:[],windings:[],multiPolys:[]};else{const t=this.prev.consumedBy||this.prev;this._beforeState=t.afterState()}return this._beforeState}afterState(){if(this._afterState!==void 0)return this._afterState;const t=this.beforeState();this._afterState={rings:t.rings.slice(0),windings:t.windings.slice(0),multiPolys:[]};const e=this._afterState.rings,r=this._afterState.windings,i=this._afterState.multiPolys;for(let l=0,u=this.rings.length;l<u;l++){const f=this.rings[l],d=this.windings[l],p=e.indexOf(f);p===-1?(e.push(f),r.push(d)):r[p]+=d}const s=[],o=[];for(let l=0,u=e.length;l<u;l++){if(r[l]===0)continue;const f=e[l],d=f.poly;if(o.indexOf(d)===-1)if(f.isExterior)s.push(d);else{o.indexOf(d)===-1&&o.push(d);const p=s.indexOf(f.poly);p!==-1&&s.splice(p,1)}}for(let l=0,u=s.length;l<u;l++){const f=s[l].multiPoly;i.indexOf(f)===-1&&i.push(f)}return this._afterState}isInResult(){if(this.consumedBy)return!1;if(this._isInResult!==void 0)return this._isInResult;const t=this.beforeState().multiPolys,e=this.afterState().multiPolys;switch(Xh.type){case"union":{const r=t.length===0,i=e.length===0;this._isInResult=r!==i;break}case"intersection":{let r,i;t.length<e.length?(r=t.length,i=e.length):(r=e.length,i=t.length),this._isInResult=i===Xh.numMultiPolys&&r<i;break}case"xor":{const r=Math.abs(t.length-e.length);this._isInResult=r%2===1;break}case"difference":{const r=i=>i.length===1&&i[0].isSubject;this._isInResult=r(t)!==r(e);break}}return this._isInResult}},du=class{constructor(h,t,e){zt(this,"poly");zt(this,"isExterior");zt(this,"segments");zt(this,"bbox");if(!Array.isArray(h)||h.length===0)throw new Error("Input geometry is not a valid Polygon or MultiPolygon");if(this.poly=t,this.isExterior=e,this.segments=[],typeof h[0][0]!="number"||typeof h[0][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");const r=cn.snap({x:new Fi(h[0][0]),y:new Fi(h[0][1])});this.bbox={ll:{x:r.x,y:r.y},ur:{x:r.x,y:r.y}};let i=r;for(let s=1,o=h.length;s<o;s++){if(typeof h[s][0]!="number"||typeof h[s][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");const l=cn.snap({x:new Fi(h[s][0]),y:new Fi(h[s][1])});l.x.eq(i.x)&&l.y.eq(i.y)||(this.segments.push(ka.fromRing(i,l,this)),l.x.isLessThan(this.bbox.ll.x)&&(this.bbox.ll.x=l.x),l.y.isLessThan(this.bbox.ll.y)&&(this.bbox.ll.y=l.y),l.x.isGreaterThan(this.bbox.ur.x)&&(this.bbox.ur.x=l.x),l.y.isGreaterThan(this.bbox.ur.y)&&(this.bbox.ur.y=l.y),i=l)}(!r.x.eq(i.x)||!r.y.eq(i.y))&&this.segments.push(ka.fromRing(i,r,this))}getSweepEvents(){const h=[];for(let t=0,e=this.segments.length;t<e;t++){const r=this.segments[t];h.push(r.leftSE),h.push(r.rightSE)}return h}},Wp=class{constructor(h,t){zt(this,"multiPoly");zt(this,"exteriorRing");zt(this,"interiorRings");zt(this,"bbox");if(!Array.isArray(h))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");this.exteriorRing=new du(h[0],this,!0),this.bbox={ll:{x:this.exteriorRing.bbox.ll.x,y:this.exteriorRing.bbox.ll.y},ur:{x:this.exteriorRing.bbox.ur.x,y:this.exteriorRing.bbox.ur.y}},this.interiorRings=[];for(let e=1,r=h.length;e<r;e++){const i=new du(h[e],this,!1);i.bbox.ll.x.isLessThan(this.bbox.ll.x)&&(this.bbox.ll.x=i.bbox.ll.x),i.bbox.ll.y.isLessThan(this.bbox.ll.y)&&(this.bbox.ll.y=i.bbox.ll.y),i.bbox.ur.x.isGreaterThan(this.bbox.ur.x)&&(this.bbox.ur.x=i.bbox.ur.x),i.bbox.ur.y.isGreaterThan(this.bbox.ur.y)&&(this.bbox.ur.y=i.bbox.ur.y),this.interiorRings.push(i)}this.multiPoly=t}getSweepEvents(){const h=this.exteriorRing.getSweepEvents();for(let t=0,e=this.interiorRings.length;t<e;t++){const r=this.interiorRings[t].getSweepEvents();for(let i=0,s=r.length;i<s;i++)h.push(r[i])}return h}},pu=class{constructor(h,t){zt(this,"isSubject");zt(this,"polys");zt(this,"bbox");if(!Array.isArray(h))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");try{typeof h[0][0][0]=="number"&&(h=[h])}catch{}this.polys=[],this.bbox={ll:{x:new Fi(Number.POSITIVE_INFINITY),y:new Fi(Number.POSITIVE_INFINITY)},ur:{x:new Fi(Number.NEGATIVE_INFINITY),y:new Fi(Number.NEGATIVE_INFINITY)}};for(let e=0,r=h.length;e<r;e++){const i=new Wp(h[e],this);i.bbox.ll.x.isLessThan(this.bbox.ll.x)&&(this.bbox.ll.x=i.bbox.ll.x),i.bbox.ll.y.isLessThan(this.bbox.ll.y)&&(this.bbox.ll.y=i.bbox.ll.y),i.bbox.ur.x.isGreaterThan(this.bbox.ur.x)&&(this.bbox.ur.x=i.bbox.ur.x),i.bbox.ur.y.isGreaterThan(this.bbox.ur.y)&&(this.bbox.ur.y=i.bbox.ur.y),this.polys.push(i)}this.isSubject=t}getSweepEvents(){const h=[];for(let t=0,e=this.polys.length;t<e;t++){const r=this.polys[t].getSweepEvents();for(let i=0,s=r.length;i<s;i++)h.push(r[i])}return h}},Vp=(h,...t)=>Xh.run("intersection",h,t);cn.set;function qp(h,t,e={}){const r=Vr(h),i=Vr(t);i[0]+=i[0]-r[0]>180?-360:r[0]-i[0]>180?360:0;const s=Yp(r,i);return Mp(s,"meters",e.units)}function Yp(h,t,e){e=e===void 0?We:Number(e);const r=e,i=h[1]*Math.PI/180,s=t[1]*Math.PI/180,o=s-i;let l=Math.abs(t[0]-h[0])*Math.PI/180;l>Math.PI&&(l-=2*Math.PI);const u=Math.log(Math.tan(s/2+Math.PI/4)/Math.tan(i/2+Math.PI/4)),f=Math.abs(u)>1e-11?o/u:Math.cos(i);return Math.sqrt(o*o+f*f*l*l)*r}function jp(h,t={}){const e=[];if(Tp(h,i=>{e.push(i.coordinates)}),e.length<2)throw new Error("Must specify at least 2 geometries");const r=Vp(e[0],...e.slice(1));return r.length===0?null:r.length===1?Na(r[0],t.properties):Nc(r,t.properties)}/**
 * @license
 * Copyright 2010-2024 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const yl="172",Jh=0,Xp=1,Vc=2,mu=1,_u=100,gu=204,yu=205,vu=3,Jp=0,qc=300,$h=1e3,Us=1001,Kh=1002,$p=1003,Kp=1004,Qp=1005,Yc=1006,tm=1007,jc=1008,em=1009,im=1015,Xc=1023,nm=2300,rm=2301,sm=0,vl="",gi="srgb",xu="srgb-linear",wu="linear",fh="srgb",zr=7680,bu=519,Lu=35044,Vo=2e3,Mu=2001;class Fa{addEventListener(t,e){this._listeners===void 0&&(this._listeners={});const r=this._listeners;r[t]===void 0&&(r[t]=[]),r[t].indexOf(e)===-1&&r[t].push(e)}hasEventListener(t,e){if(this._listeners===void 0)return!1;const r=this._listeners;return r[t]!==void 0&&r[t].indexOf(e)!==-1}removeEventListener(t,e){if(this._listeners===void 0)return;const i=this._listeners[t];if(i!==void 0){const s=i.indexOf(e);s!==-1&&i.splice(s,1)}}dispatchEvent(t){if(this._listeners===void 0)return;const r=this._listeners[t.type];if(r!==void 0){t.target=this;const i=r.slice(0);for(let s=0,o=i.length;s<o;s++)i[s].call(this,t);t.target=null}}}const ze=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let Eu=1234567;const Jc=Math.PI/180,$c=180/Math.PI;function ur(){const h=Math.random()*4294967295|0,t=Math.random()*4294967295|0,e=Math.random()*4294967295|0,r=Math.random()*4294967295|0;return(ze[h&255]+ze[h>>8&255]+ze[h>>16&255]+ze[h>>24&255]+"-"+ze[t&255]+ze[t>>8&255]+"-"+ze[t>>16&15|64]+ze[t>>24&255]+"-"+ze[e&63|128]+ze[e>>8&255]+"-"+ze[e>>16&255]+ze[e>>24&255]+ze[r&255]+ze[r>>8&255]+ze[r>>16&255]+ze[r>>24&255]).toLowerCase()}function Ht(h,t,e){return Math.max(t,Math.min(e,h))}function xl(h,t){return(h%t+t)%t}function om(h,t,e,r,i){return r+(h-t)*(i-r)/(e-t)}function am(h,t,e){return h!==t?(e-h)/(t-h):0}function Ws(h,t,e){return(1-e)*h+e*t}function hm(h,t,e,r){return Ws(h,t,1-Math.exp(-e*r))}function lm(h,t=1){return t-Math.abs(xl(h,t*2)-t)}function um(h,t,e){return h<=t?0:h>=e?1:(h=(h-t)/(e-t),h*h*(3-2*h))}function cm(h,t,e){return h<=t?0:h>=e?1:(h=(h-t)/(e-t),h*h*h*(h*(h*6-15)+10))}function fm(h,t){return h+Math.floor(Math.random()*(t-h+1))}function dm(h,t){return h+Math.random()*(t-h)}function pm(h){return h*(.5-Math.random())}function mm(h){h!==void 0&&(Eu=h);let t=Eu+=1831565813;return t=Math.imul(t^t>>>15,t|1),t^=t+Math.imul(t^t>>>7,t|61),((t^t>>>14)>>>0)/4294967296}function _m(h){return h*Jc}function gm(h){return h*$c}function ym(h){return(h&h-1)===0&&h!==0}function vm(h){return Math.pow(2,Math.ceil(Math.log(h)/Math.LN2))}function xm(h){return Math.pow(2,Math.floor(Math.log(h)/Math.LN2))}function wm(h,t,e,r,i){const s=Math.cos,o=Math.sin,l=s(e/2),u=o(e/2),f=s((t+r)/2),d=o((t+r)/2),p=s((t-r)/2),g=o((t-r)/2),m=s((r-t)/2),x=o((r-t)/2);switch(i){case"XYX":h.set(l*d,u*p,u*g,l*f);break;case"YZY":h.set(u*g,l*d,u*p,l*f);break;case"ZXZ":h.set(u*p,u*g,l*d,l*f);break;case"XZX":h.set(l*d,u*x,u*m,l*f);break;case"YXY":h.set(u*m,l*d,u*x,l*f);break;case"ZYZ":h.set(u*x,u*m,l*d,l*f);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+i)}}function Wr(h,t){switch(t.constructor){case Float32Array:return h;case Uint32Array:return h/4294967295;case Uint16Array:return h/65535;case Uint8Array:return h/255;case Int32Array:return Math.max(h/2147483647,-1);case Int16Array:return Math.max(h/32767,-1);case Int8Array:return Math.max(h/127,-1);default:throw new Error("Invalid component type.")}}function Be(h,t){switch(t.constructor){case Float32Array:return h;case Uint32Array:return Math.round(h*4294967295);case Uint16Array:return Math.round(h*65535);case Uint8Array:return Math.round(h*255);case Int32Array:return Math.round(h*2147483647);case Int16Array:return Math.round(h*32767);case Int8Array:return Math.round(h*127);default:throw new Error("Invalid component type.")}}const Qh={DEG2RAD:Jc,RAD2DEG:$c,generateUUID:ur,clamp:Ht,euclideanModulo:xl,mapLinear:om,inverseLerp:am,lerp:Ws,damp:hm,pingpong:lm,smoothstep:um,smootherstep:cm,randInt:fm,randFloat:dm,randFloatSpread:pm,seededRandom:mm,degToRad:_m,radToDeg:gm,isPowerOfTwo:ym,ceilPowerOfTwo:vm,floorPowerOfTwo:xm,setQuaternionFromProperEuler:wm,normalize:Be,denormalize:Wr};class Pt{constructor(t=0,e=0){Pt.prototype.isVector2=!0,this.x=t,this.y=e}get width(){return this.x}set width(t){this.x=t}get height(){return this.y}set height(t){this.y=t}set(t,e){return this.x=t,this.y=e,this}setScalar(t){return this.x=t,this.y=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setComponent(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y)}copy(t){return this.x=t.x,this.y=t.y,this}add(t){return this.x+=t.x,this.y+=t.y,this}addScalar(t){return this.x+=t,this.y+=t,this}addVectors(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this}addScaledVector(t,e){return this.x+=t.x*e,this.y+=t.y*e,this}sub(t){return this.x-=t.x,this.y-=t.y,this}subScalar(t){return this.x-=t,this.y-=t,this}subVectors(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this}multiply(t){return this.x*=t.x,this.y*=t.y,this}multiplyScalar(t){return this.x*=t,this.y*=t,this}divide(t){return this.x/=t.x,this.y/=t.y,this}divideScalar(t){return this.multiplyScalar(1/t)}applyMatrix3(t){const e=this.x,r=this.y,i=t.elements;return this.x=i[0]*e+i[3]*r+i[6],this.y=i[1]*e+i[4]*r+i[7],this}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this}clamp(t,e){return this.x=Ht(this.x,t.x,e.x),this.y=Ht(this.y,t.y,e.y),this}clampScalar(t,e){return this.x=Ht(this.x,t,e),this.y=Ht(this.y,t,e),this}clampLength(t,e){const r=this.length();return this.divideScalar(r||1).multiplyScalar(Ht(r,t,e))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(t){return this.x*t.x+this.y*t.y}cross(t){return this.x*t.y-this.y*t.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(t){const e=Math.sqrt(this.lengthSq()*t.lengthSq());if(e===0)return Math.PI/2;const r=this.dot(t)/e;return Math.acos(Ht(r,-1,1))}distanceTo(t){return Math.sqrt(this.distanceToSquared(t))}distanceToSquared(t){const e=this.x-t.x,r=this.y-t.y;return e*e+r*r}manhattanDistanceTo(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this}lerpVectors(t,e,r){return this.x=t.x+(e.x-t.x)*r,this.y=t.y+(e.y-t.y)*r,this}equals(t){return t.x===this.x&&t.y===this.y}fromArray(t,e=0){return this.x=t[e],this.y=t[e+1],this}toArray(t=[],e=0){return t[e]=this.x,t[e+1]=this.y,t}fromBufferAttribute(t,e){return this.x=t.getX(e),this.y=t.getY(e),this}rotateAround(t,e){const r=Math.cos(e),i=Math.sin(e),s=this.x-t.x,o=this.y-t.y;return this.x=s*r-o*i+t.x,this.y=s*i+o*r+t.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class Bn{constructor(t,e,r,i,s,o,l,u,f){Bn.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],t!==void 0&&this.set(t,e,r,i,s,o,l,u,f)}set(t,e,r,i,s,o,l,u,f){const d=this.elements;return d[0]=t,d[1]=i,d[2]=l,d[3]=e,d[4]=s,d[5]=u,d[6]=r,d[7]=o,d[8]=f,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(t){const e=this.elements,r=t.elements;return e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=r[3],e[4]=r[4],e[5]=r[5],e[6]=r[6],e[7]=r[7],e[8]=r[8],this}extractBasis(t,e,r){return t.setFromMatrix3Column(this,0),e.setFromMatrix3Column(this,1),r.setFromMatrix3Column(this,2),this}setFromMatrix4(t){const e=t.elements;return this.set(e[0],e[4],e[8],e[1],e[5],e[9],e[2],e[6],e[10]),this}multiply(t){return this.multiplyMatrices(this,t)}premultiply(t){return this.multiplyMatrices(t,this)}multiplyMatrices(t,e){const r=t.elements,i=e.elements,s=this.elements,o=r[0],l=r[3],u=r[6],f=r[1],d=r[4],p=r[7],g=r[2],m=r[5],x=r[8],v=i[0],b=i[3],P=i[6],A=i[1],B=i[4],Z=i[7],I=i[2],K=i[5],V=i[8];return s[0]=o*v+l*A+u*I,s[3]=o*b+l*B+u*K,s[6]=o*P+l*Z+u*V,s[1]=f*v+d*A+p*I,s[4]=f*b+d*B+p*K,s[7]=f*P+d*Z+p*V,s[2]=g*v+m*A+x*I,s[5]=g*b+m*B+x*K,s[8]=g*P+m*Z+x*V,this}multiplyScalar(t){const e=this.elements;return e[0]*=t,e[3]*=t,e[6]*=t,e[1]*=t,e[4]*=t,e[7]*=t,e[2]*=t,e[5]*=t,e[8]*=t,this}determinant(){const t=this.elements,e=t[0],r=t[1],i=t[2],s=t[3],o=t[4],l=t[5],u=t[6],f=t[7],d=t[8];return e*o*d-e*l*f-r*s*d+r*l*u+i*s*f-i*o*u}invert(){const t=this.elements,e=t[0],r=t[1],i=t[2],s=t[3],o=t[4],l=t[5],u=t[6],f=t[7],d=t[8],p=d*o-l*f,g=l*u-d*s,m=f*s-o*u,x=e*p+r*g+i*m;if(x===0)return this.set(0,0,0,0,0,0,0,0,0);const v=1/x;return t[0]=p*v,t[1]=(i*f-d*r)*v,t[2]=(l*r-i*o)*v,t[3]=g*v,t[4]=(d*e-i*u)*v,t[5]=(i*s-l*e)*v,t[6]=m*v,t[7]=(r*u-f*e)*v,t[8]=(o*e-r*s)*v,this}transpose(){let t;const e=this.elements;return t=e[1],e[1]=e[3],e[3]=t,t=e[2],e[2]=e[6],e[6]=t,t=e[5],e[5]=e[7],e[7]=t,this}getNormalMatrix(t){return this.setFromMatrix4(t).invert().transpose()}transposeIntoArray(t){const e=this.elements;return t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8],this}setUvTransform(t,e,r,i,s,o,l){const u=Math.cos(s),f=Math.sin(s);return this.set(r*u,r*f,-r*(u*o+f*l)+o+t,-i*f,i*u,-i*(-f*o+u*l)+l+e,0,0,1),this}scale(t,e){return this.premultiply(dh.makeScale(t,e)),this}rotate(t){return this.premultiply(dh.makeRotation(-t)),this}translate(t,e){return this.premultiply(dh.makeTranslation(t,e)),this}makeTranslation(t,e){return t.isVector2?this.set(1,0,t.x,0,1,t.y,0,0,1):this.set(1,0,t,0,1,e,0,0,1),this}makeRotation(t){const e=Math.cos(t),r=Math.sin(t);return this.set(e,-r,0,r,e,0,0,0,1),this}makeScale(t,e){return this.set(t,0,0,0,e,0,0,0,1),this}equals(t){const e=this.elements,r=t.elements;for(let i=0;i<9;i++)if(e[i]!==r[i])return!1;return!0}fromArray(t,e=0){for(let r=0;r<9;r++)this.elements[r]=t[r+e];return this}toArray(t=[],e=0){const r=this.elements;return t[e]=r[0],t[e+1]=r[1],t[e+2]=r[2],t[e+3]=r[3],t[e+4]=r[4],t[e+5]=r[5],t[e+6]=r[6],t[e+7]=r[7],t[e+8]=r[8],t}clone(){return new this.constructor().fromArray(this.elements)}}const dh=new Bn;function bm(h){for(let t=h.length-1;t>=0;--t)if(h[t]>=65535)return!0;return!1}function Tu(h){return document.createElementNS("http://www.w3.org/1999/xhtml",h)}const Su=new Bn().set(.4123908,.3575843,.1804808,.212639,.7151687,.0721923,.0193308,.1191948,.9505322),ku=new Bn().set(3.2409699,-1.5373832,-.4986108,-.9692436,1.8759675,.0415551,.0556301,-.203977,1.0569715);function Lm(){const h={enabled:!0,workingColorSpace:xu,spaces:{},convert:function(i,s,o){return this.enabled===!1||s===o||!s||!o||(this.spaces[s].transfer===fh&&(i.r=un(i.r),i.g=un(i.g),i.b=un(i.b)),this.spaces[s].primaries!==this.spaces[o].primaries&&(i.applyMatrix3(this.spaces[s].toXYZ),i.applyMatrix3(this.spaces[o].fromXYZ)),this.spaces[o].transfer===fh&&(i.r=$r(i.r),i.g=$r(i.g),i.b=$r(i.b))),i},fromWorkingColorSpace:function(i,s){return this.convert(i,this.workingColorSpace,s)},toWorkingColorSpace:function(i,s){return this.convert(i,s,this.workingColorSpace)},getPrimaries:function(i){return this.spaces[i].primaries},getTransfer:function(i){return i===vl?wu:this.spaces[i].transfer},getLuminanceCoefficients:function(i,s=this.workingColorSpace){return i.fromArray(this.spaces[s].luminanceCoefficients)},define:function(i){Object.assign(this.spaces,i)},_getMatrix:function(i,s,o){return i.copy(this.spaces[s].toXYZ).multiply(this.spaces[o].fromXYZ)},_getDrawingBufferColorSpace:function(i){return this.spaces[i].outputColorSpaceConfig.drawingBufferColorSpace},_getUnpackColorSpace:function(i=this.workingColorSpace){return this.spaces[i].workingColorSpaceConfig.unpackColorSpace}},t=[.64,.33,.3,.6,.15,.06],e=[.2126,.7152,.0722],r=[.3127,.329];return h.define({[xu]:{primaries:t,whitePoint:r,transfer:wu,toXYZ:Su,fromXYZ:ku,luminanceCoefficients:e,workingColorSpaceConfig:{unpackColorSpace:gi},outputColorSpaceConfig:{drawingBufferColorSpace:gi}},[gi]:{primaries:t,whitePoint:r,transfer:fh,toXYZ:Su,fromXYZ:ku,luminanceCoefficients:e,outputColorSpaceConfig:{drawingBufferColorSpace:gi}}}),h}const Ei=Lm();function un(h){return h<.04045?h*.0773993808:Math.pow(h*.9478672986+.0521327014,2.4)}function $r(h){return h<.0031308?h*12.92:1.055*Math.pow(h,.41666)-.055}let Ir;class Mm{static getDataURL(t){if(/^data:/i.test(t.src)||typeof HTMLCanvasElement>"u")return t.src;let e;if(t instanceof HTMLCanvasElement)e=t;else{Ir===void 0&&(Ir=Tu("canvas")),Ir.width=t.width,Ir.height=t.height;const r=Ir.getContext("2d");t instanceof ImageData?r.putImageData(t,0,0):r.drawImage(t,0,0,t.width,t.height),e=Ir}return e.width>2048||e.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",t),e.toDataURL("image/jpeg",.6)):e.toDataURL("image/png")}static sRGBToLinear(t){if(typeof HTMLImageElement<"u"&&t instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&t instanceof ImageBitmap){const e=Tu("canvas");e.width=t.width,e.height=t.height;const r=e.getContext("2d");r.drawImage(t,0,0,t.width,t.height);const i=r.getImageData(0,0,t.width,t.height),s=i.data;for(let o=0;o<s.length;o++)s[o]=un(s[o]/255)*255;return r.putImageData(i,0,0),e}else if(t.data){const e=t.data.slice(0);for(let r=0;r<e.length;r++)e instanceof Uint8Array||e instanceof Uint8ClampedArray?e[r]=Math.floor(un(e[r]/255)*255):e[r]=un(e[r]);return{data:e,width:t.width,height:t.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),t}}let Em=0;class Kc{constructor(t=null){this.isSource=!0,Object.defineProperty(this,"id",{value:Em++}),this.uuid=ur(),this.data=t,this.dataReady=!0,this.version=0}set needsUpdate(t){t===!0&&this.version++}toJSON(t){const e=t===void 0||typeof t=="string";if(!e&&t.images[this.uuid]!==void 0)return t.images[this.uuid];const r={uuid:this.uuid,url:""},i=this.data;if(i!==null){let s;if(Array.isArray(i)){s=[];for(let o=0,l=i.length;o<l;o++)i[o].isDataTexture?s.push(ph(i[o].image)):s.push(ph(i[o]))}else s=ph(i);r.url=s}return e||(t.images[this.uuid]=r),r}}function ph(h){return typeof HTMLImageElement<"u"&&h instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&h instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&h instanceof ImageBitmap?Mm.getDataURL(h):h.data?{data:Array.from(h.data),width:h.width,height:h.height,type:h.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let Tm=0;class Cn extends Fa{constructor(t=Cn.DEFAULT_IMAGE,e=Cn.DEFAULT_MAPPING,r=Us,i=Us,s=Yc,o=jc,l=Xc,u=em,f=Cn.DEFAULT_ANISOTROPY,d=vl){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:Tm++}),this.uuid=ur(),this.name="",this.source=new Kc(t),this.mipmaps=[],this.mapping=e,this.channel=0,this.wrapS=r,this.wrapT=i,this.magFilter=s,this.minFilter=o,this.anisotropy=f,this.format=l,this.internalFormat=null,this.type=u,this.offset=new Pt(0,0),this.repeat=new Pt(1,1),this.center=new Pt(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Bn,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.colorSpace=d,this.userData={},this.version=0,this.onUpdate=null,this.renderTarget=null,this.isRenderTargetTexture=!1,this.pmremVersion=0}get image(){return this.source.data}set image(t=null){this.source.data=t}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(t){return this.name=t.name,this.source=t.source,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.channel=t.channel,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.internalFormat=t.internalFormat,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.center.copy(t.center),this.rotation=t.rotation,this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrix.copy(t.matrix),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.colorSpace=t.colorSpace,this.renderTarget=t.renderTarget,this.isRenderTargetTexture=t.isRenderTargetTexture,this.userData=JSON.parse(JSON.stringify(t.userData)),this.needsUpdate=!0,this}toJSON(t){const e=t===void 0||typeof t=="string";if(!e&&t.textures[this.uuid]!==void 0)return t.textures[this.uuid];const r={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(t).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(r.userData=this.userData),e||(t.textures[this.uuid]=r),r}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(t){if(this.mapping!==qc)return t;if(t.applyMatrix3(this.matrix),t.x<0||t.x>1)switch(this.wrapS){case $h:t.x=t.x-Math.floor(t.x);break;case Us:t.x=t.x<0?0:1;break;case Kh:Math.abs(Math.floor(t.x)%2)===1?t.x=Math.ceil(t.x)-t.x:t.x=t.x-Math.floor(t.x);break}if(t.y<0||t.y>1)switch(this.wrapT){case $h:t.y=t.y-Math.floor(t.y);break;case Us:t.y=t.y<0?0:1;break;case Kh:Math.abs(Math.floor(t.y)%2)===1?t.y=Math.ceil(t.y)-t.y:t.y=t.y-Math.floor(t.y);break}return this.flipY&&(t.y=1-t.y),t}set needsUpdate(t){t===!0&&(this.version++,this.source.needsUpdate=!0)}set needsPMREMUpdate(t){t===!0&&this.pmremVersion++}}Cn.DEFAULT_IMAGE=null;Cn.DEFAULT_MAPPING=qc;Cn.DEFAULT_ANISOTROPY=1;class io{constructor(t=0,e=0,r=0,i=1){io.prototype.isVector4=!0,this.x=t,this.y=e,this.z=r,this.w=i}get width(){return this.z}set width(t){this.z=t}get height(){return this.w}set height(t){this.w=t}set(t,e,r,i){return this.x=t,this.y=e,this.z=r,this.w=i,this}setScalar(t){return this.x=t,this.y=t,this.z=t,this.w=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setZ(t){return this.z=t,this}setW(t){return this.w=t,this}setComponent(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;case 3:this.w=e;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=t.w!==void 0?t.w:1,this}add(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this}addScalar(t){return this.x+=t,this.y+=t,this.z+=t,this.w+=t,this}addVectors(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this.w=t.w+e.w,this}addScaledVector(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this.w+=t.w*e,this}sub(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this}subScalar(t){return this.x-=t,this.y-=t,this.z-=t,this.w-=t,this}subVectors(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this.w=t.w-e.w,this}multiply(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z,this.w*=t.w,this}multiplyScalar(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this}applyMatrix4(t){const e=this.x,r=this.y,i=this.z,s=this.w,o=t.elements;return this.x=o[0]*e+o[4]*r+o[8]*i+o[12]*s,this.y=o[1]*e+o[5]*r+o[9]*i+o[13]*s,this.z=o[2]*e+o[6]*r+o[10]*i+o[14]*s,this.w=o[3]*e+o[7]*r+o[11]*i+o[15]*s,this}divide(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this.w/=t.w,this}divideScalar(t){return this.multiplyScalar(1/t)}setAxisAngleFromQuaternion(t){this.w=2*Math.acos(t.w);const e=Math.sqrt(1-t.w*t.w);return e<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=t.x/e,this.y=t.y/e,this.z=t.z/e),this}setAxisAngleFromRotationMatrix(t){let e,r,i,s;const u=t.elements,f=u[0],d=u[4],p=u[8],g=u[1],m=u[5],x=u[9],v=u[2],b=u[6],P=u[10];if(Math.abs(d-g)<.01&&Math.abs(p-v)<.01&&Math.abs(x-b)<.01){if(Math.abs(d+g)<.1&&Math.abs(p+v)<.1&&Math.abs(x+b)<.1&&Math.abs(f+m+P-3)<.1)return this.set(1,0,0,0),this;e=Math.PI;const B=(f+1)/2,Z=(m+1)/2,I=(P+1)/2,K=(d+g)/4,V=(p+v)/4,S=(x+b)/4;return B>Z&&B>I?B<.01?(r=0,i=.707106781,s=.707106781):(r=Math.sqrt(B),i=K/r,s=V/r):Z>I?Z<.01?(r=.707106781,i=0,s=.707106781):(i=Math.sqrt(Z),r=K/i,s=S/i):I<.01?(r=.707106781,i=.707106781,s=0):(s=Math.sqrt(I),r=V/s,i=S/s),this.set(r,i,s,e),this}let A=Math.sqrt((b-x)*(b-x)+(p-v)*(p-v)+(g-d)*(g-d));return Math.abs(A)<.001&&(A=1),this.x=(b-x)/A,this.y=(p-v)/A,this.z=(g-d)/A,this.w=Math.acos((f+m+P-1)/2),this}setFromMatrixPosition(t){const e=t.elements;return this.x=e[12],this.y=e[13],this.z=e[14],this.w=e[15],this}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this.w=Math.min(this.w,t.w),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this.w=Math.max(this.w,t.w),this}clamp(t,e){return this.x=Ht(this.x,t.x,e.x),this.y=Ht(this.y,t.y,e.y),this.z=Ht(this.z,t.z,e.z),this.w=Ht(this.w,t.w,e.w),this}clampScalar(t,e){return this.x=Ht(this.x,t,e),this.y=Ht(this.y,t,e),this.z=Ht(this.z,t,e),this.w=Ht(this.w,t,e),this}clampLength(t,e){const r=this.length();return this.divideScalar(r||1).multiplyScalar(Ht(r,t,e))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this.w+=(t.w-this.w)*e,this}lerpVectors(t,e,r){return this.x=t.x+(e.x-t.x)*r,this.y=t.y+(e.y-t.y)*r,this.z=t.z+(e.z-t.z)*r,this.w=t.w+(e.w-t.w)*r,this}equals(t){return t.x===this.x&&t.y===this.y&&t.z===this.z&&t.w===this.w}fromArray(t,e=0){return this.x=t[e],this.y=t[e+1],this.z=t[e+2],this.w=t[e+3],this}toArray(t=[],e=0){return t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t[e+3]=this.w,t}fromBufferAttribute(t,e){return this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this.w=t.getW(e),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class ns{constructor(t=0,e=0,r=0,i=1){this.isQuaternion=!0,this._x=t,this._y=e,this._z=r,this._w=i}static slerpFlat(t,e,r,i,s,o,l){let u=r[i+0],f=r[i+1],d=r[i+2],p=r[i+3];const g=s[o+0],m=s[o+1],x=s[o+2],v=s[o+3];if(l===0){t[e+0]=u,t[e+1]=f,t[e+2]=d,t[e+3]=p;return}if(l===1){t[e+0]=g,t[e+1]=m,t[e+2]=x,t[e+3]=v;return}if(p!==v||u!==g||f!==m||d!==x){let b=1-l;const P=u*g+f*m+d*x+p*v,A=P>=0?1:-1,B=1-P*P;if(B>Number.EPSILON){const I=Math.sqrt(B),K=Math.atan2(I,P*A);b=Math.sin(b*K)/I,l=Math.sin(l*K)/I}const Z=l*A;if(u=u*b+g*Z,f=f*b+m*Z,d=d*b+x*Z,p=p*b+v*Z,b===1-l){const I=1/Math.sqrt(u*u+f*f+d*d+p*p);u*=I,f*=I,d*=I,p*=I}}t[e]=u,t[e+1]=f,t[e+2]=d,t[e+3]=p}static multiplyQuaternionsFlat(t,e,r,i,s,o){const l=r[i],u=r[i+1],f=r[i+2],d=r[i+3],p=s[o],g=s[o+1],m=s[o+2],x=s[o+3];return t[e]=l*x+d*p+u*m-f*g,t[e+1]=u*x+d*g+f*p-l*m,t[e+2]=f*x+d*m+l*g-u*p,t[e+3]=d*x-l*p-u*g-f*m,t}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get w(){return this._w}set w(t){this._w=t,this._onChangeCallback()}set(t,e,r,i){return this._x=t,this._y=e,this._z=r,this._w=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(t){return this._x=t.x,this._y=t.y,this._z=t.z,this._w=t.w,this._onChangeCallback(),this}setFromEuler(t,e=!0){const r=t._x,i=t._y,s=t._z,o=t._order,l=Math.cos,u=Math.sin,f=l(r/2),d=l(i/2),p=l(s/2),g=u(r/2),m=u(i/2),x=u(s/2);switch(o){case"XYZ":this._x=g*d*p+f*m*x,this._y=f*m*p-g*d*x,this._z=f*d*x+g*m*p,this._w=f*d*p-g*m*x;break;case"YXZ":this._x=g*d*p+f*m*x,this._y=f*m*p-g*d*x,this._z=f*d*x-g*m*p,this._w=f*d*p+g*m*x;break;case"ZXY":this._x=g*d*p-f*m*x,this._y=f*m*p+g*d*x,this._z=f*d*x+g*m*p,this._w=f*d*p-g*m*x;break;case"ZYX":this._x=g*d*p-f*m*x,this._y=f*m*p+g*d*x,this._z=f*d*x-g*m*p,this._w=f*d*p+g*m*x;break;case"YZX":this._x=g*d*p+f*m*x,this._y=f*m*p+g*d*x,this._z=f*d*x-g*m*p,this._w=f*d*p-g*m*x;break;case"XZY":this._x=g*d*p-f*m*x,this._y=f*m*p-g*d*x,this._z=f*d*x+g*m*p,this._w=f*d*p+g*m*x;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+o)}return e===!0&&this._onChangeCallback(),this}setFromAxisAngle(t,e){const r=e/2,i=Math.sin(r);return this._x=t.x*i,this._y=t.y*i,this._z=t.z*i,this._w=Math.cos(r),this._onChangeCallback(),this}setFromRotationMatrix(t){const e=t.elements,r=e[0],i=e[4],s=e[8],o=e[1],l=e[5],u=e[9],f=e[2],d=e[6],p=e[10],g=r+l+p;if(g>0){const m=.5/Math.sqrt(g+1);this._w=.25/m,this._x=(d-u)*m,this._y=(s-f)*m,this._z=(o-i)*m}else if(r>l&&r>p){const m=2*Math.sqrt(1+r-l-p);this._w=(d-u)/m,this._x=.25*m,this._y=(i+o)/m,this._z=(s+f)/m}else if(l>p){const m=2*Math.sqrt(1+l-r-p);this._w=(s-f)/m,this._x=(i+o)/m,this._y=.25*m,this._z=(u+d)/m}else{const m=2*Math.sqrt(1+p-r-l);this._w=(o-i)/m,this._x=(s+f)/m,this._y=(u+d)/m,this._z=.25*m}return this._onChangeCallback(),this}setFromUnitVectors(t,e){let r=t.dot(e)+1;return r<Number.EPSILON?(r=0,Math.abs(t.x)>Math.abs(t.z)?(this._x=-t.y,this._y=t.x,this._z=0,this._w=r):(this._x=0,this._y=-t.z,this._z=t.y,this._w=r)):(this._x=t.y*e.z-t.z*e.y,this._y=t.z*e.x-t.x*e.z,this._z=t.x*e.y-t.y*e.x,this._w=r),this.normalize()}angleTo(t){return 2*Math.acos(Math.abs(Ht(this.dot(t),-1,1)))}rotateTowards(t,e){const r=this.angleTo(t);if(r===0)return this;const i=Math.min(1,e/r);return this.slerp(t,i),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(t){return this._x*t._x+this._y*t._y+this._z*t._z+this._w*t._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let t=this.length();return t===0?(this._x=0,this._y=0,this._z=0,this._w=1):(t=1/t,this._x=this._x*t,this._y=this._y*t,this._z=this._z*t,this._w=this._w*t),this._onChangeCallback(),this}multiply(t){return this.multiplyQuaternions(this,t)}premultiply(t){return this.multiplyQuaternions(t,this)}multiplyQuaternions(t,e){const r=t._x,i=t._y,s=t._z,o=t._w,l=e._x,u=e._y,f=e._z,d=e._w;return this._x=r*d+o*l+i*f-s*u,this._y=i*d+o*u+s*l-r*f,this._z=s*d+o*f+r*u-i*l,this._w=o*d-r*l-i*u-s*f,this._onChangeCallback(),this}slerp(t,e){if(e===0)return this;if(e===1)return this.copy(t);const r=this._x,i=this._y,s=this._z,o=this._w;let l=o*t._w+r*t._x+i*t._y+s*t._z;if(l<0?(this._w=-t._w,this._x=-t._x,this._y=-t._y,this._z=-t._z,l=-l):this.copy(t),l>=1)return this._w=o,this._x=r,this._y=i,this._z=s,this;const u=1-l*l;if(u<=Number.EPSILON){const m=1-e;return this._w=m*o+e*this._w,this._x=m*r+e*this._x,this._y=m*i+e*this._y,this._z=m*s+e*this._z,this.normalize(),this}const f=Math.sqrt(u),d=Math.atan2(f,l),p=Math.sin((1-e)*d)/f,g=Math.sin(e*d)/f;return this._w=o*p+this._w*g,this._x=r*p+this._x*g,this._y=i*p+this._y*g,this._z=s*p+this._z*g,this._onChangeCallback(),this}slerpQuaternions(t,e,r){return this.copy(t).slerp(e,r)}random(){const t=2*Math.PI*Math.random(),e=2*Math.PI*Math.random(),r=Math.random(),i=Math.sqrt(1-r),s=Math.sqrt(r);return this.set(i*Math.sin(t),i*Math.cos(t),s*Math.sin(e),s*Math.cos(e))}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._w===this._w}fromArray(t,e=0){return this._x=t[e],this._y=t[e+1],this._z=t[e+2],this._w=t[e+3],this._onChangeCallback(),this}toArray(t=[],e=0){return t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._w,t}fromBufferAttribute(t,e){return this._x=t.getX(e),this._y=t.getY(e),this._z=t.getZ(e),this._w=t.getW(e),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class ut{constructor(t=0,e=0,r=0){ut.prototype.isVector3=!0,this.x=t,this.y=e,this.z=r}set(t,e,r){return r===void 0&&(r=this.z),this.x=t,this.y=e,this.z=r,this}setScalar(t){return this.x=t,this.y=t,this.z=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setZ(t){return this.z=t,this}setComponent(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(t){return this.x=t.x,this.y=t.y,this.z=t.z,this}add(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this}addScalar(t){return this.x+=t,this.y+=t,this.z+=t,this}addVectors(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this}addScaledVector(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this}sub(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this}subScalar(t){return this.x-=t,this.y-=t,this.z-=t,this}subVectors(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this}multiply(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z,this}multiplyScalar(t){return this.x*=t,this.y*=t,this.z*=t,this}multiplyVectors(t,e){return this.x=t.x*e.x,this.y=t.y*e.y,this.z=t.z*e.z,this}applyEuler(t){return this.applyQuaternion(Au.setFromEuler(t))}applyAxisAngle(t,e){return this.applyQuaternion(Au.setFromAxisAngle(t,e))}applyMatrix3(t){const e=this.x,r=this.y,i=this.z,s=t.elements;return this.x=s[0]*e+s[3]*r+s[6]*i,this.y=s[1]*e+s[4]*r+s[7]*i,this.z=s[2]*e+s[5]*r+s[8]*i,this}applyNormalMatrix(t){return this.applyMatrix3(t).normalize()}applyMatrix4(t){const e=this.x,r=this.y,i=this.z,s=t.elements,o=1/(s[3]*e+s[7]*r+s[11]*i+s[15]);return this.x=(s[0]*e+s[4]*r+s[8]*i+s[12])*o,this.y=(s[1]*e+s[5]*r+s[9]*i+s[13])*o,this.z=(s[2]*e+s[6]*r+s[10]*i+s[14])*o,this}applyQuaternion(t){const e=this.x,r=this.y,i=this.z,s=t.x,o=t.y,l=t.z,u=t.w,f=2*(o*i-l*r),d=2*(l*e-s*i),p=2*(s*r-o*e);return this.x=e+u*f+o*p-l*d,this.y=r+u*d+l*f-s*p,this.z=i+u*p+s*d-o*f,this}project(t){return this.applyMatrix4(t.matrixWorldInverse).applyMatrix4(t.projectionMatrix)}unproject(t){return this.applyMatrix4(t.projectionMatrixInverse).applyMatrix4(t.matrixWorld)}transformDirection(t){const e=this.x,r=this.y,i=this.z,s=t.elements;return this.x=s[0]*e+s[4]*r+s[8]*i,this.y=s[1]*e+s[5]*r+s[9]*i,this.z=s[2]*e+s[6]*r+s[10]*i,this.normalize()}divide(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this}divideScalar(t){return this.multiplyScalar(1/t)}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this}clamp(t,e){return this.x=Ht(this.x,t.x,e.x),this.y=Ht(this.y,t.y,e.y),this.z=Ht(this.z,t.z,e.z),this}clampScalar(t,e){return this.x=Ht(this.x,t,e),this.y=Ht(this.y,t,e),this.z=Ht(this.z,t,e),this}clampLength(t,e){const r=this.length();return this.divideScalar(r||1).multiplyScalar(Ht(r,t,e))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this}lerpVectors(t,e,r){return this.x=t.x+(e.x-t.x)*r,this.y=t.y+(e.y-t.y)*r,this.z=t.z+(e.z-t.z)*r,this}cross(t){return this.crossVectors(this,t)}crossVectors(t,e){const r=t.x,i=t.y,s=t.z,o=e.x,l=e.y,u=e.z;return this.x=i*u-s*l,this.y=s*o-r*u,this.z=r*l-i*o,this}projectOnVector(t){const e=t.lengthSq();if(e===0)return this.set(0,0,0);const r=t.dot(this)/e;return this.copy(t).multiplyScalar(r)}projectOnPlane(t){return mh.copy(this).projectOnVector(t),this.sub(mh)}reflect(t){return this.sub(mh.copy(t).multiplyScalar(2*this.dot(t)))}angleTo(t){const e=Math.sqrt(this.lengthSq()*t.lengthSq());if(e===0)return Math.PI/2;const r=this.dot(t)/e;return Math.acos(Ht(r,-1,1))}distanceTo(t){return Math.sqrt(this.distanceToSquared(t))}distanceToSquared(t){const e=this.x-t.x,r=this.y-t.y,i=this.z-t.z;return e*e+r*r+i*i}manhattanDistanceTo(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)}setFromSpherical(t){return this.setFromSphericalCoords(t.radius,t.phi,t.theta)}setFromSphericalCoords(t,e,r){const i=Math.sin(e)*t;return this.x=i*Math.sin(r),this.y=Math.cos(e)*t,this.z=i*Math.cos(r),this}setFromCylindrical(t){return this.setFromCylindricalCoords(t.radius,t.theta,t.y)}setFromCylindricalCoords(t,e,r){return this.x=t*Math.sin(e),this.y=r,this.z=t*Math.cos(e),this}setFromMatrixPosition(t){const e=t.elements;return this.x=e[12],this.y=e[13],this.z=e[14],this}setFromMatrixScale(t){const e=this.setFromMatrixColumn(t,0).length(),r=this.setFromMatrixColumn(t,1).length(),i=this.setFromMatrixColumn(t,2).length();return this.x=e,this.y=r,this.z=i,this}setFromMatrixColumn(t,e){return this.fromArray(t.elements,e*4)}setFromMatrix3Column(t,e){return this.fromArray(t.elements,e*3)}setFromEuler(t){return this.x=t._x,this.y=t._y,this.z=t._z,this}setFromColor(t){return this.x=t.r,this.y=t.g,this.z=t.b,this}equals(t){return t.x===this.x&&t.y===this.y&&t.z===this.z}fromArray(t,e=0){return this.x=t[e],this.y=t[e+1],this.z=t[e+2],this}toArray(t=[],e=0){return t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t}fromBufferAttribute(t,e){return this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const t=Math.random()*Math.PI*2,e=Math.random()*2-1,r=Math.sqrt(1-e*e);return this.x=r*Math.cos(t),this.y=e,this.z=r*Math.sin(t),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const mh=new ut,Au=new ns;class no{constructor(t=new ut(1/0,1/0,1/0),e=new ut(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=t,this.max=e}set(t,e){return this.min.copy(t),this.max.copy(e),this}setFromArray(t){this.makeEmpty();for(let e=0,r=t.length;e<r;e+=3)this.expandByPoint(Ti.fromArray(t,e));return this}setFromBufferAttribute(t){this.makeEmpty();for(let e=0,r=t.count;e<r;e++)this.expandByPoint(Ti.fromBufferAttribute(t,e));return this}setFromPoints(t){this.makeEmpty();for(let e=0,r=t.length;e<r;e++)this.expandByPoint(t[e]);return this}setFromCenterAndSize(t,e){const r=Ti.copy(e).multiplyScalar(.5);return this.min.copy(t).sub(r),this.max.copy(t).add(r),this}setFromObject(t,e=!1){return this.makeEmpty(),this.expandByObject(t,e)}clone(){return new this.constructor().copy(this)}copy(t){return this.min.copy(t.min),this.max.copy(t.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(t){return this.isEmpty()?t.set(0,0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(t){return this.isEmpty()?t.set(0,0,0):t.subVectors(this.max,this.min)}expandByPoint(t){return this.min.min(t),this.max.max(t),this}expandByVector(t){return this.min.sub(t),this.max.add(t),this}expandByScalar(t){return this.min.addScalar(-t),this.max.addScalar(t),this}expandByObject(t,e=!1){t.updateWorldMatrix(!1,!1);const r=t.geometry;if(r!==void 0){const s=r.getAttribute("position");if(e===!0&&s!==void 0&&t.isInstancedMesh!==!0)for(let o=0,l=s.count;o<l;o++)t.isMesh===!0?t.getVertexPosition(o,Ti):Ti.fromBufferAttribute(s,o),Ti.applyMatrix4(t.matrixWorld),this.expandByPoint(Ti);else t.boundingBox!==void 0?(t.boundingBox===null&&t.computeBoundingBox(),qo.copy(t.boundingBox)):(r.boundingBox===null&&r.computeBoundingBox(),qo.copy(r.boundingBox)),qo.applyMatrix4(t.matrixWorld),this.union(qo)}const i=t.children;for(let s=0,o=i.length;s<o;s++)this.expandByObject(i[s],e);return this}containsPoint(t){return t.x>=this.min.x&&t.x<=this.max.x&&t.y>=this.min.y&&t.y<=this.max.y&&t.z>=this.min.z&&t.z<=this.max.z}containsBox(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y&&this.min.z<=t.min.z&&t.max.z<=this.max.z}getParameter(t,e){return e.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y),(t.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(t){return t.max.x>=this.min.x&&t.min.x<=this.max.x&&t.max.y>=this.min.y&&t.min.y<=this.max.y&&t.max.z>=this.min.z&&t.min.z<=this.max.z}intersectsSphere(t){return this.clampPoint(t.center,Ti),Ti.distanceToSquared(t.center)<=t.radius*t.radius}intersectsPlane(t){let e,r;return t.normal.x>0?(e=t.normal.x*this.min.x,r=t.normal.x*this.max.x):(e=t.normal.x*this.max.x,r=t.normal.x*this.min.x),t.normal.y>0?(e+=t.normal.y*this.min.y,r+=t.normal.y*this.max.y):(e+=t.normal.y*this.max.y,r+=t.normal.y*this.min.y),t.normal.z>0?(e+=t.normal.z*this.min.z,r+=t.normal.z*this.max.z):(e+=t.normal.z*this.max.z,r+=t.normal.z*this.min.z),e<=-t.constant&&r>=-t.constant}intersectsTriangle(t){if(this.isEmpty())return!1;this.getCenter(Cs),Yo.subVectors(this.max,Cs),Or.subVectors(t.a,Cs),Rr.subVectors(t.b,Cs),Dr.subVectors(t.c,Cs),bn.subVectors(Rr,Or),Ln.subVectors(Dr,Rr),Kn.subVectors(Or,Dr);let e=[0,-bn.z,bn.y,0,-Ln.z,Ln.y,0,-Kn.z,Kn.y,bn.z,0,-bn.x,Ln.z,0,-Ln.x,Kn.z,0,-Kn.x,-bn.y,bn.x,0,-Ln.y,Ln.x,0,-Kn.y,Kn.x,0];return!_h(e,Or,Rr,Dr,Yo)||(e=[1,0,0,0,1,0,0,0,1],!_h(e,Or,Rr,Dr,Yo))?!1:(jo.crossVectors(bn,Ln),e=[jo.x,jo.y,jo.z],_h(e,Or,Rr,Dr,Yo))}clampPoint(t,e){return e.copy(t).clamp(this.min,this.max)}distanceToPoint(t){return this.clampPoint(t,Ti).distanceTo(t)}getBoundingSphere(t){return this.isEmpty()?t.makeEmpty():(this.getCenter(t.center),t.radius=this.getSize(Ti).length()*.5),t}intersect(t){return this.min.max(t.min),this.max.min(t.max),this.isEmpty()&&this.makeEmpty(),this}union(t){return this.min.min(t.min),this.max.max(t.max),this}applyMatrix4(t){return this.isEmpty()?this:(sn[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(t),sn[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(t),sn[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(t),sn[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(t),sn[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(t),sn[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(t),sn[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(t),sn[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(t),this.setFromPoints(sn),this)}translate(t){return this.min.add(t),this.max.add(t),this}equals(t){return t.min.equals(this.min)&&t.max.equals(this.max)}}const sn=[new ut,new ut,new ut,new ut,new ut,new ut,new ut,new ut],Ti=new ut,qo=new no,Or=new ut,Rr=new ut,Dr=new ut,bn=new ut,Ln=new ut,Kn=new ut,Cs=new ut,Yo=new ut,jo=new ut,Qn=new ut;function _h(h,t,e,r,i){for(let s=0,o=h.length-3;s<=o;s+=3){Qn.fromArray(h,s);const l=i.x*Math.abs(Qn.x)+i.y*Math.abs(Qn.y)+i.z*Math.abs(Qn.z),u=t.dot(Qn),f=e.dot(Qn),d=r.dot(Qn);if(Math.max(-Math.max(u,f,d),Math.min(u,f,d))>l)return!1}return!0}const Sm=new no,zs=new ut,gh=new ut;class Qc{constructor(t=new ut,e=-1){this.isSphere=!0,this.center=t,this.radius=e}set(t,e){return this.center.copy(t),this.radius=e,this}setFromPoints(t,e){const r=this.center;e!==void 0?r.copy(e):Sm.setFromPoints(t).getCenter(r);let i=0;for(let s=0,o=t.length;s<o;s++)i=Math.max(i,r.distanceToSquared(t[s]));return this.radius=Math.sqrt(i),this}copy(t){return this.center.copy(t.center),this.radius=t.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(t){return t.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(t){return t.distanceTo(this.center)-this.radius}intersectsSphere(t){const e=this.radius+t.radius;return t.center.distanceToSquared(this.center)<=e*e}intersectsBox(t){return t.intersectsSphere(this)}intersectsPlane(t){return Math.abs(t.distanceToPoint(this.center))<=this.radius}clampPoint(t,e){const r=this.center.distanceToSquared(t);return e.copy(t),r>this.radius*this.radius&&(e.sub(this.center).normalize(),e.multiplyScalar(this.radius).add(this.center)),e}getBoundingBox(t){return this.isEmpty()?(t.makeEmpty(),t):(t.set(this.center,this.center),t.expandByScalar(this.radius),t)}applyMatrix4(t){return this.center.applyMatrix4(t),this.radius=this.radius*t.getMaxScaleOnAxis(),this}translate(t){return this.center.add(t),this}expandByPoint(t){if(this.isEmpty())return this.center.copy(t),this.radius=0,this;zs.subVectors(t,this.center);const e=zs.lengthSq();if(e>this.radius*this.radius){const r=Math.sqrt(e),i=(r-this.radius)*.5;this.center.addScaledVector(zs,i/r),this.radius+=i}return this}union(t){return t.isEmpty()?this:this.isEmpty()?(this.copy(t),this):(this.center.equals(t.center)===!0?this.radius=Math.max(this.radius,t.radius):(gh.subVectors(t.center,this.center).setLength(t.radius),this.expandByPoint(zs.copy(t.center).add(gh)),this.expandByPoint(zs.copy(t.center).sub(gh))),this)}equals(t){return t.center.equals(this.center)&&t.radius===this.radius}clone(){return new this.constructor().copy(this)}}const on=new ut,yh=new ut,Xo=new ut,Mn=new ut,vh=new ut,Jo=new ut,xh=new ut;class km{constructor(t=new ut,e=new ut(0,0,-1)){this.origin=t,this.direction=e}set(t,e){return this.origin.copy(t),this.direction.copy(e),this}copy(t){return this.origin.copy(t.origin),this.direction.copy(t.direction),this}at(t,e){return e.copy(this.origin).addScaledVector(this.direction,t)}lookAt(t){return this.direction.copy(t).sub(this.origin).normalize(),this}recast(t){return this.origin.copy(this.at(t,on)),this}closestPointToPoint(t,e){e.subVectors(t,this.origin);const r=e.dot(this.direction);return r<0?e.copy(this.origin):e.copy(this.origin).addScaledVector(this.direction,r)}distanceToPoint(t){return Math.sqrt(this.distanceSqToPoint(t))}distanceSqToPoint(t){const e=on.subVectors(t,this.origin).dot(this.direction);return e<0?this.origin.distanceToSquared(t):(on.copy(this.origin).addScaledVector(this.direction,e),on.distanceToSquared(t))}distanceSqToSegment(t,e,r,i){yh.copy(t).add(e).multiplyScalar(.5),Xo.copy(e).sub(t).normalize(),Mn.copy(this.origin).sub(yh);const s=t.distanceTo(e)*.5,o=-this.direction.dot(Xo),l=Mn.dot(this.direction),u=-Mn.dot(Xo),f=Mn.lengthSq(),d=Math.abs(1-o*o);let p,g,m,x;if(d>0)if(p=o*u-l,g=o*l-u,x=s*d,p>=0)if(g>=-x)if(g<=x){const v=1/d;p*=v,g*=v,m=p*(p+o*g+2*l)+g*(o*p+g+2*u)+f}else g=s,p=Math.max(0,-(o*g+l)),m=-p*p+g*(g+2*u)+f;else g=-s,p=Math.max(0,-(o*g+l)),m=-p*p+g*(g+2*u)+f;else g<=-x?(p=Math.max(0,-(-o*s+l)),g=p>0?-s:Math.min(Math.max(-s,-u),s),m=-p*p+g*(g+2*u)+f):g<=x?(p=0,g=Math.min(Math.max(-s,-u),s),m=g*(g+2*u)+f):(p=Math.max(0,-(o*s+l)),g=p>0?s:Math.min(Math.max(-s,-u),s),m=-p*p+g*(g+2*u)+f);else g=o>0?-s:s,p=Math.max(0,-(o*g+l)),m=-p*p+g*(g+2*u)+f;return r&&r.copy(this.origin).addScaledVector(this.direction,p),i&&i.copy(yh).addScaledVector(Xo,g),m}intersectSphere(t,e){on.subVectors(t.center,this.origin);const r=on.dot(this.direction),i=on.dot(on)-r*r,s=t.radius*t.radius;if(i>s)return null;const o=Math.sqrt(s-i),l=r-o,u=r+o;return u<0?null:l<0?this.at(u,e):this.at(l,e)}intersectsSphere(t){return this.distanceSqToPoint(t.center)<=t.radius*t.radius}distanceToPlane(t){const e=t.normal.dot(this.direction);if(e===0)return t.distanceToPoint(this.origin)===0?0:null;const r=-(this.origin.dot(t.normal)+t.constant)/e;return r>=0?r:null}intersectPlane(t,e){const r=this.distanceToPlane(t);return r===null?null:this.at(r,e)}intersectsPlane(t){const e=t.distanceToPoint(this.origin);return e===0||t.normal.dot(this.direction)*e<0}intersectBox(t,e){let r,i,s,o,l,u;const f=1/this.direction.x,d=1/this.direction.y,p=1/this.direction.z,g=this.origin;return f>=0?(r=(t.min.x-g.x)*f,i=(t.max.x-g.x)*f):(r=(t.max.x-g.x)*f,i=(t.min.x-g.x)*f),d>=0?(s=(t.min.y-g.y)*d,o=(t.max.y-g.y)*d):(s=(t.max.y-g.y)*d,o=(t.min.y-g.y)*d),r>o||s>i||((s>r||isNaN(r))&&(r=s),(o<i||isNaN(i))&&(i=o),p>=0?(l=(t.min.z-g.z)*p,u=(t.max.z-g.z)*p):(l=(t.max.z-g.z)*p,u=(t.min.z-g.z)*p),r>u||l>i)||((l>r||r!==r)&&(r=l),(u<i||i!==i)&&(i=u),i<0)?null:this.at(r>=0?r:i,e)}intersectsBox(t){return this.intersectBox(t,on)!==null}intersectTriangle(t,e,r,i,s){vh.subVectors(e,t),Jo.subVectors(r,t),xh.crossVectors(vh,Jo);let o=this.direction.dot(xh),l;if(o>0){if(i)return null;l=1}else if(o<0)l=-1,o=-o;else return null;Mn.subVectors(this.origin,t);const u=l*this.direction.dot(Jo.crossVectors(Mn,Jo));if(u<0)return null;const f=l*this.direction.dot(vh.cross(Mn));if(f<0||u+f>o)return null;const d=-l*Mn.dot(xh);return d<0?null:this.at(d/o,s)}applyMatrix4(t){return this.origin.applyMatrix4(t),this.direction.transformDirection(t),this}equals(t){return t.origin.equals(this.origin)&&t.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class qe{constructor(t,e,r,i,s,o,l,u,f,d,p,g,m,x,v,b){qe.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],t!==void 0&&this.set(t,e,r,i,s,o,l,u,f,d,p,g,m,x,v,b)}set(t,e,r,i,s,o,l,u,f,d,p,g,m,x,v,b){const P=this.elements;return P[0]=t,P[4]=e,P[8]=r,P[12]=i,P[1]=s,P[5]=o,P[9]=l,P[13]=u,P[2]=f,P[6]=d,P[10]=p,P[14]=g,P[3]=m,P[7]=x,P[11]=v,P[15]=b,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new qe().fromArray(this.elements)}copy(t){const e=this.elements,r=t.elements;return e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=r[3],e[4]=r[4],e[5]=r[5],e[6]=r[6],e[7]=r[7],e[8]=r[8],e[9]=r[9],e[10]=r[10],e[11]=r[11],e[12]=r[12],e[13]=r[13],e[14]=r[14],e[15]=r[15],this}copyPosition(t){const e=this.elements,r=t.elements;return e[12]=r[12],e[13]=r[13],e[14]=r[14],this}setFromMatrix3(t){const e=t.elements;return this.set(e[0],e[3],e[6],0,e[1],e[4],e[7],0,e[2],e[5],e[8],0,0,0,0,1),this}extractBasis(t,e,r){return t.setFromMatrixColumn(this,0),e.setFromMatrixColumn(this,1),r.setFromMatrixColumn(this,2),this}makeBasis(t,e,r){return this.set(t.x,e.x,r.x,0,t.y,e.y,r.y,0,t.z,e.z,r.z,0,0,0,0,1),this}extractRotation(t){const e=this.elements,r=t.elements,i=1/Br.setFromMatrixColumn(t,0).length(),s=1/Br.setFromMatrixColumn(t,1).length(),o=1/Br.setFromMatrixColumn(t,2).length();return e[0]=r[0]*i,e[1]=r[1]*i,e[2]=r[2]*i,e[3]=0,e[4]=r[4]*s,e[5]=r[5]*s,e[6]=r[6]*s,e[7]=0,e[8]=r[8]*o,e[9]=r[9]*o,e[10]=r[10]*o,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this}makeRotationFromEuler(t){const e=this.elements,r=t.x,i=t.y,s=t.z,o=Math.cos(r),l=Math.sin(r),u=Math.cos(i),f=Math.sin(i),d=Math.cos(s),p=Math.sin(s);if(t.order==="XYZ"){const g=o*d,m=o*p,x=l*d,v=l*p;e[0]=u*d,e[4]=-u*p,e[8]=f,e[1]=m+x*f,e[5]=g-v*f,e[9]=-l*u,e[2]=v-g*f,e[6]=x+m*f,e[10]=o*u}else if(t.order==="YXZ"){const g=u*d,m=u*p,x=f*d,v=f*p;e[0]=g+v*l,e[4]=x*l-m,e[8]=o*f,e[1]=o*p,e[5]=o*d,e[9]=-l,e[2]=m*l-x,e[6]=v+g*l,e[10]=o*u}else if(t.order==="ZXY"){const g=u*d,m=u*p,x=f*d,v=f*p;e[0]=g-v*l,e[4]=-o*p,e[8]=x+m*l,e[1]=m+x*l,e[5]=o*d,e[9]=v-g*l,e[2]=-o*f,e[6]=l,e[10]=o*u}else if(t.order==="ZYX"){const g=o*d,m=o*p,x=l*d,v=l*p;e[0]=u*d,e[4]=x*f-m,e[8]=g*f+v,e[1]=u*p,e[5]=v*f+g,e[9]=m*f-x,e[2]=-f,e[6]=l*u,e[10]=o*u}else if(t.order==="YZX"){const g=o*u,m=o*f,x=l*u,v=l*f;e[0]=u*d,e[4]=v-g*p,e[8]=x*p+m,e[1]=p,e[5]=o*d,e[9]=-l*d,e[2]=-f*d,e[6]=m*p+x,e[10]=g-v*p}else if(t.order==="XZY"){const g=o*u,m=o*f,x=l*u,v=l*f;e[0]=u*d,e[4]=-p,e[8]=f*d,e[1]=g*p+v,e[5]=o*d,e[9]=m*p-x,e[2]=x*p-m,e[6]=l*d,e[10]=v*p+g}return e[3]=0,e[7]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this}makeRotationFromQuaternion(t){return this.compose(Am,t,Pm)}lookAt(t,e,r){const i=this.elements;return $e.subVectors(t,e),$e.lengthSq()===0&&($e.z=1),$e.normalize(),En.crossVectors(r,$e),En.lengthSq()===0&&(Math.abs(r.z)===1?$e.x+=1e-4:$e.z+=1e-4,$e.normalize(),En.crossVectors(r,$e)),En.normalize(),$o.crossVectors($e,En),i[0]=En.x,i[4]=$o.x,i[8]=$e.x,i[1]=En.y,i[5]=$o.y,i[9]=$e.y,i[2]=En.z,i[6]=$o.z,i[10]=$e.z,this}multiply(t){return this.multiplyMatrices(this,t)}premultiply(t){return this.multiplyMatrices(t,this)}multiplyMatrices(t,e){const r=t.elements,i=e.elements,s=this.elements,o=r[0],l=r[4],u=r[8],f=r[12],d=r[1],p=r[5],g=r[9],m=r[13],x=r[2],v=r[6],b=r[10],P=r[14],A=r[3],B=r[7],Z=r[11],I=r[15],K=i[0],V=i[4],S=i[8],k=i[12],O=i[1],N=i[5],E=i[9],C=i[13],y=i[2],z=i[6],H=i[10],G=i[14],W=i[3],X=i[7],tt=i[11],q=i[15];return s[0]=o*K+l*O+u*y+f*W,s[4]=o*V+l*N+u*z+f*X,s[8]=o*S+l*E+u*H+f*tt,s[12]=o*k+l*C+u*G+f*q,s[1]=d*K+p*O+g*y+m*W,s[5]=d*V+p*N+g*z+m*X,s[9]=d*S+p*E+g*H+m*tt,s[13]=d*k+p*C+g*G+m*q,s[2]=x*K+v*O+b*y+P*W,s[6]=x*V+v*N+b*z+P*X,s[10]=x*S+v*E+b*H+P*tt,s[14]=x*k+v*C+b*G+P*q,s[3]=A*K+B*O+Z*y+I*W,s[7]=A*V+B*N+Z*z+I*X,s[11]=A*S+B*E+Z*H+I*tt,s[15]=A*k+B*C+Z*G+I*q,this}multiplyScalar(t){const e=this.elements;return e[0]*=t,e[4]*=t,e[8]*=t,e[12]*=t,e[1]*=t,e[5]*=t,e[9]*=t,e[13]*=t,e[2]*=t,e[6]*=t,e[10]*=t,e[14]*=t,e[3]*=t,e[7]*=t,e[11]*=t,e[15]*=t,this}determinant(){const t=this.elements,e=t[0],r=t[4],i=t[8],s=t[12],o=t[1],l=t[5],u=t[9],f=t[13],d=t[2],p=t[6],g=t[10],m=t[14],x=t[3],v=t[7],b=t[11],P=t[15];return x*(+s*u*p-i*f*p-s*l*g+r*f*g+i*l*m-r*u*m)+v*(+e*u*m-e*f*g+s*o*g-i*o*m+i*f*d-s*u*d)+b*(+e*f*p-e*l*m-s*o*p+r*o*m+s*l*d-r*f*d)+P*(-i*l*d-e*u*p+e*l*g+i*o*p-r*o*g+r*u*d)}transpose(){const t=this.elements;let e;return e=t[1],t[1]=t[4],t[4]=e,e=t[2],t[2]=t[8],t[8]=e,e=t[6],t[6]=t[9],t[9]=e,e=t[3],t[3]=t[12],t[12]=e,e=t[7],t[7]=t[13],t[13]=e,e=t[11],t[11]=t[14],t[14]=e,this}setPosition(t,e,r){const i=this.elements;return t.isVector3?(i[12]=t.x,i[13]=t.y,i[14]=t.z):(i[12]=t,i[13]=e,i[14]=r),this}invert(){const t=this.elements,e=t[0],r=t[1],i=t[2],s=t[3],o=t[4],l=t[5],u=t[6],f=t[7],d=t[8],p=t[9],g=t[10],m=t[11],x=t[12],v=t[13],b=t[14],P=t[15],A=p*b*f-v*g*f+v*u*m-l*b*m-p*u*P+l*g*P,B=x*g*f-d*b*f-x*u*m+o*b*m+d*u*P-o*g*P,Z=d*v*f-x*p*f+x*l*m-o*v*m-d*l*P+o*p*P,I=x*p*u-d*v*u-x*l*g+o*v*g+d*l*b-o*p*b,K=e*A+r*B+i*Z+s*I;if(K===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const V=1/K;return t[0]=A*V,t[1]=(v*g*s-p*b*s-v*i*m+r*b*m+p*i*P-r*g*P)*V,t[2]=(l*b*s-v*u*s+v*i*f-r*b*f-l*i*P+r*u*P)*V,t[3]=(p*u*s-l*g*s-p*i*f+r*g*f+l*i*m-r*u*m)*V,t[4]=B*V,t[5]=(d*b*s-x*g*s+x*i*m-e*b*m-d*i*P+e*g*P)*V,t[6]=(x*u*s-o*b*s-x*i*f+e*b*f+o*i*P-e*u*P)*V,t[7]=(o*g*s-d*u*s+d*i*f-e*g*f-o*i*m+e*u*m)*V,t[8]=Z*V,t[9]=(x*p*s-d*v*s-x*r*m+e*v*m+d*r*P-e*p*P)*V,t[10]=(o*v*s-x*l*s+x*r*f-e*v*f-o*r*P+e*l*P)*V,t[11]=(d*l*s-o*p*s-d*r*f+e*p*f+o*r*m-e*l*m)*V,t[12]=I*V,t[13]=(d*v*i-x*p*i+x*r*g-e*v*g-d*r*b+e*p*b)*V,t[14]=(x*l*i-o*v*i-x*r*u+e*v*u+o*r*b-e*l*b)*V,t[15]=(o*p*i-d*l*i+d*r*u-e*p*u-o*r*g+e*l*g)*V,this}scale(t){const e=this.elements,r=t.x,i=t.y,s=t.z;return e[0]*=r,e[4]*=i,e[8]*=s,e[1]*=r,e[5]*=i,e[9]*=s,e[2]*=r,e[6]*=i,e[10]*=s,e[3]*=r,e[7]*=i,e[11]*=s,this}getMaxScaleOnAxis(){const t=this.elements,e=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],r=t[4]*t[4]+t[5]*t[5]+t[6]*t[6],i=t[8]*t[8]+t[9]*t[9]+t[10]*t[10];return Math.sqrt(Math.max(e,r,i))}makeTranslation(t,e,r){return t.isVector3?this.set(1,0,0,t.x,0,1,0,t.y,0,0,1,t.z,0,0,0,1):this.set(1,0,0,t,0,1,0,e,0,0,1,r,0,0,0,1),this}makeRotationX(t){const e=Math.cos(t),r=Math.sin(t);return this.set(1,0,0,0,0,e,-r,0,0,r,e,0,0,0,0,1),this}makeRotationY(t){const e=Math.cos(t),r=Math.sin(t);return this.set(e,0,r,0,0,1,0,0,-r,0,e,0,0,0,0,1),this}makeRotationZ(t){const e=Math.cos(t),r=Math.sin(t);return this.set(e,-r,0,0,r,e,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(t,e){const r=Math.cos(e),i=Math.sin(e),s=1-r,o=t.x,l=t.y,u=t.z,f=s*o,d=s*l;return this.set(f*o+r,f*l-i*u,f*u+i*l,0,f*l+i*u,d*l+r,d*u-i*o,0,f*u-i*l,d*u+i*o,s*u*u+r,0,0,0,0,1),this}makeScale(t,e,r){return this.set(t,0,0,0,0,e,0,0,0,0,r,0,0,0,0,1),this}makeShear(t,e,r,i,s,o){return this.set(1,r,s,0,t,1,o,0,e,i,1,0,0,0,0,1),this}compose(t,e,r){const i=this.elements,s=e._x,o=e._y,l=e._z,u=e._w,f=s+s,d=o+o,p=l+l,g=s*f,m=s*d,x=s*p,v=o*d,b=o*p,P=l*p,A=u*f,B=u*d,Z=u*p,I=r.x,K=r.y,V=r.z;return i[0]=(1-(v+P))*I,i[1]=(m+Z)*I,i[2]=(x-B)*I,i[3]=0,i[4]=(m-Z)*K,i[5]=(1-(g+P))*K,i[6]=(b+A)*K,i[7]=0,i[8]=(x+B)*V,i[9]=(b-A)*V,i[10]=(1-(g+v))*V,i[11]=0,i[12]=t.x,i[13]=t.y,i[14]=t.z,i[15]=1,this}decompose(t,e,r){const i=this.elements;let s=Br.set(i[0],i[1],i[2]).length();const o=Br.set(i[4],i[5],i[6]).length(),l=Br.set(i[8],i[9],i[10]).length();this.determinant()<0&&(s=-s),t.x=i[12],t.y=i[13],t.z=i[14],Si.copy(this);const f=1/s,d=1/o,p=1/l;return Si.elements[0]*=f,Si.elements[1]*=f,Si.elements[2]*=f,Si.elements[4]*=d,Si.elements[5]*=d,Si.elements[6]*=d,Si.elements[8]*=p,Si.elements[9]*=p,Si.elements[10]*=p,e.setFromRotationMatrix(Si),r.x=s,r.y=o,r.z=l,this}makePerspective(t,e,r,i,s,o,l=Vo){const u=this.elements,f=2*s/(e-t),d=2*s/(r-i),p=(e+t)/(e-t),g=(r+i)/(r-i);let m,x;if(l===Vo)m=-(o+s)/(o-s),x=-2*o*s/(o-s);else if(l===Mu)m=-o/(o-s),x=-o*s/(o-s);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+l);return u[0]=f,u[4]=0,u[8]=p,u[12]=0,u[1]=0,u[5]=d,u[9]=g,u[13]=0,u[2]=0,u[6]=0,u[10]=m,u[14]=x,u[3]=0,u[7]=0,u[11]=-1,u[15]=0,this}makeOrthographic(t,e,r,i,s,o,l=Vo){const u=this.elements,f=1/(e-t),d=1/(r-i),p=1/(o-s),g=(e+t)*f,m=(r+i)*d;let x,v;if(l===Vo)x=(o+s)*p,v=-2*p;else if(l===Mu)x=s*p,v=-1*p;else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+l);return u[0]=2*f,u[4]=0,u[8]=0,u[12]=-g,u[1]=0,u[5]=2*d,u[9]=0,u[13]=-m,u[2]=0,u[6]=0,u[10]=v,u[14]=-x,u[3]=0,u[7]=0,u[11]=0,u[15]=1,this}equals(t){const e=this.elements,r=t.elements;for(let i=0;i<16;i++)if(e[i]!==r[i])return!1;return!0}fromArray(t,e=0){for(let r=0;r<16;r++)this.elements[r]=t[r+e];return this}toArray(t=[],e=0){const r=this.elements;return t[e]=r[0],t[e+1]=r[1],t[e+2]=r[2],t[e+3]=r[3],t[e+4]=r[4],t[e+5]=r[5],t[e+6]=r[6],t[e+7]=r[7],t[e+8]=r[8],t[e+9]=r[9],t[e+10]=r[10],t[e+11]=r[11],t[e+12]=r[12],t[e+13]=r[13],t[e+14]=r[14],t[e+15]=r[15],t}}const Br=new ut,Si=new qe,Am=new ut(0,0,0),Pm=new ut(1,1,1),En=new ut,$o=new ut,$e=new ut,Pu=new qe,Cu=new ns;class Dn{constructor(t=0,e=0,r=0,i=Dn.DEFAULT_ORDER){this.isEuler=!0,this._x=t,this._y=e,this._z=r,this._order=i}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get order(){return this._order}set order(t){this._order=t,this._onChangeCallback()}set(t,e,r,i=this._order){return this._x=t,this._y=e,this._z=r,this._order=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this._onChangeCallback(),this}setFromRotationMatrix(t,e=this._order,r=!0){const i=t.elements,s=i[0],o=i[4],l=i[8],u=i[1],f=i[5],d=i[9],p=i[2],g=i[6],m=i[10];switch(e){case"XYZ":this._y=Math.asin(Ht(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(-d,m),this._z=Math.atan2(-o,s)):(this._x=Math.atan2(g,f),this._z=0);break;case"YXZ":this._x=Math.asin(-Ht(d,-1,1)),Math.abs(d)<.9999999?(this._y=Math.atan2(l,m),this._z=Math.atan2(u,f)):(this._y=Math.atan2(-p,s),this._z=0);break;case"ZXY":this._x=Math.asin(Ht(g,-1,1)),Math.abs(g)<.9999999?(this._y=Math.atan2(-p,m),this._z=Math.atan2(-o,f)):(this._y=0,this._z=Math.atan2(u,s));break;case"ZYX":this._y=Math.asin(-Ht(p,-1,1)),Math.abs(p)<.9999999?(this._x=Math.atan2(g,m),this._z=Math.atan2(u,s)):(this._x=0,this._z=Math.atan2(-o,f));break;case"YZX":this._z=Math.asin(Ht(u,-1,1)),Math.abs(u)<.9999999?(this._x=Math.atan2(-d,f),this._y=Math.atan2(-p,s)):(this._x=0,this._y=Math.atan2(l,m));break;case"XZY":this._z=Math.asin(-Ht(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(g,f),this._y=Math.atan2(l,s)):(this._x=Math.atan2(-d,m),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+e)}return this._order=e,r===!0&&this._onChangeCallback(),this}setFromQuaternion(t,e,r){return Pu.makeRotationFromQuaternion(t),this.setFromRotationMatrix(Pu,e,r)}setFromVector3(t,e=this._order){return this.set(t.x,t.y,t.z,e)}reorder(t){return Cu.setFromEuler(this),this.setFromQuaternion(Cu,t)}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order}fromArray(t){return this._x=t[0],this._y=t[1],this._z=t[2],t[3]!==void 0&&(this._order=t[3]),this._onChangeCallback(),this}toArray(t=[],e=0){return t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._order,t}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}Dn.DEFAULT_ORDER="XYZ";class Cm{constructor(){this.mask=1}set(t){this.mask=(1<<t|0)>>>0}enable(t){this.mask|=1<<t|0}enableAll(){this.mask=-1}toggle(t){this.mask^=1<<t|0}disable(t){this.mask&=~(1<<t|0)}disableAll(){this.mask=0}test(t){return(this.mask&t.mask)!==0}isEnabled(t){return(this.mask&(1<<t|0))!==0}}let zm=0;const zu=new ut,Nr=new ns,an=new qe,Ko=new ut,Is=new ut,Im=new ut,Om=new ns,Iu=new ut(1,0,0),Ou=new ut(0,1,0),Ru=new ut(0,0,1),Du={type:"added"},Rm={type:"removed"},Fr={type:"childadded",child:null},wh={type:"childremoved",child:null};class Gi extends Fa{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:zm++}),this.uuid=ur(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Gi.DEFAULT_UP.clone();const t=new ut,e=new Dn,r=new ns,i=new ut(1,1,1);function s(){r.setFromEuler(e,!1)}function o(){e.setFromQuaternion(r,void 0,!1)}e._onChange(s),r._onChange(o),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:t},rotation:{configurable:!0,enumerable:!0,value:e},quaternion:{configurable:!0,enumerable:!0,value:r},scale:{configurable:!0,enumerable:!0,value:i},modelViewMatrix:{value:new qe},normalMatrix:{value:new Bn}}),this.matrix=new qe,this.matrixWorld=new qe,this.matrixAutoUpdate=Gi.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=Gi.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new Cm,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(t){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(t),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(t){return this.quaternion.premultiply(t),this}setRotationFromAxisAngle(t,e){this.quaternion.setFromAxisAngle(t,e)}setRotationFromEuler(t){this.quaternion.setFromEuler(t,!0)}setRotationFromMatrix(t){this.quaternion.setFromRotationMatrix(t)}setRotationFromQuaternion(t){this.quaternion.copy(t)}rotateOnAxis(t,e){return Nr.setFromAxisAngle(t,e),this.quaternion.multiply(Nr),this}rotateOnWorldAxis(t,e){return Nr.setFromAxisAngle(t,e),this.quaternion.premultiply(Nr),this}rotateX(t){return this.rotateOnAxis(Iu,t)}rotateY(t){return this.rotateOnAxis(Ou,t)}rotateZ(t){return this.rotateOnAxis(Ru,t)}translateOnAxis(t,e){return zu.copy(t).applyQuaternion(this.quaternion),this.position.add(zu.multiplyScalar(e)),this}translateX(t){return this.translateOnAxis(Iu,t)}translateY(t){return this.translateOnAxis(Ou,t)}translateZ(t){return this.translateOnAxis(Ru,t)}localToWorld(t){return this.updateWorldMatrix(!0,!1),t.applyMatrix4(this.matrixWorld)}worldToLocal(t){return this.updateWorldMatrix(!0,!1),t.applyMatrix4(an.copy(this.matrixWorld).invert())}lookAt(t,e,r){t.isVector3?Ko.copy(t):Ko.set(t,e,r);const i=this.parent;this.updateWorldMatrix(!0,!1),Is.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?an.lookAt(Is,Ko,this.up):an.lookAt(Ko,Is,this.up),this.quaternion.setFromRotationMatrix(an),i&&(an.extractRotation(i.matrixWorld),Nr.setFromRotationMatrix(an),this.quaternion.premultiply(Nr.invert()))}add(t){if(arguments.length>1){for(let e=0;e<arguments.length;e++)this.add(arguments[e]);return this}return t===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",t),this):(t&&t.isObject3D?(t.removeFromParent(),t.parent=this,this.children.push(t),t.dispatchEvent(Du),Fr.child=t,this.dispatchEvent(Fr),Fr.child=null):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",t),this)}remove(t){if(arguments.length>1){for(let r=0;r<arguments.length;r++)this.remove(arguments[r]);return this}const e=this.children.indexOf(t);return e!==-1&&(t.parent=null,this.children.splice(e,1),t.dispatchEvent(Rm),wh.child=t,this.dispatchEvent(wh),wh.child=null),this}removeFromParent(){const t=this.parent;return t!==null&&t.remove(this),this}clear(){return this.remove(...this.children)}attach(t){return this.updateWorldMatrix(!0,!1),an.copy(this.matrixWorld).invert(),t.parent!==null&&(t.parent.updateWorldMatrix(!0,!1),an.multiply(t.parent.matrixWorld)),t.applyMatrix4(an),t.removeFromParent(),t.parent=this,this.children.push(t),t.updateWorldMatrix(!1,!0),t.dispatchEvent(Du),Fr.child=t,this.dispatchEvent(Fr),Fr.child=null,this}getObjectById(t){return this.getObjectByProperty("id",t)}getObjectByName(t){return this.getObjectByProperty("name",t)}getObjectByProperty(t,e){if(this[t]===e)return this;for(let r=0,i=this.children.length;r<i;r++){const o=this.children[r].getObjectByProperty(t,e);if(o!==void 0)return o}}getObjectsByProperty(t,e,r=[]){this[t]===e&&r.push(this);const i=this.children;for(let s=0,o=i.length;s<o;s++)i[s].getObjectsByProperty(t,e,r);return r}getWorldPosition(t){return this.updateWorldMatrix(!0,!1),t.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Is,t,Im),t}getWorldScale(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Is,Om,t),t}getWorldDirection(t){this.updateWorldMatrix(!0,!1);const e=this.matrixWorld.elements;return t.set(e[8],e[9],e[10]).normalize()}raycast(){}traverse(t){t(this);const e=this.children;for(let r=0,i=e.length;r<i;r++)e[r].traverse(t)}traverseVisible(t){if(this.visible===!1)return;t(this);const e=this.children;for(let r=0,i=e.length;r<i;r++)e[r].traverseVisible(t)}traverseAncestors(t){const e=this.parent;e!==null&&(t(e),e.traverseAncestors(t))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1,t=!0);const e=this.children;for(let r=0,i=e.length;r<i;r++)e[r].updateMatrixWorld(t)}updateWorldMatrix(t,e){const r=this.parent;if(t===!0&&r!==null&&r.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),e===!0){const i=this.children;for(let s=0,o=i.length;s<o;s++)i[s].updateWorldMatrix(!1,!0)}}toJSON(t){const e=t===void 0||typeof t=="string",r={};e&&(t={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},r.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});const i={};i.uuid=this.uuid,i.type=this.type,this.name!==""&&(i.name=this.name),this.castShadow===!0&&(i.castShadow=!0),this.receiveShadow===!0&&(i.receiveShadow=!0),this.visible===!1&&(i.visible=!1),this.frustumCulled===!1&&(i.frustumCulled=!1),this.renderOrder!==0&&(i.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(i.userData=this.userData),i.layers=this.layers.mask,i.matrix=this.matrix.toArray(),i.up=this.up.toArray(),this.matrixAutoUpdate===!1&&(i.matrixAutoUpdate=!1),this.isInstancedMesh&&(i.type="InstancedMesh",i.count=this.count,i.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(i.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(i.type="BatchedMesh",i.perObjectFrustumCulled=this.perObjectFrustumCulled,i.sortObjects=this.sortObjects,i.drawRanges=this._drawRanges,i.reservedRanges=this._reservedRanges,i.visibility=this._visibility,i.active=this._active,i.bounds=this._bounds.map(l=>({boxInitialized:l.boxInitialized,boxMin:l.box.min.toArray(),boxMax:l.box.max.toArray(),sphereInitialized:l.sphereInitialized,sphereRadius:l.sphere.radius,sphereCenter:l.sphere.center.toArray()})),i.maxInstanceCount=this._maxInstanceCount,i.maxVertexCount=this._maxVertexCount,i.maxIndexCount=this._maxIndexCount,i.geometryInitialized=this._geometryInitialized,i.geometryCount=this._geometryCount,i.matricesTexture=this._matricesTexture.toJSON(t),this._colorsTexture!==null&&(i.colorsTexture=this._colorsTexture.toJSON(t)),this.boundingSphere!==null&&(i.boundingSphere={center:i.boundingSphere.center.toArray(),radius:i.boundingSphere.radius}),this.boundingBox!==null&&(i.boundingBox={min:i.boundingBox.min.toArray(),max:i.boundingBox.max.toArray()}));function s(l,u){return l[u.uuid]===void 0&&(l[u.uuid]=u.toJSON(t)),u.uuid}if(this.isScene)this.background&&(this.background.isColor?i.background=this.background.toJSON():this.background.isTexture&&(i.background=this.background.toJSON(t).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(i.environment=this.environment.toJSON(t).uuid);else if(this.isMesh||this.isLine||this.isPoints){i.geometry=s(t.geometries,this.geometry);const l=this.geometry.parameters;if(l!==void 0&&l.shapes!==void 0){const u=l.shapes;if(Array.isArray(u))for(let f=0,d=u.length;f<d;f++){const p=u[f];s(t.shapes,p)}else s(t.shapes,u)}}if(this.isSkinnedMesh&&(i.bindMode=this.bindMode,i.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(s(t.skeletons,this.skeleton),i.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const l=[];for(let u=0,f=this.material.length;u<f;u++)l.push(s(t.materials,this.material[u]));i.material=l}else i.material=s(t.materials,this.material);if(this.children.length>0){i.children=[];for(let l=0;l<this.children.length;l++)i.children.push(this.children[l].toJSON(t).object)}if(this.animations.length>0){i.animations=[];for(let l=0;l<this.animations.length;l++){const u=this.animations[l];i.animations.push(s(t.animations,u))}}if(e){const l=o(t.geometries),u=o(t.materials),f=o(t.textures),d=o(t.images),p=o(t.shapes),g=o(t.skeletons),m=o(t.animations),x=o(t.nodes);l.length>0&&(r.geometries=l),u.length>0&&(r.materials=u),f.length>0&&(r.textures=f),d.length>0&&(r.images=d),p.length>0&&(r.shapes=p),g.length>0&&(r.skeletons=g),m.length>0&&(r.animations=m),x.length>0&&(r.nodes=x)}return r.object=i,r;function o(l){const u=[];for(const f in l){const d=l[f];delete d.metadata,u.push(d)}return u}}clone(t){return new this.constructor().copy(this,t)}copy(t,e=!0){if(this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.rotation.order=t.rotation.order,this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldAutoUpdate=t.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.animations=t.animations.slice(),this.userData=JSON.parse(JSON.stringify(t.userData)),e===!0)for(let r=0;r<t.children.length;r++){const i=t.children[r];this.add(i.clone())}return this}}Gi.DEFAULT_UP=new ut(0,1,0);Gi.DEFAULT_MATRIX_AUTO_UPDATE=!0;Gi.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const ki=new ut,hn=new ut,bh=new ut,ln=new ut,Ur=new ut,Zr=new ut,Bu=new ut,Lh=new ut,Mh=new ut,Eh=new ut,Th=new io,Sh=new io,kh=new io;class Ai{constructor(t=new ut,e=new ut,r=new ut){this.a=t,this.b=e,this.c=r}static getNormal(t,e,r,i){i.subVectors(r,e),ki.subVectors(t,e),i.cross(ki);const s=i.lengthSq();return s>0?i.multiplyScalar(1/Math.sqrt(s)):i.set(0,0,0)}static getBarycoord(t,e,r,i,s){ki.subVectors(i,e),hn.subVectors(r,e),bh.subVectors(t,e);const o=ki.dot(ki),l=ki.dot(hn),u=ki.dot(bh),f=hn.dot(hn),d=hn.dot(bh),p=o*f-l*l;if(p===0)return s.set(0,0,0),null;const g=1/p,m=(f*u-l*d)*g,x=(o*d-l*u)*g;return s.set(1-m-x,x,m)}static containsPoint(t,e,r,i){return this.getBarycoord(t,e,r,i,ln)===null?!1:ln.x>=0&&ln.y>=0&&ln.x+ln.y<=1}static getInterpolation(t,e,r,i,s,o,l,u){return this.getBarycoord(t,e,r,i,ln)===null?(u.x=0,u.y=0,"z"in u&&(u.z=0),"w"in u&&(u.w=0),null):(u.setScalar(0),u.addScaledVector(s,ln.x),u.addScaledVector(o,ln.y),u.addScaledVector(l,ln.z),u)}static getInterpolatedAttribute(t,e,r,i,s,o){return Th.setScalar(0),Sh.setScalar(0),kh.setScalar(0),Th.fromBufferAttribute(t,e),Sh.fromBufferAttribute(t,r),kh.fromBufferAttribute(t,i),o.setScalar(0),o.addScaledVector(Th,s.x),o.addScaledVector(Sh,s.y),o.addScaledVector(kh,s.z),o}static isFrontFacing(t,e,r,i){return ki.subVectors(r,e),hn.subVectors(t,e),ki.cross(hn).dot(i)<0}set(t,e,r){return this.a.copy(t),this.b.copy(e),this.c.copy(r),this}setFromPointsAndIndices(t,e,r,i){return this.a.copy(t[e]),this.b.copy(t[r]),this.c.copy(t[i]),this}setFromAttributeAndIndices(t,e,r,i){return this.a.fromBufferAttribute(t,e),this.b.fromBufferAttribute(t,r),this.c.fromBufferAttribute(t,i),this}clone(){return new this.constructor().copy(this)}copy(t){return this.a.copy(t.a),this.b.copy(t.b),this.c.copy(t.c),this}getArea(){return ki.subVectors(this.c,this.b),hn.subVectors(this.a,this.b),ki.cross(hn).length()*.5}getMidpoint(t){return t.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(t){return Ai.getNormal(this.a,this.b,this.c,t)}getPlane(t){return t.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(t,e){return Ai.getBarycoord(t,this.a,this.b,this.c,e)}getInterpolation(t,e,r,i,s){return Ai.getInterpolation(t,this.a,this.b,this.c,e,r,i,s)}containsPoint(t){return Ai.containsPoint(t,this.a,this.b,this.c)}isFrontFacing(t){return Ai.isFrontFacing(this.a,this.b,this.c,t)}intersectsBox(t){return t.intersectsTriangle(this)}closestPointToPoint(t,e){const r=this.a,i=this.b,s=this.c;let o,l;Ur.subVectors(i,r),Zr.subVectors(s,r),Lh.subVectors(t,r);const u=Ur.dot(Lh),f=Zr.dot(Lh);if(u<=0&&f<=0)return e.copy(r);Mh.subVectors(t,i);const d=Ur.dot(Mh),p=Zr.dot(Mh);if(d>=0&&p<=d)return e.copy(i);const g=u*p-d*f;if(g<=0&&u>=0&&d<=0)return o=u/(u-d),e.copy(r).addScaledVector(Ur,o);Eh.subVectors(t,s);const m=Ur.dot(Eh),x=Zr.dot(Eh);if(x>=0&&m<=x)return e.copy(s);const v=m*f-u*x;if(v<=0&&f>=0&&x<=0)return l=f/(f-x),e.copy(r).addScaledVector(Zr,l);const b=d*x-m*p;if(b<=0&&p-d>=0&&m-x>=0)return Bu.subVectors(s,i),l=(p-d)/(p-d+(m-x)),e.copy(i).addScaledVector(Bu,l);const P=1/(b+v+g);return o=v*P,l=g*P,e.copy(r).addScaledVector(Ur,o).addScaledVector(Zr,l)}equals(t){return t.a.equals(this.a)&&t.b.equals(this.b)&&t.c.equals(this.c)}}const tf={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Tn={h:0,s:0,l:0},Qo={h:0,s:0,l:0};function Ah(h,t,e){return e<0&&(e+=1),e>1&&(e-=1),e<1/6?h+(t-h)*6*e:e<1/2?t:e<2/3?h+(t-h)*6*(2/3-e):h}class sr{constructor(t,e,r){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(t,e,r)}set(t,e,r){if(e===void 0&&r===void 0){const i=t;i&&i.isColor?this.copy(i):typeof i=="number"?this.setHex(i):typeof i=="string"&&this.setStyle(i)}else this.setRGB(t,e,r);return this}setScalar(t){return this.r=t,this.g=t,this.b=t,this}setHex(t,e=gi){return t=Math.floor(t),this.r=(t>>16&255)/255,this.g=(t>>8&255)/255,this.b=(t&255)/255,Ei.toWorkingColorSpace(this,e),this}setRGB(t,e,r,i=Ei.workingColorSpace){return this.r=t,this.g=e,this.b=r,Ei.toWorkingColorSpace(this,i),this}setHSL(t,e,r,i=Ei.workingColorSpace){if(t=xl(t,1),e=Ht(e,0,1),r=Ht(r,0,1),e===0)this.r=this.g=this.b=r;else{const s=r<=.5?r*(1+e):r+e-r*e,o=2*r-s;this.r=Ah(o,s,t+1/3),this.g=Ah(o,s,t),this.b=Ah(o,s,t-1/3)}return Ei.toWorkingColorSpace(this,i),this}setStyle(t,e=gi){function r(s){s!==void 0&&parseFloat(s)<1&&console.warn("THREE.Color: Alpha component of "+t+" will be ignored.")}let i;if(i=/^(\w+)\(([^\)]*)\)/.exec(t)){let s;const o=i[1],l=i[2];switch(o){case"rgb":case"rgba":if(s=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(l))return r(s[4]),this.setRGB(Math.min(255,parseInt(s[1],10))/255,Math.min(255,parseInt(s[2],10))/255,Math.min(255,parseInt(s[3],10))/255,e);if(s=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(l))return r(s[4]),this.setRGB(Math.min(100,parseInt(s[1],10))/100,Math.min(100,parseInt(s[2],10))/100,Math.min(100,parseInt(s[3],10))/100,e);break;case"hsl":case"hsla":if(s=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(l))return r(s[4]),this.setHSL(parseFloat(s[1])/360,parseFloat(s[2])/100,parseFloat(s[3])/100,e);break;default:console.warn("THREE.Color: Unknown color model "+t)}}else if(i=/^\#([A-Fa-f\d]+)$/.exec(t)){const s=i[1],o=s.length;if(o===3)return this.setRGB(parseInt(s.charAt(0),16)/15,parseInt(s.charAt(1),16)/15,parseInt(s.charAt(2),16)/15,e);if(o===6)return this.setHex(parseInt(s,16),e);console.warn("THREE.Color: Invalid hex color "+t)}else if(t&&t.length>0)return this.setColorName(t,e);return this}setColorName(t,e=gi){const r=tf[t.toLowerCase()];return r!==void 0?this.setHex(r,e):console.warn("THREE.Color: Unknown color "+t),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(t){return this.r=t.r,this.g=t.g,this.b=t.b,this}copySRGBToLinear(t){return this.r=un(t.r),this.g=un(t.g),this.b=un(t.b),this}copyLinearToSRGB(t){return this.r=$r(t.r),this.g=$r(t.g),this.b=$r(t.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(t=gi){return Ei.fromWorkingColorSpace(Ie.copy(this),t),Math.round(Ht(Ie.r*255,0,255))*65536+Math.round(Ht(Ie.g*255,0,255))*256+Math.round(Ht(Ie.b*255,0,255))}getHexString(t=gi){return("000000"+this.getHex(t).toString(16)).slice(-6)}getHSL(t,e=Ei.workingColorSpace){Ei.fromWorkingColorSpace(Ie.copy(this),e);const r=Ie.r,i=Ie.g,s=Ie.b,o=Math.max(r,i,s),l=Math.min(r,i,s);let u,f;const d=(l+o)/2;if(l===o)u=0,f=0;else{const p=o-l;switch(f=d<=.5?p/(o+l):p/(2-o-l),o){case r:u=(i-s)/p+(i<s?6:0);break;case i:u=(s-r)/p+2;break;case s:u=(r-i)/p+4;break}u/=6}return t.h=u,t.s=f,t.l=d,t}getRGB(t,e=Ei.workingColorSpace){return Ei.fromWorkingColorSpace(Ie.copy(this),e),t.r=Ie.r,t.g=Ie.g,t.b=Ie.b,t}getStyle(t=gi){Ei.fromWorkingColorSpace(Ie.copy(this),t);const e=Ie.r,r=Ie.g,i=Ie.b;return t!==gi?`color(${t} ${e.toFixed(3)} ${r.toFixed(3)} ${i.toFixed(3)})`:`rgb(${Math.round(e*255)},${Math.round(r*255)},${Math.round(i*255)})`}offsetHSL(t,e,r){return this.getHSL(Tn),this.setHSL(Tn.h+t,Tn.s+e,Tn.l+r)}add(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this}addColors(t,e){return this.r=t.r+e.r,this.g=t.g+e.g,this.b=t.b+e.b,this}addScalar(t){return this.r+=t,this.g+=t,this.b+=t,this}sub(t){return this.r=Math.max(0,this.r-t.r),this.g=Math.max(0,this.g-t.g),this.b=Math.max(0,this.b-t.b),this}multiply(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this}multiplyScalar(t){return this.r*=t,this.g*=t,this.b*=t,this}lerp(t,e){return this.r+=(t.r-this.r)*e,this.g+=(t.g-this.g)*e,this.b+=(t.b-this.b)*e,this}lerpColors(t,e,r){return this.r=t.r+(e.r-t.r)*r,this.g=t.g+(e.g-t.g)*r,this.b=t.b+(e.b-t.b)*r,this}lerpHSL(t,e){this.getHSL(Tn),t.getHSL(Qo);const r=Ws(Tn.h,Qo.h,e),i=Ws(Tn.s,Qo.s,e),s=Ws(Tn.l,Qo.l,e);return this.setHSL(r,i,s),this}setFromVector3(t){return this.r=t.x,this.g=t.y,this.b=t.z,this}applyMatrix3(t){const e=this.r,r=this.g,i=this.b,s=t.elements;return this.r=s[0]*e+s[3]*r+s[6]*i,this.g=s[1]*e+s[4]*r+s[7]*i,this.b=s[2]*e+s[5]*r+s[8]*i,this}equals(t){return t.r===this.r&&t.g===this.g&&t.b===this.b}fromArray(t,e=0){return this.r=t[e],this.g=t[e+1],this.b=t[e+2],this}toArray(t=[],e=0){return t[e]=this.r,t[e+1]=this.g,t[e+2]=this.b,t}fromBufferAttribute(t,e){return this.r=t.getX(e),this.g=t.getY(e),this.b=t.getZ(e),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const Ie=new sr;sr.NAMES=tf;let Dm=0;class ef extends Fa{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:Dm++}),this.uuid=ur(),this.name="",this.type="Material",this.blending=mu,this.side=Jh,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=gu,this.blendDst=yu,this.blendEquation=_u,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new sr(0,0,0),this.blendAlpha=0,this.depthFunc=vu,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=bu,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=zr,this.stencilZFail=zr,this.stencilZPass=zr,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(t){this._alphaTest>0!=t>0&&this.version++,this._alphaTest=t}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(t){if(t!==void 0)for(const e in t){const r=t[e];if(r===void 0){console.warn(`THREE.Material: parameter '${e}' has value of undefined.`);continue}const i=this[e];if(i===void 0){console.warn(`THREE.Material: '${e}' is not a property of THREE.${this.type}.`);continue}i&&i.isColor?i.set(r):i&&i.isVector3&&r&&r.isVector3?i.copy(r):this[e]=r}}toJSON(t){const e=t===void 0||typeof t=="string";e&&(t={textures:{},images:{}});const r={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};r.uuid=this.uuid,r.type=this.type,this.name!==""&&(r.name=this.name),this.color&&this.color.isColor&&(r.color=this.color.getHex()),this.roughness!==void 0&&(r.roughness=this.roughness),this.metalness!==void 0&&(r.metalness=this.metalness),this.sheen!==void 0&&(r.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(r.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(r.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(r.emissive=this.emissive.getHex()),this.emissiveIntensity!==void 0&&this.emissiveIntensity!==1&&(r.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(r.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(r.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(r.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(r.shininess=this.shininess),this.clearcoat!==void 0&&(r.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(r.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(r.clearcoatMap=this.clearcoatMap.toJSON(t).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(r.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(t).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(r.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(t).uuid,r.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.dispersion!==void 0&&(r.dispersion=this.dispersion),this.iridescence!==void 0&&(r.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(r.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(r.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(r.iridescenceMap=this.iridescenceMap.toJSON(t).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(r.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(t).uuid),this.anisotropy!==void 0&&(r.anisotropy=this.anisotropy),this.anisotropyRotation!==void 0&&(r.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(r.anisotropyMap=this.anisotropyMap.toJSON(t).uuid),this.map&&this.map.isTexture&&(r.map=this.map.toJSON(t).uuid),this.matcap&&this.matcap.isTexture&&(r.matcap=this.matcap.toJSON(t).uuid),this.alphaMap&&this.alphaMap.isTexture&&(r.alphaMap=this.alphaMap.toJSON(t).uuid),this.lightMap&&this.lightMap.isTexture&&(r.lightMap=this.lightMap.toJSON(t).uuid,r.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(r.aoMap=this.aoMap.toJSON(t).uuid,r.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(r.bumpMap=this.bumpMap.toJSON(t).uuid,r.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(r.normalMap=this.normalMap.toJSON(t).uuid,r.normalMapType=this.normalMapType,r.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(r.displacementMap=this.displacementMap.toJSON(t).uuid,r.displacementScale=this.displacementScale,r.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(r.roughnessMap=this.roughnessMap.toJSON(t).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(r.metalnessMap=this.metalnessMap.toJSON(t).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(r.emissiveMap=this.emissiveMap.toJSON(t).uuid),this.specularMap&&this.specularMap.isTexture&&(r.specularMap=this.specularMap.toJSON(t).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(r.specularIntensityMap=this.specularIntensityMap.toJSON(t).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(r.specularColorMap=this.specularColorMap.toJSON(t).uuid),this.envMap&&this.envMap.isTexture&&(r.envMap=this.envMap.toJSON(t).uuid,this.combine!==void 0&&(r.combine=this.combine)),this.envMapRotation!==void 0&&(r.envMapRotation=this.envMapRotation.toArray()),this.envMapIntensity!==void 0&&(r.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(r.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(r.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(r.gradientMap=this.gradientMap.toJSON(t).uuid),this.transmission!==void 0&&(r.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(r.transmissionMap=this.transmissionMap.toJSON(t).uuid),this.thickness!==void 0&&(r.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(r.thicknessMap=this.thicknessMap.toJSON(t).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(r.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(r.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(r.size=this.size),this.shadowSide!==null&&(r.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(r.sizeAttenuation=this.sizeAttenuation),this.blending!==mu&&(r.blending=this.blending),this.side!==Jh&&(r.side=this.side),this.vertexColors===!0&&(r.vertexColors=!0),this.opacity<1&&(r.opacity=this.opacity),this.transparent===!0&&(r.transparent=!0),this.blendSrc!==gu&&(r.blendSrc=this.blendSrc),this.blendDst!==yu&&(r.blendDst=this.blendDst),this.blendEquation!==_u&&(r.blendEquation=this.blendEquation),this.blendSrcAlpha!==null&&(r.blendSrcAlpha=this.blendSrcAlpha),this.blendDstAlpha!==null&&(r.blendDstAlpha=this.blendDstAlpha),this.blendEquationAlpha!==null&&(r.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(r.blendColor=this.blendColor.getHex()),this.blendAlpha!==0&&(r.blendAlpha=this.blendAlpha),this.depthFunc!==vu&&(r.depthFunc=this.depthFunc),this.depthTest===!1&&(r.depthTest=this.depthTest),this.depthWrite===!1&&(r.depthWrite=this.depthWrite),this.colorWrite===!1&&(r.colorWrite=this.colorWrite),this.stencilWriteMask!==255&&(r.stencilWriteMask=this.stencilWriteMask),this.stencilFunc!==bu&&(r.stencilFunc=this.stencilFunc),this.stencilRef!==0&&(r.stencilRef=this.stencilRef),this.stencilFuncMask!==255&&(r.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==zr&&(r.stencilFail=this.stencilFail),this.stencilZFail!==zr&&(r.stencilZFail=this.stencilZFail),this.stencilZPass!==zr&&(r.stencilZPass=this.stencilZPass),this.stencilWrite===!0&&(r.stencilWrite=this.stencilWrite),this.rotation!==void 0&&this.rotation!==0&&(r.rotation=this.rotation),this.polygonOffset===!0&&(r.polygonOffset=!0),this.polygonOffsetFactor!==0&&(r.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(r.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(r.linewidth=this.linewidth),this.dashSize!==void 0&&(r.dashSize=this.dashSize),this.gapSize!==void 0&&(r.gapSize=this.gapSize),this.scale!==void 0&&(r.scale=this.scale),this.dithering===!0&&(r.dithering=!0),this.alphaTest>0&&(r.alphaTest=this.alphaTest),this.alphaHash===!0&&(r.alphaHash=!0),this.alphaToCoverage===!0&&(r.alphaToCoverage=!0),this.premultipliedAlpha===!0&&(r.premultipliedAlpha=!0),this.forceSinglePass===!0&&(r.forceSinglePass=!0),this.wireframe===!0&&(r.wireframe=!0),this.wireframeLinewidth>1&&(r.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(r.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(r.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(r.flatShading=!0),this.visible===!1&&(r.visible=!1),this.toneMapped===!1&&(r.toneMapped=!1),this.fog===!1&&(r.fog=!1),Object.keys(this.userData).length>0&&(r.userData=this.userData);function i(s){const o=[];for(const l in s){const u=s[l];delete u.metadata,o.push(u)}return o}if(e){const s=i(t.textures),o=i(t.images);s.length>0&&(r.textures=s),o.length>0&&(r.images=o)}return r}clone(){return new this.constructor().copy(this)}copy(t){this.name=t.name,this.blending=t.blending,this.side=t.side,this.vertexColors=t.vertexColors,this.opacity=t.opacity,this.transparent=t.transparent,this.blendSrc=t.blendSrc,this.blendDst=t.blendDst,this.blendEquation=t.blendEquation,this.blendSrcAlpha=t.blendSrcAlpha,this.blendDstAlpha=t.blendDstAlpha,this.blendEquationAlpha=t.blendEquationAlpha,this.blendColor.copy(t.blendColor),this.blendAlpha=t.blendAlpha,this.depthFunc=t.depthFunc,this.depthTest=t.depthTest,this.depthWrite=t.depthWrite,this.stencilWriteMask=t.stencilWriteMask,this.stencilFunc=t.stencilFunc,this.stencilRef=t.stencilRef,this.stencilFuncMask=t.stencilFuncMask,this.stencilFail=t.stencilFail,this.stencilZFail=t.stencilZFail,this.stencilZPass=t.stencilZPass,this.stencilWrite=t.stencilWrite;const e=t.clippingPlanes;let r=null;if(e!==null){const i=e.length;r=new Array(i);for(let s=0;s!==i;++s)r[s]=e[s].clone()}return this.clippingPlanes=r,this.clipIntersection=t.clipIntersection,this.clipShadows=t.clipShadows,this.shadowSide=t.shadowSide,this.colorWrite=t.colorWrite,this.precision=t.precision,this.polygonOffset=t.polygonOffset,this.polygonOffsetFactor=t.polygonOffsetFactor,this.polygonOffsetUnits=t.polygonOffsetUnits,this.dithering=t.dithering,this.alphaTest=t.alphaTest,this.alphaHash=t.alphaHash,this.alphaToCoverage=t.alphaToCoverage,this.premultipliedAlpha=t.premultipliedAlpha,this.forceSinglePass=t.forceSinglePass,this.visible=t.visible,this.toneMapped=t.toneMapped,this.userData=JSON.parse(JSON.stringify(t.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(t){t===!0&&this.version++}onBuild(){console.warn("Material: onBuild() has been removed.")}}class Bm extends ef{constructor(t){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new sr(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Dn,this.combine=Jp,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.envMapRotation.copy(t.envMapRotation),this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.fog=t.fog,this}}const ge=new ut,ta=new Pt;class Ne{constructor(t,e,r=!1){if(Array.isArray(t))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=t,this.itemSize=e,this.count=t!==void 0?t.length/e:0,this.normalized=r,this.usage=Lu,this.updateRanges=[],this.gpuType=im,this.version=0}onUploadCallback(){}set needsUpdate(t){t===!0&&this.version++}setUsage(t){return this.usage=t,this}addUpdateRange(t,e){this.updateRanges.push({start:t,count:e})}clearUpdateRanges(){this.updateRanges.length=0}copy(t){return this.name=t.name,this.array=new t.array.constructor(t.array),this.itemSize=t.itemSize,this.count=t.count,this.normalized=t.normalized,this.usage=t.usage,this.gpuType=t.gpuType,this}copyAt(t,e,r){t*=this.itemSize,r*=e.itemSize;for(let i=0,s=this.itemSize;i<s;i++)this.array[t+i]=e.array[r+i];return this}copyArray(t){return this.array.set(t),this}applyMatrix3(t){if(this.itemSize===2)for(let e=0,r=this.count;e<r;e++)ta.fromBufferAttribute(this,e),ta.applyMatrix3(t),this.setXY(e,ta.x,ta.y);else if(this.itemSize===3)for(let e=0,r=this.count;e<r;e++)ge.fromBufferAttribute(this,e),ge.applyMatrix3(t),this.setXYZ(e,ge.x,ge.y,ge.z);return this}applyMatrix4(t){for(let e=0,r=this.count;e<r;e++)ge.fromBufferAttribute(this,e),ge.applyMatrix4(t),this.setXYZ(e,ge.x,ge.y,ge.z);return this}applyNormalMatrix(t){for(let e=0,r=this.count;e<r;e++)ge.fromBufferAttribute(this,e),ge.applyNormalMatrix(t),this.setXYZ(e,ge.x,ge.y,ge.z);return this}transformDirection(t){for(let e=0,r=this.count;e<r;e++)ge.fromBufferAttribute(this,e),ge.transformDirection(t),this.setXYZ(e,ge.x,ge.y,ge.z);return this}set(t,e=0){return this.array.set(t,e),this}getComponent(t,e){let r=this.array[t*this.itemSize+e];return this.normalized&&(r=Wr(r,this.array)),r}setComponent(t,e,r){return this.normalized&&(r=Be(r,this.array)),this.array[t*this.itemSize+e]=r,this}getX(t){let e=this.array[t*this.itemSize];return this.normalized&&(e=Wr(e,this.array)),e}setX(t,e){return this.normalized&&(e=Be(e,this.array)),this.array[t*this.itemSize]=e,this}getY(t){let e=this.array[t*this.itemSize+1];return this.normalized&&(e=Wr(e,this.array)),e}setY(t,e){return this.normalized&&(e=Be(e,this.array)),this.array[t*this.itemSize+1]=e,this}getZ(t){let e=this.array[t*this.itemSize+2];return this.normalized&&(e=Wr(e,this.array)),e}setZ(t,e){return this.normalized&&(e=Be(e,this.array)),this.array[t*this.itemSize+2]=e,this}getW(t){let e=this.array[t*this.itemSize+3];return this.normalized&&(e=Wr(e,this.array)),e}setW(t,e){return this.normalized&&(e=Be(e,this.array)),this.array[t*this.itemSize+3]=e,this}setXY(t,e,r){return t*=this.itemSize,this.normalized&&(e=Be(e,this.array),r=Be(r,this.array)),this.array[t+0]=e,this.array[t+1]=r,this}setXYZ(t,e,r,i){return t*=this.itemSize,this.normalized&&(e=Be(e,this.array),r=Be(r,this.array),i=Be(i,this.array)),this.array[t+0]=e,this.array[t+1]=r,this.array[t+2]=i,this}setXYZW(t,e,r,i,s){return t*=this.itemSize,this.normalized&&(e=Be(e,this.array),r=Be(r,this.array),i=Be(i,this.array),s=Be(s,this.array)),this.array[t+0]=e,this.array[t+1]=r,this.array[t+2]=i,this.array[t+3]=s,this}onUpload(t){return this.onUploadCallback=t,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const t={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(t.name=this.name),this.usage!==Lu&&(t.usage=this.usage),t}}class Nm extends Ne{constructor(t,e,r){super(new Uint16Array(t),e,r)}}class Fm extends Ne{constructor(t,e,r){super(new Uint32Array(t),e,r)}}class Kr extends Ne{constructor(t,e,r){super(new Float32Array(t),e,r)}}let Um=0;const pi=new qe,Ph=new Gi,Gr=new ut,Ke=new no,Os=new no,Te=new ut;class rs extends Fa{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:Um++}),this.uuid=ur(),this.name="",this.type="BufferGeometry",this.index=null,this.indirect=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(t){return Array.isArray(t)?this.index=new(bm(t)?Fm:Nm)(t,1):this.index=t,this}setIndirect(t){return this.indirect=t,this}getIndirect(){return this.indirect}getAttribute(t){return this.attributes[t]}setAttribute(t,e){return this.attributes[t]=e,this}deleteAttribute(t){return delete this.attributes[t],this}hasAttribute(t){return this.attributes[t]!==void 0}addGroup(t,e,r=0){this.groups.push({start:t,count:e,materialIndex:r})}clearGroups(){this.groups=[]}setDrawRange(t,e){this.drawRange.start=t,this.drawRange.count=e}applyMatrix4(t){const e=this.attributes.position;e!==void 0&&(e.applyMatrix4(t),e.needsUpdate=!0);const r=this.attributes.normal;if(r!==void 0){const s=new Bn().getNormalMatrix(t);r.applyNormalMatrix(s),r.needsUpdate=!0}const i=this.attributes.tangent;return i!==void 0&&(i.transformDirection(t),i.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(t){return pi.makeRotationFromQuaternion(t),this.applyMatrix4(pi),this}rotateX(t){return pi.makeRotationX(t),this.applyMatrix4(pi),this}rotateY(t){return pi.makeRotationY(t),this.applyMatrix4(pi),this}rotateZ(t){return pi.makeRotationZ(t),this.applyMatrix4(pi),this}translate(t,e,r){return pi.makeTranslation(t,e,r),this.applyMatrix4(pi),this}scale(t,e,r){return pi.makeScale(t,e,r),this.applyMatrix4(pi),this}lookAt(t){return Ph.lookAt(t),Ph.updateMatrix(),this.applyMatrix4(Ph.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(Gr).negate(),this.translate(Gr.x,Gr.y,Gr.z),this}setFromPoints(t){const e=this.getAttribute("position");if(e===void 0){const r=[];for(let i=0,s=t.length;i<s;i++){const o=t[i];r.push(o.x,o.y,o.z||0)}this.setAttribute("position",new Kr(r,3))}else{const r=Math.min(t.length,e.count);for(let i=0;i<r;i++){const s=t[i];e.setXYZ(i,s.x,s.y,s.z||0)}t.length>e.count&&console.warn("THREE.BufferGeometry: Buffer size too small for points data. Use .dispose() and create a new geometry."),e.needsUpdate=!0}return this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new no);const t=this.attributes.position,e=this.morphAttributes.position;if(t&&t.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box.",this),this.boundingBox.set(new ut(-1/0,-1/0,-1/0),new ut(1/0,1/0,1/0));return}if(t!==void 0){if(this.boundingBox.setFromBufferAttribute(t),e)for(let r=0,i=e.length;r<i;r++){const s=e[r];Ke.setFromBufferAttribute(s),this.morphTargetsRelative?(Te.addVectors(this.boundingBox.min,Ke.min),this.boundingBox.expandByPoint(Te),Te.addVectors(this.boundingBox.max,Ke.max),this.boundingBox.expandByPoint(Te)):(this.boundingBox.expandByPoint(Ke.min),this.boundingBox.expandByPoint(Ke.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Qc);const t=this.attributes.position,e=this.morphAttributes.position;if(t&&t.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere.",this),this.boundingSphere.set(new ut,1/0);return}if(t){const r=this.boundingSphere.center;if(Ke.setFromBufferAttribute(t),e)for(let s=0,o=e.length;s<o;s++){const l=e[s];Os.setFromBufferAttribute(l),this.morphTargetsRelative?(Te.addVectors(Ke.min,Os.min),Ke.expandByPoint(Te),Te.addVectors(Ke.max,Os.max),Ke.expandByPoint(Te)):(Ke.expandByPoint(Os.min),Ke.expandByPoint(Os.max))}Ke.getCenter(r);let i=0;for(let s=0,o=t.count;s<o;s++)Te.fromBufferAttribute(t,s),i=Math.max(i,r.distanceToSquared(Te));if(e)for(let s=0,o=e.length;s<o;s++){const l=e[s],u=this.morphTargetsRelative;for(let f=0,d=l.count;f<d;f++)Te.fromBufferAttribute(l,f),u&&(Gr.fromBufferAttribute(t,f),Te.add(Gr)),i=Math.max(i,r.distanceToSquared(Te))}this.boundingSphere.radius=Math.sqrt(i),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const t=this.index,e=this.attributes;if(t===null||e.position===void 0||e.normal===void 0||e.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const r=e.position,i=e.normal,s=e.uv;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new Ne(new Float32Array(4*r.count),4));const o=this.getAttribute("tangent"),l=[],u=[];for(let S=0;S<r.count;S++)l[S]=new ut,u[S]=new ut;const f=new ut,d=new ut,p=new ut,g=new Pt,m=new Pt,x=new Pt,v=new ut,b=new ut;function P(S,k,O){f.fromBufferAttribute(r,S),d.fromBufferAttribute(r,k),p.fromBufferAttribute(r,O),g.fromBufferAttribute(s,S),m.fromBufferAttribute(s,k),x.fromBufferAttribute(s,O),d.sub(f),p.sub(f),m.sub(g),x.sub(g);const N=1/(m.x*x.y-x.x*m.y);isFinite(N)&&(v.copy(d).multiplyScalar(x.y).addScaledVector(p,-m.y).multiplyScalar(N),b.copy(p).multiplyScalar(m.x).addScaledVector(d,-x.x).multiplyScalar(N),l[S].add(v),l[k].add(v),l[O].add(v),u[S].add(b),u[k].add(b),u[O].add(b))}let A=this.groups;A.length===0&&(A=[{start:0,count:t.count}]);for(let S=0,k=A.length;S<k;++S){const O=A[S],N=O.start,E=O.count;for(let C=N,y=N+E;C<y;C+=3)P(t.getX(C+0),t.getX(C+1),t.getX(C+2))}const B=new ut,Z=new ut,I=new ut,K=new ut;function V(S){I.fromBufferAttribute(i,S),K.copy(I);const k=l[S];B.copy(k),B.sub(I.multiplyScalar(I.dot(k))).normalize(),Z.crossVectors(K,k);const N=Z.dot(u[S])<0?-1:1;o.setXYZW(S,B.x,B.y,B.z,N)}for(let S=0,k=A.length;S<k;++S){const O=A[S],N=O.start,E=O.count;for(let C=N,y=N+E;C<y;C+=3)V(t.getX(C+0)),V(t.getX(C+1)),V(t.getX(C+2))}}computeVertexNormals(){const t=this.index,e=this.getAttribute("position");if(e!==void 0){let r=this.getAttribute("normal");if(r===void 0)r=new Ne(new Float32Array(e.count*3),3),this.setAttribute("normal",r);else for(let g=0,m=r.count;g<m;g++)r.setXYZ(g,0,0,0);const i=new ut,s=new ut,o=new ut,l=new ut,u=new ut,f=new ut,d=new ut,p=new ut;if(t)for(let g=0,m=t.count;g<m;g+=3){const x=t.getX(g+0),v=t.getX(g+1),b=t.getX(g+2);i.fromBufferAttribute(e,x),s.fromBufferAttribute(e,v),o.fromBufferAttribute(e,b),d.subVectors(o,s),p.subVectors(i,s),d.cross(p),l.fromBufferAttribute(r,x),u.fromBufferAttribute(r,v),f.fromBufferAttribute(r,b),l.add(d),u.add(d),f.add(d),r.setXYZ(x,l.x,l.y,l.z),r.setXYZ(v,u.x,u.y,u.z),r.setXYZ(b,f.x,f.y,f.z)}else for(let g=0,m=e.count;g<m;g+=3)i.fromBufferAttribute(e,g+0),s.fromBufferAttribute(e,g+1),o.fromBufferAttribute(e,g+2),d.subVectors(o,s),p.subVectors(i,s),d.cross(p),r.setXYZ(g+0,d.x,d.y,d.z),r.setXYZ(g+1,d.x,d.y,d.z),r.setXYZ(g+2,d.x,d.y,d.z);this.normalizeNormals(),r.needsUpdate=!0}}normalizeNormals(){const t=this.attributes.normal;for(let e=0,r=t.count;e<r;e++)Te.fromBufferAttribute(t,e),Te.normalize(),t.setXYZ(e,Te.x,Te.y,Te.z)}toNonIndexed(){function t(l,u){const f=l.array,d=l.itemSize,p=l.normalized,g=new f.constructor(u.length*d);let m=0,x=0;for(let v=0,b=u.length;v<b;v++){l.isInterleavedBufferAttribute?m=u[v]*l.data.stride+l.offset:m=u[v]*d;for(let P=0;P<d;P++)g[x++]=f[m++]}return new Ne(g,d,p)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const e=new rs,r=this.index.array,i=this.attributes;for(const l in i){const u=i[l],f=t(u,r);e.setAttribute(l,f)}const s=this.morphAttributes;for(const l in s){const u=[],f=s[l];for(let d=0,p=f.length;d<p;d++){const g=f[d],m=t(g,r);u.push(m)}e.morphAttributes[l]=u}e.morphTargetsRelative=this.morphTargetsRelative;const o=this.groups;for(let l=0,u=o.length;l<u;l++){const f=o[l];e.addGroup(f.start,f.count,f.materialIndex)}return e}toJSON(){const t={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(t.uuid=this.uuid,t.type=this.type,this.name!==""&&(t.name=this.name),Object.keys(this.userData).length>0&&(t.userData=this.userData),this.parameters!==void 0){const u=this.parameters;for(const f in u)u[f]!==void 0&&(t[f]=u[f]);return t}t.data={attributes:{}};const e=this.index;e!==null&&(t.data.index={type:e.array.constructor.name,array:Array.prototype.slice.call(e.array)});const r=this.attributes;for(const u in r){const f=r[u];t.data.attributes[u]=f.toJSON(t.data)}const i={};let s=!1;for(const u in this.morphAttributes){const f=this.morphAttributes[u],d=[];for(let p=0,g=f.length;p<g;p++){const m=f[p];d.push(m.toJSON(t.data))}d.length>0&&(i[u]=d,s=!0)}s&&(t.data.morphAttributes=i,t.data.morphTargetsRelative=this.morphTargetsRelative);const o=this.groups;o.length>0&&(t.data.groups=JSON.parse(JSON.stringify(o)));const l=this.boundingSphere;return l!==null&&(t.data.boundingSphere={center:l.center.toArray(),radius:l.radius}),t}clone(){return new this.constructor().copy(this)}copy(t){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const e={};this.name=t.name;const r=t.index;r!==null&&this.setIndex(r.clone(e));const i=t.attributes;for(const f in i){const d=i[f];this.setAttribute(f,d.clone(e))}const s=t.morphAttributes;for(const f in s){const d=[],p=s[f];for(let g=0,m=p.length;g<m;g++)d.push(p[g].clone(e));this.morphAttributes[f]=d}this.morphTargetsRelative=t.morphTargetsRelative;const o=t.groups;for(let f=0,d=o.length;f<d;f++){const p=o[f];this.addGroup(p.start,p.count,p.materialIndex)}const l=t.boundingBox;l!==null&&(this.boundingBox=l.clone());const u=t.boundingSphere;return u!==null&&(this.boundingSphere=u.clone()),this.drawRange.start=t.drawRange.start,this.drawRange.count=t.drawRange.count,this.userData=t.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const Nu=new qe,tr=new km,ea=new Qc,Fu=new ut,ia=new ut,na=new ut,ra=new ut,Ch=new ut,sa=new ut,Uu=new ut,oa=new ut;class Zu extends Gi{constructor(t=new rs,e=new Bm){super(),this.isMesh=!0,this.type="Mesh",this.geometry=t,this.material=e,this.updateMorphTargets()}copy(t,e){return super.copy(t,e),t.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=t.morphTargetInfluences.slice()),t.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},t.morphTargetDictionary)),this.material=Array.isArray(t.material)?t.material.slice():t.material,this.geometry=t.geometry,this}updateMorphTargets(){const e=this.geometry.morphAttributes,r=Object.keys(e);if(r.length>0){const i=e[r[0]];if(i!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=i.length;s<o;s++){const l=i[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[l]=s}}}}getVertexPosition(t,e){const r=this.geometry,i=r.attributes.position,s=r.morphAttributes.position,o=r.morphTargetsRelative;e.fromBufferAttribute(i,t);const l=this.morphTargetInfluences;if(s&&l){sa.set(0,0,0);for(let u=0,f=s.length;u<f;u++){const d=l[u],p=s[u];d!==0&&(Ch.fromBufferAttribute(p,t),o?sa.addScaledVector(Ch,d):sa.addScaledVector(Ch.sub(e),d))}e.add(sa)}return e}raycast(t,e){const r=this.geometry,i=this.material,s=this.matrixWorld;i!==void 0&&(r.boundingSphere===null&&r.computeBoundingSphere(),ea.copy(r.boundingSphere),ea.applyMatrix4(s),tr.copy(t.ray).recast(t.near),!(ea.containsPoint(tr.origin)===!1&&(tr.intersectSphere(ea,Fu)===null||tr.origin.distanceToSquared(Fu)>(t.far-t.near)**2))&&(Nu.copy(s).invert(),tr.copy(t.ray).applyMatrix4(Nu),!(r.boundingBox!==null&&tr.intersectsBox(r.boundingBox)===!1)&&this._computeIntersections(t,e,tr)))}_computeIntersections(t,e,r){let i;const s=this.geometry,o=this.material,l=s.index,u=s.attributes.position,f=s.attributes.uv,d=s.attributes.uv1,p=s.attributes.normal,g=s.groups,m=s.drawRange;if(l!==null)if(Array.isArray(o))for(let x=0,v=g.length;x<v;x++){const b=g[x],P=o[b.materialIndex],A=Math.max(b.start,m.start),B=Math.min(l.count,Math.min(b.start+b.count,m.start+m.count));for(let Z=A,I=B;Z<I;Z+=3){const K=l.getX(Z),V=l.getX(Z+1),S=l.getX(Z+2);i=aa(this,P,t,r,f,d,p,K,V,S),i&&(i.faceIndex=Math.floor(Z/3),i.face.materialIndex=b.materialIndex,e.push(i))}}else{const x=Math.max(0,m.start),v=Math.min(l.count,m.start+m.count);for(let b=x,P=v;b<P;b+=3){const A=l.getX(b),B=l.getX(b+1),Z=l.getX(b+2);i=aa(this,o,t,r,f,d,p,A,B,Z),i&&(i.faceIndex=Math.floor(b/3),e.push(i))}}else if(u!==void 0)if(Array.isArray(o))for(let x=0,v=g.length;x<v;x++){const b=g[x],P=o[b.materialIndex],A=Math.max(b.start,m.start),B=Math.min(u.count,Math.min(b.start+b.count,m.start+m.count));for(let Z=A,I=B;Z<I;Z+=3){const K=Z,V=Z+1,S=Z+2;i=aa(this,P,t,r,f,d,p,K,V,S),i&&(i.faceIndex=Math.floor(Z/3),i.face.materialIndex=b.materialIndex,e.push(i))}}else{const x=Math.max(0,m.start),v=Math.min(u.count,m.start+m.count);for(let b=x,P=v;b<P;b+=3){const A=b,B=b+1,Z=b+2;i=aa(this,o,t,r,f,d,p,A,B,Z),i&&(i.faceIndex=Math.floor(b/3),e.push(i))}}}}function Zm(h,t,e,r,i,s,o,l){let u;if(t.side===Xp?u=r.intersectTriangle(o,s,i,!0,l):u=r.intersectTriangle(i,s,o,t.side===Jh,l),u===null)return null;oa.copy(l),oa.applyMatrix4(h.matrixWorld);const f=e.ray.origin.distanceTo(oa);return f<e.near||f>e.far?null:{distance:f,point:oa.clone(),object:h}}function aa(h,t,e,r,i,s,o,l,u,f){h.getVertexPosition(l,ia),h.getVertexPosition(u,na),h.getVertexPosition(f,ra);const d=Zm(h,t,e,r,ia,na,ra,Uu);if(d){const p=new ut;Ai.getBarycoord(Uu,ia,na,ra,p),i&&(d.uv=Ai.getInterpolatedAttribute(i,l,u,f,p,new Pt)),s&&(d.uv1=Ai.getInterpolatedAttribute(s,l,u,f,p,new Pt)),o&&(d.normal=Ai.getInterpolatedAttribute(o,l,u,f,p,new ut),d.normal.dot(r.direction)>0&&d.normal.multiplyScalar(-1));const g={a:l,b:u,c:f,normal:new ut,materialIndex:0};Ai.getNormal(ia,na,ra,g.normal),d.face=g,d.barycoord=p}return d}class tl extends Gi{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.backgroundRotation=new Dn,this.environmentIntensity=1,this.environmentRotation=new Dn,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(t,e){return super.copy(t,e),t.background!==null&&(this.background=t.background.clone()),t.environment!==null&&(this.environment=t.environment.clone()),t.fog!==null&&(this.fog=t.fog.clone()),this.backgroundBlurriness=t.backgroundBlurriness,this.backgroundIntensity=t.backgroundIntensity,this.backgroundRotation.copy(t.backgroundRotation),this.environmentIntensity=t.environmentIntensity,this.environmentRotation.copy(t.environmentRotation),t.overrideMaterial!==null&&(this.overrideMaterial=t.overrideMaterial.clone()),this.matrixAutoUpdate=t.matrixAutoUpdate,this}toJSON(t){const e=super.toJSON(t);return this.fog!==null&&(e.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(e.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(e.object.backgroundIntensity=this.backgroundIntensity),e.object.backgroundRotation=this.backgroundRotation.toArray(),this.environmentIntensity!==1&&(e.object.environmentIntensity=this.environmentIntensity),e.object.environmentRotation=this.environmentRotation.toArray(),e}}class zh extends Cn{constructor(t,e,r,i,s,o,l,u,f,d,p,g){super(null,o,l,u,f,d,i,s,p,g),this.isCompressedTexture=!0,this.image={width:e,height:r},this.mipmaps=t,this.flipY=!1,this.generateMipmaps=!1}}class Wi{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(t,e){const r=this.getUtoTmapping(t);return this.getPoint(r,e)}getPoints(t=5){const e=[];for(let r=0;r<=t;r++)e.push(this.getPoint(r/t));return e}getSpacedPoints(t=5){const e=[];for(let r=0;r<=t;r++)e.push(this.getPointAt(r/t));return e}getLength(){const t=this.getLengths();return t[t.length-1]}getLengths(t=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===t+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const e=[];let r,i=this.getPoint(0),s=0;e.push(0);for(let o=1;o<=t;o++)r=this.getPoint(o/t),s+=r.distanceTo(i),e.push(s),i=r;return this.cacheArcLengths=e,e}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(t,e){const r=this.getLengths();let i=0;const s=r.length;let o;e?o=e:o=t*r[s-1];let l=0,u=s-1,f;for(;l<=u;)if(i=Math.floor(l+(u-l)/2),f=r[i]-o,f<0)l=i+1;else if(f>0)u=i-1;else{u=i;break}if(i=u,r[i]===o)return i/(s-1);const d=r[i],g=r[i+1]-d,m=(o-d)/g;return(i+m)/(s-1)}getTangent(t,e){let i=t-1e-4,s=t+1e-4;i<0&&(i=0),s>1&&(s=1);const o=this.getPoint(i),l=this.getPoint(s),u=e||(o.isVector2?new Pt:new ut);return u.copy(l).sub(o).normalize(),u}getTangentAt(t,e){const r=this.getUtoTmapping(t);return this.getTangent(r,e)}computeFrenetFrames(t,e){const r=new ut,i=[],s=[],o=[],l=new ut,u=new qe;for(let m=0;m<=t;m++){const x=m/t;i[m]=this.getTangentAt(x,new ut)}s[0]=new ut,o[0]=new ut;let f=Number.MAX_VALUE;const d=Math.abs(i[0].x),p=Math.abs(i[0].y),g=Math.abs(i[0].z);d<=f&&(f=d,r.set(1,0,0)),p<=f&&(f=p,r.set(0,1,0)),g<=f&&r.set(0,0,1),l.crossVectors(i[0],r).normalize(),s[0].crossVectors(i[0],l),o[0].crossVectors(i[0],s[0]);for(let m=1;m<=t;m++){if(s[m]=s[m-1].clone(),o[m]=o[m-1].clone(),l.crossVectors(i[m-1],i[m]),l.length()>Number.EPSILON){l.normalize();const x=Math.acos(Ht(i[m-1].dot(i[m]),-1,1));s[m].applyMatrix4(u.makeRotationAxis(l,x))}o[m].crossVectors(i[m],s[m])}if(e===!0){let m=Math.acos(Ht(s[0].dot(s[t]),-1,1));m/=t,i[0].dot(l.crossVectors(s[0],s[t]))>0&&(m=-m);for(let x=1;x<=t;x++)s[x].applyMatrix4(u.makeRotationAxis(i[x],m*x)),o[x].crossVectors(i[x],s[x])}return{tangents:i,normals:s,binormals:o}}clone(){return new this.constructor().copy(this)}copy(t){return this.arcLengthDivisions=t.arcLengthDivisions,this}toJSON(){const t={metadata:{version:4.6,type:"Curve",generator:"Curve.toJSON"}};return t.arcLengthDivisions=this.arcLengthDivisions,t.type=this.type,t}fromJSON(t){return this.arcLengthDivisions=t.arcLengthDivisions,this}}class wl extends Wi{constructor(t=0,e=0,r=1,i=1,s=0,o=Math.PI*2,l=!1,u=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=t,this.aY=e,this.xRadius=r,this.yRadius=i,this.aStartAngle=s,this.aEndAngle=o,this.aClockwise=l,this.aRotation=u}getPoint(t,e=new Pt){const r=e,i=Math.PI*2;let s=this.aEndAngle-this.aStartAngle;const o=Math.abs(s)<Number.EPSILON;for(;s<0;)s+=i;for(;s>i;)s-=i;s<Number.EPSILON&&(o?s=0:s=i),this.aClockwise===!0&&!o&&(s===i?s=-i:s=s-i);const l=this.aStartAngle+t*s;let u=this.aX+this.xRadius*Math.cos(l),f=this.aY+this.yRadius*Math.sin(l);if(this.aRotation!==0){const d=Math.cos(this.aRotation),p=Math.sin(this.aRotation),g=u-this.aX,m=f-this.aY;u=g*d-m*p+this.aX,f=g*p+m*d+this.aY}return r.set(u,f)}copy(t){return super.copy(t),this.aX=t.aX,this.aY=t.aY,this.xRadius=t.xRadius,this.yRadius=t.yRadius,this.aStartAngle=t.aStartAngle,this.aEndAngle=t.aEndAngle,this.aClockwise=t.aClockwise,this.aRotation=t.aRotation,this}toJSON(){const t=super.toJSON();return t.aX=this.aX,t.aY=this.aY,t.xRadius=this.xRadius,t.yRadius=this.yRadius,t.aStartAngle=this.aStartAngle,t.aEndAngle=this.aEndAngle,t.aClockwise=this.aClockwise,t.aRotation=this.aRotation,t}fromJSON(t){return super.fromJSON(t),this.aX=t.aX,this.aY=t.aY,this.xRadius=t.xRadius,this.yRadius=t.yRadius,this.aStartAngle=t.aStartAngle,this.aEndAngle=t.aEndAngle,this.aClockwise=t.aClockwise,this.aRotation=t.aRotation,this}}class Gm extends wl{constructor(t,e,r,i,s,o){super(t,e,r,r,i,s,o),this.isArcCurve=!0,this.type="ArcCurve"}}function bl(){let h=0,t=0,e=0,r=0;function i(s,o,l,u){h=s,t=l,e=-3*s+3*o-2*l-u,r=2*s-2*o+l+u}return{initCatmullRom:function(s,o,l,u,f){i(o,l,f*(l-s),f*(u-o))},initNonuniformCatmullRom:function(s,o,l,u,f,d,p){let g=(o-s)/f-(l-s)/(f+d)+(l-o)/d,m=(l-o)/d-(u-o)/(d+p)+(u-l)/p;g*=d,m*=d,i(o,l,g,m)},calc:function(s){const o=s*s,l=o*s;return h+t*s+e*o+r*l}}}const ha=new ut,Ih=new bl,Oh=new bl,Rh=new bl;class Hm extends Wi{constructor(t=[],e=!1,r="centripetal",i=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=t,this.closed=e,this.curveType=r,this.tension=i}getPoint(t,e=new ut){const r=e,i=this.points,s=i.length,o=(s-(this.closed?0:1))*t;let l=Math.floor(o),u=o-l;this.closed?l+=l>0?0:(Math.floor(Math.abs(l)/s)+1)*s:u===0&&l===s-1&&(l=s-2,u=1);let f,d;this.closed||l>0?f=i[(l-1)%s]:(ha.subVectors(i[0],i[1]).add(i[0]),f=ha);const p=i[l%s],g=i[(l+1)%s];if(this.closed||l+2<s?d=i[(l+2)%s]:(ha.subVectors(i[s-1],i[s-2]).add(i[s-1]),d=ha),this.curveType==="centripetal"||this.curveType==="chordal"){const m=this.curveType==="chordal"?.5:.25;let x=Math.pow(f.distanceToSquared(p),m),v=Math.pow(p.distanceToSquared(g),m),b=Math.pow(g.distanceToSquared(d),m);v<1e-4&&(v=1),x<1e-4&&(x=v),b<1e-4&&(b=v),Ih.initNonuniformCatmullRom(f.x,p.x,g.x,d.x,x,v,b),Oh.initNonuniformCatmullRom(f.y,p.y,g.y,d.y,x,v,b),Rh.initNonuniformCatmullRom(f.z,p.z,g.z,d.z,x,v,b)}else this.curveType==="catmullrom"&&(Ih.initCatmullRom(f.x,p.x,g.x,d.x,this.tension),Oh.initCatmullRom(f.y,p.y,g.y,d.y,this.tension),Rh.initCatmullRom(f.z,p.z,g.z,d.z,this.tension));return r.set(Ih.calc(u),Oh.calc(u),Rh.calc(u)),r}copy(t){super.copy(t),this.points=[];for(let e=0,r=t.points.length;e<r;e++){const i=t.points[e];this.points.push(i.clone())}return this.closed=t.closed,this.curveType=t.curveType,this.tension=t.tension,this}toJSON(){const t=super.toJSON();t.points=[];for(let e=0,r=this.points.length;e<r;e++){const i=this.points[e];t.points.push(i.toArray())}return t.closed=this.closed,t.curveType=this.curveType,t.tension=this.tension,t}fromJSON(t){super.fromJSON(t),this.points=[];for(let e=0,r=t.points.length;e<r;e++){const i=t.points[e];this.points.push(new ut().fromArray(i))}return this.closed=t.closed,this.curveType=t.curveType,this.tension=t.tension,this}}function Gu(h,t,e,r,i){const s=(r-t)*.5,o=(i-e)*.5,l=h*h,u=h*l;return(2*e-2*r+s+o)*u+(-3*e+3*r-2*s-o)*l+s*h+e}function Wm(h,t){const e=1-h;return e*e*t}function Vm(h,t){return 2*(1-h)*h*t}function qm(h,t){return h*h*t}function Vs(h,t,e,r){return Wm(h,t)+Vm(h,e)+qm(h,r)}function Ym(h,t){const e=1-h;return e*e*e*t}function jm(h,t){const e=1-h;return 3*e*e*h*t}function Xm(h,t){return 3*(1-h)*h*h*t}function Jm(h,t){return h*h*h*t}function qs(h,t,e,r,i){return Ym(h,t)+jm(h,e)+Xm(h,r)+Jm(h,i)}class nf extends Wi{constructor(t=new Pt,e=new Pt,r=new Pt,i=new Pt){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=t,this.v1=e,this.v2=r,this.v3=i}getPoint(t,e=new Pt){const r=e,i=this.v0,s=this.v1,o=this.v2,l=this.v3;return r.set(qs(t,i.x,s.x,o.x,l.x),qs(t,i.y,s.y,o.y,l.y)),r}copy(t){return super.copy(t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this.v3.copy(t.v3),this}toJSON(){const t=super.toJSON();return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t.v3=this.v3.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this.v3.fromArray(t.v3),this}}class $m extends Wi{constructor(t=new ut,e=new ut,r=new ut,i=new ut){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=t,this.v1=e,this.v2=r,this.v3=i}getPoint(t,e=new ut){const r=e,i=this.v0,s=this.v1,o=this.v2,l=this.v3;return r.set(qs(t,i.x,s.x,o.x,l.x),qs(t,i.y,s.y,o.y,l.y),qs(t,i.z,s.z,o.z,l.z)),r}copy(t){return super.copy(t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this.v3.copy(t.v3),this}toJSON(){const t=super.toJSON();return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t.v3=this.v3.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this.v3.fromArray(t.v3),this}}class rf extends Wi{constructor(t=new Pt,e=new Pt){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=t,this.v2=e}getPoint(t,e=new Pt){const r=e;return t===1?r.copy(this.v2):(r.copy(this.v2).sub(this.v1),r.multiplyScalar(t).add(this.v1)),r}getPointAt(t,e){return this.getPoint(t,e)}getTangent(t,e=new Pt){return e.subVectors(this.v2,this.v1).normalize()}getTangentAt(t,e){return this.getTangent(t,e)}copy(t){return super.copy(t),this.v1.copy(t.v1),this.v2.copy(t.v2),this}toJSON(){const t=super.toJSON();return t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this}}class Km extends Wi{constructor(t=new ut,e=new ut){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=t,this.v2=e}getPoint(t,e=new ut){const r=e;return t===1?r.copy(this.v2):(r.copy(this.v2).sub(this.v1),r.multiplyScalar(t).add(this.v1)),r}getPointAt(t,e){return this.getPoint(t,e)}getTangent(t,e=new ut){return e.subVectors(this.v2,this.v1).normalize()}getTangentAt(t,e){return this.getTangent(t,e)}copy(t){return super.copy(t),this.v1.copy(t.v1),this.v2.copy(t.v2),this}toJSON(){const t=super.toJSON();return t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this}}class sf extends Wi{constructor(t=new Pt,e=new Pt,r=new Pt){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=t,this.v1=e,this.v2=r}getPoint(t,e=new Pt){const r=e,i=this.v0,s=this.v1,o=this.v2;return r.set(Vs(t,i.x,s.x,o.x),Vs(t,i.y,s.y,o.y)),r}copy(t){return super.copy(t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this}toJSON(){const t=super.toJSON();return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this}}class Qm extends Wi{constructor(t=new ut,e=new ut,r=new ut){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=t,this.v1=e,this.v2=r}getPoint(t,e=new ut){const r=e,i=this.v0,s=this.v1,o=this.v2;return r.set(Vs(t,i.x,s.x,o.x),Vs(t,i.y,s.y,o.y),Vs(t,i.z,s.z,o.z)),r}copy(t){return super.copy(t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this}toJSON(){const t=super.toJSON();return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this}}class of extends Wi{constructor(t=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=t}getPoint(t,e=new Pt){const r=e,i=this.points,s=(i.length-1)*t,o=Math.floor(s),l=s-o,u=i[o===0?o:o-1],f=i[o],d=i[o>i.length-2?i.length-1:o+1],p=i[o>i.length-3?i.length-1:o+2];return r.set(Gu(l,u.x,f.x,d.x,p.x),Gu(l,u.y,f.y,d.y,p.y)),r}copy(t){super.copy(t),this.points=[];for(let e=0,r=t.points.length;e<r;e++){const i=t.points[e];this.points.push(i.clone())}return this}toJSON(){const t=super.toJSON();t.points=[];for(let e=0,r=this.points.length;e<r;e++){const i=this.points[e];t.points.push(i.toArray())}return t}fromJSON(t){super.fromJSON(t),this.points=[];for(let e=0,r=t.points.length;e<r;e++){const i=t.points[e];this.points.push(new Pt().fromArray(i))}return this}}var el=Object.freeze({__proto__:null,ArcCurve:Gm,CatmullRomCurve3:Hm,CubicBezierCurve:nf,CubicBezierCurve3:$m,EllipseCurve:wl,LineCurve:rf,LineCurve3:Km,QuadraticBezierCurve:sf,QuadraticBezierCurve3:Qm,SplineCurve:of});class t_ extends Wi{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(t){this.curves.push(t)}closePath(){const t=this.curves[0].getPoint(0),e=this.curves[this.curves.length-1].getPoint(1);if(!t.equals(e)){const r=t.isVector2===!0?"LineCurve":"LineCurve3";this.curves.push(new el[r](e,t))}return this}getPoint(t,e){const r=t*this.getLength(),i=this.getCurveLengths();let s=0;for(;s<i.length;){if(i[s]>=r){const o=i[s]-r,l=this.curves[s],u=l.getLength(),f=u===0?0:1-o/u;return l.getPointAt(f,e)}s++}return null}getLength(){const t=this.getCurveLengths();return t[t.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const t=[];let e=0;for(let r=0,i=this.curves.length;r<i;r++)e+=this.curves[r].getLength(),t.push(e);return this.cacheLengths=t,t}getSpacedPoints(t=40){const e=[];for(let r=0;r<=t;r++)e.push(this.getPoint(r/t));return this.autoClose&&e.push(e[0]),e}getPoints(t=12){const e=[];let r;for(let i=0,s=this.curves;i<s.length;i++){const o=s[i],l=o.isEllipseCurve?t*2:o.isLineCurve||o.isLineCurve3?1:o.isSplineCurve?t*o.points.length:t,u=o.getPoints(l);for(let f=0;f<u.length;f++){const d=u[f];r&&r.equals(d)||(e.push(d),r=d)}}return this.autoClose&&e.length>1&&!e[e.length-1].equals(e[0])&&e.push(e[0]),e}copy(t){super.copy(t),this.curves=[];for(let e=0,r=t.curves.length;e<r;e++){const i=t.curves[e];this.curves.push(i.clone())}return this.autoClose=t.autoClose,this}toJSON(){const t=super.toJSON();t.autoClose=this.autoClose,t.curves=[];for(let e=0,r=this.curves.length;e<r;e++){const i=this.curves[e];t.curves.push(i.toJSON())}return t}fromJSON(t){super.fromJSON(t),this.autoClose=t.autoClose,this.curves=[];for(let e=0,r=t.curves.length;e<r;e++){const i=t.curves[e];this.curves.push(new el[i.type]().fromJSON(i))}return this}}class Hu extends t_{constructor(t){super(),this.type="Path",this.currentPoint=new Pt,t&&this.setFromPoints(t)}setFromPoints(t){this.moveTo(t[0].x,t[0].y);for(let e=1,r=t.length;e<r;e++)this.lineTo(t[e].x,t[e].y);return this}moveTo(t,e){return this.currentPoint.set(t,e),this}lineTo(t,e){const r=new rf(this.currentPoint.clone(),new Pt(t,e));return this.curves.push(r),this.currentPoint.set(t,e),this}quadraticCurveTo(t,e,r,i){const s=new sf(this.currentPoint.clone(),new Pt(t,e),new Pt(r,i));return this.curves.push(s),this.currentPoint.set(r,i),this}bezierCurveTo(t,e,r,i,s,o){const l=new nf(this.currentPoint.clone(),new Pt(t,e),new Pt(r,i),new Pt(s,o));return this.curves.push(l),this.currentPoint.set(s,o),this}splineThru(t){const e=[this.currentPoint.clone()].concat(t),r=new of(e);return this.curves.push(r),this.currentPoint.copy(t[t.length-1]),this}arc(t,e,r,i,s,o){const l=this.currentPoint.x,u=this.currentPoint.y;return this.absarc(t+l,e+u,r,i,s,o),this}absarc(t,e,r,i,s,o){return this.absellipse(t,e,r,r,i,s,o),this}ellipse(t,e,r,i,s,o,l,u){const f=this.currentPoint.x,d=this.currentPoint.y;return this.absellipse(t+f,e+d,r,i,s,o,l,u),this}absellipse(t,e,r,i,s,o,l,u){const f=new wl(t,e,r,i,s,o,l,u);if(this.curves.length>0){const p=f.getPoint(0);p.equals(this.currentPoint)||this.lineTo(p.x,p.y)}this.curves.push(f);const d=f.getPoint(1);return this.currentPoint.copy(d),this}copy(t){return super.copy(t),this.currentPoint.copy(t.currentPoint),this}toJSON(){const t=super.toJSON();return t.currentPoint=this.currentPoint.toArray(),t}fromJSON(t){return super.fromJSON(t),this.currentPoint.fromArray(t.currentPoint),this}}class Aa extends Hu{constructor(t){super(t),this.uuid=ur(),this.type="Shape",this.holes=[]}getPointsHoles(t){const e=[];for(let r=0,i=this.holes.length;r<i;r++)e[r]=this.holes[r].getPoints(t);return e}extractPoints(t){return{shape:this.getPoints(t),holes:this.getPointsHoles(t)}}copy(t){super.copy(t),this.holes=[];for(let e=0,r=t.holes.length;e<r;e++){const i=t.holes[e];this.holes.push(i.clone())}return this}toJSON(){const t=super.toJSON();t.uuid=this.uuid,t.holes=[];for(let e=0,r=this.holes.length;e<r;e++){const i=this.holes[e];t.holes.push(i.toJSON())}return t}fromJSON(t){super.fromJSON(t),this.uuid=t.uuid,this.holes=[];for(let e=0,r=t.holes.length;e<r;e++){const i=t.holes[e];this.holes.push(new Hu().fromJSON(i))}return this}}const e_={triangulate:function(h,t,e=2){const r=t&&t.length,i=r?t[0]*e:h.length;let s=af(h,0,i,e,!0);const o=[];if(!s||s.next===s.prev)return o;let l,u,f,d,p,g,m;if(r&&(s=o_(h,t,s,e)),h.length>80*e){l=f=h[0],u=d=h[1];for(let x=e;x<i;x+=e)p=h[x],g=h[x+1],p<l&&(l=p),g<u&&(u=g),p>f&&(f=p),g>d&&(d=g);m=Math.max(f-l,d-u),m=m!==0?32767/m:0}return Xs(s,o,e,l,u,m,0),o}};function af(h,t,e,r,i){let s,o;if(i===g_(h,t,e,r)>0)for(s=t;s<e;s+=r)o=Wu(s,h[s],h[s+1],o);else for(s=e-r;s>=t;s-=r)o=Wu(s,h[s],h[s+1],o);return o&&Ua(o,o.next)&&($s(o),o=o.next),o}function or(h,t){if(!h)return h;t||(t=h);let e=h,r;do if(r=!1,!e.steiner&&(Ua(e,e.next)||le(e.prev,e,e.next)===0)){if($s(e),e=t=e.prev,e===e.next)break;r=!0}else e=e.next;while(r||e!==t);return t}function Xs(h,t,e,r,i,s,o){if(!h)return;!o&&s&&c_(h,r,i,s);let l=h,u,f;for(;h.prev!==h.next;){if(u=h.prev,f=h.next,s?n_(h,r,i,s):i_(h)){t.push(u.i/e|0),t.push(h.i/e|0),t.push(f.i/e|0),$s(h),h=f.next,l=f.next;continue}if(h=f,h===l){o?o===1?(h=r_(or(h),t,e),Xs(h,t,e,r,i,s,2)):o===2&&s_(h,t,e,r,i,s):Xs(or(h),t,e,r,i,s,1);break}}}function i_(h){const t=h.prev,e=h,r=h.next;if(le(t,e,r)>=0)return!1;const i=t.x,s=e.x,o=r.x,l=t.y,u=e.y,f=r.y,d=i<s?i<o?i:o:s<o?s:o,p=l<u?l<f?l:f:u<f?u:f,g=i>s?i>o?i:o:s>o?s:o,m=l>u?l>f?l:f:u>f?u:f;let x=r.next;for(;x!==t;){if(x.x>=d&&x.x<=g&&x.y>=p&&x.y<=m&&qr(i,l,s,u,o,f,x.x,x.y)&&le(x.prev,x,x.next)>=0)return!1;x=x.next}return!0}function n_(h,t,e,r){const i=h.prev,s=h,o=h.next;if(le(i,s,o)>=0)return!1;const l=i.x,u=s.x,f=o.x,d=i.y,p=s.y,g=o.y,m=l<u?l<f?l:f:u<f?u:f,x=d<p?d<g?d:g:p<g?p:g,v=l>u?l>f?l:f:u>f?u:f,b=d>p?d>g?d:g:p>g?p:g,P=il(m,x,t,e,r),A=il(v,b,t,e,r);let B=h.prevZ,Z=h.nextZ;for(;B&&B.z>=P&&Z&&Z.z<=A;){if(B.x>=m&&B.x<=v&&B.y>=x&&B.y<=b&&B!==i&&B!==o&&qr(l,d,u,p,f,g,B.x,B.y)&&le(B.prev,B,B.next)>=0||(B=B.prevZ,Z.x>=m&&Z.x<=v&&Z.y>=x&&Z.y<=b&&Z!==i&&Z!==o&&qr(l,d,u,p,f,g,Z.x,Z.y)&&le(Z.prev,Z,Z.next)>=0))return!1;Z=Z.nextZ}for(;B&&B.z>=P;){if(B.x>=m&&B.x<=v&&B.y>=x&&B.y<=b&&B!==i&&B!==o&&qr(l,d,u,p,f,g,B.x,B.y)&&le(B.prev,B,B.next)>=0)return!1;B=B.prevZ}for(;Z&&Z.z<=A;){if(Z.x>=m&&Z.x<=v&&Z.y>=x&&Z.y<=b&&Z!==i&&Z!==o&&qr(l,d,u,p,f,g,Z.x,Z.y)&&le(Z.prev,Z,Z.next)>=0)return!1;Z=Z.nextZ}return!0}function r_(h,t,e){let r=h;do{const i=r.prev,s=r.next.next;!Ua(i,s)&&hf(i,r,r.next,s)&&Js(i,s)&&Js(s,i)&&(t.push(i.i/e|0),t.push(r.i/e|0),t.push(s.i/e|0),$s(r),$s(r.next),r=h=s),r=r.next}while(r!==h);return or(r)}function s_(h,t,e,r,i,s){let o=h;do{let l=o.next.next;for(;l!==o.prev;){if(o.i!==l.i&&p_(o,l)){let u=lf(o,l);o=or(o,o.next),u=or(u,u.next),Xs(o,t,e,r,i,s,0),Xs(u,t,e,r,i,s,0);return}l=l.next}o=o.next}while(o!==h)}function o_(h,t,e,r){const i=[];let s,o,l,u,f;for(s=0,o=t.length;s<o;s++)l=t[s]*r,u=s<o-1?t[s+1]*r:h.length,f=af(h,l,u,r,!1),f===f.next&&(f.steiner=!0),i.push(d_(f));for(i.sort(a_),s=0;s<i.length;s++)e=h_(i[s],e);return e}function a_(h,t){return h.x-t.x}function h_(h,t){const e=l_(h,t);if(!e)return t;const r=lf(e,h);return or(r,r.next),or(e,e.next)}function l_(h,t){let e=t,r=-1/0,i;const s=h.x,o=h.y;do{if(o<=e.y&&o>=e.next.y&&e.next.y!==e.y){const g=e.x+(o-e.y)*(e.next.x-e.x)/(e.next.y-e.y);if(g<=s&&g>r&&(r=g,i=e.x<e.next.x?e:e.next,g===s))return i}e=e.next}while(e!==t);if(!i)return null;const l=i,u=i.x,f=i.y;let d=1/0,p;e=i;do s>=e.x&&e.x>=u&&s!==e.x&&qr(o<f?s:r,o,u,f,o<f?r:s,o,e.x,e.y)&&(p=Math.abs(o-e.y)/(s-e.x),Js(e,h)&&(p<d||p===d&&(e.x>i.x||e.x===i.x&&u_(i,e)))&&(i=e,d=p)),e=e.next;while(e!==l);return i}function u_(h,t){return le(h.prev,h,t.prev)<0&&le(t.next,h,h.next)<0}function c_(h,t,e,r){let i=h;do i.z===0&&(i.z=il(i.x,i.y,t,e,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next;while(i!==h);i.prevZ.nextZ=null,i.prevZ=null,f_(i)}function f_(h){let t,e,r,i,s,o,l,u,f=1;do{for(e=h,h=null,s=null,o=0;e;){for(o++,r=e,l=0,t=0;t<f&&(l++,r=r.nextZ,!!r);t++);for(u=f;l>0||u>0&&r;)l!==0&&(u===0||!r||e.z<=r.z)?(i=e,e=e.nextZ,l--):(i=r,r=r.nextZ,u--),s?s.nextZ=i:h=i,i.prevZ=s,s=i;e=r}s.nextZ=null,f*=2}while(o>1);return h}function il(h,t,e,r,i){return h=(h-e)*i|0,t=(t-r)*i|0,h=(h|h<<8)&16711935,h=(h|h<<4)&252645135,h=(h|h<<2)&858993459,h=(h|h<<1)&1431655765,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,h|t<<1}function d_(h){let t=h,e=h;do(t.x<e.x||t.x===e.x&&t.y<e.y)&&(e=t),t=t.next;while(t!==h);return e}function qr(h,t,e,r,i,s,o,l){return(i-o)*(t-l)>=(h-o)*(s-l)&&(h-o)*(r-l)>=(e-o)*(t-l)&&(e-o)*(s-l)>=(i-o)*(r-l)}function p_(h,t){return h.next.i!==t.i&&h.prev.i!==t.i&&!m_(h,t)&&(Js(h,t)&&Js(t,h)&&__(h,t)&&(le(h.prev,h,t.prev)||le(h,t.prev,t))||Ua(h,t)&&le(h.prev,h,h.next)>0&&le(t.prev,t,t.next)>0)}function le(h,t,e){return(t.y-h.y)*(e.x-t.x)-(t.x-h.x)*(e.y-t.y)}function Ua(h,t){return h.x===t.x&&h.y===t.y}function hf(h,t,e,r){const i=ua(le(h,t,e)),s=ua(le(h,t,r)),o=ua(le(e,r,h)),l=ua(le(e,r,t));return!!(i!==s&&o!==l||i===0&&la(h,e,t)||s===0&&la(h,r,t)||o===0&&la(e,h,r)||l===0&&la(e,t,r))}function la(h,t,e){return t.x<=Math.max(h.x,e.x)&&t.x>=Math.min(h.x,e.x)&&t.y<=Math.max(h.y,e.y)&&t.y>=Math.min(h.y,e.y)}function ua(h){return h>0?1:h<0?-1:0}function m_(h,t){let e=h;do{if(e.i!==h.i&&e.next.i!==h.i&&e.i!==t.i&&e.next.i!==t.i&&hf(e,e.next,h,t))return!0;e=e.next}while(e!==h);return!1}function Js(h,t){return le(h.prev,h,h.next)<0?le(h,t,h.next)>=0&&le(h,h.prev,t)>=0:le(h,t,h.prev)<0||le(h,h.next,t)<0}function __(h,t){let e=h,r=!1;const i=(h.x+t.x)/2,s=(h.y+t.y)/2;do e.y>s!=e.next.y>s&&e.next.y!==e.y&&i<(e.next.x-e.x)*(s-e.y)/(e.next.y-e.y)+e.x&&(r=!r),e=e.next;while(e!==h);return r}function lf(h,t){const e=new nl(h.i,h.x,h.y),r=new nl(t.i,t.x,t.y),i=h.next,s=t.prev;return h.next=t,t.prev=h,e.next=i,i.prev=e,r.next=e,e.prev=r,s.next=r,r.prev=s,r}function Wu(h,t,e,r){const i=new nl(h,t,e);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function $s(h){h.next.prev=h.prev,h.prev.next=h.next,h.prevZ&&(h.prevZ.nextZ=h.nextZ),h.nextZ&&(h.nextZ.prevZ=h.prevZ)}function nl(h,t,e){this.i=h,this.x=t,this.y=e,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function g_(h,t,e,r){let i=0;for(let s=t,o=e-r;s<e;s+=r)i+=(h[o]-h[s])*(h[s+1]+h[o+1]),o=s;return i}class zn{static area(t){const e=t.length;let r=0;for(let i=e-1,s=0;s<e;i=s++)r+=t[i].x*t[s].y-t[s].x*t[i].y;return r*.5}static isClockWise(t){return zn.area(t)<0}static triangulateShape(t,e){const r=[],i=[],s=[];Vu(t),qu(r,t);let o=t.length;e.forEach(Vu);for(let u=0;u<e.length;u++)i.push(o),o+=e[u].length,qu(r,e[u]);const l=e_.triangulate(r,i);for(let u=0;u<l.length;u+=3)s.push(l.slice(u,u+3));return s}}function Vu(h){const t=h.length;t>2&&h[t-1].equals(h[0])&&h.pop()}function qu(h,t){for(let e=0;e<t.length;e++)h.push(t[e].x),h.push(t[e].y)}class Ll extends rs{constructor(t=new Aa([new Pt(.5,.5),new Pt(-.5,.5),new Pt(-.5,-.5),new Pt(.5,-.5)]),e={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:t,options:e},t=Array.isArray(t)?t:[t];const r=this,i=[],s=[];for(let l=0,u=t.length;l<u;l++){const f=t[l];o(f)}this.setAttribute("position",new Kr(i,3)),this.setAttribute("uv",new Kr(s,2)),this.computeVertexNormals();function o(l){const u=[],f=e.curveSegments!==void 0?e.curveSegments:12,d=e.steps!==void 0?e.steps:1,p=e.depth!==void 0?e.depth:1;let g=e.bevelEnabled!==void 0?e.bevelEnabled:!0,m=e.bevelThickness!==void 0?e.bevelThickness:.2,x=e.bevelSize!==void 0?e.bevelSize:m-.1,v=e.bevelOffset!==void 0?e.bevelOffset:0,b=e.bevelSegments!==void 0?e.bevelSegments:3;const P=e.extrudePath,A=e.UVGenerator!==void 0?e.UVGenerator:y_;let B,Z=!1,I,K,V,S;P&&(B=P.getSpacedPoints(d),Z=!0,g=!1,I=P.computeFrenetFrames(d,!1),K=new ut,V=new ut,S=new ut),g||(b=0,m=0,x=0,v=0);const k=l.extractPoints(f);let O=k.shape;const N=k.holes;if(!zn.isClockWise(O)){O=O.reverse();for(let ht=0,ft=N.length;ht<ft;ht++){const M=N[ht];zn.isClockWise(M)&&(N[ht]=M.reverse())}}const C=zn.triangulateShape(O,N),y=O;for(let ht=0,ft=N.length;ht<ft;ht++){const M=N[ht];O=O.concat(M)}function z(ht,ft,M){return ft||console.error("THREE.ExtrudeGeometry: vec does not exist"),ht.clone().addScaledVector(ft,M)}const H=O.length,G=C.length;function W(ht,ft,M){let et,j,U;const F=ht.x-ft.x,J=ht.y-ft.y,at=M.x-ht.x,lt=M.y-ht.y,it=F*F+J*J,_t=F*lt-J*at;if(Math.abs(_t)>Number.EPSILON){const xt=Math.sqrt(it),gt=Math.sqrt(at*at+lt*lt),Tt=ft.x-J/xt,Wt=ft.y+F/xt,kt=M.x-lt/gt,$t=M.y+at/gt,ce=((kt-Tt)*lt-($t-Wt)*at)/(F*lt-J*at);et=Tt+F*ce-ht.x,j=Wt+J*ce-ht.y;const se=et*et+j*j;if(se<=2)return new Pt(et,j);U=Math.sqrt(se/2)}else{let xt=!1;F>Number.EPSILON?at>Number.EPSILON&&(xt=!0):F<-Number.EPSILON?at<-Number.EPSILON&&(xt=!0):Math.sign(J)===Math.sign(lt)&&(xt=!0),xt?(et=-J,j=F,U=Math.sqrt(it)):(et=F,j=J,U=Math.sqrt(it/2))}return new Pt(et/U,j/U)}const X=[];for(let ht=0,ft=y.length,M=ft-1,et=ht+1;ht<ft;ht++,M++,et++)M===ft&&(M=0),et===ft&&(et=0),X[ht]=W(y[ht],y[M],y[et]);const tt=[];let q,Q=X.concat();for(let ht=0,ft=N.length;ht<ft;ht++){const M=N[ht];q=[];for(let et=0,j=M.length,U=j-1,F=et+1;et<j;et++,U++,F++)U===j&&(U=0),F===j&&(F=0),q[et]=W(M[et],M[U],M[F]);tt.push(q),Q=Q.concat(q)}for(let ht=0;ht<b;ht++){const ft=ht/b,M=m*Math.cos(ft*Math.PI/2),et=x*Math.sin(ft*Math.PI/2)+v;for(let j=0,U=y.length;j<U;j++){const F=z(y[j],X[j],et);Et(F.x,F.y,-M)}for(let j=0,U=N.length;j<U;j++){const F=N[j];q=tt[j];for(let J=0,at=F.length;J<at;J++){const lt=z(F[J],q[J],et);Et(lt.x,lt.y,-M)}}}const dt=x+v;for(let ht=0;ht<H;ht++){const ft=g?z(O[ht],Q[ht],dt):O[ht];Z?(V.copy(I.normals[0]).multiplyScalar(ft.x),K.copy(I.binormals[0]).multiplyScalar(ft.y),S.copy(B[0]).add(V).add(K),Et(S.x,S.y,S.z)):Et(ft.x,ft.y,0)}for(let ht=1;ht<=d;ht++)for(let ft=0;ft<H;ft++){const M=g?z(O[ft],Q[ft],dt):O[ft];Z?(V.copy(I.normals[ht]).multiplyScalar(M.x),K.copy(I.binormals[ht]).multiplyScalar(M.y),S.copy(B[ht]).add(V).add(K),Et(S.x,S.y,S.z)):Et(M.x,M.y,p/d*ht)}for(let ht=b-1;ht>=0;ht--){const ft=ht/b,M=m*Math.cos(ft*Math.PI/2),et=x*Math.sin(ft*Math.PI/2)+v;for(let j=0,U=y.length;j<U;j++){const F=z(y[j],X[j],et);Et(F.x,F.y,p+M)}for(let j=0,U=N.length;j<U;j++){const F=N[j];q=tt[j];for(let J=0,at=F.length;J<at;J++){const lt=z(F[J],q[J],et);Z?Et(lt.x,lt.y+B[d-1].y,B[d-1].x+M):Et(lt.x,lt.y,p+M)}}}ct(),rt();function ct(){const ht=i.length/3;if(g){let ft=0,M=H*ft;for(let et=0;et<G;et++){const j=C[et];St(j[2]+M,j[1]+M,j[0]+M)}ft=d+b*2,M=H*ft;for(let et=0;et<G;et++){const j=C[et];St(j[0]+M,j[1]+M,j[2]+M)}}else{for(let ft=0;ft<G;ft++){const M=C[ft];St(M[2],M[1],M[0])}for(let ft=0;ft<G;ft++){const M=C[ft];St(M[0]+H*d,M[1]+H*d,M[2]+H*d)}}r.addGroup(ht,i.length/3-ht,0)}function rt(){const ht=i.length/3;let ft=0;mt(y,ft),ft+=y.length;for(let M=0,et=N.length;M<et;M++){const j=N[M];mt(j,ft),ft+=j.length}r.addGroup(ht,i.length/3-ht,1)}function mt(ht,ft){let M=ht.length;for(;--M>=0;){const et=M;let j=M-1;j<0&&(j=ht.length-1);for(let U=0,F=d+b*2;U<F;U++){const J=H*U,at=H*(U+1),lt=ft+et+J,it=ft+j+J,_t=ft+j+at,xt=ft+et+at;Ot(lt,it,_t,xt)}}}function Et(ht,ft,M){u.push(ht),u.push(ft),u.push(M)}function St(ht,ft,M){bt(ht),bt(ft),bt(M);const et=i.length/3,j=A.generateTopUV(r,i,et-3,et-2,et-1);vt(j[0]),vt(j[1]),vt(j[2])}function Ot(ht,ft,M,et){bt(ht),bt(ft),bt(et),bt(ft),bt(M),bt(et);const j=i.length/3,U=A.generateSideWallUV(r,i,j-6,j-3,j-2,j-1);vt(U[0]),vt(U[1]),vt(U[3]),vt(U[1]),vt(U[2]),vt(U[3])}function bt(ht){i.push(u[ht*3+0]),i.push(u[ht*3+1]),i.push(u[ht*3+2])}function vt(ht){s.push(ht.x),s.push(ht.y)}}}copy(t){return super.copy(t),this.parameters=Object.assign({},t.parameters),this}toJSON(){const t=super.toJSON(),e=this.parameters.shapes,r=this.parameters.options;return v_(e,r,t)}static fromJSON(t,e){const r=[];for(let s=0,o=t.shapes.length;s<o;s++){const l=e[t.shapes[s]];r.push(l)}const i=t.options.extrudePath;return i!==void 0&&(t.options.extrudePath=new el[i.type]().fromJSON(i)),new Ll(r,t.options)}}const y_={generateTopUV:function(h,t,e,r,i){const s=t[e*3],o=t[e*3+1],l=t[r*3],u=t[r*3+1],f=t[i*3],d=t[i*3+1];return[new Pt(s,o),new Pt(l,u),new Pt(f,d)]},generateSideWallUV:function(h,t,e,r,i,s){const o=t[e*3],l=t[e*3+1],u=t[e*3+2],f=t[r*3],d=t[r*3+1],p=t[r*3+2],g=t[i*3],m=t[i*3+1],x=t[i*3+2],v=t[s*3],b=t[s*3+1],P=t[s*3+2];return Math.abs(l-d)<Math.abs(o-f)?[new Pt(o,1-u),new Pt(f,1-p),new Pt(g,1-x),new Pt(v,1-P)]:[new Pt(l,1-u),new Pt(d,1-p),new Pt(m,1-x),new Pt(b,1-P)]}};function v_(h,t,e){if(e.shapes=[],Array.isArray(h))for(let r=0,i=h.length;r<i;r++){const s=h[r];e.shapes.push(s.uuid)}else e.shapes.push(h.uuid);return e.options=Object.assign({},t),t.extrudePath!==void 0&&(e.options.extrudePath=t.extrudePath.toJSON()),e}class Ml extends rs{constructor(t=new Aa([new Pt(0,.5),new Pt(-.5,-.5),new Pt(.5,-.5)]),e=12){super(),this.type="ShapeGeometry",this.parameters={shapes:t,curveSegments:e};const r=[],i=[],s=[],o=[];let l=0,u=0;if(Array.isArray(t)===!1)f(t);else for(let d=0;d<t.length;d++)f(t[d]),this.addGroup(l,u,d),l+=u,u=0;this.setIndex(r),this.setAttribute("position",new Kr(i,3)),this.setAttribute("normal",new Kr(s,3)),this.setAttribute("uv",new Kr(o,2));function f(d){const p=i.length/3,g=d.extractPoints(e);let m=g.shape;const x=g.holes;zn.isClockWise(m)===!1&&(m=m.reverse());for(let b=0,P=x.length;b<P;b++){const A=x[b];zn.isClockWise(A)===!0&&(x[b]=A.reverse())}const v=zn.triangulateShape(m,x);for(let b=0,P=x.length;b<P;b++){const A=x[b];m=m.concat(A)}for(let b=0,P=m.length;b<P;b++){const A=m[b];i.push(A.x,A.y,0),s.push(0,0,1),o.push(A.x,A.y)}for(let b=0,P=v.length;b<P;b++){const A=v[b],B=A[0]+p,Z=A[1]+p,I=A[2]+p;r.push(B,Z,I),u+=3}}}copy(t){return super.copy(t),this.parameters=Object.assign({},t.parameters),this}toJSON(){const t=super.toJSON(),e=this.parameters.shapes;return x_(e,t)}static fromJSON(t,e){const r=[];for(let i=0,s=t.shapes.length;i<s;i++){const o=e[t.shapes[i]];r.push(o)}return new Ml(r,t.curveSegments)}}function x_(h,t){if(t.shapes=[],Array.isArray(h))for(let e=0,r=h.length;e<r;e++){const i=h[e];t.shapes.push(i.uuid)}else t.shapes.push(h.uuid);return t}class Yu extends ef{constructor(t){super(),this.isMeshStandardMaterial=!0,this.type="MeshStandardMaterial",this.defines={STANDARD:""},this.color=new sr(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new sr(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=sm,this.normalScale=new Pt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Dn,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.defines={STANDARD:""},this.color.copy(t.color),this.roughness=t.roughness,this.metalness=t.metalness,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.roughnessMap=t.roughnessMap,this.metalnessMap=t.metalnessMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.envMapRotation.copy(t.envMapRotation),this.envMapIntensity=t.envMapIntensity,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.flatShading=t.flatShading,this.fog=t.fog,this}}const El="\\[\\]\\.:\\/",w_=new RegExp("["+El+"]","g"),Tl="[^"+El+"]",b_="[^"+El.replace("\\.","")+"]",L_=/((?:WC+[\/:])*)/.source.replace("WC",Tl),M_=/(WCOD+)?/.source.replace("WCOD",b_),E_=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",Tl),T_=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",Tl),S_=new RegExp("^"+L_+M_+E_+T_+"$"),k_=["material","materials","bones","map"];class A_{constructor(t,e,r){const i=r||Xt.parseTrackName(e);this._targetGroup=t,this._bindings=t.subscribe_(e,i)}getValue(t,e){this.bind();const r=this._targetGroup.nCachedObjects_,i=this._bindings[r];i!==void 0&&i.getValue(t,e)}setValue(t,e){const r=this._bindings;for(let i=this._targetGroup.nCachedObjects_,s=r.length;i!==s;++i)r[i].setValue(t,e)}bind(){const t=this._bindings;for(let e=this._targetGroup.nCachedObjects_,r=t.length;e!==r;++e)t[e].bind()}unbind(){const t=this._bindings;for(let e=this._targetGroup.nCachedObjects_,r=t.length;e!==r;++e)t[e].unbind()}}class Xt{constructor(t,e,r){this.path=e,this.parsedPath=r||Xt.parseTrackName(e),this.node=Xt.findNode(t,this.parsedPath.nodeName),this.rootNode=t,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(t,e,r){return t&&t.isAnimationObjectGroup?new Xt.Composite(t,e,r):new Xt(t,e,r)}static sanitizeNodeName(t){return t.replace(/\s/g,"_").replace(w_,"")}static parseTrackName(t){const e=S_.exec(t);if(e===null)throw new Error("PropertyBinding: Cannot parse trackName: "+t);const r={nodeName:e[2],objectName:e[3],objectIndex:e[4],propertyName:e[5],propertyIndex:e[6]},i=r.nodeName&&r.nodeName.lastIndexOf(".");if(i!==void 0&&i!==-1){const s=r.nodeName.substring(i+1);k_.indexOf(s)!==-1&&(r.nodeName=r.nodeName.substring(0,i),r.objectName=s)}if(r.propertyName===null||r.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+t);return r}static findNode(t,e){if(e===void 0||e===""||e==="."||e===-1||e===t.name||e===t.uuid)return t;if(t.skeleton){const r=t.skeleton.getBoneByName(e);if(r!==void 0)return r}if(t.children){const r=function(s){for(let o=0;o<s.length;o++){const l=s[o];if(l.name===e||l.uuid===e)return l;const u=r(l.children);if(u)return u}return null},i=r(t.children);if(i)return i}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(t,e){t[e]=this.targetObject[this.propertyName]}_getValue_array(t,e){const r=this.resolvedProperty;for(let i=0,s=r.length;i!==s;++i)t[e++]=r[i]}_getValue_arrayElement(t,e){t[e]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(t,e){this.resolvedProperty.toArray(t,e)}_setValue_direct(t,e){this.targetObject[this.propertyName]=t[e]}_setValue_direct_setNeedsUpdate(t,e){this.targetObject[this.propertyName]=t[e],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(t,e){this.targetObject[this.propertyName]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(t,e){const r=this.resolvedProperty;for(let i=0,s=r.length;i!==s;++i)r[i]=t[e++]}_setValue_array_setNeedsUpdate(t,e){const r=this.resolvedProperty;for(let i=0,s=r.length;i!==s;++i)r[i]=t[e++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(t,e){const r=this.resolvedProperty;for(let i=0,s=r.length;i!==s;++i)r[i]=t[e++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(t,e){this.resolvedProperty[this.propertyIndex]=t[e]}_setValue_arrayElement_setNeedsUpdate(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(t,e){this.resolvedProperty.fromArray(t,e)}_setValue_fromArray_setNeedsUpdate(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(t,e){this.bind(),this.getValue(t,e)}_setValue_unbound(t,e){this.bind(),this.setValue(t,e)}bind(){let t=this.node;const e=this.parsedPath,r=e.objectName,i=e.propertyName;let s=e.propertyIndex;if(t||(t=Xt.findNode(this.rootNode,e.nodeName),this.node=t),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!t){console.warn("THREE.PropertyBinding: No target node found for track: "+this.path+".");return}if(r){let f=e.objectIndex;switch(r){case"materials":if(!t.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!t.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}t=t.material.materials;break;case"bones":if(!t.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}t=t.skeleton.bones;for(let d=0;d<t.length;d++)if(t[d].name===f){f=d;break}break;case"map":if("map"in t){t=t.map;break}if(!t.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!t.material.map){console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);return}t=t.material.map;break;default:if(t[r]===void 0){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}t=t[r]}if(f!==void 0){if(t[f]===void 0){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,t);return}t=t[f]}}const o=t[i];if(o===void 0){const f=e.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+f+"."+i+" but it wasn't found.",t);return}let l=this.Versioning.None;this.targetObject=t,t.isMaterial===!0?l=this.Versioning.NeedsUpdate:t.isObject3D===!0&&(l=this.Versioning.MatrixWorldNeedsUpdate);let u=this.BindingType.Direct;if(s!==void 0){if(i==="morphTargetInfluences"){if(!t.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(!t.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}t.morphTargetDictionary[s]!==void 0&&(s=t.morphTargetDictionary[s])}u=this.BindingType.ArrayElement,this.resolvedProperty=o,this.propertyIndex=s}else o.fromArray!==void 0&&o.toArray!==void 0?(u=this.BindingType.HasFromToArray,this.resolvedProperty=o):Array.isArray(o)?(u=this.BindingType.EntireArray,this.resolvedProperty=o):this.propertyName=i;this.getValue=this.GetterByBindingType[u],this.setValue=this.SetterByBindingTypeAndVersioning[u][l]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}Xt.Composite=A_;Xt.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3};Xt.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2};Xt.prototype.GetterByBindingType=[Xt.prototype._getValue_direct,Xt.prototype._getValue_array,Xt.prototype._getValue_arrayElement,Xt.prototype._getValue_toArray];Xt.prototype.SetterByBindingTypeAndVersioning=[[Xt.prototype._setValue_direct,Xt.prototype._setValue_direct_setNeedsUpdate,Xt.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[Xt.prototype._setValue_array,Xt.prototype._setValue_array_setNeedsUpdate,Xt.prototype._setValue_array_setMatrixWorldNeedsUpdate],[Xt.prototype._setValue_arrayElement,Xt.prototype._setValue_arrayElement_setNeedsUpdate,Xt.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[Xt.prototype._setValue_fromArray,Xt.prototype._setValue_fromArray_setNeedsUpdate,Xt.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:yl}}));typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=yl);const ju={POSITION:["byte","byte normalized","unsigned byte","unsigned byte normalized","short","short normalized","unsigned short","unsigned short normalized"],NORMAL:["byte normalized","short normalized"],TANGENT:["byte normalized","short normalized"],TEXCOORD:["byte","byte normalized","unsigned byte","short","short normalized","unsigned short"]};class Pa{constructor(){this.textureUtils=null,this.pluginCallbacks=[],this.register(function(t){return new F_(t)}),this.register(function(t){return new U_(t)}),this.register(function(t){return new W_(t)}),this.register(function(t){return new V_(t)}),this.register(function(t){return new q_(t)}),this.register(function(t){return new Y_(t)}),this.register(function(t){return new Z_(t)}),this.register(function(t){return new G_(t)}),this.register(function(t){return new H_(t)}),this.register(function(t){return new j_(t)}),this.register(function(t){return new X_(t)}),this.register(function(t){return new J_(t)}),this.register(function(t){return new $_(t)}),this.register(function(t){return new K_(t)})}register(t){return this.pluginCallbacks.indexOf(t)===-1&&this.pluginCallbacks.push(t),this}unregister(t){return this.pluginCallbacks.indexOf(t)!==-1&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(t),1),this}setTextureUtils(t){return this.textureUtils=t,this}parse(t,e,r,i){const s=new N_,o=[];for(let l=0,u=this.pluginCallbacks.length;l<u;l++)o.push(this.pluginCallbacks[l](s));s.setPlugins(o),s.setTextureUtils(this.textureUtils),s.writeAsync(t,e,i).catch(r)}parseAsync(t,e){const r=this;return new Promise(function(i,s){r.parse(t,i,s,e)})}}const qt={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,BYTE:5120,UNSIGNED_BYTE:5121,SHORT:5122,UNSIGNED_SHORT:5123,INT:5124,UNSIGNED_INT:5125,FLOAT:5126,ARRAY_BUFFER:34962,ELEMENT_ARRAY_BUFFER:34963,NEAREST:9728,LINEAR:9729,NEAREST_MIPMAP_NEAREST:9984,LINEAR_MIPMAP_NEAREST:9985,NEAREST_MIPMAP_LINEAR:9986,LINEAR_MIPMAP_LINEAR:9987,CLAMP_TO_EDGE:33071,MIRRORED_REPEAT:33648,REPEAT:10497},Dh="KHR_mesh_quantization",ei={};ei[$p]=qt.NEAREST;ei[Kp]=qt.NEAREST_MIPMAP_NEAREST;ei[Qp]=qt.NEAREST_MIPMAP_LINEAR;ei[Yc]=qt.LINEAR;ei[tm]=qt.LINEAR_MIPMAP_NEAREST;ei[jc]=qt.LINEAR_MIPMAP_LINEAR;ei[Us]=qt.CLAMP_TO_EDGE;ei[$h]=qt.REPEAT;ei[Kh]=qt.MIRRORED_REPEAT;const Xu={scale:"scale",position:"translation",quaternion:"rotation",morphTargetInfluences:"weights"},P_=new sr,Ju=12,C_=1179937895,z_=2,$u=8,I_=1313821514,O_=5130562;function Zs(h,t){return h.length===t.length&&h.every(function(e,r){return e===t[r]})}function R_(h){return new TextEncoder().encode(h).buffer}function D_(h){return Zs(h.elements,[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}function B_(h,t,e){const r={min:new Array(h.itemSize).fill(Number.POSITIVE_INFINITY),max:new Array(h.itemSize).fill(Number.NEGATIVE_INFINITY)};for(let i=t;i<t+e;i++)for(let s=0;s<h.itemSize;s++){let o;h.itemSize>4?o=h.array[i*h.itemSize+s]:(s===0?o=h.getX(i):s===1?o=h.getY(i):s===2?o=h.getZ(i):s===3&&(o=h.getW(i)),h.normalized===!0&&(o=Qh.normalize(o,h.array))),r.min[s]=Math.min(r.min[s],o),r.max[s]=Math.max(r.max[s],o)}return r}function uf(h){return Math.ceil(h/4)*4}function Bh(h,t=0){const e=uf(h.byteLength);if(e!==h.byteLength){const r=new Uint8Array(e);if(r.set(new Uint8Array(h)),t!==0)for(let i=h.byteLength;i<e;i++)r[i]=t;return r.buffer}return h}function Ku(){return typeof document>"u"&&typeof OffscreenCanvas<"u"?new OffscreenCanvas(1,1):document.createElement("canvas")}function Qu(h,t){if(h.toBlob!==void 0)return new Promise(r=>h.toBlob(r,t));let e;return t==="image/jpeg"?e=.92:t==="image/webp"&&(e=.8),h.convertToBlob({type:t,quality:e})}class N_{constructor(){this.plugins=[],this.options={},this.pending=[],this.buffers=[],this.byteOffset=0,this.buffers=[],this.nodeMap=new Map,this.skins=[],this.extensionsUsed={},this.extensionsRequired={},this.uids=new Map,this.uid=0,this.json={asset:{version:"2.0",generator:"THREE.GLTFExporter r"+yl}},this.cache={meshes:new Map,attributes:new Map,attributesNormalized:new Map,materials:new Map,textures:new Map,images:new Map},this.textureUtils=null}setPlugins(t){this.plugins=t}setTextureUtils(t){this.textureUtils=t}async writeAsync(t,e,r={}){this.options=Object.assign({binary:!1,trs:!1,onlyVisible:!0,maxTextureSize:1/0,animations:[],includeCustomExtensions:!1},r),this.options.animations.length>0&&(this.options.trs=!0),await this.processInputAsync(t),await Promise.all(this.pending);const i=this,s=i.buffers,o=i.json;r=i.options;const l=i.extensionsUsed,u=i.extensionsRequired,f=new Blob(s,{type:"application/octet-stream"}),d=Object.keys(l),p=Object.keys(u);if(d.length>0&&(o.extensionsUsed=d),p.length>0&&(o.extensionsRequired=p),o.buffers&&o.buffers.length>0&&(o.buffers[0].byteLength=f.size),r.binary===!0){const g=new FileReader;g.readAsArrayBuffer(f),g.onloadend=function(){const m=Bh(g.result),x=new DataView(new ArrayBuffer($u));x.setUint32(0,m.byteLength,!0),x.setUint32(4,O_,!0);const v=Bh(R_(JSON.stringify(o)),32),b=new DataView(new ArrayBuffer($u));b.setUint32(0,v.byteLength,!0),b.setUint32(4,I_,!0);const P=new ArrayBuffer(Ju),A=new DataView(P);A.setUint32(0,C_,!0),A.setUint32(4,z_,!0);const B=Ju+b.byteLength+v.byteLength+x.byteLength+m.byteLength;A.setUint32(8,B,!0);const Z=new Blob([P,b,v,x,m],{type:"application/octet-stream"}),I=new FileReader;I.readAsArrayBuffer(Z),I.onloadend=function(){e(I.result)}}}else if(o.buffers&&o.buffers.length>0){const g=new FileReader;g.readAsDataURL(f),g.onloadend=function(){const m=g.result;o.buffers[0].uri=m,e(o)}}else e(o)}serializeUserData(t,e){if(Object.keys(t.userData).length===0)return;const r=this.options,i=this.extensionsUsed;try{const s=JSON.parse(JSON.stringify(t.userData));if(r.includeCustomExtensions&&s.gltfExtensions){e.extensions===void 0&&(e.extensions={});for(const o in s.gltfExtensions)e.extensions[o]=s.gltfExtensions[o],i[o]=!0;delete s.gltfExtensions}Object.keys(s).length>0&&(e.extras=s)}catch(s){console.warn("THREE.GLTFExporter: userData of '"+t.name+"' won't be serialized because of JSON.stringify error - "+s.message)}}getUID(t,e=!1){if(this.uids.has(t)===!1){const i=new Map;i.set(!0,this.uid++),i.set(!1,this.uid++),this.uids.set(t,i)}return this.uids.get(t).get(e)}isNormalizedNormalAttribute(t){if(this.cache.attributesNormalized.has(t))return!1;const r=new ut;for(let i=0,s=t.count;i<s;i++)if(Math.abs(r.fromBufferAttribute(t,i).length()-1)>5e-4)return!1;return!0}createNormalizedNormalAttribute(t){const e=this.cache;if(e.attributesNormalized.has(t))return e.attributesNormalized.get(t);const r=t.clone(),i=new ut;for(let s=0,o=r.count;s<o;s++)i.fromBufferAttribute(r,s),i.x===0&&i.y===0&&i.z===0?i.setX(1):i.normalize(),r.setXYZ(s,i.x,i.y,i.z);return e.attributesNormalized.set(t,r),r}applyTextureTransform(t,e){let r=!1;const i={};(e.offset.x!==0||e.offset.y!==0)&&(i.offset=e.offset.toArray(),r=!0),e.rotation!==0&&(i.rotation=e.rotation,r=!0),(e.repeat.x!==1||e.repeat.y!==1)&&(i.scale=e.repeat.toArray(),r=!0),r&&(t.extensions=t.extensions||{},t.extensions.KHR_texture_transform=i,this.extensionsUsed.KHR_texture_transform=!0)}async buildMetalRoughTextureAsync(t,e){if(t===e)return t;function r(m){return m.colorSpace===gi?function(v){return v<.04045?v*.0773993808:Math.pow(v*.9478672986+.0521327014,2.4)}:function(v){return v}}t instanceof zh&&(t=await this.decompressTextureAsync(t)),e instanceof zh&&(e=await this.decompressTextureAsync(e));const i=t?t.image:null,s=e?e.image:null,o=Math.max(i?i.width:0,s?s.width:0),l=Math.max(i?i.height:0,s?s.height:0),u=Ku();u.width=o,u.height=l;const f=u.getContext("2d",{willReadFrequently:!0});f.fillStyle="#00ffff",f.fillRect(0,0,o,l);const d=f.getImageData(0,0,o,l);if(i){f.drawImage(i,0,0,o,l);const m=r(t),x=f.getImageData(0,0,o,l).data;for(let v=2;v<x.length;v+=4)d.data[v]=m(x[v]/256)*256}if(s){f.drawImage(s,0,0,o,l);const m=r(e),x=f.getImageData(0,0,o,l).data;for(let v=1;v<x.length;v+=4)d.data[v]=m(x[v]/256)*256}f.putImageData(d,0,0);const g=(t||e).clone();return g.source=new Kc(u),g.colorSpace=vl,g.channel=(t||e).channel,t&&e&&t.channel!==e.channel&&console.warn("THREE.GLTFExporter: UV channels for metalnessMap and roughnessMap textures must match."),console.warn("THREE.GLTFExporter: Merged metalnessMap and roughnessMap textures."),g}async decompressTextureAsync(t,e=1/0){if(this.textureUtils===null)throw new Error("THREE.GLTFExporter: setTextureUtils() must be called to process compressed textures.");return await this.textureUtils.decompress(t,e)}processBuffer(t){const e=this.json,r=this.buffers;return e.buffers||(e.buffers=[{byteLength:0}]),r.push(t),0}processBufferView(t,e,r,i,s){const o=this.json;o.bufferViews||(o.bufferViews=[]);let l;switch(e){case qt.BYTE:case qt.UNSIGNED_BYTE:l=1;break;case qt.SHORT:case qt.UNSIGNED_SHORT:l=2;break;default:l=4}let u=t.itemSize*l;s===qt.ARRAY_BUFFER&&(u=Math.ceil(u/4)*4);const f=uf(i*u),d=new DataView(new ArrayBuffer(f));let p=0;for(let x=r;x<r+i;x++){for(let v=0;v<t.itemSize;v++){let b;t.itemSize>4?b=t.array[x*t.itemSize+v]:(v===0?b=t.getX(x):v===1?b=t.getY(x):v===2?b=t.getZ(x):v===3&&(b=t.getW(x)),t.normalized===!0&&(b=Qh.normalize(b,t.array))),e===qt.FLOAT?d.setFloat32(p,b,!0):e===qt.INT?d.setInt32(p,b,!0):e===qt.UNSIGNED_INT?d.setUint32(p,b,!0):e===qt.SHORT?d.setInt16(p,b,!0):e===qt.UNSIGNED_SHORT?d.setUint16(p,b,!0):e===qt.BYTE?d.setInt8(p,b):e===qt.UNSIGNED_BYTE&&d.setUint8(p,b),p+=l}p%u!==0&&(p+=u-p%u)}const g={buffer:this.processBuffer(d.buffer),byteOffset:this.byteOffset,byteLength:f};return s!==void 0&&(g.target=s),s===qt.ARRAY_BUFFER&&(g.byteStride=u),this.byteOffset+=f,o.bufferViews.push(g),{id:o.bufferViews.length-1,byteLength:0}}processBufferViewImage(t){const e=this,r=e.json;return r.bufferViews||(r.bufferViews=[]),new Promise(function(i){const s=new FileReader;s.readAsArrayBuffer(t),s.onloadend=function(){const o=Bh(s.result),l={buffer:e.processBuffer(o),byteOffset:e.byteOffset,byteLength:o.byteLength};e.byteOffset+=o.byteLength,i(r.bufferViews.push(l)-1)}})}processAccessor(t,e,r,i){const s=this.json,o={1:"SCALAR",2:"VEC2",3:"VEC3",4:"VEC4",9:"MAT3",16:"MAT4"};let l;if(t.array.constructor===Float32Array)l=qt.FLOAT;else if(t.array.constructor===Int32Array)l=qt.INT;else if(t.array.constructor===Uint32Array)l=qt.UNSIGNED_INT;else if(t.array.constructor===Int16Array)l=qt.SHORT;else if(t.array.constructor===Uint16Array)l=qt.UNSIGNED_SHORT;else if(t.array.constructor===Int8Array)l=qt.BYTE;else if(t.array.constructor===Uint8Array)l=qt.UNSIGNED_BYTE;else throw new Error("THREE.GLTFExporter: Unsupported bufferAttribute component type: "+t.array.constructor.name);if(r===void 0&&(r=0),(i===void 0||i===1/0)&&(i=t.count),i===0)return null;const u=B_(t,r,i);let f;e!==void 0&&(f=t===e.index?qt.ELEMENT_ARRAY_BUFFER:qt.ARRAY_BUFFER);const d=this.processBufferView(t,l,r,i,f),p={bufferView:d.id,byteOffset:d.byteOffset,componentType:l,count:i,max:u.max,min:u.min,type:o[t.itemSize]};return t.normalized===!0&&(p.normalized=!0),s.accessors||(s.accessors=[]),s.accessors.push(p)-1}processImage(t,e,r,i="image/png"){if(t!==null){const s=this,o=s.cache,l=s.json,u=s.options,f=s.pending;o.images.has(t)||o.images.set(t,{});const d=o.images.get(t),p=i+":flipY/"+r.toString();if(d[p]!==void 0)return d[p];l.images||(l.images=[]);const g={mimeType:i},m=Ku();m.width=Math.min(t.width,u.maxTextureSize),m.height=Math.min(t.height,u.maxTextureSize);const x=m.getContext("2d",{willReadFrequently:!0});if(r===!0&&(x.translate(0,m.height),x.scale(1,-1)),t.data!==void 0){e!==Xc&&console.error("GLTFExporter: Only RGBAFormat is supported.",e),(t.width>u.maxTextureSize||t.height>u.maxTextureSize)&&console.warn("GLTFExporter: Image size is bigger than maxTextureSize",t);const b=new Uint8ClampedArray(t.height*t.width*4);for(let P=0;P<b.length;P+=4)b[P+0]=t.data[P+0],b[P+1]=t.data[P+1],b[P+2]=t.data[P+2],b[P+3]=t.data[P+3];x.putImageData(new ImageData(b,t.width,t.height),0,0)}else if(typeof HTMLImageElement<"u"&&t instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&t instanceof ImageBitmap||typeof OffscreenCanvas<"u"&&t instanceof OffscreenCanvas)x.drawImage(t,0,0,m.width,m.height);else throw new Error("THREE.GLTFExporter: Invalid image type. Use HTMLImageElement, HTMLCanvasElement, ImageBitmap or OffscreenCanvas.");u.binary===!0?f.push(Qu(m,i).then(b=>s.processBufferViewImage(b)).then(b=>{g.bufferView=b})):m.toDataURL!==void 0?g.uri=m.toDataURL(i):f.push(Qu(m,i).then(b=>new FileReader().readAsDataURL(b)).then(b=>{g.uri=b}));const v=l.images.push(g)-1;return d[p]=v,v}else throw new Error("THREE.GLTFExporter: No valid image data found. Unable to process texture.")}processSampler(t){const e=this.json;e.samplers||(e.samplers=[]);const r={magFilter:ei[t.magFilter],minFilter:ei[t.minFilter],wrapS:ei[t.wrapS],wrapT:ei[t.wrapT]};return e.samplers.push(r)-1}async processTextureAsync(t){const r=this.options,i=this.cache,s=this.json;if(i.textures.has(t))return i.textures.get(t);s.textures||(s.textures=[]),t instanceof zh&&(t=await this.decompressTextureAsync(t,r.maxTextureSize));let o=t.userData.mimeType;o==="image/webp"&&(o="image/png");const l={sampler:this.processSampler(t),source:this.processImage(t.image,t.format,t.flipY,o)};t.name&&(l.name=t.name),await this._invokeAllAsync(async function(f){f.writeTexture&&await f.writeTexture(t,l)});const u=s.textures.push(l)-1;return i.textures.set(t,u),u}async processMaterialAsync(t){const e=this.cache,r=this.json;if(e.materials.has(t))return e.materials.get(t);if(t.isShaderMaterial)return console.warn("GLTFExporter: THREE.ShaderMaterial not supported."),null;r.materials||(r.materials=[]);const i={pbrMetallicRoughness:{}};t.isMeshStandardMaterial!==!0&&t.isMeshBasicMaterial!==!0&&console.warn("GLTFExporter: Use MeshStandardMaterial or MeshBasicMaterial for best results.");const s=t.color.toArray().concat([t.opacity]);if(Zs(s,[1,1,1,1])||(i.pbrMetallicRoughness.baseColorFactor=s),t.isMeshStandardMaterial?(i.pbrMetallicRoughness.metallicFactor=t.metalness,i.pbrMetallicRoughness.roughnessFactor=t.roughness):(i.pbrMetallicRoughness.metallicFactor=0,i.pbrMetallicRoughness.roughnessFactor=1),t.metalnessMap||t.roughnessMap){const l=await this.buildMetalRoughTextureAsync(t.metalnessMap,t.roughnessMap),u={index:await this.processTextureAsync(l),texCoord:l.channel};this.applyTextureTransform(u,l),i.pbrMetallicRoughness.metallicRoughnessTexture=u}if(t.map){const l={index:await this.processTextureAsync(t.map),texCoord:t.map.channel};this.applyTextureTransform(l,t.map),i.pbrMetallicRoughness.baseColorTexture=l}if(t.emissive){const l=t.emissive;if(Math.max(l.r,l.g,l.b)>0&&(i.emissiveFactor=t.emissive.toArray()),t.emissiveMap){const f={index:await this.processTextureAsync(t.emissiveMap),texCoord:t.emissiveMap.channel};this.applyTextureTransform(f,t.emissiveMap),i.emissiveTexture=f}}if(t.normalMap){const l={index:await this.processTextureAsync(t.normalMap),texCoord:t.normalMap.channel};t.normalScale&&t.normalScale.x!==1&&(l.scale=t.normalScale.x),this.applyTextureTransform(l,t.normalMap),i.normalTexture=l}if(t.aoMap){const l={index:await this.processTextureAsync(t.aoMap),texCoord:t.aoMap.channel};t.aoMapIntensity!==1&&(l.strength=t.aoMapIntensity),this.applyTextureTransform(l,t.aoMap),i.occlusionTexture=l}t.transparent?i.alphaMode="BLEND":t.alphaTest>0&&(i.alphaMode="MASK",i.alphaCutoff=t.alphaTest),t.side===Vc&&(i.doubleSided=!0),t.name!==""&&(i.name=t.name),this.serializeUserData(t,i),await this._invokeAllAsync(async function(l){l.writeMaterialAsync&&await l.writeMaterialAsync(t,i)});const o=r.materials.push(i)-1;return e.materials.set(t,o),o}async processMeshAsync(t){const e=this.cache,r=this.json,i=[t.geometry.uuid];if(Array.isArray(t.material))for(let Z=0,I=t.material.length;Z<I;Z++)i.push(t.material[Z].uuid);else i.push(t.material.uuid);const s=i.join(":");if(e.meshes.has(s))return e.meshes.get(s);const o=t.geometry;let l;t.isLineSegments?l=qt.LINES:t.isLineLoop?l=qt.LINE_LOOP:t.isLine?l=qt.LINE_STRIP:t.isPoints?l=qt.POINTS:l=t.material.wireframe?qt.LINES:qt.TRIANGLES;const u={},f={},d=[],p=[],g={uv:"TEXCOORD_0",uv1:"TEXCOORD_1",uv2:"TEXCOORD_2",uv3:"TEXCOORD_3",color:"COLOR_0",skinWeight:"WEIGHTS_0",skinIndex:"JOINTS_0"},m=o.getAttribute("normal");m!==void 0&&!this.isNormalizedNormalAttribute(m)&&(console.warn("THREE.GLTFExporter: Creating normalized normal attribute from the non-normalized one."),o.setAttribute("normal",this.createNormalizedNormalAttribute(m)));let x=null;for(let Z in o.attributes){if(Z.slice(0,5)==="morph")continue;const I=o.attributes[Z];if(Z=g[Z]||Z.toUpperCase(),/^(POSITION|NORMAL|TANGENT|TEXCOORD_\d+|COLOR_\d+|JOINTS_\d+|WEIGHTS_\d+)$/.test(Z)||(Z="_"+Z),e.attributes.has(this.getUID(I))){f[Z]=e.attributes.get(this.getUID(I));continue}x=null;const V=I.array;Z==="JOINTS_0"&&!(V instanceof Uint16Array)&&!(V instanceof Uint8Array)?(console.warn('GLTFExporter: Attribute "skinIndex" converted to type UNSIGNED_SHORT.'),x=new Ne(new Uint16Array(V),I.itemSize,I.normalized)):(V instanceof Uint32Array||V instanceof Int32Array)&&!Z.startsWith("_")&&(console.warn(`GLTFExporter: Attribute "${Z}" converted to type FLOAT.`),x=Pa.Utils.toFloat32BufferAttribute(I));const S=this.processAccessor(x||I,o);S!==null&&(Z.startsWith("_")||this.detectMeshQuantization(Z,I),f[Z]=S,e.attributes.set(this.getUID(I),S))}if(m!==void 0&&o.setAttribute("normal",m),Object.keys(f).length===0)return null;if(t.morphTargetInfluences!==void 0&&t.morphTargetInfluences.length>0){const Z=[],I=[],K={};if(t.morphTargetDictionary!==void 0)for(const V in t.morphTargetDictionary)K[t.morphTargetDictionary[V]]=V;for(let V=0;V<t.morphTargetInfluences.length;++V){const S={};let k=!1;for(const O in o.morphAttributes){if(O!=="position"&&O!=="normal"){k||(console.warn("GLTFExporter: Only POSITION and NORMAL morph are supported."),k=!0);continue}const N=o.morphAttributes[O][V],E=O.toUpperCase(),C=o.attributes[O];if(e.attributes.has(this.getUID(N,!0))){S[E]=e.attributes.get(this.getUID(N,!0));continue}const y=N.clone();if(!o.morphTargetsRelative)for(let z=0,H=N.count;z<H;z++)for(let G=0;G<N.itemSize;G++)G===0&&y.setX(z,N.getX(z)-C.getX(z)),G===1&&y.setY(z,N.getY(z)-C.getY(z)),G===2&&y.setZ(z,N.getZ(z)-C.getZ(z)),G===3&&y.setW(z,N.getW(z)-C.getW(z));S[E]=this.processAccessor(y,o),e.attributes.set(this.getUID(C,!0),S[E])}p.push(S),Z.push(t.morphTargetInfluences[V]),t.morphTargetDictionary!==void 0&&I.push(K[V])}u.weights=Z,I.length>0&&(u.extras={},u.extras.targetNames=I)}const v=Array.isArray(t.material);if(v&&o.groups.length===0)return null;let b=!1;if(v&&o.index===null){const Z=[];for(let I=0,K=o.attributes.position.count;I<K;I++)Z[I]=I;o.setIndex(Z),b=!0}const P=v?t.material:[t.material],A=v?o.groups:[{materialIndex:0,start:void 0,count:void 0}];for(let Z=0,I=A.length;Z<I;Z++){const K={mode:l,attributes:f};if(this.serializeUserData(o,K),p.length>0&&(K.targets=p),o.index!==null){let S=this.getUID(o.index);(A[Z].start!==void 0||A[Z].count!==void 0)&&(S+=":"+A[Z].start+":"+A[Z].count),e.attributes.has(S)?K.indices=e.attributes.get(S):(K.indices=this.processAccessor(o.index,o,A[Z].start,A[Z].count),e.attributes.set(S,K.indices)),K.indices===null&&delete K.indices}const V=await this.processMaterialAsync(P[A[Z].materialIndex]);V!==null&&(K.material=V),d.push(K)}b===!0&&o.setIndex(null),u.primitives=d,r.meshes||(r.meshes=[]),await this._invokeAllAsync(function(Z){Z.writeMesh&&Z.writeMesh(t,u)});const B=r.meshes.push(u)-1;return e.meshes.set(s,B),B}detectMeshQuantization(t,e){if(this.extensionsUsed[Dh])return;let r;switch(e.array.constructor){case Int8Array:r="byte";break;case Uint8Array:r="unsigned byte";break;case Int16Array:r="short";break;case Uint16Array:r="unsigned short";break;default:return}e.normalized&&(r+=" normalized");const i=t.split("_",1)[0];ju[i]&&ju[i].includes(r)&&(this.extensionsUsed[Dh]=!0,this.extensionsRequired[Dh]=!0)}processCamera(t){const e=this.json;e.cameras||(e.cameras=[]);const r=t.isOrthographicCamera,i={type:r?"orthographic":"perspective"};return r?i.orthographic={xmag:t.right*2,ymag:t.top*2,zfar:t.far<=0?.001:t.far,znear:t.near<0?0:t.near}:i.perspective={aspectRatio:t.aspect,yfov:Qh.degToRad(t.fov),zfar:t.far<=0?.001:t.far,znear:t.near<0?0:t.near},t.name!==""&&(i.name=t.type),e.cameras.push(i)-1}processAnimation(t,e){const r=this.json,i=this.nodeMap;r.animations||(r.animations=[]),t=Pa.Utils.mergeMorphTargetTracks(t.clone(),e);const s=t.tracks,o=[],l=[];for(let u=0;u<s.length;++u){const f=s[u],d=Xt.parseTrackName(f.name);let p=Xt.findNode(e,d.nodeName);const g=Xu[d.propertyName];if(d.objectName==="bones"&&(p.isSkinnedMesh===!0?p=p.skeleton.getBoneByName(d.objectIndex):p=void 0),!p||!g){console.warn('THREE.GLTFExporter: Could not export animation track "%s".',f.name);continue}const m=1;let x=f.values.length/f.times.length;g===Xu.morphTargetInfluences&&(x/=p.morphTargetInfluences.length);let v;f.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline===!0?(v="CUBICSPLINE",x/=3):f.getInterpolation()===nm?v="STEP":v="LINEAR",l.push({input:this.processAccessor(new Ne(f.times,m)),output:this.processAccessor(new Ne(f.values,x)),interpolation:v}),o.push({sampler:l.length-1,target:{node:i.get(p),path:g}})}return r.animations.push({name:t.name||"clip_"+r.animations.length,samplers:l,channels:o}),r.animations.length-1}processSkin(t){const e=this.json,r=this.nodeMap,i=e.nodes[r.get(t)],s=t.skeleton;if(s===void 0)return null;const o=t.skeleton.bones[0];if(o===void 0)return null;const l=[],u=new Float32Array(s.bones.length*16),f=new qe;for(let p=0;p<s.bones.length;++p)l.push(r.get(s.bones[p])),f.copy(s.boneInverses[p]),f.multiply(t.bindMatrix).toArray(u,p*16);return e.skins===void 0&&(e.skins=[]),e.skins.push({inverseBindMatrices:this.processAccessor(new Ne(u,16)),joints:l,skeleton:r.get(o)}),i.skin=e.skins.length-1}async processNodeAsync(t){const e=this.json,r=this.options,i=this.nodeMap;e.nodes||(e.nodes=[]);const s={};if(r.trs){const l=t.quaternion.toArray(),u=t.position.toArray(),f=t.scale.toArray();Zs(l,[0,0,0,1])||(s.rotation=l),Zs(u,[0,0,0])||(s.translation=u),Zs(f,[1,1,1])||(s.scale=f)}else t.matrixAutoUpdate&&t.updateMatrix(),D_(t.matrix)===!1&&(s.matrix=t.matrix.elements);if(t.name!==""&&(s.name=String(t.name)),this.serializeUserData(t,s),t.isMesh||t.isLine||t.isPoints){const l=await this.processMeshAsync(t);l!==null&&(s.mesh=l)}else t.isCamera&&(s.camera=this.processCamera(t));if(t.isSkinnedMesh&&this.skins.push(t),t.children.length>0){const l=[];for(let u=0,f=t.children.length;u<f;u++){const d=t.children[u];if(d.visible||r.onlyVisible===!1){const p=await this.processNodeAsync(d);p!==null&&l.push(p)}}l.length>0&&(s.children=l)}await this._invokeAllAsync(function(l){l.writeNode&&l.writeNode(t,s)});const o=e.nodes.push(s)-1;return i.set(t,o),o}async processSceneAsync(t){const e=this.json,r=this.options;e.scenes||(e.scenes=[],e.scene=0);const i={};t.name!==""&&(i.name=t.name),e.scenes.push(i);const s=[];for(let o=0,l=t.children.length;o<l;o++){const u=t.children[o];if(u.visible||r.onlyVisible===!1){const f=await this.processNodeAsync(u);f!==null&&s.push(f)}}s.length>0&&(i.nodes=s),this.serializeUserData(t,i)}async processObjectsAsync(t){const e=new tl;e.name="AuxScene";for(let r=0;r<t.length;r++)e.children.push(t[r]);await this.processSceneAsync(e)}async processInputAsync(t){const e=this.options;t=t instanceof Array?t:[t],await this._invokeAllAsync(function(i){i.beforeParse&&i.beforeParse(t)});const r=[];for(let i=0;i<t.length;i++)t[i]instanceof tl?await this.processSceneAsync(t[i]):r.push(t[i]);r.length>0&&await this.processObjectsAsync(r);for(let i=0;i<this.skins.length;++i)this.processSkin(this.skins[i]);for(let i=0;i<e.animations.length;++i)this.processAnimation(e.animations[i],t[0]);await this._invokeAllAsync(function(i){i.afterParse&&i.afterParse(t)})}async _invokeAllAsync(t){for(let e=0,r=this.plugins.length;e<r;e++)await t(this.plugins[e])}}class F_{constructor(t){this.writer=t,this.name="KHR_lights_punctual"}writeNode(t,e){if(!t.isLight)return;if(!t.isDirectionalLight&&!t.isPointLight&&!t.isSpotLight){console.warn("THREE.GLTFExporter: Only directional, point, and spot lights are supported.",t);return}const r=this.writer,i=r.json,s=r.extensionsUsed,o={};t.name&&(o.name=t.name),o.color=t.color.toArray(),o.intensity=t.intensity,t.isDirectionalLight?o.type="directional":t.isPointLight?(o.type="point",t.distance>0&&(o.range=t.distance)):t.isSpotLight&&(o.type="spot",t.distance>0&&(o.range=t.distance),o.spot={},o.spot.innerConeAngle=(1-t.penumbra)*t.angle,o.spot.outerConeAngle=t.angle),t.decay!==void 0&&t.decay!==2&&console.warn("THREE.GLTFExporter: Light decay may be lost. glTF is physically-based, and expects light.decay=2."),t.target&&(t.target.parent!==t||t.target.position.x!==0||t.target.position.y!==0||t.target.position.z!==-1)&&console.warn("THREE.GLTFExporter: Light direction may be lost. For best results, make light.target a child of the light with position 0,0,-1."),s[this.name]||(i.extensions=i.extensions||{},i.extensions[this.name]={lights:[]},s[this.name]=!0);const l=i.extensions[this.name].lights;l.push(o),e.extensions=e.extensions||{},e.extensions[this.name]={light:l.length-1}}}class U_{constructor(t){this.writer=t,this.name="KHR_materials_unlit"}async writeMaterialAsync(t,e){if(!t.isMeshBasicMaterial)return;const i=this.writer.extensionsUsed;e.extensions=e.extensions||{},e.extensions[this.name]={},i[this.name]=!0,e.pbrMetallicRoughness.metallicFactor=0,e.pbrMetallicRoughness.roughnessFactor=.9}}class Z_{constructor(t){this.writer=t,this.name="KHR_materials_clearcoat"}async writeMaterialAsync(t,e){if(!t.isMeshPhysicalMaterial||t.clearcoat===0)return;const r=this.writer,i=r.extensionsUsed,s={};if(s.clearcoatFactor=t.clearcoat,t.clearcoatMap){const o={index:await r.processTextureAsync(t.clearcoatMap),texCoord:t.clearcoatMap.channel};r.applyTextureTransform(o,t.clearcoatMap),s.clearcoatTexture=o}if(s.clearcoatRoughnessFactor=t.clearcoatRoughness,t.clearcoatRoughnessMap){const o={index:await r.processTextureAsync(t.clearcoatRoughnessMap),texCoord:t.clearcoatRoughnessMap.channel};r.applyTextureTransform(o,t.clearcoatRoughnessMap),s.clearcoatRoughnessTexture=o}if(t.clearcoatNormalMap){const o={index:await r.processTextureAsync(t.clearcoatNormalMap),texCoord:t.clearcoatNormalMap.channel};t.clearcoatNormalScale.x!==1&&(o.scale=t.clearcoatNormalScale.x),r.applyTextureTransform(o,t.clearcoatNormalMap),s.clearcoatNormalTexture=o}e.extensions=e.extensions||{},e.extensions[this.name]=s,i[this.name]=!0}}class G_{constructor(t){this.writer=t,this.name="KHR_materials_dispersion"}async writeMaterialAsync(t,e){if(!t.isMeshPhysicalMaterial||t.dispersion===0)return;const i=this.writer.extensionsUsed,s={};s.dispersion=t.dispersion,e.extensions=e.extensions||{},e.extensions[this.name]=s,i[this.name]=!0}}class H_{constructor(t){this.writer=t,this.name="KHR_materials_iridescence"}async writeMaterialAsync(t,e){if(!t.isMeshPhysicalMaterial||t.iridescence===0)return;const r=this.writer,i=r.extensionsUsed,s={};if(s.iridescenceFactor=t.iridescence,t.iridescenceMap){const o={index:await r.processTextureAsync(t.iridescenceMap),texCoord:t.iridescenceMap.channel};r.applyTextureTransform(o,t.iridescenceMap),s.iridescenceTexture=o}if(s.iridescenceIor=t.iridescenceIOR,s.iridescenceThicknessMinimum=t.iridescenceThicknessRange[0],s.iridescenceThicknessMaximum=t.iridescenceThicknessRange[1],t.iridescenceThicknessMap){const o={index:await r.processTextureAsync(t.iridescenceThicknessMap),texCoord:t.iridescenceThicknessMap.channel};r.applyTextureTransform(o,t.iridescenceThicknessMap),s.iridescenceThicknessTexture=o}e.extensions=e.extensions||{},e.extensions[this.name]=s,i[this.name]=!0}}class W_{constructor(t){this.writer=t,this.name="KHR_materials_transmission"}async writeMaterialAsync(t,e){if(!t.isMeshPhysicalMaterial||t.transmission===0)return;const r=this.writer,i=r.extensionsUsed,s={};if(s.transmissionFactor=t.transmission,t.transmissionMap){const o={index:await r.processTextureAsync(t.transmissionMap),texCoord:t.transmissionMap.channel};r.applyTextureTransform(o,t.transmissionMap),s.transmissionTexture=o}e.extensions=e.extensions||{},e.extensions[this.name]=s,i[this.name]=!0}}class V_{constructor(t){this.writer=t,this.name="KHR_materials_volume"}async writeMaterialAsync(t,e){if(!t.isMeshPhysicalMaterial||t.transmission===0)return;const r=this.writer,i=r.extensionsUsed,s={};if(s.thicknessFactor=t.thickness,t.thicknessMap){const o={index:await r.processTextureAsync(t.thicknessMap),texCoord:t.thicknessMap.channel};r.applyTextureTransform(o,t.thicknessMap),s.thicknessTexture=o}t.attenuationDistance!==1/0&&(s.attenuationDistance=t.attenuationDistance),s.attenuationColor=t.attenuationColor.toArray(),e.extensions=e.extensions||{},e.extensions[this.name]=s,i[this.name]=!0}}class q_{constructor(t){this.writer=t,this.name="KHR_materials_ior"}async writeMaterialAsync(t,e){if(!t.isMeshPhysicalMaterial||t.ior===1.5)return;const i=this.writer.extensionsUsed,s={};s.ior=t.ior,e.extensions=e.extensions||{},e.extensions[this.name]=s,i[this.name]=!0}}class Y_{constructor(t){this.writer=t,this.name="KHR_materials_specular"}async writeMaterialAsync(t,e){if(!t.isMeshPhysicalMaterial||t.specularIntensity===1&&t.specularColor.equals(P_)&&!t.specularIntensityMap&&!t.specularColorMap)return;const r=this.writer,i=r.extensionsUsed,s={};if(t.specularIntensityMap){const o={index:await r.processTextureAsync(t.specularIntensityMap),texCoord:t.specularIntensityMap.channel};r.applyTextureTransform(o,t.specularIntensityMap),s.specularTexture=o}if(t.specularColorMap){const o={index:await r.processTextureAsync(t.specularColorMap),texCoord:t.specularColorMap.channel};r.applyTextureTransform(o,t.specularColorMap),s.specularColorTexture=o}s.specularFactor=t.specularIntensity,s.specularColorFactor=t.specularColor.toArray(),e.extensions=e.extensions||{},e.extensions[this.name]=s,i[this.name]=!0}}class j_{constructor(t){this.writer=t,this.name="KHR_materials_sheen"}async writeMaterialAsync(t,e){if(!t.isMeshPhysicalMaterial||t.sheen==0)return;const r=this.writer,i=r.extensionsUsed,s={};if(t.sheenRoughnessMap){const o={index:await r.processTextureAsync(t.sheenRoughnessMap),texCoord:t.sheenRoughnessMap.channel};r.applyTextureTransform(o,t.sheenRoughnessMap),s.sheenRoughnessTexture=o}if(t.sheenColorMap){const o={index:await r.processTextureAsync(t.sheenColorMap),texCoord:t.sheenColorMap.channel};r.applyTextureTransform(o,t.sheenColorMap),s.sheenColorTexture=o}s.sheenRoughnessFactor=t.sheenRoughness,s.sheenColorFactor=t.sheenColor.toArray(),e.extensions=e.extensions||{},e.extensions[this.name]=s,i[this.name]=!0}}class X_{constructor(t){this.writer=t,this.name="KHR_materials_anisotropy"}async writeMaterialAsync(t,e){if(!t.isMeshPhysicalMaterial||t.anisotropy==0)return;const r=this.writer,i=r.extensionsUsed,s={};if(t.anisotropyMap){const o={index:await r.processTextureAsync(t.anisotropyMap)};r.applyTextureTransform(o,t.anisotropyMap),s.anisotropyTexture=o}s.anisotropyStrength=t.anisotropy,s.anisotropyRotation=t.anisotropyRotation,e.extensions=e.extensions||{},e.extensions[this.name]=s,i[this.name]=!0}}class J_{constructor(t){this.writer=t,this.name="KHR_materials_emissive_strength"}async writeMaterialAsync(t,e){if(!t.isMeshStandardMaterial||t.emissiveIntensity===1)return;const i=this.writer.extensionsUsed,s={};s.emissiveStrength=t.emissiveIntensity,e.extensions=e.extensions||{},e.extensions[this.name]=s,i[this.name]=!0}}class $_{constructor(t){this.writer=t,this.name="EXT_materials_bump"}async writeMaterialAsync(t,e){if(!t.isMeshStandardMaterial||t.bumpScale===1&&!t.bumpMap)return;const r=this.writer,i=r.extensionsUsed,s={};if(t.bumpMap){const o={index:await r.processTextureAsync(t.bumpMap),texCoord:t.bumpMap.channel};r.applyTextureTransform(o,t.bumpMap),s.bumpTexture=o}s.bumpFactor=t.bumpScale,e.extensions=e.extensions||{},e.extensions[this.name]=s,i[this.name]=!0}}class K_{constructor(t){this.writer=t,this.name="EXT_mesh_gpu_instancing"}writeNode(t,e){if(!t.isInstancedMesh)return;const r=this.writer,i=t,s=new Float32Array(i.count*3),o=new Float32Array(i.count*4),l=new Float32Array(i.count*3),u=new qe,f=new ut,d=new ns,p=new ut;for(let m=0;m<i.count;m++)i.getMatrixAt(m,u),u.decompose(f,d,p),f.toArray(s,m*3),d.toArray(o,m*4),p.toArray(l,m*3);const g={TRANSLATION:r.processAccessor(new Ne(s,3)),ROTATION:r.processAccessor(new Ne(o,4)),SCALE:r.processAccessor(new Ne(l,3))};i.instanceColor&&(g._COLOR_0=r.processAccessor(i.instanceColor)),e.extensions=e.extensions||{},e.extensions[this.name]={attributes:g},r.extensionsUsed[this.name]=!0,r.extensionsRequired[this.name]=!0}}Pa.Utils={insertKeyframe:function(h,t){const r=h.getValueSize(),i=new h.TimeBufferType(h.times.length+1),s=new h.ValueBufferType(h.values.length+r),o=h.createInterpolant(new h.ValueBufferType(r));let l;if(h.times.length===0){i[0]=t;for(let u=0;u<r;u++)s[u]=0;l=0}else if(t<h.times[0]){if(Math.abs(h.times[0]-t)<.001)return 0;i[0]=t,i.set(h.times,1),s.set(o.evaluate(t),0),s.set(h.values,r),l=0}else if(t>h.times[h.times.length-1]){if(Math.abs(h.times[h.times.length-1]-t)<.001)return h.times.length-1;i[i.length-1]=t,i.set(h.times,0),s.set(h.values,0),s.set(o.evaluate(t),h.values.length),l=i.length-1}else for(let u=0;u<h.times.length;u++){if(Math.abs(h.times[u]-t)<.001)return u;if(h.times[u]<t&&h.times[u+1]>t){i.set(h.times.slice(0,u+1),0),i[u+1]=t,i.set(h.times.slice(u+1),u+2),s.set(h.values.slice(0,(u+1)*r),0),s.set(o.evaluate(t),(u+1)*r),s.set(h.values.slice((u+1)*r),(u+2)*r),l=u+1;break}}return h.times=i,h.values=s,l},mergeMorphTargetTracks:function(h,t){const e=[],r={},i=h.tracks;for(let s=0;s<i.length;++s){let o=i[s];const l=Xt.parseTrackName(o.name),u=Xt.findNode(t,l.nodeName);if(l.propertyName!=="morphTargetInfluences"||l.propertyIndex===void 0){e.push(o);continue}if(o.createInterpolant!==o.InterpolantFactoryMethodDiscrete&&o.createInterpolant!==o.InterpolantFactoryMethodLinear){if(o.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline)throw new Error("THREE.GLTFExporter: Cannot merge tracks with glTF CUBICSPLINE interpolation.");console.warn("THREE.GLTFExporter: Morph target interpolation mode not yet supported. Using LINEAR instead."),o=o.clone(),o.setInterpolation(rm)}const f=u.morphTargetInfluences.length,d=u.morphTargetDictionary[l.propertyIndex];if(d===void 0)throw new Error("THREE.GLTFExporter: Morph target name not found: "+l.propertyIndex);let p;if(r[u.uuid]===void 0){p=o.clone();const m=new p.ValueBufferType(f*p.times.length);for(let x=0;x<p.times.length;x++)m[x*f+d]=p.values[x];p.name=(l.nodeName||"")+".morphTargetInfluences",p.values=m,r[u.uuid]=p,e.push(p);continue}const g=o.createInterpolant(new o.ValueBufferType(1));p=r[u.uuid];for(let m=0;m<p.times.length;m++)p.values[m*f+d]=g.evaluate(p.times[m]);for(let m=0;m<o.times.length;m++){const x=this.insertKeyframe(p,o.times[m]);p.values[x*f+d]=o.values[m]}}return h.tracks=e,h},toFloat32BufferAttribute:function(h){const t=new Ne(new Float32Array(h.count*h.itemSize),h.itemSize,!1);if(!h.normalized&&!h.isInterleavedBufferAttribute)return t.array.set(h.array),t;for(let e=0,r=h.count;e<r;e++)for(let i=0;i<h.itemSize;i++)t.setComponent(e,i,h.getComponent(e,i));return t}};function Q_(h,t=!1){const e=h[0].index!==null,r=new Set(Object.keys(h[0].attributes)),i=new Set(Object.keys(h[0].morphAttributes)),s={},o={},l=h[0].morphTargetsRelative,u=new rs;let f=0;for(let d=0;d<h.length;++d){const p=h[d];let g=0;if(e!==(p.index!==null))return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+d+". All geometries must have compatible attributes; make sure index attribute exists among all geometries, or in none of them."),null;for(const m in p.attributes){if(!r.has(m))return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+d+'. All geometries must have compatible attributes; make sure "'+m+'" attribute exists among all geometries, or in none of them.'),null;s[m]===void 0&&(s[m]=[]),s[m].push(p.attributes[m]),g++}if(g!==r.size)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+d+". Make sure all geometries have the same number of attributes."),null;if(l!==p.morphTargetsRelative)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+d+". .morphTargetsRelative must be consistent throughout all geometries."),null;for(const m in p.morphAttributes){if(!i.has(m))return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+d+".  .morphAttributes must be consistent throughout all geometries."),null;o[m]===void 0&&(o[m]=[]),o[m].push(p.morphAttributes[m])}if(t){let m;if(e)m=p.index.count;else if(p.attributes.position!==void 0)m=p.attributes.position.count;else return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+d+". The geometry must have either an index or a position attribute"),null;u.addGroup(f,m,d),f+=m}}if(e){let d=0;const p=[];for(let g=0;g<h.length;++g){const m=h[g].index;for(let x=0;x<m.count;++x)p.push(m.getX(x)+d);d+=h[g].attributes.position.count}u.setIndex(p)}for(const d in s){const p=tc(s[d]);if(!p)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed while trying to merge the "+d+" attribute."),null;u.setAttribute(d,p)}for(const d in o){const p=o[d][0].length;if(p===0)break;u.morphAttributes=u.morphAttributes||{},u.morphAttributes[d]=[];for(let g=0;g<p;++g){const m=[];for(let v=0;v<o[d].length;++v)m.push(o[d][v][g]);const x=tc(m);if(!x)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed while trying to merge the "+d+" morphAttribute."),null;u.morphAttributes[d].push(x)}}return u}function tc(h){let t,e,r,i=-1,s=0;for(let f=0;f<h.length;++f){const d=h[f];if(t===void 0&&(t=d.array.constructor),t!==d.array.constructor)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.array must be of consistent array types across matching attributes."),null;if(e===void 0&&(e=d.itemSize),e!==d.itemSize)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.itemSize must be consistent across matching attributes."),null;if(r===void 0&&(r=d.normalized),r!==d.normalized)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.normalized must be consistent across matching attributes."),null;if(i===-1&&(i=d.gpuType),i!==d.gpuType)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.gpuType must be consistent across matching attributes."),null;s+=d.count*e}const o=new t(s),l=new Ne(o,e,r);let u=0;for(let f=0;f<h.length;++f){const d=h[f];if(d.isInterleavedBufferAttribute){const p=u/e;for(let g=0,m=d.count;g<m;g++)for(let x=0;x<e;x++){const v=d.getComponent(g,x);l.setComponent(g+p,x,v)}}else o.set(d.array,u);u+=d.count*e}return i!==void 0&&(l.gpuType=i),l}var tg=hr('<p class="svelte-1tmczmq">Draw a shape on the map.</p>'),eg=hr('<p class="svelte-1tmczmq">The selected area is too large. Please reduce the area.</p>'),ig=hr('<div class="svelte-1tmczmq"><!> <!> <button class="svelte-1tmczmq">Fetch Data</button> <button class="svelte-1tmczmq">Clip Data</button> <button class="svelte-1tmczmq">Download Data</button></div>');function ng(h,t){Da(t,!1);const e=Ic(),r=()=>Kl(Ea,"$clippedGeoJSON",e),i=()=>Kl(pa,"$osmGeoJSON",e);let s=Hs(t,"area",8),o=Hs(t,"latlngs",8),l=Hs(t,"selectedLayer",8);const u=8e6;let f=Xr(!1);const d=E=>{const C=L.latLngBounds(E);return[C.getSouthWest(),C.getNorthEast()]},p=async()=>{if(!o()){alert("No area selected.");return}try{const[E,C]=d(o()),y="https://overpass-api.de/api/interpreter",z=`
                [out:json];
                (
                    way["building"](${E.lat},${E.lng},${C.lat},${C.lng});
                    relation["building"](${E.lat},${E.lng},${C.lat},${C.lng});
                );
                out body;
                >;
                out skel qt;
            `,H=await fetch(y,{method:"POST",body:z,headers:{"Content-Type":"application/x-www-form-urlencoded"}});if(!H.ok){alert("Failed to fetch GeoJSON data.");return}const G=await H.json(),W=mp(G);pa.set(W)}catch(E){console.error("Error fetching data:",E),alert("An error occurred while fetching data.")}},g=()=>{let E;if(pa.subscribe(C=>{E=C})(),!E||!o()){alert("No data to clip or no shape selected.");return}try{const C=[...o()];o().length>0&&(o()[0].lat!==o()[o().length-1].lat||o()[0].lng!==o()[o().length-1].lng)&&C.push(o()[0]);const y=Na([C.map(tt=>[tt.lng,tt.lat])]),z=E.features.map(tt=>{const q=tt.geometry;if(!q||!q.coordinates||q.type!=="Polygon"&&q.type!=="MultiPolygon")return null;const Q=_p(q.type,q.coordinates),dt=yp([lr(Q),y]);try{const ct=jp(dt);if(ct&&ct.geometry)return{...tt,geometry:ct.geometry}}catch(ct){console.warn("Error clipping feature:",tt,"Error:",ct)}return null}).filter(Boolean);if(z.length===0){alert("No features were clipped. Ensure your area intersects the data.");return}const H={type:"FeatureCollection",features:z};Ea.set(H);const[G,W]=d(o()),X=[G.lng,G.lat,W.lng,W.lat]}catch(C){console.error("Error during clipping:",C),alert(`Error during clipping: ${C.message}`)}},m=async()=>{const E=r();if(!E){alert("No clipped data available. Clip data first.");return}try{const C=new ap;C.file("buildings.geojson",JSON.stringify(E,null,2));const y=await x();if(y){const rt=await new Promise(mt=>y.toBlob(mt,"image/png"));C.file("map.png",rt)}const[z,H]=d(o()),G=[z.lng,z.lat,H.lng,H.lat],W=Sp(G),X=Go(W).geometry.coordinates,tt={bbox:G,clipPath:o(),referencePoint:Go(r()).geometry.coordinates},q=JSON.stringify(tt,null,2);navigator.clipboard.writeText(`${Go(r()).geometry.coordinates}`),C.file("config.json",JSON.stringify(tt,null,2));try{const rt=Go(E).geometry.coordinates,mt=v(E,rt),Et=new tl,St=new Yu({color:10066329}),Ot=new Zu(mt,St);Et.add(Ot);const bt=o().map(U=>{const F=[U.lng,U.lat];return B(F,rt)}),vt=new Aa(bt.map(U=>new Pt(U.x,U.y))),ht=new Ml(vt),ft=new Yu({color:14540253,side:Vc}),M=new Zu(ht,ft);M.rotation.x=-Math.PI/2,M.rotation.z=Math.PI,M.position.y=-.01,Et.add(M);const et=new Pa,j=await new Promise((U,F)=>{et.parse(Et,J=>U(new Blob([JSON.stringify(J)],{type:"application/json"})),F)});C.file("scene.gltf",j)}catch(rt){console.error("Error generating 3D model:",rt),alert("An error occurred while generating the 3D model.")}const Q=await C.generateAsync({type:"blob"}),dt=URL.createObjectURL(Q),ct=document.createElement("a");ct.href=dt,ct.download="vantage-scene-setup.zip",ct.click(),URL.revokeObjectURL(dt)}catch(C){console.error("Error during download:",C),alert("An error occurred during download.")}},x=async()=>{if(!o()||!l())return null;const[E,C]=d(o()),y=256,z=17,H=(j,U,F)=>{const J=Math.pow(2,F),at=Math.floor((U+180)/360*J),lt=Math.floor((1-Math.log(Math.tan(j*Math.PI/180)+1/Math.cos(j*Math.PI/180))/Math.PI)/2*J);return{x:at,y:lt}},G=H(E.lat,E.lng,z),W=H(C.lat,C.lng,z),X={x:Math.min(G.x,W.x),y:Math.min(G.y,W.y)},tt={x:Math.max(G.x,W.x),y:Math.max(G.y,W.y)},q=tt.x-X.x+1,Q=tt.y-X.y+1,dt=document.createElement("canvas"),ct=dt.getContext("2d");dt.width=q*y,dt.height=Q*y;const rt=[];for(let j=X.x;j<=tt.x;j++)for(let U=X.y;U<=tt.y;U++){const F=l().value.replace("{z}",z).replace("{x}",j).replace("{y}",U);rt.push({url:F,x:j-X.x,y:U-X.y})}(await Promise.all(rt.map(j=>fetch(j.url).then(U=>{if(!U.ok)throw new Error(`Failed to fetch tile: ${j.url}`);return U.blob()}).then(U=>createImageBitmap(U)).then(U=>({img:U,x:j.x,y:j.y}))))).forEach(({img:j,x:U,y:F})=>{const J=U*y,at=F*y;ct.drawImage(j,J,at,y,y)});const Et=(j,U,F)=>{const J=Math.pow(2,F)*y,at=(U+180)/360*J,lt=(1-Math.log(Math.tan(j*Math.PI/180)+1/Math.cos(j*Math.PI/180))/Math.PI)/2*J;return{x:at,y:lt}},St=Et(C.lat,E.lng,z),Ot=Et(E.lat,C.lng,z),bt=St.x-X.x*y,vt=St.y-X.y*y,ht=Ot.x-St.x,ft=Ot.y-St.y,M=document.createElement("canvas");return M.width=ht,M.height=ft,M.getContext("2d").drawImage(dt,bt,vt,ht,ft,0,0,ht,ft),M},v=(E,C)=>{const y=E.features.filter(({properties:z})=>z.building).flatMap(z=>{const H=z.geometry.coordinates;return H?z.geometry.type==="Polygon"?b(H,C,z.properties):z.geometry.type==="MultiPolygon"?H.flatMap(G=>b(G,C,z.properties)):(console.warn("Unsupported geometry type:",z.geometry.type),null):null}).filter(Boolean);return Q_(y)},b=(E,C,y)=>{const z=A(E[0],C);if(!z)return null;z.holes=E.slice(1).map(G=>A(G,C));const H=new Ll(z,{curveSegments:1,depth:P(y),bevelEnabled:!1});return H.rotateX(Math.PI/2),H.rotateZ(Math.PI),H},P=E=>E["building:height"]??E.height??(E["building:levels"]?E["building:levels"]*4:4),A=(E,C)=>{try{return new Aa(E.map(y=>B(y,C)))}catch(y){return console.error("Error generating shape from coordinates:",E,y),null}},B=(E,C,y=!0)=>{if(!Array.isArray(E)||E.length!==2)throw new Error("Invalid coordinate format. Expected [longitude, latitude].");const z=qp(E,C)*1e3,H=Ep(E,C)*Math.PI/180,G=z*Math.cos(H)*(y?-1:1),W=z*Math.sin(H);return new Pt(G,W)};ca(()=>ml(s()),()=>{s()&&de(f,s()<=u)}),vc(),_l();var Z=ig(),I=ya(Z);{var K=E=>{var C=tg();nr(E,C)};jl(I,E=>{s()||E(K)})}var V=kn(I,2);{var S=E=>{var C=eg();nr(E,C)};jl(V,E=>{s()&&!Bt(f)&&E(S)})}var k=kn(V,2),O=kn(k,2),N=kn(O,2);xc(()=>{k.disabled=!s(),O.disabled=!i(),N.disabled=!r()}),da("click",k,p),da("click",O,g),da("click",N,m),nr(h,Z),Ba()}var rg=hr("<div><h1>Vantage Scene Setup</h1> <p>Export the relevant data to setup Vantage.</p> <!> <!> <!></div>");function sg(h){Ic();let t=Xr(null),e=Xr(),r=Xr([]);const i=p=>{de(e,p.detail.layer)},s=p=>{const g=p.detail.layer;de(t,L.GeometryUtil.geodesicArea(g._latlngs[0])),de(r,g._latlngs[0])},o=p=>{de(t,p.detail.area),de(r,p.detail.latlngs),Wd(Ea,Bt(r))};var l=rg(),u=kn(ya(l),4);Kd(u,{get selectedLayer(){return Bt(e)},set selectedLayer(p){de(e,p)},$$events:{change:i},$$legacy:!0});var f=kn(u,2);rp(f,{get selectedLayer(){return Bt(e)},$$events:{shapeDrawn:s,shapeEdited:o}});var d=kn(f,2);ng(d,{get area(){return Bt(t)},get latlngs(){return Bt(r)},get selectedLayer(){return Bt(e)}}),nr(h,l)}Cd(sg,{target:document.getElementById("app")});
