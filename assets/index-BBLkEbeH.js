var p0=Object.defineProperty;var g0=(r,t,e)=>t in r?p0(r,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[t]=e;var Wt=(r,t,e)=>g0(r,typeof t!="symbol"?t+"":t,e);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))i(n);new MutationObserver(n=>{for(const s of n)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&i(a)}).observe(document,{childList:!0,subtree:!0});function e(n){const s={};return n.integrity&&(s.integrity=n.integrity),n.referrerPolicy&&(s.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?s.credentials="include":n.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(n){if(n.ep)return;n.ep=!0;const s=e(n);fetch(n.href,s)}})();const lp=!1;var Hh=Array.isArray,m0=Array.prototype.indexOf,td=Array.from,fy=Object.defineProperty,Ia=Object.getOwnPropertyDescriptor,y0=Object.getOwnPropertyDescriptors,_0=Object.prototype,v0=Array.prototype,dy=Object.getPrototypeOf;const Ca=()=>{};function x0(r){return r()}function pf(r){for(var t=0;t<r.length;t++)r[t]()}const Pi=2,py=4,ol=8,ed=16,zr=32,Xa=64,vh=128,Zo=256,xh=512,Wn=1024,ps=2048,Ho=4096,Cr=8192,Wa=16384,w0=32768,nd=65536,b0=1<<17,E0=1<<19,gy=1<<20,Ro=Symbol("$state"),k0=Symbol("legacy props");function my(r){return r===this.v}function yy(r,t){return r!=r?t==t:r!==t||r!==null&&typeof r=="object"||typeof r=="function"}function id(r){return!yy(r,this.v)}function M0(r){throw new Error("https://svelte.dev/e/effect_in_teardown")}function L0(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function S0(r){throw new Error("https://svelte.dev/e/effect_orphan")}function T0(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function P0(r){throw new Error("https://svelte.dev/e/props_invalid_value")}function I0(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function C0(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function A0(){throw new Error("https://svelte.dev/e/state_unsafe_local_read")}function N0(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}let $a=!1,O0=!1;function R0(){$a=!0}const D0=1,z0=2,B0=16,F0=1,U0=2,G0=4,V0=8,q0=16,Z0=1,H0=2,li=Symbol();function Li(r,t){var e={f:0,v:r,reactions:null,equals:my,rv:0,wv:0};return e}function Yh(r,t=!1){var i;const e=Li(r);return t||(e.equals=id),$a&&Re!==null&&Re.l!==null&&((i=Re.l).s??(i.s=[])).push(e),e}function rs(r,t=!1){return Y0(Yh(r,t))}function Y0(r){return Ie!==null&&Ie.f&Pi&&(Ar===null?i1([r]):Ar.push(r)),r}function X0(r,t){return Oe(r,hs(()=>Vt(r))),t}function Oe(r,t){return Ie!==null&&ul()&&Ie.f&(Pi|ed)&&(Ar===null||!Ar.includes(r))&&N0(),_y(r,t)}function _y(r,t){return r.equals(t)||(r.v,r.v=t,r.wv=By(),vy(r,ps),ul()&&Ce!==null&&Ce.f&Wn&&!(Ce.f&(zr|Xa))&&(is===null?r1([r]):is.push(r))),t}function vy(r,t){var e=r.reactions;if(e!==null)for(var i=ul(),n=e.length,s=0;s<n;s++){var a=e[s],l=a.f;l&ps||!i&&a===Ce||(Wi(a,t),l&(Wn|Zo)&&(l&Pi?vy(a,Ho):Jh(a)))}}let W0=!1;function ba(r,t=null,e){if(typeof r!="object"||r===null||Ro in r)return r;const i=dy(r);if(i!==_0&&i!==v0)return r;var n=new Map,s=Hh(r),a=Li(0);s&&n.set("length",Li(r.length));var l;return new Proxy(r,{defineProperty(f,d,g){(!("value"in g)||g.configurable===!1||g.enumerable===!1||g.writable===!1)&&I0();var m=n.get(d);return m===void 0?(m=Li(g.value),n.set(d,m)):Oe(m,ba(g.value,l)),!0},deleteProperty(f,d){var g=n.get(d);if(g===void 0)d in f&&n.set(d,Li(li));else{if(s&&typeof d=="string"){var m=n.get("length"),v=Number(d);Number.isInteger(v)&&v<m.v&&Oe(m,v)}Oe(g,li),hp(a)}return!0},get(f,d,g){var w;if(d===Ro)return r;var m=n.get(d),v=d in f;if(m===void 0&&(!v||(w=Ia(f,d))!=null&&w.writable)&&(m=Li(ba(v?f[d]:li,l)),n.set(d,m)),m!==void 0){var _=Vt(m);return _===li?void 0:_}return Reflect.get(f,d,g)},getOwnPropertyDescriptor(f,d){var g=Reflect.getOwnPropertyDescriptor(f,d);if(g&&"value"in g){var m=n.get(d);m&&(g.value=Vt(m))}else if(g===void 0){var v=n.get(d),_=v==null?void 0:v.v;if(v!==void 0&&_!==li)return{enumerable:!0,configurable:!0,value:_,writable:!0}}return g},has(f,d){var _;if(d===Ro)return!0;var g=n.get(d),m=g!==void 0&&g.v!==li||Reflect.has(f,d);if(g!==void 0||Ce!==null&&(!m||(_=Ia(f,d))!=null&&_.writable)){g===void 0&&(g=Li(m?ba(f[d],l):li),n.set(d,g));var v=Vt(g);if(v===li)return!1}return m},set(f,d,g,m){var C;var v=n.get(d),_=d in f;if(s&&d==="length")for(var w=g;w<v.v;w+=1){var b=n.get(w+"");b!==void 0?Oe(b,li):w in f&&(b=Li(li),n.set(w+"",b))}v===void 0?(!_||(C=Ia(f,d))!=null&&C.writable)&&(v=Li(void 0),Oe(v,ba(g,l)),n.set(d,v)):(_=v.v!==li,Oe(v,ba(g,l)));var S=Reflect.getOwnPropertyDescriptor(f,d);if(S!=null&&S.set&&S.set.call(m,g),!_){if(s&&typeof d=="string"){var N=n.get("length"),k=Number(d);Number.isInteger(k)&&k>=N.v&&Oe(N,k+1)}hp(a)}return!0},ownKeys(f){Vt(a);var d=Reflect.ownKeys(f).filter(v=>{var _=n.get(v);return _===void 0||_.v!==li});for(var[g,m]of n)m.v!==li&&!(g in f)&&d.push(g);return d},setPrototypeOf(){C0()}})}function hp(r,t=1){Oe(r,r.v+t)}var cp,xy,wy;function $0(){if(cp===void 0){cp=window;var r=Element.prototype,t=Node.prototype;xy=Ia(t,"firstChild").get,wy=Ia(t,"nextSibling").get,r.__click=void 0,r.__className="",r.__attributes=null,r.__styles=null,r.__e=void 0,Text.prototype.__t=void 0}}function rd(r=""){return document.createTextNode(r)}function wh(r){return xy.call(r)}function Xh(r){return wy.call(r)}function Hu(r,t){return wh(r)}function gf(r,t){{var e=wh(r);return e instanceof Comment&&e.data===""?Xh(e):e}}function ti(r,t=1,e=!1){let i=r;for(;t--;)i=Xh(i);return i}function J0(r){r.textContent=""}function bh(r){var t=Pi|ps;Ce===null?t|=Zo:Ce.f|=gy;var e=Ie!==null&&Ie.f&Pi?Ie:null;const i={children:null,ctx:Re,deps:null,equals:my,f:t,fn:r,reactions:null,rv:0,v:null,wv:0,parent:e??Ce};return e!==null&&(e.children??(e.children=[])).push(i),i}function by(r){const t=bh(r);return t.equals=id,t}function Ey(r){var t=r.children;if(t!==null){r.children=null;for(var e=0;e<t.length;e+=1){var i=t[e];i.f&Pi?sd(i):$s(i)}}}function j0(r){for(var t=r.parent;t!==null;){if(!(t.f&Pi))return t;t=t.parent}return null}function ky(r){var t,e=Ce;Nr(j0(r));try{Ey(r),t=Uy(r)}finally{Nr(e)}return t}function My(r){var t=ky(r),e=(No||r.f&Zo)&&r.deps!==null?Ho:Wn;Wi(r,e),r.equals(t)||(r.v=t,r.wv=By())}function sd(r){Ey(r),Xu(r,0),Wi(r,Wa),r.v=r.children=r.deps=r.ctx=r.reactions=null}function Ly(r){Ce===null&&Ie===null&&S0(),Ie!==null&&Ie.f&Zo&&L0(),hd&&M0()}function K0(r,t){var e=t.last;e===null?t.last=t.first=r:(e.next=r,r.prev=e,t.last=r)}function Ja(r,t,e,i=!0){var n=(r&Xa)!==0,s=Ce,a={ctx:Re,deps:null,deriveds:null,nodes_start:null,nodes_end:null,f:r|ps,first:null,fn:t,last:null,next:null,parent:n?null:s,prev:null,teardown:null,transitions:null,wv:0};if(e){var l=Aa;try{fp(!0),$h(a),a.f|=w0}catch(g){throw $s(a),g}finally{fp(l)}}else t!==null&&Jh(a);var f=e&&a.deps===null&&a.first===null&&a.nodes_start===null&&a.teardown===null&&(a.f&(gy|vh))===0;if(!f&&!n&&i&&(s!==null&&K0(a,s),Ie!==null&&Ie.f&Pi)){var d=Ie;(d.children??(d.children=[])).push(a)}return a}function Sy(r){const t=Ja(ol,null,!1);return Wi(t,Wn),t.teardown=r,t}function mf(r){Ly();var t=Ce!==null&&(Ce.f&zr)!==0&&Re!==null&&!Re.m;if(t){var e=Re;(e.e??(e.e=[])).push({fn:r,effect:Ce,reaction:Ie})}else{var i=od(r);return i}}function Q0(r){return Ly(),al(r)}function t1(r){const t=Ja(Xa,r,!0);return(e={})=>new Promise(i=>{e.outro?Eh(t,()=>{$s(t),i(void 0)}):($s(t),i(void 0))})}function od(r){return Ja(py,r,!1)}function Ma(r,t){var e=Re,i={effect:null,ran:!1};e.l.r1.push(i),i.effect=al(()=>{r(),!i.ran&&(i.ran=!0,Oe(e.l.r2,!0),hs(t))})}function ad(){var r=Re;al(()=>{if(Vt(r.l.r2)){for(var t of r.l.r1){var e=t.effect;e.f&Wn&&Wi(e,Ho),ja(e)&&$h(e),t.ran=!1}r.l.r2.v=!1}})}function al(r){return Ja(ol,r,!0)}function Ty(r){return ud(r)}function ud(r,t=0){return Ja(ol|ed|t,r,!0)}function Yu(r,t=!0){return Ja(ol|zr,r,!0,t)}function Py(r){var t=r.teardown;if(t!==null){const e=hd,i=Ie;dp(!0),Js(null);try{t.call(null)}finally{dp(e),Js(i)}}}function Iy(r){var t=r.deriveds;if(t!==null){r.deriveds=null;for(var e=0;e<t.length;e+=1)sd(t[e])}}function Cy(r,t=!1){var e=r.first;for(r.first=r.last=null;e!==null;){var i=e.next;$s(e,t),e=i}}function e1(r){for(var t=r.first;t!==null;){var e=t.next;t.f&zr||$s(t),t=e}}function $s(r,t=!0){var e=!1;if((t||r.f&E0)&&r.nodes_start!==null){for(var i=r.nodes_start,n=r.nodes_end;i!==null;){var s=i===n?null:Xh(i);i.remove(),i=s}e=!0}Cy(r,t&&!e),Iy(r),Xu(r,0),Wi(r,Wa);var a=r.transitions;if(a!==null)for(const f of a)f.stop();Py(r);var l=r.parent;l!==null&&l.first!==null&&Ay(r),r.next=r.prev=r.teardown=r.ctx=r.deps=r.fn=r.nodes_start=r.nodes_end=null}function Ay(r){var t=r.parent,e=r.prev,i=r.next;e!==null&&(e.next=i),i!==null&&(i.prev=e),t!==null&&(t.first===r&&(t.first=i),t.last===r&&(t.last=e))}function Eh(r,t){var e=[];ld(r,e,!0),Ny(e,()=>{$s(r),t&&t()})}function Ny(r,t){var e=r.length;if(e>0){var i=()=>--e||t();for(var n of r)n.out(i)}else t()}function ld(r,t,e){if(!(r.f&Cr)){if(r.f^=Cr,r.transitions!==null)for(const a of r.transitions)(a.is_global||e)&&t.push(a);for(var i=r.first;i!==null;){var n=i.next,s=(i.f&nd)!==0||(i.f&zr)!==0;ld(i,t,s?e:!1),i=n}}}function kh(r){Oy(r,!0)}function Oy(r,t){if(r.f&Cr){r.f^=Cr,r.f&Wn||(r.f^=Wn),ja(r)&&(Wi(r,ps),Jh(r));for(var e=r.first;e!==null;){var i=e.next,n=(e.f&nd)!==0||(e.f&zr)!==0;Oy(e,n?t:!1),e=i}if(r.transitions!==null)for(const s of r.transitions)(s.is_global||t)&&s.in()}}let yf=!1,_f=[];function n1(){yf=!1;const r=_f.slice();_f=[],pf(r)}function Ry(r){yf||(yf=!0,queueMicrotask(n1)),_f.push(r)}function Dy(r){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}let lh=!1,Mh=!1,Lh=null,Aa=!1,hd=!1;function fp(r){Aa=r}function dp(r){hd=r}let vf=[],zu=0;let Ie=null;function Js(r){Ie=r}let Ce=null;function Nr(r){Ce=r}let Ar=null;function i1(r){Ar=r}let fi=null,Mi=0,is=null;function r1(r){is=r}let zy=1,Sh=0,No=!1,Re=null;function By(){return++zy}function ul(){return!$a||Re!==null&&Re.l===null}function ja(r){var d;var t=r.f;if(t&ps)return!0;if(t&Ho){var e=r.deps,i=(t&Zo)!==0;if(e!==null){var n,s,a=(t&xh)!==0,l=i&&Ce!==null&&!No,f=e.length;if(a||l){for(n=0;n<f;n++)s=e[n],(a||!((d=s==null?void 0:s.reactions)!=null&&d.includes(r)))&&(s.reactions??(s.reactions=[])).push(r);a&&(r.f^=xh)}for(n=0;n<f;n++)if(s=e[n],ja(s)&&My(s),s.wv>r.wv)return!0}(!i||Ce!==null&&!No)&&Wi(r,Wn)}return!1}function s1(r,t){for(var e=t;e!==null;){if(e.f&vh)try{e.fn(r);return}catch{e.f^=vh}e=e.parent}throw lh=!1,r}function o1(r){return(r.f&Wa)===0&&(r.parent===null||(r.parent.f&vh)===0)}function Wh(r,t,e,i){if(lh){if(e===null&&(lh=!1),o1(t))throw r;return}e!==null&&(lh=!0);{s1(r,t);return}}function Fy(r,t,e=0){var i=r.reactions;if(i!==null)for(var n=0;n<i.length;n++){var s=i[n];s.f&Pi?Fy(s,t,e+1):t===s&&(e===0?Wi(s,ps):s.f&Wn&&Wi(s,Ho),Jh(s))}}function Uy(r){var v;var t=fi,e=Mi,i=is,n=Ie,s=No,a=Ar,l=Re,f=r.f;fi=null,Mi=0,is=null,Ie=f&(zr|Xa)?null:r,No=!Aa&&(f&Zo)!==0,Ar=null,Re=r.ctx,Sh++;try{var d=(0,r.fn)(),g=r.deps;if(fi!==null){var m;if(Xu(r,Mi),g!==null&&Mi>0)for(g.length=Mi+fi.length,m=0;m<fi.length;m++)g[Mi+m]=fi[m];else r.deps=g=fi;if(!No)for(m=Mi;m<g.length;m++)((v=g[m]).reactions??(v.reactions=[])).push(r)}else g!==null&&Mi<g.length&&(Xu(r,Mi),g.length=Mi);if(ul()&&is!==null&&!(r.f&(Pi|Ho|ps)))for(m=0;m<is.length;m++)Fy(is[m],r);return n!==null&&Sh++,d}finally{fi=t,Mi=e,is=i,Ie=n,No=s,Ar=a,Re=l}}function a1(r,t){let e=t.reactions;if(e!==null){var i=m0.call(e,r);if(i!==-1){var n=e.length-1;n===0?e=t.reactions=null:(e[i]=e[n],e.pop())}}e===null&&t.f&Pi&&(fi===null||!fi.includes(t))&&(Wi(t,Ho),t.f&(Zo|xh)||(t.f^=xh),Xu(t,0))}function Xu(r,t){var e=r.deps;if(e!==null)for(var i=t;i<e.length;i++)a1(r,e[i])}function $h(r){var t=r.f;if(!(t&Wa)){Wi(r,Wn);var e=Ce,i=Re;Ce=r;try{t&ed?e1(r):Cy(r),Iy(r),Py(r);var n=Uy(r);r.teardown=typeof n=="function"?n:null,r.wv=zy;var s=r.deps,a;lp&&O0&&r.f&ps}catch(l){Wh(l,r,e,i||r.ctx)}finally{Ce=e}}}function u1(){if(zu>1e3){zu=0;try{T0()}catch(r){if(Lh!==null)Wh(r,Lh,null);else throw r}}zu++}function l1(r){var t=r.length;if(t!==0){u1();var e=Aa;Aa=!0;try{for(var i=0;i<t;i++){var n=r[i];n.f&Wn||(n.f^=Wn);var s=[];Gy(n,s),h1(s)}}finally{Aa=e}}}function h1(r){var t=r.length;if(t!==0)for(var e=0;e<t;e++){var i=r[e];if(!(i.f&(Wa|Cr)))try{ja(i)&&($h(i),i.deps===null&&i.first===null&&i.nodes_start===null&&(i.teardown===null?Ay(i):i.fn=null))}catch(n){Wh(n,i,null,i.ctx)}}}function c1(){if(Mh=!1,zu>1001)return;const r=vf;vf=[],l1(r),Mh||(zu=0,Lh=null)}function Jh(r){Mh||(Mh=!0,queueMicrotask(c1)),Lh=r;for(var t=r;t.parent!==null;){t=t.parent;var e=t.f;if(e&(Xa|zr)){if(!(e&Wn))return;t.f^=Wn}}vf.push(t)}function Gy(r,t){var e=r.first,i=[];t:for(;e!==null;){var n=e.f,s=(n&zr)!==0,a=s&&(n&Wn)!==0,l=e.next;if(!a&&!(n&Cr))if(n&ol){if(s)e.f^=Wn;else try{ja(e)&&$h(e)}catch(m){Wh(m,e,null,e.ctx)}var f=e.first;if(f!==null){e=f;continue}}else n&py&&i.push(e);if(l===null){let m=e.parent;for(;m!==null;){if(r===m)break t;var d=m.next;if(d!==null){e=d;continue t}m=m.parent}}e=l}for(var g=0;g<i.length;g++)f=i[g],t.push(f),Gy(f,t)}function Vt(r){var g;var t=r.f,e=(t&Pi)!==0;if(e&&t&Wa){var i=ky(r);return sd(r),i}if(Ie!==null){Ar!==null&&Ar.includes(r)&&A0();var n=Ie.deps;r.rv<Sh&&(r.rv=Sh,fi===null&&n!==null&&n[Mi]===r?Mi++:fi===null?fi=[r]:fi.push(r))}else if(e&&r.deps===null)for(var s=r,a=s.parent,l=s;a!==null;)if(a.f&Pi){var f=a;l=f,a=f.parent}else{var d=a;(g=d.deriveds)!=null&&g.includes(l)||(d.deriveds??(d.deriveds=[])).push(l);break}return e&&(s=r,ja(s)&&My(s)),r.v}function hs(r){const t=Ie;try{return Ie=null,r()}finally{Ie=t}}const f1=-7169;function Wi(r,t){r.f=r.f&f1|t}function ll(r,t=!1,e){Re={p:Re,c:null,e:null,m:!1,s:r,x:null,l:null},$a&&!t&&(Re.l={s:null,u:null,r1:[],r2:Li(!1)})}function hl(r){const t=Re;if(t!==null){const a=t.e;if(a!==null){var e=Ce,i=Ie;t.e=null;try{for(var n=0;n<a.length;n++){var s=a[n];Nr(s.effect),Js(s.reaction),od(s.fn)}}finally{Nr(e),Js(i)}}Re=t.p,t.m=!0}return{}}function cd(r){if(!(typeof r!="object"||!r||r instanceof EventTarget)){if(Ro in r)xf(r);else if(!Array.isArray(r))for(let t in r){const e=r[t];typeof e=="object"&&e&&Ro in e&&xf(e)}}}function xf(r,t=new Set){if(typeof r=="object"&&r!==null&&!(r instanceof EventTarget)&&!t.has(r)){t.add(r),r instanceof Date&&r.getTime();for(let i in r)try{xf(r[i],t)}catch{}const e=dy(r);if(e!==Object.prototype&&e!==Array.prototype&&e!==Map.prototype&&e!==Set.prototype&&e!==Date.prototype){const i=y0(e);for(let n in i){const s=i[n].get;if(s)try{s.call(r)}catch{}}}}}const d1=["touchstart","touchmove"];function p1(r){return d1.includes(r)}let pp=!1;function g1(){pp||(pp=!0,document.addEventListener("reset",r=>{Promise.resolve().then(()=>{var t;if(!r.defaultPrevented)for(const e of r.target.elements)(t=e.__on_r)==null||t.call(e)})},{capture:!0}))}function Vy(r){var t=Ie,e=Ce;Js(null),Nr(null);try{return r()}finally{Js(t),Nr(e)}}function m1(r,t,e,i=e){r.addEventListener(t,()=>Vy(e));const n=r.__on_r;n?r.__on_r=()=>{n(),i(!0)}:r.__on_r=()=>i(!0),g1()}const y1=new Set,gp=new Set;function _1(r,t,e,i){function n(s){if(i.capture||wu.call(t,s),!s.cancelBubble)return Vy(()=>e.call(this,s))}return r.startsWith("pointer")||r.startsWith("touch")||r==="wheel"?Ry(()=>{t.addEventListener(r,n,i)}):t.addEventListener(r,n,i),n}function Do(r,t,e,i,n){var s={capture:i,passive:n},a=_1(r,t,e,s);(t===document.body||t===window||t===document)&&Sy(()=>{t.removeEventListener(r,a,s)})}function wu(r){var k;var t=this,e=t.ownerDocument,i=r.type,n=((k=r.composedPath)==null?void 0:k.call(r))||[],s=n[0]||r.target,a=0,l=r.__root;if(l){var f=n.indexOf(l);if(f!==-1&&(t===document||t===window)){r.__root=t;return}var d=n.indexOf(t);if(d===-1)return;f<=d&&(a=f)}if(s=n[a]||r.target,s!==t){fy(r,"currentTarget",{configurable:!0,get(){return s||e}});var g=Ie,m=Ce;Js(null),Nr(null);try{for(var v,_=[];s!==null;){var w=s.assignedSlot||s.parentNode||s.host||null;try{var b=s["__"+i];if(b!==void 0&&!s.disabled)if(Hh(b)){var[S,...N]=b;S.apply(s,[r,...N])}else b.call(s,r)}catch(C){v?_.push(C):v=C}if(r.cancelBubble||w===t||w===null)break;s=w}if(v){for(let C of _)queueMicrotask(()=>{throw C});throw v}}finally{r.__root=t,delete r.currentTarget,Js(g),Nr(m)}}}function v1(r){var t=document.createElement("template");return t.innerHTML=r,t.content}function wf(r,t){var e=Ce;e.nodes_start===null&&(e.nodes_start=r,e.nodes_end=t)}function to(r,t){var e=(t&Z0)!==0,i=(t&H0)!==0,n,s=!r.startsWith("<!>");return()=>{n===void 0&&(n=v1(s?r:"<!>"+r),e||(n=wh(n)));var a=i?document.importNode(n,!0):n.cloneNode(!0);if(e){var l=wh(a),f=a.lastChild;wf(l,f)}else wf(a,a);return a}}function x1(){var r=document.createDocumentFragment(),t=document.createComment(""),e=rd();return r.append(t,e),wf(t,e),r}function as(r,t){r!==null&&r.before(t)}function w1(r,t){var e=t==null?"":typeof t=="object"?t+"":t;e!==(r.__t??(r.__t=r.nodeValue))&&(r.__t=e,r.nodeValue=e==null?"":e+"")}function b1(r,t){return E1(r,t)}const aa=new Map;function E1(r,{target:t,anchor:e,props:i={},events:n,context:s,intro:a=!0}){$0();var l=new Set,f=m=>{for(var v=0;v<m.length;v++){var _=m[v];if(!l.has(_)){l.add(_);var w=p1(_);t.addEventListener(_,wu,{passive:w});var b=aa.get(_);b===void 0?(document.addEventListener(_,wu,{passive:w}),aa.set(_,1)):aa.set(_,b+1)}}};f(td(y1)),gp.add(f);var d=void 0,g=t1(()=>{var m=e??t.appendChild(rd());return Yu(()=>{if(s){ll({});var v=Re;v.c=s}n&&(i.$$events=n),d=r(m,i)||{},s&&hl()}),()=>{var w;for(var v of l){t.removeEventListener(v,wu);var _=aa.get(v);--_===0?(document.removeEventListener(v,wu),aa.delete(v)):aa.set(v,_)}gp.delete(f),m!==e&&((w=m.parentNode)==null||w.removeChild(m))}});return k1.set(d,g),d}let k1=new WeakMap;function bf(r,t,e=!1){var i=r,n=null,s=null,a=li,l=e?nd:0,f=!1;const d=(m,v=!0)=>{f=!0,g(v,m)},g=(m,v)=>{a!==(a=m)&&(a?(n?kh(n):v&&(n=Yu(()=>v(i))),s&&Eh(s,()=>{s=null})):(s?kh(s):v&&(s=Yu(()=>v(i))),n&&Eh(n,()=>{n=null})))};ud(()=>{f=!1,t(d),f||g(null,null)},l)}function M1(r,t){return t}function L1(r,t,e,i){for(var n=[],s=t.length,a=0;a<s;a++)ld(t[a].e,n,!0);var l=s>0&&n.length===0&&e!==null;if(l){var f=e.parentNode;J0(f),f.append(e),i.clear(),Hs(r,t[0].prev,t[s-1].next)}Ny(n,()=>{for(var d=0;d<s;d++){var g=t[d];l||(i.delete(g.k),Hs(r,g.prev,g.next)),$s(g.e,!l)}})}function S1(r,t,e,i,n,s=null){var a=r,l={flags:t,items:new Map,first:null};{var f=r;a=f.appendChild(rd())}var d=null,g=!1,m=by(()=>{var v=e();return Hh(v)?v:v==null?[]:td(v)});ud(()=>{var v=Vt(m),_=v.length;if(!(g&&_===0)){g=_===0;{var w=Ie;T1(v,l,a,n,t,(w.f&Cr)!==0,i)}s!==null&&(_===0?d?kh(d):d=Yu(()=>s(a)):d!==null&&Eh(d,()=>{d=null})),Vt(m)}})}function T1(r,t,e,i,n,s,a,l){var f=r.length,d=t.items,g=t.first,m=g,v,_=null,w=[],b=[],S,N,k,C;for(C=0;C<f;C+=1){if(S=r[C],N=a(S,C),k=d.get(N),k===void 0){var A=m?m.e.nodes_start:e;_=I1(A,t,_,_===null?t.first:_.next,S,N,C,i,n),d.set(N,_),w=[],b=[],m=_.next;continue}if(P1(k,S,C),k.e.f&Cr&&kh(k.e),k!==m){if(v!==void 0&&v.has(k)){if(w.length<b.length){var P=b[0],q;_=P.prev;var U=w[0],I=w[w.length-1];for(q=0;q<w.length;q+=1)mp(w[q],P,e);for(q=0;q<b.length;q+=1)v.delete(b[q]);Hs(t,U.prev,I.next),Hs(t,_,U),Hs(t,I,P),m=P,_=I,C-=1,w=[],b=[]}else v.delete(k),mp(k,m,e),Hs(t,k.prev,k.next),Hs(t,k,_===null?t.first:_.next),Hs(t,_,k),_=k;continue}for(w=[],b=[];m!==null&&m.k!==N;)(s||!(m.e.f&Cr))&&(v??(v=new Set)).add(m),b.push(m),m=m.next;if(m===null)continue;k=m}w.push(k),_=k,m=k.next}if(m!==null||v!==void 0){for(var O=v===void 0?[]:td(v);m!==null;)(s||!(m.e.f&Cr))&&O.push(m),m=m.next;var B=O.length;if(B>0){var V=f===0?e:null;L1(t,O,V,d)}}Ce.first=t.first&&t.first.e,Ce.last=_&&_.e}function P1(r,t,e,i){_y(r.v,t),r.i=e}function I1(r,t,e,i,n,s,a,l,f,d){var g=(f&D0)!==0,m=(f&B0)===0,v=g?m?Yh(n):Li(n):n,_=f&z0?Li(a):a,w={i:_,v,k:s,a:null,e:null,prev:e,next:i};try{return w.e=Yu(()=>l(r,v,_),W0),w.e.prev=e&&e.e,w.e.next=i&&i.e,e===null?t.first=w:(e.next=w,e.e.next=w.e),i!==null&&(i.prev=w,i.e.prev=w.e),w}finally{}}function mp(r,t,e){for(var i=r.next?r.next.e.nodes_start:e,n=t?t.e.nodes_start:e,s=r.e.nodes_start;s!==i;){var a=Xh(s);n.before(s),s=a}}function Hs(r,t,e){t===null?r.first=e:(t.next=e,t.e.next=e&&e.e),e!==null&&(e.prev=t,e.e.prev=t&&t.e)}function C1(r,t){t?r.hasAttribute("selected")||r.setAttribute("selected",""):r.removeAttribute("selected")}function Ef(r,t,e=t){var i=ul();m1(r,"input",n=>{var s=n?r.defaultValue:r.value;if(s=pc(r)?gc(s):s,e(s),i&&s!==(s=t())){var a=r.selectionStart,l=r.selectionEnd;r.value=s??"",l!==null&&(r.selectionStart=a,r.selectionEnd=Math.min(l,r.value.length))}}),hs(t)==null&&r.value&&e(pc(r)?gc(r.value):r.value),al(()=>{var n=t();pc(r)&&n===gc(r.value)||r.type==="date"&&!n&&!r.value||n!==r.value&&(r.value=n??"")})}function pc(r){var t=r.type;return t==="number"||t==="range"}function gc(r){return r===""?null:+r}function yp(r,t){return r===t||(r==null?void 0:r[Ro])===t}function A1(r={},t,e,i){return od(()=>{var n,s;return al(()=>{n=s,s=[],hs(()=>{r!==e(...s)&&(t(r,...s),n&&yp(e(...n),r)&&t(null,...n))})}),()=>{Ry(()=>{s&&yp(e(...s),r)&&t(null,...s)})}}),r}function jh(r=!1){const t=Re,e=t.l.u;if(!e)return;let i=()=>cd(t.s);if(r){let n=0,s={};const a=bh(()=>{let l=!1;const f=t.s;for(const d in f)f[d]!==s[d]&&(s[d]=f[d],l=!0);return l&&n++,n});i=()=>Vt(a)}e.b.length&&Q0(()=>{_p(t,i),pf(e.b)}),mf(()=>{const n=hs(()=>e.m.map(x0));return()=>{for(const s of n)typeof s=="function"&&s()}}),e.a.length&&mf(()=>{_p(t,i),pf(e.a)})}function _p(r,t){if(r.l.s)for(const e of r.l.s)Vt(e);t()}function N1(r){var t=Li(0);return function(){return arguments.length===1?(Oe(t,Vt(t)+1),arguments[0]):(Vt(t),r())}}function qy(r,t,e){if(r==null)return t(void 0),Ca;const i=hs(()=>r.subscribe(t,e));return i.unsubscribe?()=>i.unsubscribe():i}const ua=[];function fd(r,t=Ca){let e=null;const i=new Set;function n(l){if(yy(r,l)&&(r=l,e)){const f=!ua.length;for(const d of i)d[1](),ua.push(d,r);if(f){for(let d=0;d<ua.length;d+=2)ua[d][0](ua[d+1]);ua.length=0}}}function s(l){n(l(r))}function a(l,f=Ca){const d=[l,f];return i.add(d),i.size===1&&(e=t(n,s)||Ca),l(r),()=>{i.delete(d),i.size===0&&e&&(e(),e=null)}}return{set:n,update:s,subscribe:a}}function O1(r){let t;return qy(r,e=>t=e)(),t}let wl=!1,kf=Symbol();function Bu(r,t,e){const i=e[t]??(e[t]={store:null,source:Yh(void 0),unsubscribe:Ca});if(i.store!==r&&!(kf in e))if(i.unsubscribe(),i.store=r??null,r==null)i.source.v=void 0,i.unsubscribe=Ca;else{var n=!0;i.unsubscribe=qy(r,s=>{n?i.source.v=s:Oe(i.source,s)}),n=!1}return r&&kf in e?O1(r):Vt(i.source)}function Mf(r,t){return r.set(t),t}function dd(){const r={};function t(){Sy(()=>{for(var e in r)r[e].unsubscribe();fy(r,kf,{enumerable:!1,value:!0})})}return[r,t]}function R1(r){var t=wl;try{return wl=!1,[r(),wl]}finally{wl=t}}function vp(r){for(var t=Ce,e=Ce;t!==null&&!(t.f&(zr|Xa));)t=t.parent;try{return Nr(t),r()}finally{Nr(e)}}function Fu(r,t,e,i){var U;var n=(e&F0)!==0,s=!$a||(e&U0)!==0,a=(e&V0)!==0,l=(e&q0)!==0,f=!1,d;a?[d,f]=R1(()=>r[t]):d=r[t];var g=Ro in r||k0 in r,m=a&&(((U=Ia(r,t))==null?void 0:U.set)??(g&&t in r&&(I=>r[t]=I)))||void 0,v=i,_=!0,w=!1,b=()=>(w=!0,_&&(_=!1,l?v=hs(i):v=i),v);d===void 0&&i!==void 0&&(m&&s&&P0(),d=b(),m&&m(d));var S;if(s)S=()=>{var I=r[t];return I===void 0?b():(_=!0,w=!1,I)};else{var N=vp(()=>(n?bh:by)(()=>r[t]));N.f|=b0,S=()=>{var I=Vt(N);return I!==void 0&&(v=void 0),I===void 0?v:I}}if(!(e&G0))return S;if(m){var k=r.$$legacy;return function(I,O){return arguments.length>0?((!s||!O||k||f)&&m(O?S():I),I):S()}}var C=!1,A=!1,P=Yh(d),q=vp(()=>bh(()=>{var I=S(),O=Vt(P);return C?(C=!1,A=!0,O):(A=!1,P.v=I)}));return n||(q.equals=id),function(I,O){if(arguments.length>0){const B=O?Vt(q):s&&a?ba(I):I;return q.equals(B)||(C=!0,Oe(P,B),w&&v!==void 0&&(v=B),hs(()=>Vt(q))),I}return Vt(q)}}function D1(r){Re===null&&Dy(),$a&&Re.l!==null?B1(Re).m.push(r):mf(()=>{const t=hs(r);if(typeof t=="function")return t})}function z1(r,t,{bubbles:e=!1,cancelable:i=!1}={}){return new CustomEvent(r,{detail:t,bubbles:e,cancelable:i})}function Zy(){const r=Re;return r===null&&Dy(),(t,e,i)=>{var s;const n=(s=r.s.$$events)==null?void 0:s[t];if(n){const a=Hh(n)?n.slice():[n],l=z1(t,e,i);for(const f of a)f.call(r.x,l);return!l.defaultPrevented}return!0}}function B1(r){var t=r.l;return t.u??(t.u={a:[],b:[],m:[]})}const F1="5";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(F1);R0();const hh=fd(null),Wu=fd(null),Uu=fd(null);var U1=to("<option> </option>"),G1=to('<div class="svelte-1lvjhsb"><label for="layer-selector">Select Map Layer:</label> <select id="layer-selector"></select></div>');function V1(r,t){ll(t,!1);const e=[{label:"OpenStreetMap Default",value:"https://tile.openstreetmap.org/{z}/{x}/{y}.png",attribution:"&copy; OpenStreetMap contributors"},{label:"CartoDB Positron",value:"https://basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png",attribution:"&copy; OpenStreetMap contributors &copy; CartoDB"},{label:"CartoDB Dark Matter",value:"https://basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png",attribution:"&copy; OpenStreetMap contributors &copy; CartoDB"},{label:"OpenTopoMap",value:"https://tile.opentopomap.org/{z}/{x}/{y}.png",attribution:"&copy; OpenStreetMap contributors &copy; OpenTopoMap"},{label:"ESRI Satellite",value:"https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}",attribution:"Tiles &copy; Esri &mdash; Source: Esri, i-cubed, USDA, USGS, AEX, GeoEye, Getmapping, Aerogrid, IGN, IGP, UPR-EGP, and the GIS User Community"},{label:"ESRI World Imagery",value:"https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}",attribution:"Tiles &copy; Esri &mdash; Source: Esri, i-cubed, USDA, USGS, AEX, GeoEye, Getmapping, Aerogrid, IGN, IGP, UPR-EGP, and the GIS User Community"},{label:"ESRI World Street Map",value:"https://server.arcgisonline.com/ArcGIS/rest/services/World_Street_Map/MapServer/tile/{z}/{y}/{x}",attribution:"Tiles &copy; Esri &mdash; Source: Esri, DeLorme, NAVTEQ"},{label:"ESRI World Topo Map",value:"https://server.arcgisonline.com/ArcGIS/rest/services/World_Topo_Map/MapServer/tile/{z}/{y}/{x}",attribution:"Tiles &copy; Esri &mdash; Source: Esri, DeLorme, NAVTEQ"}];let i=Fu(t,"selectedLayer",28,()=>e[0]);const n=Zy(),s=f=>{i(f),n("change",{layer:f})};jh();var a=G1(),l=ti(Hu(a),2);S1(l,5,()=>e,M1,(f,d)=>{var g=U1(),m={},v=Hu(g);Ty(()=>{m!==(m=Vt(d).value)&&(g.value=(g.__value=Vt(d).value)==null?"":Vt(d).value),C1(g,Vt(d)===i()),w1(v,Vt(d).label)}),as(f,g)}),Do("change",l,f=>s(e[f.target.selectedIndex])),as(r,a),hl()}var Ys=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function eo(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}function q1(r){if(r.__esModule)return r;var t=r.default;if(typeof t=="function"){var e=function i(){return this instanceof i?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};e.prototype=t.prototype}else e={};return Object.defineProperty(e,"__esModule",{value:!0}),Object.keys(r).forEach(function(i){var n=Object.getOwnPropertyDescriptor(r,i);Object.defineProperty(e,i,n.get?n:{enumerable:!0,get:function(){return r[i]}})}),e}var bu={exports:{}};/* @preserve
 * Leaflet 1.9.4, a JS library for interactive maps. https://leafletjs.com
 * (c) 2010-2023 Vladimir Agafonkin, (c) 2010-2011 CloudMade
 */var Z1=bu.exports,xp;function H1(){return xp||(xp=1,function(r,t){(function(e,i){i(t)})(Z1,function(e){var i="1.9.4";function n(h){var y,E,R,H;for(E=1,R=arguments.length;E<R;E++){H=arguments[E];for(y in H)h[y]=H[y]}return h}var s=Object.create||function(){function h(){}return function(y){return h.prototype=y,new h}}();function a(h,y){var E=Array.prototype.slice;if(h.bind)return h.bind.apply(h,E.call(arguments,1));var R=E.call(arguments,2);return function(){return h.apply(y,R.length?R.concat(E.call(arguments)):arguments)}}var l=0;function f(h){return"_leaflet_id"in h||(h._leaflet_id=++l),h._leaflet_id}function d(h,y,E){var R,H,nt,pt;return pt=function(){R=!1,H&&(nt.apply(E,H),H=!1)},nt=function(){R?H=arguments:(h.apply(E,arguments),setTimeout(pt,y),R=!0)},nt}function g(h,y,E){var R=y[1],H=y[0],nt=R-H;return h===R&&E?h:((h-H)%nt+nt)%nt+H}function m(){return!1}function v(h,y){if(y===!1)return h;var E=Math.pow(10,y===void 0?6:y);return Math.round(h*E)/E}function _(h){return h.trim?h.trim():h.replace(/^\s+|\s+$/g,"")}function w(h){return _(h).split(/\s+/)}function b(h,y){Object.prototype.hasOwnProperty.call(h,"options")||(h.options=h.options?s(h.options):{});for(var E in y)h.options[E]=y[E];return h.options}function S(h,y,E){var R=[];for(var H in h)R.push(encodeURIComponent(E?H.toUpperCase():H)+"="+encodeURIComponent(h[H]));return(!y||y.indexOf("?")===-1?"?":"&")+R.join("&")}var N=/\{ *([\w_ -]+) *\}/g;function k(h,y){return h.replace(N,function(E,R){var H=y[R];if(H===void 0)throw new Error("No value provided for variable "+E);return typeof H=="function"&&(H=H(y)),H})}var C=Array.isArray||function(h){return Object.prototype.toString.call(h)==="[object Array]"};function A(h,y){for(var E=0;E<h.length;E++)if(h[E]===y)return E;return-1}var P="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function q(h){return window["webkit"+h]||window["moz"+h]||window["ms"+h]}var U=0;function I(h){var y=+new Date,E=Math.max(0,16-(y-U));return U=y+E,window.setTimeout(h,E)}var O=window.requestAnimationFrame||q("RequestAnimationFrame")||I,B=window.cancelAnimationFrame||q("CancelAnimationFrame")||q("CancelRequestAnimationFrame")||function(h){window.clearTimeout(h)};function V(h,y,E){if(E&&O===I)h.call(y);else return O.call(window,a(h,y))}function z(h){h&&B.call(window,h)}var W={__proto__:null,extend:n,create:s,bind:a,get lastId(){return l},stamp:f,throttle:d,wrapNum:g,falseFn:m,formatNum:v,trim:_,splitWords:w,setOptions:b,getParamString:S,template:k,isArray:C,indexOf:A,emptyImageUrl:P,requestFn:O,cancelFn:B,requestAnimFrame:V,cancelAnimFrame:z};function T(){}T.extend=function(h){var y=function(){b(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},E=y.__super__=this.prototype,R=s(E);R.constructor=y,y.prototype=R;for(var H in this)Object.prototype.hasOwnProperty.call(this,H)&&H!=="prototype"&&H!=="__super__"&&(y[H]=this[H]);return h.statics&&n(y,h.statics),h.includes&&($(h.includes),n.apply(null,[R].concat(h.includes))),n(R,h),delete R.statics,delete R.includes,R.options&&(R.options=E.options?s(E.options):{},n(R.options,h.options)),R._initHooks=[],R.callInitHooks=function(){if(!this._initHooksCalled){E.callInitHooks&&E.callInitHooks.call(this),this._initHooksCalled=!0;for(var nt=0,pt=R._initHooks.length;nt<pt;nt++)R._initHooks[nt].call(this)}},y},T.include=function(h){var y=this.prototype.options;return n(this.prototype,h),h.options&&(this.prototype.options=y,this.mergeOptions(h.options)),this},T.mergeOptions=function(h){return n(this.prototype.options,h),this},T.addInitHook=function(h){var y=Array.prototype.slice.call(arguments,1),E=typeof h=="function"?h:function(){this[h].apply(this,y)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(E),this};function $(h){if(!(typeof L>"u"||!L||!L.Mixin)){h=C(h)?h:[h];for(var y=0;y<h.length;y++)h[y]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",new Error().stack)}}var F={on:function(h,y,E){if(typeof h=="object")for(var R in h)this._on(R,h[R],y);else{h=w(h);for(var H=0,nt=h.length;H<nt;H++)this._on(h[H],y,E)}return this},off:function(h,y,E){if(!arguments.length)delete this._events;else if(typeof h=="object")for(var R in h)this._off(R,h[R],y);else{h=w(h);for(var H=arguments.length===1,nt=0,pt=h.length;nt<pt;nt++)H?this._off(h[nt]):this._off(h[nt],y,E)}return this},_on:function(h,y,E,R){if(typeof y!="function"){console.warn("wrong listener type: "+typeof y);return}if(this._listens(h,y,E)===!1){E===this&&(E=void 0);var H={fn:y,ctx:E};R&&(H.once=!0),this._events=this._events||{},this._events[h]=this._events[h]||[],this._events[h].push(H)}},_off:function(h,y,E){var R,H,nt;if(this._events&&(R=this._events[h],!!R)){if(arguments.length===1){if(this._firingCount)for(H=0,nt=R.length;H<nt;H++)R[H].fn=m;delete this._events[h];return}if(typeof y!="function"){console.warn("wrong listener type: "+typeof y);return}var pt=this._listens(h,y,E);if(pt!==!1){var vt=R[pt];this._firingCount&&(vt.fn=m,this._events[h]=R=R.slice()),R.splice(pt,1)}}},fire:function(h,y,E){if(!this.listens(h,E))return this;var R=n({},y,{type:h,target:this,sourceTarget:y&&y.sourceTarget||this});if(this._events){var H=this._events[h];if(H){this._firingCount=this._firingCount+1||1;for(var nt=0,pt=H.length;nt<pt;nt++){var vt=H[nt],bt=vt.fn;vt.once&&this.off(h,bt,vt.ctx),bt.call(vt.ctx||this,R)}this._firingCount--}}return E&&this._propagateEvent(R),this},listens:function(h,y,E,R){typeof h!="string"&&console.warn('"string" type argument expected');var H=y;typeof y!="function"&&(R=!!y,H=void 0,E=void 0);var nt=this._events&&this._events[h];if(nt&&nt.length&&this._listens(h,H,E)!==!1)return!0;if(R){for(var pt in this._eventParents)if(this._eventParents[pt].listens(h,y,E,R))return!0}return!1},_listens:function(h,y,E){if(!this._events)return!1;var R=this._events[h]||[];if(!y)return!!R.length;E===this&&(E=void 0);for(var H=0,nt=R.length;H<nt;H++)if(R[H].fn===y&&R[H].ctx===E)return H;return!1},once:function(h,y,E){if(typeof h=="object")for(var R in h)this._on(R,h[R],y,!0);else{h=w(h);for(var H=0,nt=h.length;H<nt;H++)this._on(h[H],y,E,!0)}return this},addEventParent:function(h){return this._eventParents=this._eventParents||{},this._eventParents[f(h)]=h,this},removeEventParent:function(h){return this._eventParents&&delete this._eventParents[f(h)],this},_propagateEvent:function(h){for(var y in this._eventParents)this._eventParents[y].fire(h.type,n({layer:h.target,propagatedFrom:h.target},h),!0)}};F.addEventListener=F.on,F.removeEventListener=F.clearAllEventListeners=F.off,F.addOneTimeEventListener=F.once,F.fireEvent=F.fire,F.hasEventListeners=F.listens;var X=T.extend(F);function Y(h,y,E){this.x=E?Math.round(h):h,this.y=E?Math.round(y):y}var j=Math.trunc||function(h){return h>0?Math.floor(h):Math.ceil(h)};Y.prototype={clone:function(){return new Y(this.x,this.y)},add:function(h){return this.clone()._add(J(h))},_add:function(h){return this.x+=h.x,this.y+=h.y,this},subtract:function(h){return this.clone()._subtract(J(h))},_subtract:function(h){return this.x-=h.x,this.y-=h.y,this},divideBy:function(h){return this.clone()._divideBy(h)},_divideBy:function(h){return this.x/=h,this.y/=h,this},multiplyBy:function(h){return this.clone()._multiplyBy(h)},_multiplyBy:function(h){return this.x*=h,this.y*=h,this},scaleBy:function(h){return new Y(this.x*h.x,this.y*h.y)},unscaleBy:function(h){return new Y(this.x/h.x,this.y/h.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=j(this.x),this.y=j(this.y),this},distanceTo:function(h){h=J(h);var y=h.x-this.x,E=h.y-this.y;return Math.sqrt(y*y+E*E)},equals:function(h){return h=J(h),h.x===this.x&&h.y===this.y},contains:function(h){return h=J(h),Math.abs(h.x)<=Math.abs(this.x)&&Math.abs(h.y)<=Math.abs(this.y)},toString:function(){return"Point("+v(this.x)+", "+v(this.y)+")"}};function J(h,y,E){return h instanceof Y?h:C(h)?new Y(h[0],h[1]):h==null?h:typeof h=="object"&&"x"in h&&"y"in h?new Y(h.x,h.y):new Y(h,y,E)}function K(h,y){if(h)for(var E=y?[h,y]:h,R=0,H=E.length;R<H;R++)this.extend(E[R])}K.prototype={extend:function(h){var y,E;if(!h)return this;if(h instanceof Y||typeof h[0]=="number"||"x"in h)y=E=J(h);else if(h=et(h),y=h.min,E=h.max,!y||!E)return this;return!this.min&&!this.max?(this.min=y.clone(),this.max=E.clone()):(this.min.x=Math.min(y.x,this.min.x),this.max.x=Math.max(E.x,this.max.x),this.min.y=Math.min(y.y,this.min.y),this.max.y=Math.max(E.y,this.max.y)),this},getCenter:function(h){return J((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,h)},getBottomLeft:function(){return J(this.min.x,this.max.y)},getTopRight:function(){return J(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(h){var y,E;return typeof h[0]=="number"||h instanceof Y?h=J(h):h=et(h),h instanceof K?(y=h.min,E=h.max):y=E=h,y.x>=this.min.x&&E.x<=this.max.x&&y.y>=this.min.y&&E.y<=this.max.y},intersects:function(h){h=et(h);var y=this.min,E=this.max,R=h.min,H=h.max,nt=H.x>=y.x&&R.x<=E.x,pt=H.y>=y.y&&R.y<=E.y;return nt&&pt},overlaps:function(h){h=et(h);var y=this.min,E=this.max,R=h.min,H=h.max,nt=H.x>y.x&&R.x<E.x,pt=H.y>y.y&&R.y<E.y;return nt&&pt},isValid:function(){return!!(this.min&&this.max)},pad:function(h){var y=this.min,E=this.max,R=Math.abs(y.x-E.x)*h,H=Math.abs(y.y-E.y)*h;return et(J(y.x-R,y.y-H),J(E.x+R,E.y+H))},equals:function(h){return h?(h=et(h),this.min.equals(h.getTopLeft())&&this.max.equals(h.getBottomRight())):!1}};function et(h,y){return!h||h instanceof K?h:new K(h,y)}function ft(h,y){if(h)for(var E=y?[h,y]:h,R=0,H=E.length;R<H;R++)this.extend(E[R])}ft.prototype={extend:function(h){var y=this._southWest,E=this._northEast,R,H;if(h instanceof ut)R=h,H=h;else if(h instanceof ft){if(R=h._southWest,H=h._northEast,!R||!H)return this}else return h?this.extend(mt(h)||lt(h)):this;return!y&&!E?(this._southWest=new ut(R.lat,R.lng),this._northEast=new ut(H.lat,H.lng)):(y.lat=Math.min(R.lat,y.lat),y.lng=Math.min(R.lng,y.lng),E.lat=Math.max(H.lat,E.lat),E.lng=Math.max(H.lng,E.lng)),this},pad:function(h){var y=this._southWest,E=this._northEast,R=Math.abs(y.lat-E.lat)*h,H=Math.abs(y.lng-E.lng)*h;return new ft(new ut(y.lat-R,y.lng-H),new ut(E.lat+R,E.lng+H))},getCenter:function(){return new ut((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new ut(this.getNorth(),this.getWest())},getSouthEast:function(){return new ut(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(h){typeof h[0]=="number"||h instanceof ut||"lat"in h?h=mt(h):h=lt(h);var y=this._southWest,E=this._northEast,R,H;return h instanceof ft?(R=h.getSouthWest(),H=h.getNorthEast()):R=H=h,R.lat>=y.lat&&H.lat<=E.lat&&R.lng>=y.lng&&H.lng<=E.lng},intersects:function(h){h=lt(h);var y=this._southWest,E=this._northEast,R=h.getSouthWest(),H=h.getNorthEast(),nt=H.lat>=y.lat&&R.lat<=E.lat,pt=H.lng>=y.lng&&R.lng<=E.lng;return nt&&pt},overlaps:function(h){h=lt(h);var y=this._southWest,E=this._northEast,R=h.getSouthWest(),H=h.getNorthEast(),nt=H.lat>y.lat&&R.lat<E.lat,pt=H.lng>y.lng&&R.lng<E.lng;return nt&&pt},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(h,y){return h?(h=lt(h),this._southWest.equals(h.getSouthWest(),y)&&this._northEast.equals(h.getNorthEast(),y)):!1},isValid:function(){return!!(this._southWest&&this._northEast)}};function lt(h,y){return h instanceof ft?h:new ft(h,y)}function ut(h,y,E){if(isNaN(h)||isNaN(y))throw new Error("Invalid LatLng object: ("+h+", "+y+")");this.lat=+h,this.lng=+y,E!==void 0&&(this.alt=+E)}ut.prototype={equals:function(h,y){if(!h)return!1;h=mt(h);var E=Math.max(Math.abs(this.lat-h.lat),Math.abs(this.lng-h.lng));return E<=(y===void 0?1e-9:y)},toString:function(h){return"LatLng("+v(this.lat,h)+", "+v(this.lng,h)+")"},distanceTo:function(h){return at.distance(this,mt(h))},wrap:function(){return at.wrapLatLng(this)},toBounds:function(h){var y=180*h/40075017,E=y/Math.cos(Math.PI/180*this.lat);return lt([this.lat-y,this.lng-E],[this.lat+y,this.lng+E])},clone:function(){return new ut(this.lat,this.lng,this.alt)}};function mt(h,y,E){return h instanceof ut?h:C(h)&&typeof h[0]!="object"?h.length===3?new ut(h[0],h[1],h[2]):h.length===2?new ut(h[0],h[1]):null:h==null?h:typeof h=="object"&&"lat"in h?new ut(h.lat,"lng"in h?h.lng:h.lon,h.alt):y===void 0?null:new ut(h,y,E)}var Et={latLngToPoint:function(h,y){var E=this.projection.project(h),R=this.scale(y);return this.transformation._transform(E,R)},pointToLatLng:function(h,y){var E=this.scale(y),R=this.transformation.untransform(h,E);return this.projection.unproject(R)},project:function(h){return this.projection.project(h)},unproject:function(h){return this.projection.unproject(h)},scale:function(h){return 256*Math.pow(2,h)},zoom:function(h){return Math.log(h/256)/Math.LN2},getProjectedBounds:function(h){if(this.infinite)return null;var y=this.projection.bounds,E=this.scale(h),R=this.transformation.transform(y.min,E),H=this.transformation.transform(y.max,E);return new K(R,H)},infinite:!1,wrapLatLng:function(h){var y=this.wrapLng?g(h.lng,this.wrapLng,!0):h.lng,E=this.wrapLat?g(h.lat,this.wrapLat,!0):h.lat,R=h.alt;return new ut(E,y,R)},wrapLatLngBounds:function(h){var y=h.getCenter(),E=this.wrapLatLng(y),R=y.lat-E.lat,H=y.lng-E.lng;if(R===0&&H===0)return h;var nt=h.getSouthWest(),pt=h.getNorthEast(),vt=new ut(nt.lat-R,nt.lng-H),bt=new ut(pt.lat-R,pt.lng-H);return new ft(vt,bt)}},at=n({},Et,{wrapLng:[-180,180],R:6371e3,distance:function(h,y){var E=Math.PI/180,R=h.lat*E,H=y.lat*E,nt=Math.sin((y.lat-h.lat)*E/2),pt=Math.sin((y.lng-h.lng)*E/2),vt=nt*nt+Math.cos(R)*Math.cos(H)*pt*pt,bt=2*Math.atan2(Math.sqrt(vt),Math.sqrt(1-vt));return this.R*bt}}),Rt=6378137,xt={R:Rt,MAX_LATITUDE:85.0511287798,project:function(h){var y=Math.PI/180,E=this.MAX_LATITUDE,R=Math.max(Math.min(E,h.lat),-E),H=Math.sin(R*y);return new Y(this.R*h.lng*y,this.R*Math.log((1+H)/(1-H))/2)},unproject:function(h){var y=180/Math.PI;return new ut((2*Math.atan(Math.exp(h.y/this.R))-Math.PI/2)*y,h.x*y/this.R)},bounds:function(){var h=Rt*Math.PI;return new K([-h,-h],[h,h])}()};function _t(h,y,E,R){if(C(h)){this._a=h[0],this._b=h[1],this._c=h[2],this._d=h[3];return}this._a=h,this._b=y,this._c=E,this._d=R}_t.prototype={transform:function(h,y){return this._transform(h.clone(),y)},_transform:function(h,y){return y=y||1,h.x=y*(this._a*h.x+this._b),h.y=y*(this._c*h.y+this._d),h},untransform:function(h,y){return y=y||1,new Y((h.x/y-this._b)/this._a,(h.y/y-this._d)/this._c)}};function tt(h,y,E,R){return new _t(h,y,E,R)}var wt=n({},at,{code:"EPSG:3857",projection:xt,transformation:function(){var h=.5/(Math.PI*xt.R);return tt(h,.5,-h,.5)}()}),G=n({},wt,{code:"EPSG:900913"});function ct(h){return document.createElementNS("http://www.w3.org/2000/svg",h)}function ht(h,y){var E="",R,H,nt,pt,vt,bt;for(R=0,nt=h.length;R<nt;R++){for(vt=h[R],H=0,pt=vt.length;H<pt;H++)bt=vt[H],E+=(H?"L":"M")+bt.x+" "+bt.y;E+=y?Zt.svg?"z":"x":""}return E||"M0 0"}var ot=document.documentElement.style,it="ActiveXObject"in window,st=it&&!document.addEventListener,kt="msLaunchUri"in navigator&&!("documentMode"in document),Lt=an("webkit"),yt=an("android"),At=an("android 2")||an("android 3"),St=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),Ct=yt&&an("Google")&&St<537&&!("AudioNode"in window),Bt=!!window.opera,ue=!kt&&an("chrome"),Pt=an("gecko")&&!Lt&&!Bt&&!it,be=!ue&&an("safari"),Xt=an("phantom"),Ut="OTransition"in ot,tn=navigator.platform.indexOf("Win")===0,le=it&&"transition"in ot,en="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!At,Ft="MozPerspective"in ot,nn=!window.L_DISABLE_3D&&(le||en||Ft)&&!Ut&&!Xt,Dn=typeof orientation<"u"||an("mobile"),zn=Dn&&Lt,ze=Dn&&en,In=!window.PointerEvent&&window.MSPointerEvent,Ue=!!(window.PointerEvent||In),Se="ontouchstart"in window||!!window.TouchEvent,$n=!window.L_NO_TOUCH&&(Se||Ue),ei=Dn&&Bt,ms=Dn&&Pt,Ii=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,Dt=function(){var h=!1;try{var y=Object.defineProperty({},"passive",{get:function(){h=!0}});window.addEventListener("testPassiveEventSupport",m,y),window.removeEventListener("testPassiveEventSupport",m,y)}catch{}return h}(),$i=function(){return!!document.createElement("canvas").getContext}(),Ji=!!(document.createElementNS&&ct("svg").createSVGRect),Fr=!!Ji&&function(){var h=document.createElement("div");return h.innerHTML="<svg/>",(h.firstChild&&h.firstChild.namespaceURI)==="http://www.w3.org/2000/svg"}(),so=!Ji&&function(){try{var h=document.createElement("div");h.innerHTML='<v:shape adj="1"/>';var y=h.firstChild;return y.style.behavior="url(#default#VML)",y&&typeof y.adj=="object"}catch{return!1}}(),oo=navigator.platform.indexOf("Mac")===0,ao=navigator.platform.indexOf("Linux")===0;function an(h){return navigator.userAgent.toLowerCase().indexOf(h)>=0}var Zt={ie:it,ielt9:st,edge:kt,webkit:Lt,android:yt,android23:At,androidStock:Ct,opera:Bt,chrome:ue,gecko:Pt,safari:be,phantom:Xt,opera12:Ut,win:tn,ie3d:le,webkit3d:en,gecko3d:Ft,any3d:nn,mobile:Dn,mobileWebkit:zn,mobileWebkit3d:ze,msPointer:In,pointer:Ue,touch:$n,touchNative:Se,mobileOpera:ei,mobileGecko:ms,retina:Ii,passiveEvents:Dt,canvas:$i,svg:Ji,vml:so,inlineSvg:Fr,mac:oo,linux:ao},_r=Zt.msPointer?"MSPointerDown":"pointerdown",ys=Zt.msPointer?"MSPointerMove":"pointermove",ji=Zt.msPointer?"MSPointerUp":"pointerup",_s=Zt.msPointer?"MSPointerCancel":"pointercancel",rn={touchstart:_r,touchmove:ys,touchend:ji,touchcancel:_s},vr={touchstart:Gr,touchmove:Ai,touchend:Ai,touchcancel:Ai},En={},Ci=!1;function Ki(h,y,E){return y==="touchstart"&&xs(),vr[y]?(E=vr[y].bind(this,E),h.addEventListener(rn[y],E,!1),E):(console.warn("wrong event specified:",y),m)}function uo(h,y,E){if(!rn[y]){console.warn("wrong event specified:",y);return}h.removeEventListener(rn[y],E,!1)}function vs(h){En[h.pointerId]=h}function Ur(h){En[h.pointerId]&&(En[h.pointerId]=h)}function Ge(h){delete En[h.pointerId]}function xs(){Ci||(document.addEventListener(_r,vs,!0),document.addEventListener(ys,Ur,!0),document.addEventListener(ji,Ge,!0),document.addEventListener(_s,Ge,!0),Ci=!0)}function Ai(h,y){if(y.pointerType!==(y.MSPOINTER_TYPE_MOUSE||"mouse")){y.touches=[];for(var E in En)y.touches.push(En[E]);y.changedTouches=[y],h(y)}}function Gr(h,y){y.MSPOINTER_TYPE_TOUCH&&y.pointerType===y.MSPOINTER_TYPE_TOUCH&&Be(y),Ai(h,y)}function se(h){var y={},E,R;for(R in h)E=h[R],y[R]=E&&E.bind?E.bind(h):E;return h=y,y.type="dblclick",y.detail=2,y.isTrusted=!1,y._simulated=!0,y}var mi=200;function lo(h,y){h.addEventListener("dblclick",y);var E=0,R;function H(nt){if(nt.detail!==1){R=nt.detail;return}if(!(nt.pointerType==="mouse"||nt.sourceCapabilities&&!nt.sourceCapabilities.firesTouchEvents)){var pt=ln(nt);if(!(pt.some(function(bt){return bt instanceof HTMLLabelElement&&bt.attributes.for})&&!pt.some(function(bt){return bt instanceof HTMLInputElement||bt instanceof HTMLSelectElement}))){var vt=Date.now();vt-E<=mi?(R++,R===2&&y(se(nt))):R=1,E=vt}}}return h.addEventListener("click",H),{dblclick:y,simDblclick:H}}function Wo(h,y){h.removeEventListener("dblclick",y.dblclick),h.removeEventListener("click",y.simDblclick)}var ho=Es(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),xn=Es(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),Qi=xn==="webkitTransition"||xn==="OTransition"?xn+"End":"transitionend";function Bn(h){return typeof h=="string"?document.getElementById(h):h}function ni(h,y){var E=h.style[y]||h.currentStyle&&h.currentStyle[y];if((!E||E==="auto")&&document.defaultView){var R=document.defaultView.getComputedStyle(h,null);E=R?R[y]:null}return E==="auto"?null:E}function he(h,y,E){var R=document.createElement(h);return R.className=y||"",E&&E.appendChild(R),R}function Ne(h){var y=h.parentNode;y&&y.removeChild(h)}function ws(h){for(;h.firstChild;)h.removeChild(h.firstChild)}function xr(h){var y=h.parentNode;y&&y.lastChild!==h&&y.appendChild(h)}function wn(h){var y=h.parentNode;y&&y.firstChild!==h&&y.insertBefore(h,y.firstChild)}function bs(h,y){if(h.classList!==void 0)return h.classList.contains(y);var E=Vr(h);return E.length>0&&new RegExp("(^|\\s)"+y+"(\\s|$)").test(E)}function Qt(h,y){if(h.classList!==void 0)for(var E=w(y),R=0,H=E.length;R<H;R++)h.classList.add(E[R]);else if(!bs(h,y)){var nt=Vr(h);ii(h,(nt?nt+" ":"")+y)}}function xe(h,y){h.classList!==void 0?h.classList.remove(y):ii(h,_((" "+Vr(h)+" ").replace(" "+y+" "," ")))}function ii(h,y){h.className.baseVal===void 0?h.className=y:h.className.baseVal=y}function Vr(h){return h.correspondingElement&&(h=h.correspondingElement),h.className.baseVal===void 0?h.className:h.className.baseVal}function Ve(h,y){"opacity"in h.style?h.style.opacity=y:"filter"in h.style&&iu(h,y)}function iu(h,y){var E=!1,R="DXImageTransform.Microsoft.Alpha";try{E=h.filters.item(R)}catch{if(y===1)return}y=Math.round(y*100),E?(E.Enabled=y!==100,E.Opacity=y):h.style.filter+=" progid:"+R+"(opacity="+y+")"}function Es(h){for(var y=document.documentElement.style,E=0;E<h.length;E++)if(h[E]in y)return h[E];return!1}function sn(h,y,E){var R=y||new Y(0,0);h.style[ho]=(Zt.ie3d?"translate("+R.x+"px,"+R.y+"px)":"translate3d("+R.x+"px,"+R.y+"px,0)")+(E?" scale("+E+")":"")}function qe(h,y){h._leaflet_pos=y,Zt.any3d?sn(h,y):(h.style.left=y.x+"px",h.style.top=y.y+"px")}function Ni(h){return h._leaflet_pos||new Y(0,0)}var yi,wr,co;if("onselectstart"in document)yi=function(){te(window,"selectstart",Be)},wr=function(){Le(window,"selectstart",Be)};else{var tr=Es(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);yi=function(){if(tr){var h=document.documentElement.style;co=h[tr],h[tr]="none"}},wr=function(){tr&&(document.documentElement.style[tr]=co,co=void 0)}}function qr(){te(window,"dragstart",Be)}function br(){Le(window,"dragstart",Be)}var _e,_i;function Oi(h){for(;h.tabIndex===-1;)h=h.parentNode;h.style&&(Er(),_e=h,_i=h.style.outlineStyle,h.style.outlineStyle="none",te(window,"keydown",Er))}function Er(){_e&&(_e.style.outlineStyle=_i,_e=void 0,_i=void 0,Le(window,"keydown",Er))}function Cn(h){do h=h.parentNode;while((!h.offsetWidth||!h.offsetHeight)&&h!==document.body);return h}function kn(h){var y=h.getBoundingClientRect();return{x:y.width/h.offsetWidth||1,y:y.height/h.offsetHeight||1,boundingClientRect:y}}var ks={__proto__:null,TRANSFORM:ho,TRANSITION:xn,TRANSITION_END:Qi,get:Bn,getStyle:ni,create:he,remove:Ne,empty:ws,toFront:xr,toBack:wn,hasClass:bs,addClass:Qt,removeClass:xe,setClass:ii,getClass:Vr,setOpacity:Ve,testProp:Es,setTransform:sn,setPosition:qe,getPosition:Ni,get disableTextSelection(){return yi},get enableTextSelection(){return wr},disableImageDrag:qr,enableImageDrag:br,preventOutline:Oi,restoreOutline:Er,getSizedParentNode:Cn,getScale:kn};function te(h,y,E,R){if(y&&typeof y=="object")for(var H in y)Ms(h,H,y[H],E);else{y=w(y);for(var nt=0,pt=y.length;nt<pt;nt++)Ms(h,y[nt],E,R)}return this}var ri="_leaflet_events";function Le(h,y,E,R){if(arguments.length===1)Zr(h),delete h[ri];else if(y&&typeof y=="object")for(var H in y)de(h,H,y[H],E);else if(y=w(y),arguments.length===2)Zr(h,function(vt){return A(y,vt)!==-1});else for(var nt=0,pt=y.length;nt<pt;nt++)de(h,y[nt],E,R);return this}function Zr(h,y){for(var E in h[ri]){var R=E.split(/\d/)[0];(!y||y(R))&&de(h,R,null,null,E)}}var Hr={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function Ms(h,y,E,R){var H=y+f(E)+(R?"_"+f(R):"");if(h[ri]&&h[ri][H])return this;var nt=function(vt){return E.call(R||h,vt||window.event)},pt=nt;!Zt.touchNative&&Zt.pointer&&y.indexOf("touch")===0?nt=Ki(h,y,nt):Zt.touch&&y==="dblclick"?nt=lo(h,nt):"addEventListener"in h?y==="touchstart"||y==="touchmove"||y==="wheel"||y==="mousewheel"?h.addEventListener(Hr[y]||y,nt,Zt.passiveEvents?{passive:!1}:!1):y==="mouseenter"||y==="mouseleave"?(nt=function(vt){vt=vt||window.event,Ss(h,vt)&&pt(vt)},h.addEventListener(Hr[y],nt,!1)):h.addEventListener(y,pt,!1):h.attachEvent("on"+y,nt),h[ri]=h[ri]||{},h[ri][H]=nt}function de(h,y,E,R,H){H=H||y+f(E)+(R?"_"+f(R):"");var nt=h[ri]&&h[ri][H];if(!nt)return this;!Zt.touchNative&&Zt.pointer&&y.indexOf("touch")===0?uo(h,y,nt):Zt.touch&&y==="dblclick"?Wo(h,nt):"removeEventListener"in h?h.removeEventListener(Hr[y]||y,nt,!1):h.detachEvent("on"+y,nt),h[ri][H]=null}function un(h){return h.stopPropagation?h.stopPropagation():h.originalEvent?h.originalEvent._stopped=!0:h.cancelBubble=!0,this}function Yr(h){return Ms(h,"wheel",un),this}function er(h){return te(h,"mousedown touchstart dblclick contextmenu",un),h._leaflet_disable_click=!0,this}function Be(h){return h.preventDefault?h.preventDefault():h.returnValue=!1,this}function vi(h){return Be(h),un(h),this}function ln(h){if(h.composedPath)return h.composedPath();for(var y=[],E=h.target;E;)y.push(E),E=E.parentNode;return y}function fo(h,y){if(!y)return new Y(h.clientX,h.clientY);var E=kn(y),R=E.boundingClientRect;return new Y((h.clientX-R.left)/E.x-y.clientLeft,(h.clientY-R.top)/E.y-y.clientTop)}var Ls=Zt.linux&&Zt.chrome?window.devicePixelRatio:Zt.mac?window.devicePixelRatio*3:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function po(h){return Zt.edge?h.wheelDeltaY/2:h.deltaY&&h.deltaMode===0?-h.deltaY/Ls:h.deltaY&&h.deltaMode===1?-h.deltaY*20:h.deltaY&&h.deltaMode===2?-h.deltaY*60:h.deltaX||h.deltaZ?0:h.wheelDelta?(h.wheelDeltaY||h.wheelDelta)/2:h.detail&&Math.abs(h.detail)<32765?-h.detail*20:h.detail?h.detail/-32765*60:0}function Ss(h,y){var E=y.relatedTarget;if(!E)return!0;try{for(;E&&E!==h;)E=E.parentNode}catch{return!1}return E!==h}var ru={__proto__:null,on:te,off:Le,stopPropagation:un,disableScrollPropagation:Yr,disableClickPropagation:er,preventDefault:Be,stop:vi,getPropagationPath:ln,getMousePosition:fo,getWheelDelta:po,isExternalTarget:Ss,addListener:te,removeListener:Le},go=X.extend({run:function(h,y,E,R){this.stop(),this._el=h,this._inProgress=!0,this._duration=E||.25,this._easeOutPower=1/Math.max(R||.5,.2),this._startPos=Ni(h),this._offset=y.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=V(this._animate,this),this._step()},_step:function(h){var y=+new Date-this._startTime,E=this._duration*1e3;y<E?this._runFrame(this._easeOut(y/E),h):(this._runFrame(1),this._complete())},_runFrame:function(h,y){var E=this._startPos.add(this._offset.multiplyBy(h));y&&E._round(),qe(this._el,E),this.fire("step")},_complete:function(){z(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(h){return 1-Math.pow(1-h,this._easeOutPower)}}),ee=X.extend({options:{crs:wt,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(h,y){y=b(this,y),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(h),this._initLayout(),this._onResize=a(this._onResize,this),this._initEvents(),y.maxBounds&&this.setMaxBounds(y.maxBounds),y.zoom!==void 0&&(this._zoom=this._limitZoom(y.zoom)),y.center&&y.zoom!==void 0&&this.setView(mt(y.center),y.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=xn&&Zt.any3d&&!Zt.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),te(this._proxy,Qi,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(h,y,E){if(y=y===void 0?this._zoom:this._limitZoom(y),h=this._limitCenter(mt(h),y,this.options.maxBounds),E=E||{},this._stop(),this._loaded&&!E.reset&&E!==!0){E.animate!==void 0&&(E.zoom=n({animate:E.animate},E.zoom),E.pan=n({animate:E.animate,duration:E.duration},E.pan));var R=this._zoom!==y?this._tryAnimatedZoom&&this._tryAnimatedZoom(h,y,E.zoom):this._tryAnimatedPan(h,E.pan);if(R)return clearTimeout(this._sizeTimer),this}return this._resetView(h,y,E.pan&&E.pan.noMoveStart),this},setZoom:function(h,y){return this._loaded?this.setView(this.getCenter(),h,{zoom:y}):(this._zoom=h,this)},zoomIn:function(h,y){return h=h||(Zt.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+h,y)},zoomOut:function(h,y){return h=h||(Zt.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-h,y)},setZoomAround:function(h,y,E){var R=this.getZoomScale(y),H=this.getSize().divideBy(2),nt=h instanceof Y?h:this.latLngToContainerPoint(h),pt=nt.subtract(H).multiplyBy(1-1/R),vt=this.containerPointToLatLng(H.add(pt));return this.setView(vt,y,{zoom:E})},_getBoundsCenterZoom:function(h,y){y=y||{},h=h.getBounds?h.getBounds():lt(h);var E=J(y.paddingTopLeft||y.padding||[0,0]),R=J(y.paddingBottomRight||y.padding||[0,0]),H=this.getBoundsZoom(h,!1,E.add(R));if(H=typeof y.maxZoom=="number"?Math.min(y.maxZoom,H):H,H===1/0)return{center:h.getCenter(),zoom:H};var nt=R.subtract(E).divideBy(2),pt=this.project(h.getSouthWest(),H),vt=this.project(h.getNorthEast(),H),bt=this.unproject(pt.add(vt).divideBy(2).add(nt),H);return{center:bt,zoom:H}},fitBounds:function(h,y){if(h=lt(h),!h.isValid())throw new Error("Bounds are not valid.");var E=this._getBoundsCenterZoom(h,y);return this.setView(E.center,E.zoom,y)},fitWorld:function(h){return this.fitBounds([[-90,-180],[90,180]],h)},panTo:function(h,y){return this.setView(h,this._zoom,{pan:y})},panBy:function(h,y){if(h=J(h).round(),y=y||{},!h.x&&!h.y)return this.fire("moveend");if(y.animate!==!0&&!this.getSize().contains(h))return this._resetView(this.unproject(this.project(this.getCenter()).add(h)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new go,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),y.noMoveStart||this.fire("movestart"),y.animate!==!1){Qt(this._mapPane,"leaflet-pan-anim");var E=this._getMapPanePos().subtract(h).round();this._panAnim.run(this._mapPane,E,y.duration||.25,y.easeLinearity)}else this._rawPanBy(h),this.fire("move").fire("moveend");return this},flyTo:function(h,y,E){if(E=E||{},E.animate===!1||!Zt.any3d)return this.setView(h,y,E);this._stop();var R=this.project(this.getCenter()),H=this.project(h),nt=this.getSize(),pt=this._zoom;h=mt(h),y=y===void 0?pt:y;var vt=Math.max(nt.x,nt.y),bt=vt*this.getZoomScale(pt,y),Nt=H.distanceTo(R)||1,Gt=1.42,Kt=Gt*Gt;function ce(gn){var xl=gn?-1:1,h0=gn?bt:vt,c0=bt*bt-vt*vt+xl*Kt*Kt*Nt*Nt,f0=2*h0*Kt*Nt,dc=c0/f0,up=Math.sqrt(dc*dc+1)-dc,d0=up<1e-9?-18:Math.log(up);return d0}function jn(gn){return(Math.exp(gn)-Math.exp(-gn))/2}function Sn(gn){return(Math.exp(gn)+Math.exp(-gn))/2}function Ui(gn){return jn(gn)/Sn(gn)}var ai=ce(0);function oa(gn){return vt*(Sn(ai)/Sn(ai+Gt*gn))}function o0(gn){return vt*(Sn(ai)*Ui(ai+Gt*gn)-jn(ai))/Kt}function a0(gn){return 1-Math.pow(1-gn,1.5)}var u0=Date.now(),op=(ce(1)-ai)/Gt,l0=E.duration?1e3*E.duration:1e3*op*.8;function ap(){var gn=(Date.now()-u0)/l0,xl=a0(gn)*op;gn<=1?(this._flyToFrame=V(ap,this),this._move(this.unproject(R.add(H.subtract(R).multiplyBy(o0(xl)/Nt)),pt),this.getScaleZoom(vt/oa(xl),pt),{flyTo:!0})):this._move(h,y)._moveEnd(!0)}return this._moveStart(!0,E.noMoveStart),ap.call(this),this},flyToBounds:function(h,y){var E=this._getBoundsCenterZoom(h,y);return this.flyTo(E.center,E.zoom,y)},setMaxBounds:function(h){return h=lt(h),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),h.isValid()?(this.options.maxBounds=h,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(h){var y=this.options.minZoom;return this.options.minZoom=h,this._loaded&&y!==h&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(h):this},setMaxZoom:function(h){var y=this.options.maxZoom;return this.options.maxZoom=h,this._loaded&&y!==h&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(h):this},panInsideBounds:function(h,y){this._enforcingBounds=!0;var E=this.getCenter(),R=this._limitCenter(E,this._zoom,lt(h));return E.equals(R)||this.panTo(R,y),this._enforcingBounds=!1,this},panInside:function(h,y){y=y||{};var E=J(y.paddingTopLeft||y.padding||[0,0]),R=J(y.paddingBottomRight||y.padding||[0,0]),H=this.project(this.getCenter()),nt=this.project(h),pt=this.getPixelBounds(),vt=et([pt.min.add(E),pt.max.subtract(R)]),bt=vt.getSize();if(!vt.contains(nt)){this._enforcingBounds=!0;var Nt=nt.subtract(vt.getCenter()),Gt=vt.extend(nt).getSize().subtract(bt);H.x+=Nt.x<0?-Gt.x:Gt.x,H.y+=Nt.y<0?-Gt.y:Gt.y,this.panTo(this.unproject(H),y),this._enforcingBounds=!1}return this},invalidateSize:function(h){if(!this._loaded)return this;h=n({animate:!1,pan:!0},h===!0?{animate:!0}:h);var y=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var E=this.getSize(),R=y.divideBy(2).round(),H=E.divideBy(2).round(),nt=R.subtract(H);return!nt.x&&!nt.y?this:(h.animate&&h.pan?this.panBy(nt):(h.pan&&this._rawPanBy(nt),this.fire("move"),h.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(a(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:y,newSize:E}))},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(h){if(h=this._locateOptions=n({timeout:1e4,watch:!1},h),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var y=a(this._handleGeolocationResponse,this),E=a(this._handleGeolocationError,this);return h.watch?this._locationWatchId=navigator.geolocation.watchPosition(y,E,h):navigator.geolocation.getCurrentPosition(y,E,h),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(h){if(this._container._leaflet_id){var y=h.code,E=h.message||(y===1?"permission denied":y===2?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:y,message:"Geolocation error: "+E+"."})}},_handleGeolocationResponse:function(h){if(this._container._leaflet_id){var y=h.coords.latitude,E=h.coords.longitude,R=new ut(y,E),H=R.toBounds(h.coords.accuracy*2),nt=this._locateOptions;if(nt.setView){var pt=this.getBoundsZoom(H);this.setView(R,nt.maxZoom?Math.min(pt,nt.maxZoom):pt)}var vt={latlng:R,bounds:H,timestamp:h.timestamp};for(var bt in h.coords)typeof h.coords[bt]=="number"&&(vt[bt]=h.coords[bt]);this.fire("locationfound",vt)}},addHandler:function(h,y){if(!y)return this;var E=this[h]=new y(this);return this._handlers.push(E),this.options[h]&&E.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch{this._container._leaflet_id=void 0,this._containerId=void 0}this._locationWatchId!==void 0&&this.stopLocate(),this._stop(),Ne(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(z(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload");var h;for(h in this._layers)this._layers[h].remove();for(h in this._panes)Ne(this._panes[h]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(h,y){var E="leaflet-pane"+(h?" leaflet-"+h.replace("Pane","")+"-pane":""),R=he("div",E,y||this._mapPane);return h&&(this._panes[h]=R),R},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var h=this.getPixelBounds(),y=this.unproject(h.getBottomLeft()),E=this.unproject(h.getTopRight());return new ft(y,E)},getMinZoom:function(){return this.options.minZoom===void 0?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===void 0?this._layersMaxZoom===void 0?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(h,y,E){h=lt(h),E=J(E||[0,0]);var R=this.getZoom()||0,H=this.getMinZoom(),nt=this.getMaxZoom(),pt=h.getNorthWest(),vt=h.getSouthEast(),bt=this.getSize().subtract(E),Nt=et(this.project(vt,R),this.project(pt,R)).getSize(),Gt=Zt.any3d?this.options.zoomSnap:1,Kt=bt.x/Nt.x,ce=bt.y/Nt.y,jn=y?Math.max(Kt,ce):Math.min(Kt,ce);return R=this.getScaleZoom(jn,R),Gt&&(R=Math.round(R/(Gt/100))*(Gt/100),R=y?Math.ceil(R/Gt)*Gt:Math.floor(R/Gt)*Gt),Math.max(H,Math.min(nt,R))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new Y(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(h,y){var E=this._getTopLeftPoint(h,y);return new K(E,E.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(h){return this.options.crs.getProjectedBounds(h===void 0?this.getZoom():h)},getPane:function(h){return typeof h=="string"?this._panes[h]:h},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(h,y){var E=this.options.crs;return y=y===void 0?this._zoom:y,E.scale(h)/E.scale(y)},getScaleZoom:function(h,y){var E=this.options.crs;y=y===void 0?this._zoom:y;var R=E.zoom(h*E.scale(y));return isNaN(R)?1/0:R},project:function(h,y){return y=y===void 0?this._zoom:y,this.options.crs.latLngToPoint(mt(h),y)},unproject:function(h,y){return y=y===void 0?this._zoom:y,this.options.crs.pointToLatLng(J(h),y)},layerPointToLatLng:function(h){var y=J(h).add(this.getPixelOrigin());return this.unproject(y)},latLngToLayerPoint:function(h){var y=this.project(mt(h))._round();return y._subtract(this.getPixelOrigin())},wrapLatLng:function(h){return this.options.crs.wrapLatLng(mt(h))},wrapLatLngBounds:function(h){return this.options.crs.wrapLatLngBounds(lt(h))},distance:function(h,y){return this.options.crs.distance(mt(h),mt(y))},containerPointToLayerPoint:function(h){return J(h).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(h){return J(h).add(this._getMapPanePos())},containerPointToLatLng:function(h){var y=this.containerPointToLayerPoint(J(h));return this.layerPointToLatLng(y)},latLngToContainerPoint:function(h){return this.layerPointToContainerPoint(this.latLngToLayerPoint(mt(h)))},mouseEventToContainerPoint:function(h){return fo(h,this._container)},mouseEventToLayerPoint:function(h){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(h))},mouseEventToLatLng:function(h){return this.layerPointToLatLng(this.mouseEventToLayerPoint(h))},_initContainer:function(h){var y=this._container=Bn(h);if(y){if(y._leaflet_id)throw new Error("Map container is already initialized.")}else throw new Error("Map container not found.");te(y,"scroll",this._onScroll,this),this._containerId=f(y)},_initLayout:function(){var h=this._container;this._fadeAnimated=this.options.fadeAnimation&&Zt.any3d,Qt(h,"leaflet-container"+(Zt.touch?" leaflet-touch":"")+(Zt.retina?" leaflet-retina":"")+(Zt.ielt9?" leaflet-oldie":"")+(Zt.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var y=ni(h,"position");y!=="absolute"&&y!=="relative"&&y!=="fixed"&&y!=="sticky"&&(h.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var h=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),qe(this._mapPane,new Y(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(Qt(h.markerPane,"leaflet-zoom-hide"),Qt(h.shadowPane,"leaflet-zoom-hide"))},_resetView:function(h,y,E){qe(this._mapPane,new Y(0,0));var R=!this._loaded;this._loaded=!0,y=this._limitZoom(y),this.fire("viewprereset");var H=this._zoom!==y;this._moveStart(H,E)._move(h,y)._moveEnd(H),this.fire("viewreset"),R&&this.fire("load")},_moveStart:function(h,y){return h&&this.fire("zoomstart"),y||this.fire("movestart"),this},_move:function(h,y,E,R){y===void 0&&(y=this._zoom);var H=this._zoom!==y;return this._zoom=y,this._lastCenter=h,this._pixelOrigin=this._getNewPixelOrigin(h),R?E&&E.pinch&&this.fire("zoom",E):((H||E&&E.pinch)&&this.fire("zoom",E),this.fire("move",E)),this},_moveEnd:function(h){return h&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return z(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(h){qe(this._mapPane,this._getMapPanePos().subtract(h))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(h){this._targets={},this._targets[f(this._container)]=this;var y=h?Le:te;y(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&y(window,"resize",this._onResize,this),Zt.any3d&&this.options.transform3DLimit&&(h?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){z(this._resizeRequest),this._resizeRequest=V(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var h=this._getMapPanePos();Math.max(Math.abs(h.x),Math.abs(h.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(h,y){for(var E=[],R,H=y==="mouseout"||y==="mouseover",nt=h.target||h.srcElement,pt=!1;nt;){if(R=this._targets[f(nt)],R&&(y==="click"||y==="preclick")&&this._draggableMoved(R)){pt=!0;break}if(R&&R.listens(y,!0)&&(H&&!Ss(nt,h)||(E.push(R),H))||nt===this._container)break;nt=nt.parentNode}return!E.length&&!pt&&!H&&this.listens(y,!0)&&(E=[this]),E},_isClickDisabled:function(h){for(;h&&h!==this._container;){if(h._leaflet_disable_click)return!0;h=h.parentNode}},_handleDOMEvent:function(h){var y=h.target||h.srcElement;if(!(!this._loaded||y._leaflet_disable_events||h.type==="click"&&this._isClickDisabled(y))){var E=h.type;E==="mousedown"&&Oi(y),this._fireDOMEvent(h,E)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(h,y,E){if(h.type==="click"){var R=n({},h);R.type="preclick",this._fireDOMEvent(R,R.type,E)}var H=this._findEventTargets(h,y);if(E){for(var nt=[],pt=0;pt<E.length;pt++)E[pt].listens(y,!0)&&nt.push(E[pt]);H=nt.concat(H)}if(H.length){y==="contextmenu"&&Be(h);var vt=H[0],bt={originalEvent:h};if(h.type!=="keypress"&&h.type!=="keydown"&&h.type!=="keyup"){var Nt=vt.getLatLng&&(!vt._radius||vt._radius<=10);bt.containerPoint=Nt?this.latLngToContainerPoint(vt.getLatLng()):this.mouseEventToContainerPoint(h),bt.layerPoint=this.containerPointToLayerPoint(bt.containerPoint),bt.latlng=Nt?vt.getLatLng():this.layerPointToLatLng(bt.layerPoint)}for(pt=0;pt<H.length;pt++)if(H[pt].fire(y,bt,!0),bt.originalEvent._stopped||H[pt].options.bubblingMouseEvents===!1&&A(this._mouseEvents,y)!==-1)return}},_draggableMoved:function(h){return h=h.dragging&&h.dragging.enabled()?h:this,h.dragging&&h.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var h=0,y=this._handlers.length;h<y;h++)this._handlers[h].disable()},whenReady:function(h,y){return this._loaded?h.call(y||this,{target:this}):this.on("load",h,y),this},_getMapPanePos:function(){return Ni(this._mapPane)||new Y(0,0)},_moved:function(){var h=this._getMapPanePos();return h&&!h.equals([0,0])},_getTopLeftPoint:function(h,y){var E=h&&y!==void 0?this._getNewPixelOrigin(h,y):this.getPixelOrigin();return E.subtract(this._getMapPanePos())},_getNewPixelOrigin:function(h,y){var E=this.getSize()._divideBy(2);return this.project(h,y)._subtract(E)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(h,y,E){var R=this._getNewPixelOrigin(E,y);return this.project(h,y)._subtract(R)},_latLngBoundsToNewLayerBounds:function(h,y,E){var R=this._getNewPixelOrigin(E,y);return et([this.project(h.getSouthWest(),y)._subtract(R),this.project(h.getNorthWest(),y)._subtract(R),this.project(h.getSouthEast(),y)._subtract(R),this.project(h.getNorthEast(),y)._subtract(R)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(h){return this.latLngToLayerPoint(h).subtract(this._getCenterLayerPoint())},_limitCenter:function(h,y,E){if(!E)return h;var R=this.project(h,y),H=this.getSize().divideBy(2),nt=new K(R.subtract(H),R.add(H)),pt=this._getBoundsOffset(nt,E,y);return Math.abs(pt.x)<=1&&Math.abs(pt.y)<=1?h:this.unproject(R.add(pt),y)},_limitOffset:function(h,y){if(!y)return h;var E=this.getPixelBounds(),R=new K(E.min.add(h),E.max.add(h));return h.add(this._getBoundsOffset(R,y))},_getBoundsOffset:function(h,y,E){var R=et(this.project(y.getNorthEast(),E),this.project(y.getSouthWest(),E)),H=R.min.subtract(h.min),nt=R.max.subtract(h.max),pt=this._rebound(H.x,-nt.x),vt=this._rebound(H.y,-nt.y);return new Y(pt,vt)},_rebound:function(h,y){return h+y>0?Math.round(h-y)/2:Math.max(0,Math.ceil(h))-Math.max(0,Math.floor(y))},_limitZoom:function(h){var y=this.getMinZoom(),E=this.getMaxZoom(),R=Zt.any3d?this.options.zoomSnap:1;return R&&(h=Math.round(h/R)*R),Math.max(y,Math.min(E,h))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){xe(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(h,y){var E=this._getCenterOffset(h)._trunc();return(y&&y.animate)!==!0&&!this.getSize().contains(E)?!1:(this.panBy(E,y),!0)},_createAnimProxy:function(){var h=this._proxy=he("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(h),this.on("zoomanim",function(y){var E=ho,R=this._proxy.style[E];sn(this._proxy,this.project(y.center,y.zoom),this.getZoomScale(y.zoom,1)),R===this._proxy.style[E]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){Ne(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var h=this.getCenter(),y=this.getZoom();sn(this._proxy,this.project(h,y),this.getZoomScale(y,1))},_catchTransitionEnd:function(h){this._animatingZoom&&h.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(h,y,E){if(this._animatingZoom)return!0;if(E=E||{},!this._zoomAnimated||E.animate===!1||this._nothingToAnimate()||Math.abs(y-this._zoom)>this.options.zoomAnimationThreshold)return!1;var R=this.getZoomScale(y),H=this._getCenterOffset(h)._divideBy(1-1/R);return E.animate!==!0&&!this.getSize().contains(H)?!1:(V(function(){this._moveStart(!0,E.noMoveStart||!1)._animateZoom(h,y,!0)},this),!0)},_animateZoom:function(h,y,E,R){this._mapPane&&(E&&(this._animatingZoom=!0,this._animateToCenter=h,this._animateToZoom=y,Qt(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:h,zoom:y,noUpdate:R}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(a(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&xe(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});function Ts(h,y){return new ee(h,y)}var An=T.extend({options:{position:"topright"},initialize:function(h){b(this,h)},getPosition:function(){return this.options.position},setPosition:function(h){var y=this._map;return y&&y.removeControl(this),this.options.position=h,y&&y.addControl(this),this},getContainer:function(){return this._container},addTo:function(h){this.remove(),this._map=h;var y=this._container=this.onAdd(h),E=this.getPosition(),R=h._controlCorners[E];return Qt(y,"leaflet-control"),E.indexOf("bottom")!==-1?R.insertBefore(y,R.firstChild):R.appendChild(y),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(Ne(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(h){this._map&&h&&h.screenX>0&&h.screenY>0&&this._map.getContainer().focus()}}),hn=function(h){return new An(h)};ee.include({addControl:function(h){return h.addTo(this),this},removeControl:function(h){return h.remove(),this},_initControlPos:function(){var h=this._controlCorners={},y="leaflet-",E=this._controlContainer=he("div",y+"control-container",this._container);function R(H,nt){var pt=y+H+" "+y+nt;h[H+nt]=he("div",pt,E)}R("top","left"),R("top","right"),R("bottom","left"),R("bottom","right")},_clearControlPos:function(){for(var h in this._controlCorners)Ne(this._controlCorners[h]);Ne(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var nr=An.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(h,y,E,R){return E<R?-1:R<E?1:0}},initialize:function(h,y,E){b(this,E),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._preventClick=!1;for(var R in h)this._addLayer(h[R],R);for(R in y)this._addLayer(y[R],R,!0)},onAdd:function(h){this._initLayout(),this._update(),this._map=h,h.on("zoomend",this._checkDisabledLayers,this);for(var y=0;y<this._layers.length;y++)this._layers[y].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(h){return An.prototype.addTo.call(this,h),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var h=0;h<this._layers.length;h++)this._layers[h].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(h,y){return this._addLayer(h,y),this._map?this._update():this},addOverlay:function(h,y){return this._addLayer(h,y,!0),this._map?this._update():this},removeLayer:function(h){h.off("add remove",this._onLayerChange,this);var y=this._getLayer(f(h));return y&&this._layers.splice(this._layers.indexOf(y),1),this._map?this._update():this},expand:function(){Qt(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var h=this._map.getSize().y-(this._container.offsetTop+50);return h<this._section.clientHeight?(Qt(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=h+"px"):xe(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return xe(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var h="leaflet-control-layers",y=this._container=he("div",h),E=this.options.collapsed;y.setAttribute("aria-haspopup",!0),er(y),Yr(y);var R=this._section=he("section",h+"-list");E&&(this._map.on("click",this.collapse,this),te(y,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var H=this._layersLink=he("a",h+"-toggle",y);H.href="#",H.title="Layers",H.setAttribute("role","button"),te(H,{keydown:function(nt){nt.keyCode===13&&this._expandSafely()},click:function(nt){Be(nt),this._expandSafely()}},this),E||this.expand(),this._baseLayersList=he("div",h+"-base",R),this._separator=he("div",h+"-separator",R),this._overlaysList=he("div",h+"-overlays",R),y.appendChild(R)},_getLayer:function(h){for(var y=0;y<this._layers.length;y++)if(this._layers[y]&&f(this._layers[y].layer)===h)return this._layers[y]},_addLayer:function(h,y,E){this._map&&h.on("add remove",this._onLayerChange,this),this._layers.push({layer:h,name:y,overlay:E}),this.options.sortLayers&&this._layers.sort(a(function(R,H){return this.options.sortFunction(R.layer,H.layer,R.name,H.name)},this)),this.options.autoZIndex&&h.setZIndex&&(this._lastZIndex++,h.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;ws(this._baseLayersList),ws(this._overlaysList),this._layerControlInputs=[];var h,y,E,R,H=0;for(E=0;E<this._layers.length;E++)R=this._layers[E],this._addItem(R),y=y||R.overlay,h=h||!R.overlay,H+=R.overlay?0:1;return this.options.hideSingleBase&&(h=h&&H>1,this._baseLayersList.style.display=h?"":"none"),this._separator.style.display=y&&h?"":"none",this},_onLayerChange:function(h){this._handlingClick||this._update();var y=this._getLayer(f(h.target)),E=y.overlay?h.type==="add"?"overlayadd":"overlayremove":h.type==="add"?"baselayerchange":null;E&&this._map.fire(E,y)},_createRadioElement:function(h,y){var E='<input type="radio" class="leaflet-control-layers-selector" name="'+h+'"'+(y?' checked="checked"':"")+"/>",R=document.createElement("div");return R.innerHTML=E,R.firstChild},_addItem:function(h){var y=document.createElement("label"),E=this._map.hasLayer(h.layer),R;h.overlay?(R=document.createElement("input"),R.type="checkbox",R.className="leaflet-control-layers-selector",R.defaultChecked=E):R=this._createRadioElement("leaflet-base-layers_"+f(this),E),this._layerControlInputs.push(R),R.layerId=f(h.layer),te(R,"click",this._onInputClick,this);var H=document.createElement("span");H.innerHTML=" "+h.name;var nt=document.createElement("span");y.appendChild(nt),nt.appendChild(R),nt.appendChild(H);var pt=h.overlay?this._overlaysList:this._baseLayersList;return pt.appendChild(y),this._checkDisabledLayers(),y},_onInputClick:function(){if(!this._preventClick){var h=this._layerControlInputs,y,E,R=[],H=[];this._handlingClick=!0;for(var nt=h.length-1;nt>=0;nt--)y=h[nt],E=this._getLayer(y.layerId).layer,y.checked?R.push(E):y.checked||H.push(E);for(nt=0;nt<H.length;nt++)this._map.hasLayer(H[nt])&&this._map.removeLayer(H[nt]);for(nt=0;nt<R.length;nt++)this._map.hasLayer(R[nt])||this._map.addLayer(R[nt]);this._handlingClick=!1,this._refocusOnMap()}},_checkDisabledLayers:function(){for(var h=this._layerControlInputs,y,E,R=this._map.getZoom(),H=h.length-1;H>=0;H--)y=h[H],E=this._getLayer(y.layerId).layer,y.disabled=E.options.minZoom!==void 0&&R<E.options.minZoom||E.options.maxZoom!==void 0&&R>E.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var h=this._section;this._preventClick=!0,te(h,"click",Be),this.expand();var y=this;setTimeout(function(){Le(h,"click",Be),y._preventClick=!1})}}),su=function(h,y,E){return new nr(h,y,E)},Ri=An.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(h){var y="leaflet-control-zoom",E=he("div",y+" leaflet-bar"),R=this.options;return this._zoomInButton=this._createButton(R.zoomInText,R.zoomInTitle,y+"-in",E,this._zoomIn),this._zoomOutButton=this._createButton(R.zoomOutText,R.zoomOutTitle,y+"-out",E,this._zoomOut),this._updateDisabled(),h.on("zoomend zoomlevelschange",this._updateDisabled,this),E},onRemove:function(h){h.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(h){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(h.shiftKey?3:1))},_zoomOut:function(h){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(h.shiftKey?3:1))},_createButton:function(h,y,E,R,H){var nt=he("a",E,R);return nt.innerHTML=h,nt.href="#",nt.title=y,nt.setAttribute("role","button"),nt.setAttribute("aria-label",y),er(nt),te(nt,"click",vi),te(nt,"click",H,this),te(nt,"click",this._refocusOnMap,this),nt},_updateDisabled:function(){var h=this._map,y="leaflet-disabled";xe(this._zoomInButton,y),xe(this._zoomOutButton,y),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||h._zoom===h.getMinZoom())&&(Qt(this._zoomOutButton,y),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||h._zoom===h.getMaxZoom())&&(Qt(this._zoomInButton,y),this._zoomInButton.setAttribute("aria-disabled","true"))}});ee.mergeOptions({zoomControl:!0}),ee.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new Ri,this.addControl(this.zoomControl))});var $o=function(h){return new Ri(h)},ir=An.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(h){var y="leaflet-control-scale",E=he("div",y),R=this.options;return this._addScales(R,y+"-line",E),h.on(R.updateWhenIdle?"moveend":"move",this._update,this),h.whenReady(this._update,this),E},onRemove:function(h){h.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(h,y,E){h.metric&&(this._mScale=he("div",y,E)),h.imperial&&(this._iScale=he("div",y,E))},_update:function(){var h=this._map,y=h.getSize().y/2,E=h.distance(h.containerPointToLatLng([0,y]),h.containerPointToLatLng([this.options.maxWidth,y]));this._updateScales(E)},_updateScales:function(h){this.options.metric&&h&&this._updateMetric(h),this.options.imperial&&h&&this._updateImperial(h)},_updateMetric:function(h){var y=this._getRoundNum(h),E=y<1e3?y+" m":y/1e3+" km";this._updateScale(this._mScale,E,y/h)},_updateImperial:function(h){var y=h*3.2808399,E,R,H;y>5280?(E=y/5280,R=this._getRoundNum(E),this._updateScale(this._iScale,R+" mi",R/E)):(H=this._getRoundNum(y),this._updateScale(this._iScale,H+" ft",H/y))},_updateScale:function(h,y,E){h.style.width=Math.round(this.options.maxWidth*E)+"px",h.innerHTML=y},_getRoundNum:function(h){var y=Math.pow(10,(Math.floor(h)+"").length-1),E=h/y;return E=E>=10?10:E>=5?5:E>=3?3:E>=2?2:1,y*E}}),Jo=function(h){return new ir(h)},Fn='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg>',Ps=An.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(Zt.inlineSvg?Fn+" ":"")+"Leaflet</a>"},initialize:function(h){b(this,h),this._attributions={}},onAdd:function(h){h.attributionControl=this,this._container=he("div","leaflet-control-attribution"),er(this._container);for(var y in h._layers)h._layers[y].getAttribution&&this.addAttribution(h._layers[y].getAttribution());return this._update(),h.on("layeradd",this._addAttribution,this),this._container},onRemove:function(h){h.off("layeradd",this._addAttribution,this)},_addAttribution:function(h){h.layer.getAttribution&&(this.addAttribution(h.layer.getAttribution()),h.layer.once("remove",function(){this.removeAttribution(h.layer.getAttribution())},this))},setPrefix:function(h){return this.options.prefix=h,this._update(),this},addAttribution:function(h){return h?(this._attributions[h]||(this._attributions[h]=0),this._attributions[h]++,this._update(),this):this},removeAttribution:function(h){return h?(this._attributions[h]&&(this._attributions[h]--,this._update()),this):this},_update:function(){if(this._map){var h=[];for(var y in this._attributions)this._attributions[y]&&h.push(y);var E=[];this.options.prefix&&E.push(this.options.prefix),h.length&&E.push(h.join(", ")),this._container.innerHTML=E.join(' <span aria-hidden="true">|</span> ')}}});ee.mergeOptions({attributionControl:!0}),ee.addInitHook(function(){this.options.attributionControl&&new Ps().addTo(this)});var ou=function(h){return new Ps(h)};An.Layers=nr,An.Zoom=Ri,An.Scale=ir,An.Attribution=Ps,hn.layers=su,hn.zoom=$o,hn.scale=Jo,hn.attribution=ou;var si=T.extend({initialize:function(h){this._map=h},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});si.addTo=function(h,y){return h.addHandler(y,this),this};var au={Events:F},mo=Zt.touch?"touchstart mousedown":"mousedown",Di=X.extend({options:{clickTolerance:3},initialize:function(h,y,E,R){b(this,R),this._element=h,this._dragStartTarget=y||h,this._preventOutline=E},enable:function(){this._enabled||(te(this._dragStartTarget,mo,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(Di._dragging===this&&this.finishDrag(!0),Le(this._dragStartTarget,mo,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(h){if(this._enabled&&(this._moved=!1,!bs(this._element,"leaflet-zoom-anim"))){if(h.touches&&h.touches.length!==1){Di._dragging===this&&this.finishDrag();return}if(!(Di._dragging||h.shiftKey||h.which!==1&&h.button!==1&&!h.touches)&&(Di._dragging=this,this._preventOutline&&Oi(this._element),qr(),yi(),!this._moving)){this.fire("down");var y=h.touches?h.touches[0]:h,E=Cn(this._element);this._startPoint=new Y(y.clientX,y.clientY),this._startPos=Ni(this._element),this._parentScale=kn(E);var R=h.type==="mousedown";te(document,R?"mousemove":"touchmove",this._onMove,this),te(document,R?"mouseup":"touchend touchcancel",this._onUp,this)}}},_onMove:function(h){if(this._enabled){if(h.touches&&h.touches.length>1){this._moved=!0;return}var y=h.touches&&h.touches.length===1?h.touches[0]:h,E=new Y(y.clientX,y.clientY)._subtract(this._startPoint);!E.x&&!E.y||Math.abs(E.x)+Math.abs(E.y)<this.options.clickTolerance||(E.x/=this._parentScale.x,E.y/=this._parentScale.y,Be(h),this._moved||(this.fire("dragstart"),this._moved=!0,Qt(document.body,"leaflet-dragging"),this._lastTarget=h.target||h.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),Qt(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(E),this._moving=!0,this._lastEvent=h,this._updatePosition())}},_updatePosition:function(){var h={originalEvent:this._lastEvent};this.fire("predrag",h),qe(this._element,this._newPos),this.fire("drag",h)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(h){xe(document.body,"leaflet-dragging"),this._lastTarget&&(xe(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),Le(document,"mousemove touchmove",this._onMove,this),Le(document,"mouseup touchend touchcancel",this._onUp,this),br(),wr();var y=this._moved&&this._moving;this._moving=!1,Di._dragging=!1,y&&this.fire("dragend",{noInertia:h,distance:this._newPos.distanceTo(this._startPos)})}});function jo(h,y,E){var R,H=[1,4,2,8],nt,pt,vt,bt,Nt,Gt,Kt,ce;for(nt=0,Gt=h.length;nt<Gt;nt++)h[nt]._code=Ye(h[nt],y);for(vt=0;vt<4;vt++){for(Kt=H[vt],R=[],nt=0,Gt=h.length,pt=Gt-1;nt<Gt;pt=nt++)bt=h[nt],Nt=h[pt],bt._code&Kt?Nt._code&Kt||(ce=rr(Nt,bt,Kt,y,E),ce._code=Ye(ce,y),R.push(ce)):(Nt._code&Kt&&(ce=rr(Nt,bt,Kt,y,E),ce._code=Ye(ce,y),R.push(ce)),R.push(bt));h=R}return h}function Ko(h,y){var E,R,H,nt,pt,vt,bt,Nt,Gt;if(!h||h.length===0)throw new Error("latlngs not passed");Nn(h)||(console.warn("latlngs are not flat! Only the first ring will be used"),h=h[0]);var Kt=mt([0,0]),ce=lt(h),jn=ce.getNorthWest().distanceTo(ce.getSouthWest())*ce.getNorthEast().distanceTo(ce.getNorthWest());jn<1700&&(Kt=xi(h));var Sn=h.length,Ui=[];for(E=0;E<Sn;E++){var ai=mt(h[E]);Ui.push(y.project(mt([ai.lat-Kt.lat,ai.lng-Kt.lng])))}for(vt=bt=Nt=0,E=0,R=Sn-1;E<Sn;R=E++)H=Ui[E],nt=Ui[R],pt=H.y*nt.x-nt.y*H.x,bt+=(H.x+nt.x)*pt,Nt+=(H.y+nt.y)*pt,vt+=pt*3;vt===0?Gt=Ui[0]:Gt=[bt/vt,Nt/vt];var oa=y.unproject(J(Gt));return mt([oa.lat+Kt.lat,oa.lng+Kt.lng])}function xi(h){for(var y=0,E=0,R=0,H=0;H<h.length;H++){var nt=mt(h[H]);y+=nt.lat,E+=nt.lng,R++}return mt([y/R,E/R])}var cn={__proto__:null,clipPolygon:jo,polygonCenter:Ko,centroid:xi};function Qo(h,y){if(!y||!h.length)return h.slice();var E=y*y;return h=yo(h,E),h=Un(h,E),h}function zi(h,y,E){return Math.sqrt(Xr(h,y,E,!0))}function ta(h,y,E){return Xr(h,y,E)}function Un(h,y){var E=h.length,R=typeof Uint8Array<"u"?Uint8Array:Array,H=new R(E);H[0]=H[E-1]=1,Is(h,H,y,0,E-1);var nt,pt=[];for(nt=0;nt<E;nt++)H[nt]&&pt.push(h[nt]);return pt}function Is(h,y,E,R,H){var nt=0,pt,vt,bt;for(vt=R+1;vt<=H-1;vt++)bt=Xr(h[vt],h[R],h[H],!0),bt>nt&&(pt=vt,nt=bt);nt>E&&(y[pt]=1,Is(h,y,E,R,pt),Is(h,y,E,pt,H))}function yo(h,y){for(var E=[h[0]],R=1,H=0,nt=h.length;R<nt;R++)Bi(h[R],h[H])>y&&(E.push(h[R]),H=R);return H<nt-1&&E.push(h[nt-1]),E}var _o;function Gn(h,y,E,R,H){var nt=R?_o:Ye(h,E),pt=Ye(y,E),vt,bt,Nt;for(_o=pt;;){if(!(nt|pt))return[h,y];if(nt&pt)return!1;vt=nt||pt,bt=rr(h,y,vt,E,H),Nt=Ye(bt,E),vt===nt?(h=bt,nt=Nt):(y=bt,pt=Nt)}}function rr(h,y,E,R,H){var nt=y.x-h.x,pt=y.y-h.y,vt=R.min,bt=R.max,Nt,Gt;return E&8?(Nt=h.x+nt*(bt.y-h.y)/pt,Gt=bt.y):E&4?(Nt=h.x+nt*(vt.y-h.y)/pt,Gt=vt.y):E&2?(Nt=bt.x,Gt=h.y+pt*(bt.x-h.x)/nt):E&1&&(Nt=vt.x,Gt=h.y+pt*(vt.x-h.x)/nt),new Y(Nt,Gt,H)}function Ye(h,y){var E=0;return h.x<y.min.x?E|=1:h.x>y.max.x&&(E|=2),h.y<y.min.y?E|=4:h.y>y.max.y&&(E|=8),E}function Bi(h,y){var E=y.x-h.x,R=y.y-h.y;return E*E+R*R}function Xr(h,y,E,R){var H=y.x,nt=y.y,pt=E.x-H,vt=E.y-nt,bt=pt*pt+vt*vt,Nt;return bt>0&&(Nt=((h.x-H)*pt+(h.y-nt)*vt)/bt,Nt>1?(H=E.x,nt=E.y):Nt>0&&(H+=pt*Nt,nt+=vt*Nt)),pt=h.x-H,vt=h.y-nt,R?pt*pt+vt*vt:new Y(H,nt)}function Nn(h){return!C(h[0])||typeof h[0][0]!="object"&&typeof h[0][0]<"u"}function kr(h){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),Nn(h)}function Cs(h,y){var E,R,H,nt,pt,vt,bt,Nt;if(!h||h.length===0)throw new Error("latlngs not passed");Nn(h)||(console.warn("latlngs are not flat! Only the first ring will be used"),h=h[0]);var Gt=mt([0,0]),Kt=lt(h),ce=Kt.getNorthWest().distanceTo(Kt.getSouthWest())*Kt.getNorthEast().distanceTo(Kt.getNorthWest());ce<1700&&(Gt=xi(h));var jn=h.length,Sn=[];for(E=0;E<jn;E++){var Ui=mt(h[E]);Sn.push(y.project(mt([Ui.lat-Gt.lat,Ui.lng-Gt.lng])))}for(E=0,R=0;E<jn-1;E++)R+=Sn[E].distanceTo(Sn[E+1])/2;if(R===0)Nt=Sn[0];else for(E=0,nt=0;E<jn-1;E++)if(pt=Sn[E],vt=Sn[E+1],H=pt.distanceTo(vt),nt+=H,nt>R){bt=(nt-R)/H,Nt=[vt.x-bt*(vt.x-pt.x),vt.y-bt*(vt.y-pt.y)];break}var ai=y.unproject(J(Nt));return mt([ai.lat+Gt.lat,ai.lng+Gt.lng])}var As={__proto__:null,simplify:Qo,pointToSegmentDistance:zi,closestPointOnSegment:ta,clipSegment:Gn,_getEdgeIntersection:rr,_getBitCode:Ye,_sqClosestPointOnSegment:Xr,isFlat:Nn,_flat:kr,polylineCenter:Cs},vo={project:function(h){return new Y(h.lng,h.lat)},unproject:function(h){return new ut(h.y,h.x)},bounds:new K([-180,-90],[180,90])},xo={R:6378137,R_MINOR:6356752314245179e-9,bounds:new K([-2003750834279e-5,-1549657073972e-5],[2003750834279e-5,1876465623138e-5]),project:function(h){var y=Math.PI/180,E=this.R,R=h.lat*y,H=this.R_MINOR/E,nt=Math.sqrt(1-H*H),pt=nt*Math.sin(R),vt=Math.tan(Math.PI/4-R/2)/Math.pow((1-pt)/(1+pt),nt/2);return R=-E*Math.log(Math.max(vt,1e-10)),new Y(h.lng*y*E,R)},unproject:function(h){for(var y=180/Math.PI,E=this.R,R=this.R_MINOR/E,H=Math.sqrt(1-R*R),nt=Math.exp(-h.y/E),pt=Math.PI/2-2*Math.atan(nt),vt=0,bt=.1,Nt;vt<15&&Math.abs(bt)>1e-7;vt++)Nt=H*Math.sin(pt),Nt=Math.pow((1-Nt)/(1+Nt),H/2),bt=Math.PI/2-2*Math.atan(nt*Nt)-pt,pt+=bt;return new ut(pt*y,h.x*y/E)}},Ns={__proto__:null,LonLat:vo,Mercator:xo,SphericalMercator:xt},sr=n({},at,{code:"EPSG:3395",projection:xo,transformation:function(){var h=.5/(Math.PI*xo.R);return tt(h,.5,-h,.5)}()}),ea=n({},at,{code:"EPSG:4326",projection:vo,transformation:tt(1/180,1,-1/180,.5)}),na=n({},Et,{projection:vo,transformation:tt(1,0,-1,0),scale:function(h){return Math.pow(2,h)},zoom:function(h){return Math.log(h)/Math.LN2},distance:function(h,y){var E=y.lng-h.lng,R=y.lat-h.lat;return Math.sqrt(E*E+R*R)},infinite:!0});Et.Earth=at,Et.EPSG3395=sr,Et.EPSG3857=wt,Et.EPSG900913=G,Et.EPSG4326=ea,Et.Simple=na;var Mn=X.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(h){return h.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(h){return h&&h.removeLayer(this),this},getPane:function(h){return this._map.getPane(h?this.options[h]||h:this.options.pane)},addInteractiveTarget:function(h){return this._map._targets[f(h)]=this,this},removeInteractiveTarget:function(h){return delete this._map._targets[f(h)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(h){var y=h.target;if(y.hasLayer(this)){if(this._map=y,this._zoomAnimated=y._zoomAnimated,this.getEvents){var E=this.getEvents();y.on(E,this),this.once("remove",function(){y.off(E,this)},this)}this.onAdd(y),this.fire("add"),y.fire("layeradd",{layer:this})}}});ee.include({addLayer:function(h){if(!h._layerAdd)throw new Error("The provided object is not a Layer.");var y=f(h);return this._layers[y]?this:(this._layers[y]=h,h._mapToAdd=this,h.beforeAdd&&h.beforeAdd(this),this.whenReady(h._layerAdd,h),this)},removeLayer:function(h){var y=f(h);return this._layers[y]?(this._loaded&&h.onRemove(this),delete this._layers[y],this._loaded&&(this.fire("layerremove",{layer:h}),h.fire("remove")),h._map=h._mapToAdd=null,this):this},hasLayer:function(h){return f(h)in this._layers},eachLayer:function(h,y){for(var E in this._layers)h.call(y,this._layers[E]);return this},_addLayers:function(h){h=h?C(h)?h:[h]:[];for(var y=0,E=h.length;y<E;y++)this.addLayer(h[y])},_addZoomLimit:function(h){(!isNaN(h.options.maxZoom)||!isNaN(h.options.minZoom))&&(this._zoomBoundLayers[f(h)]=h,this._updateZoomLevels())},_removeZoomLimit:function(h){var y=f(h);this._zoomBoundLayers[y]&&(delete this._zoomBoundLayers[y],this._updateZoomLevels())},_updateZoomLevels:function(){var h=1/0,y=-1/0,E=this._getZoomSpan();for(var R in this._zoomBoundLayers){var H=this._zoomBoundLayers[R].options;h=H.minZoom===void 0?h:Math.min(h,H.minZoom),y=H.maxZoom===void 0?y:Math.max(y,H.maxZoom)}this._layersMaxZoom=y===-1/0?void 0:y,this._layersMinZoom=h===1/0?void 0:h,E!==this._getZoomSpan()&&this.fire("zoomlevelschange"),this.options.maxZoom===void 0&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),this.options.minZoom===void 0&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var Mr=Mn.extend({initialize:function(h,y){b(this,y),this._layers={};var E,R;if(h)for(E=0,R=h.length;E<R;E++)this.addLayer(h[E])},addLayer:function(h){var y=this.getLayerId(h);return this._layers[y]=h,this._map&&this._map.addLayer(h),this},removeLayer:function(h){var y=h in this._layers?h:this.getLayerId(h);return this._map&&this._layers[y]&&this._map.removeLayer(this._layers[y]),delete this._layers[y],this},hasLayer:function(h){var y=typeof h=="number"?h:this.getLayerId(h);return y in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(h){var y=Array.prototype.slice.call(arguments,1),E,R;for(E in this._layers)R=this._layers[E],R[h]&&R[h].apply(R,y);return this},onAdd:function(h){this.eachLayer(h.addLayer,h)},onRemove:function(h){this.eachLayer(h.removeLayer,h)},eachLayer:function(h,y){for(var E in this._layers)h.call(y,this._layers[E]);return this},getLayer:function(h){return this._layers[h]},getLayers:function(){var h=[];return this.eachLayer(h.push,h),h},setZIndex:function(h){return this.invoke("setZIndex",h)},getLayerId:function(h){return f(h)}}),or=function(h,y){return new Mr(h,y)},Ln=Mr.extend({addLayer:function(h){return this.hasLayer(h)?this:(h.addEventParent(this),Mr.prototype.addLayer.call(this,h),this.fire("layeradd",{layer:h}))},removeLayer:function(h){return this.hasLayer(h)?(h in this._layers&&(h=this._layers[h]),h.removeEventParent(this),Mr.prototype.removeLayer.call(this,h),this.fire("layerremove",{layer:h})):this},setStyle:function(h){return this.invoke("setStyle",h)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var h=new ft;for(var y in this._layers){var E=this._layers[y];h.extend(E.getBounds?E.getBounds():E.getLatLng())}return h}}),fn=function(h,y){return new Ln(h,y)},Vn=T.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(h){b(this,h)},createIcon:function(h){return this._createIcon("icon",h)},createShadow:function(h){return this._createIcon("shadow",h)},_createIcon:function(h,y){var E=this._getIconUrl(h);if(!E){if(h==="icon")throw new Error("iconUrl not set in Icon options (see the docs).");return null}var R=this._createImg(E,y&&y.tagName==="IMG"?y:null);return this._setIconStyles(R,h),(this.options.crossOrigin||this.options.crossOrigin==="")&&(R.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),R},_setIconStyles:function(h,y){var E=this.options,R=E[y+"Size"];typeof R=="number"&&(R=[R,R]);var H=J(R),nt=J(y==="shadow"&&E.shadowAnchor||E.iconAnchor||H&&H.divideBy(2,!0));h.className="leaflet-marker-"+y+" "+(E.className||""),nt&&(h.style.marginLeft=-nt.x+"px",h.style.marginTop=-nt.y+"px"),H&&(h.style.width=H.x+"px",h.style.height=H.y+"px")},_createImg:function(h,y){return y=y||document.createElement("img"),y.src=h,y},_getIconUrl:function(h){return Zt.retina&&this.options[h+"RetinaUrl"]||this.options[h+"Url"]}});function wo(h){return new Vn(h)}var ar=Vn.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(h){return typeof ar.imagePath!="string"&&(ar.imagePath=this._detectIconPath()),(this.options.imagePath||ar.imagePath)+Vn.prototype._getIconUrl.call(this,h)},_stripUrl:function(h){var y=function(E,R,H){var nt=R.exec(E);return nt&&nt[H]};return h=y(h,/^url\((['"])?(.+)\1\)$/,2),h&&y(h,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var h=he("div","leaflet-default-icon-path",document.body),y=ni(h,"background-image")||ni(h,"backgroundImage");if(document.body.removeChild(h),y=this._stripUrl(y),y)return y;var E=document.querySelector('link[href$="leaflet.css"]');return E?E.href.substring(0,E.href.length-11-1):""}}),ia=si.extend({initialize:function(h){this._marker=h},addHooks:function(){var h=this._marker._icon;this._draggable||(this._draggable=new Di(h,h,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),Qt(h,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&xe(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(h){var y=this._marker,E=y._map,R=this._marker.options.autoPanSpeed,H=this._marker.options.autoPanPadding,nt=Ni(y._icon),pt=E.getPixelBounds(),vt=E.getPixelOrigin(),bt=et(pt.min._subtract(vt).add(H),pt.max._subtract(vt).subtract(H));if(!bt.contains(nt)){var Nt=J((Math.max(bt.max.x,nt.x)-bt.max.x)/(pt.max.x-bt.max.x)-(Math.min(bt.min.x,nt.x)-bt.min.x)/(pt.min.x-bt.min.x),(Math.max(bt.max.y,nt.y)-bt.max.y)/(pt.max.y-bt.max.y)-(Math.min(bt.min.y,nt.y)-bt.min.y)/(pt.min.y-bt.min.y)).multiplyBy(R);E.panBy(Nt,{animate:!1}),this._draggable._newPos._add(Nt),this._draggable._startPos._add(Nt),qe(y._icon,this._draggable._newPos),this._onDrag(h),this._panRequest=V(this._adjustPan.bind(this,h))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(h){this._marker.options.autoPan&&(z(this._panRequest),this._panRequest=V(this._adjustPan.bind(this,h)))},_onDrag:function(h){var y=this._marker,E=y._shadow,R=Ni(y._icon),H=y._map.layerPointToLatLng(R);E&&qe(E,R),y._latlng=H,h.latlng=H,h.oldLatLng=this._oldLatLng,y.fire("move",h).fire("drag",h)},_onDragEnd:function(h){z(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",h)}}),ur=Mn.extend({options:{icon:new ar,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(h,y){b(this,y),this._latlng=mt(h)},onAdd:function(h){this._zoomAnimated=this._zoomAnimated&&h.options.markerZoomAnimation,this._zoomAnimated&&h.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(h){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&h.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(h){var y=this._latlng;return this._latlng=mt(h),this.update(),this.fire("move",{oldLatLng:y,latlng:this._latlng})},setZIndexOffset:function(h){return this.options.zIndexOffset=h,this.update()},getIcon:function(){return this.options.icon},setIcon:function(h){return this.options.icon=h,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var h=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(h)}return this},_initIcon:function(){var h=this.options,y="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),E=h.icon.createIcon(this._icon),R=!1;E!==this._icon&&(this._icon&&this._removeIcon(),R=!0,h.title&&(E.title=h.title),E.tagName==="IMG"&&(E.alt=h.alt||"")),Qt(E,y),h.keyboard&&(E.tabIndex="0",E.setAttribute("role","button")),this._icon=E,h.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&te(E,"focus",this._panOnFocus,this);var H=h.icon.createShadow(this._shadow),nt=!1;H!==this._shadow&&(this._removeShadow(),nt=!0),H&&(Qt(H,y),H.alt=""),this._shadow=H,h.opacity<1&&this._updateOpacity(),R&&this.getPane().appendChild(this._icon),this._initInteraction(),H&&nt&&this.getPane(h.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&Le(this._icon,"focus",this._panOnFocus,this),Ne(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&Ne(this._shadow),this._shadow=null},_setPos:function(h){this._icon&&qe(this._icon,h),this._shadow&&qe(this._shadow,h),this._zIndex=h.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(h){this._icon&&(this._icon.style.zIndex=this._zIndex+h)},_animateZoom:function(h){var y=this._map._latLngToNewLayerPoint(this._latlng,h.zoom,h.center).round();this._setPos(y)},_initInteraction:function(){if(this.options.interactive&&(Qt(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),ia)){var h=this.options.draggable;this.dragging&&(h=this.dragging.enabled(),this.dragging.disable()),this.dragging=new ia(this),h&&this.dragging.enable()}},setOpacity:function(h){return this.options.opacity=h,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var h=this.options.opacity;this._icon&&Ve(this._icon,h),this._shadow&&Ve(this._shadow,h)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var h=this._map;if(h){var y=this.options.icon.options,E=y.iconSize?J(y.iconSize):J(0,0),R=y.iconAnchor?J(y.iconAnchor):J(0,0);h.panInside(this._latlng,{paddingTopLeft:R,paddingBottomRight:E.subtract(R)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function Os(h,y){return new ur(h,y)}var Ke=Mn.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(h){this._renderer=h.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(h){return b(this,h),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&h&&Object.prototype.hasOwnProperty.call(h,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),oi=Ke.extend({options:{fill:!0,radius:10},initialize:function(h,y){b(this,y),this._latlng=mt(h),this._radius=this.options.radius},setLatLng:function(h){var y=this._latlng;return this._latlng=mt(h),this.redraw(),this.fire("move",{oldLatLng:y,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(h){return this.options.radius=this._radius=h,this.redraw()},getRadius:function(){return this._radius},setStyle:function(h){var y=h&&h.radius||this._radius;return Ke.prototype.setStyle.call(this,h),this.setRadius(y),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var h=this._radius,y=this._radiusY||h,E=this._clickTolerance(),R=[h+E,y+E];this._pxBounds=new K(this._point.subtract(R),this._point.add(R))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(h){return h.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function bo(h,y){return new oi(h,y)}var lr=oi.extend({initialize:function(h,y,E){if(typeof y=="number"&&(y=n({},E,{radius:y})),b(this,y),this._latlng=mt(h),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(h){return this._mRadius=h,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var h=[this._radius,this._radiusY||this._radius];return new ft(this._map.layerPointToLatLng(this._point.subtract(h)),this._map.layerPointToLatLng(this._point.add(h)))},setStyle:Ke.prototype.setStyle,_project:function(){var h=this._latlng.lng,y=this._latlng.lat,E=this._map,R=E.options.crs;if(R.distance===at.distance){var H=Math.PI/180,nt=this._mRadius/at.R/H,pt=E.project([y+nt,h]),vt=E.project([y-nt,h]),bt=pt.add(vt).divideBy(2),Nt=E.unproject(bt).lat,Gt=Math.acos((Math.cos(nt*H)-Math.sin(y*H)*Math.sin(Nt*H))/(Math.cos(y*H)*Math.cos(Nt*H)))/H;(isNaN(Gt)||Gt===0)&&(Gt=nt/Math.cos(Math.PI/180*y)),this._point=bt.subtract(E.getPixelOrigin()),this._radius=isNaN(Gt)?0:bt.x-E.project([Nt,h-Gt]).x,this._radiusY=bt.y-pt.y}else{var Kt=R.unproject(R.project(this._latlng).subtract([this._mRadius,0]));this._point=E.latLngToLayerPoint(this._latlng),this._radius=this._point.x-E.latLngToLayerPoint(Kt).x}this._updateBounds()}});function Rs(h,y,E){return new lr(h,y,E)}var Jn=Ke.extend({options:{smoothFactor:1,noClip:!1},initialize:function(h,y){b(this,y),this._setLatLngs(h)},getLatLngs:function(){return this._latlngs},setLatLngs:function(h){return this._setLatLngs(h),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(h){for(var y=1/0,E=null,R=Xr,H,nt,pt=0,vt=this._parts.length;pt<vt;pt++)for(var bt=this._parts[pt],Nt=1,Gt=bt.length;Nt<Gt;Nt++){H=bt[Nt-1],nt=bt[Nt];var Kt=R(h,H,nt,!0);Kt<y&&(y=Kt,E=R(h,H,nt))}return E&&(E.distance=Math.sqrt(y)),E},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return Cs(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(h,y){return y=y||this._defaultShape(),h=mt(h),y.push(h),this._bounds.extend(h),this.redraw()},_setLatLngs:function(h){this._bounds=new ft,this._latlngs=this._convertLatLngs(h)},_defaultShape:function(){return Nn(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(h){for(var y=[],E=Nn(h),R=0,H=h.length;R<H;R++)E?(y[R]=mt(h[R]),this._bounds.extend(y[R])):y[R]=this._convertLatLngs(h[R]);return y},_project:function(){var h=new K;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,h),this._bounds.isValid()&&h.isValid()&&(this._rawPxBounds=h,this._updateBounds())},_updateBounds:function(){var h=this._clickTolerance(),y=new Y(h,h);this._rawPxBounds&&(this._pxBounds=new K([this._rawPxBounds.min.subtract(y),this._rawPxBounds.max.add(y)]))},_projectLatlngs:function(h,y,E){var R=h[0]instanceof ut,H=h.length,nt,pt;if(R){for(pt=[],nt=0;nt<H;nt++)pt[nt]=this._map.latLngToLayerPoint(h[nt]),E.extend(pt[nt]);y.push(pt)}else for(nt=0;nt<H;nt++)this._projectLatlngs(h[nt],y,E)},_clipPoints:function(){var h=this._renderer._bounds;if(this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(h))){if(this.options.noClip){this._parts=this._rings;return}var y=this._parts,E,R,H,nt,pt,vt,bt;for(E=0,H=0,nt=this._rings.length;E<nt;E++)for(bt=this._rings[E],R=0,pt=bt.length;R<pt-1;R++)vt=Gn(bt[R],bt[R+1],h,R,!0),vt&&(y[H]=y[H]||[],y[H].push(vt[0]),(vt[1]!==bt[R+1]||R===pt-2)&&(y[H].push(vt[1]),H++))}},_simplifyPoints:function(){for(var h=this._parts,y=this.options.smoothFactor,E=0,R=h.length;E<R;E++)h[E]=Qo(h[E],y)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(h,y){var E,R,H,nt,pt,vt,bt=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(h))return!1;for(E=0,nt=this._parts.length;E<nt;E++)for(vt=this._parts[E],R=0,pt=vt.length,H=pt-1;R<pt;H=R++)if(!(!y&&R===0)&&zi(h,vt[H],vt[R])<=bt)return!0;return!1}});function Ds(h,y){return new Jn(h,y)}Jn._flat=kr;var hr=Jn.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return Ko(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(h){var y=Jn.prototype._convertLatLngs.call(this,h),E=y.length;return E>=2&&y[0]instanceof ut&&y[0].equals(y[E-1])&&y.pop(),y},_setLatLngs:function(h){Jn.prototype._setLatLngs.call(this,h),Nn(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return Nn(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var h=this._renderer._bounds,y=this.options.weight,E=new Y(y,y);if(h=new K(h.min.subtract(E),h.max.add(E)),this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(h))){if(this.options.noClip){this._parts=this._rings;return}for(var R=0,H=this._rings.length,nt;R<H;R++)nt=jo(this._rings[R],h,!0),nt.length&&this._parts.push(nt)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(h){var y=!1,E,R,H,nt,pt,vt,bt,Nt;if(!this._pxBounds||!this._pxBounds.contains(h))return!1;for(nt=0,bt=this._parts.length;nt<bt;nt++)for(E=this._parts[nt],pt=0,Nt=E.length,vt=Nt-1;pt<Nt;vt=pt++)R=E[pt],H=E[vt],R.y>h.y!=H.y>h.y&&h.x<(H.x-R.x)*(h.y-R.y)/(H.y-R.y)+R.x&&(y=!y);return y||Jn.prototype._containsPoint.call(this,h,!0)}});function Eo(h,y){return new hr(h,y)}var on=Ln.extend({initialize:function(h,y){b(this,y),this._layers={},h&&this.addData(h)},addData:function(h){var y=C(h)?h:h.features,E,R,H;if(y){for(E=0,R=y.length;E<R;E++)H=y[E],(H.geometries||H.geometry||H.features||H.coordinates)&&this.addData(H);return this}var nt=this.options;if(nt.filter&&!nt.filter(h))return this;var pt=Wr(h,nt);return pt?(pt.feature=c(h),pt.defaultOptions=pt.options,this.resetStyle(pt),nt.onEachFeature&&nt.onEachFeature(h,pt),this.addLayer(pt)):this},resetStyle:function(h){return h===void 0?this.eachLayer(this.resetStyle,this):(h.options=n({},h.defaultOptions),this._setLayerStyle(h,this.options.style),this)},setStyle:function(h){return this.eachLayer(function(y){this._setLayerStyle(y,h)},this)},_setLayerStyle:function(h,y){h.setStyle&&(typeof y=="function"&&(y=y(h.feature)),h.setStyle(y))}});function Wr(h,y){var E=h.type==="Feature"?h.geometry:h,R=E?E.coordinates:null,H=[],nt=y&&y.pointToLayer,pt=y&&y.coordsToLatLng||wi,vt,bt,Nt,Gt;if(!R&&!E)return null;switch(E.type){case"Point":return vt=pt(R),ra(nt,h,vt,y);case"MultiPoint":for(Nt=0,Gt=R.length;Nt<Gt;Nt++)vt=pt(R[Nt]),H.push(ra(nt,h,vt,y));return new Ln(H);case"LineString":case"MultiLineString":return bt=Lr(R,E.type==="LineString"?0:1,pt),new Jn(bt,y);case"Polygon":case"MultiPolygon":return bt=Lr(R,E.type==="Polygon"?1:2,pt),new hr(bt,y);case"GeometryCollection":for(Nt=0,Gt=E.geometries.length;Nt<Gt;Nt++){var Kt=Wr({geometry:E.geometries[Nt],type:"Feature",properties:h.properties},y);Kt&&H.push(Kt)}return new Ln(H);case"FeatureCollection":for(Nt=0,Gt=E.features.length;Nt<Gt;Nt++){var ce=Wr(E.features[Nt],y);ce&&H.push(ce)}return new Ln(H);default:throw new Error("Invalid GeoJSON object.")}}function ra(h,y,E,R){return h?h(y,E):new ur(E,R&&R.markersInheritOptions&&R)}function wi(h){return new ut(h[1],h[0],h[2])}function Lr(h,y,E){for(var R=[],H=0,nt=h.length,pt;H<nt;H++)pt=y?Lr(h[H],y-1,E):(E||wi)(h[H]),R.push(pt);return R}function $r(h,y){return h=mt(h),h.alt!==void 0?[v(h.lng,y),v(h.lat,y),v(h.alt,y)]:[v(h.lng,y),v(h.lat,y)]}function dn(h,y,E,R){for(var H=[],nt=0,pt=h.length;nt<pt;nt++)H.push(y?dn(h[nt],Nn(h[nt])?0:y-1,E,R):$r(h[nt],R));return!y&&E&&H.length>0&&H.push(H[0].slice()),H}function pn(h,y){return h.feature?n({},h.feature,{geometry:y}):c(y)}function c(h){return h.type==="Feature"||h.type==="FeatureCollection"?h:{type:"Feature",properties:{},geometry:h}}var o={toGeoJSON:function(h){return pn(this,{type:"Point",coordinates:$r(this.getLatLng(),h)})}};ur.include(o),lr.include(o),oi.include(o),Jn.include({toGeoJSON:function(h){var y=!Nn(this._latlngs),E=dn(this._latlngs,y?1:0,!1,h);return pn(this,{type:(y?"Multi":"")+"LineString",coordinates:E})}}),hr.include({toGeoJSON:function(h){var y=!Nn(this._latlngs),E=y&&!Nn(this._latlngs[0]),R=dn(this._latlngs,E?2:y?1:0,!0,h);return y||(R=[R]),pn(this,{type:(E?"Multi":"")+"Polygon",coordinates:R})}}),Mr.include({toMultiPoint:function(h){var y=[];return this.eachLayer(function(E){y.push(E.toGeoJSON(h).geometry.coordinates)}),pn(this,{type:"MultiPoint",coordinates:y})},toGeoJSON:function(h){var y=this.feature&&this.feature.geometry&&this.feature.geometry.type;if(y==="MultiPoint")return this.toMultiPoint(h);var E=y==="GeometryCollection",R=[];return this.eachLayer(function(H){if(H.toGeoJSON){var nt=H.toGeoJSON(h);if(E)R.push(nt.geometry);else{var pt=c(nt);pt.type==="FeatureCollection"?R.push.apply(R,pt.features):R.push(pt)}}}),E?pn(this,{geometries:R,type:"GeometryCollection"}):{type:"FeatureCollection",features:R}}});function u(h,y){return new on(h,y)}var p=u,x=Mn.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(h,y,E){this._url=h,this._bounds=lt(y),b(this,E)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(Qt(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){Ne(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(h){return this.options.opacity=h,this._image&&this._updateOpacity(),this},setStyle:function(h){return h.opacity&&this.setOpacity(h.opacity),this},bringToFront:function(){return this._map&&xr(this._image),this},bringToBack:function(){return this._map&&wn(this._image),this},setUrl:function(h){return this._url=h,this._image&&(this._image.src=h),this},setBounds:function(h){return this._bounds=lt(h),this._map&&this._reset(),this},getEvents:function(){var h={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(h.zoomanim=this._animateZoom),h},setZIndex:function(h){return this.options.zIndex=h,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var h=this._url.tagName==="IMG",y=this._image=h?this._url:he("img");if(Qt(y,"leaflet-image-layer"),this._zoomAnimated&&Qt(y,"leaflet-zoom-animated"),this.options.className&&Qt(y,this.options.className),y.onselectstart=m,y.onmousemove=m,y.onload=a(this.fire,this,"load"),y.onerror=a(this._overlayOnError,this,"error"),(this.options.crossOrigin||this.options.crossOrigin==="")&&(y.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),h){this._url=y.src;return}y.src=this._url,y.alt=this.options.alt},_animateZoom:function(h){var y=this._map.getZoomScale(h.zoom),E=this._map._latLngBoundsToNewLayerBounds(this._bounds,h.zoom,h.center).min;sn(this._image,E,y)},_reset:function(){var h=this._image,y=new K(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),E=y.getSize();qe(h,y.min),h.style.width=E.x+"px",h.style.height=E.y+"px"},_updateOpacity:function(){Ve(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var h=this.options.errorOverlayUrl;h&&this._url!==h&&(this._url=h,this._image.src=h)},getCenter:function(){return this._bounds.getCenter()}}),M=function(h,y,E){return new x(h,y,E)},D=x.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var h=this._url.tagName==="VIDEO",y=this._image=h?this._url:he("video");if(Qt(y,"leaflet-image-layer"),this._zoomAnimated&&Qt(y,"leaflet-zoom-animated"),this.options.className&&Qt(y,this.options.className),y.onselectstart=m,y.onmousemove=m,y.onloadeddata=a(this.fire,this,"load"),h){for(var E=y.getElementsByTagName("source"),R=[],H=0;H<E.length;H++)R.push(E[H].src);this._url=E.length>0?R:[y.src];return}C(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(y.style,"objectFit")&&(y.style.objectFit="fill"),y.autoplay=!!this.options.autoplay,y.loop=!!this.options.loop,y.muted=!!this.options.muted,y.playsInline=!!this.options.playsInline;for(var nt=0;nt<this._url.length;nt++){var pt=he("source");pt.src=this._url[nt],y.appendChild(pt)}}});function Z(h,y,E){return new D(h,y,E)}var Q=x.extend({_initImage:function(){var h=this._image=this._url;Qt(h,"leaflet-image-layer"),this._zoomAnimated&&Qt(h,"leaflet-zoom-animated"),this.options.className&&Qt(h,this.options.className),h.onselectstart=m,h.onmousemove=m}});function rt(h,y,E){return new Q(h,y,E)}var dt=Mn.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(h,y){h&&(h instanceof ut||C(h))?(this._latlng=mt(h),b(this,y)):(b(this,h),this._source=y),this.options.content&&(this._content=this.options.content)},openOn:function(h){return h=arguments.length?h:this._source._map,h.hasLayer(this)||h.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(h){return this._map?this.close():(arguments.length?this._source=h:h=this._source,this._prepareOpen(),this.openOn(h._map)),this},onAdd:function(h){this._zoomAnimated=h._zoomAnimated,this._container||this._initLayout(),h._fadeAnimated&&Ve(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),h._fadeAnimated&&Ve(this._container,1),this.bringToFront(),this.options.interactive&&(Qt(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(h){h._fadeAnimated?(Ve(this._container,0),this._removeTimeout=setTimeout(a(Ne,void 0,this._container),200)):Ne(this._container),this.options.interactive&&(xe(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(h){return this._latlng=mt(h),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(h){return this._content=h,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var h={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(h.zoomanim=this._animateZoom),h},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&xr(this._container),this},bringToBack:function(){return this._map&&wn(this._container),this},_prepareOpen:function(h){var y=this._source;if(!y._map)return!1;if(y instanceof Ln){y=null;var E=this._source._layers;for(var R in E)if(E[R]._map){y=E[R];break}if(!y)return!1;this._source=y}if(!h)if(y.getCenter)h=y.getCenter();else if(y.getLatLng)h=y.getLatLng();else if(y.getBounds)h=y.getBounds().getCenter();else throw new Error("Unable to get source layer LatLng.");return this.setLatLng(h),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var h=this._contentNode,y=typeof this._content=="function"?this._content(this._source||this):this._content;if(typeof y=="string")h.innerHTML=y;else{for(;h.hasChildNodes();)h.removeChild(h.firstChild);h.appendChild(y)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var h=this._map.latLngToLayerPoint(this._latlng),y=J(this.options.offset),E=this._getAnchor();this._zoomAnimated?qe(this._container,h.add(E)):y=y.add(h).add(E);var R=this._containerBottom=-y.y,H=this._containerLeft=-Math.round(this._containerWidth/2)+y.x;this._container.style.bottom=R+"px",this._container.style.left=H+"px"}},_getAnchor:function(){return[0,0]}});ee.include({_initOverlay:function(h,y,E,R){var H=y;return H instanceof h||(H=new h(R).setContent(y)),E&&H.setLatLng(E),H}}),Mn.include({_initOverlay:function(h,y,E,R){var H=E;return H instanceof h?(b(H,R),H._source=this):(H=y&&!R?y:new h(R,this),H.setContent(E)),H}});var gt=dt.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(h){return h=arguments.length?h:this._source._map,!h.hasLayer(this)&&h._popup&&h._popup.options.autoClose&&h.removeLayer(h._popup),h._popup=this,dt.prototype.openOn.call(this,h)},onAdd:function(h){dt.prototype.onAdd.call(this,h),h.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof Ke||this._source.on("preclick",un))},onRemove:function(h){dt.prototype.onRemove.call(this,h),h.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof Ke||this._source.off("preclick",un))},getEvents:function(){var h=dt.prototype.getEvents.call(this);return(this.options.closeOnClick!==void 0?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(h.preclick=this.close),this.options.keepInView&&(h.moveend=this._adjustPan),h},_initLayout:function(){var h="leaflet-popup",y=this._container=he("div",h+" "+(this.options.className||"")+" leaflet-zoom-animated"),E=this._wrapper=he("div",h+"-content-wrapper",y);if(this._contentNode=he("div",h+"-content",E),er(y),Yr(this._contentNode),te(y,"contextmenu",un),this._tipContainer=he("div",h+"-tip-container",y),this._tip=he("div",h+"-tip",this._tipContainer),this.options.closeButton){var R=this._closeButton=he("a",h+"-close-button",y);R.setAttribute("role","button"),R.setAttribute("aria-label","Close popup"),R.href="#close",R.innerHTML='<span aria-hidden="true">&#215;</span>',te(R,"click",function(H){Be(H),this.close()},this)}},_updateLayout:function(){var h=this._contentNode,y=h.style;y.width="",y.whiteSpace="nowrap";var E=h.offsetWidth;E=Math.min(E,this.options.maxWidth),E=Math.max(E,this.options.minWidth),y.width=E+1+"px",y.whiteSpace="",y.height="";var R=h.offsetHeight,H=this.options.maxHeight,nt="leaflet-popup-scrolled";H&&R>H?(y.height=H+"px",Qt(h,nt)):xe(h,nt),this._containerWidth=this._container.offsetWidth},_animateZoom:function(h){var y=this._map._latLngToNewLayerPoint(this._latlng,h.zoom,h.center),E=this._getAnchor();qe(this._container,y.add(E))},_adjustPan:function(){if(this.options.autoPan){if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning){this._autopanning=!1;return}var h=this._map,y=parseInt(ni(this._container,"marginBottom"),10)||0,E=this._container.offsetHeight+y,R=this._containerWidth,H=new Y(this._containerLeft,-E-this._containerBottom);H._add(Ni(this._container));var nt=h.layerPointToContainerPoint(H),pt=J(this.options.autoPanPadding),vt=J(this.options.autoPanPaddingTopLeft||pt),bt=J(this.options.autoPanPaddingBottomRight||pt),Nt=h.getSize(),Gt=0,Kt=0;nt.x+R+bt.x>Nt.x&&(Gt=nt.x+R-Nt.x+bt.x),nt.x-Gt-vt.x<0&&(Gt=nt.x-vt.x),nt.y+E+bt.y>Nt.y&&(Kt=nt.y+E-Nt.y+bt.y),nt.y-Kt-vt.y<0&&(Kt=nt.y-vt.y),(Gt||Kt)&&(this.options.keepInView&&(this._autopanning=!0),h.fire("autopanstart").panBy([Gt,Kt]))}},_getAnchor:function(){return J(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),Tt=function(h,y){return new gt(h,y)};ee.mergeOptions({closePopupOnClick:!0}),ee.include({openPopup:function(h,y,E){return this._initOverlay(gt,h,y,E).openOn(this),this},closePopup:function(h){return h=arguments.length?h:this._popup,h&&h.close(),this}}),Mn.include({bindPopup:function(h,y){return this._popup=this._initOverlay(gt,this._popup,h,y),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(h){return this._popup&&(this instanceof Ln||(this._popup._source=this),this._popup._prepareOpen(h||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return this._popup?this._popup.isOpen():!1},setPopupContent:function(h){return this._popup&&this._popup.setContent(h),this},getPopup:function(){return this._popup},_openPopup:function(h){if(!(!this._popup||!this._map)){vi(h);var y=h.layer||h.target;if(this._popup._source===y&&!(y instanceof Ke)){this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(h.latlng);return}this._popup._source=y,this.openPopup(h.latlng)}},_movePopup:function(h){this._popup.setLatLng(h.latlng)},_onKeyPress:function(h){h.originalEvent.keyCode===13&&this._openPopup(h)}});var Ot=dt.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(h){dt.prototype.onAdd.call(this,h),this.setOpacity(this.options.opacity),h.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(h){dt.prototype.onRemove.call(this,h),h.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var h=dt.prototype.getEvents.call(this);return this.options.permanent||(h.preclick=this.close),h},_initLayout:function(){var h="leaflet-tooltip",y=h+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=he("div",y),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+f(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(h){var y,E,R=this._map,H=this._container,nt=R.latLngToContainerPoint(R.getCenter()),pt=R.layerPointToContainerPoint(h),vt=this.options.direction,bt=H.offsetWidth,Nt=H.offsetHeight,Gt=J(this.options.offset),Kt=this._getAnchor();vt==="top"?(y=bt/2,E=Nt):vt==="bottom"?(y=bt/2,E=0):vt==="center"?(y=bt/2,E=Nt/2):vt==="right"?(y=0,E=Nt/2):vt==="left"?(y=bt,E=Nt/2):pt.x<nt.x?(vt="right",y=0,E=Nt/2):(vt="left",y=bt+(Gt.x+Kt.x)*2,E=Nt/2),h=h.subtract(J(y,E,!0)).add(Gt).add(Kt),xe(H,"leaflet-tooltip-right"),xe(H,"leaflet-tooltip-left"),xe(H,"leaflet-tooltip-top"),xe(H,"leaflet-tooltip-bottom"),Qt(H,"leaflet-tooltip-"+vt),qe(H,h)},_updatePosition:function(){var h=this._map.latLngToLayerPoint(this._latlng);this._setPosition(h)},setOpacity:function(h){this.options.opacity=h,this._container&&Ve(this._container,h)},_animateZoom:function(h){var y=this._map._latLngToNewLayerPoint(this._latlng,h.zoom,h.center);this._setPosition(y)},_getAnchor:function(){return J(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),zt=function(h,y){return new Ot(h,y)};ee.include({openTooltip:function(h,y,E){return this._initOverlay(Ot,h,y,E).openOn(this),this},closeTooltip:function(h){return h.close(),this}}),Mn.include({bindTooltip:function(h,y){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(Ot,this._tooltip,h,y),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(h){if(!(!h&&this._tooltipHandlersAdded)){var y=h?"off":"on",E={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?E.add=this._openTooltip:(E.mouseover=this._openTooltip,E.mouseout=this.closeTooltip,E.click=this._openTooltip,this._map?this._addFocusListeners():E.add=this._addFocusListeners),this._tooltip.options.sticky&&(E.mousemove=this._moveTooltip),this[y](E),this._tooltipHandlersAdded=!h}},openTooltip:function(h){return this._tooltip&&(this instanceof Ln||(this._tooltip._source=this),this._tooltip._prepareOpen(h)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(h){return this._tooltip&&this._tooltip.setContent(h),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(h){var y=typeof h.getElement=="function"&&h.getElement();y&&(te(y,"focus",function(){this._tooltip._source=h,this.openTooltip()},this),te(y,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(h){var y=typeof h.getElement=="function"&&h.getElement();y&&y.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(h){if(!(!this._tooltip||!this._map)){if(this._map.dragging&&this._map.dragging.moving()&&!this._openOnceFlag){this._openOnceFlag=!0;var y=this;this._map.once("moveend",function(){y._openOnceFlag=!1,y._openTooltip(h)});return}this._tooltip._source=h.layer||h.target,this.openTooltip(this._tooltip.options.sticky?h.latlng:void 0)}},_moveTooltip:function(h){var y=h.latlng,E,R;this._tooltip.options.sticky&&h.originalEvent&&(E=this._map.mouseEventToContainerPoint(h.originalEvent),R=this._map.containerPointToLayerPoint(E),y=this._map.layerPointToLatLng(R)),this._tooltip.setLatLng(y)}});var qt=Vn.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(h){var y=h&&h.tagName==="DIV"?h:document.createElement("div"),E=this.options;if(E.html instanceof Element?(ws(y),y.appendChild(E.html)):y.innerHTML=E.html!==!1?E.html:"",E.bgPos){var R=J(E.bgPos);y.style.backgroundPosition=-R.x+"px "+-R.y+"px"}return this._setIconStyles(y,"icon"),y},createShadow:function(){return null}});function ne(h){return new qt(h)}Vn.Default=ar;var jt=Mn.extend({options:{tileSize:256,opacity:1,updateWhenIdle:Zt.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(h){b(this,h)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(h){h._addZoomLimit(this)},onRemove:function(h){this._removeAllTiles(),Ne(this._container),h._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(xr(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(wn(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(h){return this.options.opacity=h,this._updateOpacity(),this},setZIndex:function(h){return this.options.zIndex=h,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var h=this._clampZoom(this._map.getZoom());h!==this._tileZoom&&(this._tileZoom=h,this._updateLevels()),this._update()}return this},getEvents:function(){var h={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=d(this._onMoveEnd,this.options.updateInterval,this)),h.move=this._onMove),this._zoomAnimated&&(h.zoomanim=this._animateZoom),h},createTile:function(){return document.createElement("div")},getTileSize:function(){var h=this.options.tileSize;return h instanceof Y?h:new Y(h,h)},_updateZIndex:function(){this._container&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(h){for(var y=this.getPane().children,E=-h(-1/0,1/0),R=0,H=y.length,nt;R<H;R++)nt=y[R].style.zIndex,y[R]!==this._container&&nt&&(E=h(E,+nt));isFinite(E)&&(this.options.zIndex=E+h(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!Zt.ielt9){Ve(this._container,this.options.opacity);var h=+new Date,y=!1,E=!1;for(var R in this._tiles){var H=this._tiles[R];if(!(!H.current||!H.loaded)){var nt=Math.min(1,(h-H.loaded)/200);Ve(H.el,nt),nt<1?y=!0:(H.active?E=!0:this._onOpaqueTile(H),H.active=!0)}}E&&!this._noPrune&&this._pruneTiles(),y&&(z(this._fadeFrame),this._fadeFrame=V(this._updateOpacity,this))}},_onOpaqueTile:m,_initContainer:function(){this._container||(this._container=he("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var h=this._tileZoom,y=this.options.maxZoom;if(h!==void 0){for(var E in this._levels)E=Number(E),this._levels[E].el.children.length||E===h?(this._levels[E].el.style.zIndex=y-Math.abs(h-E),this._onUpdateLevel(E)):(Ne(this._levels[E].el),this._removeTilesAtZoom(E),this._onRemoveLevel(E),delete this._levels[E]);var R=this._levels[h],H=this._map;return R||(R=this._levels[h]={},R.el=he("div","leaflet-tile-container leaflet-zoom-animated",this._container),R.el.style.zIndex=y,R.origin=H.project(H.unproject(H.getPixelOrigin()),h).round(),R.zoom=h,this._setZoomTransform(R,H.getCenter(),H.getZoom()),m(R.el.offsetWidth),this._onCreateLevel(R)),this._level=R,R}},_onUpdateLevel:m,_onRemoveLevel:m,_onCreateLevel:m,_pruneTiles:function(){if(this._map){var h,y,E=this._map.getZoom();if(E>this.options.maxZoom||E<this.options.minZoom){this._removeAllTiles();return}for(h in this._tiles)y=this._tiles[h],y.retain=y.current;for(h in this._tiles)if(y=this._tiles[h],y.current&&!y.active){var R=y.coords;this._retainParent(R.x,R.y,R.z,R.z-5)||this._retainChildren(R.x,R.y,R.z,R.z+2)}for(h in this._tiles)this._tiles[h].retain||this._removeTile(h)}},_removeTilesAtZoom:function(h){for(var y in this._tiles)this._tiles[y].coords.z===h&&this._removeTile(y)},_removeAllTiles:function(){for(var h in this._tiles)this._removeTile(h)},_invalidateAll:function(){for(var h in this._levels)Ne(this._levels[h].el),this._onRemoveLevel(Number(h)),delete this._levels[h];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(h,y,E,R){var H=Math.floor(h/2),nt=Math.floor(y/2),pt=E-1,vt=new Y(+H,+nt);vt.z=+pt;var bt=this._tileCoordsToKey(vt),Nt=this._tiles[bt];return Nt&&Nt.active?(Nt.retain=!0,!0):(Nt&&Nt.loaded&&(Nt.retain=!0),pt>R?this._retainParent(H,nt,pt,R):!1)},_retainChildren:function(h,y,E,R){for(var H=2*h;H<2*h+2;H++)for(var nt=2*y;nt<2*y+2;nt++){var pt=new Y(H,nt);pt.z=E+1;var vt=this._tileCoordsToKey(pt),bt=this._tiles[vt];if(bt&&bt.active){bt.retain=!0;continue}else bt&&bt.loaded&&(bt.retain=!0);E+1<R&&this._retainChildren(H,nt,E+1,R)}},_resetView:function(h){var y=h&&(h.pinch||h.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),y,y)},_animateZoom:function(h){this._setView(h.center,h.zoom,!0,h.noUpdate)},_clampZoom:function(h){var y=this.options;return y.minNativeZoom!==void 0&&h<y.minNativeZoom?y.minNativeZoom:y.maxNativeZoom!==void 0&&y.maxNativeZoom<h?y.maxNativeZoom:h},_setView:function(h,y,E,R){var H=Math.round(y);this.options.maxZoom!==void 0&&H>this.options.maxZoom||this.options.minZoom!==void 0&&H<this.options.minZoom?H=void 0:H=this._clampZoom(H);var nt=this.options.updateWhenZooming&&H!==this._tileZoom;(!R||nt)&&(this._tileZoom=H,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),H!==void 0&&this._update(h),E||this._pruneTiles(),this._noPrune=!!E),this._setZoomTransforms(h,y)},_setZoomTransforms:function(h,y){for(var E in this._levels)this._setZoomTransform(this._levels[E],h,y)},_setZoomTransform:function(h,y,E){var R=this._map.getZoomScale(E,h.zoom),H=h.origin.multiplyBy(R).subtract(this._map._getNewPixelOrigin(y,E)).round();Zt.any3d?sn(h.el,H,R):qe(h.el,H)},_resetGrid:function(){var h=this._map,y=h.options.crs,E=this._tileSize=this.getTileSize(),R=this._tileZoom,H=this._map.getPixelWorldBounds(this._tileZoom);H&&(this._globalTileRange=this._pxBoundsToTileRange(H)),this._wrapX=y.wrapLng&&!this.options.noWrap&&[Math.floor(h.project([0,y.wrapLng[0]],R).x/E.x),Math.ceil(h.project([0,y.wrapLng[1]],R).x/E.y)],this._wrapY=y.wrapLat&&!this.options.noWrap&&[Math.floor(h.project([y.wrapLat[0],0],R).y/E.x),Math.ceil(h.project([y.wrapLat[1],0],R).y/E.y)]},_onMoveEnd:function(){!this._map||this._map._animatingZoom||this._update()},_getTiledPixelBounds:function(h){var y=this._map,E=y._animatingZoom?Math.max(y._animateToZoom,y.getZoom()):y.getZoom(),R=y.getZoomScale(E,this._tileZoom),H=y.project(h,this._tileZoom).floor(),nt=y.getSize().divideBy(R*2);return new K(H.subtract(nt),H.add(nt))},_update:function(h){var y=this._map;if(y){var E=this._clampZoom(y.getZoom());if(h===void 0&&(h=y.getCenter()),this._tileZoom!==void 0){var R=this._getTiledPixelBounds(h),H=this._pxBoundsToTileRange(R),nt=H.getCenter(),pt=[],vt=this.options.keepBuffer,bt=new K(H.getBottomLeft().subtract([vt,-vt]),H.getTopRight().add([vt,-vt]));if(!(isFinite(H.min.x)&&isFinite(H.min.y)&&isFinite(H.max.x)&&isFinite(H.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var Nt in this._tiles){var Gt=this._tiles[Nt].coords;(Gt.z!==this._tileZoom||!bt.contains(new Y(Gt.x,Gt.y)))&&(this._tiles[Nt].current=!1)}if(Math.abs(E-this._tileZoom)>1){this._setView(h,E);return}for(var Kt=H.min.y;Kt<=H.max.y;Kt++)for(var ce=H.min.x;ce<=H.max.x;ce++){var jn=new Y(ce,Kt);if(jn.z=this._tileZoom,!!this._isValidTile(jn)){var Sn=this._tiles[this._tileCoordsToKey(jn)];Sn?Sn.current=!0:pt.push(jn)}}if(pt.sort(function(ai,oa){return ai.distanceTo(nt)-oa.distanceTo(nt)}),pt.length!==0){this._loading||(this._loading=!0,this.fire("loading"));var Ui=document.createDocumentFragment();for(ce=0;ce<pt.length;ce++)this._addTile(pt[ce],Ui);this._level.el.appendChild(Ui)}}}},_isValidTile:function(h){var y=this._map.options.crs;if(!y.infinite){var E=this._globalTileRange;if(!y.wrapLng&&(h.x<E.min.x||h.x>E.max.x)||!y.wrapLat&&(h.y<E.min.y||h.y>E.max.y))return!1}if(!this.options.bounds)return!0;var R=this._tileCoordsToBounds(h);return lt(this.options.bounds).overlaps(R)},_keyToBounds:function(h){return this._tileCoordsToBounds(this._keyToTileCoords(h))},_tileCoordsToNwSe:function(h){var y=this._map,E=this.getTileSize(),R=h.scaleBy(E),H=R.add(E),nt=y.unproject(R,h.z),pt=y.unproject(H,h.z);return[nt,pt]},_tileCoordsToBounds:function(h){var y=this._tileCoordsToNwSe(h),E=new ft(y[0],y[1]);return this.options.noWrap||(E=this._map.wrapLatLngBounds(E)),E},_tileCoordsToKey:function(h){return h.x+":"+h.y+":"+h.z},_keyToTileCoords:function(h){var y=h.split(":"),E=new Y(+y[0],+y[1]);return E.z=+y[2],E},_removeTile:function(h){var y=this._tiles[h];y&&(Ne(y.el),delete this._tiles[h],this.fire("tileunload",{tile:y.el,coords:this._keyToTileCoords(h)}))},_initTile:function(h){Qt(h,"leaflet-tile");var y=this.getTileSize();h.style.width=y.x+"px",h.style.height=y.y+"px",h.onselectstart=m,h.onmousemove=m,Zt.ielt9&&this.options.opacity<1&&Ve(h,this.options.opacity)},_addTile:function(h,y){var E=this._getTilePos(h),R=this._tileCoordsToKey(h),H=this.createTile(this._wrapCoords(h),a(this._tileReady,this,h));this._initTile(H),this.createTile.length<2&&V(a(this._tileReady,this,h,null,H)),qe(H,E),this._tiles[R]={el:H,coords:h,current:!0},y.appendChild(H),this.fire("tileloadstart",{tile:H,coords:h})},_tileReady:function(h,y,E){y&&this.fire("tileerror",{error:y,tile:E,coords:h});var R=this._tileCoordsToKey(h);E=this._tiles[R],E&&(E.loaded=+new Date,this._map._fadeAnimated?(Ve(E.el,0),z(this._fadeFrame),this._fadeFrame=V(this._updateOpacity,this)):(E.active=!0,this._pruneTiles()),y||(Qt(E.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:E.el,coords:h})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),Zt.ielt9||!this._map._fadeAnimated?V(this._pruneTiles,this):setTimeout(a(this._pruneTiles,this),250)))},_getTilePos:function(h){return h.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(h){var y=new Y(this._wrapX?g(h.x,this._wrapX):h.x,this._wrapY?g(h.y,this._wrapY):h.y);return y.z=h.z,y},_pxBoundsToTileRange:function(h){var y=this.getTileSize();return new K(h.min.unscaleBy(y).floor(),h.max.unscaleBy(y).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var h in this._tiles)if(!this._tiles[h].loaded)return!1;return!0}});function Ee(h){return new jt(h)}var Pe=jt.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(h,y){this._url=h,y=b(this,y),y.detectRetina&&Zt.retina&&y.maxZoom>0?(y.tileSize=Math.floor(y.tileSize/2),y.zoomReverse?(y.zoomOffset--,y.minZoom=Math.min(y.maxZoom,y.minZoom+1)):(y.zoomOffset++,y.maxZoom=Math.max(y.minZoom,y.maxZoom-1)),y.minZoom=Math.max(0,y.minZoom)):y.zoomReverse?y.minZoom=Math.min(y.maxZoom,y.minZoom):y.maxZoom=Math.max(y.minZoom,y.maxZoom),typeof y.subdomains=="string"&&(y.subdomains=y.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(h,y){return this._url===h&&y===void 0&&(y=!0),this._url=h,y||this.redraw(),this},createTile:function(h,y){var E=document.createElement("img");return te(E,"load",a(this._tileOnLoad,this,y,E)),te(E,"error",a(this._tileOnError,this,y,E)),(this.options.crossOrigin||this.options.crossOrigin==="")&&(E.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),typeof this.options.referrerPolicy=="string"&&(E.referrerPolicy=this.options.referrerPolicy),E.alt="",E.src=this.getTileUrl(h),E},getTileUrl:function(h){var y={r:Zt.retina?"@2x":"",s:this._getSubdomain(h),x:h.x,y:h.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var E=this._globalTileRange.max.y-h.y;this.options.tms&&(y.y=E),y["-y"]=E}return k(this._url,n(y,this.options))},_tileOnLoad:function(h,y){Zt.ielt9?setTimeout(a(h,this,null,y),0):h(null,y)},_tileOnError:function(h,y,E){var R=this.options.errorTileUrl;R&&y.getAttribute("src")!==R&&(y.src=R),h(E,y)},_onTileRemove:function(h){h.tile.onload=null},_getZoomForUrl:function(){var h=this._tileZoom,y=this.options.maxZoom,E=this.options.zoomReverse,R=this.options.zoomOffset;return E&&(h=y-h),h+R},_getSubdomain:function(h){var y=Math.abs(h.x+h.y)%this.options.subdomains.length;return this.options.subdomains[y]},_abortLoading:function(){var h,y;for(h in this._tiles)if(this._tiles[h].coords.z!==this._tileZoom&&(y=this._tiles[h].el,y.onload=m,y.onerror=m,!y.complete)){y.src=P;var E=this._tiles[h].coords;Ne(y),delete this._tiles[h],this.fire("tileabort",{tile:y,coords:E})}},_removeTile:function(h){var y=this._tiles[h];if(y)return y.el.setAttribute("src",P),jt.prototype._removeTile.call(this,h)},_tileReady:function(h,y,E){if(!(!this._map||E&&E.getAttribute("src")===P))return jt.prototype._tileReady.call(this,h,y,E)}});function Ze(h,y){return new Pe(h,y)}var Sr=Pe.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(h,y){this._url=h;var E=n({},this.defaultWmsParams);for(var R in y)R in this.options||(E[R]=y[R]);y=b(this,y);var H=y.detectRetina&&Zt.retina?2:1,nt=this.getTileSize();E.width=nt.x*H,E.height=nt.y*H,this.wmsParams=E},onAdd:function(h){this._crs=this.options.crs||h.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var y=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[y]=this._crs.code,Pe.prototype.onAdd.call(this,h)},getTileUrl:function(h){var y=this._tileCoordsToNwSe(h),E=this._crs,R=et(E.project(y[0]),E.project(y[1])),H=R.min,nt=R.max,pt=(this._wmsVersion>=1.3&&this._crs===ea?[H.y,H.x,nt.y,nt.x]:[H.x,H.y,nt.x,nt.y]).join(","),vt=Pe.prototype.getTileUrl.call(this,h);return vt+S(this.wmsParams,vt,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+pt},setParams:function(h,y){return n(this.wmsParams,h),y||this.redraw(),this}});function ko(h,y){return new Sr(h,y)}Pe.WMS=Sr,Ze.wms=ko;var Fi=Mn.extend({options:{padding:.1},initialize:function(h){b(this,h),f(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),Qt(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var h={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(h.zoomanim=this._onAnimZoom),h},_onAnimZoom:function(h){this._updateTransform(h.center,h.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(h,y){var E=this._map.getZoomScale(y,this._zoom),R=this._map.getSize().multiplyBy(.5+this.options.padding),H=this._map.project(this._center,y),nt=R.multiplyBy(-E).add(H).subtract(this._map._getNewPixelOrigin(h,y));Zt.any3d?sn(this._container,nt,E):qe(this._container,nt)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var h in this._layers)this._layers[h]._reset()},_onZoomEnd:function(){for(var h in this._layers)this._layers[h]._project()},_updatePaths:function(){for(var h in this._layers)this._layers[h]._update()},_update:function(){var h=this.options.padding,y=this._map.getSize(),E=this._map.containerPointToLayerPoint(y.multiplyBy(-h)).round();this._bounds=new K(E,E.add(y.multiplyBy(1+h*2)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),uu=Fi.extend({options:{tolerance:0},getEvents:function(){var h=Fi.prototype.getEvents.call(this);return h.viewprereset=this._onViewPreReset,h},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){Fi.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var h=this._container=document.createElement("canvas");te(h,"mousemove",this._onMouseMove,this),te(h,"click dblclick mousedown mouseup contextmenu",this._onClick,this),te(h,"mouseout",this._handleMouseOut,this),h._leaflet_disable_events=!0,this._ctx=h.getContext("2d")},_destroyContainer:function(){z(this._redrawRequest),delete this._ctx,Ne(this._container),Le(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){var h;this._redrawBounds=null;for(var y in this._layers)h=this._layers[y],h._update();this._redraw()}},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){Fi.prototype._update.call(this);var h=this._bounds,y=this._container,E=h.getSize(),R=Zt.retina?2:1;qe(y,h.min),y.width=R*E.x,y.height=R*E.y,y.style.width=E.x+"px",y.style.height=E.y+"px",Zt.retina&&this._ctx.scale(2,2),this._ctx.translate(-h.min.x,-h.min.y),this.fire("update")}},_reset:function(){Fi.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(h){this._updateDashArray(h),this._layers[f(h)]=h;var y=h._order={layer:h,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=y),this._drawLast=y,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(h){this._requestRedraw(h)},_removePath:function(h){var y=h._order,E=y.next,R=y.prev;E?E.prev=R:this._drawLast=R,R?R.next=E:this._drawFirst=E,delete h._order,delete this._layers[f(h)],this._requestRedraw(h)},_updatePath:function(h){this._extendRedrawBounds(h),h._project(),h._update(),this._requestRedraw(h)},_updateStyle:function(h){this._updateDashArray(h),this._requestRedraw(h)},_updateDashArray:function(h){if(typeof h.options.dashArray=="string"){var y=h.options.dashArray.split(/[, ]+/),E=[],R,H;for(H=0;H<y.length;H++){if(R=Number(y[H]),isNaN(R))return;E.push(R)}h.options._dashArray=E}else h.options._dashArray=h.options.dashArray},_requestRedraw:function(h){this._map&&(this._extendRedrawBounds(h),this._redrawRequest=this._redrawRequest||V(this._redraw,this))},_extendRedrawBounds:function(h){if(h._pxBounds){var y=(h.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new K,this._redrawBounds.extend(h._pxBounds.min.subtract([y,y])),this._redrawBounds.extend(h._pxBounds.max.add([y,y]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var h=this._redrawBounds;if(h){var y=h.getSize();this._ctx.clearRect(h.min.x,h.min.y,y.x,y.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var h,y=this._redrawBounds;if(this._ctx.save(),y){var E=y.getSize();this._ctx.beginPath(),this._ctx.rect(y.min.x,y.min.y,E.x,E.y),this._ctx.clip()}this._drawing=!0;for(var R=this._drawFirst;R;R=R.next)h=R.layer,(!y||h._pxBounds&&h._pxBounds.intersects(y))&&h._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(h,y){if(this._drawing){var E,R,H,nt,pt=h._parts,vt=pt.length,bt=this._ctx;if(vt){for(bt.beginPath(),E=0;E<vt;E++){for(R=0,H=pt[E].length;R<H;R++)nt=pt[E][R],bt[R?"lineTo":"moveTo"](nt.x,nt.y);y&&bt.closePath()}this._fillStroke(bt,h)}}},_updateCircle:function(h){if(!(!this._drawing||h._empty())){var y=h._point,E=this._ctx,R=Math.max(Math.round(h._radius),1),H=(Math.max(Math.round(h._radiusY),1)||R)/R;H!==1&&(E.save(),E.scale(1,H)),E.beginPath(),E.arc(y.x,y.y/H,R,0,Math.PI*2,!1),H!==1&&E.restore(),this._fillStroke(E,h)}},_fillStroke:function(h,y){var E=y.options;E.fill&&(h.globalAlpha=E.fillOpacity,h.fillStyle=E.fillColor||E.color,h.fill(E.fillRule||"evenodd")),E.stroke&&E.weight!==0&&(h.setLineDash&&h.setLineDash(y.options&&y.options._dashArray||[]),h.globalAlpha=E.opacity,h.lineWidth=E.weight,h.strokeStyle=E.color,h.lineCap=E.lineCap,h.lineJoin=E.lineJoin,h.stroke())},_onClick:function(h){for(var y=this._map.mouseEventToLayerPoint(h),E,R,H=this._drawFirst;H;H=H.next)E=H.layer,E.options.interactive&&E._containsPoint(y)&&(!(h.type==="click"||h.type==="preclick")||!this._map._draggableMoved(E))&&(R=E);this._fireEvent(R?[R]:!1,h)},_onMouseMove:function(h){if(!(!this._map||this._map.dragging.moving()||this._map._animatingZoom)){var y=this._map.mouseEventToLayerPoint(h);this._handleMouseHover(h,y)}},_handleMouseOut:function(h){var y=this._hoveredLayer;y&&(xe(this._container,"leaflet-interactive"),this._fireEvent([y],h,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(h,y){if(!this._mouseHoverThrottled){for(var E,R,H=this._drawFirst;H;H=H.next)E=H.layer,E.options.interactive&&E._containsPoint(y)&&(R=E);R!==this._hoveredLayer&&(this._handleMouseOut(h),R&&(Qt(this._container,"leaflet-interactive"),this._fireEvent([R],h,"mouseover"),this._hoveredLayer=R)),this._fireEvent(this._hoveredLayer?[this._hoveredLayer]:!1,h),this._mouseHoverThrottled=!0,setTimeout(a(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(h,y,E){this._map._fireDOMEvent(y,E||y.type,h)},_bringToFront:function(h){var y=h._order;if(y){var E=y.next,R=y.prev;if(E)E.prev=R;else return;R?R.next=E:E&&(this._drawFirst=E),y.prev=this._drawLast,this._drawLast.next=y,y.next=null,this._drawLast=y,this._requestRedraw(h)}},_bringToBack:function(h){var y=h._order;if(y){var E=y.next,R=y.prev;if(R)R.next=E;else return;E?E.prev=R:R&&(this._drawLast=R),y.prev=null,y.next=this._drawFirst,this._drawFirst.prev=y,this._drawFirst=y,this._requestRedraw(h)}}});function lu(h){return Zt.canvas?new uu(h):null}var zs=function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(h){return document.createElement("<lvml:"+h+' class="lvml">')}}catch{}return function(h){return document.createElement("<"+h+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}(),vl={_initContainer:function(){this._container=he("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(Fi.prototype._update.call(this),this.fire("update"))},_initPath:function(h){var y=h._container=zs("shape");Qt(y,"leaflet-vml-shape "+(this.options.className||"")),y.coordsize="1 1",h._path=zs("path"),y.appendChild(h._path),this._updateStyle(h),this._layers[f(h)]=h},_addPath:function(h){var y=h._container;this._container.appendChild(y),h.options.interactive&&h.addInteractiveTarget(y)},_removePath:function(h){var y=h._container;Ne(y),h.removeInteractiveTarget(y),delete this._layers[f(h)]},_updateStyle:function(h){var y=h._stroke,E=h._fill,R=h.options,H=h._container;H.stroked=!!R.stroke,H.filled=!!R.fill,R.stroke?(y||(y=h._stroke=zs("stroke")),H.appendChild(y),y.weight=R.weight+"px",y.color=R.color,y.opacity=R.opacity,R.dashArray?y.dashStyle=C(R.dashArray)?R.dashArray.join(" "):R.dashArray.replace(/( *, *)/g," "):y.dashStyle="",y.endcap=R.lineCap.replace("butt","flat"),y.joinstyle=R.lineJoin):y&&(H.removeChild(y),h._stroke=null),R.fill?(E||(E=h._fill=zs("fill")),H.appendChild(E),E.color=R.fillColor||R.color,E.opacity=R.fillOpacity):E&&(H.removeChild(E),h._fill=null)},_updateCircle:function(h){var y=h._point.round(),E=Math.round(h._radius),R=Math.round(h._radiusY||E);this._setPath(h,h._empty()?"M0 0":"AL "+y.x+","+y.y+" "+E+","+R+" 0,"+65535*360)},_setPath:function(h,y){h._path.v=y},_bringToFront:function(h){xr(h._container)},_bringToBack:function(h){wn(h._container)}},Mo=Zt.vml?zs:ct,Jr=Fi.extend({_initContainer:function(){this._container=Mo("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=Mo("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){Ne(this._container),Le(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){Fi.prototype._update.call(this);var h=this._bounds,y=h.getSize(),E=this._container;(!this._svgSize||!this._svgSize.equals(y))&&(this._svgSize=y,E.setAttribute("width",y.x),E.setAttribute("height",y.y)),qe(E,h.min),E.setAttribute("viewBox",[h.min.x,h.min.y,y.x,y.y].join(" ")),this.fire("update")}},_initPath:function(h){var y=h._path=Mo("path");h.options.className&&Qt(y,h.options.className),h.options.interactive&&Qt(y,"leaflet-interactive"),this._updateStyle(h),this._layers[f(h)]=h},_addPath:function(h){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(h._path),h.addInteractiveTarget(h._path)},_removePath:function(h){Ne(h._path),h.removeInteractiveTarget(h._path),delete this._layers[f(h)]},_updatePath:function(h){h._project(),h._update()},_updateStyle:function(h){var y=h._path,E=h.options;y&&(E.stroke?(y.setAttribute("stroke",E.color),y.setAttribute("stroke-opacity",E.opacity),y.setAttribute("stroke-width",E.weight),y.setAttribute("stroke-linecap",E.lineCap),y.setAttribute("stroke-linejoin",E.lineJoin),E.dashArray?y.setAttribute("stroke-dasharray",E.dashArray):y.removeAttribute("stroke-dasharray"),E.dashOffset?y.setAttribute("stroke-dashoffset",E.dashOffset):y.removeAttribute("stroke-dashoffset")):y.setAttribute("stroke","none"),E.fill?(y.setAttribute("fill",E.fillColor||E.color),y.setAttribute("fill-opacity",E.fillOpacity),y.setAttribute("fill-rule",E.fillRule||"evenodd")):y.setAttribute("fill","none"))},_updatePoly:function(h,y){this._setPath(h,ht(h._parts,y))},_updateCircle:function(h){var y=h._point,E=Math.max(Math.round(h._radius),1),R=Math.max(Math.round(h._radiusY),1)||E,H="a"+E+","+R+" 0 1,0 ",nt=h._empty()?"M0 0":"M"+(y.x-E)+","+y.y+H+E*2+",0 "+H+-E*2+",0 ";this._setPath(h,nt)},_setPath:function(h,y){h._path.setAttribute("d",y)},_bringToFront:function(h){xr(h._path)},_bringToBack:function(h){wn(h._path)}});Zt.vml&&Jr.include(vl);function sa(h){return Zt.svg||Zt.vml?new Jr(h):null}ee.include({getRenderer:function(h){var y=h.options.renderer||this._getPaneRenderer(h.options.pane)||this.options.renderer||this._renderer;return y||(y=this._renderer=this._createRenderer()),this.hasLayer(y)||this.addLayer(y),y},_getPaneRenderer:function(h){if(h==="overlayPane"||h===void 0)return!1;var y=this._paneRenderers[h];return y===void 0&&(y=this._createRenderer({pane:h}),this._paneRenderers[h]=y),y},_createRenderer:function(h){return this.options.preferCanvas&&lu(h)||sa(h)}});var Kd=hr.extend({initialize:function(h,y){hr.prototype.initialize.call(this,this._boundsToLatLngs(h),y)},setBounds:function(h){return this.setLatLngs(this._boundsToLatLngs(h))},_boundsToLatLngs:function(h){return h=lt(h),[h.getSouthWest(),h.getNorthWest(),h.getNorthEast(),h.getSouthEast()]}});function i0(h,y){return new Kd(h,y)}Jr.create=Mo,Jr.pointsToPath=ht,on.geometryToLayer=Wr,on.coordsToLatLng=wi,on.coordsToLatLngs=Lr,on.latLngToCoords=$r,on.latLngsToCoords=dn,on.getFeature=pn,on.asFeature=c,ee.mergeOptions({boxZoom:!0});var Qd=si.extend({initialize:function(h){this._map=h,this._container=h._container,this._pane=h._panes.overlayPane,this._resetStateTimeout=0,h.on("unload",this._destroy,this)},addHooks:function(){te(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){Le(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){Ne(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){this._resetStateTimeout!==0&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(h){if(!h.shiftKey||h.which!==1&&h.button!==1)return!1;this._clearDeferredResetState(),this._resetState(),yi(),qr(),this._startPoint=this._map.mouseEventToContainerPoint(h),te(document,{contextmenu:vi,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(h){this._moved||(this._moved=!0,this._box=he("div","leaflet-zoom-box",this._container),Qt(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(h);var y=new K(this._point,this._startPoint),E=y.getSize();qe(this._box,y.min),this._box.style.width=E.x+"px",this._box.style.height=E.y+"px"},_finish:function(){this._moved&&(Ne(this._box),xe(this._container,"leaflet-crosshair")),wr(),br(),Le(document,{contextmenu:vi,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(h){if(!(h.which!==1&&h.button!==1)&&(this._finish(),!!this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(a(this._resetState,this),0);var y=new ft(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(y).fire("boxzoomend",{boxZoomBounds:y})}},_onKeyDown:function(h){h.keyCode===27&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});ee.addInitHook("addHandler","boxZoom",Qd),ee.mergeOptions({doubleClickZoom:!0});var tp=si.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(h){var y=this._map,E=y.getZoom(),R=y.options.zoomDelta,H=h.originalEvent.shiftKey?E-R:E+R;y.options.doubleClickZoom==="center"?y.setZoom(H):y.setZoomAround(h.containerPoint,H)}});ee.addInitHook("addHandler","doubleClickZoom",tp),ee.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var ep=si.extend({addHooks:function(){if(!this._draggable){var h=this._map;this._draggable=new Di(h._mapPane,h._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),h.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),h.on("zoomend",this._onZoomEnd,this),h.whenReady(this._onZoomEnd,this))}Qt(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){xe(this._map._container,"leaflet-grab"),xe(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var h=this._map;if(h._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var y=lt(this._map.options.maxBounds);this._offsetLimit=et(this._map.latLngToContainerPoint(y.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(y.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;h.fire("movestart").fire("dragstart"),h.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(h){if(this._map.options.inertia){var y=this._lastTime=+new Date,E=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(E),this._times.push(y),this._prunePositions(y)}this._map.fire("move",h).fire("drag",h)},_prunePositions:function(h){for(;this._positions.length>1&&h-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var h=this._map.getSize().divideBy(2),y=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=y.subtract(h).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(h,y){return h-(h-y)*this._viscosity},_onPreDragLimit:function(){if(!(!this._viscosity||!this._offsetLimit)){var h=this._draggable._newPos.subtract(this._draggable._startPos),y=this._offsetLimit;h.x<y.min.x&&(h.x=this._viscousLimit(h.x,y.min.x)),h.y<y.min.y&&(h.y=this._viscousLimit(h.y,y.min.y)),h.x>y.max.x&&(h.x=this._viscousLimit(h.x,y.max.x)),h.y>y.max.y&&(h.y=this._viscousLimit(h.y,y.max.y)),this._draggable._newPos=this._draggable._startPos.add(h)}},_onPreDragWrap:function(){var h=this._worldWidth,y=Math.round(h/2),E=this._initialWorldOffset,R=this._draggable._newPos.x,H=(R-y+E)%h+y-E,nt=(R+y+E)%h-y-E,pt=Math.abs(H+E)<Math.abs(nt+E)?H:nt;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=pt},_onDragEnd:function(h){var y=this._map,E=y.options,R=!E.inertia||h.noInertia||this._times.length<2;if(y.fire("dragend",h),R)y.fire("moveend");else{this._prunePositions(+new Date);var H=this._lastPos.subtract(this._positions[0]),nt=(this._lastTime-this._times[0])/1e3,pt=E.easeLinearity,vt=H.multiplyBy(pt/nt),bt=vt.distanceTo([0,0]),Nt=Math.min(E.inertiaMaxSpeed,bt),Gt=vt.multiplyBy(Nt/bt),Kt=Nt/(E.inertiaDeceleration*pt),ce=Gt.multiplyBy(-Kt/2).round();!ce.x&&!ce.y?y.fire("moveend"):(ce=y._limitOffset(ce,y.options.maxBounds),V(function(){y.panBy(ce,{duration:Kt,easeLinearity:pt,noMoveStart:!0,animate:!0})}))}}});ee.addInitHook("addHandler","dragging",ep),ee.mergeOptions({keyboard:!0,keyboardPanDelta:80});var np=si.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(h){this._map=h,this._setPanDelta(h.options.keyboardPanDelta),this._setZoomDelta(h.options.zoomDelta)},addHooks:function(){var h=this._map._container;h.tabIndex<=0&&(h.tabIndex="0"),te(h,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),Le(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var h=document.body,y=document.documentElement,E=h.scrollTop||y.scrollTop,R=h.scrollLeft||y.scrollLeft;this._map._container.focus(),window.scrollTo(R,E)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(h){var y=this._panKeys={},E=this.keyCodes,R,H;for(R=0,H=E.left.length;R<H;R++)y[E.left[R]]=[-1*h,0];for(R=0,H=E.right.length;R<H;R++)y[E.right[R]]=[h,0];for(R=0,H=E.down.length;R<H;R++)y[E.down[R]]=[0,h];for(R=0,H=E.up.length;R<H;R++)y[E.up[R]]=[0,-1*h]},_setZoomDelta:function(h){var y=this._zoomKeys={},E=this.keyCodes,R,H;for(R=0,H=E.zoomIn.length;R<H;R++)y[E.zoomIn[R]]=h;for(R=0,H=E.zoomOut.length;R<H;R++)y[E.zoomOut[R]]=-h},_addHooks:function(){te(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){Le(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(h){if(!(h.altKey||h.ctrlKey||h.metaKey)){var y=h.keyCode,E=this._map,R;if(y in this._panKeys){if(!E._panAnim||!E._panAnim._inProgress)if(R=this._panKeys[y],h.shiftKey&&(R=J(R).multiplyBy(3)),E.options.maxBounds&&(R=E._limitOffset(J(R),E.options.maxBounds)),E.options.worldCopyJump){var H=E.wrapLatLng(E.unproject(E.project(E.getCenter()).add(R)));E.panTo(H)}else E.panBy(R)}else if(y in this._zoomKeys)E.setZoom(E.getZoom()+(h.shiftKey?3:1)*this._zoomKeys[y]);else if(y===27&&E._popup&&E._popup.options.closeOnEscapeKey)E.closePopup();else return;vi(h)}}});ee.addInitHook("addHandler","keyboard",np),ee.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var ip=si.extend({addHooks:function(){te(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){Le(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(h){var y=po(h),E=this._map.options.wheelDebounceTime;this._delta+=y,this._lastMousePos=this._map.mouseEventToContainerPoint(h),this._startTime||(this._startTime=+new Date);var R=Math.max(E-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(a(this._performZoom,this),R),vi(h)},_performZoom:function(){var h=this._map,y=h.getZoom(),E=this._map.options.zoomSnap||0;h._stop();var R=this._delta/(this._map.options.wheelPxPerZoomLevel*4),H=4*Math.log(2/(1+Math.exp(-Math.abs(R))))/Math.LN2,nt=E?Math.ceil(H/E)*E:H,pt=h._limitZoom(y+(this._delta>0?nt:-nt))-y;this._delta=0,this._startTime=null,pt&&(h.options.scrollWheelZoom==="center"?h.setZoom(y+pt):h.setZoomAround(this._lastMousePos,y+pt))}});ee.addInitHook("addHandler","scrollWheelZoom",ip);var r0=600;ee.mergeOptions({tapHold:Zt.touchNative&&Zt.safari&&Zt.mobile,tapTolerance:15});var rp=si.extend({addHooks:function(){te(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){Le(this._map._container,"touchstart",this._onDown,this)},_onDown:function(h){if(clearTimeout(this._holdTimeout),h.touches.length===1){var y=h.touches[0];this._startPos=this._newPos=new Y(y.clientX,y.clientY),this._holdTimeout=setTimeout(a(function(){this._cancel(),this._isTapValid()&&(te(document,"touchend",Be),te(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",y))},this),r0),te(document,"touchend touchcancel contextmenu",this._cancel,this),te(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function h(){Le(document,"touchend",Be),Le(document,"touchend touchcancel",h)},_cancel:function(){clearTimeout(this._holdTimeout),Le(document,"touchend touchcancel contextmenu",this._cancel,this),Le(document,"touchmove",this._onMove,this)},_onMove:function(h){var y=h.touches[0];this._newPos=new Y(y.clientX,y.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(h,y){var E=new MouseEvent(h,{bubbles:!0,cancelable:!0,view:window,screenX:y.screenX,screenY:y.screenY,clientX:y.clientX,clientY:y.clientY});E._simulated=!0,y.target.dispatchEvent(E)}});ee.addInitHook("addHandler","tapHold",rp),ee.mergeOptions({touchZoom:Zt.touch,bounceAtZoomLimits:!0});var sp=si.extend({addHooks:function(){Qt(this._map._container,"leaflet-touch-zoom"),te(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){xe(this._map._container,"leaflet-touch-zoom"),Le(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(h){var y=this._map;if(!(!h.touches||h.touches.length!==2||y._animatingZoom||this._zooming)){var E=y.mouseEventToContainerPoint(h.touches[0]),R=y.mouseEventToContainerPoint(h.touches[1]);this._centerPoint=y.getSize()._divideBy(2),this._startLatLng=y.containerPointToLatLng(this._centerPoint),y.options.touchZoom!=="center"&&(this._pinchStartLatLng=y.containerPointToLatLng(E.add(R)._divideBy(2))),this._startDist=E.distanceTo(R),this._startZoom=y.getZoom(),this._moved=!1,this._zooming=!0,y._stop(),te(document,"touchmove",this._onTouchMove,this),te(document,"touchend touchcancel",this._onTouchEnd,this),Be(h)}},_onTouchMove:function(h){if(!(!h.touches||h.touches.length!==2||!this._zooming)){var y=this._map,E=y.mouseEventToContainerPoint(h.touches[0]),R=y.mouseEventToContainerPoint(h.touches[1]),H=E.distanceTo(R)/this._startDist;if(this._zoom=y.getScaleZoom(H,this._startZoom),!y.options.bounceAtZoomLimits&&(this._zoom<y.getMinZoom()&&H<1||this._zoom>y.getMaxZoom()&&H>1)&&(this._zoom=y._limitZoom(this._zoom)),y.options.touchZoom==="center"){if(this._center=this._startLatLng,H===1)return}else{var nt=E._add(R)._divideBy(2)._subtract(this._centerPoint);if(H===1&&nt.x===0&&nt.y===0)return;this._center=y.unproject(y.project(this._pinchStartLatLng,this._zoom).subtract(nt),this._zoom)}this._moved||(y._moveStart(!0,!1),this._moved=!0),z(this._animRequest);var pt=a(y._move,y,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=V(pt,this,!0),Be(h)}},_onTouchEnd:function(){if(!this._moved||!this._zooming){this._zooming=!1;return}this._zooming=!1,z(this._animRequest),Le(document,"touchmove",this._onTouchMove,this),Le(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))}});ee.addInitHook("addHandler","touchZoom",sp),ee.BoxZoom=Qd,ee.DoubleClickZoom=tp,ee.Drag=ep,ee.Keyboard=np,ee.ScrollWheelZoom=ip,ee.TapHold=rp,ee.TouchZoom=sp,e.Bounds=K,e.Browser=Zt,e.CRS=Et,e.Canvas=uu,e.Circle=lr,e.CircleMarker=oi,e.Class=T,e.Control=An,e.DivIcon=qt,e.DivOverlay=dt,e.DomEvent=ru,e.DomUtil=ks,e.Draggable=Di,e.Evented=X,e.FeatureGroup=Ln,e.GeoJSON=on,e.GridLayer=jt,e.Handler=si,e.Icon=Vn,e.ImageOverlay=x,e.LatLng=ut,e.LatLngBounds=ft,e.Layer=Mn,e.LayerGroup=Mr,e.LineUtil=As,e.Map=ee,e.Marker=ur,e.Mixin=au,e.Path=Ke,e.Point=Y,e.PolyUtil=cn,e.Polygon=hr,e.Polyline=Jn,e.Popup=gt,e.PosAnimation=go,e.Projection=Ns,e.Rectangle=Kd,e.Renderer=Fi,e.SVG=Jr,e.SVGOverlay=Q,e.TileLayer=Pe,e.Tooltip=Ot,e.Transformation=_t,e.Util=W,e.VideoOverlay=D,e.bind=a,e.bounds=et,e.canvas=lu,e.circle=Rs,e.circleMarker=bo,e.control=hn,e.divIcon=ne,e.extend=n,e.featureGroup=fn,e.geoJSON=u,e.geoJson=p,e.gridLayer=Ee,e.icon=wo,e.imageOverlay=M,e.latLng=mt,e.latLngBounds=lt,e.layerGroup=or,e.map=Ts,e.marker=Os,e.point=J,e.polygon=Eo,e.polyline=Ds,e.popup=Tt,e.rectangle=i0,e.setOptions=b,e.stamp=f,e.svg=sa,e.svgOverlay=rt,e.tileLayer=Ze,e.tooltip=zt,e.transformation=tt,e.version=i,e.videoOverlay=Z;var s0=window.L;e.noConflict=function(){return window.L=s0,this},window.L=e})}(bu,bu.exports)),bu.exports}var Y1=H1();const X1=eo(Y1);(function(r,t,e){function i(n,s){for(;(n=n.parentElement)&&!n.classList.contains(s););return n}L.drawVersion="1.0.4",L.Draw={},L.drawLocal={draw:{toolbar:{actions:{title:"Cancel drawing",text:"Cancel"},finish:{title:"Finish drawing",text:"Finish"},undo:{title:"Delete last point drawn",text:"Delete last point"},buttons:{polyline:"Draw a polyline",polygon:"Draw a polygon",rectangle:"Draw a rectangle",circle:"Draw a circle",marker:"Draw a marker",circlemarker:"Draw a circlemarker"}},handlers:{circle:{tooltip:{start:"Click and drag to draw circle."},radius:"Radius"},circlemarker:{tooltip:{start:"Click map to place circle marker."}},marker:{tooltip:{start:"Click map to place marker."}},polygon:{tooltip:{start:"Click to start drawing shape.",cont:"Click to continue drawing shape.",end:"Click first point to close this shape."}},polyline:{error:"<strong>Error:</strong> shape edges cannot cross!",tooltip:{start:"Click to start drawing line.",cont:"Click to continue drawing line.",end:"Click last point to finish line."}},rectangle:{tooltip:{start:"Click and drag to draw rectangle."}},simpleshape:{tooltip:{end:"Release mouse to finish drawing."}}}},edit:{toolbar:{actions:{save:{title:"Save changes",text:"Save"},cancel:{title:"Cancel editing, discards all changes",text:"Cancel"},clearAll:{title:"Clear all layers",text:"Clear All"}},buttons:{edit:"Edit layers",editDisabled:"No layers to edit",remove:"Delete layers",removeDisabled:"No layers to delete"}},handlers:{edit:{tooltip:{text:"Drag handles or markers to edit features.",subtext:"Click cancel to undo changes."}},remove:{tooltip:{text:"Click on a feature to remove."}}}}},L.Draw.Event={},L.Draw.Event.CREATED="draw:created",L.Draw.Event.EDITED="draw:edited",L.Draw.Event.DELETED="draw:deleted",L.Draw.Event.DRAWSTART="draw:drawstart",L.Draw.Event.DRAWSTOP="draw:drawstop",L.Draw.Event.DRAWVERTEX="draw:drawvertex",L.Draw.Event.EDITSTART="draw:editstart",L.Draw.Event.EDITMOVE="draw:editmove",L.Draw.Event.EDITRESIZE="draw:editresize",L.Draw.Event.EDITVERTEX="draw:editvertex",L.Draw.Event.EDITSTOP="draw:editstop",L.Draw.Event.DELETESTART="draw:deletestart",L.Draw.Event.DELETESTOP="draw:deletestop",L.Draw.Event.TOOLBAROPENED="draw:toolbaropened",L.Draw.Event.TOOLBARCLOSED="draw:toolbarclosed",L.Draw.Event.MARKERCONTEXT="draw:markercontext",L.Draw=L.Draw||{},L.Draw.Feature=L.Handler.extend({initialize:function(n,s){this._map=n,this._container=n._container,this._overlayPane=n._panes.overlayPane,this._popupPane=n._panes.popupPane,s&&s.shapeOptions&&(s.shapeOptions=L.Util.extend({},this.options.shapeOptions,s.shapeOptions)),L.setOptions(this,s);var a=L.version.split(".");parseInt(a[0],10)===1&&parseInt(a[1],10)>=2?L.Draw.Feature.include(L.Evented.prototype):L.Draw.Feature.include(L.Mixin.Events)},enable:function(){this._enabled||(L.Handler.prototype.enable.call(this),this.fire("enabled",{handler:this.type}),this._map.fire(L.Draw.Event.DRAWSTART,{layerType:this.type}))},disable:function(){this._enabled&&(L.Handler.prototype.disable.call(this),this._map.fire(L.Draw.Event.DRAWSTOP,{layerType:this.type}),this.fire("disabled",{handler:this.type}))},addHooks:function(){var n=this._map;n&&(L.DomUtil.disableTextSelection(),n.getContainer().focus(),this._tooltip=new L.Draw.Tooltip(this._map),L.DomEvent.on(this._container,"keyup",this._cancelDrawing,this))},removeHooks:function(){this._map&&(L.DomUtil.enableTextSelection(),this._tooltip.dispose(),this._tooltip=null,L.DomEvent.off(this._container,"keyup",this._cancelDrawing,this))},setOptions:function(n){L.setOptions(this,n)},_fireCreatedEvent:function(n){this._map.fire(L.Draw.Event.CREATED,{layer:n,layerType:this.type})},_cancelDrawing:function(n){n.keyCode===27&&(this._map.fire("draw:canceled",{layerType:this.type}),this.disable())}}),L.Draw.Polyline=L.Draw.Feature.extend({statics:{TYPE:"polyline"},Poly:L.Polyline,options:{allowIntersection:!0,repeatMode:!1,drawError:{color:"#b00b00",timeout:2500},icon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon"}),touchIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-touch-icon"}),guidelineDistance:20,maxGuideLineLength:4e3,shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!1,clickable:!0},metric:!0,feet:!0,nautic:!1,showLength:!0,zIndexOffset:2e3,factor:1,maxPoints:0},initialize:function(n,s){L.Browser.touch&&(this.options.icon=this.options.touchIcon),this.options.drawError.message=L.drawLocal.draw.handlers.polyline.error,s&&s.drawError&&(s.drawError=L.Util.extend({},this.options.drawError,s.drawError)),this.type=L.Draw.Polyline.TYPE,L.Draw.Feature.prototype.initialize.call(this,n,s)},addHooks:function(){L.Draw.Feature.prototype.addHooks.call(this),this._map&&(this._markers=[],this._markerGroup=new L.LayerGroup,this._map.addLayer(this._markerGroup),this._poly=new L.Polyline([],this.options.shapeOptions),this._tooltip.updateContent(this._getTooltipText()),this._mouseMarker||(this._mouseMarker=L.marker(this._map.getCenter(),{icon:L.divIcon({className:"leaflet-mouse-marker",iconAnchor:[20,20],iconSize:[40,40]}),opacity:0,zIndexOffset:this.options.zIndexOffset})),this._mouseMarker.on("mouseout",this._onMouseOut,this).on("mousemove",this._onMouseMove,this).on("mousedown",this._onMouseDown,this).on("mouseup",this._onMouseUp,this).addTo(this._map),this._map.on("mouseup",this._onMouseUp,this).on("mousemove",this._onMouseMove,this).on("zoomlevelschange",this._onZoomEnd,this).on("touchstart",this._onTouch,this).on("zoomend",this._onZoomEnd,this))},removeHooks:function(){L.Draw.Feature.prototype.removeHooks.call(this),this._clearHideErrorTimeout(),this._cleanUpShape(),this._map.removeLayer(this._markerGroup),delete this._markerGroup,delete this._markers,this._map.removeLayer(this._poly),delete this._poly,this._mouseMarker.off("mousedown",this._onMouseDown,this).off("mouseout",this._onMouseOut,this).off("mouseup",this._onMouseUp,this).off("mousemove",this._onMouseMove,this),this._map.removeLayer(this._mouseMarker),delete this._mouseMarker,this._clearGuides(),this._map.off("mouseup",this._onMouseUp,this).off("mousemove",this._onMouseMove,this).off("zoomlevelschange",this._onZoomEnd,this).off("zoomend",this._onZoomEnd,this).off("touchstart",this._onTouch,this).off("click",this._onTouch,this)},deleteLastVertex:function(){if(!(this._markers.length<=1)){var n=this._markers.pop(),s=this._poly,a=s.getLatLngs(),l=a.splice(-1,1)[0];this._poly.setLatLngs(a),this._markerGroup.removeLayer(n),s.getLatLngs().length<2&&this._map.removeLayer(s),this._vertexChanged(l,!1)}},addVertex:function(n){if(this._markers.length>=2&&!this.options.allowIntersection&&this._poly.newLatLngIntersects(n))return void this._showErrorTooltip();this._errorShown&&this._hideErrorTooltip(),this._markers.push(this._createMarker(n)),this._poly.addLatLng(n),this._poly.getLatLngs().length===2&&this._map.addLayer(this._poly),this._vertexChanged(n,!0)},completeShape:function(){this._markers.length<=1||!this._shapeIsValid()||(this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable())},_finishShape:function(){var n=this._poly._defaultShape?this._poly._defaultShape():this._poly.getLatLngs(),s=this._poly.newLatLngIntersects(n[n.length-1]);if(!this.options.allowIntersection&&s||!this._shapeIsValid())return void this._showErrorTooltip();this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable()},_shapeIsValid:function(){return!0},_onZoomEnd:function(){this._markers!==null&&this._updateGuide()},_onMouseMove:function(n){var s=this._map.mouseEventToLayerPoint(n.originalEvent),a=this._map.layerPointToLatLng(s);this._currentLatLng=a,this._updateTooltip(a),this._updateGuide(s),this._mouseMarker.setLatLng(a),L.DomEvent.preventDefault(n.originalEvent)},_vertexChanged:function(n,s){this._map.fire(L.Draw.Event.DRAWVERTEX,{layers:this._markerGroup}),this._updateFinishHandler(),this._updateRunningMeasure(n,s),this._clearGuides(),this._updateTooltip()},_onMouseDown:function(n){if(!this._clickHandled&&!this._touchHandled&&!this._disableMarkers){this._onMouseMove(n),this._clickHandled=!0,this._disableNewMarkers();var s=n.originalEvent,a=s.clientX,l=s.clientY;this._startPoint.call(this,a,l)}},_startPoint:function(n,s){this._mouseDownOrigin=L.point(n,s)},_onMouseUp:function(n){var s=n.originalEvent,a=s.clientX,l=s.clientY;this._endPoint.call(this,a,l,n),this._clickHandled=null},_endPoint:function(n,s,a){if(this._mouseDownOrigin){var l=L.point(n,s).distanceTo(this._mouseDownOrigin),f=this._calculateFinishDistance(a.latlng);this.options.maxPoints>1&&this.options.maxPoints==this._markers.length+1?(this.addVertex(a.latlng),this._finishShape()):f<10&&L.Browser.touch?this._finishShape():Math.abs(l)<9*(r.devicePixelRatio||1)&&this.addVertex(a.latlng),this._enableNewMarkers()}this._mouseDownOrigin=null},_onTouch:function(n){var s,a,l=n.originalEvent;!l.touches||!l.touches[0]||this._clickHandled||this._touchHandled||this._disableMarkers||(s=l.touches[0].clientX,a=l.touches[0].clientY,this._disableNewMarkers(),this._touchHandled=!0,this._startPoint.call(this,s,a),this._endPoint.call(this,s,a,n),this._touchHandled=null),this._clickHandled=null},_onMouseOut:function(){this._tooltip&&this._tooltip._onMouseOut.call(this._tooltip)},_calculateFinishDistance:function(n){var s;if(this._markers.length>0){var a;if(this.type===L.Draw.Polyline.TYPE)a=this._markers[this._markers.length-1];else{if(this.type!==L.Draw.Polygon.TYPE)return 1/0;a=this._markers[0]}var l=this._map.latLngToContainerPoint(a.getLatLng()),f=new L.Marker(n,{icon:this.options.icon,zIndexOffset:2*this.options.zIndexOffset}),d=this._map.latLngToContainerPoint(f.getLatLng());s=l.distanceTo(d)}else s=1/0;return s},_updateFinishHandler:function(){var n=this._markers.length;n>1&&this._markers[n-1].on("click",this._finishShape,this),n>2&&this._markers[n-2].off("click",this._finishShape,this)},_createMarker:function(n){var s=new L.Marker(n,{icon:this.options.icon,zIndexOffset:2*this.options.zIndexOffset});return this._markerGroup.addLayer(s),s},_updateGuide:function(n){var s=this._markers?this._markers.length:0;s>0&&(n=n||this._map.latLngToLayerPoint(this._currentLatLng),this._clearGuides(),this._drawGuide(this._map.latLngToLayerPoint(this._markers[s-1].getLatLng()),n))},_updateTooltip:function(n){var s=this._getTooltipText();n&&this._tooltip.updatePosition(n),this._errorShown||this._tooltip.updateContent(s)},_drawGuide:function(n,s){var a,l,f,d=Math.floor(Math.sqrt(Math.pow(s.x-n.x,2)+Math.pow(s.y-n.y,2))),g=this.options.guidelineDistance,m=this.options.maxGuideLineLength,v=d>m?d-m:g;for(this._guidesContainer||(this._guidesContainer=L.DomUtil.create("div","leaflet-draw-guides",this._overlayPane));v<d;v+=this.options.guidelineDistance)a=v/d,l={x:Math.floor(n.x*(1-a)+a*s.x),y:Math.floor(n.y*(1-a)+a*s.y)},f=L.DomUtil.create("div","leaflet-draw-guide-dash",this._guidesContainer),f.style.backgroundColor=this._errorShown?this.options.drawError.color:this.options.shapeOptions.color,L.DomUtil.setPosition(f,l)},_updateGuideColor:function(n){if(this._guidesContainer)for(var s=0,a=this._guidesContainer.childNodes.length;s<a;s++)this._guidesContainer.childNodes[s].style.backgroundColor=n},_clearGuides:function(){if(this._guidesContainer)for(;this._guidesContainer.firstChild;)this._guidesContainer.removeChild(this._guidesContainer.firstChild)},_getTooltipText:function(){var n,s,a=this.options.showLength;return this._markers.length===0?n={text:L.drawLocal.draw.handlers.polyline.tooltip.start}:(s=a?this._getMeasurementString():"",n=this._markers.length===1?{text:L.drawLocal.draw.handlers.polyline.tooltip.cont,subtext:s}:{text:L.drawLocal.draw.handlers.polyline.tooltip.end,subtext:s}),n},_updateRunningMeasure:function(n,s){var a,l,f=this._markers.length;this._markers.length===1?this._measurementRunningTotal=0:(a=f-(s?2:1),l=L.GeometryUtil.isVersion07x()?n.distanceTo(this._markers[a].getLatLng())*(this.options.factor||1):this._map.distance(n,this._markers[a].getLatLng())*(this.options.factor||1),this._measurementRunningTotal+=l*(s?1:-1))},_getMeasurementString:function(){var n,s=this._currentLatLng,a=this._markers[this._markers.length-1].getLatLng();return n=L.GeometryUtil.isVersion07x()?a&&s&&s.distanceTo?this._measurementRunningTotal+s.distanceTo(a)*(this.options.factor||1):this._measurementRunningTotal||0:a&&s?this._measurementRunningTotal+this._map.distance(s,a)*(this.options.factor||1):this._measurementRunningTotal||0,L.GeometryUtil.readableDistance(n,this.options.metric,this.options.feet,this.options.nautic,this.options.precision)},_showErrorTooltip:function(){this._errorShown=!0,this._tooltip.showAsError().updateContent({text:this.options.drawError.message}),this._updateGuideColor(this.options.drawError.color),this._poly.setStyle({color:this.options.drawError.color}),this._clearHideErrorTimeout(),this._hideErrorTimeout=setTimeout(L.Util.bind(this._hideErrorTooltip,this),this.options.drawError.timeout)},_hideErrorTooltip:function(){this._errorShown=!1,this._clearHideErrorTimeout(),this._tooltip.removeError().updateContent(this._getTooltipText()),this._updateGuideColor(this.options.shapeOptions.color),this._poly.setStyle({color:this.options.shapeOptions.color})},_clearHideErrorTimeout:function(){this._hideErrorTimeout&&(clearTimeout(this._hideErrorTimeout),this._hideErrorTimeout=null)},_disableNewMarkers:function(){this._disableMarkers=!0},_enableNewMarkers:function(){setTimeout((function(){this._disableMarkers=!1}).bind(this),50)},_cleanUpShape:function(){this._markers.length>1&&this._markers[this._markers.length-1].off("click",this._finishShape,this)},_fireCreatedEvent:function(){var n=new this.Poly(this._poly.getLatLngs(),this.options.shapeOptions);L.Draw.Feature.prototype._fireCreatedEvent.call(this,n)}}),L.Draw.Polygon=L.Draw.Polyline.extend({statics:{TYPE:"polygon"},Poly:L.Polygon,options:{showArea:!1,showLength:!1,shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0},metric:!0,feet:!0,nautic:!1,precision:{}},initialize:function(n,s){L.Draw.Polyline.prototype.initialize.call(this,n,s),this.type=L.Draw.Polygon.TYPE},_updateFinishHandler:function(){var n=this._markers.length;n===1&&this._markers[0].on("click",this._finishShape,this),n>2&&(this._markers[n-1].on("dblclick",this._finishShape,this),n>3&&this._markers[n-2].off("dblclick",this._finishShape,this))},_getTooltipText:function(){var n,s;return this._markers.length===0?n=L.drawLocal.draw.handlers.polygon.tooltip.start:this._markers.length<3?(n=L.drawLocal.draw.handlers.polygon.tooltip.cont,s=this._getMeasurementString()):(n=L.drawLocal.draw.handlers.polygon.tooltip.end,s=this._getMeasurementString()),{text:n,subtext:s}},_getMeasurementString:function(){var n=this._area,s="";return n||this.options.showLength?(this.options.showLength&&(s=L.Draw.Polyline.prototype._getMeasurementString.call(this)),n&&(s+="<br>"+L.GeometryUtil.readableArea(n,this.options.metric,this.options.precision)),s):null},_shapeIsValid:function(){return this._markers.length>=3},_vertexChanged:function(n,s){var a;!this.options.allowIntersection&&this.options.showArea&&(a=this._poly.getLatLngs(),this._area=L.GeometryUtil.geodesicArea(a)),L.Draw.Polyline.prototype._vertexChanged.call(this,n,s)},_cleanUpShape:function(){var n=this._markers.length;n>0&&(this._markers[0].off("click",this._finishShape,this),n>2&&this._markers[n-1].off("dblclick",this._finishShape,this))}}),L.SimpleShape={},L.Draw.SimpleShape=L.Draw.Feature.extend({options:{repeatMode:!1},initialize:function(n,s){this._endLabelText=L.drawLocal.draw.handlers.simpleshape.tooltip.end,L.Draw.Feature.prototype.initialize.call(this,n,s)},addHooks:function(){L.Draw.Feature.prototype.addHooks.call(this),this._map&&(this._mapDraggable=this._map.dragging.enabled(),this._mapDraggable&&this._map.dragging.disable(),this._container.style.cursor="crosshair",this._tooltip.updateContent({text:this._initialLabelText}),this._map.on("mousedown",this._onMouseDown,this).on("mousemove",this._onMouseMove,this).on("touchstart",this._onMouseDown,this).on("touchmove",this._onMouseMove,this),t.addEventListener("touchstart",L.DomEvent.preventDefault,{passive:!1}))},removeHooks:function(){L.Draw.Feature.prototype.removeHooks.call(this),this._map&&(this._mapDraggable&&this._map.dragging.enable(),this._container.style.cursor="",this._map.off("mousedown",this._onMouseDown,this).off("mousemove",this._onMouseMove,this).off("touchstart",this._onMouseDown,this).off("touchmove",this._onMouseMove,this),L.DomEvent.off(t,"mouseup",this._onMouseUp,this),L.DomEvent.off(t,"touchend",this._onMouseUp,this),t.removeEventListener("touchstart",L.DomEvent.preventDefault),this._shape&&(this._map.removeLayer(this._shape),delete this._shape)),this._isDrawing=!1},_getTooltipText:function(){return{text:this._endLabelText}},_onMouseDown:function(n){this._isDrawing=!0,this._startLatLng=n.latlng,L.DomEvent.on(t,"mouseup",this._onMouseUp,this).on(t,"touchend",this._onMouseUp,this).preventDefault(n.originalEvent)},_onMouseMove:function(n){var s=n.latlng;this._tooltip.updatePosition(s),this._isDrawing&&(this._tooltip.updateContent(this._getTooltipText()),this._drawShape(s))},_onMouseUp:function(){this._shape&&this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable()}}),L.Draw.Rectangle=L.Draw.SimpleShape.extend({statics:{TYPE:"rectangle"},options:{shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0},showArea:!0,metric:!0},initialize:function(n,s){this.type=L.Draw.Rectangle.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.rectangle.tooltip.start,L.Draw.SimpleShape.prototype.initialize.call(this,n,s)},disable:function(){this._enabled&&(this._isCurrentlyTwoClickDrawing=!1,L.Draw.SimpleShape.prototype.disable.call(this))},_onMouseUp:function(n){if(!this._shape&&!this._isCurrentlyTwoClickDrawing)return void(this._isCurrentlyTwoClickDrawing=!0);this._isCurrentlyTwoClickDrawing&&!i(n.target,"leaflet-pane")||L.Draw.SimpleShape.prototype._onMouseUp.call(this)},_drawShape:function(n){this._shape?this._shape.setBounds(new L.LatLngBounds(this._startLatLng,n)):(this._shape=new L.Rectangle(new L.LatLngBounds(this._startLatLng,n),this.options.shapeOptions),this._map.addLayer(this._shape))},_fireCreatedEvent:function(){var n=new L.Rectangle(this._shape.getBounds(),this.options.shapeOptions);L.Draw.SimpleShape.prototype._fireCreatedEvent.call(this,n)},_getTooltipText:function(){var n,s,a,l=L.Draw.SimpleShape.prototype._getTooltipText.call(this),f=this._shape,d=this.options.showArea;return f&&(n=this._shape._defaultShape?this._shape._defaultShape():this._shape.getLatLngs(),s=L.GeometryUtil.geodesicArea(n),a=d?L.GeometryUtil.readableArea(s,this.options.metric):""),{text:l.text,subtext:a}}}),L.Draw.Marker=L.Draw.Feature.extend({statics:{TYPE:"marker"},options:{icon:new L.Icon.Default,repeatMode:!1,zIndexOffset:2e3},initialize:function(n,s){this.type=L.Draw.Marker.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.marker.tooltip.start,L.Draw.Feature.prototype.initialize.call(this,n,s)},addHooks:function(){L.Draw.Feature.prototype.addHooks.call(this),this._map&&(this._tooltip.updateContent({text:this._initialLabelText}),this._mouseMarker||(this._mouseMarker=L.marker(this._map.getCenter(),{icon:L.divIcon({className:"leaflet-mouse-marker",iconAnchor:[20,20],iconSize:[40,40]}),opacity:0,zIndexOffset:this.options.zIndexOffset})),this._mouseMarker.on("click",this._onClick,this).addTo(this._map),this._map.on("mousemove",this._onMouseMove,this),this._map.on("click",this._onTouch,this))},removeHooks:function(){L.Draw.Feature.prototype.removeHooks.call(this),this._map&&(this._map.off("click",this._onClick,this).off("click",this._onTouch,this),this._marker&&(this._marker.off("click",this._onClick,this),this._map.removeLayer(this._marker),delete this._marker),this._mouseMarker.off("click",this._onClick,this),this._map.removeLayer(this._mouseMarker),delete this._mouseMarker,this._map.off("mousemove",this._onMouseMove,this))},_onMouseMove:function(n){var s=n.latlng;this._tooltip.updatePosition(s),this._mouseMarker.setLatLng(s),this._marker?(s=this._mouseMarker.getLatLng(),this._marker.setLatLng(s)):(this._marker=this._createMarker(s),this._marker.on("click",this._onClick,this),this._map.on("click",this._onClick,this).addLayer(this._marker))},_createMarker:function(n){return new L.Marker(n,{icon:this.options.icon,zIndexOffset:this.options.zIndexOffset})},_onClick:function(){this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable()},_onTouch:function(n){this._onMouseMove(n),this._onClick()},_fireCreatedEvent:function(){var n=new L.Marker.Touch(this._marker.getLatLng(),{icon:this.options.icon});L.Draw.Feature.prototype._fireCreatedEvent.call(this,n)}}),L.Draw.CircleMarker=L.Draw.Marker.extend({statics:{TYPE:"circlemarker"},options:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0,zIndexOffset:2e3},initialize:function(n,s){this.type=L.Draw.CircleMarker.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.circlemarker.tooltip.start,L.Draw.Feature.prototype.initialize.call(this,n,s)},_fireCreatedEvent:function(){var n=new L.CircleMarker(this._marker.getLatLng(),this.options);L.Draw.Feature.prototype._fireCreatedEvent.call(this,n)},_createMarker:function(n){return new L.CircleMarker(n,this.options)}}),L.Draw.Circle=L.Draw.SimpleShape.extend({statics:{TYPE:"circle"},options:{shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0},showRadius:!0,metric:!0,feet:!0,nautic:!1},initialize:function(n,s){this.type=L.Draw.Circle.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.circle.tooltip.start,L.Draw.SimpleShape.prototype.initialize.call(this,n,s)},_drawShape:function(n){if(L.GeometryUtil.isVersion07x())var s=this._startLatLng.distanceTo(n);else var s=this._map.distance(this._startLatLng,n);this._shape?this._shape.setRadius(s):(this._shape=new L.Circle(this._startLatLng,s,this.options.shapeOptions),this._map.addLayer(this._shape))},_fireCreatedEvent:function(){var n=new L.Circle(this._startLatLng,this._shape.getRadius(),this.options.shapeOptions);L.Draw.SimpleShape.prototype._fireCreatedEvent.call(this,n)},_onMouseMove:function(n){var s,a=n.latlng,l=this.options.showRadius,f=this.options.metric;if(this._tooltip.updatePosition(a),this._isDrawing){this._drawShape(a),s=this._shape.getRadius().toFixed(1);var d="";l&&(d=L.drawLocal.draw.handlers.circle.radius+": "+L.GeometryUtil.readableDistance(s,f,this.options.feet,this.options.nautic)),this._tooltip.updateContent({text:this._endLabelText,subtext:d})}}}),L.Edit=L.Edit||{},L.Edit.Marker=L.Handler.extend({initialize:function(n,s){this._marker=n,L.setOptions(this,s)},addHooks:function(){var n=this._marker;n.dragging.enable(),n.on("dragend",this._onDragEnd,n),this._toggleMarkerHighlight()},removeHooks:function(){var n=this._marker;n.dragging.disable(),n.off("dragend",this._onDragEnd,n),this._toggleMarkerHighlight()},_onDragEnd:function(n){var s=n.target;s.edited=!0,this._map.fire(L.Draw.Event.EDITMOVE,{layer:s})},_toggleMarkerHighlight:function(){var n=this._marker._icon;n&&(n.style.display="none",L.DomUtil.hasClass(n,"leaflet-edit-marker-selected")?(L.DomUtil.removeClass(n,"leaflet-edit-marker-selected"),this._offsetMarker(n,-4)):(L.DomUtil.addClass(n,"leaflet-edit-marker-selected"),this._offsetMarker(n,4)),n.style.display="")},_offsetMarker:function(n,s){var a=parseInt(n.style.marginTop,10)-s,l=parseInt(n.style.marginLeft,10)-s;n.style.marginTop=a+"px",n.style.marginLeft=l+"px"}}),L.Marker.addInitHook(function(){L.Edit.Marker&&(this.editing=new L.Edit.Marker(this),this.options.editable&&this.editing.enable())}),L.Edit=L.Edit||{},L.Edit.Poly=L.Handler.extend({initialize:function(n){this.latlngs=[n._latlngs],n._holes&&(this.latlngs=this.latlngs.concat(n._holes)),this._poly=n,this._poly.on("revert-edited",this._updateLatLngs,this)},_defaultShape:function(){return L.Polyline._flat?L.Polyline._flat(this._poly._latlngs)?this._poly._latlngs:this._poly._latlngs[0]:this._poly._latlngs},_eachVertexHandler:function(n){for(var s=0;s<this._verticesHandlers.length;s++)n(this._verticesHandlers[s])},addHooks:function(){this._initHandlers(),this._eachVertexHandler(function(n){n.addHooks()})},removeHooks:function(){this._eachVertexHandler(function(n){n.removeHooks()})},updateMarkers:function(){this._eachVertexHandler(function(n){n.updateMarkers()})},_initHandlers:function(){this._verticesHandlers=[];for(var n=0;n<this.latlngs.length;n++)this._verticesHandlers.push(new L.Edit.PolyVerticesEdit(this._poly,this.latlngs[n],this._poly.options.poly))},_updateLatLngs:function(n){this.latlngs=[n.layer._latlngs],n.layer._holes&&(this.latlngs=this.latlngs.concat(n.layer._holes))}}),L.Edit.PolyVerticesEdit=L.Handler.extend({options:{icon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon"}),touchIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-touch-icon"}),drawError:{color:"#b00b00",timeout:1e3}},initialize:function(n,s,a){L.Browser.touch&&(this.options.icon=this.options.touchIcon),this._poly=n,a&&a.drawError&&(a.drawError=L.Util.extend({},this.options.drawError,a.drawError)),this._latlngs=s,L.setOptions(this,a)},_defaultShape:function(){return L.Polyline._flat?L.Polyline._flat(this._latlngs)?this._latlngs:this._latlngs[0]:this._latlngs},addHooks:function(){var n=this._poly,s=n._path;n instanceof L.Polygon||(n.options.fill=!1,n.options.editing&&(n.options.editing.fill=!1)),s&&n.options.editing&&n.options.editing.className&&(n.options.original.className&&n.options.original.className.split(" ").forEach(function(a){L.DomUtil.removeClass(s,a)}),n.options.editing.className.split(" ").forEach(function(a){L.DomUtil.addClass(s,a)})),n.setStyle(n.options.editing),this._poly._map&&(this._map=this._poly._map,this._markerGroup||this._initMarkers(),this._poly._map.addLayer(this._markerGroup))},removeHooks:function(){var n=this._poly,s=n._path;s&&n.options.editing&&n.options.editing.className&&(n.options.editing.className.split(" ").forEach(function(a){L.DomUtil.removeClass(s,a)}),n.options.original.className&&n.options.original.className.split(" ").forEach(function(a){L.DomUtil.addClass(s,a)})),n.setStyle(n.options.original),n._map&&(n._map.removeLayer(this._markerGroup),delete this._markerGroup,delete this._markers)},updateMarkers:function(){this._markerGroup.clearLayers(),this._initMarkers()},_initMarkers:function(){this._markerGroup||(this._markerGroup=new L.LayerGroup),this._markers=[];var n,s,a,l,f=this._defaultShape();for(n=0,a=f.length;n<a;n++)l=this._createMarker(f[n],n),l.on("click",this._onMarkerClick,this),l.on("contextmenu",this._onContextMenu,this),this._markers.push(l);var d,g;for(n=0,s=a-1;n<a;s=n++)(n!==0||L.Polygon&&this._poly instanceof L.Polygon)&&(d=this._markers[s],g=this._markers[n],this._createMiddleMarker(d,g),this._updatePrevNext(d,g))},_createMarker:function(n,s){var a=new L.Marker.Touch(n,{draggable:!0,icon:this.options.icon});return a._origLatLng=n,a._index=s,a.on("dragstart",this._onMarkerDragStart,this).on("drag",this._onMarkerDrag,this).on("dragend",this._fireEdit,this).on("touchmove",this._onTouchMove,this).on("touchend",this._fireEdit,this).on("MSPointerMove",this._onTouchMove,this).on("MSPointerUp",this._fireEdit,this),this._markerGroup.addLayer(a),a},_onMarkerDragStart:function(){this._poly.fire("editstart")},_spliceLatLngs:function(){var n=this._defaultShape(),s=[].splice.apply(n,arguments);return this._poly._convertLatLngs(n,!0),this._poly.redraw(),s},_removeMarker:function(n){var s=n._index;this._markerGroup.removeLayer(n),this._markers.splice(s,1),this._spliceLatLngs(s,1),this._updateIndexes(s,-1),n.off("dragstart",this._onMarkerDragStart,this).off("drag",this._onMarkerDrag,this).off("dragend",this._fireEdit,this).off("touchmove",this._onMarkerDrag,this).off("touchend",this._fireEdit,this).off("click",this._onMarkerClick,this).off("MSPointerMove",this._onTouchMove,this).off("MSPointerUp",this._fireEdit,this)},_fireEdit:function(){this._poly.edited=!0,this._poly.fire("edit"),this._poly._map.fire(L.Draw.Event.EDITVERTEX,{layers:this._markerGroup,poly:this._poly})},_onMarkerDrag:function(n){var s=n.target,a=this._poly,l=L.LatLngUtil.cloneLatLng(s._origLatLng);if(L.extend(s._origLatLng,s._latlng),a.options.poly){var f=a._map._editTooltip;if(!a.options.poly.allowIntersection&&a.intersects()){L.extend(s._origLatLng,l),s.setLatLng(l);var d=a.options.color;a.setStyle({color:this.options.drawError.color}),f&&f.updateContent({text:L.drawLocal.draw.handlers.polyline.error}),setTimeout(function(){a.setStyle({color:d}),f&&f.updateContent({text:L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.edit.handlers.edit.tooltip.subtext})},1e3)}}s._middleLeft&&s._middleLeft.setLatLng(this._getMiddleLatLng(s._prev,s)),s._middleRight&&s._middleRight.setLatLng(this._getMiddleLatLng(s,s._next)),this._poly._bounds._southWest=L.latLng(1/0,1/0),this._poly._bounds._northEast=L.latLng(-1/0,-1/0);var g=this._poly.getLatLngs();this._poly._convertLatLngs(g,!0),this._poly.redraw(),this._poly.fire("editdrag")},_onMarkerClick:function(n){var s=L.Polygon&&this._poly instanceof L.Polygon?4:3,a=n.target;this._defaultShape().length<s||(this._removeMarker(a),this._updatePrevNext(a._prev,a._next),a._middleLeft&&this._markerGroup.removeLayer(a._middleLeft),a._middleRight&&this._markerGroup.removeLayer(a._middleRight),a._prev&&a._next?this._createMiddleMarker(a._prev,a._next):a._prev?a._next||(a._prev._middleRight=null):a._next._middleLeft=null,this._fireEdit())},_onContextMenu:function(n){var s=n.target;this._poly,this._poly._map.fire(L.Draw.Event.MARKERCONTEXT,{marker:s,layers:this._markerGroup,poly:this._poly}),L.DomEvent.stopPropagation},_onTouchMove:function(n){var s=this._map.mouseEventToLayerPoint(n.originalEvent.touches[0]),a=this._map.layerPointToLatLng(s),l=n.target;L.extend(l._origLatLng,a),l._middleLeft&&l._middleLeft.setLatLng(this._getMiddleLatLng(l._prev,l)),l._middleRight&&l._middleRight.setLatLng(this._getMiddleLatLng(l,l._next)),this._poly.redraw(),this.updateMarkers()},_updateIndexes:function(n,s){this._markerGroup.eachLayer(function(a){a._index>n&&(a._index+=s)})},_createMiddleMarker:function(n,s){var a,l,f,d=this._getMiddleLatLng(n,s),g=this._createMarker(d);g.setOpacity(.6),n._middleRight=s._middleLeft=g,l=function(){g.off("touchmove",l,this);var m=s._index;g._index=m,g.off("click",a,this).on("click",this._onMarkerClick,this),d.lat=g.getLatLng().lat,d.lng=g.getLatLng().lng,this._spliceLatLngs(m,0,d),this._markers.splice(m,0,g),g.setOpacity(1),this._updateIndexes(m,1),s._index++,this._updatePrevNext(n,g),this._updatePrevNext(g,s),this._poly.fire("editstart")},f=function(){g.off("dragstart",l,this),g.off("dragend",f,this),g.off("touchmove",l,this),this._createMiddleMarker(n,g),this._createMiddleMarker(g,s)},a=function(){l.call(this),f.call(this),this._fireEdit()},g.on("click",a,this).on("dragstart",l,this).on("dragend",f,this).on("touchmove",l,this),this._markerGroup.addLayer(g)},_updatePrevNext:function(n,s){n&&(n._next=s),s&&(s._prev=n)},_getMiddleLatLng:function(n,s){var a=this._poly._map,l=a.project(n.getLatLng()),f=a.project(s.getLatLng());return a.unproject(l._add(f)._divideBy(2))}}),L.Polyline.addInitHook(function(){this.editing||(L.Edit.Poly&&(this.editing=new L.Edit.Poly(this),this.options.editable&&this.editing.enable()),this.on("add",function(){this.editing&&this.editing.enabled()&&this.editing.addHooks()}),this.on("remove",function(){this.editing&&this.editing.enabled()&&this.editing.removeHooks()}))}),L.Edit=L.Edit||{},L.Edit.SimpleShape=L.Handler.extend({options:{moveIcon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-move"}),resizeIcon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-resize"}),touchMoveIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-move leaflet-touch-icon"}),touchResizeIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-resize leaflet-touch-icon"})},initialize:function(n,s){L.Browser.touch&&(this.options.moveIcon=this.options.touchMoveIcon,this.options.resizeIcon=this.options.touchResizeIcon),this._shape=n,L.Util.setOptions(this,s)},addHooks:function(){var n=this._shape;this._shape._map&&(this._map=this._shape._map,n.setStyle(n.options.editing),n._map&&(this._map=n._map,this._markerGroup||this._initMarkers(),this._map.addLayer(this._markerGroup)))},removeHooks:function(){var n=this._shape;if(n.setStyle(n.options.original),n._map){this._unbindMarker(this._moveMarker);for(var s=0,a=this._resizeMarkers.length;s<a;s++)this._unbindMarker(this._resizeMarkers[s]);this._resizeMarkers=null,this._map.removeLayer(this._markerGroup),delete this._markerGroup}this._map=null},updateMarkers:function(){this._markerGroup.clearLayers(),this._initMarkers()},_initMarkers:function(){this._markerGroup||(this._markerGroup=new L.LayerGroup),this._createMoveMarker(),this._createResizeMarker()},_createMoveMarker:function(){},_createResizeMarker:function(){},_createMarker:function(n,s){var a=new L.Marker.Touch(n,{draggable:!0,icon:s,zIndexOffset:10});return this._bindMarker(a),this._markerGroup.addLayer(a),a},_bindMarker:function(n){n.on("dragstart",this._onMarkerDragStart,this).on("drag",this._onMarkerDrag,this).on("dragend",this._onMarkerDragEnd,this).on("touchstart",this._onTouchStart,this).on("touchmove",this._onTouchMove,this).on("MSPointerMove",this._onTouchMove,this).on("touchend",this._onTouchEnd,this).on("MSPointerUp",this._onTouchEnd,this)},_unbindMarker:function(n){n.off("dragstart",this._onMarkerDragStart,this).off("drag",this._onMarkerDrag,this).off("dragend",this._onMarkerDragEnd,this).off("touchstart",this._onTouchStart,this).off("touchmove",this._onTouchMove,this).off("MSPointerMove",this._onTouchMove,this).off("touchend",this._onTouchEnd,this).off("MSPointerUp",this._onTouchEnd,this)},_onMarkerDragStart:function(n){n.target.setOpacity(0),this._shape.fire("editstart")},_fireEdit:function(){this._shape.edited=!0,this._shape.fire("edit")},_onMarkerDrag:function(n){var s=n.target,a=s.getLatLng();s===this._moveMarker?this._move(a):this._resize(a),this._shape.redraw(),this._shape.fire("editdrag")},_onMarkerDragEnd:function(n){n.target.setOpacity(1),this._fireEdit()},_onTouchStart:function(n){if(L.Edit.SimpleShape.prototype._onMarkerDragStart.call(this,n),typeof this._getCorners=="function"){var s=this._getCorners(),a=n.target,l=a._cornerIndex;a.setOpacity(0),this._oppositeCorner=s[(l+2)%4],this._toggleCornerMarkers(0,l)}this._shape.fire("editstart")},_onTouchMove:function(n){var s=this._map.mouseEventToLayerPoint(n.originalEvent.touches[0]),a=this._map.layerPointToLatLng(s);return n.target===this._moveMarker?this._move(a):this._resize(a),this._shape.redraw(),!1},_onTouchEnd:function(n){n.target.setOpacity(1),this.updateMarkers(),this._fireEdit()},_move:function(){},_resize:function(){}}),L.Edit=L.Edit||{},L.Edit.Rectangle=L.Edit.SimpleShape.extend({_createMoveMarker:function(){var n=this._shape.getBounds(),s=n.getCenter();this._moveMarker=this._createMarker(s,this.options.moveIcon)},_createResizeMarker:function(){var n=this._getCorners();this._resizeMarkers=[];for(var s=0,a=n.length;s<a;s++)this._resizeMarkers.push(this._createMarker(n[s],this.options.resizeIcon)),this._resizeMarkers[s]._cornerIndex=s},_onMarkerDragStart:function(n){L.Edit.SimpleShape.prototype._onMarkerDragStart.call(this,n);var s=this._getCorners(),a=n.target,l=a._cornerIndex;this._oppositeCorner=s[(l+2)%4],this._toggleCornerMarkers(0,l)},_onMarkerDragEnd:function(n){var s,a,l=n.target;l===this._moveMarker&&(s=this._shape.getBounds(),a=s.getCenter(),l.setLatLng(a)),this._toggleCornerMarkers(1),this._repositionCornerMarkers(),L.Edit.SimpleShape.prototype._onMarkerDragEnd.call(this,n)},_move:function(n){for(var s,a=this._shape._defaultShape?this._shape._defaultShape():this._shape.getLatLngs(),l=this._shape.getBounds(),f=l.getCenter(),d=[],g=0,m=a.length;g<m;g++)s=[a[g].lat-f.lat,a[g].lng-f.lng],d.push([n.lat+s[0],n.lng+s[1]]);this._shape.setLatLngs(d),this._repositionCornerMarkers(),this._map.fire(L.Draw.Event.EDITMOVE,{layer:this._shape})},_resize:function(n){var s;this._shape.setBounds(L.latLngBounds(n,this._oppositeCorner)),s=this._shape.getBounds(),this._moveMarker.setLatLng(s.getCenter()),this._map.fire(L.Draw.Event.EDITRESIZE,{layer:this._shape})},_getCorners:function(){var n=this._shape.getBounds();return[n.getNorthWest(),n.getNorthEast(),n.getSouthEast(),n.getSouthWest()]},_toggleCornerMarkers:function(n){for(var s=0,a=this._resizeMarkers.length;s<a;s++)this._resizeMarkers[s].setOpacity(n)},_repositionCornerMarkers:function(){for(var n=this._getCorners(),s=0,a=this._resizeMarkers.length;s<a;s++)this._resizeMarkers[s].setLatLng(n[s])}}),L.Rectangle.addInitHook(function(){L.Edit.Rectangle&&(this.editing=new L.Edit.Rectangle(this),this.options.editable&&this.editing.enable())}),L.Edit=L.Edit||{},L.Edit.CircleMarker=L.Edit.SimpleShape.extend({_createMoveMarker:function(){var n=this._shape.getLatLng();this._moveMarker=this._createMarker(n,this.options.moveIcon)},_createResizeMarker:function(){this._resizeMarkers=[]},_move:function(n){if(this._resizeMarkers.length){var s=this._getResizeMarkerPoint(n);this._resizeMarkers[0].setLatLng(s)}this._shape.setLatLng(n),this._map.fire(L.Draw.Event.EDITMOVE,{layer:this._shape})}}),L.CircleMarker.addInitHook(function(){L.Edit.CircleMarker&&(this.editing=new L.Edit.CircleMarker(this),this.options.editable&&this.editing.enable()),this.on("add",function(){this.editing&&this.editing.enabled()&&this.editing.addHooks()}),this.on("remove",function(){this.editing&&this.editing.enabled()&&this.editing.removeHooks()})}),L.Edit=L.Edit||{},L.Edit.Circle=L.Edit.CircleMarker.extend({_createResizeMarker:function(){var n=this._shape.getLatLng(),s=this._getResizeMarkerPoint(n);this._resizeMarkers=[],this._resizeMarkers.push(this._createMarker(s,this.options.resizeIcon))},_getResizeMarkerPoint:function(n){var s=this._shape._radius*Math.cos(Math.PI/4),a=this._map.project(n);return this._map.unproject([a.x+s,a.y-s])},_resize:function(n){var s=this._moveMarker.getLatLng();L.GeometryUtil.isVersion07x()?radius=s.distanceTo(n):radius=this._map.distance(s,n),this._shape.setRadius(radius),this._map.editTooltip&&this._map._editTooltip.updateContent({text:L.drawLocal.edit.handlers.edit.tooltip.subtext+"<br />"+L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.draw.handlers.circle.radius+": "+L.GeometryUtil.readableDistance(radius,!0,this.options.feet,this.options.nautic)}),this._shape.setRadius(radius),this._map.fire(L.Draw.Event.EDITRESIZE,{layer:this._shape})}}),L.Circle.addInitHook(function(){L.Edit.Circle&&(this.editing=new L.Edit.Circle(this),this.options.editable&&this.editing.enable())}),L.Map.mergeOptions({touchExtend:!0}),L.Map.TouchExtend=L.Handler.extend({initialize:function(n){this._map=n,this._container=n._container,this._pane=n._panes.overlayPane},addHooks:function(){L.DomEvent.on(this._container,"touchstart",this._onTouchStart,this),L.DomEvent.on(this._container,"touchend",this._onTouchEnd,this),L.DomEvent.on(this._container,"touchmove",this._onTouchMove,this),this._detectIE()?(L.DomEvent.on(this._container,"MSPointerDown",this._onTouchStart,this),L.DomEvent.on(this._container,"MSPointerUp",this._onTouchEnd,this),L.DomEvent.on(this._container,"MSPointerMove",this._onTouchMove,this),L.DomEvent.on(this._container,"MSPointerCancel",this._onTouchCancel,this)):(L.DomEvent.on(this._container,"touchcancel",this._onTouchCancel,this),L.DomEvent.on(this._container,"touchleave",this._onTouchLeave,this))},removeHooks:function(){L.DomEvent.off(this._container,"touchstart",this._onTouchStart,this),L.DomEvent.off(this._container,"touchend",this._onTouchEnd,this),L.DomEvent.off(this._container,"touchmove",this._onTouchMove,this),this._detectIE()?(L.DomEvent.off(this._container,"MSPointerDown",this._onTouchStart,this),L.DomEvent.off(this._container,"MSPointerUp",this._onTouchEnd,this),L.DomEvent.off(this._container,"MSPointerMove",this._onTouchMove,this),L.DomEvent.off(this._container,"MSPointerCancel",this._onTouchCancel,this)):(L.DomEvent.off(this._container,"touchcancel",this._onTouchCancel,this),L.DomEvent.off(this._container,"touchleave",this._onTouchLeave,this))},_touchEvent:function(n,s){var a={};if(n.touches!==void 0){if(!n.touches.length)return;a=n.touches[0]}else if(n.pointerType!=="touch"||(a=n,!this._filterClick(n)))return;var l=this._map.mouseEventToContainerPoint(a),f=this._map.mouseEventToLayerPoint(a),d=this._map.layerPointToLatLng(f);this._map.fire(s,{latlng:d,layerPoint:f,containerPoint:l,pageX:a.pageX,pageY:a.pageY,originalEvent:n})},_filterClick:function(n){var s=n.timeStamp||n.originalEvent.timeStamp,a=L.DomEvent._lastClick&&s-L.DomEvent._lastClick;return a&&a>100&&a<500||n.target._simulatedClick&&!n._simulated?(L.DomEvent.stop(n),!1):(L.DomEvent._lastClick=s,!0)},_onTouchStart:function(n){this._map._loaded&&this._touchEvent(n,"touchstart")},_onTouchEnd:function(n){this._map._loaded&&this._touchEvent(n,"touchend")},_onTouchCancel:function(n){if(this._map._loaded){var s="touchcancel";this._detectIE()&&(s="pointercancel"),this._touchEvent(n,s)}},_onTouchLeave:function(n){this._map._loaded&&this._touchEvent(n,"touchleave")},_onTouchMove:function(n){this._map._loaded&&this._touchEvent(n,"touchmove")},_detectIE:function(){var n=r.navigator.userAgent,s=n.indexOf("MSIE ");if(s>0)return parseInt(n.substring(s+5,n.indexOf(".",s)),10);if(n.indexOf("Trident/")>0){var a=n.indexOf("rv:");return parseInt(n.substring(a+3,n.indexOf(".",a)),10)}var l=n.indexOf("Edge/");return l>0&&parseInt(n.substring(l+5,n.indexOf(".",l)),10)}}),L.Map.addInitHook("addHandler","touchExtend",L.Map.TouchExtend),L.Marker.Touch=L.Marker.extend({_initInteraction:function(){return this.addInteractiveTarget?L.Marker.prototype._initInteraction.apply(this):this._initInteractionLegacy()},_initInteractionLegacy:function(){if(this.options.clickable){var n=this._icon,s=["dblclick","mousedown","mouseover","mouseout","contextmenu","touchstart","touchend","touchmove"];this._detectIE?s.concat(["MSPointerDown","MSPointerUp","MSPointerMove","MSPointerCancel"]):s.concat(["touchcancel"]),L.DomUtil.addClass(n,"leaflet-clickable"),L.DomEvent.on(n,"click",this._onMouseClick,this),L.DomEvent.on(n,"keypress",this._onKeyPress,this);for(var a=0;a<s.length;a++)L.DomEvent.on(n,s[a],this._fireMouseEvent,this);L.Handler.MarkerDrag&&(this.dragging=new L.Handler.MarkerDrag(this),this.options.draggable&&this.dragging.enable())}},_detectIE:function(){var n=r.navigator.userAgent,s=n.indexOf("MSIE ");if(s>0)return parseInt(n.substring(s+5,n.indexOf(".",s)),10);if(n.indexOf("Trident/")>0){var a=n.indexOf("rv:");return parseInt(n.substring(a+3,n.indexOf(".",a)),10)}var l=n.indexOf("Edge/");return l>0&&parseInt(n.substring(l+5,n.indexOf(".",l)),10)}}),L.LatLngUtil={cloneLatLngs:function(n){for(var s=[],a=0,l=n.length;a<l;a++)Array.isArray(n[a])?s.push(L.LatLngUtil.cloneLatLngs(n[a])):s.push(this.cloneLatLng(n[a]));return s},cloneLatLng:function(n){return L.latLng(n.lat,n.lng)}},function(){var n={km:2,ha:2,m:0,mi:2,ac:2,yd:0,ft:0,nm:2};L.GeometryUtil=L.extend(L.GeometryUtil||{},{geodesicArea:function(s){var a,l,f=s.length,d=0,g=Math.PI/180;if(f>2){for(var m=0;m<f;m++)a=s[m],l=s[(m+1)%f],d+=(l.lng-a.lng)*g*(2+Math.sin(a.lat*g)+Math.sin(l.lat*g));d=6378137*d*6378137/2}return Math.abs(d)},formattedNumber:function(s,a){var l=parseFloat(s).toFixed(a),f=L.drawLocal.format&&L.drawLocal.format.numeric,d=f&&f.delimiters,g=d&&d.thousands,m=d&&d.decimal;if(g||m){var v=l.split(".");l=g?v[0].replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1"+g):v[0],m=m||".",v.length>1&&(l=l+m+v[1])}return l},readableArea:function(s,a,g){var f,d,g=L.Util.extend({},n,g);return a?(d=["ha","m"],type=typeof a,type==="string"?d=[a]:type!=="boolean"&&(d=a),f=s>=1e6&&d.indexOf("km")!==-1?L.GeometryUtil.formattedNumber(1e-6*s,g.km)+" km":s>=1e4&&d.indexOf("ha")!==-1?L.GeometryUtil.formattedNumber(1e-4*s,g.ha)+" ha":L.GeometryUtil.formattedNumber(s,g.m)+" m"):(s/=.836127,f=s>=3097600?L.GeometryUtil.formattedNumber(s/3097600,g.mi)+" mi":s>=4840?L.GeometryUtil.formattedNumber(s/4840,g.ac)+" acres":L.GeometryUtil.formattedNumber(s,g.yd)+" yd"),f},readableDistance:function(s,a,l,f,m){var g,m=L.Util.extend({},n,m);switch(a?typeof a=="string"?a:"metric":l?"feet":f?"nauticalMile":"yards"){case"metric":g=s>1e3?L.GeometryUtil.formattedNumber(s/1e3,m.km)+" km":L.GeometryUtil.formattedNumber(s,m.m)+" m";break;case"feet":s*=3.28083,g=L.GeometryUtil.formattedNumber(s,m.ft)+" ft";break;case"nauticalMile":s*=.53996,g=L.GeometryUtil.formattedNumber(s/1e3,m.nm)+" nm";break;case"yards":default:s*=1.09361,g=s>1760?L.GeometryUtil.formattedNumber(s/1760,m.mi)+" miles":L.GeometryUtil.formattedNumber(s,m.yd)+" yd"}return g},isVersion07x:function(){var s=L.version.split(".");return parseInt(s[0],10)===0&&parseInt(s[1],10)===7}})}(),L.Util.extend(L.LineUtil,{segmentsIntersect:function(n,s,a,l){return this._checkCounterclockwise(n,a,l)!==this._checkCounterclockwise(s,a,l)&&this._checkCounterclockwise(n,s,a)!==this._checkCounterclockwise(n,s,l)},_checkCounterclockwise:function(n,s,a){return(a.y-n.y)*(s.x-n.x)>(s.y-n.y)*(a.x-n.x)}}),L.Polyline.include({intersects:function(){var n,s,a,l=this._getProjectedPoints(),f=l?l.length:0;if(this._tooFewPointsForIntersection())return!1;for(n=f-1;n>=3;n--)if(s=l[n-1],a=l[n],this._lineSegmentsIntersectsRange(s,a,n-2))return!0;return!1},newLatLngIntersects:function(n,s){return!!this._map&&this.newPointIntersects(this._map.latLngToLayerPoint(n),s)},newPointIntersects:function(n,s){var a=this._getProjectedPoints(),l=a?a.length:0,f=a?a[l-1]:null,d=l-2;return!this._tooFewPointsForIntersection(1)&&this._lineSegmentsIntersectsRange(f,n,d,s?1:0)},_tooFewPointsForIntersection:function(n){var s=this._getProjectedPoints(),a=s?s.length:0;return a+=n||0,!s||a<=3},_lineSegmentsIntersectsRange:function(n,s,a,l){var f,d,g=this._getProjectedPoints();l=l||0;for(var m=a;m>l;m--)if(f=g[m-1],d=g[m],L.LineUtil.segmentsIntersect(n,s,f,d))return!0;return!1},_getProjectedPoints:function(){if(!this._defaultShape)return this._originalPoints;for(var n=[],s=this._defaultShape(),a=0;a<s.length;a++)n.push(this._map.latLngToLayerPoint(s[a]));return n}}),L.Polygon.include({intersects:function(){var n,s,a,l,f=this._getProjectedPoints();return!this._tooFewPointsForIntersection()&&(!!L.Polyline.prototype.intersects.call(this)||(n=f.length,s=f[0],a=f[n-1],l=n-2,this._lineSegmentsIntersectsRange(a,s,l,1)))}}),L.Control.Draw=L.Control.extend({options:{position:"topleft",draw:{},edit:!1},initialize:function(n){if(L.version<"0.7")throw new Error("Leaflet.draw 0.2.3+ requires Leaflet 0.7.0+. Download latest from https://github.com/Leaflet/Leaflet/");L.Control.prototype.initialize.call(this,n);var s;this._toolbars={},L.DrawToolbar&&this.options.draw&&(s=new L.DrawToolbar(this.options.draw),this._toolbars[L.DrawToolbar.TYPE]=s,this._toolbars[L.DrawToolbar.TYPE].on("enable",this._toolbarEnabled,this)),L.EditToolbar&&this.options.edit&&(s=new L.EditToolbar(this.options.edit),this._toolbars[L.EditToolbar.TYPE]=s,this._toolbars[L.EditToolbar.TYPE].on("enable",this._toolbarEnabled,this)),L.toolbar=this},onAdd:function(n){var s,a=L.DomUtil.create("div","leaflet-draw"),l=!1;for(var f in this._toolbars)this._toolbars.hasOwnProperty(f)&&(s=this._toolbars[f].addToolbar(n))&&(l||(L.DomUtil.hasClass(s,"leaflet-draw-toolbar-top")||L.DomUtil.addClass(s.childNodes[0],"leaflet-draw-toolbar-top"),l=!0),a.appendChild(s));return a},onRemove:function(){for(var n in this._toolbars)this._toolbars.hasOwnProperty(n)&&this._toolbars[n].removeToolbar()},setDrawingOptions:function(n){for(var s in this._toolbars)this._toolbars[s]instanceof L.DrawToolbar&&this._toolbars[s].setOptions(n)},_toolbarEnabled:function(n){var s=n.target;for(var a in this._toolbars)this._toolbars[a]!==s&&this._toolbars[a].disable()}}),L.Map.mergeOptions({drawControlTooltips:!0,drawControl:!1}),L.Map.addInitHook(function(){this.options.drawControl&&(this.drawControl=new L.Control.Draw,this.addControl(this.drawControl))}),L.Toolbar=L.Class.extend({initialize:function(n){L.setOptions(this,n),this._modes={},this._actionButtons=[],this._activeMode=null;var s=L.version.split(".");parseInt(s[0],10)===1&&parseInt(s[1],10)>=2?L.Toolbar.include(L.Evented.prototype):L.Toolbar.include(L.Mixin.Events)},enabled:function(){return this._activeMode!==null},disable:function(){this.enabled()&&this._activeMode.handler.disable()},addToolbar:function(n){var s,a=L.DomUtil.create("div","leaflet-draw-section"),l=0,f=this._toolbarClass||"",d=this.getModeHandlers(n);for(this._toolbarContainer=L.DomUtil.create("div","leaflet-draw-toolbar leaflet-bar"),this._map=n,s=0;s<d.length;s++)d[s].enabled&&this._initModeHandler(d[s].handler,this._toolbarContainer,l++,f,d[s].title);if(l)return this._lastButtonIndex=--l,this._actionsContainer=L.DomUtil.create("ul","leaflet-draw-actions"),a.appendChild(this._toolbarContainer),a.appendChild(this._actionsContainer),a},removeToolbar:function(){for(var n in this._modes)this._modes.hasOwnProperty(n)&&(this._disposeButton(this._modes[n].button,this._modes[n].handler.enable,this._modes[n].handler),this._modes[n].handler.disable(),this._modes[n].handler.off("enabled",this._handlerActivated,this).off("disabled",this._handlerDeactivated,this));this._modes={};for(var s=0,a=this._actionButtons.length;s<a;s++)this._disposeButton(this._actionButtons[s].button,this._actionButtons[s].callback,this);this._actionButtons=[],this._actionsContainer=null},_initModeHandler:function(n,s,a,l,f){var d=n.type;this._modes[d]={},this._modes[d].handler=n,this._modes[d].button=this._createButton({type:d,title:f,className:l+"-"+d,container:s,callback:this._modes[d].handler.enable,context:this._modes[d].handler}),this._modes[d].buttonIndex=a,this._modes[d].handler.on("enabled",this._handlerActivated,this).on("disabled",this._handlerDeactivated,this)},_detectIOS:function(){return/iPad|iPhone|iPod/.test(navigator.userAgent)&&!r.MSStream},_createButton:function(n){var s=L.DomUtil.create("a",n.className||"",n.container),a=L.DomUtil.create("span","sr-only",n.container);s.href="#",s.appendChild(a),n.title&&(s.title=n.title,a.innerHTML=n.title),n.text&&(s.innerHTML=n.text,a.innerHTML=n.text);var l=this._detectIOS()?"touchstart":"click";return L.DomEvent.on(s,"click",L.DomEvent.stopPropagation).on(s,"mousedown",L.DomEvent.stopPropagation).on(s,"dblclick",L.DomEvent.stopPropagation).on(s,"touchstart",L.DomEvent.stopPropagation).on(s,"click",L.DomEvent.preventDefault).on(s,l,n.callback,n.context),s},_disposeButton:function(n,s){var a=this._detectIOS()?"touchstart":"click";L.DomEvent.off(n,"click",L.DomEvent.stopPropagation).off(n,"mousedown",L.DomEvent.stopPropagation).off(n,"dblclick",L.DomEvent.stopPropagation).off(n,"touchstart",L.DomEvent.stopPropagation).off(n,"click",L.DomEvent.preventDefault).off(n,a,s)},_handlerActivated:function(n){this.disable(),this._activeMode=this._modes[n.handler],L.DomUtil.addClass(this._activeMode.button,"leaflet-draw-toolbar-button-enabled"),this._showActionsToolbar(),this.fire("enable")},_handlerDeactivated:function(){this._hideActionsToolbar(),L.DomUtil.removeClass(this._activeMode.button,"leaflet-draw-toolbar-button-enabled"),this._activeMode=null,this.fire("disable")},_createActions:function(n){var s,a,l,f,d=this._actionsContainer,g=this.getActions(n),m=g.length;for(a=0,l=this._actionButtons.length;a<l;a++)this._disposeButton(this._actionButtons[a].button,this._actionButtons[a].callback);for(this._actionButtons=[];d.firstChild;)d.removeChild(d.firstChild);for(var v=0;v<m;v++)"enabled"in g[v]&&!g[v].enabled||(s=L.DomUtil.create("li","",d),f=this._createButton({title:g[v].title,text:g[v].text,container:s,callback:g[v].callback,context:g[v].context}),this._actionButtons.push({button:f,callback:g[v].callback}))},_showActionsToolbar:function(){var n=this._activeMode.buttonIndex,s=this._lastButtonIndex,a=this._activeMode.button.offsetTop-1;this._createActions(this._activeMode.handler),this._actionsContainer.style.top=a+"px",n===0&&(L.DomUtil.addClass(this._toolbarContainer,"leaflet-draw-toolbar-notop"),L.DomUtil.addClass(this._actionsContainer,"leaflet-draw-actions-top")),n===s&&(L.DomUtil.addClass(this._toolbarContainer,"leaflet-draw-toolbar-nobottom"),L.DomUtil.addClass(this._actionsContainer,"leaflet-draw-actions-bottom")),this._actionsContainer.style.display="block",this._map.fire(L.Draw.Event.TOOLBAROPENED)},_hideActionsToolbar:function(){this._actionsContainer.style.display="none",L.DomUtil.removeClass(this._toolbarContainer,"leaflet-draw-toolbar-notop"),L.DomUtil.removeClass(this._toolbarContainer,"leaflet-draw-toolbar-nobottom"),L.DomUtil.removeClass(this._actionsContainer,"leaflet-draw-actions-top"),L.DomUtil.removeClass(this._actionsContainer,"leaflet-draw-actions-bottom"),this._map.fire(L.Draw.Event.TOOLBARCLOSED)}}),L.Draw=L.Draw||{},L.Draw.Tooltip=L.Class.extend({initialize:function(n){this._map=n,this._popupPane=n._panes.popupPane,this._visible=!1,this._container=n.options.drawControlTooltips?L.DomUtil.create("div","leaflet-draw-tooltip",this._popupPane):null,this._singleLineLabel=!1,this._map.on("mouseout",this._onMouseOut,this)},dispose:function(){this._map.off("mouseout",this._onMouseOut,this),this._container&&(this._popupPane.removeChild(this._container),this._container=null)},updateContent:function(n){return this._container?(n.subtext=n.subtext||"",n.subtext.length!==0||this._singleLineLabel?n.subtext.length>0&&this._singleLineLabel&&(L.DomUtil.removeClass(this._container,"leaflet-draw-tooltip-single"),this._singleLineLabel=!1):(L.DomUtil.addClass(this._container,"leaflet-draw-tooltip-single"),this._singleLineLabel=!0),this._container.innerHTML=(n.subtext.length>0?'<span class="leaflet-draw-tooltip-subtext">'+n.subtext+"</span><br />":"")+"<span>"+n.text+"</span>",n.text||n.subtext?(this._visible=!0,this._container.style.visibility="inherit"):(this._visible=!1,this._container.style.visibility="hidden"),this):this},updatePosition:function(n){var s=this._map.latLngToLayerPoint(n),a=this._container;return this._container&&(this._visible&&(a.style.visibility="inherit"),L.DomUtil.setPosition(a,s)),this},showAsError:function(){return this._container&&L.DomUtil.addClass(this._container,"leaflet-error-draw-tooltip"),this},removeError:function(){return this._container&&L.DomUtil.removeClass(this._container,"leaflet-error-draw-tooltip"),this},_onMouseOut:function(){this._container&&(this._container.style.visibility="hidden")}}),L.DrawToolbar=L.Toolbar.extend({statics:{TYPE:"draw"},options:{polyline:{},polygon:{},rectangle:{},circle:{},marker:{},circlemarker:{}},initialize:function(n){for(var s in this.options)this.options.hasOwnProperty(s)&&n[s]&&(n[s]=L.extend({},this.options[s],n[s]));this._toolbarClass="leaflet-draw-draw",L.Toolbar.prototype.initialize.call(this,n)},getModeHandlers:function(n){return[{enabled:this.options.polyline,handler:new L.Draw.Polyline(n,this.options.polyline),title:L.drawLocal.draw.toolbar.buttons.polyline},{enabled:this.options.polygon,handler:new L.Draw.Polygon(n,this.options.polygon),title:L.drawLocal.draw.toolbar.buttons.polygon},{enabled:this.options.rectangle,handler:new L.Draw.Rectangle(n,this.options.rectangle),title:L.drawLocal.draw.toolbar.buttons.rectangle},{enabled:this.options.circle,handler:new L.Draw.Circle(n,this.options.circle),title:L.drawLocal.draw.toolbar.buttons.circle},{enabled:this.options.marker,handler:new L.Draw.Marker(n,this.options.marker),title:L.drawLocal.draw.toolbar.buttons.marker},{enabled:this.options.circlemarker,handler:new L.Draw.CircleMarker(n,this.options.circlemarker),title:L.drawLocal.draw.toolbar.buttons.circlemarker}]},getActions:function(n){return[{enabled:n.completeShape,title:L.drawLocal.draw.toolbar.finish.title,text:L.drawLocal.draw.toolbar.finish.text,callback:n.completeShape,context:n},{enabled:n.deleteLastVertex,title:L.drawLocal.draw.toolbar.undo.title,text:L.drawLocal.draw.toolbar.undo.text,callback:n.deleteLastVertex,context:n},{title:L.drawLocal.draw.toolbar.actions.title,text:L.drawLocal.draw.toolbar.actions.text,callback:this.disable,context:this}]},setOptions:function(n){L.setOptions(this,n);for(var s in this._modes)this._modes.hasOwnProperty(s)&&n.hasOwnProperty(s)&&this._modes[s].handler.setOptions(n[s])}}),L.EditToolbar=L.Toolbar.extend({statics:{TYPE:"edit"},options:{edit:{selectedPathOptions:{dashArray:"10, 10",fill:!0,fillColor:"#fe57a1",fillOpacity:.1,maintainColor:!1}},remove:{},poly:null,featureGroup:null},initialize:function(n){n.edit&&(n.edit.selectedPathOptions===void 0&&(n.edit.selectedPathOptions=this.options.edit.selectedPathOptions),n.edit.selectedPathOptions=L.extend({},this.options.edit.selectedPathOptions,n.edit.selectedPathOptions)),n.remove&&(n.remove=L.extend({},this.options.remove,n.remove)),n.poly&&(n.poly=L.extend({},this.options.poly,n.poly)),this._toolbarClass="leaflet-draw-edit",L.Toolbar.prototype.initialize.call(this,n),this._selectedFeatureCount=0},getModeHandlers:function(n){var s=this.options.featureGroup;return[{enabled:this.options.edit,handler:new L.EditToolbar.Edit(n,{featureGroup:s,selectedPathOptions:this.options.edit.selectedPathOptions,poly:this.options.poly}),title:L.drawLocal.edit.toolbar.buttons.edit},{enabled:this.options.remove,handler:new L.EditToolbar.Delete(n,{featureGroup:s}),title:L.drawLocal.edit.toolbar.buttons.remove}]},getActions:function(n){var s=[{title:L.drawLocal.edit.toolbar.actions.save.title,text:L.drawLocal.edit.toolbar.actions.save.text,callback:this._save,context:this},{title:L.drawLocal.edit.toolbar.actions.cancel.title,text:L.drawLocal.edit.toolbar.actions.cancel.text,callback:this.disable,context:this}];return n.removeAllLayers&&s.push({title:L.drawLocal.edit.toolbar.actions.clearAll.title,text:L.drawLocal.edit.toolbar.actions.clearAll.text,callback:this._clearAllLayers,context:this}),s},addToolbar:function(n){var s=L.Toolbar.prototype.addToolbar.call(this,n);return this._checkDisabled(),this.options.featureGroup.on("layeradd layerremove",this._checkDisabled,this),s},removeToolbar:function(){this.options.featureGroup.off("layeradd layerremove",this._checkDisabled,this),L.Toolbar.prototype.removeToolbar.call(this)},disable:function(){this.enabled()&&(this._activeMode.handler.revertLayers(),L.Toolbar.prototype.disable.call(this))},_save:function(){this._activeMode.handler.save(),this._activeMode&&this._activeMode.handler.disable()},_clearAllLayers:function(){this._activeMode.handler.removeAllLayers(),this._activeMode&&this._activeMode.handler.disable()},_checkDisabled:function(){var n,s=this.options.featureGroup,a=s.getLayers().length!==0;this.options.edit&&(n=this._modes[L.EditToolbar.Edit.TYPE].button,a?L.DomUtil.removeClass(n,"leaflet-disabled"):L.DomUtil.addClass(n,"leaflet-disabled"),n.setAttribute("title",a?L.drawLocal.edit.toolbar.buttons.edit:L.drawLocal.edit.toolbar.buttons.editDisabled)),this.options.remove&&(n=this._modes[L.EditToolbar.Delete.TYPE].button,a?L.DomUtil.removeClass(n,"leaflet-disabled"):L.DomUtil.addClass(n,"leaflet-disabled"),n.setAttribute("title",a?L.drawLocal.edit.toolbar.buttons.remove:L.drawLocal.edit.toolbar.buttons.removeDisabled))}}),L.EditToolbar.Edit=L.Handler.extend({statics:{TYPE:"edit"},initialize:function(n,s){if(L.Handler.prototype.initialize.call(this,n),L.setOptions(this,s),this._featureGroup=s.featureGroup,!(this._featureGroup instanceof L.FeatureGroup))throw new Error("options.featureGroup must be a L.FeatureGroup");this._uneditedLayerProps={},this.type=L.EditToolbar.Edit.TYPE;var a=L.version.split(".");parseInt(a[0],10)===1&&parseInt(a[1],10)>=2?L.EditToolbar.Edit.include(L.Evented.prototype):L.EditToolbar.Edit.include(L.Mixin.Events)},enable:function(){!this._enabled&&this._hasAvailableLayers()&&(this.fire("enabled",{handler:this.type}),this._map.fire(L.Draw.Event.EDITSTART,{handler:this.type}),L.Handler.prototype.enable.call(this),this._featureGroup.on("layeradd",this._enableLayerEdit,this).on("layerremove",this._disableLayerEdit,this))},disable:function(){this._enabled&&(this._featureGroup.off("layeradd",this._enableLayerEdit,this).off("layerremove",this._disableLayerEdit,this),L.Handler.prototype.disable.call(this),this._map.fire(L.Draw.Event.EDITSTOP,{handler:this.type}),this.fire("disabled",{handler:this.type}))},addHooks:function(){var n=this._map;n&&(n.getContainer().focus(),this._featureGroup.eachLayer(this._enableLayerEdit,this),this._tooltip=new L.Draw.Tooltip(this._map),this._tooltip.updateContent({text:L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.edit.handlers.edit.tooltip.subtext}),n._editTooltip=this._tooltip,this._updateTooltip(),this._map.on("mousemove",this._onMouseMove,this).on("touchmove",this._onMouseMove,this).on("MSPointerMove",this._onMouseMove,this).on(L.Draw.Event.EDITVERTEX,this._updateTooltip,this))},removeHooks:function(){this._map&&(this._featureGroup.eachLayer(this._disableLayerEdit,this),this._uneditedLayerProps={},this._tooltip.dispose(),this._tooltip=null,this._map.off("mousemove",this._onMouseMove,this).off("touchmove",this._onMouseMove,this).off("MSPointerMove",this._onMouseMove,this).off(L.Draw.Event.EDITVERTEX,this._updateTooltip,this))},revertLayers:function(){this._featureGroup.eachLayer(function(n){this._revertLayer(n)},this)},save:function(){var n=new L.LayerGroup;this._featureGroup.eachLayer(function(s){s.edited&&(n.addLayer(s),s.edited=!1)}),this._map.fire(L.Draw.Event.EDITED,{layers:n})},_backupLayer:function(n){var s=L.Util.stamp(n);this._uneditedLayerProps[s]||(n instanceof L.Polyline||n instanceof L.Polygon||n instanceof L.Rectangle?this._uneditedLayerProps[s]={latlngs:L.LatLngUtil.cloneLatLngs(n.getLatLngs())}:n instanceof L.Circle?this._uneditedLayerProps[s]={latlng:L.LatLngUtil.cloneLatLng(n.getLatLng()),radius:n.getRadius()}:(n instanceof L.Marker||n instanceof L.CircleMarker)&&(this._uneditedLayerProps[s]={latlng:L.LatLngUtil.cloneLatLng(n.getLatLng())}))},_getTooltipText:function(){return{text:L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.edit.handlers.edit.tooltip.subtext}},_updateTooltip:function(){this._tooltip.updateContent(this._getTooltipText())},_revertLayer:function(n){var s=L.Util.stamp(n);n.edited=!1,this._uneditedLayerProps.hasOwnProperty(s)&&(n instanceof L.Polyline||n instanceof L.Polygon||n instanceof L.Rectangle?n.setLatLngs(this._uneditedLayerProps[s].latlngs):n instanceof L.Circle?(n.setLatLng(this._uneditedLayerProps[s].latlng),n.setRadius(this._uneditedLayerProps[s].radius)):(n instanceof L.Marker||n instanceof L.CircleMarker)&&n.setLatLng(this._uneditedLayerProps[s].latlng),n.fire("revert-edited",{layer:n}))},_enableLayerEdit:function(n){var s,a,l=n.layer||n.target||n;this._backupLayer(l),this.options.poly&&(a=L.Util.extend({},this.options.poly),l.options.poly=a),this.options.selectedPathOptions&&(s=L.Util.extend({},this.options.selectedPathOptions),s.maintainColor&&(s.color=l.options.color,s.fillColor=l.options.fillColor),l.options.original=L.extend({},l.options),l.options.editing=s),l instanceof L.Marker?(l.editing&&l.editing.enable(),l.dragging.enable(),l.on("dragend",this._onMarkerDragEnd).on("touchmove",this._onTouchMove,this).on("MSPointerMove",this._onTouchMove,this).on("touchend",this._onMarkerDragEnd,this).on("MSPointerUp",this._onMarkerDragEnd,this)):l.editing.enable()},_disableLayerEdit:function(n){var s=n.layer||n.target||n;s.edited=!1,s.editing&&s.editing.disable(),delete s.options.editing,delete s.options.original,this._selectedPathOptions&&(s instanceof L.Marker?this._toggleMarkerHighlight(s):(s.setStyle(s.options.previousOptions),delete s.options.previousOptions)),s instanceof L.Marker?(s.dragging.disable(),s.off("dragend",this._onMarkerDragEnd,this).off("touchmove",this._onTouchMove,this).off("MSPointerMove",this._onTouchMove,this).off("touchend",this._onMarkerDragEnd,this).off("MSPointerUp",this._onMarkerDragEnd,this)):s.editing.disable()},_onMouseMove:function(n){this._tooltip.updatePosition(n.latlng)},_onMarkerDragEnd:function(n){var s=n.target;s.edited=!0,this._map.fire(L.Draw.Event.EDITMOVE,{layer:s})},_onTouchMove:function(n){var s=n.originalEvent.changedTouches[0],a=this._map.mouseEventToLayerPoint(s),l=this._map.layerPointToLatLng(a);n.target.setLatLng(l)},_hasAvailableLayers:function(){return this._featureGroup.getLayers().length!==0}}),L.EditToolbar.Delete=L.Handler.extend({statics:{TYPE:"remove"},initialize:function(n,s){if(L.Handler.prototype.initialize.call(this,n),L.Util.setOptions(this,s),this._deletableLayers=this.options.featureGroup,!(this._deletableLayers instanceof L.FeatureGroup))throw new Error("options.featureGroup must be a L.FeatureGroup");this.type=L.EditToolbar.Delete.TYPE;var a=L.version.split(".");parseInt(a[0],10)===1&&parseInt(a[1],10)>=2?L.EditToolbar.Delete.include(L.Evented.prototype):L.EditToolbar.Delete.include(L.Mixin.Events)},enable:function(){!this._enabled&&this._hasAvailableLayers()&&(this.fire("enabled",{handler:this.type}),this._map.fire(L.Draw.Event.DELETESTART,{handler:this.type}),L.Handler.prototype.enable.call(this),this._deletableLayers.on("layeradd",this._enableLayerDelete,this).on("layerremove",this._disableLayerDelete,this))},disable:function(){this._enabled&&(this._deletableLayers.off("layeradd",this._enableLayerDelete,this).off("layerremove",this._disableLayerDelete,this),L.Handler.prototype.disable.call(this),this._map.fire(L.Draw.Event.DELETESTOP,{handler:this.type}),this.fire("disabled",{handler:this.type}))},addHooks:function(){var n=this._map;n&&(n.getContainer().focus(),this._deletableLayers.eachLayer(this._enableLayerDelete,this),this._deletedLayers=new L.LayerGroup,this._tooltip=new L.Draw.Tooltip(this._map),this._tooltip.updateContent({text:L.drawLocal.edit.handlers.remove.tooltip.text}),this._map.on("mousemove",this._onMouseMove,this))},removeHooks:function(){this._map&&(this._deletableLayers.eachLayer(this._disableLayerDelete,this),this._deletedLayers=null,this._tooltip.dispose(),this._tooltip=null,this._map.off("mousemove",this._onMouseMove,this))},revertLayers:function(){this._deletedLayers.eachLayer(function(n){this._deletableLayers.addLayer(n),n.fire("revert-deleted",{layer:n})},this)},save:function(){this._map.fire(L.Draw.Event.DELETED,{layers:this._deletedLayers})},removeAllLayers:function(){this._deletableLayers.eachLayer(function(n){this._removeLayer({layer:n})},this),this.save()},_enableLayerDelete:function(n){(n.layer||n.target||n).on("click",this._removeLayer,this)},_disableLayerDelete:function(n){var s=n.layer||n.target||n;s.off("click",this._removeLayer,this),this._deletedLayers.removeLayer(s)},_removeLayer:function(n){var s=n.layer||n.target||n;this._deletableLayers.removeLayer(s),this._deletedLayers.addLayer(s),s.fire("deleted")},_onMouseMove:function(n){this._tooltip.updatePosition(n.latlng)},_hasAvailableLayers:function(){return this._deletableLayers.getLayers().length!==0}})})(window,document);var Gi=N1(()=>X1),W1=to('<div class="controls svelte-n52n8r"><label>Latitude:</label> <input type="number" step="0.0001"> <label>Longitude:</label> <input type="number" step="0.0001"> <button>Move Map</button></div> <div style="height: 600px; width: 100%;" class="svelte-n52n8r"></div>',1);function $1(r,t){ll(t,!1);let e=Fu(t,"selectedLayer",8),i=rs(),n=rs(null),s=null,a=null,l=rs(52.474),f=rs(13.43);const d=Zy(),g=A=>{Vt(n)&&(s&&Vt(n).removeLayer(s),A?(s=Gi().tileLayer(A.value,{attribution:A.attribution}),s.addTo(Vt(n))):(s=Gi().tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:"&copy; OpenStreetMap contributors"}),s.addTo(Vt(n))))},m=A=>{a&&Vt(n).removeLayer(a),a=Gi().geoJSON(A,{style:{color:"blue",fillColor:"blue",fillOpacity:.6,weight:2}}).addTo(Vt(n))},v=A=>{if(!Vt(n)||!A||A.length<2)return;Vt(n).referenceMarker&&Vt(n).removeLayer(Vt(n).referenceMarker);const P=Gi().circleMarker([A[1],A[0]],{color:"red",fillColor:"red",fillOpacity:1,radius:6});X0(n,Vt(n).referenceMarker=P),P.addTo(Vt(n)),Vt(n).setView([A[1],A[0]],Vt(n).getZoom())};D1(()=>{Gi().GeometryUtil&&Gi(Gi().GeometryUtil.readableArea=function(q,U){const I=U?["m","ha","km"]:["ft","ac","mi"],O=U?[1e4,1e6]:[43560,27878400];let B=0;for(;q>O[B]&&B<O.length-1;)q/=O[B],B++;return`${q.toFixed(2)} ${I[B]}`}),Oe(n,Gi().map(Vt(i)).setView([Vt(l),Vt(f)],13)),g(e());const A=new(Gi()).FeatureGroup;Vt(n).addLayer(A);const P=new(Gi()).Control.Draw({draw:{polyline:!1,polygon:{shapeOptions:{color:"var(--highlite)",fillColor:"var(--highlite)",fillOpacity:.2,weight:2}},rectangle:{shapeOptions:{color:"var(--highlite)",fillColor:"var(--highlite)",fillOpacity:.2,weight:2}},circle:!0,marker:!1,circlemarker:!1},edit:{featureGroup:A,edit:{selectedPathOptions:{color:"var(--stroke)",fillColor:"var(--highlite)",fillOpacity:.2,weight:2}}}});Vt(n).addControl(P),Vt(n).on(Gi().Draw.Event.CREATED,q=>{const{layer:U}=q;A.clearLayers(),U.setStyle({color:"var(--stroke)",fillColor:"var(--highlite)",fillOpacity:.2,weight:2}),A.addLayer(U),d("shapeDrawn",{layer:U})}),Vt(n).on("draw:edited",q=>{q.layers.eachLayer(I=>{const O=Gi().GeometryUtil.geodesicArea(I.getLatLngs()[0]),B=I.getLatLngs()[0];d("shapeEdited",{layer:I,area:O,latlngs:B})})}),Vt(n).on("zoomend",()=>{d("mapZoomed",{zoom:Vt(n).getZoom()})})});function _(){Vt(n).setView([Vt(l),Vt(f)],13)}Ma(()=>Vt(n),()=>{hh.subscribe(A=>{A&&Vt(n)&&m(A)})}),Ma(()=>Vt(n),()=>{Wu.subscribe(A=>{A&&Vt(n)&&m(A)})}),Ma(()=>Vt(n),()=>{Uu.subscribe(A=>{A&&Vt(n)&&v(A)})}),Ma(()=>cd(e()),()=>{e()&&g(e())}),ad(),jh();var w=W1(),b=gf(w),S=ti(Hu(b),2),N=ti(S,4),k=ti(N,2),C=ti(b,2);A1(C,A=>Oe(i,A),()=>Vt(i)),Ef(S,()=>Vt(l),A=>Oe(l,A)),Ef(N,()=>Vt(f),A=>Oe(f,A)),Do("click",k,_),as(r,w),hl()}function bl(r){throw new Error('Could not dynamically require "'+r+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var mc={exports:{}};/*!

JSZip v3.10.1 - A JavaScript class for generating and reading zip files
<http://stuartk.com/jszip>

(c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.

JSZip uses the library pako released under the MIT license :
https://github.com/nodeca/pako/blob/main/LICENSE
*/var wp;function J1(){return wp||(wp=1,function(r,t){(function(e){r.exports=e()})(function(){return function e(i,n,s){function a(d,g){if(!n[d]){if(!i[d]){var m=typeof bl=="function"&&bl;if(!g&&m)return m(d,!0);if(l)return l(d,!0);var v=new Error("Cannot find module '"+d+"'");throw v.code="MODULE_NOT_FOUND",v}var _=n[d]={exports:{}};i[d][0].call(_.exports,function(w){var b=i[d][1][w];return a(b||w)},_,_.exports,e,i,n,s)}return n[d].exports}for(var l=typeof bl=="function"&&bl,f=0;f<s.length;f++)a(s[f]);return a}({1:[function(e,i,n){var s=e("./utils"),a=e("./support"),l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";n.encode=function(f){for(var d,g,m,v,_,w,b,S=[],N=0,k=f.length,C=k,A=s.getTypeOf(f)!=="string";N<f.length;)C=k-N,m=A?(d=f[N++],g=N<k?f[N++]:0,N<k?f[N++]:0):(d=f.charCodeAt(N++),g=N<k?f.charCodeAt(N++):0,N<k?f.charCodeAt(N++):0),v=d>>2,_=(3&d)<<4|g>>4,w=1<C?(15&g)<<2|m>>6:64,b=2<C?63&m:64,S.push(l.charAt(v)+l.charAt(_)+l.charAt(w)+l.charAt(b));return S.join("")},n.decode=function(f){var d,g,m,v,_,w,b=0,S=0,N="data:";if(f.substr(0,N.length)===N)throw new Error("Invalid base64 input, it looks like a data url.");var k,C=3*(f=f.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(f.charAt(f.length-1)===l.charAt(64)&&C--,f.charAt(f.length-2)===l.charAt(64)&&C--,C%1!=0)throw new Error("Invalid base64 input, bad content length.");for(k=a.uint8array?new Uint8Array(0|C):new Array(0|C);b<f.length;)d=l.indexOf(f.charAt(b++))<<2|(v=l.indexOf(f.charAt(b++)))>>4,g=(15&v)<<4|(_=l.indexOf(f.charAt(b++)))>>2,m=(3&_)<<6|(w=l.indexOf(f.charAt(b++))),k[S++]=d,_!==64&&(k[S++]=g),w!==64&&(k[S++]=m);return k}},{"./support":30,"./utils":32}],2:[function(e,i,n){var s=e("./external"),a=e("./stream/DataWorker"),l=e("./stream/Crc32Probe"),f=e("./stream/DataLengthProbe");function d(g,m,v,_,w){this.compressedSize=g,this.uncompressedSize=m,this.crc32=v,this.compression=_,this.compressedContent=w}d.prototype={getContentWorker:function(){var g=new a(s.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new f("data_length")),m=this;return g.on("end",function(){if(this.streamInfo.data_length!==m.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),g},getCompressedWorker:function(){return new a(s.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},d.createWorkerFrom=function(g,m,v){return g.pipe(new l).pipe(new f("uncompressedSize")).pipe(m.compressWorker(v)).pipe(new f("compressedSize")).withStreamInfo("compression",m)},i.exports=d},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(e,i,n){var s=e("./stream/GenericWorker");n.STORE={magic:"\0\0",compressWorker:function(){return new s("STORE compression")},uncompressWorker:function(){return new s("STORE decompression")}},n.DEFLATE=e("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(e,i,n){var s=e("./utils"),a=function(){for(var l,f=[],d=0;d<256;d++){l=d;for(var g=0;g<8;g++)l=1&l?3988292384^l>>>1:l>>>1;f[d]=l}return f}();i.exports=function(l,f){return l!==void 0&&l.length?s.getTypeOf(l)!=="string"?function(d,g,m,v){var _=a,w=v+m;d^=-1;for(var b=v;b<w;b++)d=d>>>8^_[255&(d^g[b])];return-1^d}(0|f,l,l.length,0):function(d,g,m,v){var _=a,w=v+m;d^=-1;for(var b=v;b<w;b++)d=d>>>8^_[255&(d^g.charCodeAt(b))];return-1^d}(0|f,l,l.length,0):0}},{"./utils":32}],5:[function(e,i,n){n.base64=!1,n.binary=!1,n.dir=!1,n.createFolders=!0,n.date=null,n.compression=null,n.compressionOptions=null,n.comment=null,n.unixPermissions=null,n.dosPermissions=null},{}],6:[function(e,i,n){var s=null;s=typeof Promise<"u"?Promise:e("lie"),i.exports={Promise:s}},{lie:37}],7:[function(e,i,n){var s=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",a=e("pako"),l=e("./utils"),f=e("./stream/GenericWorker"),d=s?"uint8array":"array";function g(m,v){f.call(this,"FlateWorker/"+m),this._pako=null,this._pakoAction=m,this._pakoOptions=v,this.meta={}}n.magic="\b\0",l.inherits(g,f),g.prototype.processChunk=function(m){this.meta=m.meta,this._pako===null&&this._createPako(),this._pako.push(l.transformTo(d,m.data),!1)},g.prototype.flush=function(){f.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},g.prototype.cleanUp=function(){f.prototype.cleanUp.call(this),this._pako=null},g.prototype._createPako=function(){this._pako=new a[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var m=this;this._pako.onData=function(v){m.push({data:v,meta:m.meta})}},n.compressWorker=function(m){return new g("Deflate",m)},n.uncompressWorker=function(){return new g("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(e,i,n){function s(_,w){var b,S="";for(b=0;b<w;b++)S+=String.fromCharCode(255&_),_>>>=8;return S}function a(_,w,b,S,N,k){var C,A,P=_.file,q=_.compression,U=k!==d.utf8encode,I=l.transformTo("string",k(P.name)),O=l.transformTo("string",d.utf8encode(P.name)),B=P.comment,V=l.transformTo("string",k(B)),z=l.transformTo("string",d.utf8encode(B)),W=O.length!==P.name.length,T=z.length!==B.length,$="",F="",X="",Y=P.dir,j=P.date,J={crc32:0,compressedSize:0,uncompressedSize:0};w&&!b||(J.crc32=_.crc32,J.compressedSize=_.compressedSize,J.uncompressedSize=_.uncompressedSize);var K=0;w&&(K|=8),U||!W&&!T||(K|=2048);var et=0,ft=0;Y&&(et|=16),N==="UNIX"?(ft=798,et|=function(ut,mt){var Et=ut;return ut||(Et=mt?16893:33204),(65535&Et)<<16}(P.unixPermissions,Y)):(ft=20,et|=function(ut){return 63&(ut||0)}(P.dosPermissions)),C=j.getUTCHours(),C<<=6,C|=j.getUTCMinutes(),C<<=5,C|=j.getUTCSeconds()/2,A=j.getUTCFullYear()-1980,A<<=4,A|=j.getUTCMonth()+1,A<<=5,A|=j.getUTCDate(),W&&(F=s(1,1)+s(g(I),4)+O,$+="up"+s(F.length,2)+F),T&&(X=s(1,1)+s(g(V),4)+z,$+="uc"+s(X.length,2)+X);var lt="";return lt+=`
\0`,lt+=s(K,2),lt+=q.magic,lt+=s(C,2),lt+=s(A,2),lt+=s(J.crc32,4),lt+=s(J.compressedSize,4),lt+=s(J.uncompressedSize,4),lt+=s(I.length,2),lt+=s($.length,2),{fileRecord:m.LOCAL_FILE_HEADER+lt+I+$,dirRecord:m.CENTRAL_FILE_HEADER+s(ft,2)+lt+s(V.length,2)+"\0\0\0\0"+s(et,4)+s(S,4)+I+$+V}}var l=e("../utils"),f=e("../stream/GenericWorker"),d=e("../utf8"),g=e("../crc32"),m=e("../signature");function v(_,w,b,S){f.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=w,this.zipPlatform=b,this.encodeFileName=S,this.streamFiles=_,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}l.inherits(v,f),v.prototype.push=function(_){var w=_.meta.percent||0,b=this.entriesCount,S=this._sources.length;this.accumulate?this.contentBuffer.push(_):(this.bytesWritten+=_.data.length,f.prototype.push.call(this,{data:_.data,meta:{currentFile:this.currentFile,percent:b?(w+100*(b-S-1))/b:100}}))},v.prototype.openedSource=function(_){this.currentSourceOffset=this.bytesWritten,this.currentFile=_.file.name;var w=this.streamFiles&&!_.file.dir;if(w){var b=a(_,w,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:b.fileRecord,meta:{percent:0}})}else this.accumulate=!0},v.prototype.closedSource=function(_){this.accumulate=!1;var w=this.streamFiles&&!_.file.dir,b=a(_,w,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(b.dirRecord),w)this.push({data:function(S){return m.DATA_DESCRIPTOR+s(S.crc32,4)+s(S.compressedSize,4)+s(S.uncompressedSize,4)}(_),meta:{percent:100}});else for(this.push({data:b.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},v.prototype.flush=function(){for(var _=this.bytesWritten,w=0;w<this.dirRecords.length;w++)this.push({data:this.dirRecords[w],meta:{percent:100}});var b=this.bytesWritten-_,S=function(N,k,C,A,P){var q=l.transformTo("string",P(A));return m.CENTRAL_DIRECTORY_END+"\0\0\0\0"+s(N,2)+s(N,2)+s(k,4)+s(C,4)+s(q.length,2)+q}(this.dirRecords.length,b,_,this.zipComment,this.encodeFileName);this.push({data:S,meta:{percent:100}})},v.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},v.prototype.registerPrevious=function(_){this._sources.push(_);var w=this;return _.on("data",function(b){w.processChunk(b)}),_.on("end",function(){w.closedSource(w.previous.streamInfo),w._sources.length?w.prepareNextSource():w.end()}),_.on("error",function(b){w.error(b)}),this},v.prototype.resume=function(){return!!f.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},v.prototype.error=function(_){var w=this._sources;if(!f.prototype.error.call(this,_))return!1;for(var b=0;b<w.length;b++)try{w[b].error(_)}catch{}return!0},v.prototype.lock=function(){f.prototype.lock.call(this);for(var _=this._sources,w=0;w<_.length;w++)_[w].lock()},i.exports=v},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(e,i,n){var s=e("../compressions"),a=e("./ZipFileWorker");n.generateWorker=function(l,f,d){var g=new a(f.streamFiles,d,f.platform,f.encodeFileName),m=0;try{l.forEach(function(v,_){m++;var w=function(k,C){var A=k||C,P=s[A];if(!P)throw new Error(A+" is not a valid compression method !");return P}(_.options.compression,f.compression),b=_.options.compressionOptions||f.compressionOptions||{},S=_.dir,N=_.date;_._compressWorker(w,b).withStreamInfo("file",{name:v,dir:S,date:N,comment:_.comment||"",unixPermissions:_.unixPermissions,dosPermissions:_.dosPermissions}).pipe(g)}),g.entriesCount=m}catch(v){g.error(v)}return g}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(e,i,n){function s(){if(!(this instanceof s))return new s;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var a=new s;for(var l in this)typeof this[l]!="function"&&(a[l]=this[l]);return a}}(s.prototype=e("./object")).loadAsync=e("./load"),s.support=e("./support"),s.defaults=e("./defaults"),s.version="3.10.1",s.loadAsync=function(a,l){return new s().loadAsync(a,l)},s.external=e("./external"),i.exports=s},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(e,i,n){var s=e("./utils"),a=e("./external"),l=e("./utf8"),f=e("./zipEntries"),d=e("./stream/Crc32Probe"),g=e("./nodejsUtils");function m(v){return new a.Promise(function(_,w){var b=v.decompressed.getContentWorker().pipe(new d);b.on("error",function(S){w(S)}).on("end",function(){b.streamInfo.crc32!==v.decompressed.crc32?w(new Error("Corrupted zip : CRC32 mismatch")):_()}).resume()})}i.exports=function(v,_){var w=this;return _=s.extend(_||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:l.utf8decode}),g.isNode&&g.isStream(v)?a.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):s.prepareContent("the loaded zip file",v,!0,_.optimizedBinaryString,_.base64).then(function(b){var S=new f(_);return S.load(b),S}).then(function(b){var S=[a.Promise.resolve(b)],N=b.files;if(_.checkCRC32)for(var k=0;k<N.length;k++)S.push(m(N[k]));return a.Promise.all(S)}).then(function(b){for(var S=b.shift(),N=S.files,k=0;k<N.length;k++){var C=N[k],A=C.fileNameStr,P=s.resolve(C.fileNameStr);w.file(P,C.decompressed,{binary:!0,optimizedBinaryString:!0,date:C.date,dir:C.dir,comment:C.fileCommentStr.length?C.fileCommentStr:null,unixPermissions:C.unixPermissions,dosPermissions:C.dosPermissions,createFolders:_.createFolders}),C.dir||(w.file(P).unsafeOriginalName=A)}return S.zipComment.length&&(w.comment=S.zipComment),w})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(e,i,n){var s=e("../utils"),a=e("../stream/GenericWorker");function l(f,d){a.call(this,"Nodejs stream input adapter for "+f),this._upstreamEnded=!1,this._bindStream(d)}s.inherits(l,a),l.prototype._bindStream=function(f){var d=this;(this._stream=f).pause(),f.on("data",function(g){d.push({data:g,meta:{percent:0}})}).on("error",function(g){d.isPaused?this.generatedError=g:d.error(g)}).on("end",function(){d.isPaused?d._upstreamEnded=!0:d.end()})},l.prototype.pause=function(){return!!a.prototype.pause.call(this)&&(this._stream.pause(),!0)},l.prototype.resume=function(){return!!a.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},i.exports=l},{"../stream/GenericWorker":28,"../utils":32}],13:[function(e,i,n){var s=e("readable-stream").Readable;function a(l,f,d){s.call(this,f),this._helper=l;var g=this;l.on("data",function(m,v){g.push(m)||g._helper.pause(),d&&d(v)}).on("error",function(m){g.emit("error",m)}).on("end",function(){g.push(null)})}e("../utils").inherits(a,s),a.prototype._read=function(){this._helper.resume()},i.exports=a},{"../utils":32,"readable-stream":16}],14:[function(e,i,n){i.exports={isNode:typeof Buffer<"u",newBufferFrom:function(s,a){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(s,a);if(typeof s=="number")throw new Error('The "data" argument must not be a number');return new Buffer(s,a)},allocBuffer:function(s){if(Buffer.alloc)return Buffer.alloc(s);var a=new Buffer(s);return a.fill(0),a},isBuffer:function(s){return Buffer.isBuffer(s)},isStream:function(s){return s&&typeof s.on=="function"&&typeof s.pause=="function"&&typeof s.resume=="function"}}},{}],15:[function(e,i,n){function s(P,q,U){var I,O=l.getTypeOf(q),B=l.extend(U||{},g);B.date=B.date||new Date,B.compression!==null&&(B.compression=B.compression.toUpperCase()),typeof B.unixPermissions=="string"&&(B.unixPermissions=parseInt(B.unixPermissions,8)),B.unixPermissions&&16384&B.unixPermissions&&(B.dir=!0),B.dosPermissions&&16&B.dosPermissions&&(B.dir=!0),B.dir&&(P=N(P)),B.createFolders&&(I=S(P))&&k.call(this,I,!0);var V=O==="string"&&B.binary===!1&&B.base64===!1;U&&U.binary!==void 0||(B.binary=!V),(q instanceof m&&q.uncompressedSize===0||B.dir||!q||q.length===0)&&(B.base64=!1,B.binary=!0,q="",B.compression="STORE",O="string");var z=null;z=q instanceof m||q instanceof f?q:w.isNode&&w.isStream(q)?new b(P,q):l.prepareContent(P,q,B.binary,B.optimizedBinaryString,B.base64);var W=new v(P,z,B);this.files[P]=W}var a=e("./utf8"),l=e("./utils"),f=e("./stream/GenericWorker"),d=e("./stream/StreamHelper"),g=e("./defaults"),m=e("./compressedObject"),v=e("./zipObject"),_=e("./generate"),w=e("./nodejsUtils"),b=e("./nodejs/NodejsStreamInputAdapter"),S=function(P){P.slice(-1)==="/"&&(P=P.substring(0,P.length-1));var q=P.lastIndexOf("/");return 0<q?P.substring(0,q):""},N=function(P){return P.slice(-1)!=="/"&&(P+="/"),P},k=function(P,q){return q=q!==void 0?q:g.createFolders,P=N(P),this.files[P]||s.call(this,P,null,{dir:!0,createFolders:q}),this.files[P]};function C(P){return Object.prototype.toString.call(P)==="[object RegExp]"}var A={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(P){var q,U,I;for(q in this.files)I=this.files[q],(U=q.slice(this.root.length,q.length))&&q.slice(0,this.root.length)===this.root&&P(U,I)},filter:function(P){var q=[];return this.forEach(function(U,I){P(U,I)&&q.push(I)}),q},file:function(P,q,U){if(arguments.length!==1)return P=this.root+P,s.call(this,P,q,U),this;if(C(P)){var I=P;return this.filter(function(B,V){return!V.dir&&I.test(B)})}var O=this.files[this.root+P];return O&&!O.dir?O:null},folder:function(P){if(!P)return this;if(C(P))return this.filter(function(O,B){return B.dir&&P.test(O)});var q=this.root+P,U=k.call(this,q),I=this.clone();return I.root=U.name,I},remove:function(P){P=this.root+P;var q=this.files[P];if(q||(P.slice(-1)!=="/"&&(P+="/"),q=this.files[P]),q&&!q.dir)delete this.files[P];else for(var U=this.filter(function(O,B){return B.name.slice(0,P.length)===P}),I=0;I<U.length;I++)delete this.files[U[I].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(P){var q,U={};try{if((U=l.extend(P||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:a.utf8encode})).type=U.type.toLowerCase(),U.compression=U.compression.toUpperCase(),U.type==="binarystring"&&(U.type="string"),!U.type)throw new Error("No output type specified.");l.checkSupport(U.type),U.platform!=="darwin"&&U.platform!=="freebsd"&&U.platform!=="linux"&&U.platform!=="sunos"||(U.platform="UNIX"),U.platform==="win32"&&(U.platform="DOS");var I=U.comment||this.comment||"";q=_.generateWorker(this,U,I)}catch(O){(q=new f("error")).error(O)}return new d(q,U.type||"string",U.mimeType)},generateAsync:function(P,q){return this.generateInternalStream(P).accumulate(q)},generateNodeStream:function(P,q){return(P=P||{}).type||(P.type="nodebuffer"),this.generateInternalStream(P).toNodejsStream(q)}};i.exports=A},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(e,i,n){i.exports=e("stream")},{stream:void 0}],17:[function(e,i,n){var s=e("./DataReader");function a(l){s.call(this,l);for(var f=0;f<this.data.length;f++)l[f]=255&l[f]}e("../utils").inherits(a,s),a.prototype.byteAt=function(l){return this.data[this.zero+l]},a.prototype.lastIndexOfSignature=function(l){for(var f=l.charCodeAt(0),d=l.charCodeAt(1),g=l.charCodeAt(2),m=l.charCodeAt(3),v=this.length-4;0<=v;--v)if(this.data[v]===f&&this.data[v+1]===d&&this.data[v+2]===g&&this.data[v+3]===m)return v-this.zero;return-1},a.prototype.readAndCheckSignature=function(l){var f=l.charCodeAt(0),d=l.charCodeAt(1),g=l.charCodeAt(2),m=l.charCodeAt(3),v=this.readData(4);return f===v[0]&&d===v[1]&&g===v[2]&&m===v[3]},a.prototype.readData=function(l){if(this.checkOffset(l),l===0)return[];var f=this.data.slice(this.zero+this.index,this.zero+this.index+l);return this.index+=l,f},i.exports=a},{"../utils":32,"./DataReader":18}],18:[function(e,i,n){var s=e("../utils");function a(l){this.data=l,this.length=l.length,this.index=0,this.zero=0}a.prototype={checkOffset:function(l){this.checkIndex(this.index+l)},checkIndex:function(l){if(this.length<this.zero+l||l<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+l+"). Corrupted zip ?")},setIndex:function(l){this.checkIndex(l),this.index=l},skip:function(l){this.setIndex(this.index+l)},byteAt:function(){},readInt:function(l){var f,d=0;for(this.checkOffset(l),f=this.index+l-1;f>=this.index;f--)d=(d<<8)+this.byteAt(f);return this.index+=l,d},readString:function(l){return s.transformTo("string",this.readData(l))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var l=this.readInt(4);return new Date(Date.UTC(1980+(l>>25&127),(l>>21&15)-1,l>>16&31,l>>11&31,l>>5&63,(31&l)<<1))}},i.exports=a},{"../utils":32}],19:[function(e,i,n){var s=e("./Uint8ArrayReader");function a(l){s.call(this,l)}e("../utils").inherits(a,s),a.prototype.readData=function(l){this.checkOffset(l);var f=this.data.slice(this.zero+this.index,this.zero+this.index+l);return this.index+=l,f},i.exports=a},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(e,i,n){var s=e("./DataReader");function a(l){s.call(this,l)}e("../utils").inherits(a,s),a.prototype.byteAt=function(l){return this.data.charCodeAt(this.zero+l)},a.prototype.lastIndexOfSignature=function(l){return this.data.lastIndexOf(l)-this.zero},a.prototype.readAndCheckSignature=function(l){return l===this.readData(4)},a.prototype.readData=function(l){this.checkOffset(l);var f=this.data.slice(this.zero+this.index,this.zero+this.index+l);return this.index+=l,f},i.exports=a},{"../utils":32,"./DataReader":18}],21:[function(e,i,n){var s=e("./ArrayReader");function a(l){s.call(this,l)}e("../utils").inherits(a,s),a.prototype.readData=function(l){if(this.checkOffset(l),l===0)return new Uint8Array(0);var f=this.data.subarray(this.zero+this.index,this.zero+this.index+l);return this.index+=l,f},i.exports=a},{"../utils":32,"./ArrayReader":17}],22:[function(e,i,n){var s=e("../utils"),a=e("../support"),l=e("./ArrayReader"),f=e("./StringReader"),d=e("./NodeBufferReader"),g=e("./Uint8ArrayReader");i.exports=function(m){var v=s.getTypeOf(m);return s.checkSupport(v),v!=="string"||a.uint8array?v==="nodebuffer"?new d(m):a.uint8array?new g(s.transformTo("uint8array",m)):new l(s.transformTo("array",m)):new f(m)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(e,i,n){n.LOCAL_FILE_HEADER="PK",n.CENTRAL_FILE_HEADER="PK",n.CENTRAL_DIRECTORY_END="PK",n.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",n.ZIP64_CENTRAL_DIRECTORY_END="PK",n.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(e,i,n){var s=e("./GenericWorker"),a=e("../utils");function l(f){s.call(this,"ConvertWorker to "+f),this.destType=f}a.inherits(l,s),l.prototype.processChunk=function(f){this.push({data:a.transformTo(this.destType,f.data),meta:f.meta})},i.exports=l},{"../utils":32,"./GenericWorker":28}],25:[function(e,i,n){var s=e("./GenericWorker"),a=e("../crc32");function l(){s.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}e("../utils").inherits(l,s),l.prototype.processChunk=function(f){this.streamInfo.crc32=a(f.data,this.streamInfo.crc32||0),this.push(f)},i.exports=l},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(e,i,n){var s=e("../utils"),a=e("./GenericWorker");function l(f){a.call(this,"DataLengthProbe for "+f),this.propName=f,this.withStreamInfo(f,0)}s.inherits(l,a),l.prototype.processChunk=function(f){if(f){var d=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=d+f.data.length}a.prototype.processChunk.call(this,f)},i.exports=l},{"../utils":32,"./GenericWorker":28}],27:[function(e,i,n){var s=e("../utils"),a=e("./GenericWorker");function l(f){a.call(this,"DataWorker");var d=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,f.then(function(g){d.dataIsReady=!0,d.data=g,d.max=g&&g.length||0,d.type=s.getTypeOf(g),d.isPaused||d._tickAndRepeat()},function(g){d.error(g)})}s.inherits(l,a),l.prototype.cleanUp=function(){a.prototype.cleanUp.call(this),this.data=null},l.prototype.resume=function(){return!!a.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,s.delay(this._tickAndRepeat,[],this)),!0)},l.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(s.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},l.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var f=null,d=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":f=this.data.substring(this.index,d);break;case"uint8array":f=this.data.subarray(this.index,d);break;case"array":case"nodebuffer":f=this.data.slice(this.index,d)}return this.index=d,this.push({data:f,meta:{percent:this.max?this.index/this.max*100:0}})},i.exports=l},{"../utils":32,"./GenericWorker":28}],28:[function(e,i,n){function s(a){this.name=a||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}s.prototype={push:function(a){this.emit("data",a)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(a){this.emit("error",a)}return!0},error:function(a){return!this.isFinished&&(this.isPaused?this.generatedError=a:(this.isFinished=!0,this.emit("error",a),this.previous&&this.previous.error(a),this.cleanUp()),!0)},on:function(a,l){return this._listeners[a].push(l),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(a,l){if(this._listeners[a])for(var f=0;f<this._listeners[a].length;f++)this._listeners[a][f].call(this,l)},pipe:function(a){return a.registerPrevious(this)},registerPrevious:function(a){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=a.streamInfo,this.mergeStreamInfo(),this.previous=a;var l=this;return a.on("data",function(f){l.processChunk(f)}),a.on("end",function(){l.end()}),a.on("error",function(f){l.error(f)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var a=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),a=!0),this.previous&&this.previous.resume(),!a},flush:function(){},processChunk:function(a){this.push(a)},withStreamInfo:function(a,l){return this.extraStreamInfo[a]=l,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var a in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,a)&&(this.streamInfo[a]=this.extraStreamInfo[a])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var a="Worker "+this.name;return this.previous?this.previous+" -> "+a:a}},i.exports=s},{}],29:[function(e,i,n){var s=e("../utils"),a=e("./ConvertWorker"),l=e("./GenericWorker"),f=e("../base64"),d=e("../support"),g=e("../external"),m=null;if(d.nodestream)try{m=e("../nodejs/NodejsStreamOutputAdapter")}catch{}function v(w,b){return new g.Promise(function(S,N){var k=[],C=w._internalType,A=w._outputType,P=w._mimeType;w.on("data",function(q,U){k.push(q),b&&b(U)}).on("error",function(q){k=[],N(q)}).on("end",function(){try{var q=function(U,I,O){switch(U){case"blob":return s.newBlob(s.transformTo("arraybuffer",I),O);case"base64":return f.encode(I);default:return s.transformTo(U,I)}}(A,function(U,I){var O,B=0,V=null,z=0;for(O=0;O<I.length;O++)z+=I[O].length;switch(U){case"string":return I.join("");case"array":return Array.prototype.concat.apply([],I);case"uint8array":for(V=new Uint8Array(z),O=0;O<I.length;O++)V.set(I[O],B),B+=I[O].length;return V;case"nodebuffer":return Buffer.concat(I);default:throw new Error("concat : unsupported type '"+U+"'")}}(C,k),P);S(q)}catch(U){N(U)}k=[]}).resume()})}function _(w,b,S){var N=b;switch(b){case"blob":case"arraybuffer":N="uint8array";break;case"base64":N="string"}try{this._internalType=N,this._outputType=b,this._mimeType=S,s.checkSupport(N),this._worker=w.pipe(new a(N)),w.lock()}catch(k){this._worker=new l("error"),this._worker.error(k)}}_.prototype={accumulate:function(w){return v(this,w)},on:function(w,b){var S=this;return w==="data"?this._worker.on(w,function(N){b.call(S,N.data,N.meta)}):this._worker.on(w,function(){s.delay(b,arguments,S)}),this},resume:function(){return s.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(w){if(s.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new m(this,{objectMode:this._outputType!=="nodebuffer"},w)}},i.exports=_},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(e,i,n){if(n.base64=!0,n.array=!0,n.string=!0,n.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",n.nodebuffer=typeof Buffer<"u",n.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")n.blob=!1;else{var s=new ArrayBuffer(0);try{n.blob=new Blob([s],{type:"application/zip"}).size===0}catch{try{var a=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);a.append(s),n.blob=a.getBlob("application/zip").size===0}catch{n.blob=!1}}}try{n.nodestream=!!e("readable-stream").Readable}catch{n.nodestream=!1}},{"readable-stream":16}],31:[function(e,i,n){for(var s=e("./utils"),a=e("./support"),l=e("./nodejsUtils"),f=e("./stream/GenericWorker"),d=new Array(256),g=0;g<256;g++)d[g]=252<=g?6:248<=g?5:240<=g?4:224<=g?3:192<=g?2:1;d[254]=d[254]=1;function m(){f.call(this,"utf-8 decode"),this.leftOver=null}function v(){f.call(this,"utf-8 encode")}n.utf8encode=function(_){return a.nodebuffer?l.newBufferFrom(_,"utf-8"):function(w){var b,S,N,k,C,A=w.length,P=0;for(k=0;k<A;k++)(64512&(S=w.charCodeAt(k)))==55296&&k+1<A&&(64512&(N=w.charCodeAt(k+1)))==56320&&(S=65536+(S-55296<<10)+(N-56320),k++),P+=S<128?1:S<2048?2:S<65536?3:4;for(b=a.uint8array?new Uint8Array(P):new Array(P),k=C=0;C<P;k++)(64512&(S=w.charCodeAt(k)))==55296&&k+1<A&&(64512&(N=w.charCodeAt(k+1)))==56320&&(S=65536+(S-55296<<10)+(N-56320),k++),S<128?b[C++]=S:(S<2048?b[C++]=192|S>>>6:(S<65536?b[C++]=224|S>>>12:(b[C++]=240|S>>>18,b[C++]=128|S>>>12&63),b[C++]=128|S>>>6&63),b[C++]=128|63&S);return b}(_)},n.utf8decode=function(_){return a.nodebuffer?s.transformTo("nodebuffer",_).toString("utf-8"):function(w){var b,S,N,k,C=w.length,A=new Array(2*C);for(b=S=0;b<C;)if((N=w[b++])<128)A[S++]=N;else if(4<(k=d[N]))A[S++]=65533,b+=k-1;else{for(N&=k===2?31:k===3?15:7;1<k&&b<C;)N=N<<6|63&w[b++],k--;1<k?A[S++]=65533:N<65536?A[S++]=N:(N-=65536,A[S++]=55296|N>>10&1023,A[S++]=56320|1023&N)}return A.length!==S&&(A.subarray?A=A.subarray(0,S):A.length=S),s.applyFromCharCode(A)}(_=s.transformTo(a.uint8array?"uint8array":"array",_))},s.inherits(m,f),m.prototype.processChunk=function(_){var w=s.transformTo(a.uint8array?"uint8array":"array",_.data);if(this.leftOver&&this.leftOver.length){if(a.uint8array){var b=w;(w=new Uint8Array(b.length+this.leftOver.length)).set(this.leftOver,0),w.set(b,this.leftOver.length)}else w=this.leftOver.concat(w);this.leftOver=null}var S=function(k,C){var A;for((C=C||k.length)>k.length&&(C=k.length),A=C-1;0<=A&&(192&k[A])==128;)A--;return A<0||A===0?C:A+d[k[A]]>C?A:C}(w),N=w;S!==w.length&&(a.uint8array?(N=w.subarray(0,S),this.leftOver=w.subarray(S,w.length)):(N=w.slice(0,S),this.leftOver=w.slice(S,w.length))),this.push({data:n.utf8decode(N),meta:_.meta})},m.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:n.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},n.Utf8DecodeWorker=m,s.inherits(v,f),v.prototype.processChunk=function(_){this.push({data:n.utf8encode(_.data),meta:_.meta})},n.Utf8EncodeWorker=v},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(e,i,n){var s=e("./support"),a=e("./base64"),l=e("./nodejsUtils"),f=e("./external");function d(b){return b}function g(b,S){for(var N=0;N<b.length;++N)S[N]=255&b.charCodeAt(N);return S}e("setimmediate"),n.newBlob=function(b,S){n.checkSupport("blob");try{return new Blob([b],{type:S})}catch{try{var N=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return N.append(b),N.getBlob(S)}catch{throw new Error("Bug : can't construct the Blob.")}}};var m={stringifyByChunk:function(b,S,N){var k=[],C=0,A=b.length;if(A<=N)return String.fromCharCode.apply(null,b);for(;C<A;)S==="array"||S==="nodebuffer"?k.push(String.fromCharCode.apply(null,b.slice(C,Math.min(C+N,A)))):k.push(String.fromCharCode.apply(null,b.subarray(C,Math.min(C+N,A)))),C+=N;return k.join("")},stringifyByChar:function(b){for(var S="",N=0;N<b.length;N++)S+=String.fromCharCode(b[N]);return S},applyCanBeUsed:{uint8array:function(){try{return s.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}}(),nodebuffer:function(){try{return s.nodebuffer&&String.fromCharCode.apply(null,l.allocBuffer(1)).length===1}catch{return!1}}()}};function v(b){var S=65536,N=n.getTypeOf(b),k=!0;if(N==="uint8array"?k=m.applyCanBeUsed.uint8array:N==="nodebuffer"&&(k=m.applyCanBeUsed.nodebuffer),k)for(;1<S;)try{return m.stringifyByChunk(b,N,S)}catch{S=Math.floor(S/2)}return m.stringifyByChar(b)}function _(b,S){for(var N=0;N<b.length;N++)S[N]=b[N];return S}n.applyFromCharCode=v;var w={};w.string={string:d,array:function(b){return g(b,new Array(b.length))},arraybuffer:function(b){return w.string.uint8array(b).buffer},uint8array:function(b){return g(b,new Uint8Array(b.length))},nodebuffer:function(b){return g(b,l.allocBuffer(b.length))}},w.array={string:v,array:d,arraybuffer:function(b){return new Uint8Array(b).buffer},uint8array:function(b){return new Uint8Array(b)},nodebuffer:function(b){return l.newBufferFrom(b)}},w.arraybuffer={string:function(b){return v(new Uint8Array(b))},array:function(b){return _(new Uint8Array(b),new Array(b.byteLength))},arraybuffer:d,uint8array:function(b){return new Uint8Array(b)},nodebuffer:function(b){return l.newBufferFrom(new Uint8Array(b))}},w.uint8array={string:v,array:function(b){return _(b,new Array(b.length))},arraybuffer:function(b){return b.buffer},uint8array:d,nodebuffer:function(b){return l.newBufferFrom(b)}},w.nodebuffer={string:v,array:function(b){return _(b,new Array(b.length))},arraybuffer:function(b){return w.nodebuffer.uint8array(b).buffer},uint8array:function(b){return _(b,new Uint8Array(b.length))},nodebuffer:d},n.transformTo=function(b,S){if(S=S||"",!b)return S;n.checkSupport(b);var N=n.getTypeOf(S);return w[N][b](S)},n.resolve=function(b){for(var S=b.split("/"),N=[],k=0;k<S.length;k++){var C=S[k];C==="."||C===""&&k!==0&&k!==S.length-1||(C===".."?N.pop():N.push(C))}return N.join("/")},n.getTypeOf=function(b){return typeof b=="string"?"string":Object.prototype.toString.call(b)==="[object Array]"?"array":s.nodebuffer&&l.isBuffer(b)?"nodebuffer":s.uint8array&&b instanceof Uint8Array?"uint8array":s.arraybuffer&&b instanceof ArrayBuffer?"arraybuffer":void 0},n.checkSupport=function(b){if(!s[b.toLowerCase()])throw new Error(b+" is not supported by this platform")},n.MAX_VALUE_16BITS=65535,n.MAX_VALUE_32BITS=-1,n.pretty=function(b){var S,N,k="";for(N=0;N<(b||"").length;N++)k+="\\x"+((S=b.charCodeAt(N))<16?"0":"")+S.toString(16).toUpperCase();return k},n.delay=function(b,S,N){setImmediate(function(){b.apply(N||null,S||[])})},n.inherits=function(b,S){function N(){}N.prototype=S.prototype,b.prototype=new N},n.extend=function(){var b,S,N={};for(b=0;b<arguments.length;b++)for(S in arguments[b])Object.prototype.hasOwnProperty.call(arguments[b],S)&&N[S]===void 0&&(N[S]=arguments[b][S]);return N},n.prepareContent=function(b,S,N,k,C){return f.Promise.resolve(S).then(function(A){return s.blob&&(A instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(A))!==-1)&&typeof FileReader<"u"?new f.Promise(function(P,q){var U=new FileReader;U.onload=function(I){P(I.target.result)},U.onerror=function(I){q(I.target.error)},U.readAsArrayBuffer(A)}):A}).then(function(A){var P=n.getTypeOf(A);return P?(P==="arraybuffer"?A=n.transformTo("uint8array",A):P==="string"&&(C?A=a.decode(A):N&&k!==!0&&(A=function(q){return g(q,s.uint8array?new Uint8Array(q.length):new Array(q.length))}(A))),A):f.Promise.reject(new Error("Can't read the data of '"+b+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(e,i,n){var s=e("./reader/readerFor"),a=e("./utils"),l=e("./signature"),f=e("./zipEntry"),d=e("./support");function g(m){this.files=[],this.loadOptions=m}g.prototype={checkSignature:function(m){if(!this.reader.readAndCheckSignature(m)){this.reader.index-=4;var v=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+a.pretty(v)+", expected "+a.pretty(m)+")")}},isSignature:function(m,v){var _=this.reader.index;this.reader.setIndex(m);var w=this.reader.readString(4)===v;return this.reader.setIndex(_),w},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var m=this.reader.readData(this.zipCommentLength),v=d.uint8array?"uint8array":"array",_=a.transformTo(v,m);this.zipComment=this.loadOptions.decodeFileName(_)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var m,v,_,w=this.zip64EndOfCentralSize-44;0<w;)m=this.reader.readInt(2),v=this.reader.readInt(4),_=this.reader.readData(v),this.zip64ExtensibleData[m]={id:m,length:v,value:_}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var m,v;for(m=0;m<this.files.length;m++)v=this.files[m],this.reader.setIndex(v.localHeaderOffset),this.checkSignature(l.LOCAL_FILE_HEADER),v.readLocalPart(this.reader),v.handleUTF8(),v.processAttributes()},readCentralDir:function(){var m;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(l.CENTRAL_FILE_HEADER);)(m=new f({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(m);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var m=this.reader.lastIndexOfSignature(l.CENTRAL_DIRECTORY_END);if(m<0)throw this.isSignature(0,l.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(m);var v=m;if(this.checkSignature(l.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===a.MAX_VALUE_16BITS||this.diskWithCentralDirStart===a.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===a.MAX_VALUE_16BITS||this.centralDirRecords===a.MAX_VALUE_16BITS||this.centralDirSize===a.MAX_VALUE_32BITS||this.centralDirOffset===a.MAX_VALUE_32BITS){if(this.zip64=!0,(m=this.reader.lastIndexOfSignature(l.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(m),this.checkSignature(l.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,l.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(l.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(l.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var _=this.centralDirOffset+this.centralDirSize;this.zip64&&(_+=20,_+=12+this.zip64EndOfCentralSize);var w=v-_;if(0<w)this.isSignature(v,l.CENTRAL_FILE_HEADER)||(this.reader.zero=w);else if(w<0)throw new Error("Corrupted zip: missing "+Math.abs(w)+" bytes.")},prepareReader:function(m){this.reader=s(m)},load:function(m){this.prepareReader(m),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},i.exports=g},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(e,i,n){var s=e("./reader/readerFor"),a=e("./utils"),l=e("./compressedObject"),f=e("./crc32"),d=e("./utf8"),g=e("./compressions"),m=e("./support");function v(_,w){this.options=_,this.loadOptions=w}v.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(_){var w,b;if(_.skip(22),this.fileNameLength=_.readInt(2),b=_.readInt(2),this.fileName=_.readData(this.fileNameLength),_.skip(b),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((w=function(S){for(var N in g)if(Object.prototype.hasOwnProperty.call(g,N)&&g[N].magic===S)return g[N];return null}(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+a.pretty(this.compressionMethod)+" unknown (inner file : "+a.transformTo("string",this.fileName)+")");this.decompressed=new l(this.compressedSize,this.uncompressedSize,this.crc32,w,_.readData(this.compressedSize))},readCentralPart:function(_){this.versionMadeBy=_.readInt(2),_.skip(2),this.bitFlag=_.readInt(2),this.compressionMethod=_.readString(2),this.date=_.readDate(),this.crc32=_.readInt(4),this.compressedSize=_.readInt(4),this.uncompressedSize=_.readInt(4);var w=_.readInt(2);if(this.extraFieldsLength=_.readInt(2),this.fileCommentLength=_.readInt(2),this.diskNumberStart=_.readInt(2),this.internalFileAttributes=_.readInt(2),this.externalFileAttributes=_.readInt(4),this.localHeaderOffset=_.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");_.skip(w),this.readExtraFields(_),this.parseZIP64ExtraField(_),this.fileComment=_.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var _=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),_==0&&(this.dosPermissions=63&this.externalFileAttributes),_==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var _=s(this.extraFields[1].value);this.uncompressedSize===a.MAX_VALUE_32BITS&&(this.uncompressedSize=_.readInt(8)),this.compressedSize===a.MAX_VALUE_32BITS&&(this.compressedSize=_.readInt(8)),this.localHeaderOffset===a.MAX_VALUE_32BITS&&(this.localHeaderOffset=_.readInt(8)),this.diskNumberStart===a.MAX_VALUE_32BITS&&(this.diskNumberStart=_.readInt(4))}},readExtraFields:function(_){var w,b,S,N=_.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});_.index+4<N;)w=_.readInt(2),b=_.readInt(2),S=_.readData(b),this.extraFields[w]={id:w,length:b,value:S};_.setIndex(N)},handleUTF8:function(){var _=m.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=d.utf8decode(this.fileName),this.fileCommentStr=d.utf8decode(this.fileComment);else{var w=this.findExtraFieldUnicodePath();if(w!==null)this.fileNameStr=w;else{var b=a.transformTo(_,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(b)}var S=this.findExtraFieldUnicodeComment();if(S!==null)this.fileCommentStr=S;else{var N=a.transformTo(_,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(N)}}},findExtraFieldUnicodePath:function(){var _=this.extraFields[28789];if(_){var w=s(_.value);return w.readInt(1)!==1||f(this.fileName)!==w.readInt(4)?null:d.utf8decode(w.readData(_.length-5))}return null},findExtraFieldUnicodeComment:function(){var _=this.extraFields[25461];if(_){var w=s(_.value);return w.readInt(1)!==1||f(this.fileComment)!==w.readInt(4)?null:d.utf8decode(w.readData(_.length-5))}return null}},i.exports=v},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(e,i,n){function s(w,b,S){this.name=w,this.dir=S.dir,this.date=S.date,this.comment=S.comment,this.unixPermissions=S.unixPermissions,this.dosPermissions=S.dosPermissions,this._data=b,this._dataBinary=S.binary,this.options={compression:S.compression,compressionOptions:S.compressionOptions}}var a=e("./stream/StreamHelper"),l=e("./stream/DataWorker"),f=e("./utf8"),d=e("./compressedObject"),g=e("./stream/GenericWorker");s.prototype={internalStream:function(w){var b=null,S="string";try{if(!w)throw new Error("No output type specified.");var N=(S=w.toLowerCase())==="string"||S==="text";S!=="binarystring"&&S!=="text"||(S="string"),b=this._decompressWorker();var k=!this._dataBinary;k&&!N&&(b=b.pipe(new f.Utf8EncodeWorker)),!k&&N&&(b=b.pipe(new f.Utf8DecodeWorker))}catch(C){(b=new g("error")).error(C)}return new a(b,S,"")},async:function(w,b){return this.internalStream(w).accumulate(b)},nodeStream:function(w,b){return this.internalStream(w||"nodebuffer").toNodejsStream(b)},_compressWorker:function(w,b){if(this._data instanceof d&&this._data.compression.magic===w.magic)return this._data.getCompressedWorker();var S=this._decompressWorker();return this._dataBinary||(S=S.pipe(new f.Utf8EncodeWorker)),d.createWorkerFrom(S,w,b)},_decompressWorker:function(){return this._data instanceof d?this._data.getContentWorker():this._data instanceof g?this._data:new l(this._data)}};for(var m=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],v=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},_=0;_<m.length;_++)s.prototype[m[_]]=v;i.exports=s},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(e,i,n){(function(s){var a,l,f=s.MutationObserver||s.WebKitMutationObserver;if(f){var d=0,g=new f(w),m=s.document.createTextNode("");g.observe(m,{characterData:!0}),a=function(){m.data=d=++d%2}}else if(s.setImmediate||s.MessageChannel===void 0)a="document"in s&&"onreadystatechange"in s.document.createElement("script")?function(){var b=s.document.createElement("script");b.onreadystatechange=function(){w(),b.onreadystatechange=null,b.parentNode.removeChild(b),b=null},s.document.documentElement.appendChild(b)}:function(){setTimeout(w,0)};else{var v=new s.MessageChannel;v.port1.onmessage=w,a=function(){v.port2.postMessage(0)}}var _=[];function w(){var b,S;l=!0;for(var N=_.length;N;){for(S=_,_=[],b=-1;++b<N;)S[b]();N=_.length}l=!1}i.exports=function(b){_.push(b)!==1||l||a()}}).call(this,typeof Ys<"u"?Ys:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(e,i,n){var s=e("immediate");function a(){}var l={},f=["REJECTED"],d=["FULFILLED"],g=["PENDING"];function m(N){if(typeof N!="function")throw new TypeError("resolver must be a function");this.state=g,this.queue=[],this.outcome=void 0,N!==a&&b(this,N)}function v(N,k,C){this.promise=N,typeof k=="function"&&(this.onFulfilled=k,this.callFulfilled=this.otherCallFulfilled),typeof C=="function"&&(this.onRejected=C,this.callRejected=this.otherCallRejected)}function _(N,k,C){s(function(){var A;try{A=k(C)}catch(P){return l.reject(N,P)}A===N?l.reject(N,new TypeError("Cannot resolve promise with itself")):l.resolve(N,A)})}function w(N){var k=N&&N.then;if(N&&(typeof N=="object"||typeof N=="function")&&typeof k=="function")return function(){k.apply(N,arguments)}}function b(N,k){var C=!1;function A(U){C||(C=!0,l.reject(N,U))}function P(U){C||(C=!0,l.resolve(N,U))}var q=S(function(){k(P,A)});q.status==="error"&&A(q.value)}function S(N,k){var C={};try{C.value=N(k),C.status="success"}catch(A){C.status="error",C.value=A}return C}(i.exports=m).prototype.finally=function(N){if(typeof N!="function")return this;var k=this.constructor;return this.then(function(C){return k.resolve(N()).then(function(){return C})},function(C){return k.resolve(N()).then(function(){throw C})})},m.prototype.catch=function(N){return this.then(null,N)},m.prototype.then=function(N,k){if(typeof N!="function"&&this.state===d||typeof k!="function"&&this.state===f)return this;var C=new this.constructor(a);return this.state!==g?_(C,this.state===d?N:k,this.outcome):this.queue.push(new v(C,N,k)),C},v.prototype.callFulfilled=function(N){l.resolve(this.promise,N)},v.prototype.otherCallFulfilled=function(N){_(this.promise,this.onFulfilled,N)},v.prototype.callRejected=function(N){l.reject(this.promise,N)},v.prototype.otherCallRejected=function(N){_(this.promise,this.onRejected,N)},l.resolve=function(N,k){var C=S(w,k);if(C.status==="error")return l.reject(N,C.value);var A=C.value;if(A)b(N,A);else{N.state=d,N.outcome=k;for(var P=-1,q=N.queue.length;++P<q;)N.queue[P].callFulfilled(k)}return N},l.reject=function(N,k){N.state=f,N.outcome=k;for(var C=-1,A=N.queue.length;++C<A;)N.queue[C].callRejected(k);return N},m.resolve=function(N){return N instanceof this?N:l.resolve(new this(a),N)},m.reject=function(N){var k=new this(a);return l.reject(k,N)},m.all=function(N){var k=this;if(Object.prototype.toString.call(N)!=="[object Array]")return this.reject(new TypeError("must be an array"));var C=N.length,A=!1;if(!C)return this.resolve([]);for(var P=new Array(C),q=0,U=-1,I=new this(a);++U<C;)O(N[U],U);return I;function O(B,V){k.resolve(B).then(function(z){P[V]=z,++q!==C||A||(A=!0,l.resolve(I,P))},function(z){A||(A=!0,l.reject(I,z))})}},m.race=function(N){var k=this;if(Object.prototype.toString.call(N)!=="[object Array]")return this.reject(new TypeError("must be an array"));var C=N.length,A=!1;if(!C)return this.resolve([]);for(var P=-1,q=new this(a);++P<C;)U=N[P],k.resolve(U).then(function(I){A||(A=!0,l.resolve(q,I))},function(I){A||(A=!0,l.reject(q,I))});var U;return q}},{immediate:36}],38:[function(e,i,n){var s={};(0,e("./lib/utils/common").assign)(s,e("./lib/deflate"),e("./lib/inflate"),e("./lib/zlib/constants")),i.exports=s},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(e,i,n){var s=e("./zlib/deflate"),a=e("./utils/common"),l=e("./utils/strings"),f=e("./zlib/messages"),d=e("./zlib/zstream"),g=Object.prototype.toString,m=0,v=-1,_=0,w=8;function b(N){if(!(this instanceof b))return new b(N);this.options=a.assign({level:v,method:w,chunkSize:16384,windowBits:15,memLevel:8,strategy:_,to:""},N||{});var k=this.options;k.raw&&0<k.windowBits?k.windowBits=-k.windowBits:k.gzip&&0<k.windowBits&&k.windowBits<16&&(k.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new d,this.strm.avail_out=0;var C=s.deflateInit2(this.strm,k.level,k.method,k.windowBits,k.memLevel,k.strategy);if(C!==m)throw new Error(f[C]);if(k.header&&s.deflateSetHeader(this.strm,k.header),k.dictionary){var A;if(A=typeof k.dictionary=="string"?l.string2buf(k.dictionary):g.call(k.dictionary)==="[object ArrayBuffer]"?new Uint8Array(k.dictionary):k.dictionary,(C=s.deflateSetDictionary(this.strm,A))!==m)throw new Error(f[C]);this._dict_set=!0}}function S(N,k){var C=new b(k);if(C.push(N,!0),C.err)throw C.msg||f[C.err];return C.result}b.prototype.push=function(N,k){var C,A,P=this.strm,q=this.options.chunkSize;if(this.ended)return!1;A=k===~~k?k:k===!0?4:0,typeof N=="string"?P.input=l.string2buf(N):g.call(N)==="[object ArrayBuffer]"?P.input=new Uint8Array(N):P.input=N,P.next_in=0,P.avail_in=P.input.length;do{if(P.avail_out===0&&(P.output=new a.Buf8(q),P.next_out=0,P.avail_out=q),(C=s.deflate(P,A))!==1&&C!==m)return this.onEnd(C),!(this.ended=!0);P.avail_out!==0&&(P.avail_in!==0||A!==4&&A!==2)||(this.options.to==="string"?this.onData(l.buf2binstring(a.shrinkBuf(P.output,P.next_out))):this.onData(a.shrinkBuf(P.output,P.next_out)))}while((0<P.avail_in||P.avail_out===0)&&C!==1);return A===4?(C=s.deflateEnd(this.strm),this.onEnd(C),this.ended=!0,C===m):A!==2||(this.onEnd(m),!(P.avail_out=0))},b.prototype.onData=function(N){this.chunks.push(N)},b.prototype.onEnd=function(N){N===m&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=a.flattenChunks(this.chunks)),this.chunks=[],this.err=N,this.msg=this.strm.msg},n.Deflate=b,n.deflate=S,n.deflateRaw=function(N,k){return(k=k||{}).raw=!0,S(N,k)},n.gzip=function(N,k){return(k=k||{}).gzip=!0,S(N,k)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(e,i,n){var s=e("./zlib/inflate"),a=e("./utils/common"),l=e("./utils/strings"),f=e("./zlib/constants"),d=e("./zlib/messages"),g=e("./zlib/zstream"),m=e("./zlib/gzheader"),v=Object.prototype.toString;function _(b){if(!(this instanceof _))return new _(b);this.options=a.assign({chunkSize:16384,windowBits:0,to:""},b||{});var S=this.options;S.raw&&0<=S.windowBits&&S.windowBits<16&&(S.windowBits=-S.windowBits,S.windowBits===0&&(S.windowBits=-15)),!(0<=S.windowBits&&S.windowBits<16)||b&&b.windowBits||(S.windowBits+=32),15<S.windowBits&&S.windowBits<48&&!(15&S.windowBits)&&(S.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new g,this.strm.avail_out=0;var N=s.inflateInit2(this.strm,S.windowBits);if(N!==f.Z_OK)throw new Error(d[N]);this.header=new m,s.inflateGetHeader(this.strm,this.header)}function w(b,S){var N=new _(S);if(N.push(b,!0),N.err)throw N.msg||d[N.err];return N.result}_.prototype.push=function(b,S){var N,k,C,A,P,q,U=this.strm,I=this.options.chunkSize,O=this.options.dictionary,B=!1;if(this.ended)return!1;k=S===~~S?S:S===!0?f.Z_FINISH:f.Z_NO_FLUSH,typeof b=="string"?U.input=l.binstring2buf(b):v.call(b)==="[object ArrayBuffer]"?U.input=new Uint8Array(b):U.input=b,U.next_in=0,U.avail_in=U.input.length;do{if(U.avail_out===0&&(U.output=new a.Buf8(I),U.next_out=0,U.avail_out=I),(N=s.inflate(U,f.Z_NO_FLUSH))===f.Z_NEED_DICT&&O&&(q=typeof O=="string"?l.string2buf(O):v.call(O)==="[object ArrayBuffer]"?new Uint8Array(O):O,N=s.inflateSetDictionary(this.strm,q)),N===f.Z_BUF_ERROR&&B===!0&&(N=f.Z_OK,B=!1),N!==f.Z_STREAM_END&&N!==f.Z_OK)return this.onEnd(N),!(this.ended=!0);U.next_out&&(U.avail_out!==0&&N!==f.Z_STREAM_END&&(U.avail_in!==0||k!==f.Z_FINISH&&k!==f.Z_SYNC_FLUSH)||(this.options.to==="string"?(C=l.utf8border(U.output,U.next_out),A=U.next_out-C,P=l.buf2string(U.output,C),U.next_out=A,U.avail_out=I-A,A&&a.arraySet(U.output,U.output,C,A,0),this.onData(P)):this.onData(a.shrinkBuf(U.output,U.next_out)))),U.avail_in===0&&U.avail_out===0&&(B=!0)}while((0<U.avail_in||U.avail_out===0)&&N!==f.Z_STREAM_END);return N===f.Z_STREAM_END&&(k=f.Z_FINISH),k===f.Z_FINISH?(N=s.inflateEnd(this.strm),this.onEnd(N),this.ended=!0,N===f.Z_OK):k!==f.Z_SYNC_FLUSH||(this.onEnd(f.Z_OK),!(U.avail_out=0))},_.prototype.onData=function(b){this.chunks.push(b)},_.prototype.onEnd=function(b){b===f.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=a.flattenChunks(this.chunks)),this.chunks=[],this.err=b,this.msg=this.strm.msg},n.Inflate=_,n.inflate=w,n.inflateRaw=function(b,S){return(S=S||{}).raw=!0,w(b,S)},n.ungzip=w},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(e,i,n){var s=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";n.assign=function(f){for(var d=Array.prototype.slice.call(arguments,1);d.length;){var g=d.shift();if(g){if(typeof g!="object")throw new TypeError(g+"must be non-object");for(var m in g)g.hasOwnProperty(m)&&(f[m]=g[m])}}return f},n.shrinkBuf=function(f,d){return f.length===d?f:f.subarray?f.subarray(0,d):(f.length=d,f)};var a={arraySet:function(f,d,g,m,v){if(d.subarray&&f.subarray)f.set(d.subarray(g,g+m),v);else for(var _=0;_<m;_++)f[v+_]=d[g+_]},flattenChunks:function(f){var d,g,m,v,_,w;for(d=m=0,g=f.length;d<g;d++)m+=f[d].length;for(w=new Uint8Array(m),d=v=0,g=f.length;d<g;d++)_=f[d],w.set(_,v),v+=_.length;return w}},l={arraySet:function(f,d,g,m,v){for(var _=0;_<m;_++)f[v+_]=d[g+_]},flattenChunks:function(f){return[].concat.apply([],f)}};n.setTyped=function(f){f?(n.Buf8=Uint8Array,n.Buf16=Uint16Array,n.Buf32=Int32Array,n.assign(n,a)):(n.Buf8=Array,n.Buf16=Array,n.Buf32=Array,n.assign(n,l))},n.setTyped(s)},{}],42:[function(e,i,n){var s=e("./common"),a=!0,l=!0;try{String.fromCharCode.apply(null,[0])}catch{a=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{l=!1}for(var f=new s.Buf8(256),d=0;d<256;d++)f[d]=252<=d?6:248<=d?5:240<=d?4:224<=d?3:192<=d?2:1;function g(m,v){if(v<65537&&(m.subarray&&l||!m.subarray&&a))return String.fromCharCode.apply(null,s.shrinkBuf(m,v));for(var _="",w=0;w<v;w++)_+=String.fromCharCode(m[w]);return _}f[254]=f[254]=1,n.string2buf=function(m){var v,_,w,b,S,N=m.length,k=0;for(b=0;b<N;b++)(64512&(_=m.charCodeAt(b)))==55296&&b+1<N&&(64512&(w=m.charCodeAt(b+1)))==56320&&(_=65536+(_-55296<<10)+(w-56320),b++),k+=_<128?1:_<2048?2:_<65536?3:4;for(v=new s.Buf8(k),b=S=0;S<k;b++)(64512&(_=m.charCodeAt(b)))==55296&&b+1<N&&(64512&(w=m.charCodeAt(b+1)))==56320&&(_=65536+(_-55296<<10)+(w-56320),b++),_<128?v[S++]=_:(_<2048?v[S++]=192|_>>>6:(_<65536?v[S++]=224|_>>>12:(v[S++]=240|_>>>18,v[S++]=128|_>>>12&63),v[S++]=128|_>>>6&63),v[S++]=128|63&_);return v},n.buf2binstring=function(m){return g(m,m.length)},n.binstring2buf=function(m){for(var v=new s.Buf8(m.length),_=0,w=v.length;_<w;_++)v[_]=m.charCodeAt(_);return v},n.buf2string=function(m,v){var _,w,b,S,N=v||m.length,k=new Array(2*N);for(_=w=0;_<N;)if((b=m[_++])<128)k[w++]=b;else if(4<(S=f[b]))k[w++]=65533,_+=S-1;else{for(b&=S===2?31:S===3?15:7;1<S&&_<N;)b=b<<6|63&m[_++],S--;1<S?k[w++]=65533:b<65536?k[w++]=b:(b-=65536,k[w++]=55296|b>>10&1023,k[w++]=56320|1023&b)}return g(k,w)},n.utf8border=function(m,v){var _;for((v=v||m.length)>m.length&&(v=m.length),_=v-1;0<=_&&(192&m[_])==128;)_--;return _<0||_===0?v:_+f[m[_]]>v?_:v}},{"./common":41}],43:[function(e,i,n){i.exports=function(s,a,l,f){for(var d=65535&s|0,g=s>>>16&65535|0,m=0;l!==0;){for(l-=m=2e3<l?2e3:l;g=g+(d=d+a[f++]|0)|0,--m;);d%=65521,g%=65521}return d|g<<16|0}},{}],44:[function(e,i,n){i.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(e,i,n){var s=function(){for(var a,l=[],f=0;f<256;f++){a=f;for(var d=0;d<8;d++)a=1&a?3988292384^a>>>1:a>>>1;l[f]=a}return l}();i.exports=function(a,l,f,d){var g=s,m=d+f;a^=-1;for(var v=d;v<m;v++)a=a>>>8^g[255&(a^l[v])];return-1^a}},{}],46:[function(e,i,n){var s,a=e("../utils/common"),l=e("./trees"),f=e("./adler32"),d=e("./crc32"),g=e("./messages"),m=0,v=4,_=0,w=-2,b=-1,S=4,N=2,k=8,C=9,A=286,P=30,q=19,U=2*A+1,I=15,O=3,B=258,V=B+O+1,z=42,W=113,T=1,$=2,F=3,X=4;function Y(G,ct){return G.msg=g[ct],ct}function j(G){return(G<<1)-(4<G?9:0)}function J(G){for(var ct=G.length;0<=--ct;)G[ct]=0}function K(G){var ct=G.state,ht=ct.pending;ht>G.avail_out&&(ht=G.avail_out),ht!==0&&(a.arraySet(G.output,ct.pending_buf,ct.pending_out,ht,G.next_out),G.next_out+=ht,ct.pending_out+=ht,G.total_out+=ht,G.avail_out-=ht,ct.pending-=ht,ct.pending===0&&(ct.pending_out=0))}function et(G,ct){l._tr_flush_block(G,0<=G.block_start?G.block_start:-1,G.strstart-G.block_start,ct),G.block_start=G.strstart,K(G.strm)}function ft(G,ct){G.pending_buf[G.pending++]=ct}function lt(G,ct){G.pending_buf[G.pending++]=ct>>>8&255,G.pending_buf[G.pending++]=255&ct}function ut(G,ct){var ht,ot,it=G.max_chain_length,st=G.strstart,kt=G.prev_length,Lt=G.nice_match,yt=G.strstart>G.w_size-V?G.strstart-(G.w_size-V):0,At=G.window,St=G.w_mask,Ct=G.prev,Bt=G.strstart+B,ue=At[st+kt-1],Pt=At[st+kt];G.prev_length>=G.good_match&&(it>>=2),Lt>G.lookahead&&(Lt=G.lookahead);do if(At[(ht=ct)+kt]===Pt&&At[ht+kt-1]===ue&&At[ht]===At[st]&&At[++ht]===At[st+1]){st+=2,ht++;do;while(At[++st]===At[++ht]&&At[++st]===At[++ht]&&At[++st]===At[++ht]&&At[++st]===At[++ht]&&At[++st]===At[++ht]&&At[++st]===At[++ht]&&At[++st]===At[++ht]&&At[++st]===At[++ht]&&st<Bt);if(ot=B-(Bt-st),st=Bt-B,kt<ot){if(G.match_start=ct,Lt<=(kt=ot))break;ue=At[st+kt-1],Pt=At[st+kt]}}while((ct=Ct[ct&St])>yt&&--it!=0);return kt<=G.lookahead?kt:G.lookahead}function mt(G){var ct,ht,ot,it,st,kt,Lt,yt,At,St,Ct=G.w_size;do{if(it=G.window_size-G.lookahead-G.strstart,G.strstart>=Ct+(Ct-V)){for(a.arraySet(G.window,G.window,Ct,Ct,0),G.match_start-=Ct,G.strstart-=Ct,G.block_start-=Ct,ct=ht=G.hash_size;ot=G.head[--ct],G.head[ct]=Ct<=ot?ot-Ct:0,--ht;);for(ct=ht=Ct;ot=G.prev[--ct],G.prev[ct]=Ct<=ot?ot-Ct:0,--ht;);it+=Ct}if(G.strm.avail_in===0)break;if(kt=G.strm,Lt=G.window,yt=G.strstart+G.lookahead,At=it,St=void 0,St=kt.avail_in,At<St&&(St=At),ht=St===0?0:(kt.avail_in-=St,a.arraySet(Lt,kt.input,kt.next_in,St,yt),kt.state.wrap===1?kt.adler=f(kt.adler,Lt,St,yt):kt.state.wrap===2&&(kt.adler=d(kt.adler,Lt,St,yt)),kt.next_in+=St,kt.total_in+=St,St),G.lookahead+=ht,G.lookahead+G.insert>=O)for(st=G.strstart-G.insert,G.ins_h=G.window[st],G.ins_h=(G.ins_h<<G.hash_shift^G.window[st+1])&G.hash_mask;G.insert&&(G.ins_h=(G.ins_h<<G.hash_shift^G.window[st+O-1])&G.hash_mask,G.prev[st&G.w_mask]=G.head[G.ins_h],G.head[G.ins_h]=st,st++,G.insert--,!(G.lookahead+G.insert<O)););}while(G.lookahead<V&&G.strm.avail_in!==0)}function Et(G,ct){for(var ht,ot;;){if(G.lookahead<V){if(mt(G),G.lookahead<V&&ct===m)return T;if(G.lookahead===0)break}if(ht=0,G.lookahead>=O&&(G.ins_h=(G.ins_h<<G.hash_shift^G.window[G.strstart+O-1])&G.hash_mask,ht=G.prev[G.strstart&G.w_mask]=G.head[G.ins_h],G.head[G.ins_h]=G.strstart),ht!==0&&G.strstart-ht<=G.w_size-V&&(G.match_length=ut(G,ht)),G.match_length>=O)if(ot=l._tr_tally(G,G.strstart-G.match_start,G.match_length-O),G.lookahead-=G.match_length,G.match_length<=G.max_lazy_match&&G.lookahead>=O){for(G.match_length--;G.strstart++,G.ins_h=(G.ins_h<<G.hash_shift^G.window[G.strstart+O-1])&G.hash_mask,ht=G.prev[G.strstart&G.w_mask]=G.head[G.ins_h],G.head[G.ins_h]=G.strstart,--G.match_length!=0;);G.strstart++}else G.strstart+=G.match_length,G.match_length=0,G.ins_h=G.window[G.strstart],G.ins_h=(G.ins_h<<G.hash_shift^G.window[G.strstart+1])&G.hash_mask;else ot=l._tr_tally(G,0,G.window[G.strstart]),G.lookahead--,G.strstart++;if(ot&&(et(G,!1),G.strm.avail_out===0))return T}return G.insert=G.strstart<O-1?G.strstart:O-1,ct===v?(et(G,!0),G.strm.avail_out===0?F:X):G.last_lit&&(et(G,!1),G.strm.avail_out===0)?T:$}function at(G,ct){for(var ht,ot,it;;){if(G.lookahead<V){if(mt(G),G.lookahead<V&&ct===m)return T;if(G.lookahead===0)break}if(ht=0,G.lookahead>=O&&(G.ins_h=(G.ins_h<<G.hash_shift^G.window[G.strstart+O-1])&G.hash_mask,ht=G.prev[G.strstart&G.w_mask]=G.head[G.ins_h],G.head[G.ins_h]=G.strstart),G.prev_length=G.match_length,G.prev_match=G.match_start,G.match_length=O-1,ht!==0&&G.prev_length<G.max_lazy_match&&G.strstart-ht<=G.w_size-V&&(G.match_length=ut(G,ht),G.match_length<=5&&(G.strategy===1||G.match_length===O&&4096<G.strstart-G.match_start)&&(G.match_length=O-1)),G.prev_length>=O&&G.match_length<=G.prev_length){for(it=G.strstart+G.lookahead-O,ot=l._tr_tally(G,G.strstart-1-G.prev_match,G.prev_length-O),G.lookahead-=G.prev_length-1,G.prev_length-=2;++G.strstart<=it&&(G.ins_h=(G.ins_h<<G.hash_shift^G.window[G.strstart+O-1])&G.hash_mask,ht=G.prev[G.strstart&G.w_mask]=G.head[G.ins_h],G.head[G.ins_h]=G.strstart),--G.prev_length!=0;);if(G.match_available=0,G.match_length=O-1,G.strstart++,ot&&(et(G,!1),G.strm.avail_out===0))return T}else if(G.match_available){if((ot=l._tr_tally(G,0,G.window[G.strstart-1]))&&et(G,!1),G.strstart++,G.lookahead--,G.strm.avail_out===0)return T}else G.match_available=1,G.strstart++,G.lookahead--}return G.match_available&&(ot=l._tr_tally(G,0,G.window[G.strstart-1]),G.match_available=0),G.insert=G.strstart<O-1?G.strstart:O-1,ct===v?(et(G,!0),G.strm.avail_out===0?F:X):G.last_lit&&(et(G,!1),G.strm.avail_out===0)?T:$}function Rt(G,ct,ht,ot,it){this.good_length=G,this.max_lazy=ct,this.nice_length=ht,this.max_chain=ot,this.func=it}function xt(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=k,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new a.Buf16(2*U),this.dyn_dtree=new a.Buf16(2*(2*P+1)),this.bl_tree=new a.Buf16(2*(2*q+1)),J(this.dyn_ltree),J(this.dyn_dtree),J(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new a.Buf16(I+1),this.heap=new a.Buf16(2*A+1),J(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new a.Buf16(2*A+1),J(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function _t(G){var ct;return G&&G.state?(G.total_in=G.total_out=0,G.data_type=N,(ct=G.state).pending=0,ct.pending_out=0,ct.wrap<0&&(ct.wrap=-ct.wrap),ct.status=ct.wrap?z:W,G.adler=ct.wrap===2?0:1,ct.last_flush=m,l._tr_init(ct),_):Y(G,w)}function tt(G){var ct=_t(G);return ct===_&&function(ht){ht.window_size=2*ht.w_size,J(ht.head),ht.max_lazy_match=s[ht.level].max_lazy,ht.good_match=s[ht.level].good_length,ht.nice_match=s[ht.level].nice_length,ht.max_chain_length=s[ht.level].max_chain,ht.strstart=0,ht.block_start=0,ht.lookahead=0,ht.insert=0,ht.match_length=ht.prev_length=O-1,ht.match_available=0,ht.ins_h=0}(G.state),ct}function wt(G,ct,ht,ot,it,st){if(!G)return w;var kt=1;if(ct===b&&(ct=6),ot<0?(kt=0,ot=-ot):15<ot&&(kt=2,ot-=16),it<1||C<it||ht!==k||ot<8||15<ot||ct<0||9<ct||st<0||S<st)return Y(G,w);ot===8&&(ot=9);var Lt=new xt;return(G.state=Lt).strm=G,Lt.wrap=kt,Lt.gzhead=null,Lt.w_bits=ot,Lt.w_size=1<<Lt.w_bits,Lt.w_mask=Lt.w_size-1,Lt.hash_bits=it+7,Lt.hash_size=1<<Lt.hash_bits,Lt.hash_mask=Lt.hash_size-1,Lt.hash_shift=~~((Lt.hash_bits+O-1)/O),Lt.window=new a.Buf8(2*Lt.w_size),Lt.head=new a.Buf16(Lt.hash_size),Lt.prev=new a.Buf16(Lt.w_size),Lt.lit_bufsize=1<<it+6,Lt.pending_buf_size=4*Lt.lit_bufsize,Lt.pending_buf=new a.Buf8(Lt.pending_buf_size),Lt.d_buf=1*Lt.lit_bufsize,Lt.l_buf=3*Lt.lit_bufsize,Lt.level=ct,Lt.strategy=st,Lt.method=ht,tt(G)}s=[new Rt(0,0,0,0,function(G,ct){var ht=65535;for(ht>G.pending_buf_size-5&&(ht=G.pending_buf_size-5);;){if(G.lookahead<=1){if(mt(G),G.lookahead===0&&ct===m)return T;if(G.lookahead===0)break}G.strstart+=G.lookahead,G.lookahead=0;var ot=G.block_start+ht;if((G.strstart===0||G.strstart>=ot)&&(G.lookahead=G.strstart-ot,G.strstart=ot,et(G,!1),G.strm.avail_out===0)||G.strstart-G.block_start>=G.w_size-V&&(et(G,!1),G.strm.avail_out===0))return T}return G.insert=0,ct===v?(et(G,!0),G.strm.avail_out===0?F:X):(G.strstart>G.block_start&&(et(G,!1),G.strm.avail_out),T)}),new Rt(4,4,8,4,Et),new Rt(4,5,16,8,Et),new Rt(4,6,32,32,Et),new Rt(4,4,16,16,at),new Rt(8,16,32,32,at),new Rt(8,16,128,128,at),new Rt(8,32,128,256,at),new Rt(32,128,258,1024,at),new Rt(32,258,258,4096,at)],n.deflateInit=function(G,ct){return wt(G,ct,k,15,8,0)},n.deflateInit2=wt,n.deflateReset=tt,n.deflateResetKeep=_t,n.deflateSetHeader=function(G,ct){return G&&G.state?G.state.wrap!==2?w:(G.state.gzhead=ct,_):w},n.deflate=function(G,ct){var ht,ot,it,st;if(!G||!G.state||5<ct||ct<0)return G?Y(G,w):w;if(ot=G.state,!G.output||!G.input&&G.avail_in!==0||ot.status===666&&ct!==v)return Y(G,G.avail_out===0?-5:w);if(ot.strm=G,ht=ot.last_flush,ot.last_flush=ct,ot.status===z)if(ot.wrap===2)G.adler=0,ft(ot,31),ft(ot,139),ft(ot,8),ot.gzhead?(ft(ot,(ot.gzhead.text?1:0)+(ot.gzhead.hcrc?2:0)+(ot.gzhead.extra?4:0)+(ot.gzhead.name?8:0)+(ot.gzhead.comment?16:0)),ft(ot,255&ot.gzhead.time),ft(ot,ot.gzhead.time>>8&255),ft(ot,ot.gzhead.time>>16&255),ft(ot,ot.gzhead.time>>24&255),ft(ot,ot.level===9?2:2<=ot.strategy||ot.level<2?4:0),ft(ot,255&ot.gzhead.os),ot.gzhead.extra&&ot.gzhead.extra.length&&(ft(ot,255&ot.gzhead.extra.length),ft(ot,ot.gzhead.extra.length>>8&255)),ot.gzhead.hcrc&&(G.adler=d(G.adler,ot.pending_buf,ot.pending,0)),ot.gzindex=0,ot.status=69):(ft(ot,0),ft(ot,0),ft(ot,0),ft(ot,0),ft(ot,0),ft(ot,ot.level===9?2:2<=ot.strategy||ot.level<2?4:0),ft(ot,3),ot.status=W);else{var kt=k+(ot.w_bits-8<<4)<<8;kt|=(2<=ot.strategy||ot.level<2?0:ot.level<6?1:ot.level===6?2:3)<<6,ot.strstart!==0&&(kt|=32),kt+=31-kt%31,ot.status=W,lt(ot,kt),ot.strstart!==0&&(lt(ot,G.adler>>>16),lt(ot,65535&G.adler)),G.adler=1}if(ot.status===69)if(ot.gzhead.extra){for(it=ot.pending;ot.gzindex<(65535&ot.gzhead.extra.length)&&(ot.pending!==ot.pending_buf_size||(ot.gzhead.hcrc&&ot.pending>it&&(G.adler=d(G.adler,ot.pending_buf,ot.pending-it,it)),K(G),it=ot.pending,ot.pending!==ot.pending_buf_size));)ft(ot,255&ot.gzhead.extra[ot.gzindex]),ot.gzindex++;ot.gzhead.hcrc&&ot.pending>it&&(G.adler=d(G.adler,ot.pending_buf,ot.pending-it,it)),ot.gzindex===ot.gzhead.extra.length&&(ot.gzindex=0,ot.status=73)}else ot.status=73;if(ot.status===73)if(ot.gzhead.name){it=ot.pending;do{if(ot.pending===ot.pending_buf_size&&(ot.gzhead.hcrc&&ot.pending>it&&(G.adler=d(G.adler,ot.pending_buf,ot.pending-it,it)),K(G),it=ot.pending,ot.pending===ot.pending_buf_size)){st=1;break}st=ot.gzindex<ot.gzhead.name.length?255&ot.gzhead.name.charCodeAt(ot.gzindex++):0,ft(ot,st)}while(st!==0);ot.gzhead.hcrc&&ot.pending>it&&(G.adler=d(G.adler,ot.pending_buf,ot.pending-it,it)),st===0&&(ot.gzindex=0,ot.status=91)}else ot.status=91;if(ot.status===91)if(ot.gzhead.comment){it=ot.pending;do{if(ot.pending===ot.pending_buf_size&&(ot.gzhead.hcrc&&ot.pending>it&&(G.adler=d(G.adler,ot.pending_buf,ot.pending-it,it)),K(G),it=ot.pending,ot.pending===ot.pending_buf_size)){st=1;break}st=ot.gzindex<ot.gzhead.comment.length?255&ot.gzhead.comment.charCodeAt(ot.gzindex++):0,ft(ot,st)}while(st!==0);ot.gzhead.hcrc&&ot.pending>it&&(G.adler=d(G.adler,ot.pending_buf,ot.pending-it,it)),st===0&&(ot.status=103)}else ot.status=103;if(ot.status===103&&(ot.gzhead.hcrc?(ot.pending+2>ot.pending_buf_size&&K(G),ot.pending+2<=ot.pending_buf_size&&(ft(ot,255&G.adler),ft(ot,G.adler>>8&255),G.adler=0,ot.status=W)):ot.status=W),ot.pending!==0){if(K(G),G.avail_out===0)return ot.last_flush=-1,_}else if(G.avail_in===0&&j(ct)<=j(ht)&&ct!==v)return Y(G,-5);if(ot.status===666&&G.avail_in!==0)return Y(G,-5);if(G.avail_in!==0||ot.lookahead!==0||ct!==m&&ot.status!==666){var Lt=ot.strategy===2?function(yt,At){for(var St;;){if(yt.lookahead===0&&(mt(yt),yt.lookahead===0)){if(At===m)return T;break}if(yt.match_length=0,St=l._tr_tally(yt,0,yt.window[yt.strstart]),yt.lookahead--,yt.strstart++,St&&(et(yt,!1),yt.strm.avail_out===0))return T}return yt.insert=0,At===v?(et(yt,!0),yt.strm.avail_out===0?F:X):yt.last_lit&&(et(yt,!1),yt.strm.avail_out===0)?T:$}(ot,ct):ot.strategy===3?function(yt,At){for(var St,Ct,Bt,ue,Pt=yt.window;;){if(yt.lookahead<=B){if(mt(yt),yt.lookahead<=B&&At===m)return T;if(yt.lookahead===0)break}if(yt.match_length=0,yt.lookahead>=O&&0<yt.strstart&&(Ct=Pt[Bt=yt.strstart-1])===Pt[++Bt]&&Ct===Pt[++Bt]&&Ct===Pt[++Bt]){ue=yt.strstart+B;do;while(Ct===Pt[++Bt]&&Ct===Pt[++Bt]&&Ct===Pt[++Bt]&&Ct===Pt[++Bt]&&Ct===Pt[++Bt]&&Ct===Pt[++Bt]&&Ct===Pt[++Bt]&&Ct===Pt[++Bt]&&Bt<ue);yt.match_length=B-(ue-Bt),yt.match_length>yt.lookahead&&(yt.match_length=yt.lookahead)}if(yt.match_length>=O?(St=l._tr_tally(yt,1,yt.match_length-O),yt.lookahead-=yt.match_length,yt.strstart+=yt.match_length,yt.match_length=0):(St=l._tr_tally(yt,0,yt.window[yt.strstart]),yt.lookahead--,yt.strstart++),St&&(et(yt,!1),yt.strm.avail_out===0))return T}return yt.insert=0,At===v?(et(yt,!0),yt.strm.avail_out===0?F:X):yt.last_lit&&(et(yt,!1),yt.strm.avail_out===0)?T:$}(ot,ct):s[ot.level].func(ot,ct);if(Lt!==F&&Lt!==X||(ot.status=666),Lt===T||Lt===F)return G.avail_out===0&&(ot.last_flush=-1),_;if(Lt===$&&(ct===1?l._tr_align(ot):ct!==5&&(l._tr_stored_block(ot,0,0,!1),ct===3&&(J(ot.head),ot.lookahead===0&&(ot.strstart=0,ot.block_start=0,ot.insert=0))),K(G),G.avail_out===0))return ot.last_flush=-1,_}return ct!==v?_:ot.wrap<=0?1:(ot.wrap===2?(ft(ot,255&G.adler),ft(ot,G.adler>>8&255),ft(ot,G.adler>>16&255),ft(ot,G.adler>>24&255),ft(ot,255&G.total_in),ft(ot,G.total_in>>8&255),ft(ot,G.total_in>>16&255),ft(ot,G.total_in>>24&255)):(lt(ot,G.adler>>>16),lt(ot,65535&G.adler)),K(G),0<ot.wrap&&(ot.wrap=-ot.wrap),ot.pending!==0?_:1)},n.deflateEnd=function(G){var ct;return G&&G.state?(ct=G.state.status)!==z&&ct!==69&&ct!==73&&ct!==91&&ct!==103&&ct!==W&&ct!==666?Y(G,w):(G.state=null,ct===W?Y(G,-3):_):w},n.deflateSetDictionary=function(G,ct){var ht,ot,it,st,kt,Lt,yt,At,St=ct.length;if(!G||!G.state||(st=(ht=G.state).wrap)===2||st===1&&ht.status!==z||ht.lookahead)return w;for(st===1&&(G.adler=f(G.adler,ct,St,0)),ht.wrap=0,St>=ht.w_size&&(st===0&&(J(ht.head),ht.strstart=0,ht.block_start=0,ht.insert=0),At=new a.Buf8(ht.w_size),a.arraySet(At,ct,St-ht.w_size,ht.w_size,0),ct=At,St=ht.w_size),kt=G.avail_in,Lt=G.next_in,yt=G.input,G.avail_in=St,G.next_in=0,G.input=ct,mt(ht);ht.lookahead>=O;){for(ot=ht.strstart,it=ht.lookahead-(O-1);ht.ins_h=(ht.ins_h<<ht.hash_shift^ht.window[ot+O-1])&ht.hash_mask,ht.prev[ot&ht.w_mask]=ht.head[ht.ins_h],ht.head[ht.ins_h]=ot,ot++,--it;);ht.strstart=ot,ht.lookahead=O-1,mt(ht)}return ht.strstart+=ht.lookahead,ht.block_start=ht.strstart,ht.insert=ht.lookahead,ht.lookahead=0,ht.match_length=ht.prev_length=O-1,ht.match_available=0,G.next_in=Lt,G.input=yt,G.avail_in=kt,ht.wrap=st,_},n.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(e,i,n){i.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(e,i,n){i.exports=function(s,a){var l,f,d,g,m,v,_,w,b,S,N,k,C,A,P,q,U,I,O,B,V,z,W,T,$;l=s.state,f=s.next_in,T=s.input,d=f+(s.avail_in-5),g=s.next_out,$=s.output,m=g-(a-s.avail_out),v=g+(s.avail_out-257),_=l.dmax,w=l.wsize,b=l.whave,S=l.wnext,N=l.window,k=l.hold,C=l.bits,A=l.lencode,P=l.distcode,q=(1<<l.lenbits)-1,U=(1<<l.distbits)-1;t:do{C<15&&(k+=T[f++]<<C,C+=8,k+=T[f++]<<C,C+=8),I=A[k&q];e:for(;;){if(k>>>=O=I>>>24,C-=O,(O=I>>>16&255)===0)$[g++]=65535&I;else{if(!(16&O)){if(!(64&O)){I=A[(65535&I)+(k&(1<<O)-1)];continue e}if(32&O){l.mode=12;break t}s.msg="invalid literal/length code",l.mode=30;break t}B=65535&I,(O&=15)&&(C<O&&(k+=T[f++]<<C,C+=8),B+=k&(1<<O)-1,k>>>=O,C-=O),C<15&&(k+=T[f++]<<C,C+=8,k+=T[f++]<<C,C+=8),I=P[k&U];n:for(;;){if(k>>>=O=I>>>24,C-=O,!(16&(O=I>>>16&255))){if(!(64&O)){I=P[(65535&I)+(k&(1<<O)-1)];continue n}s.msg="invalid distance code",l.mode=30;break t}if(V=65535&I,C<(O&=15)&&(k+=T[f++]<<C,(C+=8)<O&&(k+=T[f++]<<C,C+=8)),_<(V+=k&(1<<O)-1)){s.msg="invalid distance too far back",l.mode=30;break t}if(k>>>=O,C-=O,(O=g-m)<V){if(b<(O=V-O)&&l.sane){s.msg="invalid distance too far back",l.mode=30;break t}if(W=N,(z=0)===S){if(z+=w-O,O<B){for(B-=O;$[g++]=N[z++],--O;);z=g-V,W=$}}else if(S<O){if(z+=w+S-O,(O-=S)<B){for(B-=O;$[g++]=N[z++],--O;);if(z=0,S<B){for(B-=O=S;$[g++]=N[z++],--O;);z=g-V,W=$}}}else if(z+=S-O,O<B){for(B-=O;$[g++]=N[z++],--O;);z=g-V,W=$}for(;2<B;)$[g++]=W[z++],$[g++]=W[z++],$[g++]=W[z++],B-=3;B&&($[g++]=W[z++],1<B&&($[g++]=W[z++]))}else{for(z=g-V;$[g++]=$[z++],$[g++]=$[z++],$[g++]=$[z++],2<(B-=3););B&&($[g++]=$[z++],1<B&&($[g++]=$[z++]))}break}}break}}while(f<d&&g<v);f-=B=C>>3,k&=(1<<(C-=B<<3))-1,s.next_in=f,s.next_out=g,s.avail_in=f<d?d-f+5:5-(f-d),s.avail_out=g<v?v-g+257:257-(g-v),l.hold=k,l.bits=C}},{}],49:[function(e,i,n){var s=e("../utils/common"),a=e("./adler32"),l=e("./crc32"),f=e("./inffast"),d=e("./inftrees"),g=1,m=2,v=0,_=-2,w=1,b=852,S=592;function N(z){return(z>>>24&255)+(z>>>8&65280)+((65280&z)<<8)+((255&z)<<24)}function k(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new s.Buf16(320),this.work=new s.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function C(z){var W;return z&&z.state?(W=z.state,z.total_in=z.total_out=W.total=0,z.msg="",W.wrap&&(z.adler=1&W.wrap),W.mode=w,W.last=0,W.havedict=0,W.dmax=32768,W.head=null,W.hold=0,W.bits=0,W.lencode=W.lendyn=new s.Buf32(b),W.distcode=W.distdyn=new s.Buf32(S),W.sane=1,W.back=-1,v):_}function A(z){var W;return z&&z.state?((W=z.state).wsize=0,W.whave=0,W.wnext=0,C(z)):_}function P(z,W){var T,$;return z&&z.state?($=z.state,W<0?(T=0,W=-W):(T=1+(W>>4),W<48&&(W&=15)),W&&(W<8||15<W)?_:($.window!==null&&$.wbits!==W&&($.window=null),$.wrap=T,$.wbits=W,A(z))):_}function q(z,W){var T,$;return z?($=new k,(z.state=$).window=null,(T=P(z,W))!==v&&(z.state=null),T):_}var U,I,O=!0;function B(z){if(O){var W;for(U=new s.Buf32(512),I=new s.Buf32(32),W=0;W<144;)z.lens[W++]=8;for(;W<256;)z.lens[W++]=9;for(;W<280;)z.lens[W++]=7;for(;W<288;)z.lens[W++]=8;for(d(g,z.lens,0,288,U,0,z.work,{bits:9}),W=0;W<32;)z.lens[W++]=5;d(m,z.lens,0,32,I,0,z.work,{bits:5}),O=!1}z.lencode=U,z.lenbits=9,z.distcode=I,z.distbits=5}function V(z,W,T,$){var F,X=z.state;return X.window===null&&(X.wsize=1<<X.wbits,X.wnext=0,X.whave=0,X.window=new s.Buf8(X.wsize)),$>=X.wsize?(s.arraySet(X.window,W,T-X.wsize,X.wsize,0),X.wnext=0,X.whave=X.wsize):($<(F=X.wsize-X.wnext)&&(F=$),s.arraySet(X.window,W,T-$,F,X.wnext),($-=F)?(s.arraySet(X.window,W,T-$,$,0),X.wnext=$,X.whave=X.wsize):(X.wnext+=F,X.wnext===X.wsize&&(X.wnext=0),X.whave<X.wsize&&(X.whave+=F))),0}n.inflateReset=A,n.inflateReset2=P,n.inflateResetKeep=C,n.inflateInit=function(z){return q(z,15)},n.inflateInit2=q,n.inflate=function(z,W){var T,$,F,X,Y,j,J,K,et,ft,lt,ut,mt,Et,at,Rt,xt,_t,tt,wt,G,ct,ht,ot,it=0,st=new s.Buf8(4),kt=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!z||!z.state||!z.output||!z.input&&z.avail_in!==0)return _;(T=z.state).mode===12&&(T.mode=13),Y=z.next_out,F=z.output,J=z.avail_out,X=z.next_in,$=z.input,j=z.avail_in,K=T.hold,et=T.bits,ft=j,lt=J,ct=v;t:for(;;)switch(T.mode){case w:if(T.wrap===0){T.mode=13;break}for(;et<16;){if(j===0)break t;j--,K+=$[X++]<<et,et+=8}if(2&T.wrap&&K===35615){st[T.check=0]=255&K,st[1]=K>>>8&255,T.check=l(T.check,st,2,0),et=K=0,T.mode=2;break}if(T.flags=0,T.head&&(T.head.done=!1),!(1&T.wrap)||(((255&K)<<8)+(K>>8))%31){z.msg="incorrect header check",T.mode=30;break}if((15&K)!=8){z.msg="unknown compression method",T.mode=30;break}if(et-=4,G=8+(15&(K>>>=4)),T.wbits===0)T.wbits=G;else if(G>T.wbits){z.msg="invalid window size",T.mode=30;break}T.dmax=1<<G,z.adler=T.check=1,T.mode=512&K?10:12,et=K=0;break;case 2:for(;et<16;){if(j===0)break t;j--,K+=$[X++]<<et,et+=8}if(T.flags=K,(255&T.flags)!=8){z.msg="unknown compression method",T.mode=30;break}if(57344&T.flags){z.msg="unknown header flags set",T.mode=30;break}T.head&&(T.head.text=K>>8&1),512&T.flags&&(st[0]=255&K,st[1]=K>>>8&255,T.check=l(T.check,st,2,0)),et=K=0,T.mode=3;case 3:for(;et<32;){if(j===0)break t;j--,K+=$[X++]<<et,et+=8}T.head&&(T.head.time=K),512&T.flags&&(st[0]=255&K,st[1]=K>>>8&255,st[2]=K>>>16&255,st[3]=K>>>24&255,T.check=l(T.check,st,4,0)),et=K=0,T.mode=4;case 4:for(;et<16;){if(j===0)break t;j--,K+=$[X++]<<et,et+=8}T.head&&(T.head.xflags=255&K,T.head.os=K>>8),512&T.flags&&(st[0]=255&K,st[1]=K>>>8&255,T.check=l(T.check,st,2,0)),et=K=0,T.mode=5;case 5:if(1024&T.flags){for(;et<16;){if(j===0)break t;j--,K+=$[X++]<<et,et+=8}T.length=K,T.head&&(T.head.extra_len=K),512&T.flags&&(st[0]=255&K,st[1]=K>>>8&255,T.check=l(T.check,st,2,0)),et=K=0}else T.head&&(T.head.extra=null);T.mode=6;case 6:if(1024&T.flags&&(j<(ut=T.length)&&(ut=j),ut&&(T.head&&(G=T.head.extra_len-T.length,T.head.extra||(T.head.extra=new Array(T.head.extra_len)),s.arraySet(T.head.extra,$,X,ut,G)),512&T.flags&&(T.check=l(T.check,$,ut,X)),j-=ut,X+=ut,T.length-=ut),T.length))break t;T.length=0,T.mode=7;case 7:if(2048&T.flags){if(j===0)break t;for(ut=0;G=$[X+ut++],T.head&&G&&T.length<65536&&(T.head.name+=String.fromCharCode(G)),G&&ut<j;);if(512&T.flags&&(T.check=l(T.check,$,ut,X)),j-=ut,X+=ut,G)break t}else T.head&&(T.head.name=null);T.length=0,T.mode=8;case 8:if(4096&T.flags){if(j===0)break t;for(ut=0;G=$[X+ut++],T.head&&G&&T.length<65536&&(T.head.comment+=String.fromCharCode(G)),G&&ut<j;);if(512&T.flags&&(T.check=l(T.check,$,ut,X)),j-=ut,X+=ut,G)break t}else T.head&&(T.head.comment=null);T.mode=9;case 9:if(512&T.flags){for(;et<16;){if(j===0)break t;j--,K+=$[X++]<<et,et+=8}if(K!==(65535&T.check)){z.msg="header crc mismatch",T.mode=30;break}et=K=0}T.head&&(T.head.hcrc=T.flags>>9&1,T.head.done=!0),z.adler=T.check=0,T.mode=12;break;case 10:for(;et<32;){if(j===0)break t;j--,K+=$[X++]<<et,et+=8}z.adler=T.check=N(K),et=K=0,T.mode=11;case 11:if(T.havedict===0)return z.next_out=Y,z.avail_out=J,z.next_in=X,z.avail_in=j,T.hold=K,T.bits=et,2;z.adler=T.check=1,T.mode=12;case 12:if(W===5||W===6)break t;case 13:if(T.last){K>>>=7&et,et-=7&et,T.mode=27;break}for(;et<3;){if(j===0)break t;j--,K+=$[X++]<<et,et+=8}switch(T.last=1&K,et-=1,3&(K>>>=1)){case 0:T.mode=14;break;case 1:if(B(T),T.mode=20,W!==6)break;K>>>=2,et-=2;break t;case 2:T.mode=17;break;case 3:z.msg="invalid block type",T.mode=30}K>>>=2,et-=2;break;case 14:for(K>>>=7&et,et-=7&et;et<32;){if(j===0)break t;j--,K+=$[X++]<<et,et+=8}if((65535&K)!=(K>>>16^65535)){z.msg="invalid stored block lengths",T.mode=30;break}if(T.length=65535&K,et=K=0,T.mode=15,W===6)break t;case 15:T.mode=16;case 16:if(ut=T.length){if(j<ut&&(ut=j),J<ut&&(ut=J),ut===0)break t;s.arraySet(F,$,X,ut,Y),j-=ut,X+=ut,J-=ut,Y+=ut,T.length-=ut;break}T.mode=12;break;case 17:for(;et<14;){if(j===0)break t;j--,K+=$[X++]<<et,et+=8}if(T.nlen=257+(31&K),K>>>=5,et-=5,T.ndist=1+(31&K),K>>>=5,et-=5,T.ncode=4+(15&K),K>>>=4,et-=4,286<T.nlen||30<T.ndist){z.msg="too many length or distance symbols",T.mode=30;break}T.have=0,T.mode=18;case 18:for(;T.have<T.ncode;){for(;et<3;){if(j===0)break t;j--,K+=$[X++]<<et,et+=8}T.lens[kt[T.have++]]=7&K,K>>>=3,et-=3}for(;T.have<19;)T.lens[kt[T.have++]]=0;if(T.lencode=T.lendyn,T.lenbits=7,ht={bits:T.lenbits},ct=d(0,T.lens,0,19,T.lencode,0,T.work,ht),T.lenbits=ht.bits,ct){z.msg="invalid code lengths set",T.mode=30;break}T.have=0,T.mode=19;case 19:for(;T.have<T.nlen+T.ndist;){for(;Rt=(it=T.lencode[K&(1<<T.lenbits)-1])>>>16&255,xt=65535&it,!((at=it>>>24)<=et);){if(j===0)break t;j--,K+=$[X++]<<et,et+=8}if(xt<16)K>>>=at,et-=at,T.lens[T.have++]=xt;else{if(xt===16){for(ot=at+2;et<ot;){if(j===0)break t;j--,K+=$[X++]<<et,et+=8}if(K>>>=at,et-=at,T.have===0){z.msg="invalid bit length repeat",T.mode=30;break}G=T.lens[T.have-1],ut=3+(3&K),K>>>=2,et-=2}else if(xt===17){for(ot=at+3;et<ot;){if(j===0)break t;j--,K+=$[X++]<<et,et+=8}et-=at,G=0,ut=3+(7&(K>>>=at)),K>>>=3,et-=3}else{for(ot=at+7;et<ot;){if(j===0)break t;j--,K+=$[X++]<<et,et+=8}et-=at,G=0,ut=11+(127&(K>>>=at)),K>>>=7,et-=7}if(T.have+ut>T.nlen+T.ndist){z.msg="invalid bit length repeat",T.mode=30;break}for(;ut--;)T.lens[T.have++]=G}}if(T.mode===30)break;if(T.lens[256]===0){z.msg="invalid code -- missing end-of-block",T.mode=30;break}if(T.lenbits=9,ht={bits:T.lenbits},ct=d(g,T.lens,0,T.nlen,T.lencode,0,T.work,ht),T.lenbits=ht.bits,ct){z.msg="invalid literal/lengths set",T.mode=30;break}if(T.distbits=6,T.distcode=T.distdyn,ht={bits:T.distbits},ct=d(m,T.lens,T.nlen,T.ndist,T.distcode,0,T.work,ht),T.distbits=ht.bits,ct){z.msg="invalid distances set",T.mode=30;break}if(T.mode=20,W===6)break t;case 20:T.mode=21;case 21:if(6<=j&&258<=J){z.next_out=Y,z.avail_out=J,z.next_in=X,z.avail_in=j,T.hold=K,T.bits=et,f(z,lt),Y=z.next_out,F=z.output,J=z.avail_out,X=z.next_in,$=z.input,j=z.avail_in,K=T.hold,et=T.bits,T.mode===12&&(T.back=-1);break}for(T.back=0;Rt=(it=T.lencode[K&(1<<T.lenbits)-1])>>>16&255,xt=65535&it,!((at=it>>>24)<=et);){if(j===0)break t;j--,K+=$[X++]<<et,et+=8}if(Rt&&!(240&Rt)){for(_t=at,tt=Rt,wt=xt;Rt=(it=T.lencode[wt+((K&(1<<_t+tt)-1)>>_t)])>>>16&255,xt=65535&it,!(_t+(at=it>>>24)<=et);){if(j===0)break t;j--,K+=$[X++]<<et,et+=8}K>>>=_t,et-=_t,T.back+=_t}if(K>>>=at,et-=at,T.back+=at,T.length=xt,Rt===0){T.mode=26;break}if(32&Rt){T.back=-1,T.mode=12;break}if(64&Rt){z.msg="invalid literal/length code",T.mode=30;break}T.extra=15&Rt,T.mode=22;case 22:if(T.extra){for(ot=T.extra;et<ot;){if(j===0)break t;j--,K+=$[X++]<<et,et+=8}T.length+=K&(1<<T.extra)-1,K>>>=T.extra,et-=T.extra,T.back+=T.extra}T.was=T.length,T.mode=23;case 23:for(;Rt=(it=T.distcode[K&(1<<T.distbits)-1])>>>16&255,xt=65535&it,!((at=it>>>24)<=et);){if(j===0)break t;j--,K+=$[X++]<<et,et+=8}if(!(240&Rt)){for(_t=at,tt=Rt,wt=xt;Rt=(it=T.distcode[wt+((K&(1<<_t+tt)-1)>>_t)])>>>16&255,xt=65535&it,!(_t+(at=it>>>24)<=et);){if(j===0)break t;j--,K+=$[X++]<<et,et+=8}K>>>=_t,et-=_t,T.back+=_t}if(K>>>=at,et-=at,T.back+=at,64&Rt){z.msg="invalid distance code",T.mode=30;break}T.offset=xt,T.extra=15&Rt,T.mode=24;case 24:if(T.extra){for(ot=T.extra;et<ot;){if(j===0)break t;j--,K+=$[X++]<<et,et+=8}T.offset+=K&(1<<T.extra)-1,K>>>=T.extra,et-=T.extra,T.back+=T.extra}if(T.offset>T.dmax){z.msg="invalid distance too far back",T.mode=30;break}T.mode=25;case 25:if(J===0)break t;if(ut=lt-J,T.offset>ut){if((ut=T.offset-ut)>T.whave&&T.sane){z.msg="invalid distance too far back",T.mode=30;break}mt=ut>T.wnext?(ut-=T.wnext,T.wsize-ut):T.wnext-ut,ut>T.length&&(ut=T.length),Et=T.window}else Et=F,mt=Y-T.offset,ut=T.length;for(J<ut&&(ut=J),J-=ut,T.length-=ut;F[Y++]=Et[mt++],--ut;);T.length===0&&(T.mode=21);break;case 26:if(J===0)break t;F[Y++]=T.length,J--,T.mode=21;break;case 27:if(T.wrap){for(;et<32;){if(j===0)break t;j--,K|=$[X++]<<et,et+=8}if(lt-=J,z.total_out+=lt,T.total+=lt,lt&&(z.adler=T.check=T.flags?l(T.check,F,lt,Y-lt):a(T.check,F,lt,Y-lt)),lt=J,(T.flags?K:N(K))!==T.check){z.msg="incorrect data check",T.mode=30;break}et=K=0}T.mode=28;case 28:if(T.wrap&&T.flags){for(;et<32;){if(j===0)break t;j--,K+=$[X++]<<et,et+=8}if(K!==(4294967295&T.total)){z.msg="incorrect length check",T.mode=30;break}et=K=0}T.mode=29;case 29:ct=1;break t;case 30:ct=-3;break t;case 31:return-4;case 32:default:return _}return z.next_out=Y,z.avail_out=J,z.next_in=X,z.avail_in=j,T.hold=K,T.bits=et,(T.wsize||lt!==z.avail_out&&T.mode<30&&(T.mode<27||W!==4))&&V(z,z.output,z.next_out,lt-z.avail_out)?(T.mode=31,-4):(ft-=z.avail_in,lt-=z.avail_out,z.total_in+=ft,z.total_out+=lt,T.total+=lt,T.wrap&&lt&&(z.adler=T.check=T.flags?l(T.check,F,lt,z.next_out-lt):a(T.check,F,lt,z.next_out-lt)),z.data_type=T.bits+(T.last?64:0)+(T.mode===12?128:0)+(T.mode===20||T.mode===15?256:0),(ft==0&&lt===0||W===4)&&ct===v&&(ct=-5),ct)},n.inflateEnd=function(z){if(!z||!z.state)return _;var W=z.state;return W.window&&(W.window=null),z.state=null,v},n.inflateGetHeader=function(z,W){var T;return z&&z.state&&2&(T=z.state).wrap?((T.head=W).done=!1,v):_},n.inflateSetDictionary=function(z,W){var T,$=W.length;return z&&z.state?(T=z.state).wrap!==0&&T.mode!==11?_:T.mode===11&&a(1,W,$,0)!==T.check?-3:V(z,W,$,$)?(T.mode=31,-4):(T.havedict=1,v):_},n.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(e,i,n){var s=e("../utils/common"),a=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],l=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],f=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],d=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];i.exports=function(g,m,v,_,w,b,S,N){var k,C,A,P,q,U,I,O,B,V=N.bits,z=0,W=0,T=0,$=0,F=0,X=0,Y=0,j=0,J=0,K=0,et=null,ft=0,lt=new s.Buf16(16),ut=new s.Buf16(16),mt=null,Et=0;for(z=0;z<=15;z++)lt[z]=0;for(W=0;W<_;W++)lt[m[v+W]]++;for(F=V,$=15;1<=$&&lt[$]===0;$--);if($<F&&(F=$),$===0)return w[b++]=20971520,w[b++]=20971520,N.bits=1,0;for(T=1;T<$&&lt[T]===0;T++);for(F<T&&(F=T),z=j=1;z<=15;z++)if(j<<=1,(j-=lt[z])<0)return-1;if(0<j&&(g===0||$!==1))return-1;for(ut[1]=0,z=1;z<15;z++)ut[z+1]=ut[z]+lt[z];for(W=0;W<_;W++)m[v+W]!==0&&(S[ut[m[v+W]]++]=W);if(U=g===0?(et=mt=S,19):g===1?(et=a,ft-=257,mt=l,Et-=257,256):(et=f,mt=d,-1),z=T,q=b,Y=W=K=0,A=-1,P=(J=1<<(X=F))-1,g===1&&852<J||g===2&&592<J)return 1;for(;;){for(I=z-Y,B=S[W]<U?(O=0,S[W]):S[W]>U?(O=mt[Et+S[W]],et[ft+S[W]]):(O=96,0),k=1<<z-Y,T=C=1<<X;w[q+(K>>Y)+(C-=k)]=I<<24|O<<16|B|0,C!==0;);for(k=1<<z-1;K&k;)k>>=1;if(k!==0?(K&=k-1,K+=k):K=0,W++,--lt[z]==0){if(z===$)break;z=m[v+S[W]]}if(F<z&&(K&P)!==A){for(Y===0&&(Y=F),q+=T,j=1<<(X=z-Y);X+Y<$&&!((j-=lt[X+Y])<=0);)X++,j<<=1;if(J+=1<<X,g===1&&852<J||g===2&&592<J)return 1;w[A=K&P]=F<<24|X<<16|q-b|0}}return K!==0&&(w[q+K]=z-Y<<24|64<<16|0),N.bits=F,0}},{"../utils/common":41}],51:[function(e,i,n){i.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(e,i,n){var s=e("../utils/common"),a=0,l=1;function f(it){for(var st=it.length;0<=--st;)it[st]=0}var d=0,g=29,m=256,v=m+1+g,_=30,w=19,b=2*v+1,S=15,N=16,k=7,C=256,A=16,P=17,q=18,U=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],I=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],O=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],B=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],V=new Array(2*(v+2));f(V);var z=new Array(2*_);f(z);var W=new Array(512);f(W);var T=new Array(256);f(T);var $=new Array(g);f($);var F,X,Y,j=new Array(_);function J(it,st,kt,Lt,yt){this.static_tree=it,this.extra_bits=st,this.extra_base=kt,this.elems=Lt,this.max_length=yt,this.has_stree=it&&it.length}function K(it,st){this.dyn_tree=it,this.max_code=0,this.stat_desc=st}function et(it){return it<256?W[it]:W[256+(it>>>7)]}function ft(it,st){it.pending_buf[it.pending++]=255&st,it.pending_buf[it.pending++]=st>>>8&255}function lt(it,st,kt){it.bi_valid>N-kt?(it.bi_buf|=st<<it.bi_valid&65535,ft(it,it.bi_buf),it.bi_buf=st>>N-it.bi_valid,it.bi_valid+=kt-N):(it.bi_buf|=st<<it.bi_valid&65535,it.bi_valid+=kt)}function ut(it,st,kt){lt(it,kt[2*st],kt[2*st+1])}function mt(it,st){for(var kt=0;kt|=1&it,it>>>=1,kt<<=1,0<--st;);return kt>>>1}function Et(it,st,kt){var Lt,yt,At=new Array(S+1),St=0;for(Lt=1;Lt<=S;Lt++)At[Lt]=St=St+kt[Lt-1]<<1;for(yt=0;yt<=st;yt++){var Ct=it[2*yt+1];Ct!==0&&(it[2*yt]=mt(At[Ct]++,Ct))}}function at(it){var st;for(st=0;st<v;st++)it.dyn_ltree[2*st]=0;for(st=0;st<_;st++)it.dyn_dtree[2*st]=0;for(st=0;st<w;st++)it.bl_tree[2*st]=0;it.dyn_ltree[2*C]=1,it.opt_len=it.static_len=0,it.last_lit=it.matches=0}function Rt(it){8<it.bi_valid?ft(it,it.bi_buf):0<it.bi_valid&&(it.pending_buf[it.pending++]=it.bi_buf),it.bi_buf=0,it.bi_valid=0}function xt(it,st,kt,Lt){var yt=2*st,At=2*kt;return it[yt]<it[At]||it[yt]===it[At]&&Lt[st]<=Lt[kt]}function _t(it,st,kt){for(var Lt=it.heap[kt],yt=kt<<1;yt<=it.heap_len&&(yt<it.heap_len&&xt(st,it.heap[yt+1],it.heap[yt],it.depth)&&yt++,!xt(st,Lt,it.heap[yt],it.depth));)it.heap[kt]=it.heap[yt],kt=yt,yt<<=1;it.heap[kt]=Lt}function tt(it,st,kt){var Lt,yt,At,St,Ct=0;if(it.last_lit!==0)for(;Lt=it.pending_buf[it.d_buf+2*Ct]<<8|it.pending_buf[it.d_buf+2*Ct+1],yt=it.pending_buf[it.l_buf+Ct],Ct++,Lt===0?ut(it,yt,st):(ut(it,(At=T[yt])+m+1,st),(St=U[At])!==0&&lt(it,yt-=$[At],St),ut(it,At=et(--Lt),kt),(St=I[At])!==0&&lt(it,Lt-=j[At],St)),Ct<it.last_lit;);ut(it,C,st)}function wt(it,st){var kt,Lt,yt,At=st.dyn_tree,St=st.stat_desc.static_tree,Ct=st.stat_desc.has_stree,Bt=st.stat_desc.elems,ue=-1;for(it.heap_len=0,it.heap_max=b,kt=0;kt<Bt;kt++)At[2*kt]!==0?(it.heap[++it.heap_len]=ue=kt,it.depth[kt]=0):At[2*kt+1]=0;for(;it.heap_len<2;)At[2*(yt=it.heap[++it.heap_len]=ue<2?++ue:0)]=1,it.depth[yt]=0,it.opt_len--,Ct&&(it.static_len-=St[2*yt+1]);for(st.max_code=ue,kt=it.heap_len>>1;1<=kt;kt--)_t(it,At,kt);for(yt=Bt;kt=it.heap[1],it.heap[1]=it.heap[it.heap_len--],_t(it,At,1),Lt=it.heap[1],it.heap[--it.heap_max]=kt,it.heap[--it.heap_max]=Lt,At[2*yt]=At[2*kt]+At[2*Lt],it.depth[yt]=(it.depth[kt]>=it.depth[Lt]?it.depth[kt]:it.depth[Lt])+1,At[2*kt+1]=At[2*Lt+1]=yt,it.heap[1]=yt++,_t(it,At,1),2<=it.heap_len;);it.heap[--it.heap_max]=it.heap[1],function(Pt,be){var Xt,Ut,tn,le,en,Ft,nn=be.dyn_tree,Dn=be.max_code,zn=be.stat_desc.static_tree,ze=be.stat_desc.has_stree,In=be.stat_desc.extra_bits,Ue=be.stat_desc.extra_base,Se=be.stat_desc.max_length,$n=0;for(le=0;le<=S;le++)Pt.bl_count[le]=0;for(nn[2*Pt.heap[Pt.heap_max]+1]=0,Xt=Pt.heap_max+1;Xt<b;Xt++)Se<(le=nn[2*nn[2*(Ut=Pt.heap[Xt])+1]+1]+1)&&(le=Se,$n++),nn[2*Ut+1]=le,Dn<Ut||(Pt.bl_count[le]++,en=0,Ue<=Ut&&(en=In[Ut-Ue]),Ft=nn[2*Ut],Pt.opt_len+=Ft*(le+en),ze&&(Pt.static_len+=Ft*(zn[2*Ut+1]+en)));if($n!==0){do{for(le=Se-1;Pt.bl_count[le]===0;)le--;Pt.bl_count[le]--,Pt.bl_count[le+1]+=2,Pt.bl_count[Se]--,$n-=2}while(0<$n);for(le=Se;le!==0;le--)for(Ut=Pt.bl_count[le];Ut!==0;)Dn<(tn=Pt.heap[--Xt])||(nn[2*tn+1]!==le&&(Pt.opt_len+=(le-nn[2*tn+1])*nn[2*tn],nn[2*tn+1]=le),Ut--)}}(it,st),Et(At,ue,it.bl_count)}function G(it,st,kt){var Lt,yt,At=-1,St=st[1],Ct=0,Bt=7,ue=4;for(St===0&&(Bt=138,ue=3),st[2*(kt+1)+1]=65535,Lt=0;Lt<=kt;Lt++)yt=St,St=st[2*(Lt+1)+1],++Ct<Bt&&yt===St||(Ct<ue?it.bl_tree[2*yt]+=Ct:yt!==0?(yt!==At&&it.bl_tree[2*yt]++,it.bl_tree[2*A]++):Ct<=10?it.bl_tree[2*P]++:it.bl_tree[2*q]++,At=yt,ue=(Ct=0)===St?(Bt=138,3):yt===St?(Bt=6,3):(Bt=7,4))}function ct(it,st,kt){var Lt,yt,At=-1,St=st[1],Ct=0,Bt=7,ue=4;for(St===0&&(Bt=138,ue=3),Lt=0;Lt<=kt;Lt++)if(yt=St,St=st[2*(Lt+1)+1],!(++Ct<Bt&&yt===St)){if(Ct<ue)for(;ut(it,yt,it.bl_tree),--Ct!=0;);else yt!==0?(yt!==At&&(ut(it,yt,it.bl_tree),Ct--),ut(it,A,it.bl_tree),lt(it,Ct-3,2)):Ct<=10?(ut(it,P,it.bl_tree),lt(it,Ct-3,3)):(ut(it,q,it.bl_tree),lt(it,Ct-11,7));At=yt,ue=(Ct=0)===St?(Bt=138,3):yt===St?(Bt=6,3):(Bt=7,4)}}f(j);var ht=!1;function ot(it,st,kt,Lt){lt(it,(d<<1)+(Lt?1:0),3),function(yt,At,St,Ct){Rt(yt),ft(yt,St),ft(yt,~St),s.arraySet(yt.pending_buf,yt.window,At,St,yt.pending),yt.pending+=St}(it,st,kt)}n._tr_init=function(it){ht||(function(){var st,kt,Lt,yt,At,St=new Array(S+1);for(yt=Lt=0;yt<g-1;yt++)for($[yt]=Lt,st=0;st<1<<U[yt];st++)T[Lt++]=yt;for(T[Lt-1]=yt,yt=At=0;yt<16;yt++)for(j[yt]=At,st=0;st<1<<I[yt];st++)W[At++]=yt;for(At>>=7;yt<_;yt++)for(j[yt]=At<<7,st=0;st<1<<I[yt]-7;st++)W[256+At++]=yt;for(kt=0;kt<=S;kt++)St[kt]=0;for(st=0;st<=143;)V[2*st+1]=8,st++,St[8]++;for(;st<=255;)V[2*st+1]=9,st++,St[9]++;for(;st<=279;)V[2*st+1]=7,st++,St[7]++;for(;st<=287;)V[2*st+1]=8,st++,St[8]++;for(Et(V,v+1,St),st=0;st<_;st++)z[2*st+1]=5,z[2*st]=mt(st,5);F=new J(V,U,m+1,v,S),X=new J(z,I,0,_,S),Y=new J(new Array(0),O,0,w,k)}(),ht=!0),it.l_desc=new K(it.dyn_ltree,F),it.d_desc=new K(it.dyn_dtree,X),it.bl_desc=new K(it.bl_tree,Y),it.bi_buf=0,it.bi_valid=0,at(it)},n._tr_stored_block=ot,n._tr_flush_block=function(it,st,kt,Lt){var yt,At,St=0;0<it.level?(it.strm.data_type===2&&(it.strm.data_type=function(Ct){var Bt,ue=4093624447;for(Bt=0;Bt<=31;Bt++,ue>>>=1)if(1&ue&&Ct.dyn_ltree[2*Bt]!==0)return a;if(Ct.dyn_ltree[18]!==0||Ct.dyn_ltree[20]!==0||Ct.dyn_ltree[26]!==0)return l;for(Bt=32;Bt<m;Bt++)if(Ct.dyn_ltree[2*Bt]!==0)return l;return a}(it)),wt(it,it.l_desc),wt(it,it.d_desc),St=function(Ct){var Bt;for(G(Ct,Ct.dyn_ltree,Ct.l_desc.max_code),G(Ct,Ct.dyn_dtree,Ct.d_desc.max_code),wt(Ct,Ct.bl_desc),Bt=w-1;3<=Bt&&Ct.bl_tree[2*B[Bt]+1]===0;Bt--);return Ct.opt_len+=3*(Bt+1)+5+5+4,Bt}(it),yt=it.opt_len+3+7>>>3,(At=it.static_len+3+7>>>3)<=yt&&(yt=At)):yt=At=kt+5,kt+4<=yt&&st!==-1?ot(it,st,kt,Lt):it.strategy===4||At===yt?(lt(it,2+(Lt?1:0),3),tt(it,V,z)):(lt(it,4+(Lt?1:0),3),function(Ct,Bt,ue,Pt){var be;for(lt(Ct,Bt-257,5),lt(Ct,ue-1,5),lt(Ct,Pt-4,4),be=0;be<Pt;be++)lt(Ct,Ct.bl_tree[2*B[be]+1],3);ct(Ct,Ct.dyn_ltree,Bt-1),ct(Ct,Ct.dyn_dtree,ue-1)}(it,it.l_desc.max_code+1,it.d_desc.max_code+1,St+1),tt(it,it.dyn_ltree,it.dyn_dtree)),at(it),Lt&&Rt(it)},n._tr_tally=function(it,st,kt){return it.pending_buf[it.d_buf+2*it.last_lit]=st>>>8&255,it.pending_buf[it.d_buf+2*it.last_lit+1]=255&st,it.pending_buf[it.l_buf+it.last_lit]=255&kt,it.last_lit++,st===0?it.dyn_ltree[2*kt]++:(it.matches++,st--,it.dyn_ltree[2*(T[kt]+m+1)]++,it.dyn_dtree[2*et(st)]++),it.last_lit===it.lit_bufsize-1},n._tr_align=function(it){lt(it,2,3),ut(it,C,V),function(st){st.bi_valid===16?(ft(st,st.bi_buf),st.bi_buf=0,st.bi_valid=0):8<=st.bi_valid&&(st.pending_buf[st.pending++]=255&st.bi_buf,st.bi_buf>>=8,st.bi_valid-=8)}(it)}},{"../utils/common":41}],53:[function(e,i,n){i.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(e,i,n){(function(s){(function(a,l){if(!a.setImmediate){var f,d,g,m,v=1,_={},w=!1,b=a.document,S=Object.getPrototypeOf&&Object.getPrototypeOf(a);S=S&&S.setTimeout?S:a,f={}.toString.call(a.process)==="[object process]"?function(A){process.nextTick(function(){k(A)})}:function(){if(a.postMessage&&!a.importScripts){var A=!0,P=a.onmessage;return a.onmessage=function(){A=!1},a.postMessage("","*"),a.onmessage=P,A}}()?(m="setImmediate$"+Math.random()+"$",a.addEventListener?a.addEventListener("message",C,!1):a.attachEvent("onmessage",C),function(A){a.postMessage(m+A,"*")}):a.MessageChannel?((g=new MessageChannel).port1.onmessage=function(A){k(A.data)},function(A){g.port2.postMessage(A)}):b&&"onreadystatechange"in b.createElement("script")?(d=b.documentElement,function(A){var P=b.createElement("script");P.onreadystatechange=function(){k(A),P.onreadystatechange=null,d.removeChild(P),P=null},d.appendChild(P)}):function(A){setTimeout(k,0,A)},S.setImmediate=function(A){typeof A!="function"&&(A=new Function(""+A));for(var P=new Array(arguments.length-1),q=0;q<P.length;q++)P[q]=arguments[q+1];var U={callback:A,args:P};return _[v]=U,f(v),v++},S.clearImmediate=N}function N(A){delete _[A]}function k(A){if(w)setTimeout(k,0,A);else{var P=_[A];if(P){w=!0;try{(function(q){var U=q.callback,I=q.args;switch(I.length){case 0:U();break;case 1:U(I[0]);break;case 2:U(I[0],I[1]);break;case 3:U(I[0],I[1],I[2]);break;default:U.apply(l,I)}})(P)}finally{N(A),w=!1}}}}function C(A){A.source===a&&typeof A.data=="string"&&A.data.indexOf(m)===0&&k(+A.data.slice(m.length))}})(typeof self>"u"?s===void 0?this:s:self)}).call(this,typeof Ys<"u"?Ys:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})}(mc)),mc.exports}var j1=J1();const K1=eo(j1);var Eu={exports:{}};/**
 * @license
 * lodash (Custom Build) <https://lodash.com/>
 * Build: `lodash exports="node" include="clone,merge,isEmpty,isArray,compact,each" -d`
 * Copyright jQuery Foundation and other contributors <https://jquery.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */var Q1=Eu.exports,bp;function tx(){return bp||(bp=1,function(r,t){(function(){var e,i="4.15.0",n=200,s="Expected a function",a="__lodash_hash_undefined__",l=1,f=2,d=9007199254740991,g="[object Arguments]",m="[object Array]",v="[object Boolean]",_="[object Date]",w="[object Error]",b="[object Function]",S="[object GeneratorFunction]",N="[object Map]",k="[object Number]",C="[object Object]",A="[object Promise]",P="[object RegExp]",q="[object Set]",U="[object String]",I="[object Symbol]",O="[object WeakMap]",B="[object ArrayBuffer]",V="[object DataView]",z="[object Float32Array]",W="[object Float64Array]",T="[object Int8Array]",$="[object Int16Array]",F="[object Int32Array]",X="[object Uint8Array]",Y="[object Uint8ClampedArray]",j="[object Uint16Array]",J="[object Uint32Array]",K=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,et=/^\w*$/,ft=/^\./,lt=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,ut=/[\\^$.*+?()[\]{}|]/g,mt=/\\(\\)?/g,Et=/\w*$/,at=/^\[object .+?Constructor\]$/,Rt=/^(?:0|[1-9]\d*)$/,xt={};xt[z]=xt[W]=xt[T]=xt[$]=xt[F]=xt[X]=xt[Y]=xt[j]=xt[J]=!0,xt[g]=xt[m]=xt[B]=xt[v]=xt[V]=xt[_]=xt[w]=xt[b]=xt[N]=xt[k]=xt[C]=xt[P]=xt[q]=xt[U]=xt[O]=!1;var _t={};_t[g]=_t[m]=_t[B]=_t[V]=_t[v]=_t[_]=_t[z]=_t[W]=_t[T]=_t[$]=_t[F]=_t[N]=_t[k]=_t[C]=_t[P]=_t[q]=_t[U]=_t[I]=_t[X]=_t[Y]=_t[j]=_t[J]=!0,_t[w]=_t[b]=_t[O]=!1;var tt=typeof Ys=="object"&&Ys&&Ys.Object===Object&&Ys,wt=typeof self=="object"&&self&&self.Object===Object&&self,G=tt||wt||Function("return this")(),ct=t&&!t.nodeType&&t,ht=ct&&!0&&r&&!r.nodeType&&r,ot=ht&&ht.exports===ct,it=ot&&tt.process,st=function(){try{return it&&it.binding("util")}catch{}}(),kt=st&&st.isTypedArray;function Lt(c,o){return c.set(o[0],o[1]),c}function yt(c,o){return c.add(o),c}function At(c,o,u){switch(u.length){case 0:return c.call(o);case 1:return c.call(o,u[0]);case 2:return c.call(o,u[0],u[1]);case 3:return c.call(o,u[0],u[1],u[2])}return c.apply(o,u)}function St(c,o){for(var u=-1,p=c?c.length:0;++u<p&&o(c[u],u,c)!==!1;);return c}function Ct(c,o){for(var u=-1,p=o.length,x=c.length;++u<p;)c[x+u]=o[u];return c}function Bt(c,o,u,p){for(var x=-1,M=c?c.length:0;++x<M;)u=o(u,c[x],x,c);return u}function ue(c,o){for(var u=-1,p=c?c.length:0;++u<p;)if(o(c[u],u,c))return!0;return!1}function Pt(c){return function(o){return o==null?e:o[c]}}function be(c,o){for(var u=-1,p=Array(c);++u<c;)p[u]=o(u);return p}function Xt(c){return function(o){return c(o)}}function Ut(c,o){return c==null?e:c[o]}function tn(c){var o=!1;if(c!=null&&typeof c.toString!="function")try{o=!!(c+"")}catch{}return o}function le(c){var o=-1,u=Array(c.size);return c.forEach(function(p,x){u[++o]=[x,p]}),u}function en(c,o){return function(u){return c(o(u))}}function Ft(c){var o=-1,u=Array(c.size);return c.forEach(function(p){u[++o]=p}),u}var nn=Array.prototype,Dn=Function.prototype,zn=Object.prototype,ze=G["__core-js_shared__"],In=function(){var c=/[^.]+$/.exec(ze&&ze.keys&&ze.keys.IE_PROTO||"");return c?"Symbol(src)_1."+c:""}(),Ue=Dn.toString,Se=zn.hasOwnProperty,$n=Ue.call(Object),ei=zn.toString,ms=RegExp("^"+Ue.call(Se).replace(ut,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Ii=ot?G.Buffer:e,Dt=G.Symbol,$i=G.Uint8Array,Ji=en(Object.getPrototypeOf,Object),Fr=Object.create,so=zn.propertyIsEnumerable,oo=nn.splice,ao=Object.getOwnPropertySymbols,an=Ii?Ii.isBuffer:e,Zt=en(Object.keys,Object),_r=Math.max,ys=zi(G,"DataView"),ji=zi(G,"Map"),_s=zi(G,"Promise"),rn=zi(G,"Set"),vr=zi(G,"WeakMap"),En=zi(Object,"create"),Ci=!so.call({valueOf:1},"valueOf"),Ki=sr(ys),uo=sr(ji),vs=sr(_s),Ur=sr(rn),Ge=sr(vr),xs=Dt?Dt.prototype:e,Ai=xs?xs.valueOf:e,Gr=xs?xs.toString:e;function se(){}function mi(c){var o=-1,u=c?c.length:0;for(this.clear();++o<u;){var p=c[o];this.set(p[0],p[1])}}function lo(){this.__data__=En?En(null):{}}function Wo(c){return this.has(c)&&delete this.__data__[c]}function ho(c){var o=this.__data__;if(En){var u=o[c];return u===a?e:u}return Se.call(o,c)?o[c]:e}function xn(c){var o=this.__data__;return En?o[c]!==e:Se.call(o,c)}function Qi(c,o){var u=this.__data__;return u[c]=En&&o===e?a:o,this}mi.prototype.clear=lo,mi.prototype.delete=Wo,mi.prototype.get=ho,mi.prototype.has=xn,mi.prototype.set=Qi;function Bn(c){var o=-1,u=c?c.length:0;for(this.clear();++o<u;){var p=c[o];this.set(p[0],p[1])}}function ni(){this.__data__=[]}function he(c){var o=this.__data__,u=_e(o,c);if(u<0)return!1;var p=o.length-1;return u==p?o.pop():oo.call(o,u,1),!0}function Ne(c){var o=this.__data__,u=_e(o,c);return u<0?e:o[u][1]}function ws(c){return _e(this.__data__,c)>-1}function xr(c,o){var u=this.__data__,p=_e(u,c);return p<0?u.push([c,o]):u[p][1]=o,this}Bn.prototype.clear=ni,Bn.prototype.delete=he,Bn.prototype.get=Ne,Bn.prototype.has=ws,Bn.prototype.set=xr;function wn(c){var o=-1,u=c?c.length:0;for(this.clear();++o<u;){var p=c[o];this.set(p[0],p[1])}}function bs(){this.__data__={hash:new mi,map:new(ji||Bn),string:new mi}}function Qt(c){return cn(this,c).delete(c)}function xe(c){return cn(this,c).get(c)}function ii(c){return cn(this,c).has(c)}function Vr(c,o){return cn(this,c).set(c,o),this}wn.prototype.clear=bs,wn.prototype.delete=Qt,wn.prototype.get=xe,wn.prototype.has=ii,wn.prototype.set=Vr;function Ve(c){var o=-1,u=c?c.length:0;for(this.__data__=new wn;++o<u;)this.add(c[o])}function iu(c){return this.__data__.set(c,a),this}function Es(c){return this.__data__.has(c)}Ve.prototype.add=Ve.prototype.push=iu,Ve.prototype.has=Es;function sn(c){this.__data__=new Bn(c)}function qe(){this.__data__=new Bn}function Ni(c){return this.__data__.delete(c)}function yi(c){return this.__data__.get(c)}function wr(c){return this.__data__.has(c)}function co(c,o){var u=this.__data__;if(u instanceof Bn){var p=u.__data__;if(!ji||p.length<n-1)return p.push([c,o]),this;u=this.__data__=new wn(p)}return u.set(c,o),this}sn.prototype.clear=qe,sn.prototype.delete=Ni,sn.prototype.get=yi,sn.prototype.has=wr,sn.prototype.set=co;function tr(c,o){var u=fn(c)||Ln(c)?be(c.length,String):[],p=u.length,x=!!p;for(var M in c)(o||Se.call(c,M))&&!(x&&(M=="length"||rr(M,p)))&&u.push(M);return u}function qr(c,o,u){(u!==e&&!or(c[o],u)||typeof o=="number"&&u===e&&!(o in c))&&(c[o]=u)}function br(c,o,u){var p=c[o];(!(Se.call(c,o)&&or(p,u))||u===e&&!(o in c))&&(c[o]=u)}function _e(c,o){for(var u=c.length;u--;)if(or(c[u][0],o))return u;return-1}function _i(c,o){return c&&Fn(o,on(o),c)}function Oi(c,o,u,p,x,M,D){var Z;if(p&&(Z=M?p(c,x,M,D):p(c)),Z!==e)return Z;if(!Ke(c))return c;var Q=fn(c);if(Q){if(Z=yo(c),!o)return Jo(c,Z)}else{var rt=Un(c),dt=rt==b||rt==S;if(ar(c))return Ts(c,o);if(rt==C||rt==g||dt&&!M){if(tn(c))return M?c:{};if(Z=_o(dt?{}:c),!o)return Ps(c,_i(Z,c))}else{if(!_t[rt])return M?c:{};Z=Gn(c,rt,Oi,o)}}D||(D=new sn);var gt=D.get(c);if(gt)return gt;if(D.set(c,Z),!Q)var Tt=u?Ko(c):on(c);return St(Tt||c,function(Ot,zt){Tt&&(zt=Ot,Ot=c[zt]),br(Z,zt,Oi(Ot,o,u,p,zt,c,D))}),Z}function Er(c){return Ke(c)?Fr(c):{}}var Cn=si(ks),kn=au();function ks(c,o){return c&&kn(c,o,on)}function te(c,o){o=Bi(o,c)?[o]:ee(o);for(var u=0,p=o.length;c!=null&&u<p;)c=c[Ns(o[u++])];return u&&u==p?c:e}function ri(c,o,u){var p=o(c);return fn(c)?p:Ct(p,u(c))}function Le(c){return ei.call(c)}function Zr(c,o){return c!=null&&o in Object(c)}function Hr(c,o,u,p,x){return c===o?!0:c==null||o==null||!Ke(c)&&!oi(o)?c!==c&&o!==o:Ms(c,o,Hr,u,p,x)}function Ms(c,o,u,p,x,M){var D=fn(c),Z=fn(o),Q=m,rt=m;D||(Q=Un(c),Q=Q==g?C:Q),Z||(rt=Un(o),rt=rt==g?C:rt);var dt=Q==C&&!tn(c),gt=rt==C&&!tn(o),Tt=Q==rt;if(Tt&&!dt)return M||(M=new sn),D||Rs(c)?mo(c,o,u,p,x,M):Di(c,o,Q,u,p,x,M);if(!(x&f)){var Ot=dt&&Se.call(c,"__wrapped__"),zt=gt&&Se.call(o,"__wrapped__");if(Ot||zt){var qt=Ot?c.value():c,ne=zt?o.value():o;return M||(M=new sn),u(qt,ne,p,x,M)}}return Tt?(M||(M=new sn),jo(c,o,u,p,x,M)):!1}function de(c,o,u,p){var x=u.length,M=x;if(c==null)return!M;for(c=Object(c);x--;){var D=u[x];if(D[2]?D[1]!==c[D[0]]:!(D[0]in c))return!1}for(;++x<M;){D=u[x];var Z=D[0],Q=c[Z],rt=D[1];if(D[2]){if(Q===e&&!(Z in c))return!1}else{var dt=new sn,gt;if(!(gt===e?Hr(rt,Q,p,l|f,dt):gt))return!1}}return!0}function un(c){if(!Ke(c)||Nn(c))return!1;var o=ur(c)||tn(c)?ms:at;return o.test(sr(c))}function Yr(c){return oi(c)&&Os(c.length)&&!!xt[ei.call(c)]}function er(c){return typeof c=="function"?c:c==null?wi:typeof c=="object"?fn(c)?fo(c[0],c[1]):ln(c):$r(c)}function Be(c){if(!kr(c))return Zt(c);var o=[];for(var u in Object(c))Se.call(c,u)&&u!="constructor"&&o.push(u);return o}function vi(c){if(!Ke(c))return vo(c);var o=kr(c),u=[];for(var p in c)p=="constructor"&&(o||!Se.call(c,p))||u.push(p);return u}function ln(c){var o=Qo(c);return o.length==1&&o[0][2]?As(o[0][0],o[0][1]):function(u){return u===c||de(u,c,o)}}function fo(c,o){return Bi(c)&&Cs(o)?As(Ns(c),o):function(u){var p=hr(u,c);return p===e&&p===o?Eo(u,c):Hr(o,p,e,l|f)}}function Ls(c,o,u,p,x){if(c!==o){if(!(fn(o)||Rs(o)))var M=vi(o);St(M||o,function(D,Z){if(M&&(Z=D,D=o[Z]),Ke(D))x||(x=new sn),po(c,o,Z,u,Ls,p,x);else{var Q=p?p(c[Z],D,Z+"",c,o,x):e;Q===e&&(Q=D),qr(c,Z,Q)}})}}function po(c,o,u,p,x,M,D){var Z=c[u],Q=o[u],rt=D.get(Q);if(rt){qr(c,u,rt);return}var dt=M?M(Z,Q,u+"",c,o,D):e,gt=dt===e;gt&&(dt=Q,fn(Q)||Rs(Q)?fn(Z)?dt=Z:wo(Z)?dt=Jo(Z):(gt=!1,dt=Oi(Q,!0)):bo(Q)||Ln(Q)?Ln(Z)?dt=Jn(Z):!Ke(Z)||p&&ur(Z)?(gt=!1,dt=Oi(Q,!0)):dt=Z:gt=!1),gt&&(D.set(Q,dt),x(dt,Q,p,M,D),D.delete(Q)),qr(c,u,dt)}function Ss(c){return function(o){return te(o,c)}}function ru(c,o){return o=_r(o===e?c.length-1:o,0),function(){for(var u=arguments,p=-1,x=_r(u.length-o,0),M=Array(x);++p<x;)M[p]=u[o+p];p=-1;for(var D=Array(o+1);++p<o;)D[p]=u[p];return D[o]=M,At(c,this,D)}}function go(c){if(typeof c=="string")return c;if(lr(c))return Gr?Gr.call(c):"";var o=c+"";return o=="0"&&1/c==-1/0?"-0":o}function ee(c){return fn(c)?c:xo(c)}function Ts(c,o){if(o)return c.slice();var u=new c.constructor(c.length);return c.copy(u),u}function An(c){var o=new c.constructor(c.byteLength);return new $i(o).set(new $i(c)),o}function hn(c,o){var u=o?An(c.buffer):c.buffer;return new c.constructor(u,c.byteOffset,c.byteLength)}function nr(c,o,u){var p=o?u(le(c),!0):le(c);return Bt(p,Lt,new c.constructor)}function su(c){var o=new c.constructor(c.source,Et.exec(c));return o.lastIndex=c.lastIndex,o}function Ri(c,o,u){var p=o?u(Ft(c),!0):Ft(c);return Bt(p,yt,new c.constructor)}function $o(c){return Ai?Object(Ai.call(c)):{}}function ir(c,o){var u=o?An(c.buffer):c.buffer;return new c.constructor(u,c.byteOffset,c.length)}function Jo(c,o){var u=-1,p=c.length;for(o||(o=Array(p));++u<p;)o[u]=c[u];return o}function Fn(c,o,u,p){u||(u={});for(var x=-1,M=o.length;++x<M;){var D=o[x],Z=e;br(u,D,Z===e?c[D]:Z)}return u}function Ps(c,o){return Fn(c,ta(c),o)}function ou(c){return ru(function(o,u){var p=-1,x=u.length,M=x>1?u[x-1]:e,D=x>2?u[2]:e;for(M=c.length>3&&typeof M=="function"?(x--,M):e,D&&Ye(u[0],u[1],D)&&(M=x<3?e:M,x=1),o=Object(o);++p<x;){var Z=u[p];Z&&c(o,Z,p,M)}return o})}function si(c,o){return function(u,p){if(u==null)return u;if(!Vn(u))return c(u,p);for(var x=u.length,M=-1,D=Object(u);++M<x&&p(D[M],M,D)!==!1;);return u}}function au(c){return function(o,u,p){for(var x=-1,M=Object(o),D=p(o),Z=D.length;Z--;){var Q=D[++x];if(u(M[Q],Q,M)===!1)break}return o}}function mo(c,o,u,p,x,M){var D=x&f,Z=c.length,Q=o.length;if(Z!=Q&&!(D&&Q>Z))return!1;var rt=M.get(c);if(rt&&M.get(o))return rt==o;var dt=-1,gt=!0,Tt=x&l?new Ve:e;for(M.set(c,o),M.set(o,c);++dt<Z;){var Ot=c[dt],zt=o[dt];if(p)var qt=D?p(zt,Ot,dt,o,c,M):p(Ot,zt,dt,c,o,M);if(qt!==e){if(qt)continue;gt=!1;break}if(Tt){if(!ue(o,function(ne,jt){if(!Tt.has(jt)&&(Ot===ne||u(Ot,ne,p,x,M)))return Tt.add(jt)})){gt=!1;break}}else if(!(Ot===zt||u(Ot,zt,p,x,M))){gt=!1;break}}return M.delete(c),M.delete(o),gt}function Di(c,o,u,p,x,M,D){switch(u){case V:if(c.byteLength!=o.byteLength||c.byteOffset!=o.byteOffset)return!1;c=c.buffer,o=o.buffer;case B:return!(c.byteLength!=o.byteLength||!p(new $i(c),new $i(o)));case v:case _:case k:return or(+c,+o);case w:return c.name==o.name&&c.message==o.message;case P:case U:return c==o+"";case N:var Z=le;case q:var Q=M&f;if(Z||(Z=Ft),c.size!=o.size&&!Q)return!1;var rt=D.get(c);if(rt)return rt==o;M|=l,D.set(c,o);var dt=mo(Z(c),Z(o),p,x,M,D);return D.delete(c),dt;case I:if(Ai)return Ai.call(c)==Ai.call(o)}return!1}function jo(c,o,u,p,x,M){var D=x&f,Z=on(c),Q=Z.length,rt=on(o),dt=rt.length;if(Q!=dt&&!D)return!1;for(var gt=Q;gt--;){var Tt=Z[gt];if(!(D?Tt in o:Se.call(o,Tt)))return!1}var Ot=M.get(c);if(Ot&&M.get(o))return Ot==o;var zt=!0;M.set(c,o),M.set(o,c);for(var qt=D;++gt<Q;){Tt=Z[gt];var ne=c[Tt],jt=o[Tt];if(p)var Ee=D?p(jt,ne,Tt,o,c,M):p(ne,jt,Tt,c,o,M);if(!(Ee===e?ne===jt||u(ne,jt,p,x,M):Ee)){zt=!1;break}qt||(qt=Tt=="constructor")}if(zt&&!qt){var Pe=c.constructor,Ze=o.constructor;Pe!=Ze&&"constructor"in c&&"constructor"in o&&!(typeof Pe=="function"&&Pe instanceof Pe&&typeof Ze=="function"&&Ze instanceof Ze)&&(zt=!1)}return M.delete(c),M.delete(o),zt}function Ko(c){return ri(c,on,ta)}function xi(){var c=se.iteratee||Lr;return c=c===Lr?er:c,arguments.length?c(arguments[0],arguments[1]):c}function cn(c,o){var u=c.__data__;return Xr(o)?u[typeof o=="string"?"string":"hash"]:u.map}function Qo(c){for(var o=on(c),u=o.length;u--;){var p=o[u],x=c[p];o[u]=[p,x,Cs(x)]}return o}function zi(c,o){var u=Ut(c,o);return un(u)?u:e}var ta=ao?en(ao,Object):dn,Un=Le;(ys&&Un(new ys(new ArrayBuffer(1)))!=V||ji&&Un(new ji)!=N||_s&&Un(_s.resolve())!=A||rn&&Un(new rn)!=q||vr&&Un(new vr)!=O)&&(Un=function(c){var o=ei.call(c),u=o==C?c.constructor:e,p=u?sr(u):e;if(p)switch(p){case Ki:return V;case uo:return N;case vs:return A;case Ur:return q;case Ge:return O}return o});function Is(c,o,u){o=Bi(o,c)?[o]:ee(o);for(var p,x=-1,D=o.length;++x<D;){var M=Ns(o[x]);if(!(p=c!=null&&u(c,M)))break;c=c[M]}if(p)return p;var D=c?c.length:0;return!!D&&Os(D)&&rr(M,D)&&(fn(c)||Ln(c))}function yo(c){var o=c.length,u=c.constructor(o);return o&&typeof c[0]=="string"&&Se.call(c,"index")&&(u.index=c.index,u.input=c.input),u}function _o(c){return typeof c.constructor=="function"&&!kr(c)?Er(Ji(c)):{}}function Gn(c,o,u,p){var x=c.constructor;switch(o){case B:return An(c);case v:case _:return new x(+c);case V:return hn(c,p);case z:case W:case T:case $:case F:case X:case Y:case j:case J:return ir(c,p);case N:return nr(c,p,u);case k:case U:return new x(c);case P:return su(c);case q:return Ri(c,p,u);case I:return $o(c)}}function rr(c,o){return o=o??d,!!o&&(typeof c=="number"||Rt.test(c))&&c>-1&&c%1==0&&c<o}function Ye(c,o,u){if(!Ke(u))return!1;var p=typeof o;return(p=="number"?Vn(u)&&rr(o,u.length):p=="string"&&o in u)?or(u[o],c):!1}function Bi(c,o){if(fn(c))return!1;var u=typeof c;return u=="number"||u=="symbol"||u=="boolean"||c==null||lr(c)?!0:et.test(c)||!K.test(c)||o!=null&&c in Object(o)}function Xr(c){var o=typeof c;return o=="string"||o=="number"||o=="symbol"||o=="boolean"?c!=="__proto__":c===null}function Nn(c){return!!In&&In in c}function kr(c){var o=c&&c.constructor,u=typeof o=="function"&&o.prototype||zn;return c===u}function Cs(c){return c===c&&!Ke(c)}function As(c,o){return function(u){return u==null?!1:u[c]===o&&(o!==e||c in Object(u))}}function vo(c){var o=[];if(c!=null)for(var u in Object(c))o.push(u);return o}var xo=Mn(function(c){c=Ds(c);var o=[];return ft.test(c)&&o.push(""),c.replace(lt,function(u,p,x,M){o.push(x?M.replace(mt,"$1"):p||u)}),o});function Ns(c){if(typeof c=="string"||lr(c))return c;var o=c+"";return o=="0"&&1/c==-1/0?"-0":o}function sr(c){if(c!=null){try{return Ue.call(c)}catch{}try{return c+""}catch{}}return""}function ea(c){for(var o=-1,u=c?c.length:0,p=0,x=[];++o<u;){var M=c[o];M&&(x[p++]=M)}return x}function na(c,o){var u=fn(c)?St:Cn;return u(c,xi(o,3))}function Mn(c,o){if(typeof c!="function"||o&&typeof o!="function")throw new TypeError(s);var u=function(){var p=arguments,x=o?o.apply(this,p):p[0],M=u.cache;if(M.has(x))return M.get(x);var D=c.apply(this,p);return u.cache=M.set(x,D),D};return u.cache=new(Mn.Cache||wn),u}Mn.Cache=wn;function Mr(c){return Oi(c,!1,!0)}function or(c,o){return c===o||c!==c&&o!==o}function Ln(c){return wo(c)&&Se.call(c,"callee")&&(!so.call(c,"callee")||ei.call(c)==g)}var fn=Array.isArray;function Vn(c){return c!=null&&Os(c.length)&&!ur(c)}function wo(c){return oi(c)&&Vn(c)}var ar=an||pn;function ia(c){if(Vn(c)&&(fn(c)||typeof c=="string"||typeof c.splice=="function"||ar(c)||Ln(c)))return!c.length;var o=Un(c);if(o==N||o==q)return!c.size;if(Ci||kr(c))return!Zt(c).length;for(var u in c)if(Se.call(c,u))return!1;return!0}function ur(c){var o=Ke(c)?ei.call(c):"";return o==b||o==S}function Os(c){return typeof c=="number"&&c>-1&&c%1==0&&c<=d}function Ke(c){var o=typeof c;return!!c&&(o=="object"||o=="function")}function oi(c){return!!c&&typeof c=="object"}function bo(c){if(!oi(c)||ei.call(c)!=C||tn(c))return!1;var o=Ji(c);if(o===null)return!0;var u=Se.call(o,"constructor")&&o.constructor;return typeof u=="function"&&u instanceof u&&Ue.call(u)==$n}function lr(c){return typeof c=="symbol"||oi(c)&&ei.call(c)==I}var Rs=kt?Xt(kt):Yr;function Jn(c){return Fn(c,Wr(c))}function Ds(c){return c==null?"":go(c)}function hr(c,o,u){var p=c==null?e:te(c,o);return p===e?u:p}function Eo(c,o){return c!=null&&Is(c,o,Zr)}function on(c){return Vn(c)?tr(c):Be(c)}function Wr(c){return Vn(c)?tr(c,!0):vi(c)}var ra=ou(function(c,o,u){Ls(c,o,u)});function wi(c){return c}function Lr(c){return er(typeof c=="function"?c:Oi(c,!0))}function $r(c){return Bi(c)?Pt(Ns(c)):Ss(c)}function dn(){return[]}function pn(){return!1}se.compact=ea,se.iteratee=Lr,se.keys=on,se.keysIn=Wr,se.memoize=Mn,se.merge=ra,se.property=$r,se.toPlainObject=Jn,se.clone=Mr,se.eq=or,se.forEach=na,se.get=hr,se.hasIn=Eo,se.identity=wi,se.isArguments=Ln,se.isArray=fn,se.isArrayLike=Vn,se.isArrayLikeObject=wo,se.isBuffer=ar,se.isEmpty=ia,se.isFunction=ur,se.isLength=Os,se.isObject=Ke,se.isObjectLike=oi,se.isPlainObject=bo,se.isSymbol=lr,se.isTypedArray=Rs,se.stubArray=dn,se.stubFalse=pn,se.toString=Ds,se.each=na,se.VERSION=i,ht&&((ht.exports=se)._=se,ct._=se)}).call(Q1)}(Eu,Eu.exports)),Eu.exports}var yc,Ep;function ex(){if(Ep)return yc;Ep=1,yc=r;function r(i,n){var s=i&&i.type,a;if(s==="FeatureCollection")for(a=0;a<i.features.length;a++)r(i.features[a],n);else if(s==="GeometryCollection")for(a=0;a<i.geometries.length;a++)r(i.geometries[a],n);else if(s==="Feature")r(i.geometry,n);else if(s==="Polygon")t(i.coordinates,n);else if(s==="MultiPolygon")for(a=0;a<i.coordinates.length;a++)t(i.coordinates[a],n);return i}function t(i,n){if(i.length!==0){e(i[0],n);for(var s=1;s<i.length;s++)e(i[s],!n)}}function e(i,n){for(var s=0,a=0,l=0,f=i.length,d=f-1;l<f;d=l++){var g=(i[l][0]-i[d][0])*(i[d][1]+i[l][1]),m=s+g;a+=Math.abs(s)>=Math.abs(g)?s-m+g:g-m+s,s=m}s+a>=0!=!!n&&i.reverse()}return yc}const nx=[{key:"building",polygon:"all"},{key:"highway",polygon:"whitelist",values:["services","rest_area","escape","elevator"]},{key:"natural",polygon:"blacklist",values:["coastline","cliff","ridge","arete","tree_row"]},{key:"landuse",polygon:"all"},{key:"waterway",polygon:"whitelist",values:["riverbank","dock","boatyard","dam"]},{key:"amenity",polygon:"all"},{key:"leisure",polygon:"all"},{key:"barrier",polygon:"whitelist",values:["city_wall","ditch","hedge","retaining_wall","wall","spikes"]},{key:"railway",polygon:"whitelist",values:["station","turntable","roundhouse","platform"]},{key:"area",polygon:"all"},{key:"boundary",polygon:"all"},{key:"man_made",polygon:"blacklist",values:["cutline","embankment","pipeline"]},{key:"power",polygon:"whitelist",values:["plant","substation","generator","transformer"]},{key:"place",polygon:"all"},{key:"shop",polygon:"all"},{key:"aeroway",polygon:"blacklist",values:["taxiway"]},{key:"tourism",polygon:"all"},{key:"historic",polygon:"all"},{key:"public_transport",polygon:"all"},{key:"office",polygon:"all"},{key:"building:part",polygon:"all"},{key:"military",polygon:"all"},{key:"ruins",polygon:"all"},{key:"area:highway",polygon:"all"},{key:"craft",polygon:"all"},{key:"golf",polygon:"all"},{key:"indoor",polygon:"all"}];var _c,kp;function ix(){return kp||(kp=1,_c=nx),_c}var vc,Mp;function rx(){if(Mp)return vc;Mp=1;var r=tx(),t=ex(),e={};ix().forEach(function(a){if(a.polygon==="all")e[a.key]=!0;else{var l=a.polygon==="whitelist"?"included_values":"excluded_values",f={};a.values.forEach(function(d){f[d]=!0}),e[a.key]={},e[a.key][l]=f}});function i(a,l){return(a.version||l.version)&&a.version!==l.version?(+a.version||0)>(+l.version||0)?a:l:r.merge(a,l)}var n={};n=function(a,l,f){l=r.merge({verbose:!1,flatProperties:!0,uninterestingTags:{source:!0,source_ref:!0,"source:ref":!0,history:!0,attribution:!0,created_by:!0,"tiger:county":!0,"tiger:tlid":!0,"tiger:upload_uuid":!0},polygonFeatures:e,deduplicator:i},l);var d;return typeof XMLDocument<"u"&&a instanceof XMLDocument||typeof XMLDocument>"u"&&a.childNodes?d=m(a):d=g(a),d;function g(w){var b=new Array,S=new Array,N=new Array;function k(V){var z=r.clone(V);z.lat=V.center.lat,z.lon=V.center.lon,z.__is_center_placeholder=!0,b.push(z)}function C(V){var z=r.clone(V);z.nodes=[];function W(T,$,F){var X={type:"node",id:"_"+z.type+"/"+z.id+"bounds"+F,lat:T,lon:$};z.nodes.push(X.id),b.push(X)}W(z.bounds.minlat,z.bounds.minlon,1),W(z.bounds.maxlat,z.bounds.minlon,2),W(z.bounds.maxlat,z.bounds.maxlon,3),W(z.bounds.minlat,z.bounds.maxlon,4),z.nodes.push(z.nodes[0]),z.__is_bounds_placeholder=!0,S.push(z)}function A(V){function z(W,T,$){var F={type:"node",id:$,lat:W,lon:T};b.push(F)}r.isArray(V.nodes)||(V.nodes=V.geometry.map(function(W){return W!==null?"_anonymous@"+W.lat+"/"+W.lon:"_anonymous@unknown_location"})),V.geometry.forEach(function(W,T){W&&z(W.lat,W.lon,V.nodes[T])})}function P(V){function z(T,$,F){var X={type:"node",id:F,lat:T,lon:$};b.push(X)}function W(T,$){if(S.some(function(Y){return Y.type=="way"&&Y.id==$}))return;var F={type:"way",id:$,nodes:[]};function X(Y,j){var J={type:"node",id:"_anonymous@"+Y+"/"+j,lat:Y,lon:j};F.nodes.push(J.id),b.push(J)}T.forEach(function(Y){Y?X(Y.lat,Y.lon):F.nodes.push(void 0)}),S.push(F)}V.members.forEach(function(T,$){T.type=="node"?T.lat&&z(T.lat,T.lon,T.ref):T.type=="way"&&T.geometry&&(T.ref="_fullGeom"+T.ref,W(T.geometry,T.ref))})}for(var q=0;q<w.elements.length;q++)switch(w.elements[q].type){case"node":var U=w.elements[q];b.push(U);break;case"way":var I=r.clone(w.elements[q]);I.nodes=r.clone(I.nodes),S.push(I),I.center&&k(I),I.geometry?A(I):I.bounds&&C(I);break;case"relation":var O=r.clone(w.elements[q]);O.members=r.clone(O.members),N.push(O);var B=O.members&&O.members.some(function(V){return V.type=="node"&&V.lat||V.type=="way"&&V.geometry&&V.geometry.length>0});O.center&&k(O),B?P(O):O.bounds&&C(O);break}return v(b,S,N)}function m(w){var b=new Array,S=new Array,N=new Array;function k(O,B,V){O.hasAttribute(V)&&(B[V]=O.getAttribute(V))}function C(O,B){var V=r.clone(O);k(B,V,"lat"),k(B,V,"lon"),V.__is_center_placeholder=!0,b.push(V)}function A(O,B){var V=r.clone(O);V.nodes=[];function z(W,T,$){var F={type:"node",id:"_"+V.type+"/"+V.id+"bounds"+$,lat:W,lon:T};V.nodes.push(F.id),b.push(F)}z(B.getAttribute("minlat"),B.getAttribute("minlon"),1),z(B.getAttribute("maxlat"),B.getAttribute("minlon"),2),z(B.getAttribute("maxlat"),B.getAttribute("maxlon"),3),z(B.getAttribute("minlat"),B.getAttribute("maxlon"),4),V.nodes.push(V.nodes[0]),V.__is_bounds_placeholder=!0,S.push(V)}function P(O,B){function V(z,W,T){var $={type:"node",id:T,lat:z,lon:W};return b.push($),$.id}r.isArray(O.nodes)||(O.nodes=[],r.each(B,function(z,W){O.nodes.push("_anonymous@"+z.getAttribute("lat")+"/"+z.getAttribute("lon"))})),r.each(B,function(z,W){z.getAttribute("lat")&&V(z.getAttribute("lat"),z.getAttribute("lon"),O.nodes[W])})}function q(O,B){function V(W,T,$){var F={type:"node",id:$,lat:W,lon:T};b.push(F)}function z(W,T){if(S.some(function(X){return X.type=="way"&&X.id==T}))return;var $={type:"way",id:T,nodes:[]};function F(X,Y){var j={type:"node",id:"_anonymous@"+X+"/"+Y,lat:X,lon:Y};$.nodes.push(j.id),b.push(j)}r.each(W,function(X){X.getAttribute("lat")?F(X.getAttribute("lat"),X.getAttribute("lon")):$.nodes.push(void 0)}),S.push($)}r.each(B,function(W,T){O.members[T].type=="node"?W.getAttribute("lat")&&V(W.getAttribute("lat"),W.getAttribute("lon"),O.members[T].ref):O.members[T].type=="way"&&W.getElementsByTagName("nd").length>0&&(O.members[T].ref="_fullGeom"+O.members[T].ref,z(W.getElementsByTagName("nd"),O.members[T].ref))})}r.each(w.getElementsByTagName("node"),function(O,B){var V={};r.each(O.getElementsByTagName("tag"),function(W){V[W.getAttribute("k")]=W.getAttribute("v")});var z={type:"node"};k(O,z,"id"),k(O,z,"lat"),k(O,z,"lon"),k(O,z,"version"),k(O,z,"timestamp"),k(O,z,"changeset"),k(O,z,"uid"),k(O,z,"user"),r.isEmpty(V)||(z.tags=V),b.push(z)});var U,I;return r.each(w.getElementsByTagName("way"),function(O,B){var V={},z=[];r.each(O.getElementsByTagName("tag"),function($){V[$.getAttribute("k")]=$.getAttribute("v")});var W=!1;r.each(O.getElementsByTagName("nd"),function($,F){var X;(X=$.getAttribute("ref"))&&(z[F]=X),!W&&$.getAttribute("lat")&&(W=!0)});var T={type:"way"};k(O,T,"id"),k(O,T,"version"),k(O,T,"timestamp"),k(O,T,"changeset"),k(O,T,"uid"),k(O,T,"user"),z.length>0&&(T.nodes=z),r.isEmpty(V)||(T.tags=V),(U=O.getElementsByTagName("center")[0])&&C(T,U),W?P(T,O.getElementsByTagName("nd")):(I=O.getElementsByTagName("bounds")[0])&&A(T,I),S.push(T)}),r.each(w.getElementsByTagName("relation"),function(O,B){var V={},z=[];r.each(O.getElementsByTagName("tag"),function($){V[$.getAttribute("k")]=$.getAttribute("v")});var W=!1;r.each(O.getElementsByTagName("member"),function($,F){z[F]={},k($,z[F],"ref"),k($,z[F],"role"),k($,z[F],"type"),(!W&&z[F].type=="node"&&$.getAttribute("lat")||z[F].type=="way"&&$.getElementsByTagName("nd").length>0)&&(W=!0)});var T={type:"relation"};k(O,T,"id"),k(O,T,"version"),k(O,T,"timestamp"),k(O,T,"changeset"),k(O,T,"uid"),k(O,T,"user"),z.length>0&&(T.members=z),r.isEmpty(V)||(T.tags=V),(U=O.getElementsByTagName("center")[0])&&C(T,U),W?q(T,O.getElementsByTagName("member")):(I=O.getElementsByTagName("bounds")[0])&&A(T,I),N.push(T)}),v(b,S,N)}function v(w,b,S){function N(xt,_t){if(typeof _t!="object"&&(_t={}),typeof l.uninterestingTags=="function")return!l.uninterestingTags(xt,_t);for(var tt in xt)if(l.uninterestingTags[tt]!==!0&&!(_t[tt]===!0||_t[tt]===xt[tt]))return!0;return!1}function k(xt){var _t={timestamp:xt.timestamp,version:xt.version,changeset:xt.changeset,user:xt.user,uid:xt.uid};for(var tt in _t)_t[tt]===void 0&&delete _t[tt];return _t}for(var C=new Object,A=new Object,P=0;P<w.length;P++){var q=w[P];C[q.id]!==void 0&&(q=l.deduplicator(q,C[q.id])),C[q.id]=q,typeof q.tags<"u"&&N(q.tags)&&(A[q.id]=!0)}for(var P=0;P<S.length;P++)if(r.isArray(S[P].members))for(var U=0;U<S[P].members.length;U++)S[P].members[U].type=="node"&&(A[S[P].members[U].ref]=!0);for(var I=new Object,O=new Object,P=0;P<b.length;P++){var B=b[P];if(I[B.id]&&(B=l.deduplicator(B,I[B.id])),I[B.id]=B,r.isArray(B.nodes))for(var U=0;U<B.nodes.length;U++)typeof B.nodes[U]!="object"&&(O[B.nodes[U]]=!0,B.nodes[U]=C[B.nodes[U]])}var V=new Array;for(var z in C){var q=C[z];(!O[z]||A[z])&&V.push(q)}for(var W=new Array,P=0;P<S.length;P++){var T=S[P];W[T.id]&&(T=l.deduplicator(T,W[T.id])),W[T.id]=T}var $={node:{},way:{},relation:{}};for(var z in W){var T=W[z];if(!r.isArray(T.members)){l.verbose&&console.warn("Relation",T.type+"/"+T.id,"ignored because it has no members");continue}for(var U=0;U<T.members.length;U++){var F=T.members[U].type,X=T.members[U].ref;if(typeof X!="number"&&(X=X.replace("_fullGeom","")),!$[F]){l.verbose&&console.warn("Relation",T.type+"/"+T.id,"member",F+"/"+X,"ignored because it has an invalid type");continue}typeof $[F][X]>"u"&&($[F][X]=[]),$[F][X].push({role:T.members[U].role,rel:T.id,reltags:T.tags})}}var Y,j=[];for(P=0;P<V.length;P++){if(typeof V[P].lon>"u"||typeof V[P].lat>"u"){l.verbose&&console.warn("POI",V[P].type+"/"+V[P].id,"ignored because it lacks coordinates");continue}var J={type:"Feature",id:V[P].type+"/"+V[P].id,properties:{type:V[P].type,id:V[P].id,tags:V[P].tags||{},relations:$.node[V[P].id]||[],meta:k(V[P])},geometry:{type:"Point",coordinates:[+V[P].lon,+V[P].lat]}};V[P].__is_center_placeholder&&(J.properties.geometry="center"),f?f(J):j.push(J)}for(var K=[],et=[],P=0;P<S.length;P++)if(W[S[P].id]===S[P]){if(typeof S[P].tags<"u"&&(S[P].tags.type=="route"||S[P].tags.type=="waterway")){let _t=function(tt){var wt=!1,G;G=tt.members.filter(function(it){return it.type==="way"}),G=G.map(function(it){var st=I[it.ref];if(st===void 0||st.nodes===void 0){l.verbose&&console.warn("Route "+tt.type+"/"+tt.id,"tainted by a missing or incomplete  way",it.type+"/"+it.ref),wt=!0;return}return{id:it.ref,role:it.role,way:st,nodes:st.nodes.filter(function(kt){return kt!==void 0?!0:(wt=!0,l.verbose&&console.warn("Route",tt.type+"/"+tt.id,"tainted by a way",it.type+"/"+it.ref,"with a missing node"),!1)})}}),G=r.compact(G);var ct;ct=s(G);var ht=[];if(ht=r.compact(ct.map(function(it){return r.compact(it.map(function(st){return[+st.lon,+st.lat]}))})),ht.length==0)return l.verbose&&console.warn("Route",tt.type+"/"+tt.id,"contains no coordinates"),!1;var ot={type:"Feature",id:tt.type+"/"+tt.id,properties:{type:tt.type,id:tt.id,tags:tt.tags||{},relations:$[tt.type][tt.id]||[],meta:k(tt)},geometry:{type:ht.length===1?"LineString":"MultiLineString",coordinates:ht.length===1?ht[0]:ht}};return wt&&(l.verbose&&console.warn("Route",tt.type+"/"+tt.id,"is tainted"),ot.properties.tainted=!0),ot};var at=_t;if(!r.isArray(S[P].members)){l.verbose&&console.warn("Route",S[P].type+"/"+S[P].id,"ignored because it has no members");continue}if(S[P].members.forEach(function(tt){I[tt.ref]&&!N(I[tt.ref].tags)&&(I[tt.ref].is_skippablerelationmember=!0)}),J=_t(S[P]),J===!1){l.verbose&&console.warn("Route relation",S[P].type+"/"+S[P].id,"ignored because it has invalid geometry");continue}f?f(t(J)):et.push(J)}if(typeof S[P].tags<"u"&&(S[P].tags.type=="multipolygon"||S[P].tags.type=="boundary")){let tt=function(wt,G){var ct=!1,ht=lt?"way":"relation",ot=typeof wt.id=="number"?wt.id:+wt.id.replace("_fullGeom",""),it;it=G.members.filter(function(Pt){return Pt.type==="way"}),it=it.map(function(Pt){var be=I[Pt.ref];if(be===void 0||be.nodes===void 0){l.verbose&&console.warn("Multipolygon",ht+"/"+ot,"tainted by a missing or incomplete way",Pt.type+"/"+Pt.ref),ct=!0;return}return{id:Pt.ref,role:Pt.role||"outer",way:be,nodes:be.nodes.filter(function(Xt){return Xt!==void 0?!0:(ct=!0,l.verbose&&console.warn("Multipolygon",ht+"/"+ot,"tainted by a way",Pt.type+"/"+Pt.ref,"with a missing node"),!1)})}}),it=r.compact(it);var st,kt;st=s(it.filter(function(Pt){return Pt.role==="outer"})),kt=s(it.filter(function(Pt){return Pt.role==="inner"}));var Lt;function yt(Pt){var be=function(en,Ft){for(var nn=0;nn<Ft.length;nn++)if(Ut(Ft[nn],en))return!0;return!1},Xt=function(en){return en.map(function(Ft){return[+Ft.lat,+Ft.lon]})},Ut=function(en,Ft){for(var nn=en[0],Dn=en[1],zn=!1,ze=0,In=Ft.length-1;ze<Ft.length;In=ze++){var Ue=Ft[ze][0],Se=Ft[ze][1],$n=Ft[In][0],ei=Ft[In][1],ms=Se>Dn!=ei>Dn&&nn<($n-Ue)*(Dn-Se)/(ei-Se)+Ue;ms&&(zn=!zn)}return zn},tn,le;for(Pt=Xt(Pt),tn=0;tn<st.length;tn++)if(le=Xt(st[tn]),be(le,Pt))return tn}Lt=st.map(function(Pt){return[Pt]});for(var At=0;At<kt.length;At++){var St=yt(kt[At]);St!==void 0?Lt[St].push(kt[At]):l.verbose&&console.warn("Multipolygon",ht+"/"+ot,"contains an inner ring with no containing outer")}var Ct=[];if(Ct=r.compact(Lt.map(function(Pt){var be=r.compact(Pt.map(function(Xt){if(Xt.length<4){l.verbose&&console.warn("Multipolygon",ht+"/"+ot,"contains a ring with less than four nodes");return}return r.compact(Xt.map(function(Ut){return[+Ut.lon,+Ut.lat]}))}));if(be.length==0){l.verbose&&console.warn("Multipolygon",ht+"/"+ot,"contains an empty ring cluster");return}return be})),Ct.length==0)return l.verbose&&console.warn("Multipolygon",ht+"/"+ot,"contains no coordinates"),!1;var Bt="MultiPolygon";Ct.length===1&&(Bt="Polygon",Ct=Ct[0]);var ue={type:"Feature",id:wt.type+"/"+ot,properties:{type:wt.type,id:ot,tags:wt.tags||{},relations:$[wt.type][wt.id]||[],meta:k(wt)},geometry:{type:Bt,coordinates:Ct}};return ct&&(l.verbose&&console.warn("Multipolygon",ht+"/"+ot,"is tainted"),ue.properties.tainted=!0),ue};var Rt=tt;if(!r.isArray(S[P].members)){l.verbose&&console.warn("Multipolygon",S[P].type+"/"+S[P].id,"ignored because it has no members");continue}for(var ft=0,U=0;U<S[P].members.length;U++)S[P].members[U].role=="outer"?ft++:l.verbose&&S[P].members[U].role!="inner"&&console.warn("Multipolygon",S[P].type+"/"+S[P].id,"member",S[P].members[U].type+"/"+S[P].members[U].ref,'ignored because it has an invalid role: "'+S[P].members[U].role+'"');if(S[P].members.forEach(function(wt){I[wt.ref]&&(wt.role==="outer"&&!N(I[wt.ref].tags,S[P].tags)&&(I[wt.ref].is_skippablerelationmember=!0),wt.role==="inner"&&!N(I[wt.ref].tags)&&(I[wt.ref].is_skippablerelationmember=!0))}),ft==0){l.verbose&&console.warn("Multipolygon relation",S[P].type+"/"+S[P].id,"ignored because it has no outer ways");continue}var lt=!1;ft==1&&!N(S[P].tags,{type:!0})&&(lt=!0);var J=null;if(!lt)J=tt(S[P],S[P]);else{var ut=S[P].members.filter(function(wt){return wt.role==="outer"})[0];if(ut=I[ut.ref],ut===void 0){l.verbose&&console.warn("Multipolygon relation",S[P].type+"/"+S[P].id,"ignored because outer way",ut.type+"/"+ut.ref,"is missing");continue}ut.is_skippablerelationmember=!0,J=tt(ut,S[P])}if(J===!1){l.verbose&&console.warn("Multipolygon relation",S[P].type+"/"+S[P].id,"ignored because it has invalid geometry");continue}f?f(t(J)):et.push(J)}}for(var P=0;P<b.length;P++)if(I[b[P].id]===b[P]){if(!r.isArray(b[P].nodes)){l.verbose&&console.warn("Way",b[P].type+"/"+b[P].id,"ignored because it has no nodes");continue}if(!b[P].is_skippablerelationmember){typeof b[P].id!="number"&&(b[P].id=+b[P].id.replace("_fullGeom","")),b[P].tainted=!1,b[P].hidden=!1;var mt=new Array;for(U=0;U<b[P].nodes.length;U++)typeof b[P].nodes[U]=="object"?mt.push([+b[P].nodes[U].lon,+b[P].nodes[U].lat]):(l.verbose&&console.warn("Way",b[P].type+"/"+b[P].id,"is tainted by an invalid node"),b[P].tainted=!0);if(mt.length<=1){l.verbose&&console.warn("Way",b[P].type+"/"+b[P].id,"ignored because it contains too few nodes");continue}var Et="LineString";typeof b[P].nodes[0]<"u"&&typeof b[P].nodes[b[P].nodes.length-1]<"u"&&b[P].nodes[0].id===b[P].nodes[b[P].nodes.length-1].id&&(typeof b[P].tags<"u"&&_(b[P].tags)||b[P].__is_bounds_placeholder)&&(Et="Polygon",mt=[mt]);var J={type:"Feature",id:b[P].type+"/"+b[P].id,properties:{type:b[P].type,id:b[P].id,tags:b[P].tags||{},relations:$.way[b[P].id]||[],meta:k(b[P])},geometry:{type:Et,coordinates:mt}};b[P].tainted&&(l.verbose&&console.warn("Way",b[P].type+"/"+b[P].id,"is tainted"),J.properties.tainted=!0),b[P].__is_bounds_placeholder&&(J.properties.geometry="bounds"),f?f(t(J)):Et=="LineString"?K.push(J):et.push(J)}}return f?!0:(Y={type:"FeatureCollection",features:[]},Y.features=Y.features.concat(et),Y.features=Y.features.concat(K),Y.features=Y.features.concat(j),l.flatProperties&&Y.features.forEach(function(xt){xt.properties=r.merge(xt.properties.meta,xt.properties.tags,{id:xt.properties.type+"/"+xt.properties.id})}),Y=t(Y),Y)}function _(w){var b=l.polygonFeatures;if(typeof b=="function")return b(w);if(w.area==="no")return!1;for(var S in w){var N=w[S],k=b[S];if(!(typeof k>"u")&&N!=="no"&&(k===!0||k.included_values&&k.included_values[N]===!0||k.excluded_values&&k.excluded_values[N]!==!0))return!0}return!1}};function s(a){for(var l=function(N){return N[0]},f=function(N){return N[N.length-1]},d=function(N,k){return N!==void 0&&k!==void 0&&N.id===k.id},g=[],m,v,_,w,b,S;a.length;)for(m=a.pop().nodes.slice(),g.push(m);a.length&&!d(l(m),f(m));){for(v=l(m),_=f(m),w=0;w<a.length;w++)if(S=a[w].nodes,d(_,l(S))){b=m.push,S=S.slice(1);break}else if(d(_,f(S))){b=m.push,S=S.slice(0,-1).reverse();break}else if(d(v,f(S))){b=m.unshift,S=S.slice(0,-1);break}else if(d(v,l(S))){b=m.unshift,S=S.slice(1).reverse();break}else S=b=null;if(!S)break;a.splice(w,1),b.apply(m,S)}return g}return n.toGeojson=n,vc=n,vc}var sx=rx();const ox=eo(sx);var yn=63710088e-1,Kh={centimeters:yn*100,centimetres:yn*100,degrees:360/(2*Math.PI),feet:yn*3.28084,inches:yn*39.37,kilometers:yn/1e3,kilometres:yn/1e3,meters:yn,metres:yn,miles:yn/1609.344,millimeters:yn*1e3,millimetres:yn*1e3,nauticalmiles:yn/1852,radians:1,yards:yn*1.0936},Th={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,hectares:1e-4,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,nauticalmiles:29155334959812285e-23,millimeters:1e6,millimetres:1e6,yards:1.195990046};function Qe(r,t,e={}){const i={type:"Feature"};return(e.id===0||e.id)&&(i.id=e.id),e.bbox&&(i.bbox=e.bbox),i.properties=t||{},i.geometry=r,i}function pd(r,t,e={}){switch(r){case"Point":return re(t).geometry;case"LineString":return ge(t).geometry;case"Polygon":return $t(t).geometry;case"MultiPoint":return cl(t).geometry;case"MultiLineString":return no(t).geometry;case"MultiPolygon":return pi(t).geometry;default:throw new Error(r+" is invalid")}}function re(r,t,e={}){if(!r)throw new Error("coordinates is required");if(!Array.isArray(r))throw new Error("coordinates must be an Array");if(r.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!_n(r[0])||!_n(r[1]))throw new Error("coordinates must contain numbers");return Qe({type:"Point",coordinates:r},t,e)}function Hy(r,t,e={}){return Yt(r.map(i=>re(i,t)),e)}function $t(r,t,e={}){for(const n of r){if(n.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");if(n[n.length-1].length!==n[0].length)throw new Error("First and last Position are not equivalent.");for(let s=0;s<n[n.length-1].length;s++)if(n[n.length-1][s]!==n[0][s])throw new Error("First and last Position are not equivalent.")}return Qe({type:"Polygon",coordinates:r},t,e)}function Yy(r,t,e={}){return Yt(r.map(i=>$t(i,t)),e)}function ge(r,t,e={}){if(r.length<2)throw new Error("coordinates must be an array of two or more positions");return Qe({type:"LineString",coordinates:r},t,e)}function Xy(r,t,e={}){return Yt(r.map(i=>ge(i,t)),e)}function Yt(r,t={}){const e={type:"FeatureCollection"};return t.id&&(e.id=t.id),t.bbox&&(e.bbox=t.bbox),e.features=r,e}function no(r,t,e={}){return Qe({type:"MultiLineString",coordinates:r},t,e)}function cl(r,t,e={}){return Qe({type:"MultiPoint",coordinates:r},t,e)}function pi(r,t,e={}){return Qe({type:"MultiPolygon",coordinates:r},t,e)}function gd(r,t,e={}){return Qe({type:"GeometryCollection",geometries:r},t,e)}function Wy(r,t=0){if(t&&!(t>=0))throw new Error("precision must be a positive number");const e=Math.pow(10,t||0);return Math.round(r*e)/e}function fl(r,t="kilometers"){const e=Kh[t];if(!e)throw new Error(t+" units is invalid");return r*e}function Ka(r,t="kilometers"){const e=Kh[t];if(!e)throw new Error(t+" units is invalid");return r/e}function Qh(r,t){return cs(Ka(r,t))}function Fa(r){let t=r%360;return t<0&&(t+=360),t}function $y(r){return r=r%360,r>180?r-360:r<-180?r+360:r}function cs(r){return r%(2*Math.PI)*180/Math.PI}function je(r){return r%360*Math.PI/180}function Bo(r,t="kilometers",e="kilometers"){if(!(r>=0))throw new Error("length must be a positive number");return fl(Ka(r,t),e)}function md(r,t="meters",e="kilometers"){if(!(r>=0))throw new Error("area must be a positive number");const i=Th[t];if(!i)throw new Error("invalid original units");const n=Th[e];if(!n)throw new Error("invalid final units");return r/i*n}function _n(r){return!isNaN(r)&&r!==null&&!Array.isArray(r)}function ve(r){return r!==null&&typeof r=="object"&&!Array.isArray(r)}function $u(r){if(!r)throw new Error("bbox is required");if(!Array.isArray(r))throw new Error("bbox must be an Array");if(r.length!==4&&r.length!==6)throw new Error("bbox must be an Array of 4 or 6 numbers");r.forEach(t=>{if(!_n(t))throw new Error("bbox must only contain numbers")})}function Jy(r){if(!r)throw new Error("id is required");if(["string","number"].indexOf(typeof r)===-1)throw new Error("id must be a number or a string")}const ax=Object.freeze(Object.defineProperty({__proto__:null,areaFactors:Th,azimuthToBearing:$y,bearingToAzimuth:Fa,convertArea:md,convertLength:Bo,degreesToRadians:je,earthRadius:yn,factors:Kh,feature:Qe,featureCollection:Yt,geometry:pd,geometryCollection:gd,isNumber:_n,isObject:ve,lengthToDegrees:Qh,lengthToRadians:Ka,lineString:ge,lineStrings:Xy,multiLineString:no,multiPoint:cl,multiPolygon:pi,point:re,points:Hy,polygon:$t,polygons:Yy,radiansToDegrees:cs,radiansToLength:fl,round:Wy,validateBBox:$u,validateId:Jy},Symbol.toStringTag,{value:"Module"}));function me(r){if(!r)throw new Error("coord is required");if(!Array.isArray(r)){if(r.type==="Feature"&&r.geometry!==null&&r.geometry.type==="Point")return[...r.geometry.coordinates];if(r.type==="Point")return[...r.coordinates]}if(Array.isArray(r)&&r.length>=2&&!Array.isArray(r[0])&&!Array.isArray(r[1]))return[...r];throw new Error("coord must be GeoJSON Point or an Array of numbers")}function Jt(r){if(Array.isArray(r))return r;if(r.type==="Feature"){if(r.geometry!==null)return r.geometry.coordinates}else if(r.coordinates)return r.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")}function yd(r){if(r.length>1&&_n(r[0])&&_n(r[1]))return!0;if(Array.isArray(r[0])&&r[0].length)return yd(r[0]);throw new Error("coordinates must only contain numbers")}function jy(r,t,e){if(!t||!e)throw new Error("type and name required");if(!r||r.type!==t)throw new Error("Invalid input to "+e+": must be a "+t+", given "+r.type)}function Ju(r,t,e){if(!r)throw new Error("No feature passed");if(!e)throw new Error(".featureOf() requires a name");if(!r||r.type!=="Feature"||!r.geometry)throw new Error("Invalid input to "+e+", Feature with geometry required");if(!r.geometry||r.geometry.type!==t)throw new Error("Invalid input to "+e+": must be a "+t+", given "+r.geometry.type)}function gs(r,t,e){if(!r)throw new Error("No featureCollection passed");if(!e)throw new Error(".collectionOf() requires a name");if(!r||r.type!=="FeatureCollection")throw new Error("Invalid input to "+e+", FeatureCollection required");for(const i of r.features){if(!i||i.type!=="Feature"||!i.geometry)throw new Error("Invalid input to "+e+", Feature with geometry required");if(!i.geometry||i.geometry.type!==t)throw new Error("Invalid input to "+e+": must be a "+t+", given "+i.geometry.type)}}function Ae(r){return r.type==="Feature"?r.geometry:r}function gi(r,t){return r.type==="FeatureCollection"?"FeatureCollection":r.type==="GeometryCollection"?"GeometryCollection":r.type==="Feature"&&r.geometry!==null?r.geometry.type:r.type}const ux=Object.freeze(Object.defineProperty({__proto__:null,collectionOf:gs,containsNumber:yd,featureOf:Ju,geojsonType:jy,getCoord:me,getCoords:Jt,getGeom:Ae,getType:gi},Symbol.toStringTag,{value:"Module"}));function js(r,t,e={}){if(e.final===!0)return lx(r,t);const i=me(r),n=me(t),s=je(i[0]),a=je(n[0]),l=je(i[1]),f=je(n[1]),d=Math.sin(a-s)*Math.cos(f),g=Math.cos(l)*Math.sin(f)-Math.sin(l)*Math.cos(f)*Math.cos(a-s);return cs(Math.atan2(d,g))}function lx(r,t){let e=js(t,r);return e=(e+180)%360,e}function Fo(r,t,e,i={}){const n=me(r),s=je(n[0]),a=je(n[1]),l=je(e),f=Ka(t,i.units),d=Math.asin(Math.sin(a)*Math.cos(f)+Math.cos(a)*Math.sin(f)*Math.cos(l)),g=s+Math.atan2(Math.sin(l)*Math.sin(f)*Math.cos(a),Math.cos(f)-Math.sin(a)*Math.sin(d)),m=cs(g),v=cs(d);return re([m,v],i.properties)}function we(r,t,e={}){var i=me(r),n=me(t),s=je(n[1]-i[1]),a=je(n[0]-i[0]),l=je(i[1]),f=je(n[1]),d=Math.pow(Math.sin(s/2),2)+Math.pow(Math.sin(a/2),2)*Math.cos(l)*Math.cos(f);return fl(2*Math.atan2(Math.sqrt(d),Math.sqrt(1-d)),e.units)}function hx(r,t,e={}){const n=Ae(r).coordinates;let s=0;for(let a=0;a<n.length&&!(t>=s&&a===n.length-1);a++)if(s>=t){const l=t-s;if(l){const f=js(n[a],n[a-1])-180;return Fo(n[a],l,f,e)}else return re(n[a])}else s+=we(n[a],n[a+1],e);return re(n[n.length-1])}function fs(r,t,e={}){let i;return e.final?i=Lp(me(t),me(r)):i=Lp(me(r),me(t)),i>180?-(360-i):i}function Lp(r,t){const e=je(r[1]),i=je(t[1]);let n=je(t[0]-r[0]);n>Math.PI&&(n-=2*Math.PI),n<-Math.PI&&(n+=2*Math.PI);const s=Math.log(Math.tan(i/2+Math.PI/4)/Math.tan(e/2+Math.PI/4)),a=Math.atan2(n,s);return(cs(a)+360)%360}function cx(r,t,e,i={}){if(!ve(i))throw new Error("options is invalid");if(!r)throw new Error("startPoint is required");if(!t)throw new Error("midPoint is required");if(!e)throw new Error("endPoint is required");const n=r,s=t,a=e,l=Fa(i.mercator!==!0?js(s,n):fs(s,n));let f=Fa(i.mercator!==!0?js(s,a):fs(s,a));f<l&&(f=f+360);const d=f-l;return i.explementary===!0?360-d:d}function Fe(r,t,e){if(r!==null)for(var i,n,s,a,l,f,d,g=0,m=0,v,_=r.type,w=_==="FeatureCollection",b=_==="Feature",S=w?r.features.length:1,N=0;N<S;N++){d=w?r.features[N].geometry:b?r.geometry:r,v=d?d.type==="GeometryCollection":!1,l=v?d.geometries.length:1;for(var k=0;k<l;k++){var C=0,A=0;if(a=v?d.geometries[k]:d,a!==null){f=a.coordinates;var P=a.type;switch(g=e&&(P==="Polygon"||P==="MultiPolygon")?1:0,P){case null:break;case"Point":if(t(f,m,N,C,A)===!1)return!1;m++,C++;break;case"LineString":case"MultiPoint":for(i=0;i<f.length;i++){if(t(f[i],m,N,C,A)===!1)return!1;m++,P==="MultiPoint"&&C++}P==="LineString"&&C++;break;case"Polygon":case"MultiLineString":for(i=0;i<f.length;i++){for(n=0;n<f[i].length-g;n++){if(t(f[i][n],m,N,C,A)===!1)return!1;m++}P==="MultiLineString"&&C++,P==="Polygon"&&A++}P==="Polygon"&&C++;break;case"MultiPolygon":for(i=0;i<f.length;i++){for(A=0,n=0;n<f[i].length;n++){for(s=0;s<f[i][n].length-g;s++){if(t(f[i][n][s],m,N,C,A)===!1)return!1;m++}A++}C++}break;case"GeometryCollection":for(i=0;i<a.geometries.length;i++)if(Fe(a.geometries[i],t,e)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function _d(r,t,e,i){var n=e;return Fe(r,function(s,a,l,f,d){a===0&&e===void 0?n=s:n=t(n,s,a,l,f,d)},i),n}function vd(r,t){var e;switch(r.type){case"FeatureCollection":for(e=0;e<r.features.length&&t(r.features[e].properties,e)!==!1;e++);break;case"Feature":t(r.properties,0);break}}function Ky(r,t,e){var i=e;return vd(r,function(n,s){s===0&&e===void 0?i=n:i=t(i,n,s)}),i}function ye(r,t){if(r.type==="Feature")t(r,0);else if(r.type==="FeatureCollection")for(var e=0;e<r.features.length&&t(r.features[e],e)!==!1;e++);}function xd(r,t,e){var i=e;return ye(r,function(n,s){s===0&&e===void 0?i=n:i=t(i,n,s)}),i}function ju(r){var t=[];return Fe(r,function(e){t.push(e)}),t}function Rn(r,t){var e,i,n,s,a,l,f,d,g,m,v=0,_=r.type==="FeatureCollection",w=r.type==="Feature",b=_?r.features.length:1;for(e=0;e<b;e++){for(l=_?r.features[e].geometry:w?r.geometry:r,d=_?r.features[e].properties:w?r.properties:{},g=_?r.features[e].bbox:w?r.bbox:void 0,m=_?r.features[e].id:w?r.id:void 0,f=l?l.type==="GeometryCollection":!1,a=f?l.geometries.length:1,n=0;n<a;n++){if(s=f?l.geometries[n]:l,s===null){if(t(null,v,d,g,m)===!1)return!1;continue}switch(s.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(t(s,v,d,g,m)===!1)return!1;break}case"GeometryCollection":{for(i=0;i<s.geometries.length;i++)if(t(s.geometries[i],v,d,g,m)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}v++}}function wd(r,t,e){var i=e;return Rn(r,function(n,s,a,l,f){s===0&&e===void 0?i=n:i=t(i,n,s,a,l,f)}),i}function vn(r,t){Rn(r,function(e,i,n,s,a){var l=e===null?null:e.type;switch(l){case null:case"Point":case"LineString":case"Polygon":return t(Qe(e,n,{bbox:s,id:a}),i,0)===!1?!1:void 0}var f;switch(l){case"MultiPoint":f="Point";break;case"MultiLineString":f="LineString";break;case"MultiPolygon":f="Polygon";break}for(var d=0;d<e.coordinates.length;d++){var g=e.coordinates[d],m={type:f,coordinates:g};if(t(Qe(m,n),i,d)===!1)return!1}})}function Qy(r,t,e){var i=e;return vn(r,function(n,s,a){s===0&&a===0&&e===void 0?i=n:i=t(i,n,s,a)}),i}function ss(r,t){vn(r,function(e,i,n){var s=0;if(e.geometry){var a=e.geometry.type;if(!(a==="Point"||a==="MultiPoint")){var l,f=0,d=0,g=0;if(Fe(e,function(m,v,_,w,b){if(l===void 0||i>f||w>d||b>g){l=m,f=i,d=w,g=b,s=0;return}var S=ge([l,m],e.properties);if(t(S,i,n,b,s)===!1)return!1;s++,l=m})===!1)return!1}}})}function bd(r,t,e){var i=e,n=!1;return ss(r,function(s,a,l,f,d){n===!1&&e===void 0?i=s:i=t(i,s,a,l,f,d),n=!0}),i}function Ed(r,t){if(!r)throw new Error("geojson is required");vn(r,function(e,i,n){if(e.geometry!==null){var s=e.geometry.type,a=e.geometry.coordinates;switch(s){case"LineString":if(t(e,i,n,0,0)===!1)return!1;break;case"Polygon":for(var l=0;l<a.length;l++)if(t(ge(a[l],e.properties),i,n,l)===!1)return!1;break}}})}function kd(r,t,e){var i=e;return Ed(r,function(n,s,a,l){s===0&&e===void 0?i=n:i=t(i,n,s,a,l)}),i}function t_(r,t){if(t=t||{},!ve(t))throw new Error("options is invalid");var e=t.featureIndex||0,i=t.multiFeatureIndex||0,n=t.geometryIndex||0,s=t.segmentIndex||0,a=t.properties,l;switch(r.type){case"FeatureCollection":e<0&&(e=r.features.length+e),a=a||r.features[e].properties,l=r.features[e].geometry;break;case"Feature":a=a||r.properties,l=r.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":l=r;break;default:throw new Error("geojson is invalid")}if(l===null)return null;var f=l.coordinates;switch(l.type){case"Point":case"MultiPoint":return null;case"LineString":return s<0&&(s=f.length+s-1),ge([f[s],f[s+1]],a,t);case"Polygon":return n<0&&(n=f.length+n),s<0&&(s=f[n].length+s-1),ge([f[n][s],f[n][s+1]],a,t);case"MultiLineString":return i<0&&(i=f.length+i),s<0&&(s=f[i].length+s-1),ge([f[i][s],f[i][s+1]],a,t);case"MultiPolygon":return i<0&&(i=f.length+i),n<0&&(n=f[i].length+n),s<0&&(s=f[i][n].length-s-1),ge([f[i][n][s],f[i][n][s+1]],a,t)}throw new Error("geojson is invalid")}function e_(r,t){if(t=t||{},!ve(t))throw new Error("options is invalid");var e=t.featureIndex||0,i=t.multiFeatureIndex||0,n=t.geometryIndex||0,s=t.coordIndex||0,a=t.properties,l;switch(r.type){case"FeatureCollection":e<0&&(e=r.features.length+e),a=a||r.features[e].properties,l=r.features[e].geometry;break;case"Feature":a=a||r.properties,l=r.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":l=r;break;default:throw new Error("geojson is invalid")}if(l===null)return null;var f=l.coordinates;switch(l.type){case"Point":return re(f,a,t);case"MultiPoint":return i<0&&(i=f.length+i),re(f[i],a,t);case"LineString":return s<0&&(s=f.length+s),re(f[s],a,t);case"Polygon":return n<0&&(n=f.length+n),s<0&&(s=f[n].length+s),re(f[n][s],a,t);case"MultiLineString":return i<0&&(i=f.length+i),s<0&&(s=f[i].length+s),re(f[i][s],a,t);case"MultiPolygon":return i<0&&(i=f.length+i),n<0&&(n=f[i].length+n),s<0&&(s=f[i][n].length-s),re(f[i][n][s],a,t)}throw new Error("geojson is invalid")}const fx=Object.freeze(Object.defineProperty({__proto__:null,coordAll:ju,coordEach:Fe,coordReduce:_d,featureEach:ye,featureReduce:xd,findPoint:e_,findSegment:t_,flattenEach:vn,flattenReduce:Qy,geomEach:Rn,geomReduce:wd,lineEach:Ed,lineReduce:kd,propEach:vd,propReduce:Ky,segmentEach:ss,segmentReduce:bd},Symbol.toStringTag,{value:"Module"}));function dl(r){return wd(r,(t,e)=>t+dx(e),0)}function dx(r){let t=0,e;switch(r.type){case"Polygon":return Sp(r.coordinates);case"MultiPolygon":for(e=0;e<r.coordinates.length;e++)t+=Sp(r.coordinates[e]);return t;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0}return 0}function Sp(r){let t=0;if(r&&r.length>0){t+=Math.abs(Tp(r[0]));for(let e=1;e<r.length;e++)t-=Math.abs(Tp(r[e]))}return t}var px=yn*yn/2,xc=Math.PI/180;function Tp(r){const t=r.length-1;if(t<=2)return 0;let e=0,i=0;for(;i<t;){const n=r[i],s=r[i+1===t?0:i+1],a=r[i+2>=t?(i+2)%t:i+2],l=n[0]*xc,f=s[1]*xc,d=a[0]*xc;e+=(d-l)*Math.sin(f),i++}return e*px}function Te(r,t={}){if(r.bbox!=null&&t.recompute!==!0)return r.bbox;const e=[1/0,1/0,-1/0,-1/0];return Fe(r,i=>{e[0]>i[0]&&(e[0]=i[0]),e[1]>i[1]&&(e[1]=i[1]),e[2]<i[0]&&(e[2]=i[0]),e[3]<i[1]&&(e[3]=i[1])}),e}function gx(r,t,e){var i=r.length,n=La(r[0],t),s=[],a,l,f;let d,g;for(e||(e=[]),a=1;a<i;a++){for(d=r[a-1],g=r[a],l=f=La(g,t);;)if(n|l){if(n&l)break;n?(d=Lf(d,g,n,t),n=La(d,t)):(g=Lf(d,g,l,t),l=La(g,t))}else{s.push(d),l!==f?(s.push(g),a<i-1&&(e.push(s),s=[])):a===i-1&&s.push(g);break}n=f}return s.length&&e.push(s),e}function mx(r,t){var e,i,n,s,a,l,f;for(i=1;i<=8;i*=2){for(e=[],n=r[r.length-1],s=!(La(n,t)&i),a=0;a<r.length;a++)l=r[a],f=!(La(l,t)&i),f!==s&&e.push(Lf(n,l,i,t)),f&&e.push(l),n=l,s=f;if(r=e,!r.length)break}return e}function Lf(r,t,e,i){return e&8?[r[0]+(t[0]-r[0])*(i[3]-r[1])/(t[1]-r[1]),i[3]]:e&4?[r[0]+(t[0]-r[0])*(i[1]-r[1])/(t[1]-r[1]),i[1]]:e&2?[i[2],r[1]+(t[1]-r[1])*(i[2]-r[0])/(t[0]-r[0])]:e&1?[i[0],r[1]+(t[1]-r[1])*(i[0]-r[0])/(t[0]-r[0])]:null}function La(r,t){var e=0;return r[0]<t[0]?e|=1:r[0]>t[2]&&(e|=2),r[1]<t[1]?e|=4:r[1]>t[3]&&(e|=8),e}function yx(r,t){const e=Ae(r),i=e.type,n=r.type==="Feature"?r.properties:{};let s=e.coordinates;switch(i){case"LineString":case"MultiLineString":{const a=[];return i==="LineString"&&(s=[s]),s.forEach(l=>{gx(l,t,a)}),a.length===1?ge(a[0],n):no(a,n)}case"Polygon":return $t(Pp(s,t),n);case"MultiPolygon":return pi(s.map(a=>Pp(a,t)),n);default:throw new Error("geometry "+i+" not supported")}}function Pp(r,t){const e=[];for(const i of r){const n=mx(i,t);n.length>0&&((n[0][0]!==n[n.length-1][0]||n[0][1]!==n[n.length-1][1])&&n.push(n[0]),n.length>=4&&e.push(n))}return e}function pl(r,t={}){const e=Number(r[0]),i=Number(r[1]),n=Number(r[2]),s=Number(r[3]);if(r.length===6)throw new Error("@turf/bbox-polygon does not support BBox with 6 positions");const a=[e,i];return $t([[a,[n,i],[n,s],[e,s],a]],t.properties,{bbox:r,id:t.id})}var _x=class{constructor(r){this.points=r.points||[],this.duration=r.duration||1e4,this.sharpness=r.sharpness||.85,this.centers=[],this.controls=[],this.stepLength=r.stepLength||60,this.length=this.points.length,this.delay=0;for(let t=0;t<this.length;t++)this.points[t].z=this.points[t].z||0;for(let t=0;t<this.length-1;t++){const e=this.points[t],i=this.points[t+1];this.centers.push({x:(e.x+i.x)/2,y:(e.y+i.y)/2,z:(e.z+i.z)/2})}this.controls.push([this.points[0],this.points[0]]);for(let t=0;t<this.centers.length-1;t++){const e=this.points[t+1].x-(this.centers[t].x+this.centers[t+1].x)/2,i=this.points[t+1].y-(this.centers[t].y+this.centers[t+1].y)/2,n=this.points[t+1].z-(this.centers[t].y+this.centers[t+1].z)/2;this.controls.push([{x:(1-this.sharpness)*this.points[t+1].x+this.sharpness*(this.centers[t].x+e),y:(1-this.sharpness)*this.points[t+1].y+this.sharpness*(this.centers[t].y+i),z:(1-this.sharpness)*this.points[t+1].z+this.sharpness*(this.centers[t].z+n)},{x:(1-this.sharpness)*this.points[t+1].x+this.sharpness*(this.centers[t+1].x+e),y:(1-this.sharpness)*this.points[t+1].y+this.sharpness*(this.centers[t+1].y+i),z:(1-this.sharpness)*this.points[t+1].z+this.sharpness*(this.centers[t+1].z+n)}])}return this.controls.push([this.points[this.length-1],this.points[this.length-1]]),this.steps=this.cacheSteps(this.stepLength),this}cacheSteps(r){const t=[];let e=this.pos(0);t.push(0);for(let i=0;i<this.duration;i+=10){const n=this.pos(i);Math.sqrt((n.x-e.x)*(n.x-e.x)+(n.y-e.y)*(n.y-e.y)+(n.z-e.z)*(n.z-e.z))>r&&(t.push(i),e=n)}return t}vector(r){const t=this.pos(r+10),e=this.pos(r-10);return{angle:180*Math.atan2(t.y-e.y,t.x-e.x)/3.14,speed:Math.sqrt((e.x-t.x)*(e.x-t.x)+(e.y-t.y)*(e.y-t.y)+(e.z-t.z)*(e.z-t.z))}}pos(r){let t=r-this.delay;t<0&&(t=0),t>this.duration&&(t=this.duration-1);const e=t/this.duration;if(e>=1)return this.points[this.length-1];const i=Math.floor((this.points.length-1)*e),n=(this.length-1)*e-i;return vx(n,this.points[i],this.controls[i][1],this.controls[i+1][0],this.points[i+1])}};function vx(r,t,e,i,n){const s=xx(r);return{x:n.x*s[0]+i.x*s[1]+e.x*s[2]+t.x*s[3],y:n.y*s[0]+i.y*s[1]+e.y*s[2]+t.y*s[3],z:n.z*s[0]+i.z*s[1]+e.z*s[2]+t.z*s[3]}}function xx(r){const t=r*r;return[t*r,3*t*(1-r),3*r*(1-r)*(1-r),(1-r)*(1-r)*(1-r)]}function wx(r,t={}){const e=t.resolution||1e4,i=t.sharpness||.85,n=[],s=Ae(r).coordinates.map(d=>({x:d[0],y:d[1]})),a=new _x({duration:e,points:s,sharpness:i}),l=d=>{var g=a.pos(d);Math.floor(d/100)%2===0&&n.push([g.x,g.y])};for(var f=0;f<a.duration;f+=10)l(f);return l(a.duration),ge(n,t.properties)}function Ph(r){const t=Jt(r);let e=0,i=1,n,s;for(;i<t.length;)n=s||t[0],s=t[i],e+=(s[0]-n[0])*(s[1]+n[1]),i++;return e>0}function bx(r){const t=Ae(r).coordinates;if(t[0].length<=4)return!1;let e=!1;const i=t[0].length-1;for(let n=0;n<i;n++){const s=t[0][(n+2)%i][0]-t[0][(n+1)%i][0],a=t[0][(n+2)%i][1]-t[0][(n+1)%i][1],l=t[0][n][0]-t[0][(n+1)%i][0],f=t[0][n][1]-t[0][(n+1)%i][1],d=s*f-a*l;if(n===0)e=d>0;else if(e!==d>0)return!0}return!1}const us=11102230246251565e-32,qn=134217729,Ex=(3+8*us)*us;function wc(r,t,e,i,n){let s,a,l,f,d=t[0],g=i[0],m=0,v=0;g>d==g>-d?(s=d,d=t[++m]):(s=g,g=i[++v]);let _=0;if(m<r&&v<e)for(g>d==g>-d?(a=d+s,l=s-(a-d),d=t[++m]):(a=g+s,l=s-(a-g),g=i[++v]),s=a,l!==0&&(n[_++]=l);m<r&&v<e;)g>d==g>-d?(a=s+d,f=a-s,l=s-(a-f)+(d-f),d=t[++m]):(a=s+g,f=a-s,l=s-(a-f)+(g-f),g=i[++v]),s=a,l!==0&&(n[_++]=l);for(;m<r;)a=s+d,f=a-s,l=s-(a-f)+(d-f),d=t[++m],s=a,l!==0&&(n[_++]=l);for(;v<e;)a=s+g,f=a-s,l=s-(a-f)+(g-f),g=i[++v],s=a,l!==0&&(n[_++]=l);return(s!==0||_===0)&&(n[_++]=s),_}function kx(r,t){let e=t[0];for(let i=1;i<r;i++)e+=t[i];return e}function gl(r){return new Float64Array(r)}const Mx=(3+16*us)*us,Lx=(2+12*us)*us,Sx=(9+64*us)*us*us,la=gl(4),Ip=gl(8),Cp=gl(12),Ap=gl(16),Kn=gl(4);function Tx(r,t,e,i,n,s,a){let l,f,d,g,m,v,_,w,b,S,N,k,C,A,P,q,U,I;const O=r-n,B=e-n,V=t-s,z=i-s;A=O*z,v=qn*O,_=v-(v-O),w=O-_,v=qn*z,b=v-(v-z),S=z-b,P=w*S-(A-_*b-w*b-_*S),q=V*B,v=qn*V,_=v-(v-V),w=V-_,v=qn*B,b=v-(v-B),S=B-b,U=w*S-(q-_*b-w*b-_*S),N=P-U,m=P-N,la[0]=P-(N+m)+(m-U),k=A+N,m=k-A,C=A-(k-m)+(N-m),N=C-q,m=C-N,la[1]=C-(N+m)+(m-q),I=k+N,m=I-k,la[2]=k-(I-m)+(N-m),la[3]=I;let W=kx(4,la),T=Lx*a;if(W>=T||-W>=T||(m=r-O,l=r-(O+m)+(m-n),m=e-B,d=e-(B+m)+(m-n),m=t-V,f=t-(V+m)+(m-s),m=i-z,g=i-(z+m)+(m-s),l===0&&f===0&&d===0&&g===0)||(T=Sx*a+Ex*Math.abs(W),W+=O*g+z*l-(V*d+B*f),W>=T||-W>=T))return W;A=l*z,v=qn*l,_=v-(v-l),w=l-_,v=qn*z,b=v-(v-z),S=z-b,P=w*S-(A-_*b-w*b-_*S),q=f*B,v=qn*f,_=v-(v-f),w=f-_,v=qn*B,b=v-(v-B),S=B-b,U=w*S-(q-_*b-w*b-_*S),N=P-U,m=P-N,Kn[0]=P-(N+m)+(m-U),k=A+N,m=k-A,C=A-(k-m)+(N-m),N=C-q,m=C-N,Kn[1]=C-(N+m)+(m-q),I=k+N,m=I-k,Kn[2]=k-(I-m)+(N-m),Kn[3]=I;const $=wc(4,la,4,Kn,Ip);A=O*g,v=qn*O,_=v-(v-O),w=O-_,v=qn*g,b=v-(v-g),S=g-b,P=w*S-(A-_*b-w*b-_*S),q=V*d,v=qn*V,_=v-(v-V),w=V-_,v=qn*d,b=v-(v-d),S=d-b,U=w*S-(q-_*b-w*b-_*S),N=P-U,m=P-N,Kn[0]=P-(N+m)+(m-U),k=A+N,m=k-A,C=A-(k-m)+(N-m),N=C-q,m=C-N,Kn[1]=C-(N+m)+(m-q),I=k+N,m=I-k,Kn[2]=k-(I-m)+(N-m),Kn[3]=I;const F=wc($,Ip,4,Kn,Cp);A=l*g,v=qn*l,_=v-(v-l),w=l-_,v=qn*g,b=v-(v-g),S=g-b,P=w*S-(A-_*b-w*b-_*S),q=f*d,v=qn*f,_=v-(v-f),w=f-_,v=qn*d,b=v-(v-d),S=d-b,U=w*S-(q-_*b-w*b-_*S),N=P-U,m=P-N,Kn[0]=P-(N+m)+(m-U),k=A+N,m=k-A,C=A-(k-m)+(N-m),N=C-q,m=C-N,Kn[1]=C-(N+m)+(m-q),I=k+N,m=I-k,Kn[2]=k-(I-m)+(N-m),Kn[3]=I;const X=wc(F,Cp,4,Kn,Ap);return Ap[X-1]}function Px(r,t,e,i,n,s){const a=(t-s)*(e-n),l=(r-n)*(i-s),f=a-l,d=Math.abs(a+l);return Math.abs(f)>=Mx*d?f:-Tx(r,t,e,i,n,s,d)}function Ix(r,t){var e,i,n=0,s,a,l,f,d,g,m,v=r[0],_=r[1],w=t.length;for(e=0;e<w;e++){i=0;var b=t[e],S=b.length-1;if(g=b[0],g[0]!==b[S][0]&&g[1]!==b[S][1])throw new Error("First and last coordinates in a ring must be the same");for(a=g[0]-v,l=g[1]-_,i;i<S;i++){if(m=b[i+1],f=m[0]-v,d=m[1]-_,l===0&&d===0){if(f<=0&&a>=0||a<=0&&f>=0)return 0}else if(d>=0&&l<=0||d<=0&&l>=0){if(s=Px(a,f,l,d,0,0),s===0)return 0;(s>0&&d>0&&l<=0||s<0&&d<=0&&l>0)&&n++}g=m,l=d,a=f}}return n%2!==0}function ie(r,t,e={}){if(!r)throw new Error("point is required");if(!t)throw new Error("polygon is required");const i=me(r),n=Ae(t),s=n.type,a=t.bbox;let l=n.coordinates;if(a&&Cx(i,a)===!1)return!1;s==="Polygon"&&(l=[l]);let f=!1;for(var d=0;d<l.length;++d){const g=Ix(i,l[d]);if(g===0)return!e.ignoreBoundary;g&&(f=!0)}return f}function Cx(r,t){return t[0]<=r[0]&&t[1]<=r[1]&&t[2]>=r[0]&&t[3]>=r[1]}function ae(r,t,e={}){const i=me(r),n=Jt(t);for(let s=0;s<n.length-1;s++){let a=!1;if(e.ignoreEndVertices&&(s===0&&(a="start"),s===n.length-2&&(a="end"),s===0&&s+1===n.length-1&&(a="both")),Ax(n[s],n[s+1],i,a,typeof e.epsilon>"u"?null:e.epsilon))return!0}return!1}function Ax(r,t,e,i,n){const s=e[0],a=e[1],l=r[0],f=r[1],d=t[0],g=t[1],m=e[0]-l,v=e[1]-f,_=d-l,w=g-f,b=m*w-v*_;if(n!==null){if(Math.abs(b)>n)return!1}else if(b!==0)return!1;if(Math.abs(_)===Math.abs(w)&&Math.abs(_)===0)return i?!1:e[0]===r[0]&&e[1]===r[1];if(i){if(i==="start")return Math.abs(_)>=Math.abs(w)?_>0?l<s&&s<=d:d<=s&&s<l:w>0?f<a&&a<=g:g<=a&&a<f;if(i==="end")return Math.abs(_)>=Math.abs(w)?_>0?l<=s&&s<d:d<s&&s<=l:w>0?f<=a&&a<g:g<a&&a<=f;if(i==="both")return Math.abs(_)>=Math.abs(w)?_>0?l<s&&s<d:d<s&&s<l:w>0?f<a&&a<g:g<a&&a<f}else return Math.abs(_)>=Math.abs(w)?_>0?l<=s&&s<=d:d<=s&&s<=l:w>0?f<=a&&a<=g:g<=a&&a<=f;return!1}function n_(r,t){const e=Ae(r),i=Ae(t),n=e.type,s=i.type,a=e.coordinates,l=i.coordinates;switch(n){case"Point":switch(s){case"Point":return Md(a,l);default:throw new Error("feature2 "+s+" geometry not supported")}case"MultiPoint":switch(s){case"Point":return Ox(e,i);case"MultiPoint":return Rx(e,i);default:throw new Error("feature2 "+s+" geometry not supported")}case"LineString":switch(s){case"Point":return ae(i,e,{ignoreEndVertices:!0});case"LineString":return Bx(e,i);case"MultiPoint":return Dx(e,i);default:throw new Error("feature2 "+s+" geometry not supported")}case"Polygon":switch(s){case"Point":return ie(i,e,{ignoreBoundary:!0});case"LineString":return Fx(e,i);case"Polygon":return i_(e,i);case"MultiPoint":return zx(e,i);default:throw new Error("feature2 "+s+" geometry not supported")}case"MultiPolygon":switch(s){case"Polygon":return Nx(e,i);default:throw new Error("feature2 "+s+" geometry not supported")}default:throw new Error("feature1 "+n+" geometry not supported")}}function Nx(r,t){return r.coordinates.some(e=>i_({type:"Polygon",coordinates:e},t))}function Ox(r,t){let e,i=!1;for(e=0;e<r.coordinates.length;e++)if(Md(r.coordinates[e],t.coordinates)){i=!0;break}return i}function Rx(r,t){for(const e of t.coordinates){let i=!1;for(const n of r.coordinates)if(Md(e,n)){i=!0;break}if(!i)return!1}return!0}function Dx(r,t){let e=!1;for(const i of t.coordinates)if(ae(i,r,{ignoreEndVertices:!0})&&(e=!0),!ae(i,r))return!1;return!!e}function zx(r,t){for(const e of t.coordinates)if(!ie(e,r,{ignoreBoundary:!0}))return!1;return!0}function Bx(r,t){let e=!1;for(const i of t.coordinates)if(ae({type:"Point",coordinates:i},r,{ignoreEndVertices:!0})&&(e=!0),!ae({type:"Point",coordinates:i},r,{ignoreEndVertices:!1}))return!1;return e}function Fx(r,t){let e=!1,i=0;const n=Te(r),s=Te(t);if(!r_(n,s))return!1;for(i;i<t.coordinates.length-1;i++){const a=Ux(t.coordinates[i],t.coordinates[i+1]);if(ie({type:"Point",coordinates:a},r,{ignoreBoundary:!0})){e=!0;break}}return e}function i_(r,t){if(r.type==="Feature"&&r.geometry===null||t.type==="Feature"&&t.geometry===null)return!1;const e=Te(r),i=Te(t);if(!r_(e,i))return!1;const n=Ae(t).coordinates;for(const s of n)for(const a of s)if(!ie(a,r))return!1;return!0}function r_(r,t){return!(r[0]>t[0]||r[2]<t[2]||r[1]>t[1]||r[3]<t[3])}function Md(r,t){return r[0]===t[0]&&r[1]===t[1]}function Ux(r,t){return[(r[0]+t[0])/2,(r[1]+t[1])/2]}let s_=class{constructor(t=[],e=Gx){if(this.data=t,this.length=this.data.length,this.compare=e,this.length>0)for(let i=(this.length>>1)-1;i>=0;i--)this._down(i)}push(t){this.data.push(t),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const t=this.data[0],e=this.data.pop();return this.length--,this.length>0&&(this.data[0]=e,this._down(0)),t}peek(){return this.data[0]}_up(t){const{data:e,compare:i}=this,n=e[t];for(;t>0;){const s=t-1>>1,a=e[s];if(i(n,a)>=0)break;e[t]=a,t=s}e[t]=n}_down(t){const{data:e,compare:i}=this,n=this.length>>1,s=e[t];for(;t<n;){let a=(t<<1)+1,l=e[a];const f=a+1;if(f<this.length&&i(e[f],l)<0&&(a=f,l=e[f]),i(l,s)>=0)break;e[t]=l,t=a}e[t]=s}};function Gx(r,t){return r<t?-1:r>t?1:0}function o_(r,t){return r.p.x>t.p.x?1:r.p.x<t.p.x?-1:r.p.y!==t.p.y?r.p.y>t.p.y?1:-1:1}function Vx(r,t){return r.rightSweepEvent.p.x>t.rightSweepEvent.p.x?1:r.rightSweepEvent.p.x<t.rightSweepEvent.p.x?-1:r.rightSweepEvent.p.y!==t.rightSweepEvent.p.y?r.rightSweepEvent.p.y<t.rightSweepEvent.p.y?1:-1:1}class Np{constructor(t,e,i,n){this.p={x:t[0],y:t[1]},this.featureId=e,this.ringId=i,this.eventId=n,this.otherEvent=null,this.isLeftEndpoint=null}isSamePoint(t){return this.p.x===t.p.x&&this.p.y===t.p.y}}function qx(r,t){if(r.type==="FeatureCollection"){const e=r.features;for(let i=0;i<e.length;i++)Op(e[i],t)}else Op(r,t)}let El=0,kl=0,Ml=0;function Op(r,t){const e=r.type==="Feature"?r.geometry:r;let i=e.coordinates;(e.type==="Polygon"||e.type==="MultiLineString")&&(i=[i]),e.type==="LineString"&&(i=[[i]]);for(let n=0;n<i.length;n++)for(let s=0;s<i[n].length;s++){let a=i[n][s][0],l=null;kl=kl+1;for(let f=0;f<i[n][s].length-1;f++){l=i[n][s][f+1];const d=new Np(a,El,kl,Ml),g=new Np(l,El,kl,Ml+1);d.otherEvent=g,g.otherEvent=d,o_(d,g)>0?(g.isLeftEndpoint=!0,d.isLeftEndpoint=!1):(d.isLeftEndpoint=!0,g.isLeftEndpoint=!1),t.push(d),t.push(g),a=l,Ml=Ml+1}}El=El+1}let Zx=class{constructor(t){this.leftSweepEvent=t,this.rightSweepEvent=t.otherEvent}};function Hx(r,t){if(r===null||t===null||r.leftSweepEvent.ringId===t.leftSweepEvent.ringId&&(r.rightSweepEvent.isSamePoint(t.leftSweepEvent)||r.rightSweepEvent.isSamePoint(t.leftSweepEvent)||r.rightSweepEvent.isSamePoint(t.rightSweepEvent)||r.leftSweepEvent.isSamePoint(t.leftSweepEvent)||r.leftSweepEvent.isSamePoint(t.rightSweepEvent)))return!1;const e=r.leftSweepEvent.p.x,i=r.leftSweepEvent.p.y,n=r.rightSweepEvent.p.x,s=r.rightSweepEvent.p.y,a=t.leftSweepEvent.p.x,l=t.leftSweepEvent.p.y,f=t.rightSweepEvent.p.x,d=t.rightSweepEvent.p.y,g=(d-l)*(n-e)-(f-a)*(s-i),m=(f-a)*(i-l)-(d-l)*(e-a),v=(n-e)*(i-l)-(s-i)*(e-a);if(g===0)return!1;const _=m/g,w=v/g;if(_>=0&&_<=1&&w>=0&&w<=1){const b=e+_*(n-e),S=i+_*(s-i);return[b,S]}return!1}function Yx(r,t){t=t||!1;const e=[],i=new s_([],Vx);for(;r.length;){const n=r.pop();if(n.isLeftEndpoint){const s=new Zx(n);for(let a=0;a<i.data.length;a++){const l=i.data[a];if(t&&l.leftSweepEvent.featureId===n.featureId)continue;const f=Hx(s,l);f!==!1&&e.push(f)}i.push(s)}else n.isLeftEndpoint===!1&&i.pop()}return e}function Xx(r,t){const e=new s_([],o_);return qx(r,e),Yx(e,t)}var Wx=Xx;function Or(r,t,e={}){const{removeDuplicates:i=!0,ignoreSelfIntersections:n=!0}=e;let s=[];r.type==="FeatureCollection"?s=s.concat(r.features):r.type==="Feature"?s.push(r):(r.type==="LineString"||r.type==="Polygon"||r.type==="MultiLineString"||r.type==="MultiPolygon")&&s.push(Qe(r)),t.type==="FeatureCollection"?s=s.concat(t.features):t.type==="Feature"?s.push(t):(t.type==="LineString"||t.type==="Polygon"||t.type==="MultiLineString"||t.type==="MultiPolygon")&&s.push(Qe(t));const a=Wx(Yt(s),n);let l=[];if(i){const f={};a.forEach(d=>{const g=d.join(",");f[g]||(f[g]=!0,l.push(d))})}else l=a;return Yt(l.map(f=>re(f)))}function Ua(r,t={}){const e=Ae(r);switch(!t.properties&&r.type==="Feature"&&(t.properties=r.properties),e.type){case"Polygon":return $x(e,t);case"MultiPolygon":return Jx(e,t);default:throw new Error("invalid poly")}}function $x(r,t={}){const i=Ae(r).coordinates,n=t.properties?t.properties:r.type==="Feature"?r.properties:{};return a_(i,n)}function Jx(r,t={}){const i=Ae(r).coordinates,n=t.properties?t.properties:r.type==="Feature"?r.properties:{},s=[];return i.forEach(a=>{s.push(a_(a,n))}),Yt(s)}function a_(r,t){return r.length>1?no(r,t):ge(r[0],t)}function u_(r,t){var e=Ae(r),i=Ae(t),n=e.type,s=i.type;switch(n){case"MultiPoint":switch(s){case"LineString":return Rp(e,i);case"Polygon":return zp(e,i);default:throw new Error("feature2 "+s+" geometry not supported")}case"LineString":switch(s){case"MultiPoint":return Rp(i,e);case"LineString":return jx(e,i);case"Polygon":return Dp(e,i);default:throw new Error("feature2 "+s+" geometry not supported")}case"Polygon":switch(s){case"MultiPoint":return zp(i,e);case"LineString":return Dp(i,e);default:throw new Error("feature2 "+s+" geometry not supported")}default:throw new Error("feature1 "+n+" geometry not supported")}}function Rp(r,t){for(var e=!1,i=!1,n=r.coordinates.length,s=0;s<n&&!e&&!i;){for(var a=0;a<t.coordinates.length-1;a++){var l=!0;(a===0||a===t.coordinates.length-2)&&(l=!1),l_(t.coordinates[a],t.coordinates[a+1],r.coordinates[s],l)?e=!0:i=!0}s++}return e&&i}function jx(r,t){var e=Or(r,t);if(e.features.length>0)for(var i=0;i<r.coordinates.length-1;i++)for(var n=0;n<t.coordinates.length-1;n++){var s=!0;if((n===0||n===t.coordinates.length-2)&&(s=!1),l_(r.coordinates[i],r.coordinates[i+1],t.coordinates[n],s))return!0}return!1}function Dp(r,t){const e=Ua(t);return Or(r,e).features.length>0}function zp(r,t){var e=!1,i=!1,n=r.coordinates.length;for(let s=0;s<n&&(!e||!i);s++)ie(re(r.coordinates[s]),t)?e=!0:i=!0;return i&&e}function l_(r,t,e,i){var n=e[0]-r[0],s=e[1]-r[1],a=t[0]-r[0],l=t[1]-r[1],f=n*l-s*a;return f!==0?!1:i?Math.abs(a)>=Math.abs(l)?a>0?r[0]<=e[0]&&e[0]<=t[0]:t[0]<=e[0]&&e[0]<=r[0]:l>0?r[1]<=e[1]&&e[1]<=t[1]:t[1]<=e[1]&&e[1]<=r[1]:Math.abs(a)>=Math.abs(l)?a>0?r[0]<e[0]&&e[0]<t[0]:t[0]<e[0]&&e[0]<r[0]:l>0?r[1]<e[1]&&e[1]<t[1]:t[1]<e[1]&&e[1]<r[1]}function Ld(r,t,{ignoreSelfIntersections:e=!0}={ignoreSelfIntersections:!0}){let i=!0;return vn(r,n=>{vn(t,s=>{if(i===!1)return!1;i=Kx(n.geometry,s.geometry,e)})}),i}function Kx(r,t,e){switch(r.type){case"Point":switch(t.type){case"Point":return!nw(r.coordinates,t.coordinates);case"LineString":return!Bp(t,r);case"Polygon":return!ie(r,t)}break;case"LineString":switch(t.type){case"Point":return!Bp(r,t);case"LineString":return!Qx(r,t,e);case"Polygon":return!Fp(t,r,e)}break;case"Polygon":switch(t.type){case"Point":return!ie(t,r);case"LineString":return!Fp(r,t,e);case"Polygon":return!tw(t,r,e)}}return!1}function Bp(r,t){for(let e=0;e<r.coordinates.length-1;e++)if(ew(r.coordinates[e],r.coordinates[e+1],t.coordinates))return!0;return!1}function Qx(r,t,e){return Or(r,t,{ignoreSelfIntersections:e}).features.length>0}function Fp(r,t,e){for(const n of t.coordinates)if(ie(n,r))return!0;return Or(t,Ua(r),{ignoreSelfIntersections:e}).features.length>0}function tw(r,t,e){for(const n of r.coordinates[0])if(ie(n,t))return!0;for(const n of t.coordinates[0])if(ie(n,r))return!0;return Or(Ua(r),Ua(t),{ignoreSelfIntersections:e}).features.length>0}function ew(r,t,e){const i=e[0]-r[0],n=e[1]-r[1],s=t[0]-r[0],a=t[1]-r[1];return i*a-n*s!==0?!1:Math.abs(s)>=Math.abs(a)?s>0?r[0]<=e[0]&&e[0]<=t[0]:t[0]<=e[0]&&e[0]<=r[0]:a>0?r[1]<=e[1]&&e[1]<=t[1]:t[1]<=e[1]&&e[1]<=r[1]}function nw(r,t){return r[0]===t[0]&&r[1]===t[1]}var iw=Object.defineProperty,Qa=(r,t)=>iw(r,"name",{value:t,configurable:!0}),h_=class{constructor(t){this.direction=!1,this.compareProperties=!0;var e,i,n;this.precision=10**-((e=t==null?void 0:t.precision)!=null?e:17),this.direction=(i=t==null?void 0:t.direction)!=null?i:!1,this.compareProperties=(n=t==null?void 0:t.compareProperties)!=null?n:!0}compare(t,e){if(t.type!==e.type||!ku(t,e))return!1;switch(t.type){case"Point":return this.compareCoord(t.coordinates,e.coordinates);case"LineString":return this.compareLine(t.coordinates,e.coordinates);case"Polygon":return this.comparePolygon(t,e);case"GeometryCollection":return this.compareGeometryCollection(t,e);case"Feature":return this.compareFeature(t,e);case"FeatureCollection":return this.compareFeatureCollection(t,e);default:if(t.type.startsWith("Multi")){const i=Sf(t),n=Sf(e);return i.every(s=>n.some(a=>this.compare(s,a)))}}return!1}compareCoord(t,e){return t.length===e.length&&t.every((i,n)=>Math.abs(i-e[n])<this.precision)}compareLine(t,e,i=0,n=!1){if(!ku(t,e))return!1;const s=t;let a=e;if(n&&!this.compareCoord(s[0],a[0])){const f=this.fixStartIndex(a,s);if(f)a=f;else return!1}const l=this.compareCoord(s[i],a[i]);return this.direction||l?this.comparePath(s,a):this.compareCoord(s[i],a[a.length-(1+i)])?this.comparePath(s.slice().reverse(),a):!1}fixStartIndex(t,e){let i,n=-1;for(let s=0;s<t.length;s++)if(this.compareCoord(t[s],e[0])){n=s;break}return n>=0&&(i=[].concat(t.slice(n,t.length),t.slice(1,n+1))),i}comparePath(t,e){return t.every((i,n)=>this.compareCoord(i,e[n]))}comparePolygon(t,e){if(this.compareLine(t.coordinates[0],e.coordinates[0],1,!0)){const i=t.coordinates.slice(1,t.coordinates.length),n=e.coordinates.slice(1,e.coordinates.length);return i.every(s=>n.some(a=>this.compareLine(s,a,1,!0)))}return!1}compareGeometryCollection(t,e){return ku(t.geometries,e.geometries)&&this.compareBBox(t,e)&&t.geometries.every((i,n)=>this.compare(i,e.geometries[n]))}compareFeature(t,e){return t.id===e.id&&(this.compareProperties?Td(t.properties,e.properties):!0)&&this.compareBBox(t,e)&&this.compare(t.geometry,e.geometry)}compareFeatureCollection(t,e){return ku(t.features,e.features)&&this.compareBBox(t,e)&&t.features.every((i,n)=>this.compare(i,e.features[n]))}compareBBox(t,e){return!t.bbox&&!e.bbox||(t.bbox&&e.bbox?this.compareCoord(t.bbox,e.bbox):!1)}};Qa(h_,"GeojsonEquality");var rw=h_;function ku(r,t){return r.coordinates?r.coordinates.length===t.coordinates.length:r.length===t.length}Qa(ku,"sameLength");function Sf(r){return r.coordinates.map(t=>({type:r.type.replace("Multi",""),coordinates:t}))}Qa(Sf,"explode");function Sd(r,t,e){return new rw(e).compare(r,t)}Qa(Sd,"geojsonEquality");function Td(r,t){if(r===null&&t===null)return!0;if(r===null||t===null)return!1;const e=Object.keys(r),i=Object.keys(t);if(e.length!==i.length)return!1;for(var n of e){const s=r[n],a=t[n],l=Up(s)&&Up(a);if(l&&!Td(s,a)||!l&&s!==a)return!1}return!0}Qa(Td,"equal");var Up=Qa(r=>r!=null&&typeof r=="object","isObject");function Uo(r,t={}){var e=typeof t=="object"?t.mutate:t;if(!r)throw new Error("geojson is required");var i=gi(r),n=[];switch(i){case"LineString":n=bc(r,i);break;case"MultiLineString":case"Polygon":Jt(r).forEach(function(a){n.push(bc(a,i))});break;case"MultiPolygon":Jt(r).forEach(function(a){var l=[];a.forEach(function(f){l.push(bc(f,i))}),n.push(l)});break;case"Point":return r;case"MultiPoint":var s={};Jt(r).forEach(function(a){var l=a.join("-");Object.prototype.hasOwnProperty.call(s,l)||(n.push(a),s[l]=!0)});break;default:throw new Error(i+" geometry not supported")}return r.coordinates?e===!0?(r.coordinates=n,r):{type:i,coordinates:n}:e===!0?(r.geometry.coordinates=n,r):Qe({type:i,coordinates:n},r.properties,{bbox:r.bbox,id:r.id})}function bc(r,t){var e=Jt(r);if(e.length===2&&!Gp(e[0],e[1]))return e;var i=[],n=e.length-1,s=i.length;i.push(e[0]);for(var a=1;a<n;a++){var l=i[i.length-1];e[a][0]===l[0]&&e[a][1]===l[1]||(i.push(e[a]),s=i.length,s>2&&Vp(i[s-3],i[s-1],i[s-2])&&i.splice(i.length-2,1))}if(i.push(e[e.length-1]),s=i.length,(t==="Polygon"||t==="MultiPolygon")&&Gp(e[0],e[e.length-1])&&s<4)throw new Error("invalid polygon");return t==="LineString"&&s<3||Vp(i[s-3],i[s-1],i[s-2])&&i.splice(i.length-2,1),i}function Gp(r,t){return r[0]===t[0]&&r[1]===t[1]}function Vp(r,t,e){var i=e[0],n=e[1],s=r[0],a=r[1],l=t[0],f=t[1],d=i-s,g=n-a,m=l-s,v=f-a,_=d*v-g*m;return _!==0?!1:Math.abs(m)>=Math.abs(v)?m>0?s<=i&&i<=l:l<=i&&i<=s:v>0?a<=n&&n<=f:f<=n&&n<=a}function sw(r,t,e={}){let i=e.precision;if(i=i==null||isNaN(i)?6:i,typeof i!="number"||!(i>=0))throw new Error("precision must be a positive number");const n=Ae(r).type,s=Ae(t).type;return n!==s?!1:Sd(Uo(r),Uo(t),{precision:i})}function c_(r,t,{ignoreSelfIntersections:e=!0}={}){let i=!1;return vn(r,n=>{vn(t,s=>{if(i===!0)return!0;i=!Ld(n.geometry,s.geometry,{ignoreSelfIntersections:e})})}),i}function ow(r,t,e,i,n){f_(r,t,e||0,i||r.length-1,n||aw)}function f_(r,t,e,i,n){for(;i>e;){if(i-e>600){var s=i-e+1,a=t-e+1,l=Math.log(s),f=.5*Math.exp(2*l/3),d=.5*Math.sqrt(l*f*(s-f)/s)*(a-s/2<0?-1:1),g=Math.max(e,Math.floor(t-a*f/s+d)),m=Math.min(i,Math.floor(t+(s-a)*f/s+d));f_(r,t,g,m,n)}var v=r[t],_=e,w=i;for(hu(r,e,t),n(r[i],v)>0&&hu(r,e,i);_<w;){for(hu(r,_,w),_++,w--;n(r[_],v)<0;)_++;for(;n(r[w],v)>0;)w--}n(r[e],v)===0?hu(r,e,w):(w++,hu(r,w,i)),w<=t&&(e=w+1),t<=w&&(i=w-1)}}function hu(r,t,e){var i=r[t];r[t]=r[e],r[e]=i}function aw(r,t){return r<t?-1:r>t?1:0}class ci{constructor(t=9){this._maxEntries=Math.max(4,t),this._minEntries=Math.max(2,Math.ceil(this._maxEntries*.4)),this.clear()}all(){return this._all(this.data,[])}search(t){let e=this.data;const i=[];if(!Sl(t,e))return i;const n=this.toBBox,s=[];for(;e;){for(let a=0;a<e.children.length;a++){const l=e.children[a],f=e.leaf?n(l):l;Sl(t,f)&&(e.leaf?i.push(l):kc(t,f)?this._all(l,i):s.push(l))}e=s.pop()}return i}collides(t){let e=this.data;if(!Sl(t,e))return!1;const i=[];for(;e;){for(let n=0;n<e.children.length;n++){const s=e.children[n],a=e.leaf?this.toBBox(s):s;if(Sl(t,a)){if(e.leaf||kc(t,a))return!0;i.push(s)}}e=i.pop()}return!1}load(t){if(!(t&&t.length))return this;if(t.length<this._minEntries){for(let i=0;i<t.length;i++)this.insert(t[i]);return this}let e=this._build(t.slice(),0,t.length-1,0);if(!this.data.children.length)this.data=e;else if(this.data.height===e.height)this._splitRoot(this.data,e);else{if(this.data.height<e.height){const i=this.data;this.data=e,e=i}this._insert(e,this.data.height-e.height-1,!0)}return this}insert(t){return t&&this._insert(t,this.data.height-1),this}clear(){return this.data=Ea([]),this}remove(t,e){if(!t)return this;let i=this.data;const n=this.toBBox(t),s=[],a=[];let l,f,d;for(;i||s.length;){if(i||(i=s.pop(),f=s[s.length-1],l=a.pop(),d=!0),i.leaf){const g=uw(t,i.children,e);if(g!==-1)return i.children.splice(g,1),s.push(i),this._condense(s),this}!d&&!i.leaf&&kc(i,n)?(s.push(i),a.push(l),l=0,f=i,i=i.children[0]):f?(l++,i=f.children[l],d=!1):i=null}return this}toBBox(t){return t}compareMinX(t,e){return t.minX-e.minX}compareMinY(t,e){return t.minY-e.minY}toJSON(){return this.data}fromJSON(t){return this.data=t,this}_all(t,e){const i=[];for(;t;)t.leaf?e.push(...t.children):i.push(...t.children),t=i.pop();return e}_build(t,e,i,n){const s=i-e+1;let a=this._maxEntries,l;if(s<=a)return l=Ea(t.slice(e,i+1)),ha(l,this.toBBox),l;n||(n=Math.ceil(Math.log(s)/Math.log(a)),a=Math.ceil(s/Math.pow(a,n-1))),l=Ea([]),l.leaf=!1,l.height=n;const f=Math.ceil(s/a),d=f*Math.ceil(Math.sqrt(a));qp(t,e,i,d,this.compareMinX);for(let g=e;g<=i;g+=d){const m=Math.min(g+d-1,i);qp(t,g,m,f,this.compareMinY);for(let v=g;v<=m;v+=f){const _=Math.min(v+f-1,m);l.children.push(this._build(t,v,_,n-1))}}return ha(l,this.toBBox),l}_chooseSubtree(t,e,i,n){for(;n.push(e),!(e.leaf||n.length-1===i);){let s=1/0,a=1/0,l;for(let f=0;f<e.children.length;f++){const d=e.children[f],g=Ec(d),m=cw(t,d)-g;m<a?(a=m,s=g<s?g:s,l=d):m===a&&g<s&&(s=g,l=d)}e=l||e.children[0]}return e}_insert(t,e,i){const n=i?t:this.toBBox(t),s=[],a=this._chooseSubtree(n,this.data,e,s);for(a.children.push(t),Lu(a,n);e>=0&&s[e].children.length>this._maxEntries;)this._split(s,e),e--;this._adjustParentBBoxes(n,s,e)}_split(t,e){const i=t[e],n=i.children.length,s=this._minEntries;this._chooseSplitAxis(i,s,n);const a=this._chooseSplitIndex(i,s,n),l=Ea(i.children.splice(a,i.children.length-a));l.height=i.height,l.leaf=i.leaf,ha(i,this.toBBox),ha(l,this.toBBox),e?t[e-1].children.push(l):this._splitRoot(i,l)}_splitRoot(t,e){this.data=Ea([t,e]),this.data.height=t.height+1,this.data.leaf=!1,ha(this.data,this.toBBox)}_chooseSplitIndex(t,e,i){let n,s=1/0,a=1/0;for(let l=e;l<=i-e;l++){const f=Mu(t,0,l,this.toBBox),d=Mu(t,l,i,this.toBBox),g=fw(f,d),m=Ec(f)+Ec(d);g<s?(s=g,n=l,a=m<a?m:a):g===s&&m<a&&(a=m,n=l)}return n||i-e}_chooseSplitAxis(t,e,i){const n=t.leaf?this.compareMinX:lw,s=t.leaf?this.compareMinY:hw,a=this._allDistMargin(t,e,i,n),l=this._allDistMargin(t,e,i,s);a<l&&t.children.sort(n)}_allDistMargin(t,e,i,n){t.children.sort(n);const s=this.toBBox,a=Mu(t,0,e,s),l=Mu(t,i-e,i,s);let f=Ll(a)+Ll(l);for(let d=e;d<i-e;d++){const g=t.children[d];Lu(a,t.leaf?s(g):g),f+=Ll(a)}for(let d=i-e-1;d>=e;d--){const g=t.children[d];Lu(l,t.leaf?s(g):g),f+=Ll(l)}return f}_adjustParentBBoxes(t,e,i){for(let n=i;n>=0;n--)Lu(e[n],t)}_condense(t){for(let e=t.length-1,i;e>=0;e--)t[e].children.length===0?e>0?(i=t[e-1].children,i.splice(i.indexOf(t[e]),1)):this.clear():ha(t[e],this.toBBox)}}function uw(r,t,e){if(!e)return t.indexOf(r);for(let i=0;i<t.length;i++)if(e(r,t[i]))return i;return-1}function ha(r,t){Mu(r,0,r.children.length,t,r)}function Mu(r,t,e,i,n){n||(n=Ea(null)),n.minX=1/0,n.minY=1/0,n.maxX=-1/0,n.maxY=-1/0;for(let s=t;s<e;s++){const a=r.children[s];Lu(n,r.leaf?i(a):a)}return n}function Lu(r,t){return r.minX=Math.min(r.minX,t.minX),r.minY=Math.min(r.minY,t.minY),r.maxX=Math.max(r.maxX,t.maxX),r.maxY=Math.max(r.maxY,t.maxY),r}function lw(r,t){return r.minX-t.minX}function hw(r,t){return r.minY-t.minY}function Ec(r){return(r.maxX-r.minX)*(r.maxY-r.minY)}function Ll(r){return r.maxX-r.minX+(r.maxY-r.minY)}function cw(r,t){return(Math.max(t.maxX,r.maxX)-Math.min(t.minX,r.minX))*(Math.max(t.maxY,r.maxY)-Math.min(t.minY,r.minY))}function fw(r,t){const e=Math.max(r.minX,t.minX),i=Math.max(r.minY,t.minY),n=Math.min(r.maxX,t.maxX),s=Math.min(r.maxY,t.maxY);return Math.max(0,n-e)*Math.max(0,s-i)}function kc(r,t){return r.minX<=t.minX&&r.minY<=t.minY&&t.maxX<=r.maxX&&t.maxY<=r.maxY}function Sl(r,t){return t.minX<=r.maxX&&t.minY<=r.maxY&&t.maxX>=r.minX&&t.maxY>=r.minY}function Ea(r){return{children:r,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function qp(r,t,e,i,n){const s=[t,e];for(;s.length;){if(e=s.pop(),t=s.pop(),e-t<=i)continue;const a=t+Math.ceil((e-t)/i/2)*i;ow(r,a,t,e,n),s.push(t,a,a,e)}}function tc(r){var t=new ci(r);return t.insert=function(e){if(e.type!=="Feature")throw new Error("invalid feature");return e.bbox=e.bbox?e.bbox:Te(e),ci.prototype.insert.call(this,e)},t.load=function(e){var i=[];return Array.isArray(e)?e.forEach(function(n){if(n.type!=="Feature")throw new Error("invalid features");n.bbox=n.bbox?n.bbox:Te(n),i.push(n)}):ye(e,function(n){if(n.type!=="Feature")throw new Error("invalid features");n.bbox=n.bbox?n.bbox:Te(n),i.push(n)}),ci.prototype.load.call(this,i)},t.remove=function(e,i){if(e.type!=="Feature")throw new Error("invalid feature");return e.bbox=e.bbox?e.bbox:Te(e),ci.prototype.remove.call(this,e,i)},t.clear=function(){return ci.prototype.clear.call(this)},t.search=function(e){var i=ci.prototype.search.call(this,this.toBBox(e));return Yt(i)},t.collides=function(e){return ci.prototype.collides.call(this,this.toBBox(e))},t.all=function(){var e=ci.prototype.all.call(this);return Yt(e)},t.toJSON=function(){return ci.prototype.toJSON.call(this)},t.fromJSON=function(e){return ci.prototype.fromJSON.call(this,e)},t.toBBox=function(e){var i;if(e.bbox)i=e.bbox;else if(Array.isArray(e)&&e.length===4)i=e;else if(Array.isArray(e)&&e.length===6)i=[e[0],e[1],e[3],e[4]];else if(e.type==="Feature")i=Te(e);else if(e.type==="FeatureCollection")i=Te(e);else throw new Error("invalid geojson");return{minX:i[0],minY:i[1],maxX:i[2],maxY:i[3]}},t}function Ku(r){if(!r)throw new Error("geojson is required");const t=[];return vn(r,e=>{dw(e,t)}),Yt(t)}function dw(r,t){let e=[];const i=r.geometry;if(i!==null){switch(i.type){case"Polygon":e=Jt(i);break;case"LineString":e=[Jt(i)]}e.forEach(n=>{pw(n,r.properties).forEach(a=>{a.id=t.length,t.push(a)})})}}function pw(r,t){const e=[];return r.reduce((i,n)=>{const s=ge([i,n],t);return s.bbox=gw(i,n),e.push(s),n}),e}function gw(r,t){const e=r[0],i=r[1],n=t[0],s=t[1],a=e<n?e:n,l=i<s?i:s,f=e>n?e:n,d=i>s?i:s;return[a,l,f,d]}var mw=Object.defineProperty,yw=Object.defineProperties,_w=Object.getOwnPropertyDescriptors,Zp=Object.getOwnPropertySymbols,vw=Object.prototype.hasOwnProperty,xw=Object.prototype.propertyIsEnumerable,Hp=(r,t,e)=>t in r?mw(r,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[t]=e,Yp=(r,t)=>{for(var e in t||(t={}))vw.call(t,e)&&Hp(r,e,t[e]);if(Zp)for(var e of Zp(t))xw.call(t,e)&&Hp(r,e,t[e]);return r},Xp=(r,t)=>yw(r,_w(t));function os(r,t,e={}){if(!r||!t)throw new Error("lines and pt are required arguments");const i=me(t);let n=re([1/0,1/0],{dist:1/0,index:-1,multiFeatureIndex:-1,location:-1}),s=0;return vn(r,function(a,l,f){const d=Jt(a);for(let g=0;g<d.length-1;g++){const m=re(d[g]);m.properties.dist=we(t,m,e);const v=me(m),_=re(d[g+1]);_.properties.dist=we(t,_,e);const w=me(_),b=we(m,_,e);let S,N;v[0]===i[0]&&v[1]===i[1]?[S,,N]=[v,void 0,!1]:w[0]===i[0]&&w[1]===i[1]?[S,,N]=[w,void 0,!0]:[S,,N]=Ew(m.geometry.coordinates,_.geometry.coordinates,me(t));let k;S&&(k=re(S,{dist:we(t,S,e),multiFeatureIndex:f,location:s+we(m,S,e)})),k&&k.properties.dist<n.properties.dist&&(n=Xp(Yp({},k),{properties:Xp(Yp({},k.properties),{index:N?g+1:g})})),s+=b}}),n}function ww(r,t){const[e,i,n]=r,[s,a,l]=t;return e*s+i*a+n*l}function bw(r,t){const[e,i,n]=r,[s,a,l]=t;return[i*l-n*a,n*s-e*l,e*a-i*s]}function Wp(r){return Math.sqrt(Math.pow(r[0],2)+Math.pow(r[1],2)+Math.pow(r[2],2))}function Lo(r,t){const e=ww(r,t)/(Wp(r)*Wp(t));return Math.acos(Math.min(Math.max(e,-1),1))}function Mc(r){const t=je(r[1]),e=je(r[0]);return[Math.cos(t)*Math.cos(e),Math.cos(t)*Math.sin(e),Math.sin(t)]}function So(r){const[t,e,i]=r,n=cs(Math.asin(i));return[cs(Math.atan2(e,t)),n]}function Ew(r,t,e){const i=Mc(r),n=Mc(t),s=Mc(e),[a,l,f]=s,[d,g,m]=bw(i,n),v=g*f-m*l,_=m*a-d*f,w=d*l-g*a,b=w*g-_*m,S=v*m-w*d,N=_*d-v*g,k=1/Math.sqrt(Math.pow(b,2)+Math.pow(S,2)+Math.pow(N,2)),C=[b*k,S*k,N*k],A=[-1*b*k,-1*S*k,-1*N*k],P=Lo(i,n),q=Lo(i,C),U=Lo(n,C),I=Lo(i,A),O=Lo(n,A);let B;return q<I&&q<O||U<I&&U<O?B=C:B=A,Lo(i,B)>P||Lo(n,B)>P?we(So(B),So(i))<=we(So(B),So(n))?[So(i),!0,!1]:[So(n),!1,!0]:[So(B),!1,!1]}var Lc,$p;function kw(){return $p||($p=1,Lc=function r(t,e){if(t===e)return!0;if(t&&e&&typeof t=="object"&&typeof e=="object"){if(t.constructor!==e.constructor)return!1;var i,n,s;if(Array.isArray(t)){if(i=t.length,i!=e.length)return!1;for(n=i;n--!==0;)if(!r(t[n],e[n]))return!1;return!0}if(t.constructor===RegExp)return t.source===e.source&&t.flags===e.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===e.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===e.toString();if(s=Object.keys(t),i=s.length,i!==Object.keys(e).length)return!1;for(n=i;n--!==0;)if(!Object.prototype.hasOwnProperty.call(e,s[n]))return!1;for(n=i;n--!==0;){var a=s[n];if(!r(t[a],e[a]))return!1}return!0}return t!==t&&e!==e}),Lc}var Mw=kw();const Su=eo(Mw);function d_(r,t,e={}){if(e=e||{},!ve(e))throw new Error("options is invalid");var i=e.tolerance||0,n=[],s=tc();const a=Ku(r);s.load(a);var l;let f=[];return ss(t,function(d){var g=!1;d&&(ye(s.search(d),function(m){if(g===!1){var v=Jt(d).sort(),_=Jt(m).sort();if(Su(v,_))g=!0,l?l=Sc(l,d)||l:l=d;else if(i===0?ae(v[0],m)&&ae(v[1],m):os(m,v[0]).properties.dist<=i&&os(m,v[1]).properties.dist<=i)g=!0,l?l=Sc(l,d)||l:l=d;else if(i===0?ae(_[0],d)&&ae(_[1],d):os(d,_[0]).properties.dist<=i&&os(d,_[1]).properties.dist<=i)if(l){const w=Sc(l,m);w?l=w:f.push(m)}else l=m}}),g===!1&&l&&(n.push(l),f.length&&(n=n.concat(f),f=[]),l=void 0))}),l&&n.push(l),Yt(n)}function Sc(r,t){var e=Jt(t),i=Jt(r),n=i[0],s=i[i.length-1],a=r.geometry.coordinates;if(Su(e[0],n))a.unshift(e[1]);else if(Su(e[0],s))a.push(e[1]);else if(Su(e[1],n))a.unshift(e[0]);else if(Su(e[1],s))a.push(e[0]);else return;return r}function Lw(r,t){const e=Ae(r),i=Ae(t),n=e.type,s=i.type;if(n==="MultiPoint"&&s!=="MultiPoint"||(n==="LineString"||n==="MultiLineString")&&s!=="LineString"&&s!=="MultiLineString"||(n==="Polygon"||n==="MultiPolygon")&&s!=="Polygon"&&s!=="MultiPolygon")throw new Error("features must be of the same type");if(n==="Point")throw new Error("Point geometry not supported");if(Sd(r,t,{precision:6}))return!1;let a=0;switch(n){case"MultiPoint":for(var l=0;l<e.coordinates.length;l++)for(var f=0;f<i.coordinates.length;f++){var d=e.coordinates[l],g=i.coordinates[f];if(d[0]===g[0]&&d[1]===g[1])return!0}return!1;case"LineString":case"MultiLineString":ss(r,m=>{ss(t,v=>{d_(m,v).features.length&&a++})});break;case"Polygon":case"MultiPolygon":ss(r,m=>{ss(t,v=>{Or(m,v).features.length&&a++})});break}return a>0}function Sw(r,t){if(!r)throw new Error("line1 is required");if(!t)throw new Error("line2 is required");var e=Jp(r,"line1");if(e!=="LineString")throw new Error("line1 must be a LineString");var i=Jp(t,"line2");if(i!=="LineString")throw new Error("line2 must be a LineString");for(var n=Ku(Uo(r)).features,s=Ku(Uo(t)).features,a=0;a<n.length;a++){var l=n[a].geometry.coordinates;if(!s[a])break;var f=s[a].geometry.coordinates;if(!Tw(l,f))return!1}return!0}function Tw(r,t){var e=Fa(fs(r[0],r[1])),i=Fa(fs(t[0],t[1]));return e===i||(i-e)%180===0}function Jp(r,t){if(r.geometry&&r.geometry.type)return r.geometry.type;if(r.type)return r.type;throw new Error("Invalid GeoJSON object for "+t)}function Pw(r,t){var e=Ae(r),i=Ae(t),n=e.type,s=i.type;switch(n){case"Point":switch(s){case"LineString":return Zn(e,i);case"MultiLineString":for(var a=!1,l=0;l<i.coordinates.length;l++)Zn(e,{type:"LineString",coordinates:i.coordinates[l]})&&(a=!0);return a;case"Polygon":for(var f=0;f<i.coordinates.length;f++)if(ae(e,{type:"LineString",coordinates:i.coordinates[f]}))return!0;return!1;case"MultiPolygon":for(var f=0;f<i.coordinates.length;f++)for(var l=0;l<i.coordinates[f].length;l++)if(ae(e,{type:"LineString",coordinates:i.coordinates[f][l]}))return!0;return!1;default:throw new Error("feature2 "+s+" geometry not supported")}case"MultiPoint":switch(s){case"LineString":for(var a=!1,f=0;f<e.coordinates.length;f++)if(a||Zn({type:"Point",coordinates:e.coordinates[f]},i)&&(a=!0),ae({type:"Point",coordinates:e.coordinates[f]},i,{ignoreEndVertices:!0}))return!1;return a;case"MultiLineString":for(var a=!1,f=0;f<e.coordinates.length;f++)for(var l=0;l<i.coordinates.length;l++)if(a||Zn({type:"Point",coordinates:e.coordinates[f]},{type:"LineString",coordinates:i.coordinates[l]})&&(a=!0),ae({type:"Point",coordinates:e.coordinates[f]},{type:"LineString",coordinates:i.coordinates[l]},{ignoreEndVertices:!0}))return!1;return a;case"Polygon":for(var a=!1,f=0;f<e.coordinates.length;f++)if(a||ae({type:"Point",coordinates:e.coordinates[f]},{type:"LineString",coordinates:i.coordinates[0]})&&(a=!0),ie({type:"Point",coordinates:e.coordinates[f]},i,{ignoreBoundary:!0}))return!1;return a;case"MultiPolygon":for(var a=!1,f=0;f<e.coordinates.length;f++)for(var l=0;l<i.coordinates.length;l++)if(a||ae({type:"Point",coordinates:e.coordinates[f]},{type:"LineString",coordinates:i.coordinates[l][0]})&&(a=!0),ie({type:"Point",coordinates:e.coordinates[f]},{type:"Polygon",coordinates:i.coordinates[l]},{ignoreBoundary:!0}))return!1;return a;default:throw new Error("feature2 "+s+" geometry not supported")}case"LineString":switch(s){case"Point":return Zn(i,e);case"MultiPoint":for(var a=!1,f=0;f<i.coordinates.length;f++)if(a||Zn({type:"Point",coordinates:i.coordinates[f]},e)&&(a=!0),ae({type:"Point",coordinates:i.coordinates[f]},e,{ignoreEndVertices:!0}))return!1;return a;case"LineString":var d=!1;if(Zn({type:"Point",coordinates:e.coordinates[0]},i)&&(d=!0),Zn({type:"Point",coordinates:e.coordinates[e.coordinates.length-1]},i)&&(d=!0),d===!1)return!1;for(var f=0;f<e.coordinates.length;f++)if(ae({type:"Point",coordinates:e.coordinates[f]},i,{ignoreEndVertices:!0}))return!1;return d;case"MultiLineString":for(var d=!1,f=0;f<i.coordinates.length;f++){Zn({type:"Point",coordinates:e.coordinates[0]},{type:"LineString",coordinates:i.coordinates[f]})&&(d=!0),Zn({type:"Point",coordinates:e.coordinates[e.coordinates.length-1]},{type:"LineString",coordinates:i.coordinates[f]})&&(d=!0);for(var l=0;l<e.coordinates[f].length;l++)if(ae({type:"Point",coordinates:e.coordinates[l]},{type:"LineString",coordinates:i.coordinates[f]},{ignoreEndVertices:!0}))return!1}return d;case"Polygon":for(var a=!1,f=0;f<e.coordinates.length;f++)if(a||ae({type:"Point",coordinates:e.coordinates[f]},{type:"LineString",coordinates:i.coordinates[0]})&&(a=!0),ie({type:"Point",coordinates:e.coordinates[f]},i,{ignoreBoundary:!0}))return!1;return a;case"MultiPolygon":for(var a=!1,f=0;f<e.coordinates.length;f++){for(var l=0;l<i.coordinates.length;l++)a||ae({type:"Point",coordinates:e.coordinates[f]},{type:"LineString",coordinates:i.coordinates[l][0]})&&(a=!0);if(ie({type:"Point",coordinates:e.coordinates[f]},i,{ignoreBoundary:!0}))return!1}return a;default:throw new Error("feature2 "+s+" geometry not supported")}case"MultiLineString":switch(s){case"Point":for(var f=0;f<e.coordinates.length;f++)if(Zn(i,{type:"LineString",coordinates:e.coordinates[f]}))return!0;return!1;case"MultiPoint":for(var a=!1,f=0;f<e.coordinates.length;f++)for(var l=0;l<i.coordinates.length;l++)if(a||Zn({type:"Point",coordinates:i.coordinates[l]},{type:"LineString",coordinates:e.coordinates[l]})&&(a=!0),ae({type:"Point",coordinates:i.coordinates[l]},{type:"LineString",coordinates:e.coordinates[l]},{ignoreEndVertices:!0}))return!1;return a;case"LineString":for(var d=!1,f=0;f<e.coordinates.length;f++){Zn({type:"Point",coordinates:e.coordinates[f][0]},i)&&(d=!0),Zn({type:"Point",coordinates:e.coordinates[f][e.coordinates[f].length-1]},i)&&(d=!0);for(var l=0;l<i.coordinates.length;l++)if(ae({type:"Point",coordinates:i.coordinates[l]},{type:"LineString",coordinates:e.coordinates[f]},{ignoreEndVertices:!0}))return!1}return d;case"MultiLineString":for(var d=!1,f=0;f<e.coordinates.length;f++)for(var l=0;l<i.coordinates.length;l++){Zn({type:"Point",coordinates:e.coordinates[f][0]},{type:"LineString",coordinates:i.coordinates[l]})&&(d=!0),Zn({type:"Point",coordinates:e.coordinates[f][e.coordinates[f].length-1]},{type:"LineString",coordinates:i.coordinates[l]})&&(d=!0);for(var g=0;g<e.coordinates[f].length;g++)if(ae({type:"Point",coordinates:e.coordinates[f][g]},{type:"LineString",coordinates:i.coordinates[l]},{ignoreEndVertices:!0}))return!1}return d;case"Polygon":for(var a=!1,f=0;f<e.coordinates.length;f++)for(var l=0;l<e.coordinates.length;l++)if(a||ae({type:"Point",coordinates:e.coordinates[f][l]},{type:"LineString",coordinates:i.coordinates[0]})&&(a=!0),ie({type:"Point",coordinates:e.coordinates[f][l]},i,{ignoreBoundary:!0}))return!1;return a;case"MultiPolygon":for(var a=!1,f=0;f<i.coordinates[0].length;f++)for(var l=0;l<e.coordinates.length;l++)for(var g=0;g<e.coordinates[l].length;g++)if(a||ae({type:"Point",coordinates:e.coordinates[l][g]},{type:"LineString",coordinates:i.coordinates[0][f]})&&(a=!0),ie({type:"Point",coordinates:e.coordinates[l][g]},{type:"Polygon",coordinates:[i.coordinates[0][f]]},{ignoreBoundary:!0}))return!1;return a;default:throw new Error("feature2 "+s+" geometry not supported")}case"Polygon":switch(s){case"Point":for(var f=0;f<e.coordinates.length;f++)if(ae(i,{type:"LineString",coordinates:e.coordinates[f]}))return!0;return!1;case"MultiPoint":for(var a=!1,f=0;f<i.coordinates.length;f++)if(a||ae({type:"Point",coordinates:i.coordinates[f]},{type:"LineString",coordinates:e.coordinates[0]})&&(a=!0),ie({type:"Point",coordinates:i.coordinates[f]},e,{ignoreBoundary:!0}))return!1;return a;case"LineString":for(var a=!1,f=0;f<i.coordinates.length;f++)if(a||ae({type:"Point",coordinates:i.coordinates[f]},{type:"LineString",coordinates:e.coordinates[0]})&&(a=!0),ie({type:"Point",coordinates:i.coordinates[f]},e,{ignoreBoundary:!0}))return!1;return a;case"MultiLineString":for(var a=!1,f=0;f<i.coordinates.length;f++)for(var l=0;l<i.coordinates[f].length;l++)if(a||ae({type:"Point",coordinates:i.coordinates[f][l]},{type:"LineString",coordinates:e.coordinates[0]})&&(a=!0),ie({type:"Point",coordinates:i.coordinates[f][l]},e,{ignoreBoundary:!0}))return!1;return a;case"Polygon":for(var a=!1,f=0;f<e.coordinates[0].length;f++)if(a||ae({type:"Point",coordinates:e.coordinates[0][f]},{type:"LineString",coordinates:i.coordinates[0]})&&(a=!0),ie({type:"Point",coordinates:e.coordinates[0][f]},i,{ignoreBoundary:!0}))return!1;return a;case"MultiPolygon":for(var a=!1,f=0;f<i.coordinates[0].length;f++)for(var l=0;l<e.coordinates[0].length;l++)if(a||ae({type:"Point",coordinates:e.coordinates[0][l]},{type:"LineString",coordinates:i.coordinates[0][f]})&&(a=!0),ie({type:"Point",coordinates:e.coordinates[0][l]},{type:"Polygon",coordinates:i.coordinates[0][f]},{ignoreBoundary:!0}))return!1;return a;default:throw new Error("feature2 "+s+" geometry not supported")}case"MultiPolygon":switch(s){case"Point":for(var f=0;f<e.coordinates[0].length;f++)if(ae(i,{type:"LineString",coordinates:e.coordinates[0][f]}))return!0;return!1;case"MultiPoint":for(var a=!1,f=0;f<e.coordinates[0].length;f++)for(var l=0;l<i.coordinates.length;l++)if(a||ae({type:"Point",coordinates:i.coordinates[l]},{type:"LineString",coordinates:e.coordinates[0][f]})&&(a=!0),ie({type:"Point",coordinates:i.coordinates[l]},{type:"Polygon",coordinates:e.coordinates[0][f]},{ignoreBoundary:!0}))return!1;return a;case"LineString":for(var a=!1,f=0;f<e.coordinates[0].length;f++)for(var l=0;l<i.coordinates.length;l++)if(a||ae({type:"Point",coordinates:i.coordinates[l]},{type:"LineString",coordinates:e.coordinates[0][f]})&&(a=!0),ie({type:"Point",coordinates:i.coordinates[l]},{type:"Polygon",coordinates:e.coordinates[0][f]},{ignoreBoundary:!0}))return!1;return a;case"MultiLineString":for(var a=!1,f=0;f<e.coordinates.length;f++)for(var l=0;l<i.coordinates.length;l++)for(var g=0;g<i.coordinates[l].length;g++)if(a||ae({type:"Point",coordinates:i.coordinates[l][g]},{type:"LineString",coordinates:e.coordinates[f][0]})&&(a=!0),ie({type:"Point",coordinates:i.coordinates[l][g]},{type:"Polygon",coordinates:[e.coordinates[f][0]]},{ignoreBoundary:!0}))return!1;return a;case"Polygon":for(var a=!1,f=0;f<e.coordinates[0].length;f++)for(var l=0;l<e.coordinates[0][f].length;l++)if(a||ae({type:"Point",coordinates:e.coordinates[0][f][l]},{type:"LineString",coordinates:i.coordinates[0]})&&(a=!0),ie({type:"Point",coordinates:e.coordinates[0][f][l]},i,{ignoreBoundary:!0}))return!1;return a;case"MultiPolygon":for(var a=!1,f=0;f<e.coordinates[0].length;f++)for(var l=0;l<i.coordinates[0].length;l++)for(var g=0;g<e.coordinates[0].length;g++)if(a||ae({type:"Point",coordinates:e.coordinates[0][f][g]},{type:"LineString",coordinates:i.coordinates[0][l]})&&(a=!0),ie({type:"Point",coordinates:e.coordinates[0][f][g]},{type:"Polygon",coordinates:i.coordinates[0][l]},{ignoreBoundary:!0}))return!1;return a;default:throw new Error("feature2 "+s+" geometry not supported")}default:throw new Error("feature1 "+n+" geometry not supported")}}function Zn(r,t){return!!(jp(t.coordinates[0],r.coordinates)||jp(t.coordinates[t.coordinates.length-1],r.coordinates))}function jp(r,t){return r[0]===t[0]&&r[1]===t[1]}function Iw(r){if(!r.type)return!1;const t=Ae(r),e=t.type,i=t.coordinates;switch(e){case"Point":return i.length>1;case"MultiPoint":for(var n=0;n<i.length;n++)if(i[n].length<2)return!1;return!0;case"LineString":if(i.length<2)return!1;for(var n=0;n<i.length;n++)if(i[n].length<2)return!1;return!0;case"MultiLineString":if(i.length<2)return!1;for(var n=0;n<i.length;n++)if(i[n].length<2)return!1;return!0;case"Polygon":for(var n=0;n<t.coordinates.length;n++)if(i[n].length<4||!Kp(i[n])||Qp(i[n])||n>0&&Or($t([i[0]]),$t([i[n]])).features.length>1)return!1;return!0;case"MultiPolygon":for(var n=0;n<t.coordinates.length;n++)for(var s=t.coordinates[n],a=0;a<s.length;a++)if(s[a].length<4||!Kp(s[a])||Qp(s[a])||a===0&&!Cw(s,t.coordinates,n)||a>0&&Or($t([s[0]]),$t([s[a]])).features.length>1)return!1;return!0;default:return!1}}function Kp(r){return r[0][0]===r[r.length-1][0]&&r[0][1]===r[r.length-1][1]}function Qp(r){for(var t=0;t<r.length-1;t++)for(var e=r[t],i=t+1;i<r.length-2;i++){var n=[r[i],r[i+1]];if(ae(e,ge(n)))return!0}return!1}function Cw(r,t,e){for(var i=$t(r),n=e+1;n<t.length;n++)if(!Ld(i,$t(t[n]))&&u_(i,ge(t[n][0])))return!1;return!0}function p_(r,t){var e=Ae(r),i=Ae(t),n=e.type,s=i.type;switch(n){case"Point":switch(s){case"MultiPoint":return Aw(e,i);case"LineString":return ae(e,i,{ignoreEndVertices:!0});case"Polygon":case"MultiPolygon":return ie(e,i,{ignoreBoundary:!0});default:throw new Error("feature2 "+s+" geometry not supported")}case"MultiPoint":switch(s){case"MultiPoint":return Nw(e,i);case"LineString":return Ow(e,i);case"Polygon":case"MultiPolygon":return Rw(e,i);default:throw new Error("feature2 "+s+" geometry not supported")}case"LineString":switch(s){case"LineString":return Dw(e,i);case"Polygon":case"MultiPolygon":return zw(e,i);default:throw new Error("feature2 "+s+" geometry not supported")}case"Polygon":switch(s){case"Polygon":case"MultiPolygon":return Bw(e,i);default:throw new Error("feature2 "+s+" geometry not supported")}default:throw new Error("feature1 "+n+" geometry not supported")}}function Aw(r,t){var e,i=!1;for(e=0;e<t.coordinates.length;e++)if(m_(t.coordinates[e],r.coordinates)){i=!0;break}return i}function Nw(r,t){for(var e=0;e<r.coordinates.length;e++){for(var i=!1,n=0;n<t.coordinates.length;n++)m_(r.coordinates[e],t.coordinates[n])&&(i=!0);if(!i)return!1}return!0}function Ow(r,t){for(var e=!1,i=0;i<r.coordinates.length;i++){if(!ae(r.coordinates[i],t))return!1;e||(e=ae(r.coordinates[i],t,{ignoreEndVertices:!0}))}return e}function Rw(r,t){for(var e=!0,i=!1,n=0;n<r.coordinates.length;n++){if(i=ie(r.coordinates[n],t),!i){e=!1;break}i=ie(r.coordinates[n],t,{ignoreBoundary:!0})}return e&&i}function Dw(r,t){for(var e=0;e<r.coordinates.length;e++)if(!ae(r.coordinates[e],t))return!1;return!0}function zw(r,t){var e=Te(t),i=Te(r);if(!g_(e,i))return!1;for(var n=!1,s=0;s<r.coordinates.length;s++){if(!ie(r.coordinates[s],t))return!1;if(n||(n=ie(r.coordinates[s],t,{ignoreBoundary:!0})),!n&&s<r.coordinates.length-1){var a=Fw(r.coordinates[s],r.coordinates[s+1]);n=ie(a,t,{ignoreBoundary:!0})}}return n}function Bw(r,t){var e=Te(r),i=Te(t);if(!g_(i,e))return!1;for(var n=0;n<r.coordinates[0].length;n++)if(!ie(r.coordinates[0][n],t))return!1;return!0}function g_(r,t){return!(r[0]>t[0]||r[2]<t[2]||r[1]>t[1]||r[3]<t[3])}function m_(r,t){return r[0]===t[0]&&r[1]===t[1]}function Fw(r,t){return[(r[0]+t[0])/2,(r[1]+t[1])/2]}function ec(r,t={}){const e=Te(r),i=(e[0]+e[2])/2,n=(e[1]+e[3])/2;return re([i,n],t.properties,t)}var ch={exports:{}},Uw=ch.exports,tg;function Gw(){return tg||(tg=1,function(r,t){(function(e,i){r.exports=i()})(Uw,function(){function e(c,o){(o==null||o>c.length)&&(o=c.length);for(var u=0,p=Array(o);u<o;u++)p[u]=c[u];return p}function i(c,o,u){return o=g(o),function(p,x){if(x&&(typeof x=="object"||typeof x=="function"))return x;if(x!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return function(M){if(M===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return M}(p)}(c,v()?Reflect.construct(o,u||[],g(c).constructor):o.apply(c,u))}function n(c,o){if(!(c instanceof o))throw new TypeError("Cannot call a class as a function")}function s(c,o,u){if(v())return Reflect.construct.apply(null,arguments);var p=[null];p.push.apply(p,o);var x=new(c.bind.apply(c,p));return u&&_(x,u.prototype),x}function a(c,o){for(var u=0;u<o.length;u++){var p=o[u];p.enumerable=p.enumerable||!1,p.configurable=!0,"value"in p&&(p.writable=!0),Object.defineProperty(c,S(p.key),p)}}function l(c,o,u){return o&&a(c.prototype,o),u&&a(c,u),Object.defineProperty(c,"prototype",{writable:!1}),c}function f(c,o){var u=typeof Symbol<"u"&&c[Symbol.iterator]||c["@@iterator"];if(!u){if(Array.isArray(c)||(u=N(c))||o){u&&(c=u);var p=0,x=function(){};return{s:x,n:function(){return p>=c.length?{done:!0}:{done:!1,value:c[p++]}},e:function(Q){throw Q},f:x}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var M,D=!0,Z=!1;return{s:function(){u=u.call(c)},n:function(){var Q=u.next();return D=Q.done,Q},e:function(Q){Z=!0,M=Q},f:function(){try{D||u.return==null||u.return()}finally{if(Z)throw M}}}}function d(){return d=typeof Reflect<"u"&&Reflect.get?Reflect.get.bind():function(c,o,u){var p=function(M,D){for(;!{}.hasOwnProperty.call(M,D)&&(M=g(M))!==null;);return M}(c,o);if(p){var x=Object.getOwnPropertyDescriptor(p,o);return x.get?x.get.call(arguments.length<3?c:u):x.value}},d.apply(null,arguments)}function g(c){return g=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(o){return o.__proto__||Object.getPrototypeOf(o)},g(c)}function m(c,o){if(typeof o!="function"&&o!==null)throw new TypeError("Super expression must either be null or a function");c.prototype=Object.create(o&&o.prototype,{constructor:{value:c,writable:!0,configurable:!0}}),Object.defineProperty(c,"prototype",{writable:!1}),o&&_(c,o)}function v(){try{var c=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(v=function(){return!!c})()}function _(c,o){return _=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(u,p){return u.__proto__=p,u},_(c,o)}function w(c,o,u,p){var x=d(g(1&p?c.prototype:c),o,u);return 2&p&&typeof x=="function"?function(M){return x.apply(u,M)}:x}function b(c){return function(o){if(Array.isArray(o))return e(o)}(c)||function(o){if(typeof Symbol<"u"&&o[Symbol.iterator]!=null||o["@@iterator"]!=null)return Array.from(o)}(c)||N(c)||function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function S(c){var o=function(u,p){if(typeof u!="object"||!u)return u;var x=u[Symbol.toPrimitive];if(x!==void 0){var M=x.call(u,p);if(typeof M!="object")return M;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(u)}(c,"string");return typeof o=="symbol"?o:o+""}function N(c,o){if(c){if(typeof c=="string")return e(c,o);var u={}.toString.call(c).slice(8,-1);return u==="Object"&&c.constructor&&(u=c.constructor.name),u==="Map"||u==="Set"?Array.from(c):u==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(u)?e(c,o):void 0}}function k(c){var o=typeof Map=="function"?new Map:void 0;return k=function(u){if(u===null||!function(x){try{return Function.toString.call(x).indexOf("[native code]")!==-1}catch{return typeof x=="function"}}(u))return u;if(typeof u!="function")throw new TypeError("Super expression must either be null or a function");if(o!==void 0){if(o.has(u))return o.get(u);o.set(u,p)}function p(){return s(u,arguments,g(this).constructor)}return p.prototype=Object.create(u.prototype,{constructor:{value:p,enumerable:!1,writable:!0,configurable:!0}}),_(p,u)},k(c)}var C=function(){function c(){n(this,c),c.constructor_.apply(this,arguments)}return l(c,[{key:"getEndCapStyle",value:function(){return this._endCapStyle}},{key:"isSingleSided",value:function(){return this._isSingleSided}},{key:"setQuadrantSegments",value:function(o){this._quadrantSegments=o,this._quadrantSegments===0&&(this._joinStyle=c.JOIN_BEVEL),this._quadrantSegments<0&&(this._joinStyle=c.JOIN_MITRE,this._mitreLimit=Math.abs(this._quadrantSegments)),o<=0&&(this._quadrantSegments=1),this._joinStyle!==c.JOIN_ROUND&&(this._quadrantSegments=c.DEFAULT_QUADRANT_SEGMENTS)}},{key:"getJoinStyle",value:function(){return this._joinStyle}},{key:"setJoinStyle",value:function(o){this._joinStyle=o}},{key:"setSimplifyFactor",value:function(o){this._simplifyFactor=o<0?0:o}},{key:"getSimplifyFactor",value:function(){return this._simplifyFactor}},{key:"getQuadrantSegments",value:function(){return this._quadrantSegments}},{key:"setEndCapStyle",value:function(o){this._endCapStyle=o}},{key:"getMitreLimit",value:function(){return this._mitreLimit}},{key:"setMitreLimit",value:function(o){this._mitreLimit=o}},{key:"setSingleSided",value:function(o){this._isSingleSided=o}}],[{key:"constructor_",value:function(){if(this._quadrantSegments=c.DEFAULT_QUADRANT_SEGMENTS,this._endCapStyle=c.CAP_ROUND,this._joinStyle=c.JOIN_ROUND,this._mitreLimit=c.DEFAULT_MITRE_LIMIT,this._isSingleSided=!1,this._simplifyFactor=c.DEFAULT_SIMPLIFY_FACTOR,arguments.length!==0){if(arguments.length===1){var o=arguments[0];this.setQuadrantSegments(o)}else if(arguments.length===2){var u=arguments[0],p=arguments[1];this.setQuadrantSegments(u),this.setEndCapStyle(p)}else if(arguments.length===4){var x=arguments[0],M=arguments[1],D=arguments[2],Z=arguments[3];this.setQuadrantSegments(x),this.setEndCapStyle(M),this.setJoinStyle(D),this.setMitreLimit(Z)}}}},{key:"bufferDistanceError",value:function(o){var u=Math.PI/2/o;return 1-Math.cos(u/2)}}])}();C.CAP_ROUND=1,C.CAP_FLAT=2,C.CAP_SQUARE=3,C.JOIN_ROUND=1,C.JOIN_MITRE=2,C.JOIN_BEVEL=3,C.DEFAULT_QUADRANT_SEGMENTS=8,C.DEFAULT_MITRE_LIMIT=5,C.DEFAULT_SIMPLIFY_FACTOR=.01;var A=function(c){function o(u){var p;return n(this,o),(p=i(this,o,[u])).name=Object.keys({Exception:o})[0],p}return m(o,c),l(o,[{key:"toString",value:function(){return this.message}}])}(k(Error)),P=function(c){function o(u){var p;return n(this,o),(p=i(this,o,[u])).name=Object.keys({IllegalArgumentException:o})[0],p}return m(o,c),l(o)}(A),q=function(){return l(function c(){n(this,c)},[{key:"filter",value:function(c){}}])}();function U(){}function I(){}function O(){}var B,V,z,W,T,$,F,X,Y=function(){return l(function c(){n(this,c)},null,[{key:"equalsWithTolerance",value:function(c,o,u){return Math.abs(c-o)<=u}}])}(),j=function(){return l(function c(o,u){n(this,c),this.low=u||0,this.high=o||0},null,[{key:"toBinaryString",value:function(c){var o,u="";for(o=2147483648;o>0;o>>>=1)u+=(c.high&o)===o?"1":"0";for(o=2147483648;o>0;o>>>=1)u+=(c.low&o)===o?"1":"0";return u}}])}();function J(){}function K(){}J.NaN=NaN,J.isNaN=function(c){return Number.isNaN(c)},J.isInfinite=function(c){return!Number.isFinite(c)},J.MAX_VALUE=Number.MAX_VALUE,J.POSITIVE_INFINITY=Number.POSITIVE_INFINITY,J.NEGATIVE_INFINITY=Number.NEGATIVE_INFINITY,typeof Float64Array=="function"&&typeof Int32Array=="function"?($=2146435072,F=new Float64Array(1),X=new Int32Array(F.buffer),J.doubleToLongBits=function(c){F[0]=c;var o=0|X[0],u=0|X[1];return(u&$)===$&&1048575&u&&o!==0&&(o=0,u=2146959360),new j(u,o)},J.longBitsToDouble=function(c){return X[0]=c.low,X[1]=c.high,F[0]}):(B=1023,V=Math.log2,z=Math.floor,W=Math.pow,T=function(){for(var c=53;c>0;c--){var o=W(2,c)-1;if(z(V(o))+1===c)return o}return 0}(),J.doubleToLongBits=function(c){var o,u,p,x,M,D,Z,Q,rt;if(c<0||1/c===Number.NEGATIVE_INFINITY?(D=1<<31,c=-c):D=0,c===0)return new j(Q=D,rt=0);if(c===1/0)return new j(Q=2146435072|D,rt=0);if(c!=c)return new j(Q=2146959360,rt=0);if(x=0,rt=0,(o=z(c))>1)if(o<=T)(x=z(V(o)))<=20?(rt=0,Q=o<<20-x&1048575):(rt=o%(u=W(2,p=x-20))<<32-p,Q=o/u&1048575);else for(p=o,rt=0;(p=z(u=p/2))!==0;)x++,rt>>>=1,rt|=(1&Q)<<31,Q>>>=1,u!==p&&(Q|=524288);if(Z=x+B,M=o===0,o=c-o,x<52&&o!==0)for(p=0;;){if((u=2*o)>=1?(o=u-1,M?(Z--,M=!1):(p<<=1,p|=1,x++)):(o=u,M?--Z==0&&(x++,M=!1):(p<<=1,x++)),x===20)Q|=p,p=0;else if(x===52){rt|=p;break}if(u===1){x<20?Q|=p<<20-x:x<52&&(rt|=p<<52-x);break}}return Q|=Z<<20,new j(Q|=D,rt)},J.longBitsToDouble=function(c){var o,u,p,x,M=c.high,D=c.low,Z=M&1<<31?-1:1;for(p=((2146435072&M)>>20)-B,x=0,u=1<<19,o=1;o<=20;o++)M&u&&(x+=W(2,-o)),u>>>=1;for(u=1<<31,o=21;o<=52;o++)D&u&&(x+=W(2,-o)),u>>>=1;if(p===-1023){if(x===0)return 0*Z;p=-1022}else{if(p===1024)return x===0?Z/0:NaN;x+=1}return Z*x*W(2,p)});var et=function(c){function o(u){var p;return n(this,o),(p=i(this,o,[u])).name=Object.keys({RuntimeException:o})[0],p}return m(o,c),l(o)}(A),ft=function(c){function o(){var u;return n(this,o),u=i(this,o),o.constructor_.apply(u,arguments),u}return m(o,c),l(o,null,[{key:"constructor_",value:function(){if(arguments.length===0)et.constructor_.call(this);else if(arguments.length===1){var u=arguments[0];et.constructor_.call(this,u)}}}])}(et),lt=function(){function c(){n(this,c)}return l(c,null,[{key:"shouldNeverReachHere",value:function(){if(arguments.length===0)c.shouldNeverReachHere(null);else if(arguments.length===1){var o=arguments[0];throw new ft("Should never reach here"+(o!==null?": "+o:""))}}},{key:"isTrue",value:function(){if(arguments.length===1){var o=arguments[0];c.isTrue(o,null)}else if(arguments.length===2){var u=arguments[1];if(!arguments[0])throw u===null?new ft:new ft(u)}}},{key:"equals",value:function(){if(arguments.length===2){var o=arguments[0],u=arguments[1];c.equals(o,u,null)}else if(arguments.length===3){var p=arguments[0],x=arguments[1],M=arguments[2];if(!x.equals(p))throw new ft("Expected "+p+" but encountered "+x+(M!==null?": "+M:""))}}}])}(),ut=new ArrayBuffer(8),mt=new Float64Array(ut),Et=new Int32Array(ut),at=function(){function c(){n(this,c),c.constructor_.apply(this,arguments)}return l(c,[{key:"getM",value:function(){return J.NaN}},{key:"setOrdinate",value:function(o,u){switch(o){case c.X:this.x=u;break;case c.Y:this.y=u;break;case c.Z:this.setZ(u);break;default:throw new P("Invalid ordinate index: "+o)}}},{key:"equals2D",value:function(){if(arguments.length===1){var o=arguments[0];return this.x===o.x&&this.y===o.y}if(arguments.length===2){var u=arguments[0],p=arguments[1];return!!Y.equalsWithTolerance(this.x,u.x,p)&&!!Y.equalsWithTolerance(this.y,u.y,p)}}},{key:"setM",value:function(o){throw new P("Invalid ordinate index: "+c.M)}},{key:"getZ",value:function(){return this.z}},{key:"getOrdinate",value:function(o){switch(o){case c.X:return this.x;case c.Y:return this.y;case c.Z:return this.getZ()}throw new P("Invalid ordinate index: "+o)}},{key:"equals3D",value:function(o){return this.x===o.x&&this.y===o.y&&(this.getZ()===o.getZ()||J.isNaN(this.getZ())&&J.isNaN(o.getZ()))}},{key:"equals",value:function(o){return o instanceof c&&this.equals2D(o)}},{key:"equalInZ",value:function(o,u){return Y.equalsWithTolerance(this.getZ(),o.getZ(),u)}},{key:"setX",value:function(o){this.x=o}},{key:"compareTo",value:function(o){var u=o;return this.x<u.x?-1:this.x>u.x?1:this.y<u.y?-1:this.y>u.y?1:0}},{key:"getX",value:function(){return this.x}},{key:"setZ",value:function(o){this.z=o}},{key:"clone",value:function(){try{return null}catch(o){if(o instanceof CloneNotSupportedException)return lt.shouldNeverReachHere("this shouldn't happen because this class is Cloneable"),null;throw o}}},{key:"copy",value:function(){return new c(this)}},{key:"toString",value:function(){return"("+this.x+", "+this.y+", "+this.getZ()+")"}},{key:"distance3D",value:function(o){var u=this.x-o.x,p=this.y-o.y,x=this.getZ()-o.getZ();return Math.sqrt(u*u+p*p+x*x)}},{key:"getY",value:function(){return this.y}},{key:"setY",value:function(o){this.y=o}},{key:"distance",value:function(o){var u=this.x-o.x,p=this.y-o.y;return Math.sqrt(u*u+p*p)}},{key:"hashCode",value:function(){var o=17;return o=37*(o=37*o+c.hashCode(this.x))+c.hashCode(this.y)}},{key:"setCoordinate",value:function(o){this.x=o.x,this.y=o.y,this.z=o.getZ()}},{key:"interfaces_",get:function(){return[U,I,O]}}],[{key:"constructor_",value:function(){if(this.x=null,this.y=null,this.z=null,arguments.length===0)c.constructor_.call(this,0,0);else if(arguments.length===1){var o=arguments[0];c.constructor_.call(this,o.x,o.y,o.getZ())}else if(arguments.length===2){var u=arguments[0],p=arguments[1];c.constructor_.call(this,u,p,c.NULL_ORDINATE)}else if(arguments.length===3){var x=arguments[0],M=arguments[1],D=arguments[2];this.x=x,this.y=M,this.z=D}}},{key:"hashCode",value:function(o){return mt[0]=o,Et[0]^Et[1]}}])}(),Rt=function(){function c(){n(this,c),c.constructor_.apply(this,arguments)}return l(c,[{key:"compare",value:function(o,u){var p=c.compare(o.x,u.x);if(p!==0)return p;var x=c.compare(o.y,u.y);return x!==0?x:this._dimensionsToTest<=2?0:c.compare(o.getZ(),u.getZ())}},{key:"interfaces_",get:function(){return[K]}}],[{key:"constructor_",value:function(){if(this._dimensionsToTest=2,arguments.length===0)c.constructor_.call(this,2);else if(arguments.length===1){var o=arguments[0];if(o!==2&&o!==3)throw new P("only 2 or 3 dimensions may be specified");this._dimensionsToTest=o}}},{key:"compare",value:function(o,u){return o<u?-1:o>u?1:J.isNaN(o)?J.isNaN(u)?0:-1:J.isNaN(u)?1:0}}])}();at.DimensionalComparator=Rt,at.NULL_ORDINATE=J.NaN,at.X=0,at.Y=1,at.Z=2,at.M=3;var xt=function(){function c(){n(this,c),c.constructor_.apply(this,arguments)}return l(c,[{key:"getArea",value:function(){return this.getWidth()*this.getHeight()}},{key:"equals",value:function(o){if(!(o instanceof c))return!1;var u=o;return this.isNull()?u.isNull():this._maxx===u.getMaxX()&&this._maxy===u.getMaxY()&&this._minx===u.getMinX()&&this._miny===u.getMinY()}},{key:"intersection",value:function(o){if(this.isNull()||o.isNull()||!this.intersects(o))return new c;var u=this._minx>o._minx?this._minx:o._minx,p=this._miny>o._miny?this._miny:o._miny;return new c(u,this._maxx<o._maxx?this._maxx:o._maxx,p,this._maxy<o._maxy?this._maxy:o._maxy)}},{key:"isNull",value:function(){return this._maxx<this._minx}},{key:"getMaxX",value:function(){return this._maxx}},{key:"covers",value:function(){if(arguments.length===1){if(arguments[0]instanceof at){var o=arguments[0];return this.covers(o.x,o.y)}if(arguments[0]instanceof c){var u=arguments[0];return!this.isNull()&&!u.isNull()&&u.getMinX()>=this._minx&&u.getMaxX()<=this._maxx&&u.getMinY()>=this._miny&&u.getMaxY()<=this._maxy}}else if(arguments.length===2){var p=arguments[0],x=arguments[1];return!this.isNull()&&p>=this._minx&&p<=this._maxx&&x>=this._miny&&x<=this._maxy}}},{key:"intersects",value:function(){if(arguments.length===1){if(arguments[0]instanceof c){var o=arguments[0];return!this.isNull()&&!o.isNull()&&!(o._minx>this._maxx||o._maxx<this._minx||o._miny>this._maxy||o._maxy<this._miny)}if(arguments[0]instanceof at){var u=arguments[0];return this.intersects(u.x,u.y)}}else if(arguments.length===2){if(arguments[0]instanceof at&&arguments[1]instanceof at){var p=arguments[0],x=arguments[1];return!this.isNull()&&!((p.x<x.x?p.x:x.x)>this._maxx)&&!((p.x>x.x?p.x:x.x)<this._minx)&&!((p.y<x.y?p.y:x.y)>this._maxy)&&!((p.y>x.y?p.y:x.y)<this._miny)}if(typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var M=arguments[0],D=arguments[1];return!this.isNull()&&!(M>this._maxx||M<this._minx||D>this._maxy||D<this._miny)}}}},{key:"getMinY",value:function(){return this._miny}},{key:"getDiameter",value:function(){if(this.isNull())return 0;var o=this.getWidth(),u=this.getHeight();return Math.sqrt(o*o+u*u)}},{key:"getMinX",value:function(){return this._minx}},{key:"expandToInclude",value:function(){if(arguments.length===1){if(arguments[0]instanceof at){var o=arguments[0];this.expandToInclude(o.x,o.y)}else if(arguments[0]instanceof c){var u=arguments[0];if(u.isNull())return null;this.isNull()?(this._minx=u.getMinX(),this._maxx=u.getMaxX(),this._miny=u.getMinY(),this._maxy=u.getMaxY()):(u._minx<this._minx&&(this._minx=u._minx),u._maxx>this._maxx&&(this._maxx=u._maxx),u._miny<this._miny&&(this._miny=u._miny),u._maxy>this._maxy&&(this._maxy=u._maxy))}}else if(arguments.length===2){var p=arguments[0],x=arguments[1];this.isNull()?(this._minx=p,this._maxx=p,this._miny=x,this._maxy=x):(p<this._minx&&(this._minx=p),p>this._maxx&&(this._maxx=p),x<this._miny&&(this._miny=x),x>this._maxy&&(this._maxy=x))}}},{key:"minExtent",value:function(){if(this.isNull())return 0;var o=this.getWidth(),u=this.getHeight();return o<u?o:u}},{key:"getWidth",value:function(){return this.isNull()?0:this._maxx-this._minx}},{key:"compareTo",value:function(o){var u=o;return this.isNull()?u.isNull()?0:-1:u.isNull()?1:this._minx<u._minx?-1:this._minx>u._minx?1:this._miny<u._miny?-1:this._miny>u._miny?1:this._maxx<u._maxx?-1:this._maxx>u._maxx?1:this._maxy<u._maxy?-1:this._maxy>u._maxy?1:0}},{key:"translate",value:function(o,u){if(this.isNull())return null;this.init(this.getMinX()+o,this.getMaxX()+o,this.getMinY()+u,this.getMaxY()+u)}},{key:"copy",value:function(){return new c(this)}},{key:"toString",value:function(){return"Env["+this._minx+" : "+this._maxx+", "+this._miny+" : "+this._maxy+"]"}},{key:"setToNull",value:function(){this._minx=0,this._maxx=-1,this._miny=0,this._maxy=-1}},{key:"disjoint",value:function(o){return!(!this.isNull()&&!o.isNull())||o._minx>this._maxx||o._maxx<this._minx||o._miny>this._maxy||o._maxy<this._miny}},{key:"getHeight",value:function(){return this.isNull()?0:this._maxy-this._miny}},{key:"maxExtent",value:function(){if(this.isNull())return 0;var o=this.getWidth(),u=this.getHeight();return o>u?o:u}},{key:"expandBy",value:function(){if(arguments.length===1){var o=arguments[0];this.expandBy(o,o)}else if(arguments.length===2){var u=arguments[0],p=arguments[1];if(this.isNull())return null;this._minx-=u,this._maxx+=u,this._miny-=p,this._maxy+=p,(this._minx>this._maxx||this._miny>this._maxy)&&this.setToNull()}}},{key:"contains",value:function(){if(arguments.length===1){if(arguments[0]instanceof c){var o=arguments[0];return this.covers(o)}if(arguments[0]instanceof at){var u=arguments[0];return this.covers(u)}}else if(arguments.length===2){var p=arguments[0],x=arguments[1];return this.covers(p,x)}}},{key:"centre",value:function(){return this.isNull()?null:new at((this.getMinX()+this.getMaxX())/2,(this.getMinY()+this.getMaxY())/2)}},{key:"init",value:function(){if(arguments.length===0)this.setToNull();else if(arguments.length===1){if(arguments[0]instanceof at){var o=arguments[0];this.init(o.x,o.x,o.y,o.y)}else if(arguments[0]instanceof c){var u=arguments[0];this._minx=u._minx,this._maxx=u._maxx,this._miny=u._miny,this._maxy=u._maxy}}else if(arguments.length===2){var p=arguments[0],x=arguments[1];this.init(p.x,x.x,p.y,x.y)}else if(arguments.length===4){var M=arguments[0],D=arguments[1],Z=arguments[2],Q=arguments[3];M<D?(this._minx=M,this._maxx=D):(this._minx=D,this._maxx=M),Z<Q?(this._miny=Z,this._maxy=Q):(this._miny=Q,this._maxy=Z)}}},{key:"getMaxY",value:function(){return this._maxy}},{key:"distance",value:function(o){if(this.intersects(o))return 0;var u=0;this._maxx<o._minx?u=o._minx-this._maxx:this._minx>o._maxx&&(u=this._minx-o._maxx);var p=0;return this._maxy<o._miny?p=o._miny-this._maxy:this._miny>o._maxy&&(p=this._miny-o._maxy),u===0?p:p===0?u:Math.sqrt(u*u+p*p)}},{key:"hashCode",value:function(){var o=17;return o=37*(o=37*(o=37*(o=37*o+at.hashCode(this._minx))+at.hashCode(this._maxx))+at.hashCode(this._miny))+at.hashCode(this._maxy)}},{key:"interfaces_",get:function(){return[U,O]}}],[{key:"constructor_",value:function(){if(this._minx=null,this._maxx=null,this._miny=null,this._maxy=null,arguments.length===0)this.init();else if(arguments.length===1){if(arguments[0]instanceof at){var o=arguments[0];this.init(o.x,o.x,o.y,o.y)}else if(arguments[0]instanceof c){var u=arguments[0];this.init(u)}}else if(arguments.length===2){var p=arguments[0],x=arguments[1];this.init(p.x,x.x,p.y,x.y)}else if(arguments.length===4){var M=arguments[0],D=arguments[1],Z=arguments[2],Q=arguments[3];this.init(M,D,Z,Q)}}},{key:"intersects",value:function(){if(arguments.length===3){var o=arguments[0],u=arguments[1],p=arguments[2];return p.x>=(o.x<u.x?o.x:u.x)&&p.x<=(o.x>u.x?o.x:u.x)&&p.y>=(o.y<u.y?o.y:u.y)&&p.y<=(o.y>u.y?o.y:u.y)}if(arguments.length===4){var x=arguments[0],M=arguments[1],D=arguments[2],Z=arguments[3],Q=Math.min(D.x,Z.x),rt=Math.max(D.x,Z.x),dt=Math.min(x.x,M.x),gt=Math.max(x.x,M.x);return!(dt>rt)&&!(gt<Q)&&(Q=Math.min(D.y,Z.y),rt=Math.max(D.y,Z.y),dt=Math.min(x.y,M.y),gt=Math.max(x.y,M.y),!(dt>rt)&&!(gt<Q))}}}])}(),_t=function(){function c(){n(this,c),c.constructor_.apply(this,arguments)}return l(c,[{key:"isGeometryCollection",value:function(){return this.getTypeCode()===c.TYPECODE_GEOMETRYCOLLECTION}},{key:"getFactory",value:function(){return this._factory}},{key:"getGeometryN",value:function(o){return this}},{key:"getArea",value:function(){return 0}},{key:"isRectangle",value:function(){return!1}},{key:"equalsExact",value:function(o){return this===o||this.equalsExact(o,0)}},{key:"geometryChanged",value:function(){this.apply(c.geometryChangedFilter)}},{key:"geometryChangedAction",value:function(){this._envelope=null}},{key:"equalsNorm",value:function(o){return o!==null&&this.norm().equalsExact(o.norm())}},{key:"getLength",value:function(){return 0}},{key:"getNumGeometries",value:function(){return 1}},{key:"compareTo",value:function(){var o;if(arguments.length===1){var u=arguments[0];return o=u,this.getTypeCode()!==o.getTypeCode()?this.getTypeCode()-o.getTypeCode():this.isEmpty()&&o.isEmpty()?0:this.isEmpty()?-1:o.isEmpty()?1:this.compareToSameClass(u)}if(arguments.length===2){var p=arguments[0],x=arguments[1];return o=p,this.getTypeCode()!==o.getTypeCode()?this.getTypeCode()-o.getTypeCode():this.isEmpty()&&o.isEmpty()?0:this.isEmpty()?-1:o.isEmpty()?1:this.compareToSameClass(p,x)}}},{key:"getUserData",value:function(){return this._userData}},{key:"getSRID",value:function(){return this._SRID}},{key:"getEnvelope",value:function(){return this.getFactory().toGeometry(this.getEnvelopeInternal())}},{key:"checkNotGeometryCollection",value:function(o){if(o.getTypeCode()===c.TYPECODE_GEOMETRYCOLLECTION)throw new P("This method does not support GeometryCollection arguments")}},{key:"equal",value:function(o,u,p){return p===0?o.equals(u):o.distance(u)<=p}},{key:"norm",value:function(){var o=this.copy();return o.normalize(),o}},{key:"reverse",value:function(){var o=this.reverseInternal();return this.envelope!=null&&(o.envelope=this.envelope.copy()),o.setSRID(this.getSRID()),o}},{key:"copy",value:function(){var o=this.copyInternal();return o.envelope=this._envelope==null?null:this._envelope.copy(),o._SRID=this._SRID,o._userData=this._userData,o}},{key:"getPrecisionModel",value:function(){return this._factory.getPrecisionModel()}},{key:"getEnvelopeInternal",value:function(){return this._envelope===null&&(this._envelope=this.computeEnvelopeInternal()),new xt(this._envelope)}},{key:"setSRID",value:function(o){this._SRID=o}},{key:"setUserData",value:function(o){this._userData=o}},{key:"compare",value:function(o,u){for(var p=o.iterator(),x=u.iterator();p.hasNext()&&x.hasNext();){var M=p.next(),D=x.next(),Z=M.compareTo(D);if(Z!==0)return Z}return p.hasNext()?1:x.hasNext()?-1:0}},{key:"hashCode",value:function(){return this.getEnvelopeInternal().hashCode()}},{key:"isEquivalentClass",value:function(o){return this.getClass()===o.getClass()}},{key:"isGeometryCollectionOrDerived",value:function(){return this.getTypeCode()===c.TYPECODE_GEOMETRYCOLLECTION||this.getTypeCode()===c.TYPECODE_MULTIPOINT||this.getTypeCode()===c.TYPECODE_MULTILINESTRING||this.getTypeCode()===c.TYPECODE_MULTIPOLYGON}},{key:"interfaces_",get:function(){return[I,U,O]}},{key:"getClass",value:function(){return c}}],[{key:"hasNonEmptyElements",value:function(o){for(var u=0;u<o.length;u++)if(!o[u].isEmpty())return!0;return!1}},{key:"hasNullElements",value:function(o){for(var u=0;u<o.length;u++)if(o[u]===null)return!0;return!1}}])}();_t.constructor_=function(c){c&&(this._envelope=null,this._userData=null,this._factory=c,this._SRID=c.getSRID())},_t.TYPECODE_POINT=0,_t.TYPECODE_MULTIPOINT=1,_t.TYPECODE_LINESTRING=2,_t.TYPECODE_LINEARRING=3,_t.TYPECODE_MULTILINESTRING=4,_t.TYPECODE_POLYGON=5,_t.TYPECODE_MULTIPOLYGON=6,_t.TYPECODE_GEOMETRYCOLLECTION=7,_t.TYPENAME_POINT="Point",_t.TYPENAME_MULTIPOINT="MultiPoint",_t.TYPENAME_LINESTRING="LineString",_t.TYPENAME_LINEARRING="LinearRing",_t.TYPENAME_MULTILINESTRING="MultiLineString",_t.TYPENAME_POLYGON="Polygon",_t.TYPENAME_MULTIPOLYGON="MultiPolygon",_t.TYPENAME_GEOMETRYCOLLECTION="GeometryCollection",_t.geometryChangedFilter={get interfaces_(){return[q]},filter:function(c){c.geometryChangedAction()}};var tt=function(){function c(){n(this,c)}return l(c,null,[{key:"toLocationSymbol",value:function(o){switch(o){case c.EXTERIOR:return"e";case c.BOUNDARY:return"b";case c.INTERIOR:return"i";case c.NONE:return"-"}throw new P("Unknown location value: "+o)}}])}();tt.INTERIOR=0,tt.BOUNDARY=1,tt.EXTERIOR=2,tt.NONE=-1;var wt=function(){return l(function c(){n(this,c)},[{key:"add",value:function(){}},{key:"addAll",value:function(){}},{key:"isEmpty",value:function(){}},{key:"iterator",value:function(){}},{key:"size",value:function(){}},{key:"toArray",value:function(){}},{key:"remove",value:function(){}}])}(),G=function(c){function o(u){var p;return n(this,o),(p=i(this,o,[u])).name=Object.keys({NoSuchElementException:o})[0],p}return m(o,c),l(o)}(A),ct=function(c){function o(u){var p;return n(this,o),(p=i(this,o,[u])).name=Object.keys({UnsupportedOperationException:o})[0],p}return m(o,c),l(o)}(A),ht=function(c){function o(){return n(this,o),i(this,o,arguments)}return m(o,c),l(o,[{key:"contains",value:function(){}}])}(wt),ot=function(c){function o(u){var p;return n(this,o),(p=i(this,o)).map=new Map,u instanceof wt&&p.addAll(u),p}return m(o,c),l(o,[{key:"contains",value:function(u){var p=u.hashCode?u.hashCode():u;return!!this.map.has(p)}},{key:"add",value:function(u){var p=u.hashCode?u.hashCode():u;return!this.map.has(p)&&!!this.map.set(p,u)}},{key:"addAll",value:function(u){var p,x=f(u);try{for(x.s();!(p=x.n()).done;){var M=p.value;this.add(M)}}catch(D){x.e(D)}finally{x.f()}return!0}},{key:"remove",value:function(){throw new ct}},{key:"size",value:function(){return this.map.size}},{key:"isEmpty",value:function(){return this.map.size===0}},{key:"toArray",value:function(){return Array.from(this.map.values())}},{key:"iterator",value:function(){return new it(this.map)}},{key:Symbol.iterator,value:function(){return this.map}}])}(ht),it=function(){return l(function c(o){n(this,c),this.iterator=o.values();var u=this.iterator.next(),p=u.done,x=u.value;this.done=p,this.value=x},[{key:"next",value:function(){if(this.done)throw new G;var c=this.value,o=this.iterator.next(),u=o.done,p=o.value;return this.done=u,this.value=p,c}},{key:"hasNext",value:function(){return!this.done}},{key:"remove",value:function(){throw new ct}}])}(),st=function(){function c(){n(this,c)}return l(c,null,[{key:"opposite",value:function(o){return o===c.LEFT?c.RIGHT:o===c.RIGHT?c.LEFT:o}}])}();st.ON=0,st.LEFT=1,st.RIGHT=2;var kt=function(c){function o(u){var p;return n(this,o),(p=i(this,o,[u])).name=Object.keys({EmptyStackException:o})[0],p}return m(o,c),l(o)}(A),Lt=function(c){function o(u){var p;return n(this,o),(p=i(this,o,[u])).name=Object.keys({IndexOutOfBoundsException:o})[0],p}return m(o,c),l(o)}(A),yt=function(c){function o(){return n(this,o),i(this,o,arguments)}return m(o,c),l(o,[{key:"get",value:function(){}},{key:"set",value:function(){}},{key:"isEmpty",value:function(){}}])}(wt),At=function(c){function o(){var u;return n(this,o),(u=i(this,o)).array=[],u}return m(o,c),l(o,[{key:"add",value:function(u){return this.array.push(u),!0}},{key:"get",value:function(u){if(u<0||u>=this.size())throw new Lt;return this.array[u]}},{key:"push",value:function(u){return this.array.push(u),u}},{key:"pop",value:function(){if(this.array.length===0)throw new kt;return this.array.pop()}},{key:"peek",value:function(){if(this.array.length===0)throw new kt;return this.array[this.array.length-1]}},{key:"empty",value:function(){return this.array.length===0}},{key:"isEmpty",value:function(){return this.empty()}},{key:"search",value:function(u){return this.array.indexOf(u)}},{key:"size",value:function(){return this.array.length}},{key:"toArray",value:function(){return this.array.slice()}}])}(yt);function St(c,o){return c.interfaces_&&c.interfaces_.indexOf(o)>-1}var Ct=function(){return l(function c(o){n(this,c),this.str=o},[{key:"append",value:function(c){this.str+=c}},{key:"setCharAt",value:function(c,o){this.str=this.str.substr(0,c)+o+this.str.substr(c+1)}},{key:"toString",value:function(){return this.str}}])}(),Bt=function(){function c(o){n(this,c),this.value=o}return l(c,[{key:"intValue",value:function(){return this.value}},{key:"compareTo",value:function(o){return this.value<o?-1:this.value>o?1:0}}],[{key:"compare",value:function(o,u){return o<u?-1:o>u?1:0}},{key:"isNan",value:function(o){return Number.isNaN(o)}},{key:"valueOf",value:function(o){return new c(o)}}])}(),ue=function(){return l(function c(){n(this,c)},null,[{key:"isWhitespace",value:function(c){return c<=32&&c>=0||c===127}},{key:"toUpperCase",value:function(c){return c.toUpperCase()}}])}(),Pt=function(){function c(){n(this,c),c.constructor_.apply(this,arguments)}return l(c,[{key:"le",value:function(o){return this._hi<o._hi||this._hi===o._hi&&this._lo<=o._lo}},{key:"extractSignificantDigits",value:function(o,u){var p=this.abs(),x=c.magnitude(p._hi),M=c.TEN.pow(x);(p=p.divide(M)).gt(c.TEN)?(p=p.divide(c.TEN),x+=1):p.lt(c.ONE)&&(p=p.multiply(c.TEN),x-=1);for(var D=x+1,Z=new Ct,Q=c.MAX_PRINT_DIGITS-1,rt=0;rt<=Q;rt++){o&&rt===D&&Z.append(".");var dt=Math.trunc(p._hi);if(dt<0)break;var gt=!1,Tt=0;dt>9?(gt=!0,Tt="9"):Tt="0"+dt,Z.append(Tt),p=p.subtract(c.valueOf(dt)).multiply(c.TEN),gt&&p.selfAdd(c.TEN);var Ot=!0,zt=c.magnitude(p._hi);if(zt<0&&Math.abs(zt)>=Q-rt&&(Ot=!1),!Ot)break}return u[0]=x,Z.toString()}},{key:"sqr",value:function(){return this.multiply(this)}},{key:"doubleValue",value:function(){return this._hi+this._lo}},{key:"subtract",value:function(){if(arguments[0]instanceof c){var o=arguments[0];return this.add(o.negate())}if(typeof arguments[0]=="number"){var u=arguments[0];return this.add(-u)}}},{key:"equals",value:function(){if(arguments.length===1&&arguments[0]instanceof c){var o=arguments[0];return this._hi===o._hi&&this._lo===o._lo}}},{key:"isZero",value:function(){return this._hi===0&&this._lo===0}},{key:"selfSubtract",value:function(){if(arguments[0]instanceof c){var o=arguments[0];return this.isNaN()?this:this.selfAdd(-o._hi,-o._lo)}if(typeof arguments[0]=="number"){var u=arguments[0];return this.isNaN()?this:this.selfAdd(-u,0)}}},{key:"getSpecialNumberString",value:function(){return this.isZero()?"0.0":this.isNaN()?"NaN ":null}},{key:"min",value:function(o){return this.le(o)?this:o}},{key:"selfDivide",value:function(){if(arguments.length===1){if(arguments[0]instanceof c){var o=arguments[0];return this.selfDivide(o._hi,o._lo)}if(typeof arguments[0]=="number"){var u=arguments[0];return this.selfDivide(u,0)}}else if(arguments.length===2){var p,x,M,D,Z=arguments[0],Q=arguments[1],rt=null,dt=null,gt=null,Tt=null;return M=this._hi/Z,Tt=(rt=(gt=c.SPLIT*M)-(rt=gt-M))*(dt=(Tt=c.SPLIT*Z)-(dt=Tt-Z))-(D=M*Z)+rt*(x=Z-dt)+(p=M-rt)*dt+p*x,Tt=M+(gt=(this._hi-D-Tt+this._lo-M*Q)/Z),this._hi=Tt,this._lo=M-Tt+gt,this}}},{key:"dump",value:function(){return"DD<"+this._hi+", "+this._lo+">"}},{key:"divide",value:function(){if(arguments[0]instanceof c){var o,u,p,x,M=arguments[0],D=null,Z=null,Q=null,rt=null;return o=(p=this._hi/M._hi)-(D=(Q=c.SPLIT*p)-(D=Q-p)),rt=D*(Z=(rt=c.SPLIT*M._hi)-(Z=rt-M._hi))-(x=p*M._hi)+D*(u=M._hi-Z)+o*Z+o*u,new c(rt=p+(Q=(this._hi-x-rt+this._lo-p*M._lo)/M._hi),p-rt+Q)}if(typeof arguments[0]=="number"){var dt=arguments[0];return J.isNaN(dt)?c.createNaN():c.copy(this).selfDivide(dt,0)}}},{key:"ge",value:function(o){return this._hi>o._hi||this._hi===o._hi&&this._lo>=o._lo}},{key:"pow",value:function(o){if(o===0)return c.valueOf(1);var u=new c(this),p=c.valueOf(1),x=Math.abs(o);if(x>1)for(;x>0;)x%2==1&&p.selfMultiply(u),(x/=2)>0&&(u=u.sqr());else p=u;return o<0?p.reciprocal():p}},{key:"ceil",value:function(){if(this.isNaN())return c.NaN;var o=Math.ceil(this._hi),u=0;return o===this._hi&&(u=Math.ceil(this._lo)),new c(o,u)}},{key:"compareTo",value:function(o){var u=o;return this._hi<u._hi?-1:this._hi>u._hi?1:this._lo<u._lo?-1:this._lo>u._lo?1:0}},{key:"rint",value:function(){return this.isNaN()?this:this.add(.5).floor()}},{key:"setValue",value:function(){if(arguments[0]instanceof c){var o=arguments[0];return this.init(o),this}if(typeof arguments[0]=="number"){var u=arguments[0];return this.init(u),this}}},{key:"max",value:function(o){return this.ge(o)?this:o}},{key:"sqrt",value:function(){if(this.isZero())return c.valueOf(0);if(this.isNegative())return c.NaN;var o=1/Math.sqrt(this._hi),u=this._hi*o,p=c.valueOf(u),x=this.subtract(p.sqr())._hi*(.5*o);return p.add(x)}},{key:"selfAdd",value:function(){if(arguments.length===1){if(arguments[0]instanceof c){var o=arguments[0];return this.selfAdd(o._hi,o._lo)}if(typeof arguments[0]=="number"){var u,p,x,M,D,Z=arguments[0],Q=null;return Q=(x=this._hi+Z)-(M=x-this._hi),p=(D=(Q=Z-M+(this._hi-Q))+this._lo)+(x-(u=x+D)),this._hi=u+p,this._lo=p+(u-this._hi),this}}else if(arguments.length===2){var rt,dt,gt,Tt,Ot=arguments[0],zt=arguments[1],qt=null,ne=null,jt=null;gt=this._hi+Ot,dt=this._lo+zt,ne=gt-(jt=gt-this._hi),qt=dt-(Tt=dt-this._lo);var Ee=(rt=gt+(jt=(ne=Ot-jt+(this._hi-ne))+dt))+(jt=(qt=zt-Tt+(this._lo-qt))+(jt+(gt-rt))),Pe=jt+(rt-Ee);return this._hi=Ee,this._lo=Pe,this}}},{key:"selfMultiply",value:function(){if(arguments.length===1){if(arguments[0]instanceof c){var o=arguments[0];return this.selfMultiply(o._hi,o._lo)}if(typeof arguments[0]=="number"){var u=arguments[0];return this.selfMultiply(u,0)}}else if(arguments.length===2){var p,x,M=arguments[0],D=arguments[1],Z=null,Q=null,rt=null,dt=null;Z=(rt=c.SPLIT*this._hi)-this._hi,dt=c.SPLIT*M,Z=rt-Z,p=this._hi-Z,Q=dt-M;var gt=(rt=this._hi*M)+(dt=Z*(Q=dt-Q)-rt+Z*(x=M-Q)+p*Q+p*x+(this._hi*D+this._lo*M)),Tt=dt+(Z=rt-gt);return this._hi=gt,this._lo=Tt,this}}},{key:"selfSqr",value:function(){return this.selfMultiply(this)}},{key:"floor",value:function(){if(this.isNaN())return c.NaN;var o=Math.floor(this._hi),u=0;return o===this._hi&&(u=Math.floor(this._lo)),new c(o,u)}},{key:"negate",value:function(){return this.isNaN()?this:new c(-this._hi,-this._lo)}},{key:"clone",value:function(){try{return null}catch(o){if(o instanceof CloneNotSupportedException)return null;throw o}}},{key:"multiply",value:function(){if(arguments[0]instanceof c){var o=arguments[0];return o.isNaN()?c.createNaN():c.copy(this).selfMultiply(o)}if(typeof arguments[0]=="number"){var u=arguments[0];return J.isNaN(u)?c.createNaN():c.copy(this).selfMultiply(u,0)}}},{key:"isNaN",value:function(){return J.isNaN(this._hi)}},{key:"intValue",value:function(){return Math.trunc(this._hi)}},{key:"toString",value:function(){var o=c.magnitude(this._hi);return o>=-3&&o<=20?this.toStandardNotation():this.toSciNotation()}},{key:"toStandardNotation",value:function(){var o=this.getSpecialNumberString();if(o!==null)return o;var u=new Array(1).fill(null),p=this.extractSignificantDigits(!0,u),x=u[0]+1,M=p;if(p.charAt(0)===".")M="0"+p;else if(x<0)M="0."+c.stringOfChar("0",-x)+p;else if(p.indexOf(".")===-1){var D=x-p.length;M=p+c.stringOfChar("0",D)+".0"}return this.isNegative()?"-"+M:M}},{key:"reciprocal",value:function(){var o,u,p,x,M=null,D=null,Z=null,Q=null;o=(p=1/this._hi)-(M=(Z=c.SPLIT*p)-(M=Z-p)),D=(Q=c.SPLIT*this._hi)-this._hi;var rt=p+(Z=(1-(x=p*this._hi)-(Q=M*(D=Q-D)-x+M*(u=this._hi-D)+o*D+o*u)-p*this._lo)/this._hi);return new c(rt,p-rt+Z)}},{key:"toSciNotation",value:function(){if(this.isZero())return c.SCI_NOT_ZERO;var o=this.getSpecialNumberString();if(o!==null)return o;var u=new Array(1).fill(null),p=this.extractSignificantDigits(!1,u),x=c.SCI_NOT_EXPONENT_CHAR+u[0];if(p.charAt(0)==="0")throw new IllegalStateException("Found leading zero: "+p);var M="";p.length>1&&(M=p.substring(1));var D=p.charAt(0)+"."+M;return this.isNegative()?"-"+D+x:D+x}},{key:"abs",value:function(){return this.isNaN()?c.NaN:this.isNegative()?this.negate():new c(this)}},{key:"isPositive",value:function(){return this._hi>0||this._hi===0&&this._lo>0}},{key:"lt",value:function(o){return this._hi<o._hi||this._hi===o._hi&&this._lo<o._lo}},{key:"add",value:function(){if(arguments[0]instanceof c){var o=arguments[0];return c.copy(this).selfAdd(o)}if(typeof arguments[0]=="number"){var u=arguments[0];return c.copy(this).selfAdd(u)}}},{key:"init",value:function(){if(arguments.length===1){if(typeof arguments[0]=="number"){var o=arguments[0];this._hi=o,this._lo=0}else if(arguments[0]instanceof c){var u=arguments[0];this._hi=u._hi,this._lo=u._lo}}else if(arguments.length===2){var p=arguments[0],x=arguments[1];this._hi=p,this._lo=x}}},{key:"gt",value:function(o){return this._hi>o._hi||this._hi===o._hi&&this._lo>o._lo}},{key:"isNegative",value:function(){return this._hi<0||this._hi===0&&this._lo<0}},{key:"trunc",value:function(){return this.isNaN()?c.NaN:this.isPositive()?this.floor():this.ceil()}},{key:"signum",value:function(){return this._hi>0?1:this._hi<0?-1:this._lo>0?1:this._lo<0?-1:0}},{key:"interfaces_",get:function(){return[O,U,I]}}],[{key:"constructor_",value:function(){if(this._hi=0,this._lo=0,arguments.length===0)this.init(0);else if(arguments.length===1){if(typeof arguments[0]=="number"){var o=arguments[0];this.init(o)}else if(arguments[0]instanceof c){var u=arguments[0];this.init(u)}else if(typeof arguments[0]=="string"){var p=arguments[0];c.constructor_.call(this,c.parse(p))}}else if(arguments.length===2){var x=arguments[0],M=arguments[1];this.init(x,M)}}},{key:"determinant",value:function(){if(typeof arguments[3]=="number"&&typeof arguments[2]=="number"&&typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var o=arguments[0],u=arguments[1],p=arguments[2],x=arguments[3];return c.determinant(c.valueOf(o),c.valueOf(u),c.valueOf(p),c.valueOf(x))}if(arguments[3]instanceof c&&arguments[2]instanceof c&&arguments[0]instanceof c&&arguments[1]instanceof c){var M=arguments[1],D=arguments[2],Z=arguments[3];return arguments[0].multiply(Z).selfSubtract(M.multiply(D))}}},{key:"sqr",value:function(o){return c.valueOf(o).selfMultiply(o)}},{key:"valueOf",value:function(){if(typeof arguments[0]=="string"){var o=arguments[0];return c.parse(o)}if(typeof arguments[0]=="number")return new c(arguments[0])}},{key:"sqrt",value:function(o){return c.valueOf(o).sqrt()}},{key:"parse",value:function(o){for(var u=0,p=o.length;ue.isWhitespace(o.charAt(u));)u++;var x=!1;if(u<p){var M=o.charAt(u);M!=="-"&&M!=="+"||(u++,M==="-"&&(x=!0))}for(var D=new c,Z=0,Q=0,rt=0,dt=!1;!(u>=p);){var gt=o.charAt(u);if(u++,ue.isDigit(gt)){var Tt=gt-"0";D.selfMultiply(c.TEN),D.selfAdd(Tt),Z++}else{if(gt!=="."){if(gt==="e"||gt==="E"){var Ot=o.substring(u);try{rt=Bt.parseInt(Ot)}catch(Ee){throw Ee instanceof NumberFormatException?new NumberFormatException("Invalid exponent "+Ot+" in string "+o):Ee}break}throw new NumberFormatException("Unexpected character '"+gt+"' at position "+u+" in string "+o)}Q=Z,dt=!0}}var zt=D;dt||(Q=Z);var qt=Z-Q-rt;if(qt===0)zt=D;else if(qt>0){var ne=c.TEN.pow(qt);zt=D.divide(ne)}else if(qt<0){var jt=c.TEN.pow(-qt);zt=D.multiply(jt)}return x?zt.negate():zt}},{key:"createNaN",value:function(){return new c(J.NaN,J.NaN)}},{key:"copy",value:function(o){return new c(o)}},{key:"magnitude",value:function(o){var u=Math.abs(o),p=Math.log(u)/Math.log(10),x=Math.trunc(Math.floor(p));return 10*Math.pow(10,x)<=u&&(x+=1),x}},{key:"stringOfChar",value:function(o,u){for(var p=new Ct,x=0;x<u;x++)p.append(o);return p.toString()}}])}();Pt.PI=new Pt(3.141592653589793,12246467991473532e-32),Pt.TWO_PI=new Pt(6.283185307179586,24492935982947064e-32),Pt.PI_2=new Pt(1.5707963267948966,6123233995736766e-32),Pt.E=new Pt(2.718281828459045,14456468917292502e-32),Pt.NaN=new Pt(J.NaN,J.NaN),Pt.EPS=123259516440783e-46,Pt.SPLIT=134217729,Pt.MAX_PRINT_DIGITS=32,Pt.TEN=Pt.valueOf(10),Pt.ONE=Pt.valueOf(1),Pt.SCI_NOT_EXPONENT_CHAR="E",Pt.SCI_NOT_ZERO="0.0E0";var be=function(){function c(){n(this,c)}return l(c,null,[{key:"orientationIndex",value:function(o,u,p){var x=c.orientationIndexFilter(o,u,p);if(x<=1)return x;var M=Pt.valueOf(u.x).selfAdd(-o.x),D=Pt.valueOf(u.y).selfAdd(-o.y),Z=Pt.valueOf(p.x).selfAdd(-u.x),Q=Pt.valueOf(p.y).selfAdd(-u.y);return M.selfMultiply(Q).selfSubtract(D.selfMultiply(Z)).signum()}},{key:"signOfDet2x2",value:function(){if(arguments[3]instanceof Pt&&arguments[2]instanceof Pt&&arguments[0]instanceof Pt&&arguments[1]instanceof Pt){var o=arguments[1],u=arguments[2],p=arguments[3];return arguments[0].multiply(p).selfSubtract(o.multiply(u)).signum()}if(typeof arguments[3]=="number"&&typeof arguments[2]=="number"&&typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var x=arguments[0],M=arguments[1],D=arguments[2],Z=arguments[3],Q=Pt.valueOf(x),rt=Pt.valueOf(M),dt=Pt.valueOf(D),gt=Pt.valueOf(Z);return Q.multiply(gt).selfSubtract(rt.multiply(dt)).signum()}}},{key:"intersection",value:function(o,u,p,x){var M=new Pt(o.y).selfSubtract(u.y),D=new Pt(u.x).selfSubtract(o.x),Z=new Pt(o.x).selfMultiply(u.y).selfSubtract(new Pt(u.x).selfMultiply(o.y)),Q=new Pt(p.y).selfSubtract(x.y),rt=new Pt(x.x).selfSubtract(p.x),dt=new Pt(p.x).selfMultiply(x.y).selfSubtract(new Pt(x.x).selfMultiply(p.y)),gt=D.multiply(dt).selfSubtract(rt.multiply(Z)),Tt=Q.multiply(Z).selfSubtract(M.multiply(dt)),Ot=M.multiply(rt).selfSubtract(Q.multiply(D)),zt=gt.selfDivide(Ot).doubleValue(),qt=Tt.selfDivide(Ot).doubleValue();return J.isNaN(zt)||J.isInfinite(zt)||J.isNaN(qt)||J.isInfinite(qt)?null:new at(zt,qt)}},{key:"orientationIndexFilter",value:function(o,u,p){var x=null,M=(o.x-p.x)*(u.y-p.y),D=(o.y-p.y)*(u.x-p.x),Z=M-D;if(M>0){if(D<=0)return c.signum(Z);x=M+D}else{if(!(M<0)||D>=0)return c.signum(Z);x=-M-D}var Q=c.DP_SAFE_EPSILON*x;return Z>=Q||-Z>=Q?c.signum(Z):2}},{key:"signum",value:function(o){return o>0?1:o<0?-1:0}}])}();be.DP_SAFE_EPSILON=1e-15;var Xt=function(){return l(function c(){n(this,c)},[{key:"getM",value:function(c){if(this.hasM()){var o=this.getDimension()-this.getMeasures();return this.getOrdinate(c,o)}return J.NaN}},{key:"setOrdinate",value:function(c,o,u){}},{key:"getZ",value:function(c){return this.hasZ()?this.getOrdinate(c,2):J.NaN}},{key:"size",value:function(){}},{key:"getOrdinate",value:function(c,o){}},{key:"getCoordinate",value:function(){}},{key:"getCoordinateCopy",value:function(c){}},{key:"createCoordinate",value:function(){}},{key:"getDimension",value:function(){}},{key:"hasM",value:function(){return this.getMeasures()>0}},{key:"getX",value:function(c){}},{key:"hasZ",value:function(){return this.getDimension()-this.getMeasures()>2}},{key:"getMeasures",value:function(){return 0}},{key:"expandEnvelope",value:function(c){}},{key:"copy",value:function(){}},{key:"getY",value:function(c){}},{key:"toCoordinateArray",value:function(){}},{key:"interfaces_",get:function(){return[I]}}])}();Xt.X=0,Xt.Y=1,Xt.Z=2,Xt.M=3;var Ut=function(){function c(){n(this,c)}return l(c,null,[{key:"index",value:function(o,u,p){return be.orientationIndex(o,u,p)}},{key:"isCCW",value:function(){if(arguments[0]instanceof Array){var o=arguments[0],u=o.length-1;if(u<3)throw new P("Ring has fewer than 4 points, so orientation cannot be determined");for(var p=o[0],x=0,M=1;M<=u;M++){var D=o[M];D.y>p.y&&(p=D,x=M)}var Z=x;do(Z-=1)<0&&(Z=u);while(o[Z].equals2D(p)&&Z!==x);var Q=x;do Q=(Q+1)%u;while(o[Q].equals2D(p)&&Q!==x);var rt=o[Z],dt=o[Q];if(rt.equals2D(p)||dt.equals2D(p)||rt.equals2D(dt))return!1;var gt=c.index(rt,p,dt);return gt===0?rt.x>dt.x:gt>0}if(St(arguments[0],Xt)){var Tt=arguments[0],Ot=Tt.size()-1;if(Ot<3)throw new P("Ring has fewer than 4 points, so orientation cannot be determined");for(var zt=Tt.getCoordinate(0),qt=0,ne=1;ne<=Ot;ne++){var jt=Tt.getCoordinate(ne);jt.y>zt.y&&(zt=jt,qt=ne)}var Ee=null,Pe=qt;do(Pe-=1)<0&&(Pe=Ot),Ee=Tt.getCoordinate(Pe);while(Ee.equals2D(zt)&&Pe!==qt);var Ze=null,Sr=qt;do Sr=(Sr+1)%Ot,Ze=Tt.getCoordinate(Sr);while(Ze.equals2D(zt)&&Sr!==qt);if(Ee.equals2D(zt)||Ze.equals2D(zt)||Ee.equals2D(Ze))return!1;var ko=c.index(Ee,zt,Ze);return ko===0?Ee.x>Ze.x:ko>0}}}])}();Ut.CLOCKWISE=-1,Ut.RIGHT=Ut.CLOCKWISE,Ut.COUNTERCLOCKWISE=1,Ut.LEFT=Ut.COUNTERCLOCKWISE,Ut.COLLINEAR=0,Ut.STRAIGHT=Ut.COLLINEAR;var tn=function(){return l(function c(){n(this,c),c.constructor_.apply(this,arguments)},[{key:"getCoordinate",value:function(){return this._minCoord}},{key:"getRightmostSide",value:function(c,o){var u=this.getRightmostSideOfSegment(c,o);return u<0&&(u=this.getRightmostSideOfSegment(c,o-1)),u<0&&(this._minCoord=null,this.checkForRightmostCoordinate(c)),u}},{key:"findRightmostEdgeAtVertex",value:function(){var c=this._minDe.getEdge().getCoordinates();lt.isTrue(this._minIndex>0&&this._minIndex<c.length,"rightmost point expected to be interior vertex of edge");var o=c[this._minIndex-1],u=c[this._minIndex+1],p=Ut.index(this._minCoord,u,o),x=!1;(o.y<this._minCoord.y&&u.y<this._minCoord.y&&p===Ut.COUNTERCLOCKWISE||o.y>this._minCoord.y&&u.y>this._minCoord.y&&p===Ut.CLOCKWISE)&&(x=!0),x&&(this._minIndex=this._minIndex-1)}},{key:"getRightmostSideOfSegment",value:function(c,o){var u=c.getEdge().getCoordinates();if(o<0||o+1>=u.length||u[o].y===u[o+1].y)return-1;var p=st.LEFT;return u[o].y<u[o+1].y&&(p=st.RIGHT),p}},{key:"getEdge",value:function(){return this._orientedDe}},{key:"checkForRightmostCoordinate",value:function(c){for(var o=c.getEdge().getCoordinates(),u=0;u<o.length-1;u++)(this._minCoord===null||o[u].x>this._minCoord.x)&&(this._minDe=c,this._minIndex=u,this._minCoord=o[u])}},{key:"findRightmostEdgeAtNode",value:function(){var c=this._minDe.getNode().getEdges();this._minDe=c.getRightmostEdge(),this._minDe.isForward()||(this._minDe=this._minDe.getSym(),this._minIndex=this._minDe.getEdge().getCoordinates().length-1)}},{key:"findEdge",value:function(c){for(var o=c.iterator();o.hasNext();){var u=o.next();u.isForward()&&this.checkForRightmostCoordinate(u)}lt.isTrue(this._minIndex!==0||this._minCoord.equals(this._minDe.getCoordinate()),"inconsistency in rightmost processing"),this._minIndex===0?this.findRightmostEdgeAtNode():this.findRightmostEdgeAtVertex(),this._orientedDe=this._minDe,this.getRightmostSide(this._minDe,this._minIndex)===st.LEFT&&(this._orientedDe=this._minDe.getSym())}}],[{key:"constructor_",value:function(){this._minIndex=-1,this._minCoord=null,this._minDe=null,this._orientedDe=null}}])}(),le=function(c){function o(u,p){var x;return n(this,o),(x=i(this,o,[p?u+" [ "+p+" ]":u])).pt=p?new at(p):void 0,x.name=Object.keys({TopologyException:o})[0],x}return m(o,c),l(o,[{key:"getCoordinate",value:function(){return this.pt}}])}(et),en=function(){return l(function c(){n(this,c),this.array=[]},[{key:"addLast",value:function(c){this.array.push(c)}},{key:"removeFirst",value:function(){return this.array.shift()}},{key:"isEmpty",value:function(){return this.array.length===0}}])}(),Ft=function(c){function o(u){var p;return n(this,o),(p=i(this,o)).array=[],u instanceof wt&&p.addAll(u),p}return m(o,c),l(o,[{key:"interfaces_",get:function(){return[yt,wt]}},{key:"ensureCapacity",value:function(){}},{key:"add",value:function(u){return arguments.length===1?this.array.push(u):this.array.splice(arguments[0],0,arguments[1]),!0}},{key:"clear",value:function(){this.array=[]}},{key:"addAll",value:function(u){var p,x=f(u);try{for(x.s();!(p=x.n()).done;){var M=p.value;this.array.push(M)}}catch(D){x.e(D)}finally{x.f()}}},{key:"set",value:function(u,p){var x=this.array[u];return this.array[u]=p,x}},{key:"iterator",value:function(){return new nn(this)}},{key:"get",value:function(u){if(u<0||u>=this.size())throw new Lt;return this.array[u]}},{key:"isEmpty",value:function(){return this.array.length===0}},{key:"sort",value:function(u){u?this.array.sort(function(p,x){return u.compare(p,x)}):this.array.sort()}},{key:"size",value:function(){return this.array.length}},{key:"toArray",value:function(){return this.array.slice()}},{key:"remove",value:function(u){for(var p=0,x=this.array.length;p<x;p++)if(this.array[p]===u)return!!this.array.splice(p,1);return!1}},{key:Symbol.iterator,value:function(){return this.array.values()}}])}(yt),nn=function(){return l(function c(o){n(this,c),this.arrayList=o,this.position=0},[{key:"next",value:function(){if(this.position===this.arrayList.size())throw new G;return this.arrayList.get(this.position++)}},{key:"hasNext",value:function(){return this.position<this.arrayList.size()}},{key:"set",value:function(c){return this.arrayList.set(this.position-1,c)}},{key:"remove",value:function(){this.arrayList.remove(this.arrayList.get(this.position))}}])}(),Dn=function(){return l(function c(){n(this,c),c.constructor_.apply(this,arguments)},[{key:"clearVisitedEdges",value:function(){for(var c=this._dirEdgeList.iterator();c.hasNext();)c.next().setVisited(!1)}},{key:"getRightmostCoordinate",value:function(){return this._rightMostCoord}},{key:"computeNodeDepth",value:function(c){for(var o=null,u=c.getEdges().iterator();u.hasNext();){var p=u.next();if(p.isVisited()||p.getSym().isVisited()){o=p;break}}if(o===null)throw new le("unable to find edge to compute depths at "+c.getCoordinate());c.getEdges().computeDepths(o);for(var x=c.getEdges().iterator();x.hasNext();){var M=x.next();M.setVisited(!0),this.copySymDepths(M)}}},{key:"computeDepth",value:function(c){this.clearVisitedEdges();var o=this._finder.getEdge();o.getNode(),o.getLabel(),o.setEdgeDepths(st.RIGHT,c),this.copySymDepths(o),this.computeDepths(o)}},{key:"create",value:function(c){this.addReachable(c),this._finder.findEdge(this._dirEdgeList),this._rightMostCoord=this._finder.getCoordinate()}},{key:"findResultEdges",value:function(){for(var c=this._dirEdgeList.iterator();c.hasNext();){var o=c.next();o.getDepth(st.RIGHT)>=1&&o.getDepth(st.LEFT)<=0&&!o.isInteriorAreaEdge()&&o.setInResult(!0)}}},{key:"computeDepths",value:function(c){var o=new ot,u=new en,p=c.getNode();for(u.addLast(p),o.add(p),c.setVisited(!0);!u.isEmpty();){var x=u.removeFirst();o.add(x),this.computeNodeDepth(x);for(var M=x.getEdges().iterator();M.hasNext();){var D=M.next().getSym();if(!D.isVisited()){var Z=D.getNode();o.contains(Z)||(u.addLast(Z),o.add(Z))}}}}},{key:"compareTo",value:function(c){var o=c;return this._rightMostCoord.x<o._rightMostCoord.x?-1:this._rightMostCoord.x>o._rightMostCoord.x?1:0}},{key:"getEnvelope",value:function(){if(this._env===null){for(var c=new xt,o=this._dirEdgeList.iterator();o.hasNext();)for(var u=o.next().getEdge().getCoordinates(),p=0;p<u.length-1;p++)c.expandToInclude(u[p]);this._env=c}return this._env}},{key:"addReachable",value:function(c){var o=new At;for(o.add(c);!o.empty();){var u=o.pop();this.add(u,o)}}},{key:"copySymDepths",value:function(c){var o=c.getSym();o.setDepth(st.LEFT,c.getDepth(st.RIGHT)),o.setDepth(st.RIGHT,c.getDepth(st.LEFT))}},{key:"add",value:function(c,o){c.setVisited(!0),this._nodes.add(c);for(var u=c.getEdges().iterator();u.hasNext();){var p=u.next();this._dirEdgeList.add(p);var x=p.getSym().getNode();x.isVisited()||o.push(x)}}},{key:"getNodes",value:function(){return this._nodes}},{key:"getDirectedEdges",value:function(){return this._dirEdgeList}},{key:"interfaces_",get:function(){return[U]}}],[{key:"constructor_",value:function(){this._finder=null,this._dirEdgeList=new Ft,this._nodes=new Ft,this._rightMostCoord=null,this._env=null,this._finder=new tn}}])}(),zn=function(){return l(function c(){n(this,c)},null,[{key:"intersection",value:function(c,o,u,p){var x=c.x<o.x?c.x:o.x,M=c.y<o.y?c.y:o.y,D=c.x>o.x?c.x:o.x,Z=c.y>o.y?c.y:o.y,Q=u.x<p.x?u.x:p.x,rt=u.y<p.y?u.y:p.y,dt=u.x>p.x?u.x:p.x,gt=u.y>p.y?u.y:p.y,Tt=((x>Q?x:Q)+(D<dt?D:dt))/2,Ot=((M>rt?M:rt)+(Z<gt?Z:gt))/2,zt=c.x-Tt,qt=c.y-Ot,ne=o.x-Tt,jt=o.y-Ot,Ee=u.x-Tt,Pe=u.y-Ot,Ze=p.x-Tt,Sr=p.y-Ot,ko=qt-jt,Fi=ne-zt,uu=zt*jt-ne*qt,lu=Pe-Sr,zs=Ze-Ee,vl=Ee*Sr-Ze*Pe,Mo=ko*zs-lu*Fi,Jr=(Fi*vl-zs*uu)/Mo,sa=(lu*uu-ko*vl)/Mo;return J.isNaN(Jr)||J.isInfinite(Jr)||J.isNaN(sa)||J.isInfinite(sa)?null:new at(Jr+Tt,sa+Ot)}}])}(),ze=function(){return l(function c(){n(this,c)},null,[{key:"arraycopy",value:function(c,o,u,p,x){for(var M=0,D=o;D<o+x;D++)u[p+M]=c[D],M++}},{key:"getProperty",value:function(c){return{"line.separator":`
`}[c]}}])}(),In=function(){function c(){n(this,c)}return l(c,null,[{key:"log10",value:function(o){var u=Math.log(o);return J.isInfinite(u)||J.isNaN(u)?u:u/c.LOG_10}},{key:"min",value:function(o,u,p,x){var M=o;return u<M&&(M=u),p<M&&(M=p),x<M&&(M=x),M}},{key:"clamp",value:function(){if(typeof arguments[2]=="number"&&typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var o=arguments[0],u=arguments[1],p=arguments[2];return o<u?u:o>p?p:o}if(Number.isInteger(arguments[2])&&Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){var x=arguments[0],M=arguments[1],D=arguments[2];return x<M?M:x>D?D:x}}},{key:"wrap",value:function(o,u){return o<0?u- -o%u:o%u}},{key:"max",value:function(){if(arguments.length===3){var o=arguments[1],u=arguments[2],p=arguments[0];return o>p&&(p=o),u>p&&(p=u),p}if(arguments.length===4){var x=arguments[1],M=arguments[2],D=arguments[3],Z=arguments[0];return x>Z&&(Z=x),M>Z&&(Z=M),D>Z&&(Z=D),Z}}},{key:"average",value:function(o,u){return(o+u)/2}}])}();In.LOG_10=Math.log(10);var Ue=function(){function c(){n(this,c)}return l(c,null,[{key:"segmentToSegment",value:function(o,u,p,x){if(o.equals(u))return c.pointToSegment(o,p,x);if(p.equals(x))return c.pointToSegment(x,o,u);var M=!1;if(xt.intersects(o,u,p,x)){var D=(u.x-o.x)*(x.y-p.y)-(u.y-o.y)*(x.x-p.x);if(D===0)M=!0;else{var Z=(o.y-p.y)*(x.x-p.x)-(o.x-p.x)*(x.y-p.y),Q=((o.y-p.y)*(u.x-o.x)-(o.x-p.x)*(u.y-o.y))/D,rt=Z/D;(rt<0||rt>1||Q<0||Q>1)&&(M=!0)}}else M=!0;return M?In.min(c.pointToSegment(o,p,x),c.pointToSegment(u,p,x),c.pointToSegment(p,o,u),c.pointToSegment(x,o,u)):0}},{key:"pointToSegment",value:function(o,u,p){if(u.x===p.x&&u.y===p.y)return o.distance(u);var x=(p.x-u.x)*(p.x-u.x)+(p.y-u.y)*(p.y-u.y),M=((o.x-u.x)*(p.x-u.x)+(o.y-u.y)*(p.y-u.y))/x;if(M<=0)return o.distance(u);if(M>=1)return o.distance(p);var D=((u.y-o.y)*(p.x-u.x)-(u.x-o.x)*(p.y-u.y))/x;return Math.abs(D)*Math.sqrt(x)}},{key:"pointToLinePerpendicular",value:function(o,u,p){var x=(p.x-u.x)*(p.x-u.x)+(p.y-u.y)*(p.y-u.y),M=((u.y-o.y)*(p.x-u.x)-(u.x-o.x)*(p.y-u.y))/x;return Math.abs(M)*Math.sqrt(x)}},{key:"pointToSegmentString",value:function(o,u){if(u.length===0)throw new P("Line array must contain at least one vertex");for(var p=o.distance(u[0]),x=0;x<u.length-1;x++){var M=c.pointToSegment(o,u[x],u[x+1]);M<p&&(p=M)}return p}}])}(),Se=function(){return l(function c(){n(this,c)},[{key:"create",value:function(){if(arguments.length===1)arguments[0]instanceof Array||St(arguments[0],Xt);else if(arguments.length!==2){if(arguments.length===3){var c=arguments[0],o=arguments[1];return this.create(c,o)}}}}])}(),$n=function(){return l(function c(){n(this,c)},[{key:"filter",value:function(c){}}])}(),ei=function(){return l(function c(){n(this,c)},null,[{key:"ofLine",value:function(c){var o=c.size();if(o<=1)return 0;var u=0,p=new at;c.getCoordinate(0,p);for(var x=p.x,M=p.y,D=1;D<o;D++){c.getCoordinate(D,p);var Z=p.x,Q=p.y,rt=Z-x,dt=Q-M;u+=Math.sqrt(rt*rt+dt*dt),x=Z,M=Q}return u}}])}(),ms=l(function c(){n(this,c)}),Ii=function(){function c(){n(this,c)}return l(c,null,[{key:"copyCoord",value:function(o,u,p,x){for(var M=Math.min(o.getDimension(),p.getDimension()),D=0;D<M;D++)p.setOrdinate(x,D,o.getOrdinate(u,D))}},{key:"isRing",value:function(o){var u=o.size();return u===0||!(u<=3)&&o.getOrdinate(0,Xt.X)===o.getOrdinate(u-1,Xt.X)&&o.getOrdinate(0,Xt.Y)===o.getOrdinate(u-1,Xt.Y)}},{key:"scroll",value:function(){if(arguments.length===2){if(St(arguments[0],Xt)&&Number.isInteger(arguments[1])){var o=arguments[0],u=arguments[1];c.scroll(o,u,c.isRing(o))}else if(St(arguments[0],Xt)&&arguments[1]instanceof at){var p=arguments[0],x=arguments[1],M=c.indexOf(x,p);if(M<=0)return null;c.scroll(p,M)}}else if(arguments.length===3){var D=arguments[0],Z=arguments[1],Q=arguments[2];if(Z<=0)return null;for(var rt=D.copy(),dt=Q?D.size()-1:D.size(),gt=0;gt<dt;gt++)for(var Tt=0;Tt<D.getDimension();Tt++)D.setOrdinate(gt,Tt,rt.getOrdinate((Z+gt)%dt,Tt));if(Q)for(var Ot=0;Ot<D.getDimension();Ot++)D.setOrdinate(dt,Ot,D.getOrdinate(0,Ot))}}},{key:"isEqual",value:function(o,u){var p=o.size();if(p!==u.size())return!1;for(var x=Math.min(o.getDimension(),u.getDimension()),M=0;M<p;M++)for(var D=0;D<x;D++){var Z=o.getOrdinate(M,D),Q=u.getOrdinate(M,D);if(o.getOrdinate(M,D)!==u.getOrdinate(M,D)&&(!J.isNaN(Z)||!J.isNaN(Q)))return!1}return!0}},{key:"minCoordinateIndex",value:function(){if(arguments.length===1){var o=arguments[0];return c.minCoordinateIndex(o,0,o.size()-1)}if(arguments.length===3){for(var u=arguments[0],p=arguments[2],x=-1,M=null,D=arguments[1];D<=p;D++){var Z=u.getCoordinate(D);(M===null||M.compareTo(Z)>0)&&(M=Z,x=D)}return x}}},{key:"extend",value:function(o,u,p){var x=o.create(p,u.getDimension()),M=u.size();if(c.copy(u,0,x,0,M),M>0)for(var D=M;D<p;D++)c.copy(u,M-1,x,D,1);return x}},{key:"reverse",value:function(o){for(var u=o.size()-1,p=Math.trunc(u/2),x=0;x<=p;x++)c.swap(o,x,u-x)}},{key:"swap",value:function(o,u,p){if(u===p)return null;for(var x=0;x<o.getDimension();x++){var M=o.getOrdinate(u,x);o.setOrdinate(u,x,o.getOrdinate(p,x)),o.setOrdinate(p,x,M)}}},{key:"copy",value:function(o,u,p,x,M){for(var D=0;D<M;D++)c.copyCoord(o,u+D,p,x+D)}},{key:"ensureValidRing",value:function(o,u){var p=u.size();return p===0?u:p<=3?c.createClosedRing(o,u,4):u.getOrdinate(0,Xt.X)===u.getOrdinate(p-1,Xt.X)&&u.getOrdinate(0,Xt.Y)===u.getOrdinate(p-1,Xt.Y)?u:c.createClosedRing(o,u,p+1)}},{key:"indexOf",value:function(o,u){for(var p=0;p<u.size();p++)if(o.x===u.getOrdinate(p,Xt.X)&&o.y===u.getOrdinate(p,Xt.Y))return p;return-1}},{key:"createClosedRing",value:function(o,u,p){var x=o.create(p,u.getDimension()),M=u.size();c.copy(u,0,x,0,M);for(var D=M;D<p;D++)c.copy(u,0,x,D,1);return x}},{key:"minCoordinate",value:function(o){for(var u=null,p=0;p<o.size();p++){var x=o.getCoordinate(p);(u===null||u.compareTo(x)>0)&&(u=x)}return u}}])}(),Dt=function(){function c(){n(this,c)}return l(c,null,[{key:"toDimensionSymbol",value:function(o){switch(o){case c.FALSE:return c.SYM_FALSE;case c.TRUE:return c.SYM_TRUE;case c.DONTCARE:return c.SYM_DONTCARE;case c.P:return c.SYM_P;case c.L:return c.SYM_L;case c.A:return c.SYM_A}throw new P("Unknown dimension value: "+o)}},{key:"toDimensionValue",value:function(o){switch(ue.toUpperCase(o)){case c.SYM_FALSE:return c.FALSE;case c.SYM_TRUE:return c.TRUE;case c.SYM_DONTCARE:return c.DONTCARE;case c.SYM_P:return c.P;case c.SYM_L:return c.L;case c.SYM_A:return c.A}throw new P("Unknown dimension symbol: "+o)}}])}();Dt.P=0,Dt.L=1,Dt.A=2,Dt.FALSE=-1,Dt.TRUE=-2,Dt.DONTCARE=-3,Dt.SYM_FALSE="F",Dt.SYM_TRUE="T",Dt.SYM_DONTCARE="*",Dt.SYM_P="0",Dt.SYM_L="1",Dt.SYM_A="2";var $i=function(){return l(function c(){n(this,c)},[{key:"filter",value:function(c){}}])}(),Ji=function(){return l(function c(){n(this,c)},[{key:"filter",value:function(c,o){}},{key:"isDone",value:function(){}},{key:"isGeometryChanged",value:function(){}}])}(),Fr=function(c){function o(){var u;return n(this,o),u=i(this,o),o.constructor_.apply(u,arguments),u}return m(o,c),l(o,[{key:"computeEnvelopeInternal",value:function(){return this.isEmpty()?new xt:this._points.expandEnvelope(new xt)}},{key:"isRing",value:function(){return this.isClosed()&&this.isSimple()}},{key:"getCoordinates",value:function(){return this._points.toCoordinateArray()}},{key:"copyInternal",value:function(){return new o(this._points.copy(),this._factory)}},{key:"equalsExact",value:function(){if(arguments.length===2&&typeof arguments[1]=="number"&&arguments[0]instanceof _t){var u=arguments[0],p=arguments[1];if(!this.isEquivalentClass(u))return!1;var x=u;if(this._points.size()!==x._points.size())return!1;for(var M=0;M<this._points.size();M++)if(!this.equal(this._points.getCoordinate(M),x._points.getCoordinate(M),p))return!1;return!0}return w(o,"equalsExact",this,1).apply(this,arguments)}},{key:"normalize",value:function(){for(var u=0;u<Math.trunc(this._points.size()/2);u++){var p=this._points.size()-1-u;if(!this._points.getCoordinate(u).equals(this._points.getCoordinate(p))){if(this._points.getCoordinate(u).compareTo(this._points.getCoordinate(p))>0){var x=this._points.copy();Ii.reverse(x),this._points=x}return null}}}},{key:"getCoordinate",value:function(){return this.isEmpty()?null:this._points.getCoordinate(0)}},{key:"getBoundaryDimension",value:function(){return this.isClosed()?Dt.FALSE:0}},{key:"isClosed",value:function(){return!this.isEmpty()&&this.getCoordinateN(0).equals2D(this.getCoordinateN(this.getNumPoints()-1))}},{key:"reverseInternal",value:function(){var u=this._points.copy();return Ii.reverse(u),this.getFactory().createLineString(u)}},{key:"getEndPoint",value:function(){return this.isEmpty()?null:this.getPointN(this.getNumPoints()-1)}},{key:"getTypeCode",value:function(){return _t.TYPECODE_LINESTRING}},{key:"getDimension",value:function(){return 1}},{key:"getLength",value:function(){return ei.ofLine(this._points)}},{key:"getNumPoints",value:function(){return this._points.size()}},{key:"compareToSameClass",value:function(){if(arguments.length===1){for(var u=arguments[0],p=0,x=0;p<this._points.size()&&x<u._points.size();){var M=this._points.getCoordinate(p).compareTo(u._points.getCoordinate(x));if(M!==0)return M;p++,x++}return p<this._points.size()?1:x<u._points.size()?-1:0}if(arguments.length===2){var D=arguments[0];return arguments[1].compare(this._points,D._points)}}},{key:"apply",value:function(){if(St(arguments[0],$n))for(var u=arguments[0],p=0;p<this._points.size();p++)u.filter(this._points.getCoordinate(p));else if(St(arguments[0],Ji)){var x=arguments[0];if(this._points.size()===0)return null;for(var M=0;M<this._points.size()&&(x.filter(this._points,M),!x.isDone());M++);x.isGeometryChanged()&&this.geometryChanged()}else St(arguments[0],$i)?arguments[0].filter(this):St(arguments[0],q)&&arguments[0].filter(this)}},{key:"getBoundary",value:function(){throw new ct}},{key:"isEquivalentClass",value:function(u){return u instanceof o}},{key:"getCoordinateN",value:function(u){return this._points.getCoordinate(u)}},{key:"getGeometryType",value:function(){return _t.TYPENAME_LINESTRING}},{key:"getCoordinateSequence",value:function(){return this._points}},{key:"isEmpty",value:function(){return this._points.size()===0}},{key:"init",value:function(u){if(u===null&&(u=this.getFactory().getCoordinateSequenceFactory().create([])),u.size()===1)throw new P("Invalid number of points in LineString (found "+u.size()+" - must be 0 or >= 2)");this._points=u}},{key:"isCoordinate",value:function(u){for(var p=0;p<this._points.size();p++)if(this._points.getCoordinate(p).equals(u))return!0;return!1}},{key:"getStartPoint",value:function(){return this.isEmpty()?null:this.getPointN(0)}},{key:"getPointN",value:function(u){return this.getFactory().createPoint(this._points.getCoordinate(u))}},{key:"interfaces_",get:function(){return[ms]}}],[{key:"constructor_",value:function(){if(this._points=null,arguments.length!==0){if(arguments.length===2){var u=arguments[0],p=arguments[1];_t.constructor_.call(this,p),this.init(u)}}}}])}(_t),so=l(function c(){n(this,c)}),oo=function(c){function o(){var u;return n(this,o),u=i(this,o),o.constructor_.apply(u,arguments),u}return m(o,c),l(o,[{key:"computeEnvelopeInternal",value:function(){if(this.isEmpty())return new xt;var u=new xt;return u.expandToInclude(this._coordinates.getX(0),this._coordinates.getY(0)),u}},{key:"getCoordinates",value:function(){return this.isEmpty()?[]:[this.getCoordinate()]}},{key:"copyInternal",value:function(){return new o(this._coordinates.copy(),this._factory)}},{key:"equalsExact",value:function(){if(arguments.length===2&&typeof arguments[1]=="number"&&arguments[0]instanceof _t){var u=arguments[0],p=arguments[1];return!!this.isEquivalentClass(u)&&(!(!this.isEmpty()||!u.isEmpty())||this.isEmpty()===u.isEmpty()&&this.equal(u.getCoordinate(),this.getCoordinate(),p))}return w(o,"equalsExact",this,1).apply(this,arguments)}},{key:"normalize",value:function(){}},{key:"getCoordinate",value:function(){return this._coordinates.size()!==0?this._coordinates.getCoordinate(0):null}},{key:"getBoundaryDimension",value:function(){return Dt.FALSE}},{key:"reverseInternal",value:function(){return this.getFactory().createPoint(this._coordinates.copy())}},{key:"getTypeCode",value:function(){return _t.TYPECODE_POINT}},{key:"getDimension",value:function(){return 0}},{key:"getNumPoints",value:function(){return this.isEmpty()?0:1}},{key:"getX",value:function(){if(this.getCoordinate()===null)throw new IllegalStateException("getX called on empty Point");return this.getCoordinate().x}},{key:"compareToSameClass",value:function(){if(arguments.length===1){var u=arguments[0];return this.getCoordinate().compareTo(u.getCoordinate())}if(arguments.length===2){var p=arguments[0];return arguments[1].compare(this._coordinates,p._coordinates)}}},{key:"apply",value:function(){if(St(arguments[0],$n)){var u=arguments[0];if(this.isEmpty())return null;u.filter(this.getCoordinate())}else if(St(arguments[0],Ji)){var p=arguments[0];if(this.isEmpty())return null;p.filter(this._coordinates,0),p.isGeometryChanged()&&this.geometryChanged()}else St(arguments[0],$i)?arguments[0].filter(this):St(arguments[0],q)&&arguments[0].filter(this)}},{key:"getBoundary",value:function(){return this.getFactory().createGeometryCollection()}},{key:"getGeometryType",value:function(){return _t.TYPENAME_POINT}},{key:"getCoordinateSequence",value:function(){return this._coordinates}},{key:"getY",value:function(){if(this.getCoordinate()===null)throw new IllegalStateException("getY called on empty Point");return this.getCoordinate().y}},{key:"isEmpty",value:function(){return this._coordinates.size()===0}},{key:"init",value:function(u){u===null&&(u=this.getFactory().getCoordinateSequenceFactory().create([])),lt.isTrue(u.size()<=1),this._coordinates=u}},{key:"isSimple",value:function(){return!0}},{key:"interfaces_",get:function(){return[so]}}],[{key:"constructor_",value:function(){this._coordinates=null;var u=arguments[0],p=arguments[1];_t.constructor_.call(this,p),this.init(u)}}])}(_t),ao=function(){function c(){n(this,c)}return l(c,null,[{key:"ofRing",value:function(){if(arguments[0]instanceof Array){var o=arguments[0];return Math.abs(c.ofRingSigned(o))}if(St(arguments[0],Xt)){var u=arguments[0];return Math.abs(c.ofRingSigned(u))}}},{key:"ofRingSigned",value:function(){if(arguments[0]instanceof Array){var o=arguments[0];if(o.length<3)return 0;for(var u=0,p=o[0].x,x=1;x<o.length-1;x++){var M=o[x].x-p,D=o[x+1].y;u+=M*(o[x-1].y-D)}return u/2}if(St(arguments[0],Xt)){var Z=arguments[0],Q=Z.size();if(Q<3)return 0;var rt=new at,dt=new at,gt=new at;Z.getCoordinate(0,dt),Z.getCoordinate(1,gt);var Tt=dt.x;gt.x-=Tt;for(var Ot=0,zt=1;zt<Q-1;zt++)rt.y=dt.y,dt.x=gt.x,dt.y=gt.y,Z.getCoordinate(zt+1,gt),gt.x-=Tt,Ot+=dt.x*(rt.y-gt.y);return Ot/2}}}])}(),an=function(){return l(function c(){n(this,c)},null,[{key:"sort",value:function(){var c=arguments,o=arguments[0];if(arguments.length===1)o.sort(function(Tt,Ot){return Tt.compareTo(Ot)});else if(arguments.length===2)o.sort(function(Tt,Ot){return c[1].compare(Tt,Ot)});else if(arguments.length===3){var u=o.slice(arguments[1],arguments[2]);u.sort();var p=o.slice(0,arguments[1]).concat(u,o.slice(arguments[2],o.length));o.splice(0,o.length);var x,M=f(p);try{for(M.s();!(x=M.n()).done;){var D=x.value;o.push(D)}}catch(Tt){M.e(Tt)}finally{M.f()}}else if(arguments.length===4){var Z=o.slice(arguments[1],arguments[2]);Z.sort(function(Tt,Ot){return c[3].compare(Tt,Ot)});var Q=o.slice(0,arguments[1]).concat(Z,o.slice(arguments[2],o.length));o.splice(0,o.length);var rt,dt=f(Q);try{for(dt.s();!(rt=dt.n()).done;){var gt=rt.value;o.push(gt)}}catch(Tt){dt.e(Tt)}finally{dt.f()}}}},{key:"asList",value:function(c){var o,u=new Ft,p=f(c);try{for(p.s();!(o=p.n()).done;){var x=o.value;u.add(x)}}catch(M){p.e(M)}finally{p.f()}return u}},{key:"copyOf",value:function(c,o){return c.slice(0,o)}}])}(),Zt=l(function c(){n(this,c)}),_r=function(c){function o(){var u;return n(this,o),u=i(this,o),o.constructor_.apply(u,arguments),u}return m(o,c),l(o,[{key:"computeEnvelopeInternal",value:function(){return this._shell.getEnvelopeInternal()}},{key:"getCoordinates",value:function(){if(this.isEmpty())return[];for(var u=new Array(this.getNumPoints()).fill(null),p=-1,x=this._shell.getCoordinates(),M=0;M<x.length;M++)u[++p]=x[M];for(var D=0;D<this._holes.length;D++)for(var Z=this._holes[D].getCoordinates(),Q=0;Q<Z.length;Q++)u[++p]=Z[Q];return u}},{key:"getArea",value:function(){var u=0;u+=ao.ofRing(this._shell.getCoordinateSequence());for(var p=0;p<this._holes.length;p++)u-=ao.ofRing(this._holes[p].getCoordinateSequence());return u}},{key:"copyInternal",value:function(){for(var u=this._shell.copy(),p=new Array(this._holes.length).fill(null),x=0;x<this._holes.length;x++)p[x]=this._holes[x].copy();return new o(u,p,this._factory)}},{key:"isRectangle",value:function(){if(this.getNumInteriorRing()!==0||this._shell===null||this._shell.getNumPoints()!==5)return!1;for(var u=this._shell.getCoordinateSequence(),p=this.getEnvelopeInternal(),x=0;x<5;x++){var M=u.getX(x);if(M!==p.getMinX()&&M!==p.getMaxX())return!1;var D=u.getY(x);if(D!==p.getMinY()&&D!==p.getMaxY())return!1}for(var Z=u.getX(0),Q=u.getY(0),rt=1;rt<=4;rt++){var dt=u.getX(rt),gt=u.getY(rt);if(dt!==Z==(gt!==Q))return!1;Z=dt,Q=gt}return!0}},{key:"equalsExact",value:function(){if(arguments.length===2&&typeof arguments[1]=="number"&&arguments[0]instanceof _t){var u=arguments[0],p=arguments[1];if(!this.isEquivalentClass(u))return!1;var x=u,M=this._shell,D=x._shell;if(!M.equalsExact(D,p)||this._holes.length!==x._holes.length)return!1;for(var Z=0;Z<this._holes.length;Z++)if(!this._holes[Z].equalsExact(x._holes[Z],p))return!1;return!0}return w(o,"equalsExact",this,1).apply(this,arguments)}},{key:"normalize",value:function(){if(arguments.length===0){this._shell=this.normalized(this._shell,!0);for(var u=0;u<this._holes.length;u++)this._holes[u]=this.normalized(this._holes[u],!1);an.sort(this._holes)}else if(arguments.length===2){var p=arguments[0],x=arguments[1];if(p.isEmpty())return null;var M=p.getCoordinateSequence(),D=Ii.minCoordinateIndex(M,0,M.size()-2);Ii.scroll(M,D,!0),Ut.isCCW(M)===x&&Ii.reverse(M)}}},{key:"getCoordinate",value:function(){return this._shell.getCoordinate()}},{key:"getNumInteriorRing",value:function(){return this._holes.length}},{key:"getBoundaryDimension",value:function(){return 1}},{key:"reverseInternal",value:function(){for(var u=this.getExteriorRing().reverse(),p=new Array(this.getNumInteriorRing()).fill(null),x=0;x<p.length;x++)p[x]=this.getInteriorRingN(x).reverse();return this.getFactory().createPolygon(u,p)}},{key:"getTypeCode",value:function(){return _t.TYPECODE_POLYGON}},{key:"getDimension",value:function(){return 2}},{key:"getLength",value:function(){var u=0;u+=this._shell.getLength();for(var p=0;p<this._holes.length;p++)u+=this._holes[p].getLength();return u}},{key:"getNumPoints",value:function(){for(var u=this._shell.getNumPoints(),p=0;p<this._holes.length;p++)u+=this._holes[p].getNumPoints();return u}},{key:"convexHull",value:function(){return this.getExteriorRing().convexHull()}},{key:"normalized",value:function(u,p){var x=u.copy();return this.normalize(x,p),x}},{key:"compareToSameClass",value:function(){if(arguments.length===1){var u=arguments[0],p=this._shell,x=u._shell;return p.compareToSameClass(x)}if(arguments.length===2){var M=arguments[1],D=arguments[0],Z=this._shell,Q=D._shell,rt=Z.compareToSameClass(Q,M);if(rt!==0)return rt;for(var dt=this.getNumInteriorRing(),gt=D.getNumInteriorRing(),Tt=0;Tt<dt&&Tt<gt;){var Ot=this.getInteriorRingN(Tt),zt=D.getInteriorRingN(Tt),qt=Ot.compareToSameClass(zt,M);if(qt!==0)return qt;Tt++}return Tt<dt?1:Tt<gt?-1:0}}},{key:"apply",value:function(){if(St(arguments[0],$n)){var u=arguments[0];this._shell.apply(u);for(var p=0;p<this._holes.length;p++)this._holes[p].apply(u)}else if(St(arguments[0],Ji)){var x=arguments[0];if(this._shell.apply(x),!x.isDone())for(var M=0;M<this._holes.length&&(this._holes[M].apply(x),!x.isDone());M++);x.isGeometryChanged()&&this.geometryChanged()}else if(St(arguments[0],$i))arguments[0].filter(this);else if(St(arguments[0],q)){var D=arguments[0];D.filter(this),this._shell.apply(D);for(var Z=0;Z<this._holes.length;Z++)this._holes[Z].apply(D)}}},{key:"getBoundary",value:function(){if(this.isEmpty())return this.getFactory().createMultiLineString();var u=new Array(this._holes.length+1).fill(null);u[0]=this._shell;for(var p=0;p<this._holes.length;p++)u[p+1]=this._holes[p];return u.length<=1?this.getFactory().createLinearRing(u[0].getCoordinateSequence()):this.getFactory().createMultiLineString(u)}},{key:"getGeometryType",value:function(){return _t.TYPENAME_POLYGON}},{key:"getExteriorRing",value:function(){return this._shell}},{key:"isEmpty",value:function(){return this._shell.isEmpty()}},{key:"getInteriorRingN",value:function(u){return this._holes[u]}},{key:"interfaces_",get:function(){return[Zt]}}],[{key:"constructor_",value:function(){this._shell=null,this._holes=null;var u=arguments[0],p=arguments[1],x=arguments[2];if(_t.constructor_.call(this,x),u===null&&(u=this.getFactory().createLinearRing()),p===null&&(p=[]),_t.hasNullElements(p))throw new P("holes must not contain null elements");if(u.isEmpty()&&_t.hasNonEmptyElements(p))throw new P("shell is empty but holes are not");this._shell=u,this._holes=p}}])}(_t),ys=function(c){function o(){return n(this,o),i(this,o,arguments)}return m(o,c),l(o)}(ht),ji=function(c){function o(u){var p;return n(this,o),(p=i(this,o)).array=[],u instanceof wt&&p.addAll(u),p}return m(o,c),l(o,[{key:"contains",value:function(u){var p,x=f(this.array);try{for(x.s();!(p=x.n()).done;)if(p.value.compareTo(u)===0)return!0}catch(M){x.e(M)}finally{x.f()}return!1}},{key:"add",value:function(u){if(this.contains(u))return!1;for(var p=0,x=this.array.length;p<x;p++)if(this.array[p].compareTo(u)===1)return!!this.array.splice(p,0,u);return this.array.push(u),!0}},{key:"addAll",value:function(u){var p,x=f(u);try{for(x.s();!(p=x.n()).done;){var M=p.value;this.add(M)}}catch(D){x.e(D)}finally{x.f()}return!0}},{key:"remove",value:function(){throw new ct}},{key:"size",value:function(){return this.array.length}},{key:"isEmpty",value:function(){return this.array.length===0}},{key:"toArray",value:function(){return this.array.slice()}},{key:"iterator",value:function(){return new _s(this.array)}}])}(ys),_s=function(){return l(function c(o){n(this,c),this.array=o,this.position=0},[{key:"next",value:function(){if(this.position===this.array.length)throw new G;return this.array[this.position++]}},{key:"hasNext",value:function(){return this.position<this.array.length}},{key:"remove",value:function(){throw new ct}}])}(),rn=function(c){function o(){var u;return n(this,o),u=i(this,o),o.constructor_.apply(u,arguments),u}return m(o,c),l(o,[{key:"computeEnvelopeInternal",value:function(){for(var u=new xt,p=0;p<this._geometries.length;p++)u.expandToInclude(this._geometries[p].getEnvelopeInternal());return u}},{key:"getGeometryN",value:function(u){return this._geometries[u]}},{key:"getCoordinates",value:function(){for(var u=new Array(this.getNumPoints()).fill(null),p=-1,x=0;x<this._geometries.length;x++)for(var M=this._geometries[x].getCoordinates(),D=0;D<M.length;D++)u[++p]=M[D];return u}},{key:"getArea",value:function(){for(var u=0,p=0;p<this._geometries.length;p++)u+=this._geometries[p].getArea();return u}},{key:"copyInternal",value:function(){for(var u=new Array(this._geometries.length).fill(null),p=0;p<u.length;p++)u[p]=this._geometries[p].copy();return new o(u,this._factory)}},{key:"equalsExact",value:function(){if(arguments.length===2&&typeof arguments[1]=="number"&&arguments[0]instanceof _t){var u=arguments[0],p=arguments[1];if(!this.isEquivalentClass(u))return!1;var x=u;if(this._geometries.length!==x._geometries.length)return!1;for(var M=0;M<this._geometries.length;M++)if(!this._geometries[M].equalsExact(x._geometries[M],p))return!1;return!0}return w(o,"equalsExact",this,1).apply(this,arguments)}},{key:"normalize",value:function(){for(var u=0;u<this._geometries.length;u++)this._geometries[u].normalize();an.sort(this._geometries)}},{key:"getCoordinate",value:function(){return this.isEmpty()?null:this._geometries[0].getCoordinate()}},{key:"getBoundaryDimension",value:function(){for(var u=Dt.FALSE,p=0;p<this._geometries.length;p++)u=Math.max(u,this._geometries[p].getBoundaryDimension());return u}},{key:"reverseInternal",value:function(){for(var u=this._geometries.length,p=new Ft(u),x=0;x<u;x++)p.add(this._geometries[x].reverse());return this.getFactory().buildGeometry(p)}},{key:"getTypeCode",value:function(){return _t.TYPECODE_GEOMETRYCOLLECTION}},{key:"getDimension",value:function(){for(var u=Dt.FALSE,p=0;p<this._geometries.length;p++)u=Math.max(u,this._geometries[p].getDimension());return u}},{key:"getLength",value:function(){for(var u=0,p=0;p<this._geometries.length;p++)u+=this._geometries[p].getLength();return u}},{key:"getNumPoints",value:function(){for(var u=0,p=0;p<this._geometries.length;p++)u+=this._geometries[p].getNumPoints();return u}},{key:"getNumGeometries",value:function(){return this._geometries.length}},{key:"compareToSameClass",value:function(){if(arguments.length===1){var u=arguments[0],p=new ji(an.asList(this._geometries)),x=new ji(an.asList(u._geometries));return this.compare(p,x)}if(arguments.length===2){for(var M=arguments[1],D=arguments[0],Z=this.getNumGeometries(),Q=D.getNumGeometries(),rt=0;rt<Z&&rt<Q;){var dt=this.getGeometryN(rt),gt=D.getGeometryN(rt),Tt=dt.compareToSameClass(gt,M);if(Tt!==0)return Tt;rt++}return rt<Z?1:rt<Q?-1:0}}},{key:"apply",value:function(){if(St(arguments[0],$n))for(var u=arguments[0],p=0;p<this._geometries.length;p++)this._geometries[p].apply(u);else if(St(arguments[0],Ji)){var x=arguments[0];if(this._geometries.length===0)return null;for(var M=0;M<this._geometries.length&&(this._geometries[M].apply(x),!x.isDone());M++);x.isGeometryChanged()&&this.geometryChanged()}else if(St(arguments[0],$i)){var D=arguments[0];D.filter(this);for(var Z=0;Z<this._geometries.length;Z++)this._geometries[Z].apply(D)}else if(St(arguments[0],q)){var Q=arguments[0];Q.filter(this);for(var rt=0;rt<this._geometries.length;rt++)this._geometries[rt].apply(Q)}}},{key:"getBoundary",value:function(){return _t.checkNotGeometryCollection(this),lt.shouldNeverReachHere(),null}},{key:"getGeometryType",value:function(){return _t.TYPENAME_GEOMETRYCOLLECTION}},{key:"isEmpty",value:function(){for(var u=0;u<this._geometries.length;u++)if(!this._geometries[u].isEmpty())return!1;return!0}}],[{key:"constructor_",value:function(){if(this._geometries=null,arguments.length!==0){if(arguments.length===2){var u=arguments[0],p=arguments[1];if(_t.constructor_.call(this,p),u===null&&(u=[]),_t.hasNullElements(u))throw new P("geometries must not contain null elements");this._geometries=u}}}}])}(_t),vr=function(c){function o(){var u;return n(this,o),u=i(this,o),o.constructor_.apply(u,arguments),u}return m(o,c),l(o,[{key:"copyInternal",value:function(){for(var u=new Array(this._geometries.length).fill(null),p=0;p<u.length;p++)u[p]=this._geometries[p].copy();return new o(u,this._factory)}},{key:"isValid",value:function(){return!0}},{key:"equalsExact",value:function(){if(arguments.length===2&&typeof arguments[1]=="number"&&arguments[0]instanceof _t){var u=arguments[0],p=arguments[1];return!!this.isEquivalentClass(u)&&w(o,"equalsExact",this,1).call(this,u,p)}return w(o,"equalsExact",this,1).apply(this,arguments)}},{key:"getCoordinate",value:function(){if(arguments.length===1&&Number.isInteger(arguments[0])){var u=arguments[0];return this._geometries[u].getCoordinate()}return w(o,"getCoordinate",this,1).apply(this,arguments)}},{key:"getBoundaryDimension",value:function(){return Dt.FALSE}},{key:"getTypeCode",value:function(){return _t.TYPECODE_MULTIPOINT}},{key:"getDimension",value:function(){return 0}},{key:"getBoundary",value:function(){return this.getFactory().createGeometryCollection()}},{key:"getGeometryType",value:function(){return _t.TYPENAME_MULTIPOINT}},{key:"interfaces_",get:function(){return[so]}}],[{key:"constructor_",value:function(){var u=arguments[0],p=arguments[1];rn.constructor_.call(this,u,p)}}])}(rn),En=function(c){function o(){var u;return n(this,o),u=i(this,o),o.constructor_.apply(u,arguments),u}return m(o,c),l(o,[{key:"copyInternal",value:function(){return new o(this._points.copy(),this._factory)}},{key:"getBoundaryDimension",value:function(){return Dt.FALSE}},{key:"isClosed",value:function(){return!!this.isEmpty()||w(o,"isClosed",this,1).call(this)}},{key:"reverseInternal",value:function(){var u=this._points.copy();return Ii.reverse(u),this.getFactory().createLinearRing(u)}},{key:"getTypeCode",value:function(){return _t.TYPECODE_LINEARRING}},{key:"validateConstruction",value:function(){if(!this.isEmpty()&&!w(o,"isClosed",this,1).call(this))throw new P("Points of LinearRing do not form a closed linestring");if(this.getCoordinateSequence().size()>=1&&this.getCoordinateSequence().size()<o.MINIMUM_VALID_SIZE)throw new P("Invalid number of points in LinearRing (found "+this.getCoordinateSequence().size()+" - must be 0 or >= 4)")}},{key:"getGeometryType",value:function(){return _t.TYPENAME_LINEARRING}}],[{key:"constructor_",value:function(){var u=arguments[0],p=arguments[1];Fr.constructor_.call(this,u,p),this.validateConstruction()}}])}(Fr);En.MINIMUM_VALID_SIZE=4;var Ci=function(c){function o(){var u;return n(this,o),u=i(this,o),o.constructor_.apply(u,arguments),u}return m(o,c),l(o,[{key:"setOrdinate",value:function(u,p){switch(u){case o.X:this.x=p;break;case o.Y:this.y=p;break;default:throw new P("Invalid ordinate index: "+u)}}},{key:"getZ",value:function(){return at.NULL_ORDINATE}},{key:"getOrdinate",value:function(u){switch(u){case o.X:return this.x;case o.Y:return this.y}throw new P("Invalid ordinate index: "+u)}},{key:"setZ",value:function(u){throw new P("CoordinateXY dimension 2 does not support z-ordinate")}},{key:"copy",value:function(){return new o(this)}},{key:"toString",value:function(){return"("+this.x+", "+this.y+")"}},{key:"setCoordinate",value:function(u){this.x=u.x,this.y=u.y,this.z=u.getZ()}}],[{key:"constructor_",value:function(){if(arguments.length===0)at.constructor_.call(this);else if(arguments.length===1){if(arguments[0]instanceof o){var u=arguments[0];at.constructor_.call(this,u.x,u.y)}else if(arguments[0]instanceof at){var p=arguments[0];at.constructor_.call(this,p.x,p.y)}}else if(arguments.length===2){var x=arguments[0],M=arguments[1];at.constructor_.call(this,x,M,at.NULL_ORDINATE)}}}])}(at);Ci.X=0,Ci.Y=1,Ci.Z=-1,Ci.M=-1;var Ki=function(c){function o(){var u;return n(this,o),u=i(this,o),o.constructor_.apply(u,arguments),u}return m(o,c),l(o,[{key:"getM",value:function(){return this._m}},{key:"setOrdinate",value:function(u,p){switch(u){case o.X:this.x=p;break;case o.Y:this.y=p;break;case o.M:this._m=p;break;default:throw new P("Invalid ordinate index: "+u)}}},{key:"setM",value:function(u){this._m=u}},{key:"getZ",value:function(){return at.NULL_ORDINATE}},{key:"getOrdinate",value:function(u){switch(u){case o.X:return this.x;case o.Y:return this.y;case o.M:return this._m}throw new P("Invalid ordinate index: "+u)}},{key:"setZ",value:function(u){throw new P("CoordinateXY dimension 2 does not support z-ordinate")}},{key:"copy",value:function(){return new o(this)}},{key:"toString",value:function(){return"("+this.x+", "+this.y+" m="+this.getM()+")"}},{key:"setCoordinate",value:function(u){this.x=u.x,this.y=u.y,this.z=u.getZ(),this._m=u.getM()}}],[{key:"constructor_",value:function(){if(this._m=null,arguments.length===0)at.constructor_.call(this),this._m=0;else if(arguments.length===1){if(arguments[0]instanceof o){var u=arguments[0];at.constructor_.call(this,u.x,u.y),this._m=u._m}else if(arguments[0]instanceof at){var p=arguments[0];at.constructor_.call(this,p.x,p.y),this._m=this.getM()}}else if(arguments.length===3){var x=arguments[0],M=arguments[1],D=arguments[2];at.constructor_.call(this,x,M,at.NULL_ORDINATE),this._m=D}}}])}(at);Ki.X=0,Ki.Y=1,Ki.Z=-1,Ki.M=2;var uo=function(c){function o(){var u;return n(this,o),u=i(this,o),o.constructor_.apply(u,arguments),u}return m(o,c),l(o,[{key:"getM",value:function(){return this._m}},{key:"setOrdinate",value:function(u,p){switch(u){case at.X:this.x=p;break;case at.Y:this.y=p;break;case at.Z:this.z=p;break;case at.M:this._m=p;break;default:throw new P("Invalid ordinate index: "+u)}}},{key:"setM",value:function(u){this._m=u}},{key:"getOrdinate",value:function(u){switch(u){case at.X:return this.x;case at.Y:return this.y;case at.Z:return this.getZ();case at.M:return this.getM()}throw new P("Invalid ordinate index: "+u)}},{key:"copy",value:function(){return new o(this)}},{key:"toString",value:function(){return"("+this.x+", "+this.y+", "+this.getZ()+" m="+this.getM()+")"}},{key:"setCoordinate",value:function(u){this.x=u.x,this.y=u.y,this.z=u.getZ(),this._m=u.getM()}}],[{key:"constructor_",value:function(){if(this._m=null,arguments.length===0)at.constructor_.call(this),this._m=0;else if(arguments.length===1){if(arguments[0]instanceof o){var u=arguments[0];at.constructor_.call(this,u),this._m=u._m}else if(arguments[0]instanceof at){var p=arguments[0];at.constructor_.call(this,p),this._m=this.getM()}}else if(arguments.length===4){var x=arguments[0],M=arguments[1],D=arguments[2],Z=arguments[3];at.constructor_.call(this,x,M,D),this._m=Z}}}])}(at),vs=function(){function c(){n(this,c)}return l(c,null,[{key:"measures",value:function(o){return o instanceof Ci?0:o instanceof Ki||o instanceof uo?1:0}},{key:"dimension",value:function(o){return o instanceof Ci?2:o instanceof Ki?3:o instanceof uo?4:3}},{key:"create",value:function(){if(arguments.length===1){var o=arguments[0];return c.create(o,0)}if(arguments.length===2){var u=arguments[0],p=arguments[1];return u===2?new Ci:u===3&&p===0?new at:u===3&&p===1?new Ki:u===4&&p===1?new uo:new at}}}])}(),Ur=function(c){function o(){var u;return n(this,o),u=i(this,o),o.constructor_.apply(u,arguments),u}return m(o,c),l(o,[{key:"getCoordinate",value:function(u){return this.get(u)}},{key:"addAll",value:function(){if(arguments.length===2&&typeof arguments[1]=="boolean"&&St(arguments[0],wt)){for(var u=arguments[1],p=!1,x=arguments[0].iterator();x.hasNext();)this.add(x.next(),u),p=!0;return p}return w(o,"addAll",this,1).apply(this,arguments)}},{key:"clone",value:function(){for(var u=w(o,"clone",this,1).call(this),p=0;p<this.size();p++)u.add(p,this.get(p).clone());return u}},{key:"toCoordinateArray",value:function(){if(arguments.length===0)return this.toArray(o.coordArrayType);if(arguments.length===1){if(arguments[0])return this.toArray(o.coordArrayType);for(var u=this.size(),p=new Array(u).fill(null),x=0;x<u;x++)p[x]=this.get(u-x-1);return p}}},{key:"add",value:function(){if(arguments.length===1){var u=arguments[0];return w(o,"add",this,1).call(this,u)}if(arguments.length===2){if(arguments[0]instanceof Array&&typeof arguments[1]=="boolean"){var p=arguments[0],x=arguments[1];return this.add(p,x,!0),!0}if(arguments[0]instanceof at&&typeof arguments[1]=="boolean"){var M=arguments[0];if(!arguments[1]&&this.size()>=1&&this.get(this.size()-1).equals2D(M))return null;w(o,"add",this,1).call(this,M)}else if(arguments[0]instanceof Object&&typeof arguments[1]=="boolean"){var D=arguments[0],Z=arguments[1];return this.add(D,Z),!0}}else if(arguments.length===3){if(typeof arguments[2]=="boolean"&&arguments[0]instanceof Array&&typeof arguments[1]=="boolean"){var Q=arguments[0],rt=arguments[1];if(arguments[2])for(var dt=0;dt<Q.length;dt++)this.add(Q[dt],rt);else for(var gt=Q.length-1;gt>=0;gt--)this.add(Q[gt],rt);return!0}if(typeof arguments[2]=="boolean"&&Number.isInteger(arguments[0])&&arguments[1]instanceof at){var Tt=arguments[0],Ot=arguments[1];if(!arguments[2]){var zt=this.size();if(zt>0&&(Tt>0&&this.get(Tt-1).equals2D(Ot)||Tt<zt&&this.get(Tt).equals2D(Ot)))return null}w(o,"add",this,1).call(this,Tt,Ot)}}else if(arguments.length===4){var qt=arguments[0],ne=arguments[1],jt=arguments[2],Ee=arguments[3],Pe=1;jt>Ee&&(Pe=-1);for(var Ze=jt;Ze!==Ee;Ze+=Pe)this.add(qt[Ze],ne);return!0}}},{key:"closeRing",value:function(){if(this.size()>0){var u=this.get(0).copy();this.add(u,!1)}}}],[{key:"constructor_",value:function(){if(arguments.length!==0){if(arguments.length===1){var u=arguments[0];this.ensureCapacity(u.length),this.add(u,!0)}else if(arguments.length===2){var p=arguments[0],x=arguments[1];this.ensureCapacity(p.length),this.add(p,x)}}}}])}(Ft);Ur.coordArrayType=new Array(0).fill(null);var Ge=function(){function c(){n(this,c)}return l(c,null,[{key:"isRing",value:function(o){return!(o.length<4)&&!!o[0].equals2D(o[o.length-1])}},{key:"ptNotInList",value:function(o,u){for(var p=0;p<o.length;p++){var x=o[p];if(c.indexOf(x,u)<0)return x}return null}},{key:"scroll",value:function(o,u){var p=c.indexOf(u,o);if(p<0)return null;var x=new Array(o.length).fill(null);ze.arraycopy(o,p,x,0,o.length-p),ze.arraycopy(o,0,x,o.length-p,p),ze.arraycopy(x,0,o,0,o.length)}},{key:"equals",value:function(){if(arguments.length===2){var o=arguments[0],u=arguments[1];if(o===u)return!0;if(o===null||u===null||o.length!==u.length)return!1;for(var p=0;p<o.length;p++)if(!o[p].equals(u[p]))return!1;return!0}if(arguments.length===3){var x=arguments[0],M=arguments[1],D=arguments[2];if(x===M)return!0;if(x===null||M===null||x.length!==M.length)return!1;for(var Z=0;Z<x.length;Z++)if(D.compare(x[Z],M[Z])!==0)return!1;return!0}}},{key:"intersection",value:function(o,u){for(var p=new Ur,x=0;x<o.length;x++)u.intersects(o[x])&&p.add(o[x],!0);return p.toCoordinateArray()}},{key:"measures",value:function(o){if(o===null||o.length===0)return 0;var u,p=0,x=f(o);try{for(x.s();!(u=x.n()).done;){var M=u.value;p=Math.max(p,vs.measures(M))}}catch(D){x.e(D)}finally{x.f()}return p}},{key:"hasRepeatedPoints",value:function(o){for(var u=1;u<o.length;u++)if(o[u-1].equals(o[u]))return!0;return!1}},{key:"removeRepeatedPoints",value:function(o){return c.hasRepeatedPoints(o)?new Ur(o,!1).toCoordinateArray():o}},{key:"reverse",value:function(o){for(var u=o.length-1,p=Math.trunc(u/2),x=0;x<=p;x++){var M=o[x];o[x]=o[u-x],o[u-x]=M}}},{key:"removeNull",value:function(o){for(var u=0,p=0;p<o.length;p++)o[p]!==null&&u++;var x=new Array(u).fill(null);if(u===0)return x;for(var M=0,D=0;D<o.length;D++)o[D]!==null&&(x[M++]=o[D]);return x}},{key:"copyDeep",value:function(){if(arguments.length===1){for(var o=arguments[0],u=new Array(o.length).fill(null),p=0;p<o.length;p++)u[p]=o[p].copy();return u}if(arguments.length===5)for(var x=arguments[0],M=arguments[1],D=arguments[2],Z=arguments[3],Q=arguments[4],rt=0;rt<Q;rt++)D[Z+rt]=x[M+rt].copy()}},{key:"isEqualReversed",value:function(o,u){for(var p=0;p<o.length;p++){var x=o[p],M=u[o.length-p-1];if(x.compareTo(M)!==0)return!1}return!0}},{key:"envelope",value:function(o){for(var u=new xt,p=0;p<o.length;p++)u.expandToInclude(o[p]);return u}},{key:"toCoordinateArray",value:function(o){return o.toArray(c.coordArrayType)}},{key:"dimension",value:function(o){if(o===null||o.length===0)return 3;var u,p=0,x=f(o);try{for(x.s();!(u=x.n()).done;){var M=u.value;p=Math.max(p,vs.dimension(M))}}catch(D){x.e(D)}finally{x.f()}return p}},{key:"atLeastNCoordinatesOrNothing",value:function(o,u){return u.length>=o?u:[]}},{key:"indexOf",value:function(o,u){for(var p=0;p<u.length;p++)if(o.equals(u[p]))return p;return-1}},{key:"increasingDirection",value:function(o){for(var u=0;u<Math.trunc(o.length/2);u++){var p=o.length-1-u,x=o[u].compareTo(o[p]);if(x!==0)return x}return 1}},{key:"compare",value:function(o,u){for(var p=0;p<o.length&&p<u.length;){var x=o[p].compareTo(u[p]);if(x!==0)return x;p++}return p<u.length?-1:p<o.length?1:0}},{key:"minCoordinate",value:function(o){for(var u=null,p=0;p<o.length;p++)(u===null||u.compareTo(o[p])>0)&&(u=o[p]);return u}},{key:"extract",value:function(o,u,p){u=In.clamp(u,0,o.length);var x=(p=In.clamp(p,-1,o.length))-u+1;p<0&&(x=0),u>=o.length&&(x=0),p<u&&(x=0);var M=new Array(x).fill(null);if(x===0)return M;for(var D=0,Z=u;Z<=p;Z++)M[D++]=o[Z];return M}}])}(),xs=function(){return l(function c(){n(this,c)},[{key:"compare",value:function(c,o){var u=c,p=o;return Ge.compare(u,p)}},{key:"interfaces_",get:function(){return[K]}}])}(),Ai=function(){return l(function c(){n(this,c)},[{key:"compare",value:function(c,o){var u=c,p=o;if(u.length<p.length)return-1;if(u.length>p.length)return 1;if(u.length===0)return 0;var x=Ge.compare(u,p);return Ge.isEqualReversed(u,p)?0:x}},{key:"OLDcompare",value:function(c,o){var u=c,p=o;if(u.length<p.length)return-1;if(u.length>p.length)return 1;if(u.length===0)return 0;for(var x=Ge.increasingDirection(u),M=Ge.increasingDirection(p),D=x>0?0:u.length-1,Z=M>0?0:u.length-1,Q=0;Q<u.length;Q++){var rt=u[D].compareTo(p[Z]);if(rt!==0)return rt;D+=x,Z+=M}return 0}},{key:"interfaces_",get:function(){return[K]}}])}();Ge.ForwardComparator=xs,Ge.BidirectionalComparator=Ai,Ge.coordArrayType=new Array(0).fill(null);var Gr=function(){return l(function c(o){n(this,c),this.str=o},[{key:"append",value:function(c){this.str+=c}},{key:"setCharAt",value:function(c,o){this.str=this.str.substr(0,c)+o+this.str.substr(c+1)}},{key:"toString",value:function(){return this.str}}])}(),se=function(){function c(){n(this,c),c.constructor_.apply(this,arguments)}return l(c,[{key:"getM",value:function(o){return this.hasM()?this._coordinates[o].getM():J.NaN}},{key:"setOrdinate",value:function(o,u,p){switch(u){case Xt.X:this._coordinates[o].x=p;break;case Xt.Y:this._coordinates[o].y=p;break;default:this._coordinates[o].setOrdinate(u,p)}}},{key:"getZ",value:function(o){return this.hasZ()?this._coordinates[o].getZ():J.NaN}},{key:"size",value:function(){return this._coordinates.length}},{key:"getOrdinate",value:function(o,u){switch(u){case Xt.X:return this._coordinates[o].x;case Xt.Y:return this._coordinates[o].y;default:return this._coordinates[o].getOrdinate(u)}}},{key:"getCoordinate",value:function(){if(arguments.length===1){var o=arguments[0];return this._coordinates[o]}if(arguments.length===2){var u=arguments[0];arguments[1].setCoordinate(this._coordinates[u])}}},{key:"getCoordinateCopy",value:function(o){var u=this.createCoordinate();return u.setCoordinate(this._coordinates[o]),u}},{key:"createCoordinate",value:function(){return vs.create(this.getDimension(),this.getMeasures())}},{key:"getDimension",value:function(){return this._dimension}},{key:"getX",value:function(o){return this._coordinates[o].x}},{key:"getMeasures",value:function(){return this._measures}},{key:"expandEnvelope",value:function(o){for(var u=0;u<this._coordinates.length;u++)o.expandToInclude(this._coordinates[u]);return o}},{key:"copy",value:function(){for(var o=new Array(this.size()).fill(null),u=0;u<this._coordinates.length;u++){var p=this.createCoordinate();p.setCoordinate(this._coordinates[u]),o[u]=p}return new c(o,this._dimension,this._measures)}},{key:"toString",value:function(){if(this._coordinates.length>0){var o=new Gr(17*this._coordinates.length);o.append("("),o.append(this._coordinates[0]);for(var u=1;u<this._coordinates.length;u++)o.append(", "),o.append(this._coordinates[u]);return o.append(")"),o.toString()}return"()"}},{key:"getY",value:function(o){return this._coordinates[o].y}},{key:"toCoordinateArray",value:function(){return this._coordinates}},{key:"interfaces_",get:function(){return[Xt,O]}}],[{key:"constructor_",value:function(){if(this._dimension=3,this._measures=0,this._coordinates=null,arguments.length===1){if(arguments[0]instanceof Array){var o=arguments[0];c.constructor_.call(this,o,Ge.dimension(o),Ge.measures(o))}else if(Number.isInteger(arguments[0])){var u=arguments[0];this._coordinates=new Array(u).fill(null);for(var p=0;p<u;p++)this._coordinates[p]=new at}else if(St(arguments[0],Xt)){var x=arguments[0];if(x===null)return this._coordinates=new Array(0).fill(null),null;this._dimension=x.getDimension(),this._measures=x.getMeasures(),this._coordinates=new Array(x.size()).fill(null);for(var M=0;M<this._coordinates.length;M++)this._coordinates[M]=x.getCoordinateCopy(M)}}else if(arguments.length===2){if(arguments[0]instanceof Array&&Number.isInteger(arguments[1])){var D=arguments[0],Z=arguments[1];c.constructor_.call(this,D,Z,Ge.measures(D))}else if(Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){var Q=arguments[0],rt=arguments[1];this._coordinates=new Array(Q).fill(null),this._dimension=rt;for(var dt=0;dt<Q;dt++)this._coordinates[dt]=vs.create(rt)}}else if(arguments.length===3){if(Number.isInteger(arguments[2])&&arguments[0]instanceof Array&&Number.isInteger(arguments[1])){var gt=arguments[0],Tt=arguments[1],Ot=arguments[2];this._dimension=Tt,this._measures=Ot,this._coordinates=gt===null?new Array(0).fill(null):gt}else if(Number.isInteger(arguments[2])&&Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){var zt=arguments[0],qt=arguments[1],ne=arguments[2];this._coordinates=new Array(zt).fill(null),this._dimension=qt,this._measures=ne;for(var jt=0;jt<zt;jt++)this._coordinates[jt]=this.createCoordinate()}}}}])}(),mi=function(){function c(){n(this,c)}return l(c,[{key:"readResolve",value:function(){return c.instance()}},{key:"create",value:function(){if(arguments.length===1){if(arguments[0]instanceof Array)return new se(arguments[0]);if(St(arguments[0],Xt))return new se(arguments[0])}else{if(arguments.length===2){var o=arguments[1];return o>3&&(o=3),o<2&&(o=2),new se(arguments[0],o)}if(arguments.length===3){var u=arguments[2],p=arguments[1]-u;return u>1&&(u=1),p>3&&(p=3),p<2&&(p=2),new se(arguments[0],p+u,u)}}}},{key:"interfaces_",get:function(){return[Se,O]}}],[{key:"instance",value:function(){return c.instanceObject}}])}();mi.instanceObject=new mi;var lo=function(c){function o(){var u;return n(this,o),u=i(this,o),o.constructor_.apply(u,arguments),u}return m(o,c),l(o,[{key:"copyInternal",value:function(){for(var u=new Array(this._geometries.length).fill(null),p=0;p<u.length;p++)u[p]=this._geometries[p].copy();return new o(u,this._factory)}},{key:"equalsExact",value:function(){if(arguments.length===2&&typeof arguments[1]=="number"&&arguments[0]instanceof _t){var u=arguments[0],p=arguments[1];return!!this.isEquivalentClass(u)&&w(o,"equalsExact",this,1).call(this,u,p)}return w(o,"equalsExact",this,1).apply(this,arguments)}},{key:"getBoundaryDimension",value:function(){return 1}},{key:"getTypeCode",value:function(){return _t.TYPECODE_MULTIPOLYGON}},{key:"getDimension",value:function(){return 2}},{key:"getBoundary",value:function(){if(this.isEmpty())return this.getFactory().createMultiLineString();for(var u=new Ft,p=0;p<this._geometries.length;p++)for(var x=this._geometries[p].getBoundary(),M=0;M<x.getNumGeometries();M++)u.add(x.getGeometryN(M));var D=new Array(u.size()).fill(null);return this.getFactory().createMultiLineString(u.toArray(D))}},{key:"getGeometryType",value:function(){return _t.TYPENAME_MULTIPOLYGON}},{key:"interfaces_",get:function(){return[Zt]}}],[{key:"constructor_",value:function(){var u=arguments[0],p=arguments[1];rn.constructor_.call(this,u,p)}}])}(rn),Wo=function(){return l(function c(){n(this,c)},[{key:"get",value:function(){}},{key:"put",value:function(){}},{key:"size",value:function(){}},{key:"values",value:function(){}},{key:"entrySet",value:function(){}}])}(),ho=function(c){function o(){var u;return n(this,o),(u=i(this,o)).map=new Map,u}return m(o,c),l(o,[{key:"get",value:function(u){return this.map.get(u)||null}},{key:"put",value:function(u,p){return this.map.set(u,p),p}},{key:"values",value:function(){for(var u=new Ft,p=this.map.values(),x=p.next();!x.done;)u.add(x.value),x=p.next();return u}},{key:"entrySet",value:function(){var u=new ot;return this.map.entries().forEach(function(p){return u.add(p)}),u}},{key:"size",value:function(){return this.map.size()}}])}(Wo),xn=function(){function c(){n(this,c),c.constructor_.apply(this,arguments)}return l(c,[{key:"equals",value:function(o){if(!(o instanceof c))return!1;var u=o;return this._modelType===u._modelType&&this._scale===u._scale}},{key:"compareTo",value:function(o){var u=o,p=this.getMaximumSignificantDigits(),x=u.getMaximumSignificantDigits();return Bt.compare(p,x)}},{key:"getScale",value:function(){return this._scale}},{key:"isFloating",value:function(){return this._modelType===c.FLOATING||this._modelType===c.FLOATING_SINGLE}},{key:"getType",value:function(){return this._modelType}},{key:"toString",value:function(){var o="UNKNOWN";return this._modelType===c.FLOATING?o="Floating":this._modelType===c.FLOATING_SINGLE?o="Floating-Single":this._modelType===c.FIXED&&(o="Fixed (Scale="+this.getScale()+")"),o}},{key:"makePrecise",value:function(){if(typeof arguments[0]=="number"){var o=arguments[0];return J.isNaN(o)||this._modelType===c.FLOATING_SINGLE?o:this._modelType===c.FIXED?Math.round(o*this._scale)/this._scale:o}if(arguments[0]instanceof at){var u=arguments[0];if(this._modelType===c.FLOATING)return null;u.x=this.makePrecise(u.x),u.y=this.makePrecise(u.y)}}},{key:"getMaximumSignificantDigits",value:function(){var o=16;return this._modelType===c.FLOATING?o=16:this._modelType===c.FLOATING_SINGLE?o=6:this._modelType===c.FIXED&&(o=1+Math.trunc(Math.ceil(Math.log(this.getScale())/Math.log(10)))),o}},{key:"setScale",value:function(o){this._scale=Math.abs(o)}},{key:"interfaces_",get:function(){return[O,U]}}],[{key:"constructor_",value:function(){if(this._modelType=null,this._scale=null,arguments.length===0)this._modelType=c.FLOATING;else if(arguments.length===1){if(arguments[0]instanceof Qi){var o=arguments[0];this._modelType=o,o===c.FIXED&&this.setScale(1)}else if(typeof arguments[0]=="number"){var u=arguments[0];this._modelType=c.FIXED,this.setScale(u)}else if(arguments[0]instanceof c){var p=arguments[0];this._modelType=p._modelType,this._scale=p._scale}}}},{key:"mostPrecise",value:function(o,u){return o.compareTo(u)>=0?o:u}}])}(),Qi=function(){function c(){n(this,c),c.constructor_.apply(this,arguments)}return l(c,[{key:"readResolve",value:function(){return c.nameToTypeMap.get(this._name)}},{key:"toString",value:function(){return this._name}},{key:"interfaces_",get:function(){return[O]}}],[{key:"constructor_",value:function(){this._name=null;var o=arguments[0];this._name=o,c.nameToTypeMap.put(o,this)}}])}();Qi.nameToTypeMap=new ho,xn.Type=Qi,xn.FIXED=new Qi("FIXED"),xn.FLOATING=new Qi("FLOATING"),xn.FLOATING_SINGLE=new Qi("FLOATING SINGLE"),xn.maximumPreciseValue=9007199254740992;var Bn=function(c){function o(){var u;return n(this,o),u=i(this,o),o.constructor_.apply(u,arguments),u}return m(o,c),l(o,[{key:"copyInternal",value:function(){for(var u=new Array(this._geometries.length).fill(null),p=0;p<u.length;p++)u[p]=this._geometries[p].copy();return new o(u,this._factory)}},{key:"equalsExact",value:function(){if(arguments.length===2&&typeof arguments[1]=="number"&&arguments[0]instanceof _t){var u=arguments[0],p=arguments[1];return!!this.isEquivalentClass(u)&&w(o,"equalsExact",this,1).call(this,u,p)}return w(o,"equalsExact",this,1).apply(this,arguments)}},{key:"getBoundaryDimension",value:function(){return this.isClosed()?Dt.FALSE:0}},{key:"isClosed",value:function(){if(this.isEmpty())return!1;for(var u=0;u<this._geometries.length;u++)if(!this._geometries[u].isClosed())return!1;return!0}},{key:"getTypeCode",value:function(){return _t.TYPECODE_MULTILINESTRING}},{key:"getDimension",value:function(){return 1}},{key:"getBoundary",value:function(){throw new ct}},{key:"getGeometryType",value:function(){return _t.TYPENAME_MULTILINESTRING}},{key:"interfaces_",get:function(){return[ms]}}],[{key:"constructor_",value:function(){var u=arguments[0],p=arguments[1];rn.constructor_.call(this,u,p)}}])}(rn),ni=function(){function c(){n(this,c),c.constructor_.apply(this,arguments)}return l(c,[{key:"createEmpty",value:function(o){switch(o){case-1:return this.createGeometryCollection();case 0:return this.createPoint();case 1:return this.createLineString();case 2:return this.createPolygon();default:throw new P("Invalid dimension: "+o)}}},{key:"toGeometry",value:function(o){return o.isNull()?this.createPoint():o.getMinX()===o.getMaxX()&&o.getMinY()===o.getMaxY()?this.createPoint(new at(o.getMinX(),o.getMinY())):o.getMinX()===o.getMaxX()||o.getMinY()===o.getMaxY()?this.createLineString([new at(o.getMinX(),o.getMinY()),new at(o.getMaxX(),o.getMaxY())]):this.createPolygon(this.createLinearRing([new at(o.getMinX(),o.getMinY()),new at(o.getMinX(),o.getMaxY()),new at(o.getMaxX(),o.getMaxY()),new at(o.getMaxX(),o.getMinY()),new at(o.getMinX(),o.getMinY())]),null)}},{key:"createLineString",value:function(){if(arguments.length===0)return this.createLineString(this.getCoordinateSequenceFactory().create([]));if(arguments.length===1){if(arguments[0]instanceof Array){var o=arguments[0];return this.createLineString(o!==null?this.getCoordinateSequenceFactory().create(o):null)}if(St(arguments[0],Xt))return new Fr(arguments[0],this)}}},{key:"createMultiLineString",value:function(){return arguments.length===0?new Bn(null,this):arguments.length===1?new Bn(arguments[0],this):void 0}},{key:"buildGeometry",value:function(o){for(var u=null,p=!1,x=!1,M=o.iterator();M.hasNext();){var D=M.next(),Z=D.getTypeCode();u===null&&(u=Z),Z!==u&&(p=!0),D instanceof rn&&(x=!0)}if(u===null)return this.createGeometryCollection();if(p||x)return this.createGeometryCollection(c.toGeometryArray(o));var Q=o.iterator().next();if(o.size()>1){if(Q instanceof _r)return this.createMultiPolygon(c.toPolygonArray(o));if(Q instanceof Fr)return this.createMultiLineString(c.toLineStringArray(o));if(Q instanceof oo)return this.createMultiPoint(c.toPointArray(o));lt.shouldNeverReachHere("Unhandled geometry type: "+Q.getGeometryType())}return Q}},{key:"createMultiPointFromCoords",value:function(o){return this.createMultiPoint(o!==null?this.getCoordinateSequenceFactory().create(o):null)}},{key:"createPoint",value:function(){if(arguments.length===0)return this.createPoint(this.getCoordinateSequenceFactory().create([]));if(arguments.length===1){if(arguments[0]instanceof at){var o=arguments[0];return this.createPoint(o!==null?this.getCoordinateSequenceFactory().create([o]):null)}if(St(arguments[0],Xt))return new oo(arguments[0],this)}}},{key:"getCoordinateSequenceFactory",value:function(){return this._coordinateSequenceFactory}},{key:"createPolygon",value:function(){if(arguments.length===0)return this.createPolygon(null,null);if(arguments.length===1){if(St(arguments[0],Xt)){var o=arguments[0];return this.createPolygon(this.createLinearRing(o))}if(arguments[0]instanceof Array){var u=arguments[0];return this.createPolygon(this.createLinearRing(u))}if(arguments[0]instanceof En){var p=arguments[0];return this.createPolygon(p,null)}}else if(arguments.length===2)return new _r(arguments[0],arguments[1],this)}},{key:"getSRID",value:function(){return this._SRID}},{key:"createGeometryCollection",value:function(){return arguments.length===0?new rn(null,this):arguments.length===1?new rn(arguments[0],this):void 0}},{key:"getPrecisionModel",value:function(){return this._precisionModel}},{key:"createLinearRing",value:function(){if(arguments.length===0)return this.createLinearRing(this.getCoordinateSequenceFactory().create([]));if(arguments.length===1){if(arguments[0]instanceof Array){var o=arguments[0];return this.createLinearRing(o!==null?this.getCoordinateSequenceFactory().create(o):null)}if(St(arguments[0],Xt))return new En(arguments[0],this)}}},{key:"createMultiPolygon",value:function(){return arguments.length===0?new lo(null,this):arguments.length===1?new lo(arguments[0],this):void 0}},{key:"createMultiPoint",value:function(){if(arguments.length===0)return new vr(null,this);if(arguments.length===1){if(arguments[0]instanceof Array)return new vr(arguments[0],this);if(St(arguments[0],Xt)){var o=arguments[0];if(o===null)return this.createMultiPoint(new Array(0).fill(null));for(var u=new Array(o.size()).fill(null),p=0;p<o.size();p++){var x=this.getCoordinateSequenceFactory().create(1,o.getDimension(),o.getMeasures());Ii.copy(o,p,x,0,1),u[p]=this.createPoint(x)}return this.createMultiPoint(u)}}}},{key:"interfaces_",get:function(){return[O]}}],[{key:"constructor_",value:function(){if(this._precisionModel=null,this._coordinateSequenceFactory=null,this._SRID=null,arguments.length===0)c.constructor_.call(this,new xn,0);else if(arguments.length===1){if(St(arguments[0],Se)){var o=arguments[0];c.constructor_.call(this,new xn,0,o)}else if(arguments[0]instanceof xn){var u=arguments[0];c.constructor_.call(this,u,0,c.getDefaultCoordinateSequenceFactory())}}else if(arguments.length===2){var p=arguments[0],x=arguments[1];c.constructor_.call(this,p,x,c.getDefaultCoordinateSequenceFactory())}else if(arguments.length===3){var M=arguments[0],D=arguments[1],Z=arguments[2];this._precisionModel=M,this._coordinateSequenceFactory=Z,this._SRID=D}}},{key:"toMultiPolygonArray",value:function(o){var u=new Array(o.size()).fill(null);return o.toArray(u)}},{key:"toGeometryArray",value:function(o){if(o===null)return null;var u=new Array(o.size()).fill(null);return o.toArray(u)}},{key:"getDefaultCoordinateSequenceFactory",value:function(){return mi.instance()}},{key:"toMultiLineStringArray",value:function(o){var u=new Array(o.size()).fill(null);return o.toArray(u)}},{key:"toLineStringArray",value:function(o){var u=new Array(o.size()).fill(null);return o.toArray(u)}},{key:"toMultiPointArray",value:function(o){var u=new Array(o.size()).fill(null);return o.toArray(u)}},{key:"toLinearRingArray",value:function(o){var u=new Array(o.size()).fill(null);return o.toArray(u)}},{key:"toPointArray",value:function(o){var u=new Array(o.size()).fill(null);return o.toArray(u)}},{key:"toPolygonArray",value:function(o){var u=new Array(o.size()).fill(null);return o.toArray(u)}},{key:"createPointFromInternalCoord",value:function(o,u){return u.getPrecisionModel().makePrecise(o),u.getFactory().createPoint(o)}}])}(),he="XY",Ne="XYZ",ws="XYM",xr="XYZM",wn={POINT:"Point",LINE_STRING:"LineString",LINEAR_RING:"LinearRing",POLYGON:"Polygon",MULTI_POINT:"MultiPoint",MULTI_LINE_STRING:"MultiLineString",MULTI_POLYGON:"MultiPolygon",GEOMETRY_COLLECTION:"GeometryCollection",CIRCLE:"Circle"},bs="EMPTY",Qt=1,xe=2,ii=3,Vr=4,Ve=5,iu=6;for(var Es in wn)wn[Es].toUpperCase();var sn=function(){return l(function c(o){n(this,c),this.wkt=o,this.index_=-1},[{key:"isAlpha_",value:function(c){return c>="a"&&c<="z"||c>="A"&&c<="Z"}},{key:"isNumeric_",value:function(c,o){return c>="0"&&c<="9"||c=="."&&!(o!==void 0&&o)}},{key:"isWhiteSpace_",value:function(c){return c==" "||c=="	"||c=="\r"||c==`
`}},{key:"nextChar_",value:function(){return this.wkt.charAt(++this.index_)}},{key:"nextToken",value:function(){var c,o=this.nextChar_(),u=this.index_,p=o;if(o=="(")c=xe;else if(o==",")c=Ve;else if(o==")")c=ii;else if(this.isNumeric_(o)||o=="-")c=Vr,p=this.readNumber_();else if(this.isAlpha_(o))c=Qt,p=this.readText_();else{if(this.isWhiteSpace_(o))return this.nextToken();if(o!=="")throw new Error("Unexpected character: "+o);c=iu}return{position:u,value:p,type:c}}},{key:"readNumber_",value:function(){var c,o=this.index_,u=!1,p=!1;do c=="."?u=!0:c!="e"&&c!="E"||(p=!0),c=this.nextChar_();while(this.isNumeric_(c,u)||!p&&(c=="e"||c=="E")||p&&(c=="-"||c=="+"));return parseFloat(this.wkt.substring(o,this.index_--))}},{key:"readText_",value:function(){var c,o=this.index_;do c=this.nextChar_();while(this.isAlpha_(c));return this.wkt.substring(o,this.index_--).toUpperCase()}}])}(),qe=function(){return l(function c(o,u){n(this,c),this.lexer_=o,this.token_,this.layout_=he,this.factory=u},[{key:"consume_",value:function(){this.token_=this.lexer_.nextToken()}},{key:"isTokenType",value:function(c){return this.token_.type==c}},{key:"match",value:function(c){var o=this.isTokenType(c);return o&&this.consume_(),o}},{key:"parse",value:function(){return this.consume_(),this.parseGeometry_()}},{key:"parseGeometryLayout_",value:function(){var c=he,o=this.token_;if(this.isTokenType(Qt)){var u=o.value;u==="Z"?c=Ne:u==="M"?c=ws:u==="ZM"&&(c=xr),c!==he&&this.consume_()}return c}},{key:"parseGeometryCollectionText_",value:function(){if(this.match(xe)){var c=[];do c.push(this.parseGeometry_());while(this.match(Ve));if(this.match(ii))return c}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_())}},{key:"parsePointText_",value:function(){if(this.match(xe)){var c=this.parsePoint_();if(this.match(ii))return c}else if(this.isEmptyGeometry_())return null;throw new Error(this.formatErrorMessage_())}},{key:"parseLineStringText_",value:function(){if(this.match(xe)){var c=this.parsePointList_();if(this.match(ii))return c}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_())}},{key:"parsePolygonText_",value:function(){if(this.match(xe)){var c=this.parseLineStringTextList_();if(this.match(ii))return c}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_())}},{key:"parseMultiPointText_",value:function(){var c;if(this.match(xe)){if(c=this.token_.type==xe?this.parsePointTextList_():this.parsePointList_(),this.match(ii))return c}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_())}},{key:"parseMultiLineStringText_",value:function(){if(this.match(xe)){var c=this.parseLineStringTextList_();if(this.match(ii))return c}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_())}},{key:"parseMultiPolygonText_",value:function(){if(this.match(xe)){var c=this.parsePolygonTextList_();if(this.match(ii))return c}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_())}},{key:"parsePoint_",value:function(){for(var c=[],o=this.layout_.length,u=0;u<o;++u){var p=this.token_;if(!this.match(Vr))break;c.push(p.value)}if(c.length==o)return c;throw new Error(this.formatErrorMessage_())}},{key:"parsePointList_",value:function(){for(var c=[this.parsePoint_()];this.match(Ve);)c.push(this.parsePoint_());return c}},{key:"parsePointTextList_",value:function(){for(var c=[this.parsePointText_()];this.match(Ve);)c.push(this.parsePointText_());return c}},{key:"parseLineStringTextList_",value:function(){for(var c=[this.parseLineStringText_()];this.match(Ve);)c.push(this.parseLineStringText_());return c}},{key:"parsePolygonTextList_",value:function(){for(var c=[this.parsePolygonText_()];this.match(Ve);)c.push(this.parsePolygonText_());return c}},{key:"isEmptyGeometry_",value:function(){var c=this.isTokenType(Qt)&&this.token_.value==bs;return c&&this.consume_(),c}},{key:"formatErrorMessage_",value:function(){return"Unexpected `"+this.token_.value+"` at position "+this.token_.position+" in `"+this.lexer_.wkt+"`"}},{key:"parseGeometry_",value:function(){var c=this.factory,o=function(qt){return s(at,b(qt))},u=function(qt){var ne=qt.map(function(jt){return c.createLinearRing(jt.map(o))});return ne.length>1?c.createPolygon(ne[0],ne.slice(1)):c.createPolygon(ne[0])},p=this.token_;if(this.match(Qt)){var x=p.value;if(this.layout_=this.parseGeometryLayout_(),x=="GEOMETRYCOLLECTION"){var M=this.parseGeometryCollectionText_();return c.createGeometryCollection(M)}switch(x){case"POINT":var D=this.parsePointText_();return D?c.createPoint(s(at,b(D))):c.createPoint();case"LINESTRING":var Z=this.parseLineStringText_().map(o);return c.createLineString(Z);case"LINEARRING":var Q=this.parseLineStringText_().map(o);return c.createLinearRing(Q);case"POLYGON":var rt=this.parsePolygonText_();return rt&&rt.length!==0?u(rt):c.createPolygon();case"MULTIPOINT":var dt=this.parseMultiPointText_();if(!dt||dt.length===0)return c.createMultiPoint();var gt=dt.map(o).map(function(qt){return c.createPoint(qt)});return c.createMultiPoint(gt);case"MULTILINESTRING":var Tt=this.parseMultiLineStringText_().map(function(qt){return c.createLineString(qt.map(o))});return c.createMultiLineString(Tt);case"MULTIPOLYGON":var Ot=this.parseMultiPolygonText_();if(!Ot||Ot.length===0)return c.createMultiPolygon();var zt=Ot.map(u);return c.createMultiPolygon(zt);default:throw new Error("Invalid geometry type: "+x)}}throw new Error(this.formatErrorMessage_())}}])}();function Ni(c){if(c.isEmpty())return"";var o=c.getCoordinate(),u=[o.x,o.y];return o.z===void 0||Number.isNaN(o.z)||u.push(o.z),o.m===void 0||Number.isNaN(o.m)||u.push(o.m),u.join(" ")}function yi(c){for(var o=c.getCoordinates().map(function(M){var D=[M.x,M.y];return M.z===void 0||Number.isNaN(M.z)||D.push(M.z),M.m===void 0||Number.isNaN(M.m)||D.push(M.m),D}),u=[],p=0,x=o.length;p<x;++p)u.push(o[p].join(" "));return u.join(", ")}function wr(c){var o=[];o.push("("+yi(c.getExteriorRing())+")");for(var u=0,p=c.getNumInteriorRing();u<p;++u)o.push("("+yi(c.getInteriorRingN(u))+")");return o.join(", ")}var co={Point:Ni,LineString:yi,LinearRing:yi,Polygon:wr,MultiPoint:function(c){for(var o=[],u=0,p=c.getNumGeometries();u<p;++u)o.push("("+Ni(c.getGeometryN(u))+")");return o.join(", ")},MultiLineString:function(c){for(var o=[],u=0,p=c.getNumGeometries();u<p;++u)o.push("("+yi(c.getGeometryN(u))+")");return o.join(", ")},MultiPolygon:function(c){for(var o=[],u=0,p=c.getNumGeometries();u<p;++u)o.push("("+wr(c.getGeometryN(u))+")");return o.join(", ")},GeometryCollection:function(c){for(var o=[],u=0,p=c.getNumGeometries();u<p;++u)o.push(tr(c.getGeometryN(u)));return o.join(", ")}};function tr(c){var o=c.getGeometryType(),u=co[o];o=o.toUpperCase();var p=function(x){var M="";if(x.isEmpty())return M;var D=x.getCoordinate();return D.z===void 0||Number.isNaN(D.z)||(M+="Z"),D.m===void 0||Number.isNaN(D.m)||(M+="M"),M}(c);return p.length>0&&(o+=" "+p),c.isEmpty()?o+" "+bs:o+" ("+u(c)+")"}var qr=function(){return l(function c(o){n(this,c),this.geometryFactory=o||new ni,this.precisionModel=this.geometryFactory.getPrecisionModel()},[{key:"read",value:function(c){var o=new sn(c);return new qe(o,this.geometryFactory).parse()}},{key:"write",value:function(c){return tr(c)}}])}(),br=function(){return l(function c(o){n(this,c),this.parser=new qr(o)},[{key:"write",value:function(c){return this.parser.write(c)}}],[{key:"toLineString",value:function(c,o){if(arguments.length!==2)throw new Error("Not implemented");return"LINESTRING ( "+c.x+" "+c.y+", "+o.x+" "+o.y+" )"}}])}(),_e=function(){function c(){n(this,c),c.constructor_.apply(this,arguments)}return l(c,[{key:"getIndexAlongSegment",value:function(o,u){return this.computeIntLineIndex(),this._intLineIndex[o][u]}},{key:"getTopologySummary",value:function(){var o=new Gr;return this.isEndPoint()&&o.append(" endpoint"),this._isProper&&o.append(" proper"),this.isCollinear()&&o.append(" collinear"),o.toString()}},{key:"computeIntersection",value:function(o,u,p,x){this._inputLines[0][0]=o,this._inputLines[0][1]=u,this._inputLines[1][0]=p,this._inputLines[1][1]=x,this._result=this.computeIntersect(o,u,p,x)}},{key:"getIntersectionNum",value:function(){return this._result}},{key:"computeIntLineIndex",value:function(){if(arguments.length===0)this._intLineIndex===null&&(this._intLineIndex=Array(2).fill().map(function(){return Array(2)}),this.computeIntLineIndex(0),this.computeIntLineIndex(1));else if(arguments.length===1){var o=arguments[0];this.getEdgeDistance(o,0)>this.getEdgeDistance(o,1)?(this._intLineIndex[o][0]=0,this._intLineIndex[o][1]=1):(this._intLineIndex[o][0]=1,this._intLineIndex[o][1]=0)}}},{key:"isProper",value:function(){return this.hasIntersection()&&this._isProper}},{key:"setPrecisionModel",value:function(o){this._precisionModel=o}},{key:"isInteriorIntersection",value:function(){if(arguments.length===0)return!!this.isInteriorIntersection(0)||!!this.isInteriorIntersection(1);if(arguments.length===1){for(var o=arguments[0],u=0;u<this._result;u++)if(!this._intPt[u].equals2D(this._inputLines[o][0])&&!this._intPt[u].equals2D(this._inputLines[o][1]))return!0;return!1}}},{key:"getIntersection",value:function(o){return this._intPt[o]}},{key:"isEndPoint",value:function(){return this.hasIntersection()&&!this._isProper}},{key:"hasIntersection",value:function(){return this._result!==c.NO_INTERSECTION}},{key:"getEdgeDistance",value:function(o,u){return c.computeEdgeDistance(this._intPt[u],this._inputLines[o][0],this._inputLines[o][1])}},{key:"isCollinear",value:function(){return this._result===c.COLLINEAR_INTERSECTION}},{key:"toString",value:function(){return br.toLineString(this._inputLines[0][0],this._inputLines[0][1])+" - "+br.toLineString(this._inputLines[1][0],this._inputLines[1][1])+this.getTopologySummary()}},{key:"getEndpoint",value:function(o,u){return this._inputLines[o][u]}},{key:"isIntersection",value:function(o){for(var u=0;u<this._result;u++)if(this._intPt[u].equals2D(o))return!0;return!1}},{key:"getIntersectionAlongSegment",value:function(o,u){return this.computeIntLineIndex(),this._intPt[this._intLineIndex[o][u]]}}],[{key:"constructor_",value:function(){this._result=null,this._inputLines=Array(2).fill().map(function(){return Array(2)}),this._intPt=new Array(2).fill(null),this._intLineIndex=null,this._isProper=null,this._pa=null,this._pb=null,this._precisionModel=null,this._intPt[0]=new at,this._intPt[1]=new at,this._pa=this._intPt[0],this._pb=this._intPt[1],this._result=0}},{key:"computeEdgeDistance",value:function(o,u,p){var x=Math.abs(p.x-u.x),M=Math.abs(p.y-u.y),D=-1;if(o.equals(u))D=0;else if(o.equals(p))D=x>M?x:M;else{var Z=Math.abs(o.x-u.x),Q=Math.abs(o.y-u.y);(D=x>M?Z:Q)!==0||o.equals(u)||(D=Math.max(Z,Q))}return lt.isTrue(!(D===0&&!o.equals(u)),"Bad distance calculation"),D}},{key:"nonRobustComputeEdgeDistance",value:function(o,u,p){var x=o.x-u.x,M=o.y-u.y,D=Math.sqrt(x*x+M*M);return lt.isTrue(!(D===0&&!o.equals(u)),"Invalid distance calculation"),D}}])}();_e.DONT_INTERSECT=0,_e.DO_INTERSECT=1,_e.COLLINEAR=2,_e.NO_INTERSECTION=0,_e.POINT_INTERSECTION=1,_e.COLLINEAR_INTERSECTION=2;var _i=function(c){function o(){return n(this,o),i(this,o)}return m(o,c),l(o,[{key:"isInSegmentEnvelopes",value:function(u){var p=new xt(this._inputLines[0][0],this._inputLines[0][1]),x=new xt(this._inputLines[1][0],this._inputLines[1][1]);return p.contains(u)&&x.contains(u)}},{key:"computeIntersection",value:function(){if(arguments.length!==3)return w(o,"computeIntersection",this,1).apply(this,arguments);var u=arguments[0],p=arguments[1],x=arguments[2];if(this._isProper=!1,xt.intersects(p,x,u)&&Ut.index(p,x,u)===0&&Ut.index(x,p,u)===0)return this._isProper=!0,(u.equals(p)||u.equals(x))&&(this._isProper=!1),this._result=_e.POINT_INTERSECTION,null;this._result=_e.NO_INTERSECTION}},{key:"intersection",value:function(u,p,x,M){var D=this.intersectionSafe(u,p,x,M);return this.isInSegmentEnvelopes(D)||(D=new at(o.nearestEndpoint(u,p,x,M))),this._precisionModel!==null&&this._precisionModel.makePrecise(D),D}},{key:"checkDD",value:function(u,p,x,M,D){var Z=be.intersection(u,p,x,M),Q=this.isInSegmentEnvelopes(Z);ze.out.println("DD in env = "+Q+"  --------------------- "+Z),D.distance(Z)>1e-4&&ze.out.println("Distance = "+D.distance(Z))}},{key:"intersectionSafe",value:function(u,p,x,M){var D=zn.intersection(u,p,x,M);return D===null&&(D=o.nearestEndpoint(u,p,x,M)),D}},{key:"computeCollinearIntersection",value:function(u,p,x,M){var D=xt.intersects(u,p,x),Z=xt.intersects(u,p,M),Q=xt.intersects(x,M,u),rt=xt.intersects(x,M,p);return D&&Z?(this._intPt[0]=x,this._intPt[1]=M,_e.COLLINEAR_INTERSECTION):Q&&rt?(this._intPt[0]=u,this._intPt[1]=p,_e.COLLINEAR_INTERSECTION):D&&Q?(this._intPt[0]=x,this._intPt[1]=u,!x.equals(u)||Z||rt?_e.COLLINEAR_INTERSECTION:_e.POINT_INTERSECTION):D&&rt?(this._intPt[0]=x,this._intPt[1]=p,!x.equals(p)||Z||Q?_e.COLLINEAR_INTERSECTION:_e.POINT_INTERSECTION):Z&&Q?(this._intPt[0]=M,this._intPt[1]=u,!M.equals(u)||D||rt?_e.COLLINEAR_INTERSECTION:_e.POINT_INTERSECTION):Z&&rt?(this._intPt[0]=M,this._intPt[1]=p,!M.equals(p)||D||Q?_e.COLLINEAR_INTERSECTION:_e.POINT_INTERSECTION):_e.NO_INTERSECTION}},{key:"computeIntersect",value:function(u,p,x,M){if(this._isProper=!1,!xt.intersects(u,p,x,M))return _e.NO_INTERSECTION;var D=Ut.index(u,p,x),Z=Ut.index(u,p,M);if(D>0&&Z>0||D<0&&Z<0)return _e.NO_INTERSECTION;var Q=Ut.index(x,M,u),rt=Ut.index(x,M,p);return Q>0&&rt>0||Q<0&&rt<0?_e.NO_INTERSECTION:D===0&&Z===0&&Q===0&&rt===0?this.computeCollinearIntersection(u,p,x,M):(D===0||Z===0||Q===0||rt===0?(this._isProper=!1,u.equals2D(x)||u.equals2D(M)?this._intPt[0]=u:p.equals2D(x)||p.equals2D(M)?this._intPt[0]=p:D===0?this._intPt[0]=new at(x):Z===0?this._intPt[0]=new at(M):Q===0?this._intPt[0]=new at(u):rt===0&&(this._intPt[0]=new at(p))):(this._isProper=!0,this._intPt[0]=this.intersection(u,p,x,M)),_e.POINT_INTERSECTION)}}],[{key:"nearestEndpoint",value:function(u,p,x,M){var D=u,Z=Ue.pointToSegment(u,x,M),Q=Ue.pointToSegment(p,x,M);return Q<Z&&(Z=Q,D=p),(Q=Ue.pointToSegment(x,u,p))<Z&&(Z=Q,D=x),(Q=Ue.pointToSegment(M,u,p))<Z&&(Z=Q,D=M),D}}])}(_e),Oi=function(){function c(){n(this,c),c.constructor_.apply(this,arguments)}return l(c,[{key:"countSegment",value:function(o,u){if(o.x<this._p.x&&u.x<this._p.x)return null;if(this._p.x===u.x&&this._p.y===u.y)return this._isPointOnSegment=!0,null;if(o.y===this._p.y&&u.y===this._p.y){var p=o.x,x=u.x;return p>x&&(p=u.x,x=o.x),this._p.x>=p&&this._p.x<=x&&(this._isPointOnSegment=!0),null}if(o.y>this._p.y&&u.y<=this._p.y||u.y>this._p.y&&o.y<=this._p.y){var M=Ut.index(o,u,this._p);if(M===Ut.COLLINEAR)return this._isPointOnSegment=!0,null;u.y<o.y&&(M=-M),M===Ut.LEFT&&this._crossingCount++}}},{key:"isPointInPolygon",value:function(){return this.getLocation()!==tt.EXTERIOR}},{key:"getLocation",value:function(){return this._isPointOnSegment?tt.BOUNDARY:this._crossingCount%2==1?tt.INTERIOR:tt.EXTERIOR}},{key:"isOnSegment",value:function(){return this._isPointOnSegment}}],[{key:"constructor_",value:function(){this._p=null,this._crossingCount=0,this._isPointOnSegment=!1;var o=arguments[0];this._p=o}},{key:"locatePointInRing",value:function(){if(arguments[0]instanceof at&&St(arguments[1],Xt)){for(var o=arguments[1],u=new c(arguments[0]),p=new at,x=new at,M=1;M<o.size();M++)if(o.getCoordinate(M,p),o.getCoordinate(M-1,x),u.countSegment(p,x),u.isOnSegment())return u.getLocation();return u.getLocation()}if(arguments[0]instanceof at&&arguments[1]instanceof Array){for(var D=arguments[1],Z=new c(arguments[0]),Q=1;Q<D.length;Q++){var rt=D[Q],dt=D[Q-1];if(Z.countSegment(rt,dt),Z.isOnSegment())return Z.getLocation()}return Z.getLocation()}}}])}(),Er=function(){function c(){n(this,c)}return l(c,null,[{key:"isOnLine",value:function(){if(arguments[0]instanceof at&&St(arguments[1],Xt)){for(var o=arguments[0],u=arguments[1],p=new _i,x=new at,M=new at,D=u.size(),Z=1;Z<D;Z++)if(u.getCoordinate(Z-1,x),u.getCoordinate(Z,M),p.computeIntersection(o,x,M),p.hasIntersection())return!0;return!1}if(arguments[0]instanceof at&&arguments[1]instanceof Array){for(var Q=arguments[0],rt=arguments[1],dt=new _i,gt=1;gt<rt.length;gt++){var Tt=rt[gt-1],Ot=rt[gt];if(dt.computeIntersection(Q,Tt,Ot),dt.hasIntersection())return!0}return!1}}},{key:"locateInRing",value:function(o,u){return Oi.locatePointInRing(o,u)}},{key:"isInRing",value:function(o,u){return c.locateInRing(o,u)!==tt.EXTERIOR}}])}(),Cn=function(){function c(){n(this,c),c.constructor_.apply(this,arguments)}return l(c,[{key:"setAllLocations",value:function(o){for(var u=0;u<this.location.length;u++)this.location[u]=o}},{key:"isNull",value:function(){for(var o=0;o<this.location.length;o++)if(this.location[o]!==tt.NONE)return!1;return!0}},{key:"setAllLocationsIfNull",value:function(o){for(var u=0;u<this.location.length;u++)this.location[u]===tt.NONE&&(this.location[u]=o)}},{key:"isLine",value:function(){return this.location.length===1}},{key:"merge",value:function(o){if(o.location.length>this.location.length){var u=new Array(3).fill(null);u[st.ON]=this.location[st.ON],u[st.LEFT]=tt.NONE,u[st.RIGHT]=tt.NONE,this.location=u}for(var p=0;p<this.location.length;p++)this.location[p]===tt.NONE&&p<o.location.length&&(this.location[p]=o.location[p])}},{key:"getLocations",value:function(){return this.location}},{key:"flip",value:function(){if(this.location.length<=1)return null;var o=this.location[st.LEFT];this.location[st.LEFT]=this.location[st.RIGHT],this.location[st.RIGHT]=o}},{key:"toString",value:function(){var o=new Ct;return this.location.length>1&&o.append(tt.toLocationSymbol(this.location[st.LEFT])),o.append(tt.toLocationSymbol(this.location[st.ON])),this.location.length>1&&o.append(tt.toLocationSymbol(this.location[st.RIGHT])),o.toString()}},{key:"setLocations",value:function(o,u,p){this.location[st.ON]=o,this.location[st.LEFT]=u,this.location[st.RIGHT]=p}},{key:"get",value:function(o){return o<this.location.length?this.location[o]:tt.NONE}},{key:"isArea",value:function(){return this.location.length>1}},{key:"isAnyNull",value:function(){for(var o=0;o<this.location.length;o++)if(this.location[o]===tt.NONE)return!0;return!1}},{key:"setLocation",value:function(){if(arguments.length===1){var o=arguments[0];this.setLocation(st.ON,o)}else if(arguments.length===2){var u=arguments[0],p=arguments[1];this.location[u]=p}}},{key:"init",value:function(o){this.location=new Array(o).fill(null),this.setAllLocations(tt.NONE)}},{key:"isEqualOnSide",value:function(o,u){return this.location[u]===o.location[u]}},{key:"allPositionsEqual",value:function(o){for(var u=0;u<this.location.length;u++)if(this.location[u]!==o)return!1;return!0}}],[{key:"constructor_",value:function(){if(this.location=null,arguments.length===1){if(arguments[0]instanceof Array){var o=arguments[0];this.init(o.length)}else if(Number.isInteger(arguments[0])){var u=arguments[0];this.init(1),this.location[st.ON]=u}else if(arguments[0]instanceof c){var p=arguments[0];if(this.init(p.location.length),p!==null)for(var x=0;x<this.location.length;x++)this.location[x]=p.location[x]}}else if(arguments.length===3){var M=arguments[0],D=arguments[1],Z=arguments[2];this.init(3),this.location[st.ON]=M,this.location[st.LEFT]=D,this.location[st.RIGHT]=Z}}}])}(),kn=function(){function c(){n(this,c),c.constructor_.apply(this,arguments)}return l(c,[{key:"getGeometryCount",value:function(){var o=0;return this.elt[0].isNull()||o++,this.elt[1].isNull()||o++,o}},{key:"setAllLocations",value:function(o,u){this.elt[o].setAllLocations(u)}},{key:"isNull",value:function(o){return this.elt[o].isNull()}},{key:"setAllLocationsIfNull",value:function(){if(arguments.length===1){var o=arguments[0];this.setAllLocationsIfNull(0,o),this.setAllLocationsIfNull(1,o)}else if(arguments.length===2){var u=arguments[0],p=arguments[1];this.elt[u].setAllLocationsIfNull(p)}}},{key:"isLine",value:function(o){return this.elt[o].isLine()}},{key:"merge",value:function(o){for(var u=0;u<2;u++)this.elt[u]===null&&o.elt[u]!==null?this.elt[u]=new Cn(o.elt[u]):this.elt[u].merge(o.elt[u])}},{key:"flip",value:function(){this.elt[0].flip(),this.elt[1].flip()}},{key:"getLocation",value:function(){if(arguments.length===1){var o=arguments[0];return this.elt[o].get(st.ON)}if(arguments.length===2){var u=arguments[0],p=arguments[1];return this.elt[u].get(p)}}},{key:"toString",value:function(){var o=new Ct;return this.elt[0]!==null&&(o.append("A:"),o.append(this.elt[0].toString())),this.elt[1]!==null&&(o.append(" B:"),o.append(this.elt[1].toString())),o.toString()}},{key:"isArea",value:function(){if(arguments.length===0)return this.elt[0].isArea()||this.elt[1].isArea();if(arguments.length===1){var o=arguments[0];return this.elt[o].isArea()}}},{key:"isAnyNull",value:function(o){return this.elt[o].isAnyNull()}},{key:"setLocation",value:function(){if(arguments.length===2){var o=arguments[0],u=arguments[1];this.elt[o].setLocation(st.ON,u)}else if(arguments.length===3){var p=arguments[0],x=arguments[1],M=arguments[2];this.elt[p].setLocation(x,M)}}},{key:"isEqualOnSide",value:function(o,u){return this.elt[0].isEqualOnSide(o.elt[0],u)&&this.elt[1].isEqualOnSide(o.elt[1],u)}},{key:"allPositionsEqual",value:function(o,u){return this.elt[o].allPositionsEqual(u)}},{key:"toLine",value:function(o){this.elt[o].isArea()&&(this.elt[o]=new Cn(this.elt[o].location[0]))}}],[{key:"constructor_",value:function(){if(this.elt=new Array(2).fill(null),arguments.length===1){if(Number.isInteger(arguments[0])){var o=arguments[0];this.elt[0]=new Cn(o),this.elt[1]=new Cn(o)}else if(arguments[0]instanceof c){var u=arguments[0];this.elt[0]=new Cn(u.elt[0]),this.elt[1]=new Cn(u.elt[1])}}else if(arguments.length===2){var p=arguments[0],x=arguments[1];this.elt[0]=new Cn(tt.NONE),this.elt[1]=new Cn(tt.NONE),this.elt[p].setLocation(x)}else if(arguments.length===3){var M=arguments[0],D=arguments[1],Z=arguments[2];this.elt[0]=new Cn(M,D,Z),this.elt[1]=new Cn(M,D,Z)}else if(arguments.length===4){var Q=arguments[0],rt=arguments[1],dt=arguments[2],gt=arguments[3];this.elt[0]=new Cn(tt.NONE,tt.NONE,tt.NONE),this.elt[1]=new Cn(tt.NONE,tt.NONE,tt.NONE),this.elt[Q].setLocations(rt,dt,gt)}}},{key:"toLineLabel",value:function(o){for(var u=new c(tt.NONE),p=0;p<2;p++)u.setLocation(p,o.getLocation(p));return u}}])}(),ks=function(){return l(function c(){n(this,c),c.constructor_.apply(this,arguments)},[{key:"computeRing",value:function(){if(this._ring!==null)return null;for(var c=new Array(this._pts.size()).fill(null),o=0;o<this._pts.size();o++)c[o]=this._pts.get(o);this._ring=this._geometryFactory.createLinearRing(c),this._isHole=Ut.isCCW(this._ring.getCoordinates())}},{key:"isIsolated",value:function(){return this._label.getGeometryCount()===1}},{key:"computePoints",value:function(c){this._startDe=c;var o=c,u=!0;do{if(o===null)throw new le("Found null DirectedEdge");if(o.getEdgeRing()===this)throw new le("Directed Edge visited twice during ring-building at "+o.getCoordinate());this._edges.add(o);var p=o.getLabel();lt.isTrue(p.isArea()),this.mergeLabel(p),this.addPoints(o.getEdge(),o.isForward(),u),u=!1,this.setEdgeRing(o,this),o=this.getNext(o)}while(o!==this._startDe)}},{key:"getLinearRing",value:function(){return this._ring}},{key:"getCoordinate",value:function(c){return this._pts.get(c)}},{key:"computeMaxNodeDegree",value:function(){this._maxNodeDegree=0;var c=this._startDe;do{var o=c.getNode().getEdges().getOutgoingDegree(this);o>this._maxNodeDegree&&(this._maxNodeDegree=o),c=this.getNext(c)}while(c!==this._startDe);this._maxNodeDegree*=2}},{key:"addPoints",value:function(c,o,u){var p=c.getCoordinates();if(o){var x=1;u&&(x=0);for(var M=x;M<p.length;M++)this._pts.add(p[M])}else{var D=p.length-2;u&&(D=p.length-1);for(var Z=D;Z>=0;Z--)this._pts.add(p[Z])}}},{key:"isHole",value:function(){return this._isHole}},{key:"setInResult",value:function(){var c=this._startDe;do c.getEdge().setInResult(!0),c=c.getNext();while(c!==this._startDe)}},{key:"containsPoint",value:function(c){var o=this.getLinearRing();if(!o.getEnvelopeInternal().contains(c)||!Er.isInRing(c,o.getCoordinates()))return!1;for(var u=this._holes.iterator();u.hasNext();)if(u.next().containsPoint(c))return!1;return!0}},{key:"addHole",value:function(c){this._holes.add(c)}},{key:"isShell",value:function(){return this._shell===null}},{key:"getLabel",value:function(){return this._label}},{key:"getEdges",value:function(){return this._edges}},{key:"getMaxNodeDegree",value:function(){return this._maxNodeDegree<0&&this.computeMaxNodeDegree(),this._maxNodeDegree}},{key:"getShell",value:function(){return this._shell}},{key:"mergeLabel",value:function(){if(arguments.length===1){var c=arguments[0];this.mergeLabel(c,0),this.mergeLabel(c,1)}else if(arguments.length===2){var o=arguments[1],u=arguments[0].getLocation(o,st.RIGHT);if(u===tt.NONE)return null;if(this._label.getLocation(o)===tt.NONE)return this._label.setLocation(o,u),null}}},{key:"setShell",value:function(c){this._shell=c,c!==null&&c.addHole(this)}},{key:"toPolygon",value:function(c){for(var o=new Array(this._holes.size()).fill(null),u=0;u<this._holes.size();u++)o[u]=this._holes.get(u).getLinearRing();return c.createPolygon(this.getLinearRing(),o)}}],[{key:"constructor_",value:function(){if(this._startDe=null,this._maxNodeDegree=-1,this._edges=new Ft,this._pts=new Ft,this._label=new kn(tt.NONE),this._ring=null,this._isHole=null,this._shell=null,this._holes=new Ft,this._geometryFactory=null,arguments.length!==0){if(arguments.length===2){var c=arguments[0],o=arguments[1];this._geometryFactory=o,this.computePoints(c),this.computeRing()}}}}])}(),te=function(c){function o(){var u;return n(this,o),u=i(this,o),o.constructor_.apply(u,arguments),u}return m(o,c),l(o,[{key:"setEdgeRing",value:function(u,p){u.setMinEdgeRing(p)}},{key:"getNext",value:function(u){return u.getNextMin()}}],[{key:"constructor_",value:function(){var u=arguments[0],p=arguments[1];ks.constructor_.call(this,u,p)}}])}(ks),ri=function(c){function o(){var u;return n(this,o),u=i(this,o),o.constructor_.apply(u,arguments),u}return m(o,c),l(o,[{key:"buildMinimalRings",value:function(){var u=new Ft,p=this._startDe;do{if(p.getMinEdgeRing()===null){var x=new te(p,this._geometryFactory);u.add(x)}p=p.getNext()}while(p!==this._startDe);return u}},{key:"setEdgeRing",value:function(u,p){u.setEdgeRing(p)}},{key:"linkDirectedEdgesForMinimalEdgeRings",value:function(){var u=this._startDe;do u.getNode().getEdges().linkMinimalDirectedEdges(this),u=u.getNext();while(u!==this._startDe)}},{key:"getNext",value:function(u){return u.getNext()}}],[{key:"constructor_",value:function(){var u=arguments[0],p=arguments[1];ks.constructor_.call(this,u,p)}}])}(ks),Le=function(){return l(function c(){n(this,c),c.constructor_.apply(this,arguments)},[{key:"setVisited",value:function(c){this._isVisited=c}},{key:"setInResult",value:function(c){this._isInResult=c}},{key:"isCovered",value:function(){return this._isCovered}},{key:"isCoveredSet",value:function(){return this._isCoveredSet}},{key:"setLabel",value:function(c){this._label=c}},{key:"getLabel",value:function(){return this._label}},{key:"setCovered",value:function(c){this._isCovered=c,this._isCoveredSet=!0}},{key:"updateIM",value:function(c){lt.isTrue(this._label.getGeometryCount()>=2,"found partial label"),this.computeIM(c)}},{key:"isInResult",value:function(){return this._isInResult}},{key:"isVisited",value:function(){return this._isVisited}}],[{key:"constructor_",value:function(){if(this._label=null,this._isInResult=!1,this._isCovered=!1,this._isCoveredSet=!1,this._isVisited=!1,arguments.length!==0){if(arguments.length===1){var c=arguments[0];this._label=c}}}}])}(),Zr=function(c){function o(){var u;return n(this,o),u=i(this,o),o.constructor_.apply(u,arguments),u}return m(o,c),l(o,[{key:"isIncidentEdgeInResult",value:function(){for(var u=this.getEdges().getEdges().iterator();u.hasNext();)if(u.next().getEdge().isInResult())return!0;return!1}},{key:"isIsolated",value:function(){return this._label.getGeometryCount()===1}},{key:"getCoordinate",value:function(){return this._coord}},{key:"print",value:function(u){u.println("node "+this._coord+" lbl: "+this._label)}},{key:"computeIM",value:function(u){}},{key:"computeMergedLocation",value:function(u,p){var x=tt.NONE;if(x=this._label.getLocation(p),!u.isNull(p)){var M=u.getLocation(p);x!==tt.BOUNDARY&&(x=M)}return x}},{key:"setLabel",value:function(){if(arguments.length!==2||!Number.isInteger(arguments[1])||!Number.isInteger(arguments[0]))return w(o,"setLabel",this,1).apply(this,arguments);var u=arguments[0],p=arguments[1];this._label===null?this._label=new kn(u,p):this._label.setLocation(u,p)}},{key:"getEdges",value:function(){return this._edges}},{key:"mergeLabel",value:function(){if(arguments[0]instanceof o){var u=arguments[0];this.mergeLabel(u._label)}else if(arguments[0]instanceof kn)for(var p=arguments[0],x=0;x<2;x++){var M=this.computeMergedLocation(p,x);this._label.getLocation(x)===tt.NONE&&this._label.setLocation(x,M)}}},{key:"add",value:function(u){this._edges.insert(u),u.setNode(this)}},{key:"setLabelBoundary",value:function(u){if(this._label===null)return null;var p=tt.NONE;this._label!==null&&(p=this._label.getLocation(u));var x=null;switch(p){case tt.BOUNDARY:x=tt.INTERIOR;break;case tt.INTERIOR:default:x=tt.BOUNDARY}this._label.setLocation(u,x)}}],[{key:"constructor_",value:function(){this._coord=null,this._edges=null;var u=arguments[0],p=arguments[1];this._coord=u,this._edges=p,this._label=new kn(0,tt.NONE)}}])}(Le),Hr=function(c){function o(){return n(this,o),i(this,o,arguments)}return m(o,c),l(o)}(Wo);function Ms(c){return c==null?0:c.color}function de(c){return c==null?null:c.parent}function un(c,o){c!==null&&(c.color=o)}function Yr(c){return c==null?null:c.left}function er(c){return c==null?null:c.right}var Be=function(c){function o(){var u;return n(this,o),(u=i(this,o)).root_=null,u.size_=0,u}return m(o,c),l(o,[{key:"get",value:function(u){for(var p=this.root_;p!==null;){var x=u.compareTo(p.key);if(x<0)p=p.left;else{if(!(x>0))return p.value;p=p.right}}return null}},{key:"put",value:function(u,p){if(this.root_===null)return this.root_={key:u,value:p,left:null,right:null,parent:null,color:0,getValue:function(){return this.value},getKey:function(){return this.key}},this.size_=1,null;var x,M,D=this.root_;do if(x=D,(M=u.compareTo(D.key))<0)D=D.left;else{if(!(M>0)){var Z=D.value;return D.value=p,Z}D=D.right}while(D!==null);var Q={key:u,left:null,right:null,value:p,parent:x,color:0,getValue:function(){return this.value},getKey:function(){return this.key}};return M<0?x.left=Q:x.right=Q,this.fixAfterInsertion(Q),this.size_++,null}},{key:"fixAfterInsertion",value:function(u){var p;for(u.color=1;u!=null&&u!==this.root_&&u.parent.color===1;)de(u)===Yr(de(de(u)))?Ms(p=er(de(de(u))))===1?(un(de(u),0),un(p,0),un(de(de(u)),1),u=de(de(u))):(u===er(de(u))&&(u=de(u),this.rotateLeft(u)),un(de(u),0),un(de(de(u)),1),this.rotateRight(de(de(u)))):Ms(p=Yr(de(de(u))))===1?(un(de(u),0),un(p,0),un(de(de(u)),1),u=de(de(u))):(u===Yr(de(u))&&(u=de(u),this.rotateRight(u)),un(de(u),0),un(de(de(u)),1),this.rotateLeft(de(de(u))));this.root_.color=0}},{key:"values",value:function(){var u=new Ft,p=this.getFirstEntry();if(p!==null)for(u.add(p.value);(p=o.successor(p))!==null;)u.add(p.value);return u}},{key:"entrySet",value:function(){var u=new ot,p=this.getFirstEntry();if(p!==null)for(u.add(p);(p=o.successor(p))!==null;)u.add(p);return u}},{key:"rotateLeft",value:function(u){if(u!=null){var p=u.right;u.right=p.left,p.left!=null&&(p.left.parent=u),p.parent=u.parent,u.parent==null?this.root_=p:u.parent.left===u?u.parent.left=p:u.parent.right=p,p.left=u,u.parent=p}}},{key:"rotateRight",value:function(u){if(u!=null){var p=u.left;u.left=p.right,p.right!=null&&(p.right.parent=u),p.parent=u.parent,u.parent==null?this.root_=p:u.parent.right===u?u.parent.right=p:u.parent.left=p,p.right=u,u.parent=p}}},{key:"getFirstEntry",value:function(){var u=this.root_;if(u!=null)for(;u.left!=null;)u=u.left;return u}},{key:"size",value:function(){return this.size_}},{key:"containsKey",value:function(u){for(var p=this.root_;p!==null;){var x=u.compareTo(p.key);if(x<0)p=p.left;else{if(!(x>0))return!0;p=p.right}}return!1}}],[{key:"successor",value:function(u){var p;if(u===null)return null;if(u.right!==null){for(p=u.right;p.left!==null;)p=p.left;return p}p=u.parent;for(var x=u;p!==null&&x===p.right;)x=p,p=p.parent;return p}}])}(Hr),vi=function(){return l(function c(){n(this,c),c.constructor_.apply(this,arguments)},[{key:"find",value:function(c){return this.nodeMap.get(c)}},{key:"addNode",value:function(){if(arguments[0]instanceof at){var c=arguments[0],o=this.nodeMap.get(c);return o===null&&(o=this.nodeFact.createNode(c),this.nodeMap.put(c,o)),o}if(arguments[0]instanceof Zr){var u=arguments[0],p=this.nodeMap.get(u.getCoordinate());return p===null?(this.nodeMap.put(u.getCoordinate(),u),u):(p.mergeLabel(u),p)}}},{key:"print",value:function(c){for(var o=this.iterator();o.hasNext();)o.next().print(c)}},{key:"iterator",value:function(){return this.nodeMap.values().iterator()}},{key:"values",value:function(){return this.nodeMap.values()}},{key:"getBoundaryNodes",value:function(c){for(var o=new Ft,u=this.iterator();u.hasNext();){var p=u.next();p.getLabel().getLocation(c)===tt.BOUNDARY&&o.add(p)}return o}},{key:"add",value:function(c){var o=c.getCoordinate();this.addNode(o).add(c)}}],[{key:"constructor_",value:function(){this.nodeMap=new Be,this.nodeFact=null;var c=arguments[0];this.nodeFact=c}}])}(),ln=function(){function c(){n(this,c)}return l(c,null,[{key:"isNorthern",value:function(o){return o===c.NE||o===c.NW}},{key:"isOpposite",value:function(o,u){return o!==u&&(o-u+4)%4===2}},{key:"commonHalfPlane",value:function(o,u){if(o===u)return o;if((o-u+4)%4===2)return-1;var p=o<u?o:u;return p===0&&(o>u?o:u)===3?3:p}},{key:"isInHalfPlane",value:function(o,u){return u===c.SE?o===c.SE||o===c.SW:o===u||o===u+1}},{key:"quadrant",value:function(){if(typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var o=arguments[0],u=arguments[1];if(o===0&&u===0)throw new P("Cannot compute the quadrant for point ( "+o+", "+u+" )");return o>=0?u>=0?c.NE:c.SE:u>=0?c.NW:c.SW}if(arguments[0]instanceof at&&arguments[1]instanceof at){var p=arguments[0],x=arguments[1];if(x.x===p.x&&x.y===p.y)throw new P("Cannot compute the quadrant for two identical points "+p);return x.x>=p.x?x.y>=p.y?c.NE:c.SE:x.y>=p.y?c.NW:c.SW}}}])}();ln.NE=0,ln.NW=1,ln.SW=2,ln.SE=3;var fo=function(){function c(){n(this,c),c.constructor_.apply(this,arguments)}return l(c,[{key:"compareDirection",value:function(o){return this._dx===o._dx&&this._dy===o._dy?0:this._quadrant>o._quadrant?1:this._quadrant<o._quadrant?-1:Ut.index(o._p0,o._p1,this._p1)}},{key:"getDy",value:function(){return this._dy}},{key:"getCoordinate",value:function(){return this._p0}},{key:"setNode",value:function(o){this._node=o}},{key:"print",value:function(o){var u=Math.atan2(this._dy,this._dx),p=this.getClass().getName(),x=p.lastIndexOf("."),M=p.substring(x+1);o.print("  "+M+": "+this._p0+" - "+this._p1+" "+this._quadrant+":"+u+"   "+this._label)}},{key:"compareTo",value:function(o){var u=o;return this.compareDirection(u)}},{key:"getDirectedCoordinate",value:function(){return this._p1}},{key:"getDx",value:function(){return this._dx}},{key:"getLabel",value:function(){return this._label}},{key:"getEdge",value:function(){return this._edge}},{key:"getQuadrant",value:function(){return this._quadrant}},{key:"getNode",value:function(){return this._node}},{key:"toString",value:function(){var o=Math.atan2(this._dy,this._dx),u=this.getClass().getName(),p=u.lastIndexOf(".");return"  "+u.substring(p+1)+": "+this._p0+" - "+this._p1+" "+this._quadrant+":"+o+"   "+this._label}},{key:"computeLabel",value:function(o){}},{key:"init",value:function(o,u){this._p0=o,this._p1=u,this._dx=u.x-o.x,this._dy=u.y-o.y,this._quadrant=ln.quadrant(this._dx,this._dy),lt.isTrue(!(this._dx===0&&this._dy===0),"EdgeEnd with identical endpoints found")}},{key:"interfaces_",get:function(){return[U]}}],[{key:"constructor_",value:function(){if(this._edge=null,this._label=null,this._node=null,this._p0=null,this._p1=null,this._dx=null,this._dy=null,this._quadrant=null,arguments.length===1){var o=arguments[0];this._edge=o}else if(arguments.length===3){var u=arguments[0],p=arguments[1],x=arguments[2];c.constructor_.call(this,u,p,x,null)}else if(arguments.length===4){var M=arguments[0],D=arguments[1],Z=arguments[2],Q=arguments[3];c.constructor_.call(this,M),this.init(D,Z),this._label=Q}}}])}(),Ls=function(c){function o(){var u;return n(this,o),u=i(this,o),o.constructor_.apply(u,arguments),u}return m(o,c),l(o,[{key:"getNextMin",value:function(){return this._nextMin}},{key:"getDepth",value:function(u){return this._depth[u]}},{key:"setVisited",value:function(u){this._isVisited=u}},{key:"computeDirectedLabel",value:function(){this._label=new kn(this._edge.getLabel()),this._isForward||this._label.flip()}},{key:"getNext",value:function(){return this._next}},{key:"setDepth",value:function(u,p){if(this._depth[u]!==-999&&this._depth[u]!==p)throw new le("assigned depths do not match",this.getCoordinate());this._depth[u]=p}},{key:"isInteriorAreaEdge",value:function(){for(var u=!0,p=0;p<2;p++)this._label.isArea(p)&&this._label.getLocation(p,st.LEFT)===tt.INTERIOR&&this._label.getLocation(p,st.RIGHT)===tt.INTERIOR||(u=!1);return u}},{key:"setNextMin",value:function(u){this._nextMin=u}},{key:"print",value:function(u){w(o,"print",this,1).call(this,u),u.print(" "+this._depth[st.LEFT]+"/"+this._depth[st.RIGHT]),u.print(" ("+this.getDepthDelta()+")"),this._isInResult&&u.print(" inResult")}},{key:"setMinEdgeRing",value:function(u){this._minEdgeRing=u}},{key:"isLineEdge",value:function(){var u=this._label.isLine(0)||this._label.isLine(1),p=!this._label.isArea(0)||this._label.allPositionsEqual(0,tt.EXTERIOR),x=!this._label.isArea(1)||this._label.allPositionsEqual(1,tt.EXTERIOR);return u&&p&&x}},{key:"setEdgeRing",value:function(u){this._edgeRing=u}},{key:"getMinEdgeRing",value:function(){return this._minEdgeRing}},{key:"getDepthDelta",value:function(){var u=this._edge.getDepthDelta();return this._isForward||(u=-u),u}},{key:"setInResult",value:function(u){this._isInResult=u}},{key:"getSym",value:function(){return this._sym}},{key:"isForward",value:function(){return this._isForward}},{key:"getEdge",value:function(){return this._edge}},{key:"printEdge",value:function(u){this.print(u),u.print(" "),this._isForward?this._edge.print(u):this._edge.printReverse(u)}},{key:"setSym",value:function(u){this._sym=u}},{key:"setVisitedEdge",value:function(u){this.setVisited(u),this._sym.setVisited(u)}},{key:"setEdgeDepths",value:function(u,p){var x=this.getEdge().getDepthDelta();this._isForward||(x=-x);var M=1;u===st.LEFT&&(M=-1);var D=st.opposite(u),Z=p+x*M;this.setDepth(u,p),this.setDepth(D,Z)}},{key:"getEdgeRing",value:function(){return this._edgeRing}},{key:"isInResult",value:function(){return this._isInResult}},{key:"setNext",value:function(u){this._next=u}},{key:"isVisited",value:function(){return this._isVisited}}],[{key:"constructor_",value:function(){this._isForward=null,this._isInResult=!1,this._isVisited=!1,this._sym=null,this._next=null,this._nextMin=null,this._edgeRing=null,this._minEdgeRing=null,this._depth=[0,-999,-999];var u=arguments[0],p=arguments[1];if(fo.constructor_.call(this,u),this._isForward=p,p)this.init(u.getCoordinate(0),u.getCoordinate(1));else{var x=u.getNumPoints()-1;this.init(u.getCoordinate(x),u.getCoordinate(x-1))}this.computeDirectedLabel()}},{key:"depthFactor",value:function(u,p){return u===tt.EXTERIOR&&p===tt.INTERIOR?1:u===tt.INTERIOR&&p===tt.EXTERIOR?-1:0}}])}(fo),po=function(){return l(function c(){n(this,c)},[{key:"createNode",value:function(c){return new Zr(c,null)}}])}(),Ss=function(){return l(function c(){n(this,c),c.constructor_.apply(this,arguments)},[{key:"printEdges",value:function(c){c.println("Edges:");for(var o=0;o<this._edges.size();o++){c.println("edge "+o+":");var u=this._edges.get(o);u.print(c),u.eiList.print(c)}}},{key:"find",value:function(c){return this._nodes.find(c)}},{key:"addNode",value:function(){if(arguments[0]instanceof Zr){var c=arguments[0];return this._nodes.addNode(c)}if(arguments[0]instanceof at){var o=arguments[0];return this._nodes.addNode(o)}}},{key:"getNodeIterator",value:function(){return this._nodes.iterator()}},{key:"linkResultDirectedEdges",value:function(){for(var c=this._nodes.iterator();c.hasNext();)c.next().getEdges().linkResultDirectedEdges()}},{key:"debugPrintln",value:function(c){ze.out.println(c)}},{key:"isBoundaryNode",value:function(c,o){var u=this._nodes.find(o);if(u===null)return!1;var p=u.getLabel();return p!==null&&p.getLocation(c)===tt.BOUNDARY}},{key:"linkAllDirectedEdges",value:function(){for(var c=this._nodes.iterator();c.hasNext();)c.next().getEdges().linkAllDirectedEdges()}},{key:"matchInSameDirection",value:function(c,o,u,p){return!!c.equals(u)&&Ut.index(c,o,p)===Ut.COLLINEAR&&ln.quadrant(c,o)===ln.quadrant(u,p)}},{key:"getEdgeEnds",value:function(){return this._edgeEndList}},{key:"debugPrint",value:function(c){ze.out.print(c)}},{key:"getEdgeIterator",value:function(){return this._edges.iterator()}},{key:"findEdgeInSameDirection",value:function(c,o){for(var u=0;u<this._edges.size();u++){var p=this._edges.get(u),x=p.getCoordinates();if(this.matchInSameDirection(c,o,x[0],x[1])||this.matchInSameDirection(c,o,x[x.length-1],x[x.length-2]))return p}return null}},{key:"insertEdge",value:function(c){this._edges.add(c)}},{key:"findEdgeEnd",value:function(c){for(var o=this.getEdgeEnds().iterator();o.hasNext();){var u=o.next();if(u.getEdge()===c)return u}return null}},{key:"addEdges",value:function(c){for(var o=c.iterator();o.hasNext();){var u=o.next();this._edges.add(u);var p=new Ls(u,!0),x=new Ls(u,!1);p.setSym(x),x.setSym(p),this.add(p),this.add(x)}}},{key:"add",value:function(c){this._nodes.add(c),this._edgeEndList.add(c)}},{key:"getNodes",value:function(){return this._nodes.values()}},{key:"findEdge",value:function(c,o){for(var u=0;u<this._edges.size();u++){var p=this._edges.get(u),x=p.getCoordinates();if(c.equals(x[0])&&o.equals(x[1]))return p}return null}}],[{key:"constructor_",value:function(){if(this._edges=new Ft,this._nodes=null,this._edgeEndList=new Ft,arguments.length===0)this._nodes=new vi(new po);else if(arguments.length===1){var c=arguments[0];this._nodes=new vi(c)}}},{key:"linkResultDirectedEdges",value:function(c){for(var o=c.iterator();o.hasNext();)o.next().getEdges().linkResultDirectedEdges()}}])}(),ru=function(){function c(){n(this,c),c.constructor_.apply(this,arguments)}return l(c,[{key:"sortShellsAndHoles",value:function(o,u,p){for(var x=o.iterator();x.hasNext();){var M=x.next();M.isHole()?p.add(M):u.add(M)}}},{key:"computePolygons",value:function(o){for(var u=new Ft,p=o.iterator();p.hasNext();){var x=p.next().toPolygon(this._geometryFactory);u.add(x)}return u}},{key:"placeFreeHoles",value:function(o,u){for(var p=u.iterator();p.hasNext();){var x=p.next();if(x.getShell()===null){var M=c.findEdgeRingContaining(x,o);if(M===null)throw new le("unable to assign hole to a shell",x.getCoordinate(0));x.setShell(M)}}}},{key:"buildMinimalEdgeRings",value:function(o,u,p){for(var x=new Ft,M=o.iterator();M.hasNext();){var D=M.next();if(D.getMaxNodeDegree()>2){D.linkDirectedEdgesForMinimalEdgeRings();var Z=D.buildMinimalRings(),Q=this.findShell(Z);Q!==null?(this.placePolygonHoles(Q,Z),u.add(Q)):p.addAll(Z)}else x.add(D)}return x}},{key:"buildMaximalEdgeRings",value:function(o){for(var u=new Ft,p=o.iterator();p.hasNext();){var x=p.next();if(x.isInResult()&&x.getLabel().isArea()&&x.getEdgeRing()===null){var M=new ri(x,this._geometryFactory);u.add(M),M.setInResult()}}return u}},{key:"placePolygonHoles",value:function(o,u){for(var p=u.iterator();p.hasNext();){var x=p.next();x.isHole()&&x.setShell(o)}}},{key:"getPolygons",value:function(){return this.computePolygons(this._shellList)}},{key:"findShell",value:function(o){for(var u=0,p=null,x=o.iterator();x.hasNext();){var M=x.next();M.isHole()||(p=M,u++)}return lt.isTrue(u<=1,"found two shells in MinimalEdgeRing list"),p}},{key:"add",value:function(){if(arguments.length===1){var o=arguments[0];this.add(o.getEdgeEnds(),o.getNodes())}else if(arguments.length===2){var u=arguments[0],p=arguments[1];Ss.linkResultDirectedEdges(p);var x=this.buildMaximalEdgeRings(u),M=new Ft,D=this.buildMinimalEdgeRings(x,this._shellList,M);this.sortShellsAndHoles(D,this._shellList,M),this.placeFreeHoles(this._shellList,M)}}}],[{key:"constructor_",value:function(){this._geometryFactory=null,this._shellList=new Ft;var o=arguments[0];this._geometryFactory=o}},{key:"findEdgeRingContaining",value:function(o,u){for(var p=o.getLinearRing(),x=p.getEnvelopeInternal(),M=p.getCoordinateN(0),D=null,Z=null,Q=u.iterator();Q.hasNext();){var rt=Q.next(),dt=rt.getLinearRing(),gt=dt.getEnvelopeInternal();if(!gt.equals(x)&&gt.contains(x)){M=Ge.ptNotInList(p.getCoordinates(),dt.getCoordinates());var Tt=!1;Er.isInRing(M,dt.getCoordinates())&&(Tt=!0),Tt&&(D===null||Z.contains(gt))&&(Z=(D=rt).getLinearRing().getEnvelopeInternal())}}return D}}])}(),go=function(){return l(function c(){n(this,c)},[{key:"getBounds",value:function(){}}])}(),ee=function(){return l(function c(){n(this,c),c.constructor_.apply(this,arguments)},[{key:"getItem",value:function(){return this._item}},{key:"getBounds",value:function(){return this._bounds}},{key:"interfaces_",get:function(){return[go,O]}}],[{key:"constructor_",value:function(){this._bounds=null,this._item=null;var c=arguments[0],o=arguments[1];this._bounds=c,this._item=o}}])}(),Ts=function(){return l(function c(){n(this,c),c.constructor_.apply(this,arguments)},[{key:"poll",value:function(){if(this.isEmpty())return null;var c=this._items.get(1);return this._items.set(1,this._items.get(this._size)),this._size-=1,this.reorder(1),c}},{key:"size",value:function(){return this._size}},{key:"reorder",value:function(c){for(var o=null,u=this._items.get(c);2*c<=this._size&&((o=2*c)!==this._size&&this._items.get(o+1).compareTo(this._items.get(o))<0&&o++,this._items.get(o).compareTo(u)<0);c=o)this._items.set(c,this._items.get(o));this._items.set(c,u)}},{key:"clear",value:function(){this._size=0,this._items.clear()}},{key:"peek",value:function(){return this.isEmpty()?null:this._items.get(1)}},{key:"isEmpty",value:function(){return this._size===0}},{key:"add",value:function(c){this._items.add(null),this._size+=1;var o=this._size;for(this._items.set(0,c);c.compareTo(this._items.get(Math.trunc(o/2)))<0;o/=2)this._items.set(o,this._items.get(Math.trunc(o/2)));this._items.set(o,c)}}],[{key:"constructor_",value:function(){this._size=null,this._items=null,this._size=0,this._items=new Ft,this._items.add(null)}}])}(),An=function(){return l(function c(){n(this,c)},[{key:"insert",value:function(c,o){}},{key:"remove",value:function(c,o){}},{key:"query",value:function(){}}])}(),hn=function(){return l(function c(){n(this,c),c.constructor_.apply(this,arguments)},[{key:"getLevel",value:function(){return this._level}},{key:"size",value:function(){return this._childBoundables.size()}},{key:"getChildBoundables",value:function(){return this._childBoundables}},{key:"addChildBoundable",value:function(c){lt.isTrue(this._bounds===null),this._childBoundables.add(c)}},{key:"isEmpty",value:function(){return this._childBoundables.isEmpty()}},{key:"getBounds",value:function(){return this._bounds===null&&(this._bounds=this.computeBounds()),this._bounds}},{key:"interfaces_",get:function(){return[go,O]}}],[{key:"constructor_",value:function(){if(this._childBoundables=new Ft,this._bounds=null,this._level=null,arguments.length!==0){if(arguments.length===1){var c=arguments[0];this._level=c}}}}])}(),nr={reverseOrder:function(){return{compare:function(c,o){return o.compareTo(c)}}},min:function(c){return nr.sort(c),c.get(0)},sort:function(c,o){var u=c.toArray();o?an.sort(u,o):an.sort(u);for(var p=c.iterator(),x=0,M=u.length;x<M;x++)p.next(),p.set(u[x])},singletonList:function(c){var o=new Ft;return o.add(c),o}},su=function(){function c(){n(this,c)}return l(c,null,[{key:"maxDistance",value:function(o,u,p,x,M,D,Z,Q){var rt=c.distance(o,u,M,D);return rt=Math.max(rt,c.distance(o,u,Z,Q)),rt=Math.max(rt,c.distance(p,x,M,D)),rt=Math.max(rt,c.distance(p,x,Z,Q))}},{key:"distance",value:function(o,u,p,x){var M=p-o,D=x-u;return Math.sqrt(M*M+D*D)}},{key:"maximumDistance",value:function(o,u){var p=Math.min(o.getMinX(),u.getMinX()),x=Math.min(o.getMinY(),u.getMinY()),M=Math.max(o.getMaxX(),u.getMaxX()),D=Math.max(o.getMaxY(),u.getMaxY());return c.distance(p,x,M,D)}},{key:"minMaxDistance",value:function(o,u){var p=o.getMinX(),x=o.getMinY(),M=o.getMaxX(),D=o.getMaxY(),Z=u.getMinX(),Q=u.getMinY(),rt=u.getMaxX(),dt=u.getMaxY(),gt=c.maxDistance(p,x,p,D,Z,Q,Z,dt);return gt=Math.min(gt,c.maxDistance(p,x,p,D,Z,Q,rt,Q)),gt=Math.min(gt,c.maxDistance(p,x,p,D,rt,dt,Z,dt)),gt=Math.min(gt,c.maxDistance(p,x,p,D,rt,dt,rt,Q)),gt=Math.min(gt,c.maxDistance(p,x,M,x,Z,Q,Z,dt)),gt=Math.min(gt,c.maxDistance(p,x,M,x,Z,Q,rt,Q)),gt=Math.min(gt,c.maxDistance(p,x,M,x,rt,dt,Z,dt)),gt=Math.min(gt,c.maxDistance(p,x,M,x,rt,dt,rt,Q)),gt=Math.min(gt,c.maxDistance(M,D,p,D,Z,Q,Z,dt)),gt=Math.min(gt,c.maxDistance(M,D,p,D,Z,Q,rt,Q)),gt=Math.min(gt,c.maxDistance(M,D,p,D,rt,dt,Z,dt)),gt=Math.min(gt,c.maxDistance(M,D,p,D,rt,dt,rt,Q)),gt=Math.min(gt,c.maxDistance(M,D,M,x,Z,Q,Z,dt)),gt=Math.min(gt,c.maxDistance(M,D,M,x,Z,Q,rt,Q)),gt=Math.min(gt,c.maxDistance(M,D,M,x,rt,dt,Z,dt)),gt=Math.min(gt,c.maxDistance(M,D,M,x,rt,dt,rt,Q))}}])}(),Ri=function(){function c(){n(this,c),c.constructor_.apply(this,arguments)}return l(c,[{key:"maximumDistance",value:function(){return su.maximumDistance(this._boundable1.getBounds(),this._boundable2.getBounds())}},{key:"expandToQueue",value:function(o,u){var p=c.isComposite(this._boundable1),x=c.isComposite(this._boundable2);if(p&&x)return c.area(this._boundable1)>c.area(this._boundable2)?(this.expand(this._boundable1,this._boundable2,!1,o,u),null):(this.expand(this._boundable2,this._boundable1,!0,o,u),null);if(p)return this.expand(this._boundable1,this._boundable2,!1,o,u),null;if(x)return this.expand(this._boundable2,this._boundable1,!0,o,u),null;throw new P("neither boundable is composite")}},{key:"isLeaves",value:function(){return!(c.isComposite(this._boundable1)||c.isComposite(this._boundable2))}},{key:"compareTo",value:function(o){var u=o;return this._distance<u._distance?-1:this._distance>u._distance?1:0}},{key:"expand",value:function(o,u,p,x,M){for(var D=o.getChildBoundables().iterator();D.hasNext();){var Z=D.next(),Q=null;(Q=p?new c(u,Z,this._itemDistance):new c(Z,u,this._itemDistance)).getDistance()<M&&x.add(Q)}}},{key:"getBoundable",value:function(o){return o===0?this._boundable1:this._boundable2}},{key:"getDistance",value:function(){return this._distance}},{key:"distance",value:function(){return this.isLeaves()?this._itemDistance.distance(this._boundable1,this._boundable2):this._boundable1.getBounds().distance(this._boundable2.getBounds())}},{key:"interfaces_",get:function(){return[U]}}],[{key:"constructor_",value:function(){this._boundable1=null,this._boundable2=null,this._distance=null,this._itemDistance=null;var o=arguments[0],u=arguments[1],p=arguments[2];this._boundable1=o,this._boundable2=u,this._itemDistance=p,this._distance=this.distance()}},{key:"area",value:function(o){return o.getBounds().getArea()}},{key:"isComposite",value:function(o){return o instanceof hn}}])}(),$o=function(){return l(function c(){n(this,c)},[{key:"visitItem",value:function(c){}}])}(),ir=function(){function c(){n(this,c),c.constructor_.apply(this,arguments)}return l(c,[{key:"queryInternal",value:function(){if(St(arguments[2],$o)&&arguments[0]instanceof Object&&arguments[1]instanceof hn)for(var o=arguments[0],u=arguments[2],p=arguments[1].getChildBoundables(),x=0;x<p.size();x++){var M=p.get(x);this.getIntersectsOp().intersects(M.getBounds(),o)&&(M instanceof hn?this.queryInternal(o,M,u):M instanceof ee?u.visitItem(M.getItem()):lt.shouldNeverReachHere())}else if(St(arguments[2],yt)&&arguments[0]instanceof Object&&arguments[1]instanceof hn)for(var D=arguments[0],Z=arguments[2],Q=arguments[1].getChildBoundables(),rt=0;rt<Q.size();rt++){var dt=Q.get(rt);this.getIntersectsOp().intersects(dt.getBounds(),D)&&(dt instanceof hn?this.queryInternal(D,dt,Z):dt instanceof ee?Z.add(dt.getItem()):lt.shouldNeverReachHere())}}},{key:"getNodeCapacity",value:function(){return this._nodeCapacity}},{key:"lastNode",value:function(o){return o.get(o.size()-1)}},{key:"size",value:function(){if(arguments.length===0)return this.isEmpty()?0:(this.build(),this.size(this._root));if(arguments.length===1){for(var o=0,u=arguments[0].getChildBoundables().iterator();u.hasNext();){var p=u.next();p instanceof hn?o+=this.size(p):p instanceof ee&&(o+=1)}return o}}},{key:"removeItem",value:function(o,u){for(var p=null,x=o.getChildBoundables().iterator();x.hasNext();){var M=x.next();M instanceof ee&&M.getItem()===u&&(p=M)}return p!==null&&(o.getChildBoundables().remove(p),!0)}},{key:"itemsTree",value:function(){if(arguments.length===0){this.build();var o=this.itemsTree(this._root);return o===null?new Ft:o}if(arguments.length===1){for(var u=arguments[0],p=new Ft,x=u.getChildBoundables().iterator();x.hasNext();){var M=x.next();if(M instanceof hn){var D=this.itemsTree(M);D!==null&&p.add(D)}else M instanceof ee?p.add(M.getItem()):lt.shouldNeverReachHere()}return p.size()<=0?null:p}}},{key:"insert",value:function(o,u){lt.isTrue(!this._built,"Cannot insert items into an STR packed R-tree after it has been built."),this._itemBoundables.add(new ee(o,u))}},{key:"boundablesAtLevel",value:function(){if(arguments.length===1){var o=arguments[0],u=new Ft;return this.boundablesAtLevel(o,this._root,u),u}if(arguments.length===3){var p=arguments[0],x=arguments[1],M=arguments[2];if(lt.isTrue(p>-2),x.getLevel()===p)return M.add(x),null;for(var D=x.getChildBoundables().iterator();D.hasNext();){var Z=D.next();Z instanceof hn?this.boundablesAtLevel(p,Z,M):(lt.isTrue(Z instanceof ee),p===-1&&M.add(Z))}return null}}},{key:"query",value:function(){if(arguments.length===1){var o=arguments[0];this.build();var u=new Ft;return this.isEmpty()||this.getIntersectsOp().intersects(this._root.getBounds(),o)&&this.queryInternal(o,this._root,u),u}if(arguments.length===2){var p=arguments[0],x=arguments[1];if(this.build(),this.isEmpty())return null;this.getIntersectsOp().intersects(this._root.getBounds(),p)&&this.queryInternal(p,this._root,x)}}},{key:"build",value:function(){if(this._built)return null;this._root=this._itemBoundables.isEmpty()?this.createNode(0):this.createHigherLevels(this._itemBoundables,-1),this._itemBoundables=null,this._built=!0}},{key:"getRoot",value:function(){return this.build(),this._root}},{key:"remove",value:function(){if(arguments.length===2){var o=arguments[0],u=arguments[1];return this.build(),!!this.getIntersectsOp().intersects(this._root.getBounds(),o)&&this.remove(o,this._root,u)}if(arguments.length===3){var p=arguments[0],x=arguments[1],M=arguments[2],D=this.removeItem(x,M);if(D)return!0;for(var Z=null,Q=x.getChildBoundables().iterator();Q.hasNext();){var rt=Q.next();if(this.getIntersectsOp().intersects(rt.getBounds(),p)&&rt instanceof hn&&(D=this.remove(p,rt,M))){Z=rt;break}}return Z!==null&&Z.getChildBoundables().isEmpty()&&x.getChildBoundables().remove(Z),D}}},{key:"createHigherLevels",value:function(o,u){lt.isTrue(!o.isEmpty());var p=this.createParentBoundables(o,u+1);return p.size()===1?p.get(0):this.createHigherLevels(p,u+1)}},{key:"depth",value:function(){if(arguments.length===0)return this.isEmpty()?0:(this.build(),this.depth(this._root));if(arguments.length===1){for(var o=0,u=arguments[0].getChildBoundables().iterator();u.hasNext();){var p=u.next();if(p instanceof hn){var x=this.depth(p);x>o&&(o=x)}}return o+1}}},{key:"createParentBoundables",value:function(o,u){lt.isTrue(!o.isEmpty());var p=new Ft;p.add(this.createNode(u));var x=new Ft(o);nr.sort(x,this.getComparator());for(var M=x.iterator();M.hasNext();){var D=M.next();this.lastNode(p).getChildBoundables().size()===this.getNodeCapacity()&&p.add(this.createNode(u)),this.lastNode(p).addChildBoundable(D)}return p}},{key:"isEmpty",value:function(){return this._built?this._root.isEmpty():this._itemBoundables.isEmpty()}},{key:"interfaces_",get:function(){return[O]}}],[{key:"constructor_",value:function(){if(this._root=null,this._built=!1,this._itemBoundables=new Ft,this._nodeCapacity=null,arguments.length===0)c.constructor_.call(this,c.DEFAULT_NODE_CAPACITY);else if(arguments.length===1){var o=arguments[0];lt.isTrue(o>1,"Node capacity must be greater than 1"),this._nodeCapacity=o}}},{key:"compareDoubles",value:function(o,u){return o>u?1:o<u?-1:0}}])}();ir.IntersectsOp=function(){},ir.DEFAULT_NODE_CAPACITY=10;var Jo=function(){return l(function c(){n(this,c)},[{key:"distance",value:function(c,o){}}])}(),Fn=function(c){function o(){var u;return n(this,o),u=i(this,o),o.constructor_.apply(u,arguments),u}return m(o,c),l(o,[{key:"createParentBoundablesFromVerticalSlices",value:function(u,p){lt.isTrue(u.length>0);for(var x=new Ft,M=0;M<u.length;M++)x.addAll(this.createParentBoundablesFromVerticalSlice(u[M],p));return x}},{key:"nearestNeighbourK",value:function(){if(arguments.length===2){var u=arguments[0],p=arguments[1];return this.nearestNeighbourK(u,J.POSITIVE_INFINITY,p)}if(arguments.length===3){var x=arguments[0],M=arguments[2],D=arguments[1],Z=new Ts;Z.add(x);for(var Q=new Ts;!Z.isEmpty()&&D>=0;){var rt=Z.poll(),dt=rt.getDistance();if(dt>=D)break;rt.isLeaves()?Q.size()<M?Q.add(rt):(Q.peek().getDistance()>dt&&(Q.poll(),Q.add(rt)),D=Q.peek().getDistance()):rt.expandToQueue(Z,D)}return o.getItems(Q)}}},{key:"createNode",value:function(u){return new Ps(u)}},{key:"size",value:function(){return arguments.length===0?w(o,"size",this,1).call(this):w(o,"size",this,1).apply(this,arguments)}},{key:"insert",value:function(){if(!(arguments.length===2&&arguments[1]instanceof Object&&arguments[0]instanceof xt))return w(o,"insert",this,1).apply(this,arguments);var u=arguments[0],p=arguments[1];if(u.isNull())return null;w(o,"insert",this,1).call(this,u,p)}},{key:"getIntersectsOp",value:function(){return o.intersectsOp}},{key:"verticalSlices",value:function(u,p){for(var x=Math.trunc(Math.ceil(u.size()/p)),M=new Array(p).fill(null),D=u.iterator(),Z=0;Z<p;Z++){M[Z]=new Ft;for(var Q=0;D.hasNext()&&Q<x;){var rt=D.next();M[Z].add(rt),Q++}}return M}},{key:"query",value:function(){if(arguments.length===1){var u=arguments[0];return w(o,"query",this,1).call(this,u)}if(arguments.length===2){var p=arguments[0],x=arguments[1];w(o,"query",this,1).call(this,p,x)}}},{key:"getComparator",value:function(){return o.yComparator}},{key:"createParentBoundablesFromVerticalSlice",value:function(u,p){return w(o,"createParentBoundables",this,1).call(this,u,p)}},{key:"remove",value:function(){if(arguments.length===2&&arguments[1]instanceof Object&&arguments[0]instanceof xt){var u=arguments[0],p=arguments[1];return w(o,"remove",this,1).call(this,u,p)}return w(o,"remove",this,1).apply(this,arguments)}},{key:"depth",value:function(){return arguments.length===0?w(o,"depth",this,1).call(this):w(o,"depth",this,1).apply(this,arguments)}},{key:"createParentBoundables",value:function(u,p){lt.isTrue(!u.isEmpty());var x=Math.trunc(Math.ceil(u.size()/this.getNodeCapacity())),M=new Ft(u);nr.sort(M,o.xComparator);var D=this.verticalSlices(M,Math.trunc(Math.ceil(Math.sqrt(x))));return this.createParentBoundablesFromVerticalSlices(D,p)}},{key:"nearestNeighbour",value:function(){if(arguments.length===1){if(St(arguments[0],Jo)){var u=arguments[0];if(this.isEmpty())return null;var p=new Ri(this.getRoot(),this.getRoot(),u);return this.nearestNeighbour(p)}if(arguments[0]instanceof Ri){var x=arguments[0],M=J.POSITIVE_INFINITY,D=null,Z=new Ts;for(Z.add(x);!Z.isEmpty()&&M>0;){var Q=Z.poll(),rt=Q.getDistance();if(rt>=M)break;Q.isLeaves()?(M=rt,D=Q):Q.expandToQueue(Z,M)}return D===null?null:[D.getBoundable(0).getItem(),D.getBoundable(1).getItem()]}}else{if(arguments.length===2){var dt=arguments[0],gt=arguments[1];if(this.isEmpty()||dt.isEmpty())return null;var Tt=new Ri(this.getRoot(),dt.getRoot(),gt);return this.nearestNeighbour(Tt)}if(arguments.length===3){var Ot=arguments[2],zt=new ee(arguments[0],arguments[1]),qt=new Ri(this.getRoot(),zt,Ot);return this.nearestNeighbour(qt)[0]}if(arguments.length===4){var ne=arguments[2],jt=arguments[3],Ee=new ee(arguments[0],arguments[1]),Pe=new Ri(this.getRoot(),Ee,ne);return this.nearestNeighbourK(Pe,jt)}}}},{key:"isWithinDistance",value:function(){if(arguments.length===2){var u=arguments[0],p=arguments[1],x=J.POSITIVE_INFINITY,M=new Ts;for(M.add(u);!M.isEmpty();){var D=M.poll(),Z=D.getDistance();if(Z>p)return!1;if(D.maximumDistance()<=p)return!0;if(D.isLeaves()){if((x=Z)<=p)return!0}else D.expandToQueue(M,x)}return!1}if(arguments.length===3){var Q=arguments[0],rt=arguments[1],dt=arguments[2],gt=new Ri(this.getRoot(),Q.getRoot(),rt);return this.isWithinDistance(gt,dt)}}},{key:"interfaces_",get:function(){return[An,O]}}],[{key:"constructor_",value:function(){if(arguments.length===0)o.constructor_.call(this,o.DEFAULT_NODE_CAPACITY);else if(arguments.length===1){var u=arguments[0];ir.constructor_.call(this,u)}}},{key:"centreX",value:function(u){return o.avg(u.getMinX(),u.getMaxX())}},{key:"avg",value:function(u,p){return(u+p)/2}},{key:"getItems",value:function(u){for(var p=new Array(u.size()).fill(null),x=0;!u.isEmpty();){var M=u.poll();p[x]=M.getBoundable(0).getItem(),x++}return p}},{key:"centreY",value:function(u){return o.avg(u.getMinY(),u.getMaxY())}}])}(ir),Ps=function(c){function o(){var u;return n(this,o),u=i(this,o),o.constructor_.apply(u,arguments),u}return m(o,c),l(o,[{key:"computeBounds",value:function(){for(var u=null,p=this.getChildBoundables().iterator();p.hasNext();){var x=p.next();u===null?u=new xt(x.getBounds()):u.expandToInclude(x.getBounds())}return u}}],[{key:"constructor_",value:function(){var u=arguments[0];hn.constructor_.call(this,u)}}])}(hn);Fn.STRtreeNode=Ps,Fn.xComparator=new(function(){return l(function c(){n(this,c)},[{key:"interfaces_",get:function(){return[K]}},{key:"compare",value:function(c,o){return ir.compareDoubles(Fn.centreX(c.getBounds()),Fn.centreX(o.getBounds()))}}])}()),Fn.yComparator=new(function(){return l(function c(){n(this,c)},[{key:"interfaces_",get:function(){return[K]}},{key:"compare",value:function(c,o){return ir.compareDoubles(Fn.centreY(c.getBounds()),Fn.centreY(o.getBounds()))}}])}()),Fn.intersectsOp=new(function(){return l(function c(){n(this,c)},[{key:"interfaces_",get:function(){return[IntersectsOp]}},{key:"intersects",value:function(c,o){return c.intersects(o)}}])}()),Fn.DEFAULT_NODE_CAPACITY=10;var ou=function(){function c(){n(this,c)}return l(c,null,[{key:"relativeSign",value:function(o,u){return o<u?-1:o>u?1:0}},{key:"compare",value:function(o,u,p){if(u.equals2D(p))return 0;var x=c.relativeSign(u.x,p.x),M=c.relativeSign(u.y,p.y);switch(o){case 0:return c.compareValue(x,M);case 1:return c.compareValue(M,x);case 2:return c.compareValue(M,-x);case 3:return c.compareValue(-x,M);case 4:return c.compareValue(-x,-M);case 5:return c.compareValue(-M,-x);case 6:return c.compareValue(-M,x);case 7:return c.compareValue(x,-M)}return lt.shouldNeverReachHere("invalid octant value"),0}},{key:"compareValue",value:function(o,u){return o<0?-1:o>0?1:u<0?-1:u>0?1:0}}])}(),si=function(){return l(function c(){n(this,c),c.constructor_.apply(this,arguments)},[{key:"getCoordinate",value:function(){return this.coord}},{key:"print",value:function(c){c.print(this.coord),c.print(" seg # = "+this.segmentIndex)}},{key:"compareTo",value:function(c){var o=c;return this.segmentIndex<o.segmentIndex?-1:this.segmentIndex>o.segmentIndex?1:this.coord.equals2D(o.coord)?0:this._isInterior?o._isInterior?ou.compare(this._segmentOctant,this.coord,o.coord):1:-1}},{key:"isEndPoint",value:function(c){return this.segmentIndex===0&&!this._isInterior||this.segmentIndex===c}},{key:"toString",value:function(){return this.segmentIndex+":"+this.coord.toString()}},{key:"isInterior",value:function(){return this._isInterior}},{key:"interfaces_",get:function(){return[U]}}],[{key:"constructor_",value:function(){this._segString=null,this.coord=null,this.segmentIndex=null,this._segmentOctant=null,this._isInterior=null;var c=arguments[0],o=arguments[1],u=arguments[2],p=arguments[3];this._segString=c,this.coord=new at(o),this.segmentIndex=u,this._segmentOctant=p,this._isInterior=!o.equals2D(c.getCoordinate(u))}}])}(),au=function(){return l(function c(){n(this,c)},[{key:"hasNext",value:function(){}},{key:"next",value:function(){}},{key:"remove",value:function(){}}])}(),mo=function(){return l(function c(){n(this,c),c.constructor_.apply(this,arguments)},[{key:"getSplitCoordinates",value:function(){var c=new Ur;this.addEndpoints();for(var o=this.iterator(),u=o.next();o.hasNext();){var p=o.next();this.addEdgeCoordinates(u,p,c),u=p}return c.toCoordinateArray()}},{key:"addCollapsedNodes",value:function(){var c=new Ft;this.findCollapsesFromInsertedNodes(c),this.findCollapsesFromExistingVertices(c);for(var o=c.iterator();o.hasNext();){var u=o.next().intValue();this.add(this._edge.getCoordinate(u),u)}}},{key:"createSplitEdgePts",value:function(c,o){var u=o.segmentIndex-c.segmentIndex+2;if(u===2)return[new at(c.coord),new at(o.coord)];var p=this._edge.getCoordinate(o.segmentIndex),x=o.isInterior()||!o.coord.equals2D(p);x||u--;var M=new Array(u).fill(null),D=0;M[D++]=new at(c.coord);for(var Z=c.segmentIndex+1;Z<=o.segmentIndex;Z++)M[D++]=this._edge.getCoordinate(Z);return x&&(M[D]=new at(o.coord)),M}},{key:"print",value:function(c){c.println("Intersections:");for(var o=this.iterator();o.hasNext();)o.next().print(c)}},{key:"findCollapsesFromExistingVertices",value:function(c){for(var o=0;o<this._edge.size()-2;o++){var u=this._edge.getCoordinate(o);this._edge.getCoordinate(o+1);var p=this._edge.getCoordinate(o+2);u.equals2D(p)&&c.add(Bt.valueOf(o+1))}}},{key:"addEdgeCoordinates",value:function(c,o,u){var p=this.createSplitEdgePts(c,o);u.add(p,!1)}},{key:"iterator",value:function(){return this._nodeMap.values().iterator()}},{key:"addSplitEdges",value:function(c){this.addEndpoints(),this.addCollapsedNodes();for(var o=this.iterator(),u=o.next();o.hasNext();){var p=o.next(),x=this.createSplitEdge(u,p);c.add(x),u=p}}},{key:"findCollapseIndex",value:function(c,o,u){if(!c.coord.equals2D(o.coord))return!1;var p=o.segmentIndex-c.segmentIndex;return o.isInterior()||p--,p===1&&(u[0]=c.segmentIndex+1,!0)}},{key:"findCollapsesFromInsertedNodes",value:function(c){for(var o=new Array(1).fill(null),u=this.iterator(),p=u.next();u.hasNext();){var x=u.next();this.findCollapseIndex(p,x,o)&&c.add(Bt.valueOf(o[0])),p=x}}},{key:"getEdge",value:function(){return this._edge}},{key:"addEndpoints",value:function(){var c=this._edge.size()-1;this.add(this._edge.getCoordinate(0),0),this.add(this._edge.getCoordinate(c),c)}},{key:"createSplitEdge",value:function(c,o){var u=this.createSplitEdgePts(c,o);return new xi(u,this._edge.getData())}},{key:"add",value:function(c,o){var u=new si(this._edge,c,o,this._edge.getSegmentOctant(o)),p=this._nodeMap.get(u);return p!==null?(lt.isTrue(p.coord.equals2D(c),"Found equal nodes with different coordinates"),p):(this._nodeMap.put(u,u),u)}},{key:"checkSplitEdgesCorrectness",value:function(c){var o=this._edge.getCoordinates(),u=c.get(0).getCoordinate(0);if(!u.equals2D(o[0]))throw new et("bad split edge start point at "+u);var p=c.get(c.size()-1).getCoordinates(),x=p[p.length-1];if(!x.equals2D(o[o.length-1]))throw new et("bad split edge end point at "+x)}}],[{key:"constructor_",value:function(){this._nodeMap=new Be,this._edge=null;var c=arguments[0];this._edge=c}}])}(),Di=function(){function c(){n(this,c)}return l(c,null,[{key:"octant",value:function(){if(typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var o=arguments[0],u=arguments[1];if(o===0&&u===0)throw new P("Cannot compute the octant for point ( "+o+", "+u+" )");var p=Math.abs(o),x=Math.abs(u);return o>=0?u>=0?p>=x?0:1:p>=x?7:6:u>=0?p>=x?3:2:p>=x?4:5}if(arguments[0]instanceof at&&arguments[1]instanceof at){var M=arguments[0],D=arguments[1],Z=D.x-M.x,Q=D.y-M.y;if(Z===0&&Q===0)throw new P("Cannot compute the octant for two identical points "+M);return c.octant(Z,Q)}}}])}(),jo=function(){return l(function c(){n(this,c)},[{key:"getCoordinates",value:function(){}},{key:"size",value:function(){}},{key:"getCoordinate",value:function(c){}},{key:"isClosed",value:function(){}},{key:"setData",value:function(c){}},{key:"getData",value:function(){}}])}(),Ko=function(){return l(function c(){n(this,c)},[{key:"addIntersection",value:function(c,o){}},{key:"interfaces_",get:function(){return[jo]}}])}(),xi=function(){function c(){n(this,c),c.constructor_.apply(this,arguments)}return l(c,[{key:"getCoordinates",value:function(){return this._pts}},{key:"size",value:function(){return this._pts.length}},{key:"getCoordinate",value:function(o){return this._pts[o]}},{key:"isClosed",value:function(){return this._pts[0].equals(this._pts[this._pts.length-1])}},{key:"getSegmentOctant",value:function(o){return o===this._pts.length-1?-1:this.safeOctant(this.getCoordinate(o),this.getCoordinate(o+1))}},{key:"setData",value:function(o){this._data=o}},{key:"safeOctant",value:function(o,u){return o.equals2D(u)?0:Di.octant(o,u)}},{key:"getData",value:function(){return this._data}},{key:"addIntersection",value:function(){if(arguments.length===2){var o=arguments[0],u=arguments[1];this.addIntersectionNode(o,u)}else if(arguments.length===4){var p=arguments[1],x=arguments[3],M=new at(arguments[0].getIntersection(x));this.addIntersection(M,p)}}},{key:"toString",value:function(){return br.toLineString(new se(this._pts))}},{key:"getNodeList",value:function(){return this._nodeList}},{key:"addIntersectionNode",value:function(o,u){var p=u,x=p+1;if(x<this._pts.length){var M=this._pts[x];o.equals2D(M)&&(p=x)}return this._nodeList.add(o,p)}},{key:"addIntersections",value:function(o,u,p){for(var x=0;x<o.getIntersectionNum();x++)this.addIntersection(o,u,p,x)}},{key:"interfaces_",get:function(){return[Ko]}}],[{key:"constructor_",value:function(){this._nodeList=new mo(this),this._pts=null,this._data=null;var o=arguments[0],u=arguments[1];this._pts=o,this._data=u}},{key:"getNodedSubstrings",value:function(){if(arguments.length===1){var o=arguments[0],u=new Ft;return c.getNodedSubstrings(o,u),u}if(arguments.length===2)for(var p=arguments[1],x=arguments[0].iterator();x.hasNext();)x.next().getNodeList().addSplitEdges(p)}}])}(),cn=function(){function c(){n(this,c),c.constructor_.apply(this,arguments)}return l(c,[{key:"minX",value:function(){return Math.min(this.p0.x,this.p1.x)}},{key:"orientationIndex",value:function(){if(arguments[0]instanceof c){var o=arguments[0],u=Ut.index(this.p0,this.p1,o.p0),p=Ut.index(this.p0,this.p1,o.p1);return u>=0&&p>=0||u<=0&&p<=0?Math.max(u,p):0}if(arguments[0]instanceof at){var x=arguments[0];return Ut.index(this.p0,this.p1,x)}}},{key:"toGeometry",value:function(o){return o.createLineString([this.p0,this.p1])}},{key:"isVertical",value:function(){return this.p0.x===this.p1.x}},{key:"equals",value:function(o){if(!(o instanceof c))return!1;var u=o;return this.p0.equals(u.p0)&&this.p1.equals(u.p1)}},{key:"intersection",value:function(o){var u=new _i;return u.computeIntersection(this.p0,this.p1,o.p0,o.p1),u.hasIntersection()?u.getIntersection(0):null}},{key:"project",value:function(){if(arguments[0]instanceof at){var o=arguments[0];if(o.equals(this.p0)||o.equals(this.p1))return new at(o);var u=this.projectionFactor(o),p=new at;return p.x=this.p0.x+u*(this.p1.x-this.p0.x),p.y=this.p0.y+u*(this.p1.y-this.p0.y),p}if(arguments[0]instanceof c){var x=arguments[0],M=this.projectionFactor(x.p0),D=this.projectionFactor(x.p1);if(M>=1&&D>=1||M<=0&&D<=0)return null;var Z=this.project(x.p0);M<0&&(Z=this.p0),M>1&&(Z=this.p1);var Q=this.project(x.p1);return D<0&&(Q=this.p0),D>1&&(Q=this.p1),new c(Z,Q)}}},{key:"normalize",value:function(){this.p1.compareTo(this.p0)<0&&this.reverse()}},{key:"angle",value:function(){return Math.atan2(this.p1.y-this.p0.y,this.p1.x-this.p0.x)}},{key:"getCoordinate",value:function(o){return o===0?this.p0:this.p1}},{key:"distancePerpendicular",value:function(o){return Ue.pointToLinePerpendicular(o,this.p0,this.p1)}},{key:"minY",value:function(){return Math.min(this.p0.y,this.p1.y)}},{key:"midPoint",value:function(){return c.midPoint(this.p0,this.p1)}},{key:"projectionFactor",value:function(o){if(o.equals(this.p0))return 0;if(o.equals(this.p1))return 1;var u=this.p1.x-this.p0.x,p=this.p1.y-this.p0.y,x=u*u+p*p;return x<=0?J.NaN:((o.x-this.p0.x)*u+(o.y-this.p0.y)*p)/x}},{key:"closestPoints",value:function(o){var u=this.intersection(o);if(u!==null)return[u,u];var p=new Array(2).fill(null),x=J.MAX_VALUE,M=null,D=this.closestPoint(o.p0);x=D.distance(o.p0),p[0]=D,p[1]=o.p0;var Z=this.closestPoint(o.p1);(M=Z.distance(o.p1))<x&&(x=M,p[0]=Z,p[1]=o.p1);var Q=o.closestPoint(this.p0);(M=Q.distance(this.p0))<x&&(x=M,p[0]=this.p0,p[1]=Q);var rt=o.closestPoint(this.p1);return(M=rt.distance(this.p1))<x&&(x=M,p[0]=this.p1,p[1]=rt),p}},{key:"closestPoint",value:function(o){var u=this.projectionFactor(o);return u>0&&u<1?this.project(o):this.p0.distance(o)<this.p1.distance(o)?this.p0:this.p1}},{key:"maxX",value:function(){return Math.max(this.p0.x,this.p1.x)}},{key:"getLength",value:function(){return this.p0.distance(this.p1)}},{key:"compareTo",value:function(o){var u=o,p=this.p0.compareTo(u.p0);return p!==0?p:this.p1.compareTo(u.p1)}},{key:"reverse",value:function(){var o=this.p0;this.p0=this.p1,this.p1=o}},{key:"equalsTopo",value:function(o){return this.p0.equals(o.p0)&&this.p1.equals(o.p1)||this.p0.equals(o.p1)&&this.p1.equals(o.p0)}},{key:"lineIntersection",value:function(o){return zn.intersection(this.p0,this.p1,o.p0,o.p1)}},{key:"maxY",value:function(){return Math.max(this.p0.y,this.p1.y)}},{key:"pointAlongOffset",value:function(o,u){var p=this.p0.x+o*(this.p1.x-this.p0.x),x=this.p0.y+o*(this.p1.y-this.p0.y),M=this.p1.x-this.p0.x,D=this.p1.y-this.p0.y,Z=Math.sqrt(M*M+D*D),Q=0,rt=0;if(u!==0){if(Z<=0)throw new IllegalStateException("Cannot compute offset from zero-length line segment");Q=u*M/Z,rt=u*D/Z}return new at(p-rt,x+Q)}},{key:"setCoordinates",value:function(){if(arguments.length===1){var o=arguments[0];this.setCoordinates(o.p0,o.p1)}else if(arguments.length===2){var u=arguments[0],p=arguments[1];this.p0.x=u.x,this.p0.y=u.y,this.p1.x=p.x,this.p1.y=p.y}}},{key:"segmentFraction",value:function(o){var u=this.projectionFactor(o);return u<0?u=0:(u>1||J.isNaN(u))&&(u=1),u}},{key:"toString",value:function(){return"LINESTRING( "+this.p0.x+" "+this.p0.y+", "+this.p1.x+" "+this.p1.y+")"}},{key:"isHorizontal",value:function(){return this.p0.y===this.p1.y}},{key:"reflect",value:function(o){var u=this.p1.getY()-this.p0.getY(),p=this.p0.getX()-this.p1.getX(),x=this.p0.getY()*(this.p1.getX()-this.p0.getX())-this.p0.getX()*(this.p1.getY()-this.p0.getY()),M=u*u+p*p,D=u*u-p*p,Z=o.getX(),Q=o.getY();return new at((-D*Z-2*u*p*Q-2*u*x)/M,(D*Q-2*u*p*Z-2*p*x)/M)}},{key:"distance",value:function(){if(arguments[0]instanceof c){var o=arguments[0];return Ue.segmentToSegment(this.p0,this.p1,o.p0,o.p1)}if(arguments[0]instanceof at){var u=arguments[0];return Ue.pointToSegment(u,this.p0,this.p1)}}},{key:"pointAlong",value:function(o){var u=new at;return u.x=this.p0.x+o*(this.p1.x-this.p0.x),u.y=this.p0.y+o*(this.p1.y-this.p0.y),u}},{key:"hashCode",value:function(){var o=J.doubleToLongBits(this.p0.x);o^=31*J.doubleToLongBits(this.p0.y);var u=Math.trunc(o)^Math.trunc(o>>32),p=J.doubleToLongBits(this.p1.x);return p^=31*J.doubleToLongBits(this.p1.y),u^(Math.trunc(p)^Math.trunc(p>>32))}},{key:"interfaces_",get:function(){return[U,O]}}],[{key:"constructor_",value:function(){if(this.p0=null,this.p1=null,arguments.length===0)c.constructor_.call(this,new at,new at);else if(arguments.length===1){var o=arguments[0];c.constructor_.call(this,o.p0,o.p1)}else if(arguments.length===2){var u=arguments[0],p=arguments[1];this.p0=u,this.p1=p}else if(arguments.length===4){var x=arguments[0],M=arguments[1],D=arguments[2],Z=arguments[3];c.constructor_.call(this,new at(x,M),new at(D,Z))}}},{key:"midPoint",value:function(o,u){return new at((o.x+u.x)/2,(o.y+u.y)/2)}}])}(),Qo=function(){return l(function c(){n(this,c),c.constructor_.apply(this,arguments)},[{key:"overlap",value:function(){if(arguments.length!==2){if(arguments.length===4){var c=arguments[1],o=arguments[2],u=arguments[3];arguments[0].getLineSegment(c,this._overlapSeg1),o.getLineSegment(u,this._overlapSeg2),this.overlap(this._overlapSeg1,this._overlapSeg2)}}}}],[{key:"constructor_",value:function(){this._overlapSeg1=new cn,this._overlapSeg2=new cn}}])}(),zi=function(){return l(function c(){n(this,c),c.constructor_.apply(this,arguments)},[{key:"getLineSegment",value:function(c,o){o.p0=this._pts[c],o.p1=this._pts[c+1]}},{key:"computeSelect",value:function(c,o,u,p){var x=this._pts[o],M=this._pts[u];if(u-o==1)return p.select(this,o),null;if(!c.intersects(x,M))return null;var D=Math.trunc((o+u)/2);o<D&&this.computeSelect(c,o,D,p),D<u&&this.computeSelect(c,D,u,p)}},{key:"getCoordinates",value:function(){for(var c=new Array(this._end-this._start+1).fill(null),o=0,u=this._start;u<=this._end;u++)c[o++]=this._pts[u];return c}},{key:"computeOverlaps",value:function(){if(arguments.length===2){var c=arguments[0],o=arguments[1];this.computeOverlaps(this._start,this._end,c,c._start,c._end,o)}else if(arguments.length===6){var u=arguments[0],p=arguments[1],x=arguments[2],M=arguments[3],D=arguments[4],Z=arguments[5];if(p-u==1&&D-M==1)return Z.overlap(this,u,x,M),null;if(!this.overlaps(u,p,x,M,D))return null;var Q=Math.trunc((u+p)/2),rt=Math.trunc((M+D)/2);u<Q&&(M<rt&&this.computeOverlaps(u,Q,x,M,rt,Z),rt<D&&this.computeOverlaps(u,Q,x,rt,D,Z)),Q<p&&(M<rt&&this.computeOverlaps(Q,p,x,M,rt,Z),rt<D&&this.computeOverlaps(Q,p,x,rt,D,Z))}}},{key:"setId",value:function(c){this._id=c}},{key:"select",value:function(c,o){this.computeSelect(c,this._start,this._end,o)}},{key:"getEnvelope",value:function(){if(this._env===null){var c=this._pts[this._start],o=this._pts[this._end];this._env=new xt(c,o)}return this._env}},{key:"overlaps",value:function(c,o,u,p,x){return xt.intersects(this._pts[c],this._pts[o],u._pts[p],u._pts[x])}},{key:"getEndIndex",value:function(){return this._end}},{key:"getStartIndex",value:function(){return this._start}},{key:"getContext",value:function(){return this._context}},{key:"getId",value:function(){return this._id}}],[{key:"constructor_",value:function(){this._pts=null,this._start=null,this._end=null,this._env=null,this._context=null,this._id=null;var c=arguments[0],o=arguments[1],u=arguments[2],p=arguments[3];this._pts=c,this._start=o,this._end=u,this._context=p}}])}(),ta=function(){function c(){n(this,c)}return l(c,null,[{key:"findChainEnd",value:function(o,u){for(var p=u;p<o.length-1&&o[p].equals2D(o[p+1]);)p++;if(p>=o.length-1)return o.length-1;for(var x=ln.quadrant(o[p],o[p+1]),M=u+1;M<o.length&&!(!o[M-1].equals2D(o[M])&&ln.quadrant(o[M-1],o[M])!==x);)M++;return M-1}},{key:"getChains",value:function(){if(arguments.length===1){var o=arguments[0];return c.getChains(o,null)}if(arguments.length===2){var u=arguments[0],p=arguments[1],x=new Ft,M=0;do{var D=c.findChainEnd(u,M),Z=new zi(u,M,D,p);x.add(Z),M=D}while(M<u.length-1);return x}}}])}(),Un=function(){return l(function c(){n(this,c)},[{key:"computeNodes",value:function(c){}},{key:"getNodedSubstrings",value:function(){}}])}(),Is=function(){return l(function c(){n(this,c),c.constructor_.apply(this,arguments)},[{key:"setSegmentIntersector",value:function(c){this._segInt=c}},{key:"interfaces_",get:function(){return[Un]}}],[{key:"constructor_",value:function(){if(this._segInt=null,arguments.length!==0){if(arguments.length===1){var c=arguments[0];this.setSegmentIntersector(c)}}}}])}(),yo=function(c){function o(){var u;return n(this,o),u=i(this,o),o.constructor_.apply(u,arguments),u}return m(o,c),l(o,[{key:"getMonotoneChains",value:function(){return this._monoChains}},{key:"getNodedSubstrings",value:function(){return xi.getNodedSubstrings(this._nodedSegStrings)}},{key:"getIndex",value:function(){return this._index}},{key:"add",value:function(u){for(var p=ta.getChains(u.getCoordinates(),u).iterator();p.hasNext();){var x=p.next();x.setId(this._idCounter++),this._index.insert(x.getEnvelope(),x),this._monoChains.add(x)}}},{key:"computeNodes",value:function(u){this._nodedSegStrings=u;for(var p=u.iterator();p.hasNext();)this.add(p.next());this.intersectChains()}},{key:"intersectChains",value:function(){for(var u=new _o(this._segInt),p=this._monoChains.iterator();p.hasNext();)for(var x=p.next(),M=this._index.query(x.getEnvelope()).iterator();M.hasNext();){var D=M.next();if(D.getId()>x.getId()&&(x.computeOverlaps(D,u),this._nOverlaps++),this._segInt.isDone())return null}}}],[{key:"constructor_",value:function(){if(this._monoChains=new Ft,this._index=new Fn,this._idCounter=0,this._nodedSegStrings=null,this._nOverlaps=0,arguments.length!==0){if(arguments.length===1){var u=arguments[0];Is.constructor_.call(this,u)}}}}])}(Is),_o=function(c){function o(){var u;return n(this,o),u=i(this,o),o.constructor_.apply(u,arguments),u}return m(o,c),l(o,[{key:"overlap",value:function(){if(arguments.length!==4)return w(o,"overlap",this,1).apply(this,arguments);var u=arguments[1],p=arguments[2],x=arguments[3],M=arguments[0].getContext(),D=p.getContext();this._si.processIntersections(M,u,D,x)}}],[{key:"constructor_",value:function(){this._si=null;var u=arguments[0];this._si=u}}])}(Qo);yo.SegmentOverlapAction=_o;var Gn=function(){function c(){n(this,c),c.constructor_.apply(this,arguments)}return l(c,[{key:"isDeletable",value:function(o,u,p,x){var M=this._inputLine[o],D=this._inputLine[u],Z=this._inputLine[p];return!!this.isConcave(M,D,Z)&&!!this.isShallow(M,D,Z,x)&&this.isShallowSampled(M,D,o,p,x)}},{key:"deleteShallowConcavities",value:function(){for(var o=1,u=this.findNextNonDeletedIndex(o),p=this.findNextNonDeletedIndex(u),x=!1;p<this._inputLine.length;){var M=!1;this.isDeletable(o,u,p,this._distanceTol)&&(this._isDeleted[u]=c.DELETE,M=!0,x=!0),o=M?p:u,u=this.findNextNonDeletedIndex(o),p=this.findNextNonDeletedIndex(u)}return x}},{key:"isShallowConcavity",value:function(o,u,p,x){return Ut.index(o,u,p)===this._angleOrientation&&Ue.pointToSegment(u,o,p)<x}},{key:"isShallowSampled",value:function(o,u,p,x,M){var D=Math.trunc((x-p)/c.NUM_PTS_TO_CHECK);D<=0&&(D=1);for(var Z=p;Z<x;Z+=D)if(!this.isShallow(o,u,this._inputLine[Z],M))return!1;return!0}},{key:"isConcave",value:function(o,u,p){var x=Ut.index(o,u,p)===this._angleOrientation;return x}},{key:"simplify",value:function(o){this._distanceTol=Math.abs(o),o<0&&(this._angleOrientation=Ut.CLOCKWISE),this._isDeleted=new Array(this._inputLine.length).fill(null);var u=!1;do u=this.deleteShallowConcavities();while(u);return this.collapseLine()}},{key:"findNextNonDeletedIndex",value:function(o){for(var u=o+1;u<this._inputLine.length&&this._isDeleted[u]===c.DELETE;)u++;return u}},{key:"isShallow",value:function(o,u,p,x){return Ue.pointToSegment(u,o,p)<x}},{key:"collapseLine",value:function(){for(var o=new Ur,u=0;u<this._inputLine.length;u++)this._isDeleted[u]!==c.DELETE&&o.add(this._inputLine[u]);return o.toCoordinateArray()}}],[{key:"constructor_",value:function(){this._inputLine=null,this._distanceTol=null,this._isDeleted=null,this._angleOrientation=Ut.COUNTERCLOCKWISE;var o=arguments[0];this._inputLine=o}},{key:"simplify",value:function(o,u){return new c(o).simplify(u)}}])}();Gn.INIT=0,Gn.DELETE=1,Gn.KEEP=1,Gn.NUM_PTS_TO_CHECK=10;var rr=function(){function c(){n(this,c),c.constructor_.apply(this,arguments)}return l(c,[{key:"getCoordinates",value:function(){return this._ptList.toArray(c.COORDINATE_ARRAY_TYPE)}},{key:"setPrecisionModel",value:function(o){this._precisionModel=o}},{key:"addPt",value:function(o){var u=new at(o);if(this._precisionModel.makePrecise(u),this.isRedundant(u))return null;this._ptList.add(u)}},{key:"reverse",value:function(){}},{key:"addPts",value:function(o,u){if(u)for(var p=0;p<o.length;p++)this.addPt(o[p]);else for(var x=o.length-1;x>=0;x--)this.addPt(o[x])}},{key:"isRedundant",value:function(o){if(this._ptList.size()<1)return!1;var u=this._ptList.get(this._ptList.size()-1);return o.distance(u)<this._minimimVertexDistance}},{key:"toString",value:function(){return new ni().createLineString(this.getCoordinates()).toString()}},{key:"closeRing",value:function(){if(this._ptList.size()<1)return null;var o=new at(this._ptList.get(0)),u=this._ptList.get(this._ptList.size()-1);if(o.equals(u))return null;this._ptList.add(o)}},{key:"setMinimumVertexDistance",value:function(o){this._minimimVertexDistance=o}}],[{key:"constructor_",value:function(){this._ptList=null,this._precisionModel=null,this._minimimVertexDistance=0,this._ptList=new Ft}}])}();rr.COORDINATE_ARRAY_TYPE=new Array(0).fill(null);var Ye=function(){function c(){n(this,c)}return l(c,null,[{key:"toDegrees",value:function(o){return 180*o/Math.PI}},{key:"normalize",value:function(o){for(;o>Math.PI;)o-=c.PI_TIMES_2;for(;o<=-Math.PI;)o+=c.PI_TIMES_2;return o}},{key:"angle",value:function(){if(arguments.length===1){var o=arguments[0];return Math.atan2(o.y,o.x)}if(arguments.length===2){var u=arguments[0],p=arguments[1],x=p.x-u.x,M=p.y-u.y;return Math.atan2(M,x)}}},{key:"isAcute",value:function(o,u,p){var x=o.x-u.x,M=o.y-u.y;return x*(p.x-u.x)+M*(p.y-u.y)>0}},{key:"isObtuse",value:function(o,u,p){var x=o.x-u.x,M=o.y-u.y;return x*(p.x-u.x)+M*(p.y-u.y)<0}},{key:"interiorAngle",value:function(o,u,p){var x=c.angle(u,o),M=c.angle(u,p);return Math.abs(M-x)}},{key:"normalizePositive",value:function(o){if(o<0){for(;o<0;)o+=c.PI_TIMES_2;o>=c.PI_TIMES_2&&(o=0)}else{for(;o>=c.PI_TIMES_2;)o-=c.PI_TIMES_2;o<0&&(o=0)}return o}},{key:"angleBetween",value:function(o,u,p){var x=c.angle(u,o),M=c.angle(u,p);return c.diff(x,M)}},{key:"diff",value:function(o,u){var p=null;return(p=o<u?u-o:o-u)>Math.PI&&(p=2*Math.PI-p),p}},{key:"toRadians",value:function(o){return o*Math.PI/180}},{key:"getTurn",value:function(o,u){var p=Math.sin(u-o);return p>0?c.COUNTERCLOCKWISE:p<0?c.CLOCKWISE:c.NONE}},{key:"angleBetweenOriented",value:function(o,u,p){var x=c.angle(u,o),M=c.angle(u,p)-x;return M<=-Math.PI?M+c.PI_TIMES_2:M>Math.PI?M-c.PI_TIMES_2:M}}])}();Ye.PI_TIMES_2=2*Math.PI,Ye.PI_OVER_2=Math.PI/2,Ye.PI_OVER_4=Math.PI/4,Ye.COUNTERCLOCKWISE=Ut.COUNTERCLOCKWISE,Ye.CLOCKWISE=Ut.CLOCKWISE,Ye.NONE=Ut.COLLINEAR;var Bi=function(){function c(){n(this,c),c.constructor_.apply(this,arguments)}return l(c,[{key:"addNextSegment",value:function(o,u){if(this._s0=this._s1,this._s1=this._s2,this._s2=o,this._seg0.setCoordinates(this._s0,this._s1),this.computeOffsetSegment(this._seg0,this._side,this._distance,this._offset0),this._seg1.setCoordinates(this._s1,this._s2),this.computeOffsetSegment(this._seg1,this._side,this._distance,this._offset1),this._s1.equals(this._s2))return null;var p=Ut.index(this._s0,this._s1,this._s2),x=p===Ut.CLOCKWISE&&this._side===st.LEFT||p===Ut.COUNTERCLOCKWISE&&this._side===st.RIGHT;p===0?this.addCollinear(u):x?this.addOutsideTurn(p,u):this.addInsideTurn(p,u)}},{key:"addLineEndCap",value:function(o,u){var p=new cn(o,u),x=new cn;this.computeOffsetSegment(p,st.LEFT,this._distance,x);var M=new cn;this.computeOffsetSegment(p,st.RIGHT,this._distance,M);var D=u.x-o.x,Z=u.y-o.y,Q=Math.atan2(Z,D);switch(this._bufParams.getEndCapStyle()){case C.CAP_ROUND:this._segList.addPt(x.p1),this.addDirectedFillet(u,Q+Math.PI/2,Q-Math.PI/2,Ut.CLOCKWISE,this._distance),this._segList.addPt(M.p1);break;case C.CAP_FLAT:this._segList.addPt(x.p1),this._segList.addPt(M.p1);break;case C.CAP_SQUARE:var rt=new at;rt.x=Math.abs(this._distance)*Math.cos(Q),rt.y=Math.abs(this._distance)*Math.sin(Q);var dt=new at(x.p1.x+rt.x,x.p1.y+rt.y),gt=new at(M.p1.x+rt.x,M.p1.y+rt.y);this._segList.addPt(dt),this._segList.addPt(gt)}}},{key:"getCoordinates",value:function(){return this._segList.getCoordinates()}},{key:"addMitreJoin",value:function(o,u,p,x){var M=zn.intersection(u.p0,u.p1,p.p0,p.p1);if(M!==null&&(x<=0?1:M.distance(o)/Math.abs(x))<=this._bufParams.getMitreLimit())return this._segList.addPt(M),null;this.addLimitedMitreJoin(u,p,x,this._bufParams.getMitreLimit())}},{key:"addOutsideTurn",value:function(o,u){if(this._offset0.p1.distance(this._offset1.p0)<this._distance*c.OFFSET_SEGMENT_SEPARATION_FACTOR)return this._segList.addPt(this._offset0.p1),null;this._bufParams.getJoinStyle()===C.JOIN_MITRE?this.addMitreJoin(this._s1,this._offset0,this._offset1,this._distance):this._bufParams.getJoinStyle()===C.JOIN_BEVEL?this.addBevelJoin(this._offset0,this._offset1):(u&&this._segList.addPt(this._offset0.p1),this.addCornerFillet(this._s1,this._offset0.p1,this._offset1.p0,o,this._distance),this._segList.addPt(this._offset1.p0))}},{key:"createSquare",value:function(o){this._segList.addPt(new at(o.x+this._distance,o.y+this._distance)),this._segList.addPt(new at(o.x+this._distance,o.y-this._distance)),this._segList.addPt(new at(o.x-this._distance,o.y-this._distance)),this._segList.addPt(new at(o.x-this._distance,o.y+this._distance)),this._segList.closeRing()}},{key:"addSegments",value:function(o,u){this._segList.addPts(o,u)}},{key:"addFirstSegment",value:function(){this._segList.addPt(this._offset1.p0)}},{key:"addCornerFillet",value:function(o,u,p,x,M){var D=u.x-o.x,Z=u.y-o.y,Q=Math.atan2(Z,D),rt=p.x-o.x,dt=p.y-o.y,gt=Math.atan2(dt,rt);x===Ut.CLOCKWISE?Q<=gt&&(Q+=2*Math.PI):Q>=gt&&(Q-=2*Math.PI),this._segList.addPt(u),this.addDirectedFillet(o,Q,gt,x,M),this._segList.addPt(p)}},{key:"addLastSegment",value:function(){this._segList.addPt(this._offset1.p1)}},{key:"initSideSegments",value:function(o,u,p){this._s1=o,this._s2=u,this._side=p,this._seg1.setCoordinates(o,u),this.computeOffsetSegment(this._seg1,p,this._distance,this._offset1)}},{key:"addLimitedMitreJoin",value:function(o,u,p,x){var M=this._seg0.p1,D=Ye.angle(M,this._seg0.p0),Z=Ye.angleBetweenOriented(this._seg0.p0,M,this._seg1.p1)/2,Q=Ye.normalize(D+Z),rt=Ye.normalize(Q+Math.PI),dt=x*p,gt=p-dt*Math.abs(Math.sin(Z)),Tt=M.x+dt*Math.cos(rt),Ot=M.y+dt*Math.sin(rt),zt=new at(Tt,Ot),qt=new cn(M,zt),ne=qt.pointAlongOffset(1,gt),jt=qt.pointAlongOffset(1,-gt);this._side===st.LEFT?(this._segList.addPt(ne),this._segList.addPt(jt)):(this._segList.addPt(jt),this._segList.addPt(ne))}},{key:"addDirectedFillet",value:function(o,u,p,x,M){var D=x===Ut.CLOCKWISE?-1:1,Z=Math.abs(u-p),Q=Math.trunc(Z/this._filletAngleQuantum+.5);if(Q<1)return null;for(var rt=Z/Q,dt=new at,gt=0;gt<Q;gt++){var Tt=u+D*gt*rt;dt.x=o.x+M*Math.cos(Tt),dt.y=o.y+M*Math.sin(Tt),this._segList.addPt(dt)}}},{key:"computeOffsetSegment",value:function(o,u,p,x){var M=u===st.LEFT?1:-1,D=o.p1.x-o.p0.x,Z=o.p1.y-o.p0.y,Q=Math.sqrt(D*D+Z*Z),rt=M*p*D/Q,dt=M*p*Z/Q;x.p0.x=o.p0.x-dt,x.p0.y=o.p0.y+rt,x.p1.x=o.p1.x-dt,x.p1.y=o.p1.y+rt}},{key:"addInsideTurn",value:function(o,u){if(this._li.computeIntersection(this._offset0.p0,this._offset0.p1,this._offset1.p0,this._offset1.p1),this._li.hasIntersection())this._segList.addPt(this._li.getIntersection(0));else if(this._hasNarrowConcaveAngle=!0,this._offset0.p1.distance(this._offset1.p0)<this._distance*c.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR)this._segList.addPt(this._offset0.p1);else{if(this._segList.addPt(this._offset0.p1),this._closingSegLengthFactor>0){var p=new at((this._closingSegLengthFactor*this._offset0.p1.x+this._s1.x)/(this._closingSegLengthFactor+1),(this._closingSegLengthFactor*this._offset0.p1.y+this._s1.y)/(this._closingSegLengthFactor+1));this._segList.addPt(p);var x=new at((this._closingSegLengthFactor*this._offset1.p0.x+this._s1.x)/(this._closingSegLengthFactor+1),(this._closingSegLengthFactor*this._offset1.p0.y+this._s1.y)/(this._closingSegLengthFactor+1));this._segList.addPt(x)}else this._segList.addPt(this._s1);this._segList.addPt(this._offset1.p0)}}},{key:"createCircle",value:function(o){var u=new at(o.x+this._distance,o.y);this._segList.addPt(u),this.addDirectedFillet(o,0,2*Math.PI,-1,this._distance),this._segList.closeRing()}},{key:"addBevelJoin",value:function(o,u){this._segList.addPt(o.p1),this._segList.addPt(u.p0)}},{key:"init",value:function(o){this._distance=o,this._maxCurveSegmentError=o*(1-Math.cos(this._filletAngleQuantum/2)),this._segList=new rr,this._segList.setPrecisionModel(this._precisionModel),this._segList.setMinimumVertexDistance(o*c.CURVE_VERTEX_SNAP_DISTANCE_FACTOR)}},{key:"addCollinear",value:function(o){this._li.computeIntersection(this._s0,this._s1,this._s1,this._s2),this._li.getIntersectionNum()>=2&&(this._bufParams.getJoinStyle()===C.JOIN_BEVEL||this._bufParams.getJoinStyle()===C.JOIN_MITRE?(o&&this._segList.addPt(this._offset0.p1),this._segList.addPt(this._offset1.p0)):this.addCornerFillet(this._s1,this._offset0.p1,this._offset1.p0,Ut.CLOCKWISE,this._distance))}},{key:"closeRing",value:function(){this._segList.closeRing()}},{key:"hasNarrowConcaveAngle",value:function(){return this._hasNarrowConcaveAngle}}],[{key:"constructor_",value:function(){this._maxCurveSegmentError=0,this._filletAngleQuantum=null,this._closingSegLengthFactor=1,this._segList=null,this._distance=0,this._precisionModel=null,this._bufParams=null,this._li=null,this._s0=null,this._s1=null,this._s2=null,this._seg0=new cn,this._seg1=new cn,this._offset0=new cn,this._offset1=new cn,this._side=0,this._hasNarrowConcaveAngle=!1;var o=arguments[0],u=arguments[1],p=arguments[2];this._precisionModel=o,this._bufParams=u,this._li=new _i,this._filletAngleQuantum=Math.PI/2/u.getQuadrantSegments(),u.getQuadrantSegments()>=8&&u.getJoinStyle()===C.JOIN_ROUND&&(this._closingSegLengthFactor=c.MAX_CLOSING_SEG_LEN_FACTOR),this.init(p)}}])}();Bi.OFFSET_SEGMENT_SEPARATION_FACTOR=.001,Bi.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR=.001,Bi.CURVE_VERTEX_SNAP_DISTANCE_FACTOR=1e-6,Bi.MAX_CLOSING_SEG_LEN_FACTOR=80;var Xr=function(){function c(){n(this,c),c.constructor_.apply(this,arguments)}return l(c,[{key:"getOffsetCurve",value:function(o,u){if(this._distance=u,u===0)return null;var p=u<0,x=Math.abs(u),M=this.getSegGen(x);o.length<=1?this.computePointCurve(o[0],M):this.computeOffsetCurve(o,p,M);var D=M.getCoordinates();return p&&Ge.reverse(D),D}},{key:"computeSingleSidedBufferCurve",value:function(o,u,p){var x=this.simplifyTolerance(this._distance);if(u){p.addSegments(o,!0);var M=Gn.simplify(o,-x),D=M.length-1;p.initSideSegments(M[D],M[D-1],st.LEFT),p.addFirstSegment();for(var Z=D-2;Z>=0;Z--)p.addNextSegment(M[Z],!0)}else{p.addSegments(o,!1);var Q=Gn.simplify(o,x),rt=Q.length-1;p.initSideSegments(Q[0],Q[1],st.LEFT),p.addFirstSegment();for(var dt=2;dt<=rt;dt++)p.addNextSegment(Q[dt],!0)}p.addLastSegment(),p.closeRing()}},{key:"computeRingBufferCurve",value:function(o,u,p){var x=this.simplifyTolerance(this._distance);u===st.RIGHT&&(x=-x);var M=Gn.simplify(o,x),D=M.length-1;p.initSideSegments(M[D-1],M[0],u);for(var Z=1;Z<=D;Z++){var Q=Z!==1;p.addNextSegment(M[Z],Q)}p.closeRing()}},{key:"computeLineBufferCurve",value:function(o,u){var p=this.simplifyTolerance(this._distance),x=Gn.simplify(o,p),M=x.length-1;u.initSideSegments(x[0],x[1],st.LEFT);for(var D=2;D<=M;D++)u.addNextSegment(x[D],!0);u.addLastSegment(),u.addLineEndCap(x[M-1],x[M]);var Z=Gn.simplify(o,-p),Q=Z.length-1;u.initSideSegments(Z[Q],Z[Q-1],st.LEFT);for(var rt=Q-2;rt>=0;rt--)u.addNextSegment(Z[rt],!0);u.addLastSegment(),u.addLineEndCap(Z[1],Z[0]),u.closeRing()}},{key:"computePointCurve",value:function(o,u){switch(this._bufParams.getEndCapStyle()){case C.CAP_ROUND:u.createCircle(o);break;case C.CAP_SQUARE:u.createSquare(o)}}},{key:"getLineCurve",value:function(o,u){if(this._distance=u,this.isLineOffsetEmpty(u))return null;var p=Math.abs(u),x=this.getSegGen(p);if(o.length<=1)this.computePointCurve(o[0],x);else if(this._bufParams.isSingleSided()){var M=u<0;this.computeSingleSidedBufferCurve(o,M,x)}else this.computeLineBufferCurve(o,x);return x.getCoordinates()}},{key:"getBufferParameters",value:function(){return this._bufParams}},{key:"simplifyTolerance",value:function(o){return o*this._bufParams.getSimplifyFactor()}},{key:"getRingCurve",value:function(o,u,p){if(this._distance=p,o.length<=2)return this.getLineCurve(o,p);if(p===0)return c.copyCoordinates(o);var x=this.getSegGen(p);return this.computeRingBufferCurve(o,u,x),x.getCoordinates()}},{key:"computeOffsetCurve",value:function(o,u,p){var x=this.simplifyTolerance(this._distance);if(u){var M=Gn.simplify(o,-x),D=M.length-1;p.initSideSegments(M[D],M[D-1],st.LEFT),p.addFirstSegment();for(var Z=D-2;Z>=0;Z--)p.addNextSegment(M[Z],!0)}else{var Q=Gn.simplify(o,x),rt=Q.length-1;p.initSideSegments(Q[0],Q[1],st.LEFT),p.addFirstSegment();for(var dt=2;dt<=rt;dt++)p.addNextSegment(Q[dt],!0)}p.addLastSegment()}},{key:"isLineOffsetEmpty",value:function(o){return o===0||o<0&&!this._bufParams.isSingleSided()}},{key:"getSegGen",value:function(o){return new Bi(this._precisionModel,this._bufParams,o)}}],[{key:"constructor_",value:function(){this._distance=0,this._precisionModel=null,this._bufParams=null;var o=arguments[0],u=arguments[1];this._precisionModel=o,this._bufParams=u}},{key:"copyCoordinates",value:function(o){for(var u=new Array(o.length).fill(null),p=0;p<u.length;p++)u[p]=new at(o[p]);return u}}])}(),Nn=function(){return l(function c(){n(this,c),c.constructor_.apply(this,arguments)},[{key:"findStabbedSegments",value:function(){if(arguments.length===1){for(var c=arguments[0],o=new Ft,u=this._subgraphs.iterator();u.hasNext();){var p=u.next(),x=p.getEnvelope();c.y<x.getMinY()||c.y>x.getMaxY()||this.findStabbedSegments(c,p.getDirectedEdges(),o)}return o}if(arguments.length===3){if(St(arguments[2],yt)&&arguments[0]instanceof at&&arguments[1]instanceof Ls){for(var M=arguments[0],D=arguments[1],Z=arguments[2],Q=D.getEdge().getCoordinates(),rt=0;rt<Q.length-1;rt++)if(this._seg.p0=Q[rt],this._seg.p1=Q[rt+1],this._seg.p0.y>this._seg.p1.y&&this._seg.reverse(),!(Math.max(this._seg.p0.x,this._seg.p1.x)<M.x||this._seg.isHorizontal()||M.y<this._seg.p0.y||M.y>this._seg.p1.y||Ut.index(this._seg.p0,this._seg.p1,M)===Ut.RIGHT)){var dt=D.getDepth(st.LEFT);this._seg.p0.equals(Q[rt])||(dt=D.getDepth(st.RIGHT));var gt=new kr(this._seg,dt);Z.add(gt)}}else if(St(arguments[2],yt)&&arguments[0]instanceof at&&St(arguments[1],yt))for(var Tt=arguments[0],Ot=arguments[2],zt=arguments[1].iterator();zt.hasNext();){var qt=zt.next();qt.isForward()&&this.findStabbedSegments(Tt,qt,Ot)}}}},{key:"getDepth",value:function(c){var o=this.findStabbedSegments(c);return o.size()===0?0:nr.min(o)._leftDepth}}],[{key:"constructor_",value:function(){this._subgraphs=null,this._seg=new cn;var c=arguments[0];this._subgraphs=c}}])}(),kr=function(){return l(function c(){n(this,c),c.constructor_.apply(this,arguments)},[{key:"compareTo",value:function(c){var o=c;if(this._upwardSeg.minX()>=o._upwardSeg.maxX())return 1;if(this._upwardSeg.maxX()<=o._upwardSeg.minX())return-1;var u=this._upwardSeg.orientationIndex(o._upwardSeg);return u!==0||(u=-1*o._upwardSeg.orientationIndex(this._upwardSeg))!==0?u:this._upwardSeg.compareTo(o._upwardSeg)}},{key:"compareX",value:function(c,o){var u=c.p0.compareTo(o.p0);return u!==0?u:c.p1.compareTo(o.p1)}},{key:"toString",value:function(){return this._upwardSeg.toString()}},{key:"interfaces_",get:function(){return[U]}}],[{key:"constructor_",value:function(){this._upwardSeg=null,this._leftDepth=null;var c=arguments[0],o=arguments[1];this._upwardSeg=new cn(c),this._leftDepth=o}}])}();Nn.DepthSegment=kr;var Cs=function(c){function o(){var u;return n(this,o),u=i(this,o),o.constructor_.apply(u,arguments),u}return m(o,c),l(o,null,[{key:"constructor_",value:function(){A.constructor_.call(this,"Projective point not representable on the Cartesian plane.")}}])}(A),As=function(){function c(){n(this,c),c.constructor_.apply(this,arguments)}return l(c,[{key:"getY",value:function(){var o=this.y/this.w;if(J.isNaN(o)||J.isInfinite(o))throw new Cs;return o}},{key:"getX",value:function(){var o=this.x/this.w;if(J.isNaN(o)||J.isInfinite(o))throw new Cs;return o}},{key:"getCoordinate",value:function(){var o=new at;return o.x=this.getX(),o.y=this.getY(),o}}],[{key:"constructor_",value:function(){if(this.x=null,this.y=null,this.w=null,arguments.length===0)this.x=0,this.y=0,this.w=1;else if(arguments.length===1){var o=arguments[0];this.x=o.x,this.y=o.y,this.w=1}else if(arguments.length===2){if(typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var u=arguments[0],p=arguments[1];this.x=u,this.y=p,this.w=1}else if(arguments[0]instanceof c&&arguments[1]instanceof c){var x=arguments[0],M=arguments[1];this.x=x.y*M.w-M.y*x.w,this.y=M.x*x.w-x.x*M.w,this.w=x.x*M.y-M.x*x.y}else if(arguments[0]instanceof at&&arguments[1]instanceof at){var D=arguments[0],Z=arguments[1];this.x=D.y-Z.y,this.y=Z.x-D.x,this.w=D.x*Z.y-Z.x*D.y}}else if(arguments.length===3){var Q=arguments[0],rt=arguments[1],dt=arguments[2];this.x=Q,this.y=rt,this.w=dt}else if(arguments.length===4){var gt=arguments[0],Tt=arguments[1],Ot=arguments[2],zt=arguments[3],qt=gt.y-Tt.y,ne=Tt.x-gt.x,jt=gt.x*Tt.y-Tt.x*gt.y,Ee=Ot.y-zt.y,Pe=zt.x-Ot.x,Ze=Ot.x*zt.y-zt.x*Ot.y;this.x=ne*Ze-Pe*jt,this.y=Ee*jt-qt*Ze,this.w=qt*Pe-Ee*ne}}}])}(),vo=function(){function c(){n(this,c),c.constructor_.apply(this,arguments)}return l(c,[{key:"area",value:function(){return c.area(this.p0,this.p1,this.p2)}},{key:"signedArea",value:function(){return c.signedArea(this.p0,this.p1,this.p2)}},{key:"interpolateZ",value:function(o){if(o===null)throw new P("Supplied point is null.");return c.interpolateZ(o,this.p0,this.p1,this.p2)}},{key:"longestSideLength",value:function(){return c.longestSideLength(this.p0,this.p1,this.p2)}},{key:"isAcute",value:function(){return c.isAcute(this.p0,this.p1,this.p2)}},{key:"circumcentre",value:function(){return c.circumcentre(this.p0,this.p1,this.p2)}},{key:"area3D",value:function(){return c.area3D(this.p0,this.p1,this.p2)}},{key:"centroid",value:function(){return c.centroid(this.p0,this.p1,this.p2)}},{key:"inCentre",value:function(){return c.inCentre(this.p0,this.p1,this.p2)}}],[{key:"constructor_",value:function(){this.p0=null,this.p1=null,this.p2=null;var o=arguments[0],u=arguments[1],p=arguments[2];this.p0=o,this.p1=u,this.p2=p}},{key:"area",value:function(o,u,p){return Math.abs(((p.x-o.x)*(u.y-o.y)-(u.x-o.x)*(p.y-o.y))/2)}},{key:"signedArea",value:function(o,u,p){return((p.x-o.x)*(u.y-o.y)-(u.x-o.x)*(p.y-o.y))/2}},{key:"det",value:function(o,u,p,x){return o*x-u*p}},{key:"interpolateZ",value:function(o,u,p,x){var M=u.x,D=u.y,Z=p.x-M,Q=x.x-M,rt=p.y-D,dt=x.y-D,gt=Z*dt-Q*rt,Tt=o.x-M,Ot=o.y-D,zt=(dt*Tt-Q*Ot)/gt,qt=(-rt*Tt+Z*Ot)/gt;return u.getZ()+zt*(p.getZ()-u.getZ())+qt*(x.getZ()-u.getZ())}},{key:"longestSideLength",value:function(o,u,p){var x=o.distance(u),M=u.distance(p),D=p.distance(o),Z=x;return M>Z&&(Z=M),D>Z&&(Z=D),Z}},{key:"circumcentreDD",value:function(o,u,p){var x=Pt.valueOf(o.x).subtract(p.x),M=Pt.valueOf(o.y).subtract(p.y),D=Pt.valueOf(u.x).subtract(p.x),Z=Pt.valueOf(u.y).subtract(p.y),Q=Pt.determinant(x,M,D,Z).multiply(2),rt=x.sqr().add(M.sqr()),dt=D.sqr().add(Z.sqr()),gt=Pt.determinant(M,rt,Z,dt),Tt=Pt.determinant(x,rt,D,dt),Ot=Pt.valueOf(p.x).subtract(gt.divide(Q)).doubleValue(),zt=Pt.valueOf(p.y).add(Tt.divide(Q)).doubleValue();return new at(Ot,zt)}},{key:"isAcute",value:function(o,u,p){return!!Ye.isAcute(o,u,p)&&!!Ye.isAcute(u,p,o)&&!!Ye.isAcute(p,o,u)}},{key:"circumcentre",value:function(o,u,p){var x=p.x,M=p.y,D=o.x-x,Z=o.y-M,Q=u.x-x,rt=u.y-M,dt=2*c.det(D,Z,Q,rt),gt=c.det(Z,D*D+Z*Z,rt,Q*Q+rt*rt),Tt=c.det(D,D*D+Z*Z,Q,Q*Q+rt*rt);return new at(x-gt/dt,M+Tt/dt)}},{key:"perpendicularBisector",value:function(o,u){var p=u.x-o.x,x=u.y-o.y,M=new As(o.x+p/2,o.y+x/2,1),D=new As(o.x-x+p/2,o.y+p+x/2,1);return new As(M,D)}},{key:"angleBisector",value:function(o,u,p){var x=u.distance(o),M=x/(x+u.distance(p)),D=p.x-o.x,Z=p.y-o.y;return new at(o.x+M*D,o.y+M*Z)}},{key:"area3D",value:function(o,u,p){var x=u.x-o.x,M=u.y-o.y,D=u.getZ()-o.getZ(),Z=p.x-o.x,Q=p.y-o.y,rt=p.getZ()-o.getZ(),dt=M*rt-D*Q,gt=D*Z-x*rt,Tt=x*Q-M*Z,Ot=dt*dt+gt*gt+Tt*Tt,zt=Math.sqrt(Ot)/2;return zt}},{key:"centroid",value:function(o,u,p){var x=(o.x+u.x+p.x)/3,M=(o.y+u.y+p.y)/3;return new at(x,M)}},{key:"inCentre",value:function(o,u,p){var x=u.distance(p),M=o.distance(p),D=o.distance(u),Z=x+M+D,Q=(x*o.x+M*u.x+D*p.x)/Z,rt=(x*o.y+M*u.y+D*p.y)/Z;return new at(Q,rt)}}])}(),xo=function(){return l(function c(){n(this,c),c.constructor_.apply(this,arguments)},[{key:"addRingSide",value:function(c,o,u,p,x){if(o===0&&c.length<En.MINIMUM_VALID_SIZE)return null;var M=p,D=x;c.length>=En.MINIMUM_VALID_SIZE&&Ut.isCCW(c)&&(M=x,D=p,u=st.opposite(u));var Z=this._curveBuilder.getRingCurve(c,u,o);this.addCurve(Z,M,D)}},{key:"addRingBothSides",value:function(c,o){this.addRingSide(c,o,st.LEFT,tt.EXTERIOR,tt.INTERIOR),this.addRingSide(c,o,st.RIGHT,tt.INTERIOR,tt.EXTERIOR)}},{key:"addPoint",value:function(c){if(this._distance<=0)return null;var o=c.getCoordinates(),u=this._curveBuilder.getLineCurve(o,this._distance);this.addCurve(u,tt.EXTERIOR,tt.INTERIOR)}},{key:"addPolygon",value:function(c){var o=this._distance,u=st.LEFT;this._distance<0&&(o=-this._distance,u=st.RIGHT);var p=c.getExteriorRing(),x=Ge.removeRepeatedPoints(p.getCoordinates());if(this._distance<0&&this.isErodedCompletely(p,this._distance)||this._distance<=0&&x.length<3)return null;this.addRingSide(x,o,u,tt.EXTERIOR,tt.INTERIOR);for(var M=0;M<c.getNumInteriorRing();M++){var D=c.getInteriorRingN(M),Z=Ge.removeRepeatedPoints(D.getCoordinates());this._distance>0&&this.isErodedCompletely(D,-this._distance)||this.addRingSide(Z,o,st.opposite(u),tt.INTERIOR,tt.EXTERIOR)}}},{key:"isTriangleErodedCompletely",value:function(c,o){var u=new vo(c[0],c[1],c[2]),p=u.inCentre();return Ue.pointToSegment(p,u.p0,u.p1)<Math.abs(o)}},{key:"addLineString",value:function(c){if(this._curveBuilder.isLineOffsetEmpty(this._distance))return null;var o=Ge.removeRepeatedPoints(c.getCoordinates());if(Ge.isRing(o)&&!this._curveBuilder.getBufferParameters().isSingleSided())this.addRingBothSides(o,this._distance);else{var u=this._curveBuilder.getLineCurve(o,this._distance);this.addCurve(u,tt.EXTERIOR,tt.INTERIOR)}}},{key:"addCurve",value:function(c,o,u){if(c===null||c.length<2)return null;var p=new xi(c,new kn(0,tt.BOUNDARY,o,u));this._curveList.add(p)}},{key:"getCurves",value:function(){return this.add(this._inputGeom),this._curveList}},{key:"add",value:function(c){if(c.isEmpty())return null;if(c instanceof _r)this.addPolygon(c);else if(c instanceof Fr)this.addLineString(c);else if(c instanceof oo)this.addPoint(c);else if(c instanceof vr)this.addCollection(c);else if(c instanceof Bn)this.addCollection(c);else if(c instanceof lo)this.addCollection(c);else{if(!(c instanceof rn))throw new ct(c.getGeometryType());this.addCollection(c)}}},{key:"isErodedCompletely",value:function(c,o){var u=c.getCoordinates();if(u.length<4)return o<0;if(u.length===4)return this.isTriangleErodedCompletely(u,o);var p=c.getEnvelopeInternal(),x=Math.min(p.getHeight(),p.getWidth());return o<0&&2*Math.abs(o)>x}},{key:"addCollection",value:function(c){for(var o=0;o<c.getNumGeometries();o++){var u=c.getGeometryN(o);this.add(u)}}}],[{key:"constructor_",value:function(){this._inputGeom=null,this._distance=null,this._curveBuilder=null,this._curveList=new Ft;var c=arguments[0],o=arguments[1],u=arguments[2];this._inputGeom=c,this._distance=o,this._curveBuilder=u}}])}(),Ns=function(){return l(function c(){n(this,c)},[{key:"locate",value:function(c){}}])}(),sr=function(){function c(){n(this,c),c.constructor_.apply(this,arguments)}return l(c,[{key:"next",value:function(){if(this._atStart)return this._atStart=!1,c.isAtomic(this._parent)&&this._index++,this._parent;if(this._subcollectionIterator!==null){if(this._subcollectionIterator.hasNext())return this._subcollectionIterator.next();this._subcollectionIterator=null}if(this._index>=this._max)throw new G;var o=this._parent.getGeometryN(this._index++);return o instanceof rn?(this._subcollectionIterator=new c(o),this._subcollectionIterator.next()):o}},{key:"remove",value:function(){throw new ct(this.getClass().getName())}},{key:"hasNext",value:function(){if(this._atStart)return!0;if(this._subcollectionIterator!==null){if(this._subcollectionIterator.hasNext())return!0;this._subcollectionIterator=null}return!(this._index>=this._max)}},{key:"interfaces_",get:function(){return[au]}}],[{key:"constructor_",value:function(){this._parent=null,this._atStart=null,this._max=null,this._index=null,this._subcollectionIterator=null;var o=arguments[0];this._parent=o,this._atStart=!0,this._index=0,this._max=o.getNumGeometries()}},{key:"isAtomic",value:function(o){return!(o instanceof rn)}}])}(),ea=function(){function c(){n(this,c),c.constructor_.apply(this,arguments)}return l(c,[{key:"locate",value:function(o){return c.locate(o,this._geom)}},{key:"interfaces_",get:function(){return[Ns]}}],[{key:"constructor_",value:function(){this._geom=null;var o=arguments[0];this._geom=o}},{key:"locatePointInPolygon",value:function(o,u){if(u.isEmpty())return tt.EXTERIOR;var p=u.getExteriorRing(),x=c.locatePointInRing(o,p);if(x!==tt.INTERIOR)return x;for(var M=0;M<u.getNumInteriorRing();M++){var D=u.getInteriorRingN(M),Z=c.locatePointInRing(o,D);if(Z===tt.BOUNDARY)return tt.BOUNDARY;if(Z===tt.INTERIOR)return tt.EXTERIOR}return tt.INTERIOR}},{key:"locatePointInRing",value:function(o,u){return u.getEnvelopeInternal().intersects(o)?Er.locateInRing(o,u.getCoordinates()):tt.EXTERIOR}},{key:"containsPointInPolygon",value:function(o,u){return tt.EXTERIOR!==c.locatePointInPolygon(o,u)}},{key:"locateInGeometry",value:function(o,u){if(u instanceof _r)return c.locatePointInPolygon(o,u);if(u instanceof rn)for(var p=new sr(u);p.hasNext();){var x=p.next();if(x!==u){var M=c.locateInGeometry(o,x);if(M!==tt.EXTERIOR)return M}}return tt.EXTERIOR}},{key:"isContained",value:function(o,u){return tt.EXTERIOR!==c.locate(o,u)}},{key:"locate",value:function(o,u){return u.isEmpty()?tt.EXTERIOR:u.getEnvelopeInternal().intersects(o)?c.locateInGeometry(o,u):tt.EXTERIOR}}])}(),na=function(){return l(function c(){n(this,c),c.constructor_.apply(this,arguments)},[{key:"getNextCW",value:function(c){this.getEdges();var o=this._edgeList.indexOf(c),u=o-1;return o===0&&(u=this._edgeList.size()-1),this._edgeList.get(u)}},{key:"propagateSideLabels",value:function(c){for(var o=tt.NONE,u=this.iterator();u.hasNext();){var p=u.next().getLabel();p.isArea(c)&&p.getLocation(c,st.LEFT)!==tt.NONE&&(o=p.getLocation(c,st.LEFT))}if(o===tt.NONE)return null;for(var x=o,M=this.iterator();M.hasNext();){var D=M.next(),Z=D.getLabel();if(Z.getLocation(c,st.ON)===tt.NONE&&Z.setLocation(c,st.ON,x),Z.isArea(c)){var Q=Z.getLocation(c,st.LEFT),rt=Z.getLocation(c,st.RIGHT);if(rt!==tt.NONE){if(rt!==x)throw new le("side location conflict",D.getCoordinate());Q===tt.NONE&&lt.shouldNeverReachHere("found single null side (at "+D.getCoordinate()+")"),x=Q}else lt.isTrue(Z.getLocation(c,st.LEFT)===tt.NONE,"found single null side"),Z.setLocation(c,st.RIGHT,x),Z.setLocation(c,st.LEFT,x)}}}},{key:"getCoordinate",value:function(){var c=this.iterator();return c.hasNext()?c.next().getCoordinate():null}},{key:"print",value:function(c){ze.out.println("EdgeEndStar:   "+this.getCoordinate());for(var o=this.iterator();o.hasNext();)o.next().print(c)}},{key:"isAreaLabelsConsistent",value:function(c){return this.computeEdgeEndLabels(c.getBoundaryNodeRule()),this.checkAreaLabelsConsistent(0)}},{key:"checkAreaLabelsConsistent",value:function(c){var o=this.getEdges();if(o.size()<=0)return!0;var u=o.size()-1,p=o.get(u).getLabel().getLocation(c,st.LEFT);lt.isTrue(p!==tt.NONE,"Found unlabelled area edge");for(var x=p,M=this.iterator();M.hasNext();){var D=M.next().getLabel();lt.isTrue(D.isArea(c),"Found non-area edge");var Z=D.getLocation(c,st.LEFT),Q=D.getLocation(c,st.RIGHT);if(Z===Q||Q!==x)return!1;x=Z}return!0}},{key:"findIndex",value:function(c){this.iterator();for(var o=0;o<this._edgeList.size();o++)if(this._edgeList.get(o)===c)return o;return-1}},{key:"iterator",value:function(){return this.getEdges().iterator()}},{key:"getEdges",value:function(){return this._edgeList===null&&(this._edgeList=new Ft(this._edgeMap.values())),this._edgeList}},{key:"getLocation",value:function(c,o,u){return this._ptInAreaLocation[c]===tt.NONE&&(this._ptInAreaLocation[c]=ea.locate(o,u[c].getGeometry())),this._ptInAreaLocation[c]}},{key:"toString",value:function(){var c=new Ct;c.append("EdgeEndStar:   "+this.getCoordinate()),c.append(`
`);for(var o=this.iterator();o.hasNext();){var u=o.next();c.append(u),c.append(`
`)}return c.toString()}},{key:"computeEdgeEndLabels",value:function(c){for(var o=this.iterator();o.hasNext();)o.next().computeLabel(c)}},{key:"computeLabelling",value:function(c){this.computeEdgeEndLabels(c[0].getBoundaryNodeRule()),this.propagateSideLabels(0),this.propagateSideLabels(1);for(var o=[!1,!1],u=this.iterator();u.hasNext();)for(var p=u.next().getLabel(),x=0;x<2;x++)p.isLine(x)&&p.getLocation(x)===tt.BOUNDARY&&(o[x]=!0);for(var M=this.iterator();M.hasNext();)for(var D=M.next(),Z=D.getLabel(),Q=0;Q<2;Q++)if(Z.isAnyNull(Q)){var rt=tt.NONE;if(o[Q])rt=tt.EXTERIOR;else{var dt=D.getCoordinate();rt=this.getLocation(Q,dt,c)}Z.setAllLocationsIfNull(Q,rt)}}},{key:"getDegree",value:function(){return this._edgeMap.size()}},{key:"insertEdgeEnd",value:function(c,o){this._edgeMap.put(c,o),this._edgeList=null}}],[{key:"constructor_",value:function(){this._edgeMap=new Be,this._edgeList=null,this._ptInAreaLocation=[tt.NONE,tt.NONE]}}])}(),Mn=function(c){function o(){var u;return n(this,o),u=i(this,o),o.constructor_.apply(u,arguments),u}return m(o,c),l(o,[{key:"linkResultDirectedEdges",value:function(){this.getResultAreaEdges();for(var u=null,p=null,x=this._SCANNING_FOR_INCOMING,M=0;M<this._resultAreaEdgeList.size();M++){var D=this._resultAreaEdgeList.get(M),Z=D.getSym();if(D.getLabel().isArea())switch(u===null&&D.isInResult()&&(u=D),x){case this._SCANNING_FOR_INCOMING:if(!Z.isInResult())continue;p=Z,x=this._LINKING_TO_OUTGOING;break;case this._LINKING_TO_OUTGOING:if(!D.isInResult())continue;p.setNext(D),x=this._SCANNING_FOR_INCOMING}}if(x===this._LINKING_TO_OUTGOING){if(u===null)throw new le("no outgoing dirEdge found",this.getCoordinate());lt.isTrue(u.isInResult(),"unable to link last incoming dirEdge"),p.setNext(u)}}},{key:"insert",value:function(u){var p=u;this.insertEdgeEnd(p,p)}},{key:"getRightmostEdge",value:function(){var u=this.getEdges(),p=u.size();if(p<1)return null;var x=u.get(0);if(p===1)return x;var M=u.get(p-1),D=x.getQuadrant(),Z=M.getQuadrant();return ln.isNorthern(D)&&ln.isNorthern(Z)?x:ln.isNorthern(D)||ln.isNorthern(Z)?x.getDy()!==0?x:M.getDy()!==0?M:(lt.shouldNeverReachHere("found two horizontal edges incident on node"),null):M}},{key:"print",value:function(u){ze.out.println("DirectedEdgeStar: "+this.getCoordinate());for(var p=this.iterator();p.hasNext();){var x=p.next();u.print("out "),x.print(u),u.println(),u.print("in "),x.getSym().print(u),u.println()}}},{key:"getResultAreaEdges",value:function(){if(this._resultAreaEdgeList!==null)return this._resultAreaEdgeList;this._resultAreaEdgeList=new Ft;for(var u=this.iterator();u.hasNext();){var p=u.next();(p.isInResult()||p.getSym().isInResult())&&this._resultAreaEdgeList.add(p)}return this._resultAreaEdgeList}},{key:"updateLabelling",value:function(u){for(var p=this.iterator();p.hasNext();){var x=p.next().getLabel();x.setAllLocationsIfNull(0,u.getLocation(0)),x.setAllLocationsIfNull(1,u.getLocation(1))}}},{key:"linkAllDirectedEdges",value:function(){this.getEdges();for(var u=null,p=null,x=this._edgeList.size()-1;x>=0;x--){var M=this._edgeList.get(x),D=M.getSym();p===null&&(p=D),u!==null&&D.setNext(u),u=M}p.setNext(u)}},{key:"computeDepths",value:function(){if(arguments.length===1){var u=arguments[0],p=this.findIndex(u),x=u.getDepth(st.LEFT),M=u.getDepth(st.RIGHT),D=this.computeDepths(p+1,this._edgeList.size(),x);if(this.computeDepths(0,p,D)!==M)throw new le("depth mismatch at "+u.getCoordinate())}else if(arguments.length===3){for(var Z=arguments[1],Q=arguments[2],rt=arguments[0];rt<Z;rt++){var dt=this._edgeList.get(rt);dt.setEdgeDepths(st.RIGHT,Q),Q=dt.getDepth(st.LEFT)}return Q}}},{key:"mergeSymLabels",value:function(){for(var u=this.iterator();u.hasNext();){var p=u.next();p.getLabel().merge(p.getSym().getLabel())}}},{key:"linkMinimalDirectedEdges",value:function(u){for(var p=null,x=null,M=this._SCANNING_FOR_INCOMING,D=this._resultAreaEdgeList.size()-1;D>=0;D--){var Z=this._resultAreaEdgeList.get(D),Q=Z.getSym();switch(p===null&&Z.getEdgeRing()===u&&(p=Z),M){case this._SCANNING_FOR_INCOMING:if(Q.getEdgeRing()!==u)continue;x=Q,M=this._LINKING_TO_OUTGOING;break;case this._LINKING_TO_OUTGOING:if(Z.getEdgeRing()!==u)continue;x.setNextMin(Z),M=this._SCANNING_FOR_INCOMING}}M===this._LINKING_TO_OUTGOING&&(lt.isTrue(p!==null,"found null for first outgoing dirEdge"),lt.isTrue(p.getEdgeRing()===u,"unable to link last incoming dirEdge"),x.setNextMin(p))}},{key:"getOutgoingDegree",value:function(){if(arguments.length===0){for(var u=0,p=this.iterator();p.hasNext();)p.next().isInResult()&&u++;return u}if(arguments.length===1){for(var x=arguments[0],M=0,D=this.iterator();D.hasNext();)D.next().getEdgeRing()===x&&M++;return M}}},{key:"getLabel",value:function(){return this._label}},{key:"findCoveredLineEdges",value:function(){for(var u=tt.NONE,p=this.iterator();p.hasNext();){var x=p.next(),M=x.getSym();if(!x.isLineEdge()){if(x.isInResult()){u=tt.INTERIOR;break}if(M.isInResult()){u=tt.EXTERIOR;break}}}if(u===tt.NONE)return null;for(var D=u,Z=this.iterator();Z.hasNext();){var Q=Z.next(),rt=Q.getSym();Q.isLineEdge()?Q.getEdge().setCovered(D===tt.INTERIOR):(Q.isInResult()&&(D=tt.EXTERIOR),rt.isInResult()&&(D=tt.INTERIOR))}}},{key:"computeLabelling",value:function(u){w(o,"computeLabelling",this,1).call(this,u),this._label=new kn(tt.NONE);for(var p=this.iterator();p.hasNext();)for(var x=p.next().getEdge().getLabel(),M=0;M<2;M++){var D=x.getLocation(M);D!==tt.INTERIOR&&D!==tt.BOUNDARY||this._label.setLocation(M,tt.INTERIOR)}}}],[{key:"constructor_",value:function(){this._resultAreaEdgeList=null,this._label=null,this._SCANNING_FOR_INCOMING=1,this._LINKING_TO_OUTGOING=2}}])}(na),Mr=function(c){function o(){return n(this,o),i(this,o)}return m(o,c),l(o,[{key:"createNode",value:function(u){return new Zr(u,new Mn)}}])}(po),or=function(){function c(){n(this,c),c.constructor_.apply(this,arguments)}return l(c,[{key:"compareTo",value:function(o){var u=o;return c.compareOriented(this._pts,this._orientation,u._pts,u._orientation)}},{key:"interfaces_",get:function(){return[U]}}],[{key:"constructor_",value:function(){this._pts=null,this._orientation=null;var o=arguments[0];this._pts=o,this._orientation=c.orientation(o)}},{key:"orientation",value:function(o){return Ge.increasingDirection(o)===1}},{key:"compareOriented",value:function(o,u,p,x){for(var M=u?1:-1,D=x?1:-1,Z=u?o.length:-1,Q=x?p.length:-1,rt=u?0:o.length-1,dt=x?0:p.length-1;;){var gt=o[rt].compareTo(p[dt]);if(gt!==0)return gt;var Tt=(rt+=M)===Z,Ot=(dt+=D)===Q;if(Tt&&!Ot)return-1;if(!Tt&&Ot)return 1;if(Tt&&Ot)return 0}}}])}(),Ln=function(){return l(function c(){n(this,c),c.constructor_.apply(this,arguments)},[{key:"print",value:function(c){c.print("MULTILINESTRING ( ");for(var o=0;o<this._edges.size();o++){var u=this._edges.get(o);o>0&&c.print(","),c.print("(");for(var p=u.getCoordinates(),x=0;x<p.length;x++)x>0&&c.print(","),c.print(p[x].x+" "+p[x].y);c.println(")")}c.print(")  ")}},{key:"addAll",value:function(c){for(var o=c.iterator();o.hasNext();)this.add(o.next())}},{key:"findEdgeIndex",value:function(c){for(var o=0;o<this._edges.size();o++)if(this._edges.get(o).equals(c))return o;return-1}},{key:"iterator",value:function(){return this._edges.iterator()}},{key:"getEdges",value:function(){return this._edges}},{key:"get",value:function(c){return this._edges.get(c)}},{key:"findEqualEdge",value:function(c){var o=new or(c.getCoordinates());return this._ocaMap.get(o)}},{key:"add",value:function(c){this._edges.add(c);var o=new or(c.getCoordinates());this._ocaMap.put(o,c)}}],[{key:"constructor_",value:function(){this._edges=new Ft,this._ocaMap=new Be}}])}(),fn=function(){return l(function c(){n(this,c)},[{key:"processIntersections",value:function(c,o,u,p){}},{key:"isDone",value:function(){}}])}(),Vn=function(){function c(){n(this,c),c.constructor_.apply(this,arguments)}return l(c,[{key:"isTrivialIntersection",value:function(o,u,p,x){if(o===p&&this._li.getIntersectionNum()===1){if(c.isAdjacentSegments(u,x))return!0;if(o.isClosed()){var M=o.size()-1;if(u===0&&x===M||x===0&&u===M)return!0}}return!1}},{key:"getProperIntersectionPoint",value:function(){return this._properIntersectionPoint}},{key:"hasProperInteriorIntersection",value:function(){return this._hasProperInterior}},{key:"getLineIntersector",value:function(){return this._li}},{key:"hasProperIntersection",value:function(){return this._hasProper}},{key:"processIntersections",value:function(o,u,p,x){if(o===p&&u===x)return null;this.numTests++;var M=o.getCoordinates()[u],D=o.getCoordinates()[u+1],Z=p.getCoordinates()[x],Q=p.getCoordinates()[x+1];this._li.computeIntersection(M,D,Z,Q),this._li.hasIntersection()&&(this.numIntersections++,this._li.isInteriorIntersection()&&(this.numInteriorIntersections++,this._hasInterior=!0),this.isTrivialIntersection(o,u,p,x)||(this._hasIntersection=!0,o.addIntersections(this._li,u,0),p.addIntersections(this._li,x,1),this._li.isProper()&&(this.numProperIntersections++,this._hasProper=!0,this._hasProperInterior=!0)))}},{key:"hasIntersection",value:function(){return this._hasIntersection}},{key:"isDone",value:function(){return!1}},{key:"hasInteriorIntersection",value:function(){return this._hasInterior}},{key:"interfaces_",get:function(){return[fn]}}],[{key:"constructor_",value:function(){this._hasIntersection=!1,this._hasProper=!1,this._hasProperInterior=!1,this._hasInterior=!1,this._properIntersectionPoint=null,this._li=null,this._isSelfIntersection=null,this.numIntersections=0,this.numInteriorIntersections=0,this.numProperIntersections=0,this.numTests=0;var o=arguments[0];this._li=o}},{key:"isAdjacentSegments",value:function(o,u){return Math.abs(o-u)===1}}])}(),wo=function(){return l(function c(){n(this,c),c.constructor_.apply(this,arguments)},[{key:"getSegmentIndex",value:function(){return this.segmentIndex}},{key:"getCoordinate",value:function(){return this.coord}},{key:"print",value:function(c){c.print(this.coord),c.print(" seg # = "+this.segmentIndex),c.println(" dist = "+this.dist)}},{key:"compareTo",value:function(c){var o=c;return this.compare(o.segmentIndex,o.dist)}},{key:"isEndPoint",value:function(c){return this.segmentIndex===0&&this.dist===0||this.segmentIndex===c}},{key:"toString",value:function(){return this.coord+" seg # = "+this.segmentIndex+" dist = "+this.dist}},{key:"getDistance",value:function(){return this.dist}},{key:"compare",value:function(c,o){return this.segmentIndex<c?-1:this.segmentIndex>c?1:this.dist<o?-1:this.dist>o?1:0}},{key:"interfaces_",get:function(){return[U]}}],[{key:"constructor_",value:function(){this.coord=null,this.segmentIndex=null,this.dist=null;var c=arguments[0],o=arguments[1],u=arguments[2];this.coord=new at(c),this.segmentIndex=o,this.dist=u}}])}(),ar=function(){return l(function c(){n(this,c),c.constructor_.apply(this,arguments)},[{key:"print",value:function(c){c.println("Intersections:");for(var o=this.iterator();o.hasNext();)o.next().print(c)}},{key:"iterator",value:function(){return this._nodeMap.values().iterator()}},{key:"addSplitEdges",value:function(c){this.addEndpoints();for(var o=this.iterator(),u=o.next();o.hasNext();){var p=o.next(),x=this.createSplitEdge(u,p);c.add(x),u=p}}},{key:"addEndpoints",value:function(){var c=this.edge.pts.length-1;this.add(this.edge.pts[0],0,0),this.add(this.edge.pts[c],c,0)}},{key:"createSplitEdge",value:function(c,o){var u=o.segmentIndex-c.segmentIndex+2,p=this.edge.pts[o.segmentIndex],x=o.dist>0||!o.coord.equals2D(p);x||u--;var M=new Array(u).fill(null),D=0;M[D++]=new at(c.coord);for(var Z=c.segmentIndex+1;Z<=o.segmentIndex;Z++)M[D++]=this.edge.pts[Z];return x&&(M[D]=o.coord),new bo(M,new kn(this.edge._label))}},{key:"add",value:function(c,o,u){var p=new wo(c,o,u),x=this._nodeMap.get(p);return x!==null?x:(this._nodeMap.put(p,p),p)}},{key:"isIntersection",value:function(c){for(var o=this.iterator();o.hasNext();)if(o.next().coord.equals(c))return!0;return!1}}],[{key:"constructor_",value:function(){this._nodeMap=new Be,this.edge=null;var c=arguments[0];this.edge=c}}])}(),ia=function(){function c(){n(this,c),c.constructor_.apply(this,arguments)}return l(c,[{key:"isIntersects",value:function(){return!this.isDisjoint()}},{key:"isCovers",value:function(){return(c.isTrue(this._matrix[tt.INTERIOR][tt.INTERIOR])||c.isTrue(this._matrix[tt.INTERIOR][tt.BOUNDARY])||c.isTrue(this._matrix[tt.BOUNDARY][tt.INTERIOR])||c.isTrue(this._matrix[tt.BOUNDARY][tt.BOUNDARY]))&&this._matrix[tt.EXTERIOR][tt.INTERIOR]===Dt.FALSE&&this._matrix[tt.EXTERIOR][tt.BOUNDARY]===Dt.FALSE}},{key:"isCoveredBy",value:function(){return(c.isTrue(this._matrix[tt.INTERIOR][tt.INTERIOR])||c.isTrue(this._matrix[tt.INTERIOR][tt.BOUNDARY])||c.isTrue(this._matrix[tt.BOUNDARY][tt.INTERIOR])||c.isTrue(this._matrix[tt.BOUNDARY][tt.BOUNDARY]))&&this._matrix[tt.INTERIOR][tt.EXTERIOR]===Dt.FALSE&&this._matrix[tt.BOUNDARY][tt.EXTERIOR]===Dt.FALSE}},{key:"set",value:function(){if(arguments.length===1)for(var o=arguments[0],u=0;u<o.length;u++){var p=Math.trunc(u/3),x=u%3;this._matrix[p][x]=Dt.toDimensionValue(o.charAt(u))}else if(arguments.length===3){var M=arguments[0],D=arguments[1],Z=arguments[2];this._matrix[M][D]=Z}}},{key:"isContains",value:function(){return c.isTrue(this._matrix[tt.INTERIOR][tt.INTERIOR])&&this._matrix[tt.EXTERIOR][tt.INTERIOR]===Dt.FALSE&&this._matrix[tt.EXTERIOR][tt.BOUNDARY]===Dt.FALSE}},{key:"setAtLeast",value:function(){if(arguments.length===1)for(var o=arguments[0],u=0;u<o.length;u++){var p=Math.trunc(u/3),x=u%3;this.setAtLeast(p,x,Dt.toDimensionValue(o.charAt(u)))}else if(arguments.length===3){var M=arguments[0],D=arguments[1],Z=arguments[2];this._matrix[M][D]<Z&&(this._matrix[M][D]=Z)}}},{key:"setAtLeastIfValid",value:function(o,u,p){o>=0&&u>=0&&this.setAtLeast(o,u,p)}},{key:"isWithin",value:function(){return c.isTrue(this._matrix[tt.INTERIOR][tt.INTERIOR])&&this._matrix[tt.INTERIOR][tt.EXTERIOR]===Dt.FALSE&&this._matrix[tt.BOUNDARY][tt.EXTERIOR]===Dt.FALSE}},{key:"isTouches",value:function(o,u){return o>u?this.isTouches(u,o):(o===Dt.A&&u===Dt.A||o===Dt.L&&u===Dt.L||o===Dt.L&&u===Dt.A||o===Dt.P&&u===Dt.A||o===Dt.P&&u===Dt.L)&&this._matrix[tt.INTERIOR][tt.INTERIOR]===Dt.FALSE&&(c.isTrue(this._matrix[tt.INTERIOR][tt.BOUNDARY])||c.isTrue(this._matrix[tt.BOUNDARY][tt.INTERIOR])||c.isTrue(this._matrix[tt.BOUNDARY][tt.BOUNDARY]))}},{key:"isOverlaps",value:function(o,u){return o===Dt.P&&u===Dt.P||o===Dt.A&&u===Dt.A?c.isTrue(this._matrix[tt.INTERIOR][tt.INTERIOR])&&c.isTrue(this._matrix[tt.INTERIOR][tt.EXTERIOR])&&c.isTrue(this._matrix[tt.EXTERIOR][tt.INTERIOR]):o===Dt.L&&u===Dt.L&&this._matrix[tt.INTERIOR][tt.INTERIOR]===1&&c.isTrue(this._matrix[tt.INTERIOR][tt.EXTERIOR])&&c.isTrue(this._matrix[tt.EXTERIOR][tt.INTERIOR])}},{key:"isEquals",value:function(o,u){return o===u&&c.isTrue(this._matrix[tt.INTERIOR][tt.INTERIOR])&&this._matrix[tt.INTERIOR][tt.EXTERIOR]===Dt.FALSE&&this._matrix[tt.BOUNDARY][tt.EXTERIOR]===Dt.FALSE&&this._matrix[tt.EXTERIOR][tt.INTERIOR]===Dt.FALSE&&this._matrix[tt.EXTERIOR][tt.BOUNDARY]===Dt.FALSE}},{key:"toString",value:function(){for(var o=new Gr("123456789"),u=0;u<3;u++)for(var p=0;p<3;p++)o.setCharAt(3*u+p,Dt.toDimensionSymbol(this._matrix[u][p]));return o.toString()}},{key:"setAll",value:function(o){for(var u=0;u<3;u++)for(var p=0;p<3;p++)this._matrix[u][p]=o}},{key:"get",value:function(o,u){return this._matrix[o][u]}},{key:"transpose",value:function(){var o=this._matrix[1][0];return this._matrix[1][0]=this._matrix[0][1],this._matrix[0][1]=o,o=this._matrix[2][0],this._matrix[2][0]=this._matrix[0][2],this._matrix[0][2]=o,o=this._matrix[2][1],this._matrix[2][1]=this._matrix[1][2],this._matrix[1][2]=o,this}},{key:"matches",value:function(o){if(o.length!==9)throw new P("Should be length 9: "+o);for(var u=0;u<3;u++)for(var p=0;p<3;p++)if(!c.matches(this._matrix[u][p],o.charAt(3*u+p)))return!1;return!0}},{key:"add",value:function(o){for(var u=0;u<3;u++)for(var p=0;p<3;p++)this.setAtLeast(u,p,o.get(u,p))}},{key:"isDisjoint",value:function(){return this._matrix[tt.INTERIOR][tt.INTERIOR]===Dt.FALSE&&this._matrix[tt.INTERIOR][tt.BOUNDARY]===Dt.FALSE&&this._matrix[tt.BOUNDARY][tt.INTERIOR]===Dt.FALSE&&this._matrix[tt.BOUNDARY][tt.BOUNDARY]===Dt.FALSE}},{key:"isCrosses",value:function(o,u){return o===Dt.P&&u===Dt.L||o===Dt.P&&u===Dt.A||o===Dt.L&&u===Dt.A?c.isTrue(this._matrix[tt.INTERIOR][tt.INTERIOR])&&c.isTrue(this._matrix[tt.INTERIOR][tt.EXTERIOR]):o===Dt.L&&u===Dt.P||o===Dt.A&&u===Dt.P||o===Dt.A&&u===Dt.L?c.isTrue(this._matrix[tt.INTERIOR][tt.INTERIOR])&&c.isTrue(this._matrix[tt.EXTERIOR][tt.INTERIOR]):o===Dt.L&&u===Dt.L&&this._matrix[tt.INTERIOR][tt.INTERIOR]===0}},{key:"interfaces_",get:function(){return[I]}}],[{key:"constructor_",value:function(){if(this._matrix=null,arguments.length===0)this._matrix=Array(3).fill().map(function(){return Array(3)}),this.setAll(Dt.FALSE);else if(arguments.length===1){if(typeof arguments[0]=="string"){var o=arguments[0];c.constructor_.call(this),this.set(o)}else if(arguments[0]instanceof c){var u=arguments[0];c.constructor_.call(this),this._matrix[tt.INTERIOR][tt.INTERIOR]=u._matrix[tt.INTERIOR][tt.INTERIOR],this._matrix[tt.INTERIOR][tt.BOUNDARY]=u._matrix[tt.INTERIOR][tt.BOUNDARY],this._matrix[tt.INTERIOR][tt.EXTERIOR]=u._matrix[tt.INTERIOR][tt.EXTERIOR],this._matrix[tt.BOUNDARY][tt.INTERIOR]=u._matrix[tt.BOUNDARY][tt.INTERIOR],this._matrix[tt.BOUNDARY][tt.BOUNDARY]=u._matrix[tt.BOUNDARY][tt.BOUNDARY],this._matrix[tt.BOUNDARY][tt.EXTERIOR]=u._matrix[tt.BOUNDARY][tt.EXTERIOR],this._matrix[tt.EXTERIOR][tt.INTERIOR]=u._matrix[tt.EXTERIOR][tt.INTERIOR],this._matrix[tt.EXTERIOR][tt.BOUNDARY]=u._matrix[tt.EXTERIOR][tt.BOUNDARY],this._matrix[tt.EXTERIOR][tt.EXTERIOR]=u._matrix[tt.EXTERIOR][tt.EXTERIOR]}}}},{key:"matches",value:function(){if(Number.isInteger(arguments[0])&&typeof arguments[1]=="string"){var o=arguments[0],u=arguments[1];return u===Dt.SYM_DONTCARE||u===Dt.SYM_TRUE&&(o>=0||o===Dt.TRUE)||u===Dt.SYM_FALSE&&o===Dt.FALSE||u===Dt.SYM_P&&o===Dt.P||u===Dt.SYM_L&&o===Dt.L||u===Dt.SYM_A&&o===Dt.A}if(typeof arguments[0]=="string"&&typeof arguments[1]=="string"){var p=arguments[1];return new c(arguments[0]).matches(p)}}},{key:"isTrue",value:function(o){return o>=0||o===Dt.TRUE}}])}(),ur=function(){function c(){n(this,c),c.constructor_.apply(this,arguments)}return l(c,[{key:"size",value:function(){return this._size}},{key:"addAll",value:function(o){return o===null||o.length===0?null:(this.ensureCapacity(this._size+o.length),ze.arraycopy(o,0,this._data,this._size,o.length),void(this._size+=o.length))}},{key:"ensureCapacity",value:function(o){if(o<=this._data.length)return null;var u=Math.max(o,2*this._data.length);this._data=an.copyOf(this._data,u)}},{key:"toArray",value:function(){var o=new Array(this._size).fill(null);return ze.arraycopy(this._data,0,o,0,this._size),o}},{key:"add",value:function(o){this.ensureCapacity(this._size+1),this._data[this._size]=o,++this._size}}],[{key:"constructor_",value:function(){if(this._data=null,this._size=0,arguments.length===0)c.constructor_.call(this,10);else if(arguments.length===1){var o=arguments[0];this._data=new Array(o).fill(null)}}}])}(),Os=function(){function c(){n(this,c)}return l(c,[{key:"getChainStartIndices",value:function(o){var u=0,p=new ur(Math.trunc(o.length/2));p.add(u);do{var x=this.findChainEnd(o,u);p.add(x),u=x}while(u<o.length-1);return p.toArray()}},{key:"findChainEnd",value:function(o,u){for(var p=ln.quadrant(o[u],o[u+1]),x=u+1;x<o.length&&ln.quadrant(o[x-1],o[x])===p;)x++;return x-1}},{key:"OLDgetChainStartIndices",value:function(o){var u=0,p=new Ft;p.add(u);do{var x=this.findChainEnd(o,u);p.add(x),u=x}while(u<o.length-1);return c.toIntArray(p)}}],[{key:"toIntArray",value:function(o){for(var u=new Array(o.size()).fill(null),p=0;p<u.length;p++)u[p]=o.get(p).intValue();return u}}])}(),Ke=function(){return l(function c(){n(this,c),c.constructor_.apply(this,arguments)},[{key:"getCoordinates",value:function(){return this.pts}},{key:"getMaxX",value:function(c){var o=this.pts[this.startIndex[c]].x,u=this.pts[this.startIndex[c+1]].x;return o>u?o:u}},{key:"getMinX",value:function(c){var o=this.pts[this.startIndex[c]].x,u=this.pts[this.startIndex[c+1]].x;return o<u?o:u}},{key:"computeIntersectsForChain",value:function(){if(arguments.length===4){var c=arguments[0],o=arguments[1],u=arguments[2],p=arguments[3];this.computeIntersectsForChain(this.startIndex[c],this.startIndex[c+1],o,o.startIndex[u],o.startIndex[u+1],p)}else if(arguments.length===6){var x=arguments[0],M=arguments[1],D=arguments[2],Z=arguments[3],Q=arguments[4],rt=arguments[5];if(M-x==1&&Q-Z==1)return rt.addIntersections(this.e,x,D.e,Z),null;if(!this.overlaps(x,M,D,Z,Q))return null;var dt=Math.trunc((x+M)/2),gt=Math.trunc((Z+Q)/2);x<dt&&(Z<gt&&this.computeIntersectsForChain(x,dt,D,Z,gt,rt),gt<Q&&this.computeIntersectsForChain(x,dt,D,gt,Q,rt)),dt<M&&(Z<gt&&this.computeIntersectsForChain(dt,M,D,Z,gt,rt),gt<Q&&this.computeIntersectsForChain(dt,M,D,gt,Q,rt))}}},{key:"overlaps",value:function(c,o,u,p,x){return xt.intersects(this.pts[c],this.pts[o],u.pts[p],u.pts[x])}},{key:"getStartIndexes",value:function(){return this.startIndex}},{key:"computeIntersects",value:function(c,o){for(var u=0;u<this.startIndex.length-1;u++)for(var p=0;p<c.startIndex.length-1;p++)this.computeIntersectsForChain(u,c,p,o)}}],[{key:"constructor_",value:function(){this.e=null,this.pts=null,this.startIndex=null;var c=arguments[0];this.e=c,this.pts=c.getCoordinates();var o=new Os;this.startIndex=o.getChainStartIndices(this.pts)}}])}(),oi=function(){function c(){n(this,c),c.constructor_.apply(this,arguments)}return l(c,[{key:"getDepth",value:function(o,u){return this._depth[o][u]}},{key:"setDepth",value:function(o,u,p){this._depth[o][u]=p}},{key:"isNull",value:function(){if(arguments.length===0){for(var o=0;o<2;o++)for(var u=0;u<3;u++)if(this._depth[o][u]!==c.NULL_VALUE)return!1;return!0}if(arguments.length===1){var p=arguments[0];return this._depth[p][1]===c.NULL_VALUE}if(arguments.length===2){var x=arguments[0],M=arguments[1];return this._depth[x][M]===c.NULL_VALUE}}},{key:"normalize",value:function(){for(var o=0;o<2;o++)if(!this.isNull(o)){var u=this._depth[o][1];this._depth[o][2]<u&&(u=this._depth[o][2]),u<0&&(u=0);for(var p=1;p<3;p++){var x=0;this._depth[o][p]>u&&(x=1),this._depth[o][p]=x}}}},{key:"getDelta",value:function(o){return this._depth[o][st.RIGHT]-this._depth[o][st.LEFT]}},{key:"getLocation",value:function(o,u){return this._depth[o][u]<=0?tt.EXTERIOR:tt.INTERIOR}},{key:"toString",value:function(){return"A: "+this._depth[0][1]+","+this._depth[0][2]+" B: "+this._depth[1][1]+","+this._depth[1][2]}},{key:"add",value:function(){if(arguments.length===1)for(var o=arguments[0],u=0;u<2;u++)for(var p=1;p<3;p++){var x=o.getLocation(u,p);x!==tt.EXTERIOR&&x!==tt.INTERIOR||(this.isNull(u,p)?this._depth[u][p]=c.depthAtLocation(x):this._depth[u][p]+=c.depthAtLocation(x))}else if(arguments.length===3){var M=arguments[0],D=arguments[1];arguments[2]===tt.INTERIOR&&this._depth[M][D]++}}}],[{key:"constructor_",value:function(){this._depth=Array(2).fill().map(function(){return Array(3)});for(var o=0;o<2;o++)for(var u=0;u<3;u++)this._depth[o][u]=c.NULL_VALUE}},{key:"depthAtLocation",value:function(o){return o===tt.EXTERIOR?0:o===tt.INTERIOR?1:c.NULL_VALUE}}])}();oi.NULL_VALUE=-1;var bo=function(c){function o(){var u;return n(this,o),u=i(this,o),o.constructor_.apply(u,arguments),u}return m(o,c),l(o,[{key:"getDepth",value:function(){return this._depth}},{key:"getCollapsedEdge",value:function(){var u=new Array(2).fill(null);return u[0]=this.pts[0],u[1]=this.pts[1],new o(u,kn.toLineLabel(this._label))}},{key:"isIsolated",value:function(){return this._isIsolated}},{key:"getCoordinates",value:function(){return this.pts}},{key:"setIsolated",value:function(u){this._isIsolated=u}},{key:"setName",value:function(u){this._name=u}},{key:"equals",value:function(u){if(!(u instanceof o))return!1;var p=u;if(this.pts.length!==p.pts.length)return!1;for(var x=!0,M=!0,D=this.pts.length,Z=0;Z<this.pts.length;Z++)if(this.pts[Z].equals2D(p.pts[Z])||(x=!1),this.pts[Z].equals2D(p.pts[--D])||(M=!1),!x&&!M)return!1;return!0}},{key:"getCoordinate",value:function(){if(arguments.length===0)return this.pts.length>0?this.pts[0]:null;if(arguments.length===1){var u=arguments[0];return this.pts[u]}}},{key:"print",value:function(u){u.print("edge "+this._name+": "),u.print("LINESTRING (");for(var p=0;p<this.pts.length;p++)p>0&&u.print(","),u.print(this.pts[p].x+" "+this.pts[p].y);u.print(")  "+this._label+" "+this._depthDelta)}},{key:"computeIM",value:function(u){o.updateIM(this._label,u)}},{key:"isCollapsed",value:function(){return!!this._label.isArea()&&this.pts.length===3&&!!this.pts[0].equals(this.pts[2])}},{key:"isClosed",value:function(){return this.pts[0].equals(this.pts[this.pts.length-1])}},{key:"getMaximumSegmentIndex",value:function(){return this.pts.length-1}},{key:"getDepthDelta",value:function(){return this._depthDelta}},{key:"getNumPoints",value:function(){return this.pts.length}},{key:"printReverse",value:function(u){u.print("edge "+this._name+": ");for(var p=this.pts.length-1;p>=0;p--)u.print(this.pts[p]+" ");u.println("")}},{key:"getMonotoneChainEdge",value:function(){return this._mce===null&&(this._mce=new Ke(this)),this._mce}},{key:"getEnvelope",value:function(){if(this._env===null){this._env=new xt;for(var u=0;u<this.pts.length;u++)this._env.expandToInclude(this.pts[u])}return this._env}},{key:"addIntersection",value:function(u,p,x,M){var D=new at(u.getIntersection(M)),Z=p,Q=u.getEdgeDistance(x,M),rt=Z+1;if(rt<this.pts.length){var dt=this.pts[rt];D.equals2D(dt)&&(Z=rt,Q=0)}this.eiList.add(D,Z,Q)}},{key:"toString",value:function(){var u=new Gr;u.append("edge "+this._name+": "),u.append("LINESTRING (");for(var p=0;p<this.pts.length;p++)p>0&&u.append(","),u.append(this.pts[p].x+" "+this.pts[p].y);return u.append(")  "+this._label+" "+this._depthDelta),u.toString()}},{key:"isPointwiseEqual",value:function(u){if(this.pts.length!==u.pts.length)return!1;for(var p=0;p<this.pts.length;p++)if(!this.pts[p].equals2D(u.pts[p]))return!1;return!0}},{key:"setDepthDelta",value:function(u){this._depthDelta=u}},{key:"getEdgeIntersectionList",value:function(){return this.eiList}},{key:"addIntersections",value:function(u,p,x){for(var M=0;M<u.getIntersectionNum();M++)this.addIntersection(u,p,x,M)}}],[{key:"constructor_",value:function(){if(this.pts=null,this._env=null,this.eiList=new ar(this),this._name=null,this._mce=null,this._isIsolated=!0,this._depth=new oi,this._depthDelta=0,arguments.length===1){var u=arguments[0];o.constructor_.call(this,u,null)}else if(arguments.length===2){var p=arguments[0],x=arguments[1];this.pts=p,this._label=x}}},{key:"updateIM",value:function(){if(!(arguments.length===2&&arguments[1]instanceof ia&&arguments[0]instanceof kn))return w(o,"updateIM",this).apply(this,arguments);var u=arguments[0],p=arguments[1];p.setAtLeastIfValid(u.getLocation(0,st.ON),u.getLocation(1,st.ON),1),u.isArea()&&(p.setAtLeastIfValid(u.getLocation(0,st.LEFT),u.getLocation(1,st.LEFT),2),p.setAtLeastIfValid(u.getLocation(0,st.RIGHT),u.getLocation(1,st.RIGHT),2))}}])}(Le),lr=function(){function c(){n(this,c),c.constructor_.apply(this,arguments)}return l(c,[{key:"setWorkingPrecisionModel",value:function(o){this._workingPrecisionModel=o}},{key:"insertUniqueEdge",value:function(o){var u=this._edgeList.findEqualEdge(o);if(u!==null){var p=u.getLabel(),x=o.getLabel();u.isPointwiseEqual(o)||(x=new kn(o.getLabel())).flip(),p.merge(x);var M=c.depthDelta(x),D=u.getDepthDelta()+M;u.setDepthDelta(D)}else this._edgeList.add(o),o.setDepthDelta(c.depthDelta(o.getLabel()))}},{key:"buildSubgraphs",value:function(o,u){for(var p=new Ft,x=o.iterator();x.hasNext();){var M=x.next(),D=M.getRightmostCoordinate(),Z=new Nn(p).getDepth(D);M.computeDepth(Z),M.findResultEdges(),p.add(M),u.add(M.getDirectedEdges(),M.getNodes())}}},{key:"createSubgraphs",value:function(o){for(var u=new Ft,p=o.getNodes().iterator();p.hasNext();){var x=p.next();if(!x.isVisited()){var M=new Dn;M.create(x),u.add(M)}}return nr.sort(u,nr.reverseOrder()),u}},{key:"createEmptyResultGeometry",value:function(){return this._geomFact.createPolygon()}},{key:"getNoder",value:function(o){if(this._workingNoder!==null)return this._workingNoder;var u=new yo,p=new _i;return p.setPrecisionModel(o),u.setSegmentIntersector(new Vn(p)),u}},{key:"buffer",value:function(o,u){var p=this._workingPrecisionModel;p===null&&(p=o.getPrecisionModel()),this._geomFact=o.getFactory();var x=new Xr(p,this._bufParams),M=new xo(o,u,x).getCurves();if(M.size()<=0)return this.createEmptyResultGeometry();this.computeNodedEdges(M,p),this._graph=new Ss(new Mr),this._graph.addEdges(this._edgeList.getEdges());var D=this.createSubgraphs(this._graph),Z=new ru(this._geomFact);this.buildSubgraphs(D,Z);var Q=Z.getPolygons();return Q.size()<=0?this.createEmptyResultGeometry():this._geomFact.buildGeometry(Q)}},{key:"computeNodedEdges",value:function(o,u){var p=this.getNoder(u);p.computeNodes(o);for(var x=p.getNodedSubstrings().iterator();x.hasNext();){var M=x.next(),D=M.getCoordinates();if(D.length!==2||!D[0].equals2D(D[1])){var Z=M.getData(),Q=new bo(M.getCoordinates(),new kn(Z));this.insertUniqueEdge(Q)}}}},{key:"setNoder",value:function(o){this._workingNoder=o}}],[{key:"constructor_",value:function(){this._bufParams=null,this._workingPrecisionModel=null,this._workingNoder=null,this._geomFact=null,this._graph=null,this._edgeList=new Ln;var o=arguments[0];this._bufParams=o}},{key:"depthDelta",value:function(o){var u=o.getLocation(0,st.LEFT),p=o.getLocation(0,st.RIGHT);return u===tt.INTERIOR&&p===tt.EXTERIOR?1:u===tt.EXTERIOR&&p===tt.INTERIOR?-1:0}},{key:"convertSegStrings",value:function(o){for(var u=new ni,p=new Ft;o.hasNext();){var x=o.next(),M=u.createLineString(x.getCoordinates());p.add(M)}return u.buildGeometry(p)}}])}(),Rs=function(){function c(){n(this,c),c.constructor_.apply(this,arguments)}return l(c,[{key:"rescale",value:function(){if(St(arguments[0],wt))for(var o=arguments[0].iterator();o.hasNext();){var u=o.next();this.rescale(u.getCoordinates())}else if(arguments[0]instanceof Array){for(var p=arguments[0],x=0;x<p.length;x++)p[x].x=p[x].x/this._scaleFactor+this._offsetX,p[x].y=p[x].y/this._scaleFactor+this._offsetY;p.length===2&&p[0].equals2D(p[1])&&ze.out.println(p)}}},{key:"scale",value:function(){if(St(arguments[0],wt)){for(var o=arguments[0],u=new Ft(o.size()),p=o.iterator();p.hasNext();){var x=p.next();u.add(new xi(this.scale(x.getCoordinates()),x.getData()))}return u}if(arguments[0]instanceof Array){for(var M=arguments[0],D=new Array(M.length).fill(null),Z=0;Z<M.length;Z++)D[Z]=new at(Math.round((M[Z].x-this._offsetX)*this._scaleFactor),Math.round((M[Z].y-this._offsetY)*this._scaleFactor),M[Z].getZ());return Ge.removeRepeatedPoints(D)}}},{key:"isIntegerPrecision",value:function(){return this._scaleFactor===1}},{key:"getNodedSubstrings",value:function(){var o=this._noder.getNodedSubstrings();return this._isScaled&&this.rescale(o),o}},{key:"computeNodes",value:function(o){var u=o;this._isScaled&&(u=this.scale(o)),this._noder.computeNodes(u)}},{key:"interfaces_",get:function(){return[Un]}}],[{key:"constructor_",value:function(){if(this._noder=null,this._scaleFactor=null,this._offsetX=null,this._offsetY=null,this._isScaled=!1,arguments.length===2){var o=arguments[0],u=arguments[1];c.constructor_.call(this,o,u,0,0)}else if(arguments.length===4){var p=arguments[0],x=arguments[1];this._noder=p,this._scaleFactor=x,this._isScaled=!this.isIntegerPrecision()}}}])}(),Jn=function(){function c(){n(this,c),c.constructor_.apply(this,arguments)}return l(c,[{key:"checkEndPtVertexIntersections",value:function(){if(arguments.length===0)for(var o=this._segStrings.iterator();o.hasNext();){var u=o.next().getCoordinates();this.checkEndPtVertexIntersections(u[0],this._segStrings),this.checkEndPtVertexIntersections(u[u.length-1],this._segStrings)}else if(arguments.length===2){for(var p=arguments[0],x=arguments[1].iterator();x.hasNext();)for(var M=x.next().getCoordinates(),D=1;D<M.length-1;D++)if(M[D].equals(p))throw new et("found endpt/interior pt intersection at index "+D+" :pt "+p)}}},{key:"checkInteriorIntersections",value:function(){if(arguments.length===0)for(var o=this._segStrings.iterator();o.hasNext();)for(var u=o.next(),p=this._segStrings.iterator();p.hasNext();){var x=p.next();this.checkInteriorIntersections(u,x)}else if(arguments.length===2)for(var M=arguments[0],D=arguments[1],Z=M.getCoordinates(),Q=D.getCoordinates(),rt=0;rt<Z.length-1;rt++)for(var dt=0;dt<Q.length-1;dt++)this.checkInteriorIntersections(M,rt,D,dt);else if(arguments.length===4){var gt=arguments[0],Tt=arguments[1],Ot=arguments[2],zt=arguments[3];if(gt===Ot&&Tt===zt)return null;var qt=gt.getCoordinates()[Tt],ne=gt.getCoordinates()[Tt+1],jt=Ot.getCoordinates()[zt],Ee=Ot.getCoordinates()[zt+1];if(this._li.computeIntersection(qt,ne,jt,Ee),this._li.hasIntersection()&&(this._li.isProper()||this.hasInteriorIntersection(this._li,qt,ne)||this.hasInteriorIntersection(this._li,jt,Ee)))throw new et("found non-noded intersection at "+qt+"-"+ne+" and "+jt+"-"+Ee)}}},{key:"checkValid",value:function(){this.checkEndPtVertexIntersections(),this.checkInteriorIntersections(),this.checkCollapses()}},{key:"checkCollapses",value:function(){if(arguments.length===0)for(var o=this._segStrings.iterator();o.hasNext();){var u=o.next();this.checkCollapses(u)}else if(arguments.length===1)for(var p=arguments[0].getCoordinates(),x=0;x<p.length-2;x++)this.checkCollapse(p[x],p[x+1],p[x+2])}},{key:"hasInteriorIntersection",value:function(o,u,p){for(var x=0;x<o.getIntersectionNum();x++){var M=o.getIntersection(x);if(!M.equals(u)&&!M.equals(p))return!0}return!1}},{key:"checkCollapse",value:function(o,u,p){if(o.equals(p))throw new et("found non-noded collapse at "+c.fact.createLineString([o,u,p]))}}],[{key:"constructor_",value:function(){this._li=new _i,this._segStrings=null;var o=arguments[0];this._segStrings=o}}])}();Jn.fact=new ni;var Ds=function(){function c(){n(this,c),c.constructor_.apply(this,arguments)}return l(c,[{key:"intersectsScaled",value:function(o,u){var p=Math.min(o.x,u.x),x=Math.max(o.x,u.x),M=Math.min(o.y,u.y),D=Math.max(o.y,u.y),Z=this._maxx<p||this._minx>x||this._maxy<M||this._miny>D;if(Z)return!1;var Q=this.intersectsToleranceSquare(o,u);return lt.isTrue(!(Z&&Q),"Found bad envelope test"),Q}},{key:"initCorners",value:function(o){var u=.5;this._minx=o.x-u,this._maxx=o.x+u,this._miny=o.y-u,this._maxy=o.y+u,this._corner[0]=new at(this._maxx,this._maxy),this._corner[1]=new at(this._minx,this._maxy),this._corner[2]=new at(this._minx,this._miny),this._corner[3]=new at(this._maxx,this._miny)}},{key:"intersects",value:function(o,u){return this._scaleFactor===1?this.intersectsScaled(o,u):(this.copyScaled(o,this._p0Scaled),this.copyScaled(u,this._p1Scaled),this.intersectsScaled(this._p0Scaled,this._p1Scaled))}},{key:"scale",value:function(o){return Math.round(o*this._scaleFactor)}},{key:"getCoordinate",value:function(){return this._originalPt}},{key:"copyScaled",value:function(o,u){u.x=this.scale(o.x),u.y=this.scale(o.y)}},{key:"getSafeEnvelope",value:function(){if(this._safeEnv===null){var o=c.SAFE_ENV_EXPANSION_FACTOR/this._scaleFactor;this._safeEnv=new xt(this._originalPt.x-o,this._originalPt.x+o,this._originalPt.y-o,this._originalPt.y+o)}return this._safeEnv}},{key:"intersectsPixelClosure",value:function(o,u){return this._li.computeIntersection(o,u,this._corner[0],this._corner[1]),!!this._li.hasIntersection()||(this._li.computeIntersection(o,u,this._corner[1],this._corner[2]),!!this._li.hasIntersection()||(this._li.computeIntersection(o,u,this._corner[2],this._corner[3]),!!this._li.hasIntersection()||(this._li.computeIntersection(o,u,this._corner[3],this._corner[0]),!!this._li.hasIntersection())))}},{key:"intersectsToleranceSquare",value:function(o,u){var p=!1,x=!1;return this._li.computeIntersection(o,u,this._corner[0],this._corner[1]),!!this._li.isProper()||(this._li.computeIntersection(o,u,this._corner[1],this._corner[2]),!!this._li.isProper()||(this._li.hasIntersection()&&(p=!0),this._li.computeIntersection(o,u,this._corner[2],this._corner[3]),!!this._li.isProper()||(this._li.hasIntersection()&&(x=!0),this._li.computeIntersection(o,u,this._corner[3],this._corner[0]),!!this._li.isProper()||!(!p||!x)||!!o.equals(this._pt)||!!u.equals(this._pt))))}},{key:"addSnappedNode",value:function(o,u){var p=o.getCoordinate(u),x=o.getCoordinate(u+1);return!!this.intersects(p,x)&&(o.addIntersection(this.getCoordinate(),u),!0)}}],[{key:"constructor_",value:function(){this._li=null,this._pt=null,this._originalPt=null,this._ptScaled=null,this._p0Scaled=null,this._p1Scaled=null,this._scaleFactor=null,this._minx=null,this._maxx=null,this._miny=null,this._maxy=null,this._corner=new Array(4).fill(null),this._safeEnv=null;var o=arguments[0],u=arguments[1],p=arguments[2];if(this._originalPt=o,this._pt=o,this._scaleFactor=u,this._li=p,u<=0)throw new P("Scale factor must be non-zero");u!==1&&(this._pt=new at(this.scale(o.x),this.scale(o.y)),this._p0Scaled=new at,this._p1Scaled=new at),this.initCorners(this._pt)}}])}();Ds.SAFE_ENV_EXPANSION_FACTOR=.75;var hr=function(){return l(function c(){n(this,c),c.constructor_.apply(this,arguments)},[{key:"select",value:function(){if(arguments.length!==1){if(arguments.length===2){var c=arguments[1];arguments[0].getLineSegment(c,this.selectedSegment),this.select(this.selectedSegment)}}}}],[{key:"constructor_",value:function(){this.selectedSegment=new cn}}])}(),Eo=function(){return l(function c(){n(this,c),c.constructor_.apply(this,arguments)},[{key:"snap",value:function(){if(arguments.length===1){var c=arguments[0];return this.snap(c,null,-1)}if(arguments.length===3){var o=arguments[0],u=arguments[1],p=arguments[2],x=o.getSafeEnvelope(),M=new on(o,u,p);return this._index.query(x,new(function(){return l(function D(){n(this,D)},[{key:"interfaces_",get:function(){return[$o]}},{key:"visitItem",value:function(D){D.select(x,M)}}])}())),M.isNodeAdded()}}}],[{key:"constructor_",value:function(){this._index=null;var c=arguments[0];this._index=c}}])}(),on=function(c){function o(){var u;return n(this,o),u=i(this,o),o.constructor_.apply(u,arguments),u}return m(o,c),l(o,[{key:"isNodeAdded",value:function(){return this._isNodeAdded}},{key:"select",value:function(){if(!(arguments.length===2&&Number.isInteger(arguments[1])&&arguments[0]instanceof zi))return w(o,"select",this,1).apply(this,arguments);var u=arguments[1],p=arguments[0].getContext();if(this._parentEdge===p&&(u===this._hotPixelVertexIndex||u+1===this._hotPixelVertexIndex))return null;this._isNodeAdded|=this._hotPixel.addSnappedNode(p,u)}}],[{key:"constructor_",value:function(){this._hotPixel=null,this._parentEdge=null,this._hotPixelVertexIndex=null,this._isNodeAdded=!1;var u=arguments[0],p=arguments[1],x=arguments[2];this._hotPixel=u,this._parentEdge=p,this._hotPixelVertexIndex=x}}])}(hr);Eo.HotPixelSnapAction=on;var Wr=function(){return l(function c(){n(this,c),c.constructor_.apply(this,arguments)},[{key:"processIntersections",value:function(c,o,u,p){if(c===u&&o===p)return null;var x=c.getCoordinates()[o],M=c.getCoordinates()[o+1],D=u.getCoordinates()[p],Z=u.getCoordinates()[p+1];if(this._li.computeIntersection(x,M,D,Z),this._li.hasIntersection()&&this._li.isInteriorIntersection()){for(var Q=0;Q<this._li.getIntersectionNum();Q++)this._interiorIntersections.add(this._li.getIntersection(Q));c.addIntersections(this._li,o,0),u.addIntersections(this._li,p,1)}}},{key:"isDone",value:function(){return!1}},{key:"getInteriorIntersections",value:function(){return this._interiorIntersections}},{key:"interfaces_",get:function(){return[fn]}}],[{key:"constructor_",value:function(){this._li=null,this._interiorIntersections=null;var c=arguments[0];this._li=c,this._interiorIntersections=new Ft}}])}(),ra=function(){return l(function c(){n(this,c),c.constructor_.apply(this,arguments)},[{key:"checkCorrectness",value:function(c){var o=xi.getNodedSubstrings(c),u=new Jn(o);try{u.checkValid()}catch(p){if(!(p instanceof A))throw p;p.printStackTrace()}}},{key:"getNodedSubstrings",value:function(){return xi.getNodedSubstrings(this._nodedSegStrings)}},{key:"snapRound",value:function(c,o){var u=this.findInteriorIntersections(c,o);this.computeIntersectionSnaps(u),this.computeVertexSnaps(c)}},{key:"findInteriorIntersections",value:function(c,o){var u=new Wr(o);return this._noder.setSegmentIntersector(u),this._noder.computeNodes(c),u.getInteriorIntersections()}},{key:"computeVertexSnaps",value:function(){if(St(arguments[0],wt))for(var c=arguments[0].iterator();c.hasNext();){var o=c.next();this.computeVertexSnaps(o)}else if(arguments[0]instanceof xi)for(var u=arguments[0],p=u.getCoordinates(),x=0;x<p.length;x++){var M=new Ds(p[x],this._scaleFactor,this._li);this._pointSnapper.snap(M,u,x)&&u.addIntersection(p[x],x)}}},{key:"computeNodes",value:function(c){this._nodedSegStrings=c,this._noder=new yo,this._pointSnapper=new Eo(this._noder.getIndex()),this.snapRound(c,this._li)}},{key:"computeIntersectionSnaps",value:function(c){for(var o=c.iterator();o.hasNext();){var u=o.next(),p=new Ds(u,this._scaleFactor,this._li);this._pointSnapper.snap(p)}}},{key:"interfaces_",get:function(){return[Un]}}],[{key:"constructor_",value:function(){this._pm=null,this._li=null,this._scaleFactor=null,this._noder=null,this._pointSnapper=null,this._nodedSegStrings=null;var c=arguments[0];this._pm=c,this._li=new _i,this._li.setPrecisionModel(c),this._scaleFactor=c.getScale()}}])}(),wi=function(){function c(){n(this,c),c.constructor_.apply(this,arguments)}return l(c,[{key:"bufferFixedPrecision",value:function(o){var u=new Rs(new ra(new xn(1)),o.getScale()),p=new lr(this._bufParams);p.setWorkingPrecisionModel(o),p.setNoder(u),this._resultGeometry=p.buffer(this._argGeom,this._distance)}},{key:"bufferReducedPrecision",value:function(){if(arguments.length===0){for(var o=c.MAX_PRECISION_DIGITS;o>=0;o--){try{this.bufferReducedPrecision(o)}catch(M){if(!(M instanceof le))throw M;this._saveException=M}if(this._resultGeometry!==null)return null}throw this._saveException}if(arguments.length===1){var u=arguments[0],p=c.precisionScaleFactor(this._argGeom,this._distance,u),x=new xn(p);this.bufferFixedPrecision(x)}}},{key:"computeGeometry",value:function(){if(this.bufferOriginalPrecision(),this._resultGeometry!==null)return null;var o=this._argGeom.getFactory().getPrecisionModel();o.getType()===xn.FIXED?this.bufferFixedPrecision(o):this.bufferReducedPrecision()}},{key:"setQuadrantSegments",value:function(o){this._bufParams.setQuadrantSegments(o)}},{key:"bufferOriginalPrecision",value:function(){try{var o=new lr(this._bufParams);this._resultGeometry=o.buffer(this._argGeom,this._distance)}catch(u){if(!(u instanceof et))throw u;this._saveException=u}}},{key:"getResultGeometry",value:function(o){return this._distance=o,this.computeGeometry(),this._resultGeometry}},{key:"setEndCapStyle",value:function(o){this._bufParams.setEndCapStyle(o)}}],[{key:"constructor_",value:function(){if(this._argGeom=null,this._distance=null,this._bufParams=new C,this._resultGeometry=null,this._saveException=null,arguments.length===1){var o=arguments[0];this._argGeom=o}else if(arguments.length===2){var u=arguments[0],p=arguments[1];this._argGeom=u,this._bufParams=p}}},{key:"bufferOp",value:function(){if(arguments.length===2){var o=arguments[1];return new c(arguments[0]).getResultGeometry(o)}if(arguments.length===3){if(Number.isInteger(arguments[2])&&arguments[0]instanceof _t&&typeof arguments[1]=="number"){var u=arguments[1],p=arguments[2],x=new c(arguments[0]);return x.setQuadrantSegments(p),x.getResultGeometry(u)}if(arguments[2]instanceof C&&arguments[0]instanceof _t&&typeof arguments[1]=="number"){var M=arguments[1];return new c(arguments[0],arguments[2]).getResultGeometry(M)}}else if(arguments.length===4){var D=arguments[1],Z=arguments[2],Q=arguments[3],rt=new c(arguments[0]);return rt.setQuadrantSegments(Z),rt.setEndCapStyle(Q),rt.getResultGeometry(D)}}},{key:"precisionScaleFactor",value:function(o,u,p){var x=o.getEnvelopeInternal(),M=In.max(Math.abs(x.getMaxX()),Math.abs(x.getMaxY()),Math.abs(x.getMinX()),Math.abs(x.getMinY()))+2*(u>0?u:0),D=p-Math.trunc(Math.log(M)/Math.log(10)+1);return Math.pow(10,D)}}])}();wi.CAP_ROUND=C.CAP_ROUND,wi.CAP_BUTT=C.CAP_FLAT,wi.CAP_FLAT=C.CAP_FLAT,wi.CAP_SQUARE=C.CAP_SQUARE,wi.MAX_PRECISION_DIGITS=12;var Lr=["Point","MultiPoint","LineString","MultiLineString","Polygon","MultiPolygon"],$r=function(){return l(function c(o){n(this,c),this.geometryFactory=o||new ni},[{key:"read",value:function(c){var o,u=(o=typeof c=="string"?JSON.parse(c):c).type;if(!dn[u])throw new Error("Unknown GeoJSON type: "+o.type);return Lr.indexOf(u)!==-1?dn[u].call(this,o.coordinates):u==="GeometryCollection"?dn[u].call(this,o.geometries):dn[u].call(this,o)}},{key:"write",value:function(c){var o=c.getGeometryType();if(!pn[o])throw new Error("Geometry is not supported");return pn[o].call(this,c)}}])}(),dn={Feature:function(c){var o={};for(var u in c)o[u]=c[u];if(c.geometry){var p=c.geometry.type;if(!dn[p])throw new Error("Unknown GeoJSON type: "+c.type);o.geometry=this.read(c.geometry)}return c.bbox&&(o.bbox=dn.bbox.call(this,c.bbox)),o},FeatureCollection:function(c){var o={};if(c.features){o.features=[];for(var u=0;u<c.features.length;++u)o.features.push(this.read(c.features[u]))}return c.bbox&&(o.bbox=this.parse.bbox.call(this,c.bbox)),o},coordinates:function(c){for(var o=[],u=0;u<c.length;++u){var p=c[u];o.push(s(at,b(p)))}return o},bbox:function(c){return this.geometryFactory.createLinearRing([new at(c[0],c[1]),new at(c[2],c[1]),new at(c[2],c[3]),new at(c[0],c[3]),new at(c[0],c[1])])},Point:function(c){var o=s(at,b(c));return this.geometryFactory.createPoint(o)},MultiPoint:function(c){for(var o=[],u=0;u<c.length;++u)o.push(dn.Point.call(this,c[u]));return this.geometryFactory.createMultiPoint(o)},LineString:function(c){var o=dn.coordinates.call(this,c);return this.geometryFactory.createLineString(o)},MultiLineString:function(c){for(var o=[],u=0;u<c.length;++u)o.push(dn.LineString.call(this,c[u]));return this.geometryFactory.createMultiLineString(o)},Polygon:function(c){for(var o=dn.coordinates.call(this,c[0]),u=this.geometryFactory.createLinearRing(o),p=[],x=1;x<c.length;++x){var M=c[x],D=dn.coordinates.call(this,M),Z=this.geometryFactory.createLinearRing(D);p.push(Z)}return this.geometryFactory.createPolygon(u,p)},MultiPolygon:function(c){for(var o=[],u=0;u<c.length;++u){var p=c[u];o.push(dn.Polygon.call(this,p))}return this.geometryFactory.createMultiPolygon(o)},GeometryCollection:function(c){for(var o=[],u=0;u<c.length;++u){var p=c[u];o.push(this.read(p))}return this.geometryFactory.createGeometryCollection(o)}},pn={coordinate:function(c){var o=[c.x,c.y];return c.z&&o.push(c.z),c.m&&o.push(c.m),o},Point:function(c){return{type:"Point",coordinates:pn.coordinate.call(this,c.getCoordinate())}},MultiPoint:function(c){for(var o=[],u=0;u<c._geometries.length;++u){var p=c._geometries[u],x=pn.Point.call(this,p);o.push(x.coordinates)}return{type:"MultiPoint",coordinates:o}},LineString:function(c){for(var o=[],u=c.getCoordinates(),p=0;p<u.length;++p){var x=u[p];o.push(pn.coordinate.call(this,x))}return{type:"LineString",coordinates:o}},MultiLineString:function(c){for(var o=[],u=0;u<c._geometries.length;++u){var p=c._geometries[u],x=pn.LineString.call(this,p);o.push(x.coordinates)}return{type:"MultiLineString",coordinates:o}},Polygon:function(c){var o=[],u=pn.LineString.call(this,c._shell);o.push(u.coordinates);for(var p=0;p<c._holes.length;++p){var x=c._holes[p],M=pn.LineString.call(this,x);o.push(M.coordinates)}return{type:"Polygon",coordinates:o}},MultiPolygon:function(c){for(var o=[],u=0;u<c._geometries.length;++u){var p=c._geometries[u],x=pn.Polygon.call(this,p);o.push(x.coordinates)}return{type:"MultiPolygon",coordinates:o}},GeometryCollection:function(c){for(var o=[],u=0;u<c._geometries.length;++u){var p=c._geometries[u],x=p.getGeometryType();o.push(pn[x].call(this,p))}return{type:"GeometryCollection",geometries:o}}};return{BufferOp:wi,GeoJSONReader:function(){return l(function c(o){n(this,c),this.parser=new $r(o||new ni)},[{key:"read",value:function(c){return this.parser.read(c)}}])}(),GeoJSONWriter:function(){return l(function c(){n(this,c),this.parser=new $r(this.geometryFactory)},[{key:"write",value:function(c){return this.parser.write(c)}}])}()}})}(ch)),ch.exports}var Vw=Gw();const qw=eo(Vw);function io(){return new Ih}function Ih(){this.reset()}Ih.prototype={constructor:Ih,reset:function(){this.s=this.t=0},add:function(r){eg(Tl,r,this.t),eg(this,Tl.s,this.s),this.s?this.t+=Tl.t:this.s=Tl.t},valueOf:function(){return this.s}};var Tl=new Ih;function eg(r,t,e){var i=r.s=t+e,n=i-t,s=i-n;r.t=t-s+(e-n)}var He=1e-6,Me=Math.PI,Pr=Me/2,ng=Me/4,Rr=Me*2,Bs=180/Me,Yi=Me/180,Pn=Math.abs,Zw=Math.atan,Ga=Math.atan2,We=Math.cos,$e=Math.sin,tu=Math.sqrt;function y_(r){return r>1?0:r<-1?Me:Math.acos(r)}function Go(r){return r>1?Pr:r<-1?-Pr:Math.asin(r)}function Tu(){}function Ch(r,t){r&&rg.hasOwnProperty(r.type)&&rg[r.type](r,t)}var ig={Feature:function(r,t){Ch(r.geometry,t)},FeatureCollection:function(r,t){for(var e=r.features,i=-1,n=e.length;++i<n;)Ch(e[i].geometry,t)}},rg={Sphere:function(r,t){t.sphere()},Point:function(r,t){r=r.coordinates,t.point(r[0],r[1],r[2])},MultiPoint:function(r,t){for(var e=r.coordinates,i=-1,n=e.length;++i<n;)r=e[i],t.point(r[0],r[1],r[2])},LineString:function(r,t){Tf(r.coordinates,t,0)},MultiLineString:function(r,t){for(var e=r.coordinates,i=-1,n=e.length;++i<n;)Tf(e[i],t,0)},Polygon:function(r,t){sg(r.coordinates,t)},MultiPolygon:function(r,t){for(var e=r.coordinates,i=-1,n=e.length;++i<n;)sg(e[i],t)},GeometryCollection:function(r,t){for(var e=r.geometries,i=-1,n=e.length;++i<n;)Ch(e[i],t)}};function Tf(r,t,e){var i=-1,n=r.length-e,s;for(t.lineStart();++i<n;)s=r[i],t.point(s[0],s[1],s[2]);t.lineEnd()}function sg(r,t){var e=-1,i=r.length;for(t.polygonStart();++e<i;)Tf(r[e],t,1);t.polygonEnd()}function Hw(r,t){r&&ig.hasOwnProperty(r.type)?ig[r.type](r,t):Ch(r,t)}io();io();function Pf(r){return[Ga(r[1],r[0]),Go(r[2])]}function Va(r){var t=r[0],e=r[1],i=We(e);return[i*We(t),i*$e(t),$e(e)]}function Pl(r,t){return r[0]*t[0]+r[1]*t[1]+r[2]*t[2]}function Ah(r,t){return[r[1]*t[2]-r[2]*t[1],r[2]*t[0]-r[0]*t[2],r[0]*t[1]-r[1]*t[0]]}function Tc(r,t){r[0]+=t[0],r[1]+=t[1],r[2]+=t[2]}function Il(r,t){return[r[0]*t,r[1]*t,r[2]*t]}function If(r){var t=tu(r[0]*r[0]+r[1]*r[1]+r[2]*r[2]);r[0]/=t,r[1]/=t,r[2]/=t}io();function __(r,t){function e(i,n){return i=r(i,n),t(i[0],i[1])}return r.invert&&t.invert&&(e.invert=function(i,n){return i=t.invert(i,n),i&&r.invert(i[0],i[1])}),e}function Cf(r,t){return[r>Me?r-Rr:r<-Me?r+Rr:r,t]}Cf.invert=Cf;function Yw(r,t,e){return(r%=Rr)?t||e?__(ag(r),ug(t,e)):ag(r):t||e?ug(t,e):Cf}function og(r){return function(t,e){return t+=r,[t>Me?t-Rr:t<-Me?t+Rr:t,e]}}function ag(r){var t=og(r);return t.invert=og(-r),t}function ug(r,t){var e=We(r),i=$e(r),n=We(t),s=$e(t);function a(l,f){var d=We(f),g=We(l)*d,m=$e(l)*d,v=$e(f),_=v*e+g*i;return[Ga(m*n-_*s,g*e-v*i),Go(_*n+m*s)]}return a.invert=function(l,f){var d=We(f),g=We(l)*d,m=$e(l)*d,v=$e(f),_=v*n-m*s;return[Ga(m*n+v*s,g*e+_*i),Go(_*e-g*i)]},a}function Xw(r,t,e,i,n,s){if(e){var a=We(t),l=$e(t),f=i*e;n==null?(n=t+i*Rr,s=t-f/2):(n=lg(a,n),s=lg(a,s),(i>0?n<s:n>s)&&(n+=i*Rr));for(var d,g=n;i>0?g>s:g<s;g-=f)d=Pf([a,-l*We(g),-l*$e(g)]),r.point(d[0],d[1])}}function lg(r,t){t=Va(t),t[0]-=r,If(t);var e=y_(-t[1]);return((-t[2]<0?-e:e)+Rr-He)%Rr}function v_(){var r=[],t;return{point:function(e,i){t.push([e,i])},lineStart:function(){r.push(t=[])},lineEnd:Tu,rejoin:function(){r.length>1&&r.push(r.pop().concat(r.shift()))},result:function(){var e=r;return r=[],t=null,e}}}function Ww(r,t,e,i,n,s){var a=r[0],l=r[1],f=t[0],d=t[1],g=0,m=1,v=f-a,_=d-l,w;if(w=e-a,!(!v&&w>0)){if(w/=v,v<0){if(w<g)return;w<m&&(m=w)}else if(v>0){if(w>m)return;w>g&&(g=w)}if(w=n-a,!(!v&&w<0)){if(w/=v,v<0){if(w>m)return;w>g&&(g=w)}else if(v>0){if(w<g)return;w<m&&(m=w)}if(w=i-l,!(!_&&w>0)){if(w/=_,_<0){if(w<g)return;w<m&&(m=w)}else if(_>0){if(w>m)return;w>g&&(g=w)}if(w=s-l,!(!_&&w<0)){if(w/=_,_<0){if(w>m)return;w>g&&(g=w)}else if(_>0){if(w<g)return;w<m&&(m=w)}return g>0&&(r[0]=a+g*v,r[1]=l+g*_),m<1&&(t[0]=a+m*v,t[1]=l+m*_),!0}}}}}function fh(r,t){return Pn(r[0]-t[0])<He&&Pn(r[1]-t[1])<He}function Cl(r,t,e,i){this.x=r,this.z=t,this.o=e,this.e=i,this.v=!1,this.n=this.p=null}function x_(r,t,e,i,n){var s=[],a=[],l,f;if(r.forEach(function(w){if(!((b=w.length-1)<=0)){var b,S=w[0],N=w[b],k;if(fh(S,N)){for(n.lineStart(),l=0;l<b;++l)n.point((S=w[l])[0],S[1]);n.lineEnd();return}s.push(k=new Cl(S,w,null,!0)),a.push(k.o=new Cl(S,null,k,!1)),s.push(k=new Cl(N,w,null,!1)),a.push(k.o=new Cl(N,null,k,!0))}}),!!s.length){for(a.sort(t),hg(s),hg(a),l=0,f=a.length;l<f;++l)a[l].e=e=!e;for(var d=s[0],g,m;;){for(var v=d,_=!0;v.v;)if((v=v.n)===d)return;g=v.z,n.lineStart();do{if(v.v=v.o.v=!0,v.e){if(_)for(l=0,f=g.length;l<f;++l)n.point((m=g[l])[0],m[1]);else i(v.x,v.n.x,1,n);v=v.n}else{if(_)for(g=v.p.z,l=g.length-1;l>=0;--l)n.point((m=g[l])[0],m[1]);else i(v.x,v.p.x,-1,n);v=v.p}v=v.o,g=v.z,_=!_}while(!v.v);n.lineEnd()}}}function hg(r){if(t=r.length){for(var t,e=0,i=r[0],n;++e<t;)i.n=n=r[e],n.p=i,i=n;i.n=n=r[0],n.p=i}}function w_(r,t){return r<t?-1:r>t?1:r>=t?0:NaN}function $w(r){return r.length===1&&(r=Jw(r)),{left:function(t,e,i,n){for(i==null&&(i=0),n==null&&(n=t.length);i<n;){var s=i+n>>>1;r(t[s],e)<0?i=s+1:n=s}return i},right:function(t,e,i,n){for(i==null&&(i=0),n==null&&(n=t.length);i<n;){var s=i+n>>>1;r(t[s],e)>0?n=s:i=s+1}return i}}}function Jw(r){return function(t,e){return w_(r(t),e)}}$w(w_);function b_(r){for(var t=r.length,e,i=-1,n=0,s,a;++i<t;)n+=r[i].length;for(s=new Array(n);--t>=0;)for(a=r[t],e=a.length;--e>=0;)s[--n]=a[e];return s}var Al=1e9,Nl=-1e9;function jw(r,t,e,i){function n(d,g){return r<=d&&d<=e&&t<=g&&g<=i}function s(d,g,m,v){var _=0,w=0;if(d==null||(_=a(d,m))!==(w=a(g,m))||f(d,g)<0^m>0)do v.point(_===0||_===3?r:e,_>1?i:t);while((_=(_+m+4)%4)!==w);else v.point(g[0],g[1])}function a(d,g){return Pn(d[0]-r)<He?g>0?0:3:Pn(d[0]-e)<He?g>0?2:1:Pn(d[1]-t)<He?g>0?1:0:g>0?3:2}function l(d,g){return f(d.x,g.x)}function f(d,g){var m=a(d,1),v=a(g,1);return m!==v?m-v:m===0?g[1]-d[1]:m===1?d[0]-g[0]:m===2?d[1]-g[1]:g[0]-d[0]}return function(d){var g=d,m=v_(),v,_,w,b,S,N,k,C,A,P,q,U={point:I,lineStart:z,lineEnd:W,polygonStart:B,polygonEnd:V};function I($,F){n($,F)&&g.point($,F)}function O(){for(var $=0,F=0,X=_.length;F<X;++F)for(var Y=_[F],j=1,J=Y.length,K=Y[0],et,ft,lt=K[0],ut=K[1];j<J;++j)et=lt,ft=ut,K=Y[j],lt=K[0],ut=K[1],ft<=i?ut>i&&(lt-et)*(i-ft)>(ut-ft)*(r-et)&&++$:ut<=i&&(lt-et)*(i-ft)<(ut-ft)*(r-et)&&--$;return $}function B(){g=m,v=[],_=[],q=!0}function V(){var $=O(),F=q&&$,X=(v=b_(v)).length;(F||X)&&(d.polygonStart(),F&&(d.lineStart(),s(null,null,1,d),d.lineEnd()),X&&x_(v,l,$,s,d),d.polygonEnd()),g=d,v=_=w=null}function z(){U.point=T,_&&_.push(w=[]),P=!0,A=!1,k=C=NaN}function W(){v&&(T(b,S),N&&A&&m.rejoin(),v.push(m.result())),U.point=I,A&&g.lineEnd()}function T($,F){var X=n($,F);if(_&&w.push([$,F]),P)b=$,S=F,N=X,P=!1,X&&(g.lineStart(),g.point($,F));else if(X&&A)g.point($,F);else{var Y=[k=Math.max(Nl,Math.min(Al,k)),C=Math.max(Nl,Math.min(Al,C))],j=[$=Math.max(Nl,Math.min(Al,$)),F=Math.max(Nl,Math.min(Al,F))];Ww(Y,j,r,t,e,i)?(A||(g.lineStart(),g.point(Y[0],Y[1])),g.point(j[0],j[1]),X||g.lineEnd(),q=!1):X&&(g.lineStart(),g.point($,F),q=!1)}k=$,C=F,A=X}return U}}var Pc=io();function Kw(r,t){var e=t[0],i=t[1],n=[$e(e),-We(e),0],s=0,a=0;Pc.reset();for(var l=0,f=r.length;l<f;++l)if(g=(d=r[l]).length)for(var d,g,m=d[g-1],v=m[0],_=m[1]/2+ng,w=$e(_),b=We(_),S=0;S<g;++S,v=k,w=A,b=P,m=N){var N=d[S],k=N[0],C=N[1]/2+ng,A=$e(C),P=We(C),q=k-v,U=q>=0?1:-1,I=U*q,O=I>Me,B=w*A;if(Pc.add(Ga(B*U*$e(I),b*P+B*We(I))),s+=O?q+U*Rr:q,O^v>=e^k>=e){var V=Ah(Va(m),Va(N));If(V);var z=Ah(n,V);If(z);var W=(O^q>=0?-1:1)*Go(z[2]);(i>W||i===W&&(V[0]||V[1]))&&(a+=O^q>=0?1:-1)}}return(s<-1e-6||s<He&&Pc<-1e-6)^a&1}io();function cg(r){return r}io();io();var qa=1/0,Nh=qa,Qu=-qa,Oh=Qu,fg={point:Qw,lineStart:Tu,lineEnd:Tu,polygonStart:Tu,polygonEnd:Tu,result:function(){var r=[[qa,Nh],[Qu,Oh]];return Qu=Oh=-(Nh=qa=1/0),r}};function Qw(r,t){r<qa&&(qa=r),r>Qu&&(Qu=r),t<Nh&&(Nh=t),t>Oh&&(Oh=t)}io();function E_(r,t,e,i){return function(n,s){var a=t(s),l=n.invert(i[0],i[1]),f=v_(),d=t(f),g=!1,m,v,_,w={point:b,lineStart:N,lineEnd:k,polygonStart:function(){w.point=C,w.lineStart=A,w.lineEnd=P,v=[],m=[]},polygonEnd:function(){w.point=b,w.lineStart=N,w.lineEnd=k,v=b_(v);var q=Kw(m,l);v.length?(g||(s.polygonStart(),g=!0),x_(v,eb,q,e,s)):q&&(g||(s.polygonStart(),g=!0),s.lineStart(),e(null,null,1,s),s.lineEnd()),g&&(s.polygonEnd(),g=!1),v=m=null},sphere:function(){s.polygonStart(),s.lineStart(),e(null,null,1,s),s.lineEnd(),s.polygonEnd()}};function b(q,U){var I=n(q,U);r(q=I[0],U=I[1])&&s.point(q,U)}function S(q,U){var I=n(q,U);a.point(I[0],I[1])}function N(){w.point=S,a.lineStart()}function k(){w.point=b,a.lineEnd()}function C(q,U){_.push([q,U]);var I=n(q,U);d.point(I[0],I[1])}function A(){d.lineStart(),_=[]}function P(){C(_[0][0],_[0][1]),d.lineEnd();var q=d.clean(),U=f.result(),I,O=U.length,B,V,z;if(_.pop(),m.push(_),_=null,!!O){if(q&1){if(V=U[0],(B=V.length-1)>0){for(g||(s.polygonStart(),g=!0),s.lineStart(),I=0;I<B;++I)s.point((z=V[I])[0],z[1]);s.lineEnd()}return}O>1&&q&2&&U.push(U.pop().concat(U.shift())),v.push(U.filter(tb))}}return w}}function tb(r){return r.length>1}function eb(r,t){return((r=r.x)[0]<0?r[1]-Pr-He:Pr-r[1])-((t=t.x)[0]<0?t[1]-Pr-He:Pr-t[1])}const dg=E_(function(){return!0},nb,rb,[-Me,-Pr]);function nb(r){var t=NaN,e=NaN,i=NaN,n;return{lineStart:function(){r.lineStart(),n=1},point:function(s,a){var l=s>0?Me:-Me,f=Pn(s-t);Pn(f-Me)<He?(r.point(t,e=(e+a)/2>0?Pr:-Pr),r.point(i,e),r.lineEnd(),r.lineStart(),r.point(l,e),r.point(s,e),n=0):i!==l&&f>=Me&&(Pn(t-i)<He&&(t-=i*He),Pn(s-l)<He&&(s-=l*He),e=ib(t,e,s,a),r.point(i,e),r.lineEnd(),r.lineStart(),r.point(l,e),n=0),r.point(t=s,e=a),i=l},lineEnd:function(){r.lineEnd(),t=e=NaN},clean:function(){return 2-n}}}function ib(r,t,e,i){var n,s,a=$e(r-e);return Pn(a)>He?Zw(($e(t)*(s=We(i))*$e(e)-$e(i)*(n=We(t))*$e(r))/(n*s*a)):(t+i)/2}function rb(r,t,e,i){var n;if(r==null)n=e*Pr,i.point(-Me,n),i.point(0,n),i.point(Me,n),i.point(Me,0),i.point(Me,-n),i.point(0,-n),i.point(-Me,-n),i.point(-Me,0),i.point(-Me,n);else if(Pn(r[0]-t[0])>He){var s=r[0]<t[0]?Me:-Me;n=e*s/2,i.point(-s,n),i.point(0,n),i.point(s,n)}else i.point(t[0],t[1])}function sb(r,t){var e=We(r),i=e>0,n=Pn(e)>He;function s(g,m,v,_){Xw(_,r,t,v,g,m)}function a(g,m){return We(g)*We(m)>e}function l(g){var m,v,_,w,b;return{lineStart:function(){w=_=!1,b=1},point:function(S,N){var k=[S,N],C,A=a(S,N),P=i?A?0:d(S,N):A?d(S+(S<0?Me:-Me),N):0;if(!m&&(w=_=A)&&g.lineStart(),A!==_&&(C=f(m,k),(!C||fh(m,C)||fh(k,C))&&(k[0]+=He,k[1]+=He,A=a(k[0],k[1]))),A!==_)b=0,A?(g.lineStart(),C=f(k,m),g.point(C[0],C[1])):(C=f(m,k),g.point(C[0],C[1]),g.lineEnd()),m=C;else if(n&&m&&i^A){var q;!(P&v)&&(q=f(k,m,!0))&&(b=0,i?(g.lineStart(),g.point(q[0][0],q[0][1]),g.point(q[1][0],q[1][1]),g.lineEnd()):(g.point(q[1][0],q[1][1]),g.lineEnd(),g.lineStart(),g.point(q[0][0],q[0][1])))}A&&(!m||!fh(m,k))&&g.point(k[0],k[1]),m=k,_=A,v=P},lineEnd:function(){_&&g.lineEnd(),m=null},clean:function(){return b|(w&&_)<<1}}}function f(g,m,v){var _=Va(g),w=Va(m),b=[1,0,0],S=Ah(_,w),N=Pl(S,S),k=S[0],C=N-k*k;if(!C)return!v&&g;var A=e*N/C,P=-e*k/C,q=Ah(b,S),U=Il(b,A),I=Il(S,P);Tc(U,I);var O=q,B=Pl(U,O),V=Pl(O,O),z=B*B-V*(Pl(U,U)-1);if(!(z<0)){var W=tu(z),T=Il(O,(-B-W)/V);if(Tc(T,U),T=Pf(T),!v)return T;var $=g[0],F=m[0],X=g[1],Y=m[1],j;F<$&&(j=$,$=F,F=j);var J=F-$,K=Pn(J-Me)<He,et=K||J<He;if(!K&&Y<X&&(j=X,X=Y,Y=j),et?K?X+Y>0^T[1]<(Pn(T[0]-$)<He?X:Y):X<=T[1]&&T[1]<=Y:J>Me^($<=T[0]&&T[0]<=F)){var ft=Il(O,(-B+W)/V);return Tc(ft,U),[T,Pf(ft)]}}}function d(g,m){var v=i?r:Me-r,_=0;return g<-v?_|=1:g>v&&(_|=2),m<-v?_|=4:m>v&&(_|=8),_}return E_(a,l,s,i?[0,-r]:[-Me,r-Me])}function k_(r){return function(t){var e=new Af;for(var i in r)e[i]=r[i];return e.stream=t,e}}function Af(){}Af.prototype={constructor:Af,point:function(r,t){this.stream.point(r,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function M_(r,t,e){var i=t[1][0]-t[0][0],n=t[1][1]-t[0][1],s=r.clipExtent&&r.clipExtent();r.scale(150).translate([0,0]),s!=null&&r.clipExtent(null),Hw(e,r.stream(fg));var a=fg.result(),l=Math.min(i/(a[1][0]-a[0][0]),n/(a[1][1]-a[0][1])),f=+t[0][0]+(i-l*(a[1][0]+a[0][0]))/2,d=+t[0][1]+(n-l*(a[1][1]+a[0][1]))/2;return s!=null&&r.clipExtent(s),r.scale(l*150).translate([f,d])}function ob(r,t,e){return M_(r,[[0,0],t],e)}var pg=16,ab=We(30*Yi);function gg(r,t){return+t?lb(r,t):ub(r)}function ub(r){return k_({point:function(t,e){t=r(t,e),this.stream.point(t[0],t[1])}})}function lb(r,t){function e(i,n,s,a,l,f,d,g,m,v,_,w,b,S){var N=d-i,k=g-n,C=N*N+k*k;if(C>4*t&&b--){var A=a+v,P=l+_,q=f+w,U=tu(A*A+P*P+q*q),I=Go(q/=U),O=Pn(Pn(q)-1)<He||Pn(s-m)<He?(s+m)/2:Ga(P,A),B=r(O,I),V=B[0],z=B[1],W=V-i,T=z-n,$=k*W-N*T;($*$/C>t||Pn((N*W+k*T)/C-.5)>.3||a*v+l*_+f*w<ab)&&(e(i,n,s,a,l,f,V,z,O,A/=U,P/=U,q,b,S),S.point(V,z),e(V,z,O,A,P,q,d,g,m,v,_,w,b,S))}}return function(i){var n,s,a,l,f,d,g,m,v,_,w,b,S={point:N,lineStart:k,lineEnd:A,polygonStart:function(){i.polygonStart(),S.lineStart=P},polygonEnd:function(){i.polygonEnd(),S.lineStart=k}};function N(I,O){I=r(I,O),i.point(I[0],I[1])}function k(){m=NaN,S.point=C,i.lineStart()}function C(I,O){var B=Va([I,O]),V=r(I,O);e(m,v,g,_,w,b,m=V[0],v=V[1],g=I,_=B[0],w=B[1],b=B[2],pg,i),i.point(m,v)}function A(){S.point=N,i.lineEnd()}function P(){k(),S.point=q,S.lineEnd=U}function q(I,O){C(n=I,O),s=m,a=v,l=_,f=w,d=b,S.point=C}function U(){e(m,v,g,_,w,b,s,a,n,l,f,d,pg,i),S.lineEnd=A,A()}return S}}var hb=k_({point:function(r,t){this.stream.point(r*Yi,t*Yi)}});function cb(r){return fb(function(){return r})()}function fb(r){var t,e=150,i=480,n=250,s,a,l=0,f=0,d=0,g=0,m=0,v,_,w=null,b=dg,S=null,N,k,C,A=cg,P=.5,q=gg(V,P),U,I;function O(T){return T=_(T[0]*Yi,T[1]*Yi),[T[0]*e+s,a-T[1]*e]}function B(T){return T=_.invert((T[0]-s)/e,(a-T[1])/e),T&&[T[0]*Bs,T[1]*Bs]}function V(T,$){return T=t(T,$),[T[0]*e+s,a-T[1]*e]}O.stream=function(T){return U&&I===T?U:U=hb(b(v,q(A(I=T))))},O.clipAngle=function(T){return arguments.length?(b=+T?sb(w=T*Yi,6*Yi):(w=null,dg),W()):w*Bs},O.clipExtent=function(T){return arguments.length?(A=T==null?(S=N=k=C=null,cg):jw(S=+T[0][0],N=+T[0][1],k=+T[1][0],C=+T[1][1]),W()):S==null?null:[[S,N],[k,C]]},O.scale=function(T){return arguments.length?(e=+T,z()):e},O.translate=function(T){return arguments.length?(i=+T[0],n=+T[1],z()):[i,n]},O.center=function(T){return arguments.length?(l=T[0]%360*Yi,f=T[1]%360*Yi,z()):[l*Bs,f*Bs]},O.rotate=function(T){return arguments.length?(d=T[0]%360*Yi,g=T[1]%360*Yi,m=T.length>2?T[2]%360*Yi:0,z()):[d*Bs,g*Bs,m*Bs]},O.precision=function(T){return arguments.length?(q=gg(V,P=T*T),W()):tu(P)},O.fitExtent=function(T,$){return M_(O,T,$)},O.fitSize=function(T,$){return ob(O,T,$)};function z(){_=__(v=Yw(d,g,m),t);var T=t(l,f);return s=i-T[0]*e,a=n+T[1]*e,W()}function W(){return U=I=null,O}return function(){return t=r.apply(this,arguments),O.invert=t.invert&&B,z()}}function L_(r){return function(t,e){var i=We(t),n=We(e),s=r(i*n);return[s*n*$e(t),s*$e(e)]}}function S_(r){return function(t,e){var i=tu(t*t+e*e),n=r(i),s=$e(n),a=We(n);return[Ga(t*s,i*a),Go(i&&e*s/i)]}}var db=L_(function(r){return tu(2/(1+r))});db.invert=S_(function(r){return 2*Go(r/2)});var T_=L_(function(r){return(r=y_(r))&&r/$e(r)});T_.invert=S_(function(r){return r});function pb(){return cb(T_).scale(79.4188).clipAngle(180-.001)}function mg(r,t){return[r,t]}mg.invert=mg;var{BufferOp:gb,GeoJSONReader:mb,GeoJSONWriter:yb}=qw;function _b(r,t,e){e=e||{};var i=e.units||"kilometers",n=e.steps||8;if(!r)throw new Error("geojson is required");if(typeof e!="object")throw new Error("options must be an object");if(typeof n!="number")throw new Error("steps must be an number");if(t===void 0)throw new Error("radius is required");if(n<=0)throw new Error("steps must be greater than 0");var s=[];switch(r.type){case"GeometryCollection":return Rn(r,function(a){var l=dh(a,t,i,n);l&&s.push(l)}),Yt(s);case"FeatureCollection":return ye(r,function(a){var l=dh(a,t,i,n);l&&ye(l,function(f){f&&s.push(f)})}),Yt(s)}return dh(r,t,i,n)}function dh(r,t,e,i){var n=r.properties||{},s=r.type==="Feature"?r.geometry:r;if(s.type==="GeometryCollection"){var a=[];return Rn(r,function(b){var S=dh(b,t,e,i);S&&a.push(S)}),Yt(a)}var l=vb(s),f={type:s.type,coordinates:I_(s.coordinates,l)},d=new mb,g=d.read(f),m=fl(Ka(t,e),"meters"),v=gb.bufferOp(g,m,i),_=new yb;if(v=_.write(v),!P_(v.coordinates)){var w={type:v.type,coordinates:C_(v.coordinates,l)};return Qe(w,n)}}function P_(r){return Array.isArray(r[0])?P_(r[0]):isNaN(r[0])}function I_(r,t){return typeof r[0]!="object"?t(r):r.map(function(e){return I_(e,t)})}function C_(r,t){return typeof r[0]!="object"?t.invert(r):r.map(function(e){return C_(e,t)})}function vb(r){var t=ec(r).geometry.coordinates,e=[-t[0],-t[1]];return pb().rotate(e).scale(yn)}function Pd(r,t={}){let e=0,i=0,n=0;return Rn(r,function(s,a,l){let f=t.weight?l==null?void 0:l[t.weight]:void 0;if(f=f??1,!_n(f))throw new Error("weight value must be a number for feature index "+a);f=Number(f),f>0&&Fe(s,function(d){e+=d[0]*f,i+=d[1]*f,n+=f})}),re([e/n,i/n],t.properties,t)}function Dr(r,t={}){let e=0,i=0,n=0;return Fe(r,function(s){e+=s[0],i+=s[1],n++},!0),re([e/n,i/n],t.properties)}function xb(r,t={}){if(t=t||{},!ve(t))throw new Error("options is invalid");var e=t.counter||10;if(!_n(e))throw new Error("counter must be a number");var i=t.weight,n=Pd(r,{weight:t.weight}),s=Yt([]);ye(r,function(l){var f;s.features.push(Dr(l,{properties:{weight:(f=l.properties)==null?void 0:f[i]}}))});const a={tolerance:t.tolerance,medianCandidates:[]};return A_(n.geometry.coordinates,[0,0],s,a,e)}function A_(r,t,e,i,n){var s=i.tolerance||.001,a=0,l=0,f=0,d=0;if(ye(e,function(v){var _,w=(_=v.properties)==null?void 0:_.weight,b=w??1;if(b=Number(b),!_n(b))throw new Error("weight value must be a number");if(b>0){d+=1;var S=b*we(v,r);S===0&&(S=1);var N=b/S;a+=v.geometry.coordinates[0]*N,l+=v.geometry.coordinates[1]*N,f+=N}}),d<1)throw new Error("no features to measure");var g=a/f,m=l/f;return d===1||n===0||Math.abs(g-t[0])<s&&Math.abs(m-t[1])<s?re([g,m],{medianCandidates:i.medianCandidates}):(i.medianCandidates.push([g,m]),A_([g,m],r,e,i,n-1))}var Ol={exports:{}},ph={exports:{}},wb=ph.exports,yg;function bb(){return yg||(yg=1,function(r,t){(function(e,i){r.exports=i()})(wb,function(){function e(k,C,A,P,q){(function U(I,O,B,V,z){for(;V>B;){if(V-B>600){var W=V-B+1,T=O-B+1,$=Math.log(W),F=.5*Math.exp(2*$/3),X=.5*Math.sqrt($*F*(W-F)/W)*(T-W/2<0?-1:1),Y=Math.max(B,Math.floor(O-T*F/W+X)),j=Math.min(V,Math.floor(O+(W-T)*F/W+X));U(I,O,Y,j,z)}var J=I[O],K=B,et=V;for(i(I,B,O),z(I[V],J)>0&&i(I,B,V);K<et;){for(i(I,K,et),K++,et--;z(I[K],J)<0;)K++;for(;z(I[et],J)>0;)et--}z(I[B],J)===0?i(I,B,et):i(I,++et,V),et<=O&&(B=et+1),O<=et&&(V=et-1)}})(k,C,A||0,P||k.length-1,q||n)}function i(k,C,A){var P=k[C];k[C]=k[A],k[A]=P}function n(k,C){return k<C?-1:k>C?1:0}var s=function(k){k===void 0&&(k=9),this._maxEntries=Math.max(4,k),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()};function a(k,C,A){if(!A)return C.indexOf(k);for(var P=0;P<C.length;P++)if(A(k,C[P]))return P;return-1}function l(k,C){f(k,0,k.children.length,C,k)}function f(k,C,A,P,q){q||(q=S(null)),q.minX=1/0,q.minY=1/0,q.maxX=-1/0,q.maxY=-1/0;for(var U=C;U<A;U++){var I=k.children[U];d(q,k.leaf?P(I):I)}return q}function d(k,C){return k.minX=Math.min(k.minX,C.minX),k.minY=Math.min(k.minY,C.minY),k.maxX=Math.max(k.maxX,C.maxX),k.maxY=Math.max(k.maxY,C.maxY),k}function g(k,C){return k.minX-C.minX}function m(k,C){return k.minY-C.minY}function v(k){return(k.maxX-k.minX)*(k.maxY-k.minY)}function _(k){return k.maxX-k.minX+(k.maxY-k.minY)}function w(k,C){return k.minX<=C.minX&&k.minY<=C.minY&&C.maxX<=k.maxX&&C.maxY<=k.maxY}function b(k,C){return C.minX<=k.maxX&&C.minY<=k.maxY&&C.maxX>=k.minX&&C.maxY>=k.minY}function S(k){return{children:k,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function N(k,C,A,P,q){for(var U=[C,A];U.length;)if(!((A=U.pop())-(C=U.pop())<=P)){var I=C+Math.ceil((A-C)/P/2)*P;e(k,I,C,A,q),U.push(C,I,I,A)}}return s.prototype.all=function(){return this._all(this.data,[])},s.prototype.search=function(k){var C=this.data,A=[];if(!b(k,C))return A;for(var P=this.toBBox,q=[];C;){for(var U=0;U<C.children.length;U++){var I=C.children[U],O=C.leaf?P(I):I;b(k,O)&&(C.leaf?A.push(I):w(k,O)?this._all(I,A):q.push(I))}C=q.pop()}return A},s.prototype.collides=function(k){var C=this.data;if(!b(k,C))return!1;for(var A=[];C;){for(var P=0;P<C.children.length;P++){var q=C.children[P],U=C.leaf?this.toBBox(q):q;if(b(k,U)){if(C.leaf||w(k,U))return!0;A.push(q)}}C=A.pop()}return!1},s.prototype.load=function(k){if(!k||!k.length)return this;if(k.length<this._minEntries){for(var C=0;C<k.length;C++)this.insert(k[C]);return this}var A=this._build(k.slice(),0,k.length-1,0);if(this.data.children.length)if(this.data.height===A.height)this._splitRoot(this.data,A);else{if(this.data.height<A.height){var P=this.data;this.data=A,A=P}this._insert(A,this.data.height-A.height-1,!0)}else this.data=A;return this},s.prototype.insert=function(k){return k&&this._insert(k,this.data.height-1),this},s.prototype.clear=function(){return this.data=S([]),this},s.prototype.remove=function(k,C){if(!k)return this;for(var A,P,q,U=this.data,I=this.toBBox(k),O=[],B=[];U||O.length;){if(U||(U=O.pop(),P=O[O.length-1],A=B.pop(),q=!0),U.leaf){var V=a(k,U.children,C);if(V!==-1)return U.children.splice(V,1),O.push(U),this._condense(O),this}q||U.leaf||!w(U,I)?P?(A++,U=P.children[A],q=!1):U=null:(O.push(U),B.push(A),A=0,P=U,U=U.children[0])}return this},s.prototype.toBBox=function(k){return k},s.prototype.compareMinX=function(k,C){return k.minX-C.minX},s.prototype.compareMinY=function(k,C){return k.minY-C.minY},s.prototype.toJSON=function(){return this.data},s.prototype.fromJSON=function(k){return this.data=k,this},s.prototype._all=function(k,C){for(var A=[];k;)k.leaf?C.push.apply(C,k.children):A.push.apply(A,k.children),k=A.pop();return C},s.prototype._build=function(k,C,A,P){var q,U=A-C+1,I=this._maxEntries;if(U<=I)return l(q=S(k.slice(C,A+1)),this.toBBox),q;P||(P=Math.ceil(Math.log(U)/Math.log(I)),I=Math.ceil(U/Math.pow(I,P-1))),(q=S([])).leaf=!1,q.height=P;var O=Math.ceil(U/I),B=O*Math.ceil(Math.sqrt(I));N(k,C,A,B,this.compareMinX);for(var V=C;V<=A;V+=B){var z=Math.min(V+B-1,A);N(k,V,z,O,this.compareMinY);for(var W=V;W<=z;W+=O){var T=Math.min(W+O-1,z);q.children.push(this._build(k,W,T,P-1))}}return l(q,this.toBBox),q},s.prototype._chooseSubtree=function(k,C,A,P){for(;P.push(C),!C.leaf&&P.length-1!==A;){for(var q=1/0,U=1/0,I=void 0,O=0;O<C.children.length;O++){var B=C.children[O],V=v(B),z=(W=k,T=B,(Math.max(T.maxX,W.maxX)-Math.min(T.minX,W.minX))*(Math.max(T.maxY,W.maxY)-Math.min(T.minY,W.minY))-V);z<U?(U=z,q=V<q?V:q,I=B):z===U&&V<q&&(q=V,I=B)}C=I||C.children[0]}var W,T;return C},s.prototype._insert=function(k,C,A){var P=A?k:this.toBBox(k),q=[],U=this._chooseSubtree(P,this.data,C,q);for(U.children.push(k),d(U,P);C>=0&&q[C].children.length>this._maxEntries;)this._split(q,C),C--;this._adjustParentBBoxes(P,q,C)},s.prototype._split=function(k,C){var A=k[C],P=A.children.length,q=this._minEntries;this._chooseSplitAxis(A,q,P);var U=this._chooseSplitIndex(A,q,P),I=S(A.children.splice(U,A.children.length-U));I.height=A.height,I.leaf=A.leaf,l(A,this.toBBox),l(I,this.toBBox),C?k[C-1].children.push(I):this._splitRoot(A,I)},s.prototype._splitRoot=function(k,C){this.data=S([k,C]),this.data.height=k.height+1,this.data.leaf=!1,l(this.data,this.toBBox)},s.prototype._chooseSplitIndex=function(k,C,A){for(var P,q,U,I,O,B,V,z=1/0,W=1/0,T=C;T<=A-C;T++){var $=f(k,0,T,this.toBBox),F=f(k,T,A,this.toBBox),X=(q=$,U=F,I=void 0,O=void 0,B=void 0,V=void 0,I=Math.max(q.minX,U.minX),O=Math.max(q.minY,U.minY),B=Math.min(q.maxX,U.maxX),V=Math.min(q.maxY,U.maxY),Math.max(0,B-I)*Math.max(0,V-O)),Y=v($)+v(F);X<z?(z=X,P=T,W=Y<W?Y:W):X===z&&Y<W&&(W=Y,P=T)}return P||A-C},s.prototype._chooseSplitAxis=function(k,C,A){var P=k.leaf?this.compareMinX:g,q=k.leaf?this.compareMinY:m;this._allDistMargin(k,C,A,P)<this._allDistMargin(k,C,A,q)&&k.children.sort(P)},s.prototype._allDistMargin=function(k,C,A,P){k.children.sort(P);for(var q=this.toBBox,U=f(k,0,C,q),I=f(k,A-C,A,q),O=_(U)+_(I),B=C;B<A-C;B++){var V=k.children[B];d(U,k.leaf?q(V):V),O+=_(U)}for(var z=A-C-1;z>=C;z--){var W=k.children[z];d(I,k.leaf?q(W):W),O+=_(I)}return O},s.prototype._adjustParentBBoxes=function(k,C,A){for(var P=A;P>=0;P--)d(C[P],k)},s.prototype._condense=function(k){for(var C=k.length-1,A=void 0;C>=0;C--)k[C].children.length===0?C>0?(A=k[C-1].children).splice(A.indexOf(k[C]),1):this.clear():l(k[C],this.toBBox)},s})}(ph)),ph.exports}class Eb{constructor(t=[],e=kb){if(this.data=t,this.length=this.data.length,this.compare=e,this.length>0)for(let i=(this.length>>1)-1;i>=0;i--)this._down(i)}push(t){this.data.push(t),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const t=this.data[0],e=this.data.pop();return this.length--,this.length>0&&(this.data[0]=e,this._down(0)),t}peek(){return this.data[0]}_up(t){const{data:e,compare:i}=this,n=e[t];for(;t>0;){const s=t-1>>1,a=e[s];if(i(n,a)>=0)break;e[t]=a,t=s}e[t]=n}_down(t){const{data:e,compare:i}=this,n=this.length>>1,s=e[t];for(;t<n;){let a=(t<<1)+1,l=e[a];const f=a+1;if(f<this.length&&i(e[f],l)<0&&(a=f,l=e[f]),i(l,s)>=0)break;e[t]=l,t=a}e[t]=s}}function kb(r,t){return r<t?-1:r>t?1:0}const Mb=Object.freeze(Object.defineProperty({__proto__:null,default:Eb},Symbol.toStringTag,{value:"Module"})),Lb=q1(Mb);var cu={exports:{}},Ic,_g;function Sb(){return _g||(_g=1,Ic=function(t,e,i,n){var s=t[0],a=t[1],l=!1;i===void 0&&(i=0),n===void 0&&(n=e.length);for(var f=(n-i)/2,d=0,g=f-1;d<f;g=d++){var m=e[i+d*2+0],v=e[i+d*2+1],_=e[i+g*2+0],w=e[i+g*2+1],b=v>a!=w>a&&s<(_-m)*(a-v)/(w-v)+m;b&&(l=!l)}return l}),Ic}var Cc,vg;function Tb(){return vg||(vg=1,Cc=function(t,e,i,n){var s=t[0],a=t[1],l=!1;i===void 0&&(i=0),n===void 0&&(n=e.length);for(var f=n-i,d=0,g=f-1;d<f;g=d++){var m=e[d+i][0],v=e[d+i][1],_=e[g+i][0],w=e[g+i][1],b=v>a!=w>a&&s<(_-m)*(a-v)/(w-v)+m;b&&(l=!l)}return l}),Cc}var xg;function Pb(){if(xg)return cu.exports;xg=1;var r=Sb(),t=Tb();return cu.exports=function(i,n,s,a){return n.length>0&&Array.isArray(n[0])?t(i,n,s,a):r(i,n,s,a)},cu.exports.nested=t,cu.exports.flat=r,cu.exports}var Pu={exports:{}},Ib=Pu.exports,wg;function Cb(){return wg||(wg=1,function(r,t){(function(e,i){i(t)})(Ib,function(e){const n=33306690738754706e-32;function s(b,S,N,k,C){let A,P,q,U,I=S[0],O=k[0],B=0,V=0;O>I==O>-I?(A=I,I=S[++B]):(A=O,O=k[++V]);let z=0;if(B<b&&V<N)for(O>I==O>-I?(q=A-((P=I+A)-I),I=S[++B]):(q=A-((P=O+A)-O),O=k[++V]),A=P,q!==0&&(C[z++]=q);B<b&&V<N;)O>I==O>-I?(q=A-((P=A+I)-(U=P-A))+(I-U),I=S[++B]):(q=A-((P=A+O)-(U=P-A))+(O-U),O=k[++V]),A=P,q!==0&&(C[z++]=q);for(;B<b;)q=A-((P=A+I)-(U=P-A))+(I-U),I=S[++B],A=P,q!==0&&(C[z++]=q);for(;V<N;)q=A-((P=A+O)-(U=P-A))+(O-U),O=k[++V],A=P,q!==0&&(C[z++]=q);return A===0&&z!==0||(C[z++]=A),z}function a(b){return new Float64Array(b)}const l=33306690738754716e-32,f=22204460492503146e-32,d=11093356479670487e-47,g=a(4),m=a(8),v=a(12),_=a(16),w=a(4);e.orient2d=function(b,S,N,k,C,A){const P=(S-A)*(N-C),q=(b-C)*(k-A),U=P-q;if(P===0||q===0||P>0!=q>0)return U;const I=Math.abs(P+q);return Math.abs(U)>=l*I?U:-function(O,B,V,z,W,T,$){let F,X,Y,j,J,K,et,ft,lt,ut,mt,Et,at,Rt,xt,_t,tt,wt;const G=O-W,ct=V-W,ht=B-T,ot=z-T;J=(xt=(ft=G-(et=(K=134217729*G)-(K-G)))*(ut=ot-(lt=(K=134217729*ot)-(K-ot)))-((Rt=G*ot)-et*lt-ft*lt-et*ut))-(mt=xt-(tt=(ft=ht-(et=(K=134217729*ht)-(K-ht)))*(ut=ct-(lt=(K=134217729*ct)-(K-ct)))-((_t=ht*ct)-et*lt-ft*lt-et*ut))),g[0]=xt-(mt+J)+(J-tt),J=(at=Rt-((Et=Rt+mt)-(J=Et-Rt))+(mt-J))-(mt=at-_t),g[1]=at-(mt+J)+(J-_t),J=(wt=Et+mt)-Et,g[2]=Et-(wt-J)+(mt-J),g[3]=wt;let it=function(At,St){let Ct=St[0];for(let Bt=1;Bt<At;Bt++)Ct+=St[Bt];return Ct}(4,g),st=f*$;if(it>=st||-it>=st||(F=O-(G+(J=O-G))+(J-W),Y=V-(ct+(J=V-ct))+(J-W),X=B-(ht+(J=B-ht))+(J-T),j=z-(ot+(J=z-ot))+(J-T),F===0&&X===0&&Y===0&&j===0)||(st=d*$+n*Math.abs(it),(it+=G*j+ot*F-(ht*Y+ct*X))>=st||-it>=st))return it;J=(xt=(ft=F-(et=(K=134217729*F)-(K-F)))*(ut=ot-(lt=(K=134217729*ot)-(K-ot)))-((Rt=F*ot)-et*lt-ft*lt-et*ut))-(mt=xt-(tt=(ft=X-(et=(K=134217729*X)-(K-X)))*(ut=ct-(lt=(K=134217729*ct)-(K-ct)))-((_t=X*ct)-et*lt-ft*lt-et*ut))),w[0]=xt-(mt+J)+(J-tt),J=(at=Rt-((Et=Rt+mt)-(J=Et-Rt))+(mt-J))-(mt=at-_t),w[1]=at-(mt+J)+(J-_t),J=(wt=Et+mt)-Et,w[2]=Et-(wt-J)+(mt-J),w[3]=wt;const kt=s(4,g,4,w,m);J=(xt=(ft=G-(et=(K=134217729*G)-(K-G)))*(ut=j-(lt=(K=134217729*j)-(K-j)))-((Rt=G*j)-et*lt-ft*lt-et*ut))-(mt=xt-(tt=(ft=ht-(et=(K=134217729*ht)-(K-ht)))*(ut=Y-(lt=(K=134217729*Y)-(K-Y)))-((_t=ht*Y)-et*lt-ft*lt-et*ut))),w[0]=xt-(mt+J)+(J-tt),J=(at=Rt-((Et=Rt+mt)-(J=Et-Rt))+(mt-J))-(mt=at-_t),w[1]=at-(mt+J)+(J-_t),J=(wt=Et+mt)-Et,w[2]=Et-(wt-J)+(mt-J),w[3]=wt;const Lt=s(kt,m,4,w,v);J=(xt=(ft=F-(et=(K=134217729*F)-(K-F)))*(ut=j-(lt=(K=134217729*j)-(K-j)))-((Rt=F*j)-et*lt-ft*lt-et*ut))-(mt=xt-(tt=(ft=X-(et=(K=134217729*X)-(K-X)))*(ut=Y-(lt=(K=134217729*Y)-(K-Y)))-((_t=X*Y)-et*lt-ft*lt-et*ut))),w[0]=xt-(mt+J)+(J-tt),J=(at=Rt-((Et=Rt+mt)-(J=Et-Rt))+(mt-J))-(mt=at-_t),w[1]=at-(mt+J)+(J-_t),J=(wt=Et+mt)-Et,w[2]=Et-(wt-J)+(mt-J),w[3]=wt;const yt=s(Lt,v,4,w,_);return _[yt-1]}(b,S,N,k,C,A,I)},e.orient2dfast=function(b,S,N,k,C,A){return(S-A)*(N-C)-(b-C)*(k-A)},Object.defineProperty(e,"__esModule",{value:!0})})}(Pu,Pu.exports)),Pu.exports}var bg;function Ab(){if(bg)return Ol.exports;bg=1;var r=bb(),t=Lb,e=Pb(),i=Cb().orient2d;t.default&&(t=t.default),Ol.exports=n,Ol.exports.default=n;function n(A,P,q){P=Math.max(0,P===void 0?2:P),q=q||0;var U=_(A),I=new r(16);I.toBBox=function(et){return{minX:et[0],minY:et[1],maxX:et[0],maxY:et[1]}},I.compareMinX=function(et,ft){return et[0]-ft[0]},I.compareMinY=function(et,ft){return et[1]-ft[1]},I.load(A);for(var O=[],B=0,V;B<U.length;B++){var z=U[B];I.remove(z),V=w(z,V),O.push(V)}var W=new r(16);for(B=0;B<O.length;B++)W.insert(v(O[B]));for(var T=P*P,$=q*q;O.length;){var F=O.shift(),X=F.p,Y=F.next.p,j=b(X,Y);if(!(j<$)){var J=j/T;z=s(I,F.prev.p,X,Y,F.next.next.p,J,W),z&&Math.min(b(z,X),b(z,Y))<=J&&(O.push(F),O.push(w(z,F)),I.remove(z),W.remove(F),W.insert(v(F)),W.insert(v(F.next)))}}F=V;var K=[];do K.push(F.p),F=F.next;while(F!==V);return K.push(F.p),K}function s(A,P,q,U,I,O,B){for(var V=new t([],a),z=A.data;z;){for(var W=0;W<z.children.length;W++){var T=z.children[W],$=z.leaf?S(T,q,U):l(q,U,T);$>O||V.push({node:T,dist:$})}for(;V.length&&!V.peek().node.children;){var F=V.pop(),X=F.node,Y=S(X,P,q),j=S(X,U,I);if(F.dist<Y&&F.dist<j&&d(q,X,B)&&d(U,X,B))return X}z=V.pop(),z&&(z=z.node)}return null}function a(A,P){return A.dist-P.dist}function l(A,P,q){if(f(A,q)||f(P,q))return 0;var U=N(A[0],A[1],P[0],P[1],q.minX,q.minY,q.maxX,q.minY);if(U===0)return 0;var I=N(A[0],A[1],P[0],P[1],q.minX,q.minY,q.minX,q.maxY);if(I===0)return 0;var O=N(A[0],A[1],P[0],P[1],q.maxX,q.minY,q.maxX,q.maxY);if(O===0)return 0;var B=N(A[0],A[1],P[0],P[1],q.minX,q.maxY,q.maxX,q.maxY);return B===0?0:Math.min(U,I,O,B)}function f(A,P){return A[0]>=P.minX&&A[0]<=P.maxX&&A[1]>=P.minY&&A[1]<=P.maxY}function d(A,P,q){for(var U=Math.min(A[0],P[0]),I=Math.min(A[1],P[1]),O=Math.max(A[0],P[0]),B=Math.max(A[1],P[1]),V=q.search({minX:U,minY:I,maxX:O,maxY:B}),z=0;z<V.length;z++)if(m(V[z].p,V[z].next.p,A,P))return!1;return!0}function g(A,P,q){return i(A[0],A[1],P[0],P[1],q[0],q[1])}function m(A,P,q,U){return A!==U&&P!==q&&g(A,P,q)>0!=g(A,P,U)>0&&g(q,U,A)>0!=g(q,U,P)>0}function v(A){var P=A.p,q=A.next.p;return A.minX=Math.min(P[0],q[0]),A.minY=Math.min(P[1],q[1]),A.maxX=Math.max(P[0],q[0]),A.maxY=Math.max(P[1],q[1]),A}function _(A){for(var P=A[0],q=A[0],U=A[0],I=A[0],O=0;O<A.length;O++){var B=A[O];B[0]<P[0]&&(P=B),B[0]>U[0]&&(U=B),B[1]<q[1]&&(q=B),B[1]>I[1]&&(I=B)}var V=[P,q,U,I],z=V.slice();for(O=0;O<A.length;O++)e(A[O],V)||z.push(A[O]);return C(z)}function w(A,P){var q={p:A,prev:null,next:null,minX:0,minY:0,maxX:0,maxY:0};return P?(q.next=P.next,q.prev=P,P.next.prev=q,P.next=q):(q.prev=q,q.next=q),q}function b(A,P){var q=A[0]-P[0],U=A[1]-P[1];return q*q+U*U}function S(A,P,q){var U=P[0],I=P[1],O=q[0]-U,B=q[1]-I;if(O!==0||B!==0){var V=((A[0]-U)*O+(A[1]-I)*B)/(O*O+B*B);V>1?(U=q[0],I=q[1]):V>0&&(U+=O*V,I+=B*V)}return O=A[0]-U,B=A[1]-I,O*O+B*B}function N(A,P,q,U,I,O,B,V){var z=q-A,W=U-P,T=B-I,$=V-O,F=A-I,X=P-O,Y=z*z+W*W,j=z*T+W*$,J=T*T+$*$,K=z*F+W*X,et=T*F+$*X,ft=Y*J-j*j,lt,ut,mt,Et,at=ft,Rt=ft;ft===0?(ut=0,at=1,Et=et,Rt=J):(ut=j*et-J*K,Et=Y*et-j*K,ut<0?(ut=0,Et=et,Rt=J):ut>at&&(ut=at,Et=et+j,Rt=J)),Et<0?(Et=0,-K<0?ut=0:-K>Y?ut=at:(ut=-K,at=Y)):Et>Rt&&(Et=Rt,-K+j<0?ut=0:-K+j>Y?ut=at:(ut=-K+j,at=Y)),lt=ut===0?0:ut/at,mt=Et===0?0:Et/Rt;var xt=(1-lt)*A+lt*q,_t=(1-lt)*P+lt*U,tt=(1-mt)*I+mt*B,wt=(1-mt)*O+mt*V,G=tt-xt,ct=wt-_t;return G*G+ct*ct}function k(A,P){return A[0]===P[0]?A[1]-P[1]:A[0]-P[0]}function C(A){A.sort(k);for(var P=[],q=0;q<A.length;q++){for(;P.length>=2&&g(P[P.length-2],P[P.length-1],A[q])<=0;)P.pop();P.push(A[q])}for(var U=[],I=A.length-1;I>=0;I--){for(;U.length>=2&&g(U[U.length-2],U[U.length-1],A[I])<=0;)U.pop();U.push(A[I])}return U.pop(),P.pop(),P.concat(U)}return Ol.exports}var Nb=Ab();const Ob=eo(Nb);function N_(r,t={}){t.concavity=t.concavity||1/0;const e=[];if(Fe(r,n=>{e.push([n[0],n[1]])}),!e.length)return null;const i=Ob(e,t.concavity);return i.length>3?$t([i]):null}function O_(r,t={}){switch(gi(r)){case"Point":return re(me(r),t.properties);case"Polygon":var e=[];Fe(r,function(A){e.push(A)});var i=Dr(r,{properties:t.properties}),n=i.geometry.coordinates,s=0,a=0,l=0,f,d,g,m,v,_,w,b,S=e.map(function(A){return[A[0]-n[0],A[1]-n[1]]});for(f=0;f<e.length-1;f++)d=S[f],m=d[0],_=d[1],g=S[f+1],v=g[0],w=g[1],b=m*w-v*_,l+=b,s+=(m+v)*b,a+=(_+w)*b;if(l===0)return i;var N=l*.5,k=1/(6*N);return re([n[0]+k*s,n[1]+k*a],t.properties);default:var C=N_(r);return C?O_(C,{properties:t.properties}):Dr(r,{properties:t.properties})}}function ml(r,t,e={}){const i=e.steps||64,n=e.properties?e.properties:!Array.isArray(r)&&r.type==="Feature"&&r.properties?r.properties:{},s=[];for(let a=0;a<i;a++)s.push(Fo(r,t,a*-360/i,e).geometry.coordinates);return s.push(s[0]),$t([s],n)}function bn(r){if(!r)throw new Error("geojson is required");switch(r.type){case"Feature":return R_(r);case"FeatureCollection":return Rb(r);case"Point":case"LineString":case"Polygon":case"MultiPoint":case"MultiLineString":case"MultiPolygon":case"GeometryCollection":return Id(r);default:throw new Error("unknown GeoJSON type")}}function R_(r){const t={type:"Feature"};return Object.keys(r).forEach(e=>{switch(e){case"type":case"properties":case"geometry":return;default:t[e]=r[e]}}),t.properties=nc(r.properties),r.geometry==null?t.geometry=null:t.geometry=Id(r.geometry),t}function nc(r){const t={};return r&&Object.keys(r).forEach(e=>{const i=r[e];typeof i=="object"?i===null?t[e]=null:Array.isArray(i)?t[e]=i.map(n=>n):t[e]=nc(i):t[e]=i}),t}function Rb(r){const t={type:"FeatureCollection"};return Object.keys(r).forEach(e=>{switch(e){case"type":case"features":return;default:t[e]=r[e]}}),t.features=r.features.map(e=>R_(e)),t}function Id(r){const t={type:r.type};return r.bbox&&(t.bbox=r.bbox),r.type==="GeometryCollection"?(t.geometries=r.geometries.map(e=>Id(e)),t):(t.coordinates=D_(r.coordinates),t)}function D_(r){const t=r;return typeof t[0]!="object"?t.slice():t.map(e=>D_(e))}function z_(r,t){if(!r)throw new Error("geojson is required");if(r.type!=="FeatureCollection")throw new Error("geojson must be a FeatureCollection");if(t==null)throw new Error("filter is required");var e=[];return ye(r,function(i){ic(i.properties,t)&&e.push(i)}),Yt(e)}function Cd(r,t,e){if(!r)throw new Error("geojson is required");if(r.type!=="FeatureCollection")throw new Error("geojson must be a FeatureCollection");if(t==null)throw new Error("property is required");for(var i=Ad(r,t),n=Object.keys(i),s=0;s<n.length;s++){for(var a=n[s],l=i[a],f=[],d=0;d<l.length;d++)f.push(r.features[l[d]]);e(Yt(f),a,s)}}function B_(r,t,e,i){var n=i;return Cd(r,t,function(s,a,l){l===0&&i===void 0?n=s:n=e(n,s,a,l)}),n}function Ad(r,t){var e={};return ye(r,function(i,n){var s=i.properties||{};if(Object.prototype.hasOwnProperty.call(s,String(t))){var a=s[t];Object.prototype.hasOwnProperty.call(e,a)?e[a].push(n):e[a]=[n]}}),e}function ic(r,t){if(r===void 0)return!1;var e=typeof t;if(e==="number"||e==="string")return Object.prototype.hasOwnProperty.call(r,t);if(Array.isArray(t)){for(var i=0;i<t.length;i++)if(!ic(r,t[i]))return!1;return!0}else return Nd(r,t)}function Nd(r,t){for(var e=Object.keys(t),i=0;i<e.length;i++){var n=e[i];if(r[n]!==t[n])return!1}return!0}function F_(r,t){if(!t)return{};if(!t.length)return{};for(var e={},i=0;i<t.length;i++){var n=t[i];Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}const Db=Object.freeze(Object.defineProperty({__proto__:null,applyFilter:ic,clusterEach:Cd,clusterReduce:B_,createBins:Ad,filterProperties:F_,getCluster:z_,propertiesContainsFilter:Nd},Symbol.toStringTag,{value:"Module"}));var zb=ci;function Bb(r,t,e={}){e.mutate!==!0&&(r=bn(r));const i=e.minPoints||3,n=Qh(t,e.units);var s=new zb(r.features.length),a=r.features.map(_=>!1),l=r.features.map(_=>!1),f=r.features.map(_=>!1),d=r.features.map(_=>-1);s.load(r.features.map((_,w)=>{var[b,S]=_.geometry.coordinates;return{minX:b,minY:S,maxX:b,maxY:S,index:w}}));const g=_=>{const w=r.features[_],[b,S]=w.geometry.coordinates,N=Math.max(S-n,-90),k=Math.min(S+n,90),C=function(){return N<0&&k>0?n:Math.abs(N)<Math.abs(k)?n/Math.cos(je(k)):n/Math.cos(je(N))}(),A=Math.max(b-C,-360),P=Math.min(b+C,360),q={minX:A,minY:N,maxX:P,maxY:k};return s.search(q).filter(U=>{const I=U.index,O=r.features[I];return we(w,O,{units:"kilometers"})<=t})},m=(_,w)=>{for(var b=0;b<w.length;b++){var S=w[b];const N=S.index;if(!a[N]){a[N]=!0;const k=g(N);k.length>=i&&w.push(...k)}l[N]||(l[N]=!0,d[N]=_)}};var v=0;return r.features.forEach((_,w)=>{if(a[w])return;const b=g(w);if(b.length>=i){const S=v;v++,a[w]=!0,m(S,b)}else f[w]=!0}),r.features.forEach((_,w)=>{var b=r.features[w];b.properties||(b.properties={}),d[w]>=0?(b.properties.dbscan=f[w]?"edge":"core",b.properties.cluster=d[w]):b.properties.dbscan="noise"}),r}var Ac,Eg;function U_(){return Eg||(Eg=1,Ac={eudist:function(t,e,i){for(var n=t.length,s=0,a=0;a<n;a++){var l=(t[a]||0)-(e[a]||0);s+=l*l}return i?Math.sqrt(s):s},mandist:function(t,e,i){for(var n=t.length,s=0,a=0;a<n;a++)s+=Math.abs((t[a]||0)-(e[a]||0));return i?Math.sqrt(s):s},dist:function(t,e,i){var n=Math.abs(t-e);return i?n:n*n}}),Ac}var Nc,kg;function Fb(){if(kg)return Nc;kg=1;var r=U_(),t=r.eudist,e=r.dist;return Nc={kmrand:function(n,s){for(var a={},l=[],f=s<<2,d=n.length,g=n[0].length>0;l.length<s&&f-- >0;){var m=n[Math.floor(Math.random()*d)],v=g?m.join("_"):""+m;a[v]||(a[v]=!0,l.push(m))}if(l.length<s)throw new Error("Error initializating clusters");return l},kmpp:function(n,s){var a=n[0].length?t:e,l=[],f=n.length,d=n[0].length>0,g=n[Math.floor(Math.random()*f)];for(d?g.join("_"):""+g,l.push(g);l.length<s;){for(var m=[],v=l.length,_=0,w=[],b=0;b<f;b++){for(var S=1/0,N=0;N<v;N++){var k=a(n[b],l[N]);k<=S&&(S=k)}m[b]=S}for(var C=0;C<f;C++)_+=m[C];for(var A=0;A<f;A++)w[A]={i:A,v:n[A],pr:m[A]/_,cs:0};w.sort(function(I,O){return I.pr-O.pr}),w[0].cs=w[0].pr;for(var P=1;P<f;P++)w[P].cs=w[P-1].cs+w[P].pr;for(var q=Math.random(),U=0;U<f-1&&w[U++].cs<q;);l.push(w[U-1].v)}return l}},Nc}var Oc,Mg;function Ub(){if(Mg)return Oc;Mg=1;var r=U_(),t=Fb(),e=r.eudist;r.mandist,r.dist;var i=t.kmrand,n=t.kmpp,s=1e4;function a(f,d,g){g=g||[];for(var m=0;m<f;m++)g[m]=d;return g}function l(f,d,g,m){var v=[],_=[],w=[],b=[],S=!1,N=m||s,k=f.length,C=f[0].length,A=C>0,P=[];if(g)g=="kmrand"?v=i(f,d):g=="kmpp"?v=n(f,d):v=g;else for(var q={};v.length<d;){var U=Math.floor(Math.random()*k);q[U]||(q[U]=!0,v.push(f[U]))}do{a(d,0,P);for(var I=0;I<k;I++){for(var O=1/0,B=0,V=0;V<d;V++){var b=A?e(f[I],v[V]):Math.abs(f[I]-v[V]);b<=O&&(O=b,B=V)}w[I]=B,P[B]++}for(var z=[],_=[],W=0;W<d;W++)z[W]=A?a(C,0,z[W]):0,_[W]=v[W];if(A){for(var T=0;T<d;T++)v[T]=[];for(var $=0;$<k;$++)for(var F=w[$],X=z[F],Y=f[$],j=0;j<C;j++)X[j]+=Y[j];S=!0;for(var J=0;J<d;J++){for(var K=v[J],et=z[J],ft=_[J],lt=P[J],ut=0;ut<C;ut++)K[ut]=et[ut]/lt||0;if(S){for(var mt=0;mt<C;mt++)if(ft[mt]!=K[mt]){S=!1;break}}}}else{for(var Et=0;Et<k;Et++){var at=w[Et];z[at]+=f[Et]}for(var Rt=0;Rt<d;Rt++)v[Rt]=z[Rt]/P[Rt]||0;S=!0;for(var xt=0;xt<d;xt++)if(_[xt]!=v[xt]){S=!1;break}}S=S||--N<=0}while(!S);return{it:s-N,k:d,idxs:w,centroids:v}}return Oc=l,Oc}var Gb=Ub();const Vb=eo(Gb);function qb(r,t={}){var e=r.features.length;t.numberOfClusters=t.numberOfClusters||Math.round(Math.sqrt(e/2)),t.numberOfClusters>e&&(t.numberOfClusters=e),t.mutate!==!0&&(r=bn(r));var i=ju(r),n=i.slice(0,t.numberOfClusters),s=Vb(i,t.numberOfClusters,n),a={};return s.centroids.forEach(function(l,f){a[f]=l}),ye(r,function(l,f){var d=s.idxs[f];l.properties.cluster=d,l.properties.centroid=a[d]}),r}var Zb=ci;function Hb(r,t,e,i){var n=new Zb(6),s=t.features.map(function(a){var l;return{minX:a.geometry.coordinates[0],minY:a.geometry.coordinates[1],maxX:a.geometry.coordinates[0],maxY:a.geometry.coordinates[1],property:(l=a.properties)==null?void 0:l[e]}});return n.load(s),r.features.forEach(function(a){a.properties||(a.properties={});var l=Te(a),f=n.search({minX:l[0],minY:l[1],maxX:l[2],maxY:l[3]}),d=[];f.forEach(function(g){ie([g.minX,g.minY],a)&&d.push(g.property)}),a.properties[i]=d}),r}function Yb(r){var t={MultiPoint:{coordinates:[],properties:[]},MultiLineString:{coordinates:[],properties:[]},MultiPolygon:{coordinates:[],properties:[]}};return ye(r,e=>{var i;switch((i=e.geometry)==null?void 0:i.type){case"Point":t.MultiPoint.coordinates.push(e.geometry.coordinates),t.MultiPoint.properties.push(e.properties);break;case"MultiPoint":t.MultiPoint.coordinates.push(...e.geometry.coordinates),t.MultiPoint.properties.push(e.properties);break;case"LineString":t.MultiLineString.coordinates.push(e.geometry.coordinates),t.MultiLineString.properties.push(e.properties);break;case"MultiLineString":t.MultiLineString.coordinates.push(...e.geometry.coordinates),t.MultiLineString.properties.push(e.properties);break;case"Polygon":t.MultiPolygon.coordinates.push(e.geometry.coordinates),t.MultiPolygon.properties.push(e.properties);break;case"MultiPolygon":t.MultiPolygon.coordinates.push(...e.geometry.coordinates),t.MultiPolygon.properties.push(e.properties);break}}),Yt(Object.keys(t).filter(function(e){return t[e].coordinates.length}).sort().map(function(e){var i={type:e,coordinates:t[e].coordinates},n={collectedProperties:t[e].properties};return Qe(i,n)}))}function G_(r,t){let e=!1;return Yt($b(r.features.map(i=>{const n={x:i.geometry.coordinates[0],y:i.geometry.coordinates[1]};return t?n.z=i.properties[t]:i.geometry.coordinates.length===3&&(e=!0,n.z=i.geometry.coordinates[2]),n})).map(i=>{const n=[i.a.x,i.a.y],s=[i.b.x,i.b.y],a=[i.c.x,i.c.y];let l={};return e?(n.push(i.a.z),s.push(i.b.z),a.push(i.c.z)):l={a:i.a.z,b:i.b.z,c:i.c.z},$t([[n,s,a,n]],l)}))}var Lg=class{constructor(t,e,i){this.a=t,this.b=e,this.c=i;const n=e.x-t.x,s=e.y-t.y,a=i.x-t.x,l=i.y-t.y,f=n*(t.x+e.x)+s*(t.y+e.y),d=a*(t.x+i.x)+l*(t.y+i.y),g=2*(n*(i.y-e.y)-s*(i.x-e.x));let m,v;this.x=(l*f-s*d)/g,this.y=(n*d-a*f)/g,m=this.x-t.x,v=this.y-t.y,this.r=m*m+v*v}};function Xb(r,t){return t.x-r.x}function Wb(r){let t=r.length,e,i,n,s,a;t:for(;t;)for(i=r[--t],e=r[--t],n=t;n;)if(a=r[--n],s=r[--n],e===s&&i===a||e===a&&i===s){r.splice(t,2),r.splice(n,2),t-=2;continue t}}function $b(r){if(r.length<3)return[];r.sort(Xb);let t=r.length-1;const e=r[t].x,i=r[0].x;let n=r[t].y,s=n;const a=1e-12;let l,f,d,g,m,v;for(;t--;)r[t].y<n&&(n=r[t].y),r[t].y>s&&(s=r[t].y);let _=i-e,w=s-n;const b=_>w?_:w,S=(i+e)*.5,N=(s+n)*.5,k=[new Lg({__sentinel:!0,x:S-20*b,y:N-b},{__sentinel:!0,x:S,y:N+20*b},{__sentinel:!0,x:S+20*b,y:N-b})],C=[],A=[];let P;for(t=r.length;t--;){for(A.length=0,P=k.length;P--;){if(_=r[t].x-k[P].x,_>0&&_*_>k[P].r){C.push(k[P]),k.splice(P,1);continue}w=r[t].y-k[P].y,!(_*_+w*w>k[P].r)&&(A.push(k[P].a,k[P].b,k[P].b,k[P].c,k[P].c,k[P].a),k.splice(P,1))}for(Wb(A),P=A.length;P;)f=A[--P],l=A[--P],d=r[t],g=f.x-l.x,m=f.y-l.y,v=2*(g*(d.y-f.y)-m*(d.x-f.x)),Math.abs(v)>a&&k.push(new Lg(l,f,d))}for(Array.prototype.push.apply(C,k),t=C.length;t--;)(C[t].a.__sentinel||C[t].b.__sentinel||C[t].c.__sentinel)&&C.splice(t,1);return C}function Jb(r){return r}function jb(r){if(r==null)return Jb;var t,e,i=r.scale[0],n=r.scale[1],s=r.translate[0],a=r.translate[1];return function(l,f){f||(t=e=0);var d=2,g=l.length,m=new Array(g);for(m[0]=(t+=l[0])*i+s,m[1]=(e+=l[1])*n+a;d<g;)m[d]=l[d],++d;return m}}function Kb(r,t){for(var e,i=r.length,n=i-t;n<--i;)e=r[n],r[n++]=r[i],r[i]=e}function V_(r,t){var e=jb(r.transform),i=r.arcs;function n(g,m){m.length&&m.pop();for(var v=i[g<0?~g:g],_=0,w=v.length;_<w;++_)m.push(e(v[_],_));g<0&&Kb(m,w)}function s(g){return e(g)}function a(g){for(var m=[],v=0,_=g.length;v<_;++v)n(g[v],m);return m.length<2&&m.push(m[0]),m}function l(g){for(var m=a(g);m.length<4;)m.push(m[0]);return m}function f(g){return g.map(l)}function d(g){var m=g.type,v;switch(m){case"GeometryCollection":return{type:m,geometries:g.geometries.map(d)};case"Point":v=s(g.coordinates);break;case"MultiPoint":v=g.coordinates.map(s);break;case"LineString":v=a(g.arcs);break;case"MultiLineString":v=g.arcs.map(a);break;case"Polygon":v=f(g.arcs);break;case"MultiPolygon":v=g.arcs.map(f);break;default:return null}return{type:m,coordinates:v}}return d(t)}function Qb(r,t){var e={},i={},n={},s=[],a=-1;t.forEach(function(d,g){var m=r.arcs[d<0?~d:d],v;m.length<3&&!m[1][0]&&!m[1][1]&&(v=t[++a],t[a]=d,t[g]=v)}),t.forEach(function(d){var g=l(d),m=g[0],v=g[1],_,w;if(_=n[m])if(delete n[_.end],_.push(d),_.end=v,w=i[v]){delete i[w.start];var b=w===_?_:_.concat(w);i[b.start=_.start]=n[b.end=w.end]=b}else i[_.start]=n[_.end]=_;else if(_=i[v])if(delete i[_.start],_.unshift(d),_.start=m,w=n[m]){delete n[w.end];var S=w===_?_:w.concat(_);i[S.start=w.start]=n[S.end=_.end]=S}else i[_.start]=n[_.end]=_;else _=[d],i[_.start=m]=n[_.end=v]=_});function l(d){var g=r.arcs[d<0?~d:d],m=g[0],v;return r.transform?(v=[0,0],g.forEach(function(_){v[0]+=_[0],v[1]+=_[1]})):v=g[g.length-1],d<0?[v,m]:[m,v]}function f(d,g){for(var m in d){var v=d[m];delete g[v.start],delete v.start,delete v.end,v.forEach(function(_){e[_<0?~_:_]=1}),s.push(v)}}return f(n,i),f(i,n),t.forEach(function(d){e[d<0?~d:d]||s.push([d])}),s}function tE(r){for(var t=-1,e=r.length,i,n=r[e-1],s=0;++t<e;)i=n,n=r[t],s+=i[0]*n[1]-i[1]*n[0];return Math.abs(s)}function eE(r){return V_(r,nE.apply(this,arguments))}function nE(r,t){var e={},i=[],n=[];t.forEach(s);function s(f){switch(f.type){case"GeometryCollection":f.geometries.forEach(s);break;case"Polygon":a(f.arcs);break;case"MultiPolygon":f.arcs.forEach(a);break}}function a(f){f.forEach(function(d){d.forEach(function(g){(e[g=g<0?~g:g]||(e[g]=[])).push(f)})}),i.push(f)}function l(f){return tE(V_(r,{type:"Polygon",arcs:[f]}).coordinates[0])}return i.forEach(function(f){if(!f._){var d=[],g=[f];for(f._=1,n.push(d);f=g.pop();)d.push(f),f.forEach(function(m){m.forEach(function(v){e[v<0?~v:v].forEach(function(_){_._||(_._=1,g.push(_))})})})}}),i.forEach(function(f){delete f._}),{type:"MultiPolygon",arcs:n.map(function(f){var d=[],g;if(f.forEach(function(b){b.forEach(function(S){S.forEach(function(N){e[N<0?~N:N].length<2&&d.push(N)})})}),d=Qb(r,d),(g=d.length)>1)for(var m=1,v=l(d[0]),_,w;m<g;++m)(_=l(d[m]))>v&&(w=d[0],d[0]=d[m],d[m]=w,v=_);return d}).filter(function(f){return f.length>0})}}var Od=Object.prototype.hasOwnProperty;function iE(r){var t=1/0,e=1/0,i=-1/0,n=-1/0;function s(m){m!=null&&Od.call(a,m.type)&&a[m.type](m)}var a={GeometryCollection:function(m){m.geometries.forEach(s)},Point:function(m){l(m.coordinates)},MultiPoint:function(m){m.coordinates.forEach(l)},LineString:function(m){f(m.arcs)},MultiLineString:function(m){m.arcs.forEach(f)},Polygon:function(m){m.arcs.forEach(f)},MultiPolygon:function(m){m.arcs.forEach(d)}};function l(m){var v=m[0],_=m[1];v<t&&(t=v),v>i&&(i=v),_<e&&(e=_),_>n&&(n=_)}function f(m){m.forEach(l)}function d(m){m.forEach(f)}for(var g in r)s(r[g]);return i>=t&&n>=e?[t,e,i,n]:void 0}function rE(r,t,e,i,n){arguments.length===3&&(i=Array,n=null);for(var s=new i(r=1<<Math.max(4,Math.ceil(Math.log(r)/Math.LN2))),a=r-1,l=0;l<r;++l)s[l]=n;function f(m){for(var v=t(m)&a,_=s[v],w=0;_!=n;){if(e(_,m))return!0;if(++w>=r)throw new Error("full hashset");_=s[v=v+1&a]}return s[v]=m,!0}function d(m){for(var v=t(m)&a,_=s[v],w=0;_!=n;){if(e(_,m))return!0;if(++w>=r)break;_=s[v=v+1&a]}return!1}function g(){for(var m=[],v=0,_=s.length;v<_;++v){var w=s[v];w!=n&&m.push(w)}return m}return{add:f,has:d,values:g}}function Rd(r,t,e,i,n,s){arguments.length===3&&(i=s=Array,n=null);for(var a=new i(r=1<<Math.max(4,Math.ceil(Math.log(r)/Math.LN2))),l=new s(r),f=r-1,d=0;d<r;++d)a[d]=n;function g(w,b){for(var S=t(w)&f,N=a[S],k=0;N!=n;){if(e(N,w))return l[S]=b;if(++k>=r)throw new Error("full hashmap");N=a[S=S+1&f]}return a[S]=w,l[S]=b,b}function m(w,b){for(var S=t(w)&f,N=a[S],k=0;N!=n;){if(e(N,w))return l[S];if(++k>=r)throw new Error("full hashmap");N=a[S=S+1&f]}return a[S]=w,l[S]=b,b}function v(w,b){for(var S=t(w)&f,N=a[S],k=0;N!=n;){if(e(N,w))return l[S];if(++k>=r)break;N=a[S=S+1&f]}return b}function _(){for(var w=[],b=0,S=a.length;b<S;++b){var N=a[b];N!=n&&w.push(N)}return w}return{set:g,maybeSet:m,get:v,keys:_}}function Ao(r,t){return r[0]===t[0]&&r[1]===t[1]}var q_=new ArrayBuffer(16),Sg=new Float64Array(q_),Rl=new Uint32Array(q_);function Nf(r){Sg[0]=r[0],Sg[1]=r[1];var t=Rl[0]^Rl[1];return t=t<<5^t>>7^Rl[2]^Rl[3],t&2147483647}function sE(r){var t=r.coordinates,e=r.lines,i=r.rings,n=q(),s=new Int32Array(t.length),a=new Int32Array(t.length),l=new Int32Array(t.length),f=new Int8Array(t.length),d=0,g,m,v,_,w;for(g=0,m=t.length;g<m;++g)s[g]=a[g]=l[g]=-1;for(g=0,m=e.length;g<m;++g){var b=e[g],S=b[0],N=b[1];for(_=n[S],w=n[++S],++d,f[_]=1;++S<=N;)P(g,v=_,_=w,w=n[S]);++d,f[w]=1}for(g=0,m=t.length;g<m;++g)s[g]=-1;for(g=0,m=i.length;g<m;++g){var k=i[g],C=k[0]+1,A=k[1];for(v=n[A-1],_=n[C-1],w=n[C],P(g,v,_,w);++C<=A;)P(g,v=_,_=w,w=n[C])}function P(V,z,W,T){if(s[W]!==V){s[W]=V;var $=a[W];if($>=0){var F=l[W];($!==z||F!==T)&&($!==T||F!==z)&&(++d,f[W]=1)}else a[W]=z,l[W]=T}}function q(){for(var V=Rd(t.length*1.4,U,I,Int32Array,-1,Int32Array),z=new Int32Array(t.length),W=0,T=t.length;W<T;++W)z[W]=V.maybeSet(W,W);return z}function U(V){return Nf(t[V])}function I(V,z){return Ao(t[V],t[z])}s=a=l=null;var O=rE(d*1.4,Nf,Ao),B;for(g=0,m=t.length;g<m;++g)f[B=n[g]]&&O.add(t[B]);return O}function oE(r){var t=sE(r),e=r.coordinates,i=r.lines,n=r.rings,s,a,l;for(a=0,l=i.length;a<l;++a)for(var f=i[a],d=f[0],g=f[1];++d<g;)t.has(e[d])&&(s={0:d,1:f[1]},f[1]=d,f=f.next=s);for(a=0,l=n.length;a<l;++a)for(var m=n[a],v=m[0],_=v,w=m[1],b=t.has(e[v]);++_<w;)t.has(e[_])&&(b?(s={0:_,1:m[1]},m[1]=_,m=m.next=s):(aE(e,v,w,w-_),e[w]=e[v],b=!0,_=v));return r}function aE(r,t,e,i){Rc(r,t,e),Rc(r,t,t+i),Rc(r,t+i,e)}function Rc(r,t,e){for(var i=t+(e---t>>1),n;t<i;++t,--e)n=r[t],r[t]=r[e],r[e]=n}function uE(r){var t=r.coordinates,e=r.lines,i,n=r.rings,s,a=e.length+n.length,l,f;for(delete r.lines,delete r.rings,l=0,f=e.length;l<f;++l)for(i=e[l];i=i.next;)++a;for(l=0,f=n.length;l<f;++l)for(s=n[l];s=s.next;)++a;var d=Rd(a*2*1.4,Nf,Ao),g=r.arcs=[];for(l=0,f=e.length;l<f;++l){i=e[l];do m(i);while(i=i.next)}for(l=0,f=n.length;l<f;++l)if(s=n[l],s.next)do m(s);while(s=s.next);else v(s);function m(k){var C,A,P,q,U,I,O,B;if(P=d.get(C=t[k[0]])){for(O=0,B=P.length;O<B;++O)if(q=P[O],_(q,k)){k[0]=q[0],k[1]=q[1];return}}if(U=d.get(A=t[k[1]])){for(O=0,B=U.length;O<B;++O)if(I=U[O],w(I,k)){k[1]=I[0],k[0]=I[1];return}}P?P.push(k):d.set(C,[k]),U?U.push(k):d.set(A,[k]),g.push(k)}function v(k){var C,A,P,q,U;if(A=d.get(C=t[k[0]]))for(q=0,U=A.length;q<U;++q){if(P=A[q],b(P,k)){k[0]=P[0],k[1]=P[1];return}if(S(P,k)){k[0]=P[1],k[1]=P[0];return}}if(A=d.get(C=t[k[0]+N(k)]))for(q=0,U=A.length;q<U;++q){if(P=A[q],b(P,k)){k[0]=P[0],k[1]=P[1];return}if(S(P,k)){k[0]=P[1],k[1]=P[0];return}}A?A.push(k):d.set(C,[k]),g.push(k)}function _(k,C){var A=k[0],P=C[0],q=k[1],U=C[1];if(A-q!==P-U)return!1;for(;A<=q;++A,++P)if(!Ao(t[A],t[P]))return!1;return!0}function w(k,C){var A=k[0],P=C[0],q=k[1],U=C[1];if(A-q!==P-U)return!1;for(;A<=q;++A,--U)if(!Ao(t[A],t[U]))return!1;return!0}function b(k,C){var A=k[0],P=C[0],q=k[1],U=C[1],I=q-A;if(I!==U-P)return!1;for(var O=N(k),B=N(C),V=0;V<I;++V)if(!Ao(t[A+(V+O)%I],t[P+(V+B)%I]))return!1;return!0}function S(k,C){var A=k[0],P=C[0],q=k[1],U=C[1],I=q-A;if(I!==U-P)return!1;for(var O=N(k),B=I-N(C),V=0;V<I;++V)if(!Ao(t[A+(V+O)%I],t[U-(V+B)%I]))return!1;return!0}function N(k){for(var C=k[0],A=k[1],P=C,q=P,U=t[P];++P<A;){var I=t[P];(I[0]<U[0]||I[0]===U[0]&&I[1]<U[1])&&(q=P,U=I)}return q-C}return r}function lE(r){var t=-1,e=[],i=[],n=[];function s(m){m&&Od.call(a,m.type)&&a[m.type](m)}var a={GeometryCollection:function(m){m.geometries.forEach(s)},LineString:function(m){m.arcs=l(m.arcs)},MultiLineString:function(m){m.arcs=m.arcs.map(l)},Polygon:function(m){m.arcs=m.arcs.map(f)},MultiPolygon:function(m){m.arcs=m.arcs.map(d)}};function l(m){for(var v=0,_=m.length;v<_;++v)n[++t]=m[v];var w={0:t-_+1,1:t};return e.push(w),w}function f(m){for(var v=0,_=m.length;v<_;++v)n[++t]=m[v];var w={0:t-_+1,1:t};return i.push(w),w}function d(m){return m.map(f)}for(var g in r)s(r[g]);return{type:"Topology",coordinates:n,lines:e,rings:i,objects:r}}function hE(r){var t={},e;for(e in r)t[e]=cE(r[e]);return t}function cE(r){return r==null?{type:null}:(r.type==="FeatureCollection"?fE:r.type==="Feature"?Z_:Dd)(r)}function fE(r){var t={type:"GeometryCollection",geometries:r.features.map(Z_)};return r.bbox!=null&&(t.bbox=r.bbox),t}function Z_(r){var t=Dd(r.geometry),e;r.id!=null&&(t.id=r.id),r.bbox!=null&&(t.bbox=r.bbox);for(e in r.properties){t.properties=r.properties;break}return t}function Dd(r){if(r==null)return{type:null};var t=r.type==="GeometryCollection"?{type:"GeometryCollection",geometries:r.geometries.map(Dd)}:r.type==="Point"||r.type==="MultiPoint"?{type:r.type,coordinates:r.coordinates}:{type:r.type,arcs:r.coordinates};return r.bbox!=null&&(t.bbox=r.bbox),t}function dE(r,t){var e=iE(r=hE(r)),i=uE(oE(lE(r))),n=i.coordinates,s=Rd(i.arcs.length*1.4,pE,gE);r=i.objects,i.bbox=e,i.arcs=i.arcs.map(function(m,v){return s.set(m,v),n.slice(m[0],m[1]+1)}),delete i.coordinates,n=null;function a(m){m&&Od.call(l,m.type)&&l[m.type](m)}var l={GeometryCollection:function(m){m.geometries.forEach(a)},LineString:function(m){m.arcs=f(m.arcs)},MultiLineString:function(m){m.arcs=m.arcs.map(f)},Polygon:function(m){m.arcs=m.arcs.map(f)},MultiPolygon:function(m){m.arcs=m.arcs.map(d)}};function f(m){var v=[];do{var _=s.get(m);v.push(m[0]<m[1]?_:~_)}while(m=m.next);return v}function d(m){return m.map(f)}for(var g in r)a(r[g]);return i}function pE(r){var t=r[0],e=r[1],i;return e<t&&(i=t,t=e,e=i),t+31*e}function gE(r,t){var e=r[0],i=r[1],n=t[0],s=t[1],a;return i<e&&(a=e,e=i,i=a),s<n&&(a=n,n=s,s=a),e===n&&i===s}function mE(r,t={}){if(t=t||{},!ve(t))throw new Error("options is invalid");const e=t.mutate;if(gi(r)!=="FeatureCollection")throw new Error("geojson must be a FeatureCollection");if(!r.features.length)throw new Error("geojson is empty");(e===!1||e===void 0)&&(r=bn(r));const i=[],n=kd(r,(s,a)=>{const l=yE(s,a);return l||(i.push(s),a)});return n&&i.push(n),i.length?i.length===1?i[0]:no(i.map(s=>s.coordinates)):null}function Dl(r){return r[0].toString()+","+r[1].toString()}function yE(r,t){const e=r.geometry.coordinates,i=t.geometry.coordinates,n=Dl(e[0]),s=Dl(e[e.length-1]),a=Dl(i[0]),l=Dl(i[i.length-1]);let f;if(n===l)f=i.concat(e.slice(1));else if(a===s)f=e.concat(i.slice(1));else if(n===a)f=e.slice(1).reverse().concat(i);else if(s===l)f=e.concat(i.reverse().slice(1));else return null;return ge(f)}function _E(r,t={}){if(gi(r)!=="FeatureCollection")throw new Error("geojson must be a FeatureCollection");if(!r.features.length)throw new Error("geojson is empty");(t.mutate===!1||t.mutate===void 0)&&(r=bn(r));const e=[];vn(r,s=>{e.push(s.geometry)});const i=dE({geoms:gd(e).geometry});return eE(i,i.objects.geoms.geometries)}function vE(r,t={}){if(t=t||{},!ve(t))throw new Error("options is invalid");const e=t.mutate;if(gi(r)!=="FeatureCollection")throw new Error("geojson must be a FeatureCollection");if(!r.features.length)throw new Error("geojson is empty");(e===!1||e===void 0)&&(r=bn(r));const i=xE(r);if(!i)throw new Error("geojson must be homogenous");const n=r;switch(i){case"LineString":return mE(n,t);case"Polygon":return _E(n,t);default:throw new Error(i+" is not supported")}}function xE(r){const t={};vn(r,i=>{t[i.geometry.type]=!0});const e=Object.keys(t);return e.length===1?e[0]:null}function wE(r,t={}){const e=t.maxEdge||1/0,i=bE(r),n=G_(i);if(n.features=n.features.filter(a=>{const l=a.geometry.coordinates[0][0],f=a.geometry.coordinates[0][1],d=a.geometry.coordinates[0][2],g=we(l,f,t),m=we(f,d,t),v=we(l,d,t);return g<=e&&m<=e&&v<=e}),n.features.length<1)return null;const s=vE(n);return s.coordinates.length===1&&(s.coordinates=s.coordinates[0],s.type="Polygon"),Qe(s)}function bE(r){const t=[],e={};return ye(r,i=>{if(!i.geometry)return;const n=i.geometry.coordinates.join("-");Object.prototype.hasOwnProperty.call(e,n)||(t.push(i),e[n]=!0)}),Yt(t)}var EE=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,Dc=Math.ceil,Zi=Math.floor,hi="[BigNumber Error] ",Tg=hi+"Number primitive has more than 15 significant digits: ",cr=1e14,oe=14,Pg=9007199254740991,zc=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],Fs=1e7,bi=1e9;function H_(r){var t,e,i,n=k.prototype={constructor:k,toString:null,valueOf:null},s=new k(1),a=20,l=4,f=-7,d=21,g=-1e7,m=1e7,v=!1,_=1,w=0,b={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:"",suffix:""},S="0123456789abcdefghijklmnopqrstuvwxyz",N=!0;function k(I,O){var B,V,z,W,T,$,F,X,Y=this;if(!(Y instanceof k))return new k(I,O);if(O==null){if(I&&I._isBigNumber===!0){Y.s=I.s,!I.c||I.e>m?Y.c=Y.e=null:I.e<g?Y.c=[Y.e=0]:(Y.e=I.e,Y.c=I.c.slice());return}if(($=typeof I=="number")&&I*0==0){if(Y.s=1/I<0?(I=-I,-1):1,I===~~I){for(W=0,T=I;T>=10;T/=10,W++);W>m?Y.c=Y.e=null:(Y.e=W,Y.c=[I]);return}X=String(I)}else{if(!EE.test(X=String(I)))return i(Y,X,$);Y.s=X.charCodeAt(0)==45?(X=X.slice(1),-1):1}(W=X.indexOf("."))>-1&&(X=X.replace(".","")),(T=X.search(/e/i))>0?(W<0&&(W=T),W+=+X.slice(T+1),X=X.substring(0,T)):W<0&&(W=X.length)}else{if(Xe(O,2,S.length,"Base"),O==10&&N)return Y=new k(I),q(Y,a+Y.e+1,l);if(X=String(I),$=typeof I=="number"){if(I*0!=0)return i(Y,X,$,O);if(Y.s=1/I<0?(X=X.slice(1),-1):1,k.DEBUG&&X.replace(/^0\.0*|\./,"").length>15)throw Error(Tg+I)}else Y.s=X.charCodeAt(0)===45?(X=X.slice(1),-1):1;for(B=S.slice(0,O),W=T=0,F=X.length;T<F;T++)if(B.indexOf(V=X.charAt(T))<0){if(V=="."){if(T>W){W=F;continue}}else if(!z&&(X==X.toUpperCase()&&(X=X.toLowerCase())||X==X.toLowerCase()&&(X=X.toUpperCase()))){z=!0,T=-1,W=0;continue}return i(Y,String(I),$,O)}$=!1,X=e(X,O,10,Y.s),(W=X.indexOf("."))>-1?X=X.replace(".",""):W=X.length}for(T=0;X.charCodeAt(T)===48;T++);for(F=X.length;X.charCodeAt(--F)===48;);if(X=X.slice(T,++F)){if(F-=T,$&&k.DEBUG&&F>15&&(I>Pg||I!==Zi(I)))throw Error(Tg+Y.s*I);if((W=W-T-1)>m)Y.c=Y.e=null;else if(W<g)Y.c=[Y.e=0];else{if(Y.e=W,Y.c=[],T=(W+1)%oe,W<0&&(T+=oe),T<F){for(T&&Y.c.push(+X.slice(0,T)),F-=oe;T<F;)Y.c.push(+X.slice(T,T+=oe));T=oe-(X=X.slice(T)).length}else T-=F;for(;T--;X+="0");Y.c.push(+X)}}else Y.c=[Y.e=0]}k.clone=H_,k.ROUND_UP=0,k.ROUND_DOWN=1,k.ROUND_CEIL=2,k.ROUND_FLOOR=3,k.ROUND_HALF_UP=4,k.ROUND_HALF_DOWN=5,k.ROUND_HALF_EVEN=6,k.ROUND_HALF_CEIL=7,k.ROUND_HALF_FLOOR=8,k.EUCLID=9,k.config=k.set=function(I){var O,B;if(I!=null)if(typeof I=="object"){if(I.hasOwnProperty(O="DECIMAL_PLACES")&&(B=I[O],Xe(B,0,bi,O),a=B),I.hasOwnProperty(O="ROUNDING_MODE")&&(B=I[O],Xe(B,0,8,O),l=B),I.hasOwnProperty(O="EXPONENTIAL_AT")&&(B=I[O],B&&B.pop?(Xe(B[0],-1e9,0,O),Xe(B[1],0,bi,O),f=B[0],d=B[1]):(Xe(B,-1e9,bi,O),f=-(d=B<0?-B:B))),I.hasOwnProperty(O="RANGE"))if(B=I[O],B&&B.pop)Xe(B[0],-1e9,-1,O),Xe(B[1],1,bi,O),g=B[0],m=B[1];else if(Xe(B,-1e9,bi,O),B)g=-(m=B<0?-B:B);else throw Error(hi+O+" cannot be zero: "+B);if(I.hasOwnProperty(O="CRYPTO"))if(B=I[O],B===!!B)if(B)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))v=B;else throw v=!B,Error(hi+"crypto unavailable");else v=B;else throw Error(hi+O+" not true or false: "+B);if(I.hasOwnProperty(O="MODULO_MODE")&&(B=I[O],Xe(B,0,9,O),_=B),I.hasOwnProperty(O="POW_PRECISION")&&(B=I[O],Xe(B,0,bi,O),w=B),I.hasOwnProperty(O="FORMAT"))if(B=I[O],typeof B=="object")b=B;else throw Error(hi+O+" not an object: "+B);if(I.hasOwnProperty(O="ALPHABET"))if(B=I[O],typeof B=="string"&&!/^.?$|[+\-.\s]|(.).*\1/.test(B))N=B.slice(0,10)=="0123456789",S=B;else throw Error(hi+O+" invalid: "+B)}else throw Error(hi+"Object expected: "+I);return{DECIMAL_PLACES:a,ROUNDING_MODE:l,EXPONENTIAL_AT:[f,d],RANGE:[g,m],CRYPTO:v,MODULO_MODE:_,POW_PRECISION:w,FORMAT:b,ALPHABET:S}},k.isBigNumber=function(I){if(!I||I._isBigNumber!==!0)return!1;if(!k.DEBUG)return!0;var O,B,V=I.c,z=I.e,W=I.s;t:if({}.toString.call(V)=="[object Array]"){if((W===1||W===-1)&&z>=-1e9&&z<=bi&&z===Zi(z)){if(V[0]===0){if(z===0&&V.length===1)return!0;break t}if(O=(z+1)%oe,O<1&&(O+=oe),String(V[0]).length==O){for(O=0;O<V.length;O++)if(B=V[O],B<0||B>=cr||B!==Zi(B))break t;if(B!==0)return!0}}}else if(V===null&&z===null&&(W===null||W===1||W===-1))return!0;throw Error(hi+"Invalid BigNumber: "+I)},k.maximum=k.max=function(){return A(arguments,-1)},k.minimum=k.min=function(){return A(arguments,1)},k.random=function(){var I=9007199254740992,O=Math.random()*I&2097151?function(){return Zi(Math.random()*I)}:function(){return(Math.random()*1073741824|0)*8388608+(Math.random()*8388608|0)};return function(B){var V,z,W,T,$,F=0,X=[],Y=new k(s);if(B==null?B=a:Xe(B,0,bi),T=Dc(B/oe),v)if(crypto.getRandomValues){for(V=crypto.getRandomValues(new Uint32Array(T*=2));F<T;)$=V[F]*131072+(V[F+1]>>>11),$>=9e15?(z=crypto.getRandomValues(new Uint32Array(2)),V[F]=z[0],V[F+1]=z[1]):(X.push($%1e14),F+=2);F=T/2}else if(crypto.randomBytes){for(V=crypto.randomBytes(T*=7);F<T;)$=(V[F]&31)*281474976710656+V[F+1]*1099511627776+V[F+2]*4294967296+V[F+3]*16777216+(V[F+4]<<16)+(V[F+5]<<8)+V[F+6],$>=9e15?crypto.randomBytes(7).copy(V,F):(X.push($%1e14),F+=7);F=T/7}else throw v=!1,Error(hi+"crypto unavailable");if(!v)for(;F<T;)$=O(),$<9e15&&(X[F++]=$%1e14);for(T=X[--F],B%=oe,T&&B&&($=zc[oe-B],X[F]=Zi(T/$)*$);X[F]===0;X.pop(),F--);if(F<0)X=[W=0];else{for(W=-1;X[0]===0;X.splice(0,1),W-=oe);for(F=1,$=X[0];$>=10;$/=10,F++);F<oe&&(W-=oe-F)}return Y.e=W,Y.c=X,Y}}(),k.sum=function(){for(var I=1,O=arguments,B=new k(O[0]);I<O.length;)B=B.plus(O[I++]);return B},e=function(){var I="0123456789";function O(B,V,z,W){for(var T,$=[0],F,X=0,Y=B.length;X<Y;){for(F=$.length;F--;$[F]*=V);for($[0]+=W.indexOf(B.charAt(X++)),T=0;T<$.length;T++)$[T]>z-1&&($[T+1]==null&&($[T+1]=0),$[T+1]+=$[T]/z|0,$[T]%=z)}return $.reverse()}return function(B,V,z,W,T){var $,F,X,Y,j,J,K,et,ft=B.indexOf("."),lt=a,ut=l;for(ft>=0&&(Y=w,w=0,B=B.replace(".",""),et=new k(V),J=et.pow(B.length-ft),w=Y,et.c=O(jr(Vi(J.c),J.e,"0"),10,z,I),et.e=et.c.length),K=O(B,V,z,T?($=S,I):($=I,S)),X=Y=K.length;K[--Y]==0;K.pop());if(!K[0])return $.charAt(0);if(ft<0?--X:(J.c=K,J.e=X,J.s=W,J=t(J,et,lt,ut,z),K=J.c,j=J.r,X=J.e),F=X+lt+1,ft=K[F],Y=z/2,j=j||F<0||K[F+1]!=null,j=ut<4?(ft!=null||j)&&(ut==0||ut==(J.s<0?3:2)):ft>Y||ft==Y&&(ut==4||j||ut==6&&K[F-1]&1||ut==(J.s<0?8:7)),F<1||!K[0])B=j?jr($.charAt(1),-lt,$.charAt(0)):$.charAt(0);else{if(K.length=F,j)for(--z;++K[--F]>z;)K[F]=0,F||(++X,K=[1].concat(K));for(Y=K.length;!K[--Y];);for(ft=0,B="";ft<=Y;B+=$.charAt(K[ft++]));B=jr(B,X,$.charAt(0))}return B}}(),t=function(){function I(V,z,W){var T,$,F,X,Y=0,j=V.length,J=z%Fs,K=z/Fs|0;for(V=V.slice();j--;)F=V[j]%Fs,X=V[j]/Fs|0,T=K*F+X*J,$=J*F+T%Fs*Fs+Y,Y=($/W|0)+(T/Fs|0)+K*X,V[j]=$%W;return Y&&(V=[Y].concat(V)),V}function O(V,z,W,T){var $,F;if(W!=T)F=W>T?1:-1;else for($=F=0;$<W;$++)if(V[$]!=z[$]){F=V[$]>z[$]?1:-1;break}return F}function B(V,z,W,T){for(var $=0;W--;)V[W]-=$,$=V[W]<z[W]?1:0,V[W]=$*T+V[W]-z[W];for(;!V[0]&&V.length>1;V.splice(0,1));}return function(V,z,W,T,$){var F,X,Y,j,J,K,et,ft,lt,ut,mt,Et,at,Rt,xt,_t,tt,wt=V.s==z.s?1:-1,G=V.c,ct=z.c;if(!G||!G[0]||!ct||!ct[0])return new k(!V.s||!z.s||(G?ct&&G[0]==ct[0]:!ct)?NaN:G&&G[0]==0||!ct?wt*0:wt/0);for(ft=new k(wt),lt=ft.c=[],X=V.e-z.e,wt=W+X+1,$||($=cr,X=Hi(V.e/oe)-Hi(z.e/oe),wt=wt/oe|0),Y=0;ct[Y]==(G[Y]||0);Y++);if(ct[Y]>(G[Y]||0)&&X--,wt<0)lt.push(1),j=!0;else{for(Rt=G.length,_t=ct.length,Y=0,wt+=2,J=Zi($/(ct[0]+1)),J>1&&(ct=I(ct,J,$),G=I(G,J,$),_t=ct.length,Rt=G.length),at=_t,ut=G.slice(0,_t),mt=ut.length;mt<_t;ut[mt++]=0);tt=ct.slice(),tt=[0].concat(tt),xt=ct[0],ct[1]>=$/2&&xt++;do{if(J=0,F=O(ct,ut,_t,mt),F<0){if(Et=ut[0],_t!=mt&&(Et=Et*$+(ut[1]||0)),J=Zi(Et/xt),J>1)for(J>=$&&(J=$-1),K=I(ct,J,$),et=K.length,mt=ut.length;O(K,ut,et,mt)==1;)J--,B(K,_t<et?tt:ct,et,$),et=K.length,F=1;else J==0&&(F=J=1),K=ct.slice(),et=K.length;if(et<mt&&(K=[0].concat(K)),B(ut,K,mt,$),mt=ut.length,F==-1)for(;O(ct,ut,_t,mt)<1;)J++,B(ut,_t<mt?tt:ct,mt,$),mt=ut.length}else F===0&&(J++,ut=[0]);lt[Y++]=J,ut[0]?ut[mt++]=G[at]||0:(ut=[G[at]],mt=1)}while((at++<Rt||ut[0]!=null)&&wt--);j=ut[0]!=null,lt[0]||lt.splice(0,1)}if($==cr){for(Y=1,wt=lt[0];wt>=10;wt/=10,Y++);q(ft,W+(ft.e=Y+X*oe-1)+1,T,j)}else ft.e=X,ft.r=+j;return ft}}();function C(I,O,B,V){var z,W,T,$,F;if(B==null?B=l:Xe(B,0,8),!I.c)return I.toString();if(z=I.c[0],T=I.e,O==null)F=Vi(I.c),F=V==1||V==2&&(T<=f||T>=d)?Bl(F,T):jr(F,T,"0");else if(I=q(new k(I),O,B),W=I.e,F=Vi(I.c),$=F.length,V==1||V==2&&(O<=W||W<=f)){for(;$<O;F+="0",$++);F=Bl(F,W)}else if(O-=T,F=jr(F,W,"0"),W+1>$){if(--O>0)for(F+=".";O--;F+="0");}else if(O+=W-$,O>0)for(W+1==$&&(F+=".");O--;F+="0");return I.s<0&&z?"-"+F:F}function A(I,O){for(var B,V,z=1,W=new k(I[0]);z<I.length;z++)V=new k(I[z]),(!V.s||(B=To(W,V))===O||B===0&&W.s===O)&&(W=V);return W}function P(I,O,B){for(var V=1,z=O.length;!O[--z];O.pop());for(z=O[0];z>=10;z/=10,V++);return(B=V+B*oe-1)>m?I.c=I.e=null:B<g?I.c=[I.e=0]:(I.e=B,I.c=O),I}i=function(){var I=/^(-?)0([xbo])(?=\w[\w.]*$)/i,O=/^([^.]+)\.$/,B=/^\.([^.]+)$/,V=/^-?(Infinity|NaN)$/,z=/^\s*\+(?=[\w.])|^\s+|\s+$/g;return function(W,T,$,F){var X,Y=$?T:T.replace(z,"");if(V.test(Y))W.s=isNaN(Y)?null:Y<0?-1:1;else{if(!$&&(Y=Y.replace(I,function(j,J,K){return X=(K=K.toLowerCase())=="x"?16:K=="b"?2:8,!F||F==X?J:j}),F&&(X=F,Y=Y.replace(O,"$1").replace(B,"0.$1")),T!=Y))return new k(Y,X);if(k.DEBUG)throw Error(hi+"Not a"+(F?" base "+F:"")+" number: "+T);W.s=null}W.c=W.e=null}}();function q(I,O,B,V){var z,W,T,$,F,X,Y,j=I.c,J=zc;if(j){t:{for(z=1,$=j[0];$>=10;$/=10,z++);if(W=O-z,W<0)W+=oe,T=O,F=j[X=0],Y=Zi(F/J[z-T-1]%10);else if(X=Dc((W+1)/oe),X>=j.length)if(V){for(;j.length<=X;j.push(0));F=Y=0,z=1,W%=oe,T=W-oe+1}else break t;else{for(F=$=j[X],z=1;$>=10;$/=10,z++);W%=oe,T=W-oe+z,Y=T<0?0:Zi(F/J[z-T-1]%10)}if(V=V||O<0||j[X+1]!=null||(T<0?F:F%J[z-T-1]),V=B<4?(Y||V)&&(B==0||B==(I.s<0?3:2)):Y>5||Y==5&&(B==4||V||B==6&&(W>0?T>0?F/J[z-T]:0:j[X-1])%10&1||B==(I.s<0?8:7)),O<1||!j[0])return j.length=0,V?(O-=I.e+1,j[0]=J[(oe-O%oe)%oe],I.e=-O||0):j[0]=I.e=0,I;if(W==0?(j.length=X,$=1,X--):(j.length=X+1,$=J[oe-W],j[X]=T>0?Zi(F/J[z-T]%J[T])*$:0),V)for(;;)if(X==0){for(W=1,T=j[0];T>=10;T/=10,W++);for(T=j[0]+=$,$=1;T>=10;T/=10,$++);W!=$&&(I.e++,j[0]==cr&&(j[0]=1));break}else{if(j[X]+=$,j[X]!=cr)break;j[X--]=0,$=1}for(W=j.length;j[--W]===0;j.pop());}I.e>m?I.c=I.e=null:I.e<g&&(I.c=[I.e=0])}return I}function U(I){var O,B=I.e;return B===null?I.toString():(O=Vi(I.c),O=B<=f||B>=d?Bl(O,B):jr(O,B,"0"),I.s<0?"-"+O:O)}return n.absoluteValue=n.abs=function(){var I=new k(this);return I.s<0&&(I.s=1),I},n.comparedTo=function(I,O){return To(this,new k(I,O))},n.decimalPlaces=n.dp=function(I,O){var B,V,z,W=this;if(I!=null)return Xe(I,0,bi),O==null?O=l:Xe(O,0,8),q(new k(W),I+W.e+1,O);if(!(B=W.c))return null;if(V=((z=B.length-1)-Hi(this.e/oe))*oe,z=B[z])for(;z%10==0;z/=10,V--);return V<0&&(V=0),V},n.dividedBy=n.div=function(I,O){return t(this,new k(I,O),a,l)},n.dividedToIntegerBy=n.idiv=function(I,O){return t(this,new k(I,O),0,1)},n.exponentiatedBy=n.pow=function(I,O){var B,V,z,W,T,$,F,X,Y,j=this;if(I=new k(I),I.c&&!I.isInteger())throw Error(hi+"Exponent not an integer: "+U(I));if(O!=null&&(O=new k(O)),$=I.e>14,!j.c||!j.c[0]||j.c[0]==1&&!j.e&&j.c.length==1||!I.c||!I.c[0])return Y=new k(Math.pow(+U(j),$?I.s*(2-zl(I)):+U(I))),O?Y.mod(O):Y;if(F=I.s<0,O){if(O.c?!O.c[0]:!O.s)return new k(NaN);V=!F&&j.isInteger()&&O.isInteger(),V&&(j=j.mod(O))}else{if(I.e>9&&(j.e>0||j.e<-1||(j.e==0?j.c[0]>1||$&&j.c[1]>=24e7:j.c[0]<8e13||$&&j.c[0]<=9999975e7)))return W=j.s<0&&zl(I)?-0:0,j.e>-1&&(W=1/W),new k(F?1/W:W);w&&(W=Dc(w/oe+2))}for($?(B=new k(.5),F&&(I.s=1),X=zl(I)):(z=Math.abs(+U(I)),X=z%2),Y=new k(s);;){if(X){if(Y=Y.times(j),!Y.c)break;W?Y.c.length>W&&(Y.c.length=W):V&&(Y=Y.mod(O))}if(z){if(z=Zi(z/2),z===0)break;X=z%2}else if(I=I.times(B),q(I,I.e+1,1),I.e>14)X=zl(I);else{if(z=+U(I),z===0)break;X=z%2}j=j.times(j),W?j.c&&j.c.length>W&&(j.c.length=W):V&&(j=j.mod(O))}return V?Y:(F&&(Y=s.div(Y)),O?Y.mod(O):W?q(Y,w,l,T):Y)},n.integerValue=function(I){var O=new k(this);return I==null?I=l:Xe(I,0,8),q(O,O.e+1,I)},n.isEqualTo=n.eq=function(I,O){return To(this,new k(I,O))===0},n.isFinite=function(){return!!this.c},n.isGreaterThan=n.gt=function(I,O){return To(this,new k(I,O))>0},n.isGreaterThanOrEqualTo=n.gte=function(I,O){return(O=To(this,new k(I,O)))===1||O===0},n.isInteger=function(){return!!this.c&&Hi(this.e/oe)>this.c.length-2},n.isLessThan=n.lt=function(I,O){return To(this,new k(I,O))<0},n.isLessThanOrEqualTo=n.lte=function(I,O){return(O=To(this,new k(I,O)))===-1||O===0},n.isNaN=function(){return!this.s},n.isNegative=function(){return this.s<0},n.isPositive=function(){return this.s>0},n.isZero=function(){return!!this.c&&this.c[0]==0},n.minus=function(I,O){var B,V,z,W,T=this,$=T.s;if(I=new k(I,O),O=I.s,!$||!O)return new k(NaN);if($!=O)return I.s=-O,T.plus(I);var F=T.e/oe,X=I.e/oe,Y=T.c,j=I.c;if(!F||!X){if(!Y||!j)return Y?(I.s=-O,I):new k(j?T:NaN);if(!Y[0]||!j[0])return j[0]?(I.s=-O,I):new k(Y[0]?T:l==3?-0:0)}if(F=Hi(F),X=Hi(X),Y=Y.slice(),$=F-X){for((W=$<0)?($=-$,z=Y):(X=F,z=j),z.reverse(),O=$;O--;z.push(0));z.reverse()}else for(V=(W=($=Y.length)<(O=j.length))?$:O,$=O=0;O<V;O++)if(Y[O]!=j[O]){W=Y[O]<j[O];break}if(W&&(z=Y,Y=j,j=z,I.s=-I.s),O=(V=j.length)-(B=Y.length),O>0)for(;O--;Y[B++]=0);for(O=cr-1;V>$;){if(Y[--V]<j[V]){for(B=V;B&&!Y[--B];Y[B]=O);--Y[B],Y[V]+=cr}Y[V]-=j[V]}for(;Y[0]==0;Y.splice(0,1),--X);return Y[0]?P(I,Y,X):(I.s=l==3?-1:1,I.c=[I.e=0],I)},n.modulo=n.mod=function(I,O){var B,V,z=this;return I=new k(I,O),!z.c||!I.s||I.c&&!I.c[0]?new k(NaN):!I.c||z.c&&!z.c[0]?new k(z):(_==9?(V=I.s,I.s=1,B=t(z,I,0,3),I.s=V,B.s*=V):B=t(z,I,0,_),I=z.minus(B.times(I)),!I.c[0]&&_==1&&(I.s=z.s),I)},n.multipliedBy=n.times=function(I,O){var B,V,z,W,T,$,F,X,Y,j,J,K,et,ft,lt,ut=this,mt=ut.c,Et=(I=new k(I,O)).c;if(!mt||!Et||!mt[0]||!Et[0])return!ut.s||!I.s||mt&&!mt[0]&&!Et||Et&&!Et[0]&&!mt?I.c=I.e=I.s=null:(I.s*=ut.s,!mt||!Et?I.c=I.e=null:(I.c=[0],I.e=0)),I;for(V=Hi(ut.e/oe)+Hi(I.e/oe),I.s*=ut.s,F=mt.length,j=Et.length,F<j&&(et=mt,mt=Et,Et=et,z=F,F=j,j=z),z=F+j,et=[];z--;et.push(0));for(ft=cr,lt=Fs,z=j;--z>=0;){for(B=0,J=Et[z]%lt,K=Et[z]/lt|0,T=F,W=z+T;W>z;)X=mt[--T]%lt,Y=mt[T]/lt|0,$=K*X+Y*J,X=J*X+$%lt*lt+et[W]+B,B=(X/ft|0)+($/lt|0)+K*Y,et[W--]=X%ft;et[W]=B}return B?++V:et.splice(0,1),P(I,et,V)},n.negated=function(){var I=new k(this);return I.s=-I.s||null,I},n.plus=function(I,O){var B,V=this,z=V.s;if(I=new k(I,O),O=I.s,!z||!O)return new k(NaN);if(z!=O)return I.s=-O,V.minus(I);var W=V.e/oe,T=I.e/oe,$=V.c,F=I.c;if(!W||!T){if(!$||!F)return new k(z/0);if(!$[0]||!F[0])return F[0]?I:new k($[0]?V:z*0)}if(W=Hi(W),T=Hi(T),$=$.slice(),z=W-T){for(z>0?(T=W,B=F):(z=-z,B=$),B.reverse();z--;B.push(0));B.reverse()}for(z=$.length,O=F.length,z-O<0&&(B=F,F=$,$=B,O=z),z=0;O;)z=($[--O]=$[O]+F[O]+z)/cr|0,$[O]=cr===$[O]?0:$[O]%cr;return z&&($=[z].concat($),++T),P(I,$,T)},n.precision=n.sd=function(I,O){var B,V,z,W=this;if(I!=null&&I!==!!I)return Xe(I,1,bi),O==null?O=l:Xe(O,0,8),q(new k(W),I,O);if(!(B=W.c))return null;if(z=B.length-1,V=z*oe+1,z=B[z]){for(;z%10==0;z/=10,V--);for(z=B[0];z>=10;z/=10,V++);}return I&&W.e+1>V&&(V=W.e+1),V},n.shiftedBy=function(I){return Xe(I,-9007199254740991,Pg),this.times("1e"+I)},n.squareRoot=n.sqrt=function(){var I,O,B,V,z,W=this,T=W.c,$=W.s,F=W.e,X=a+4,Y=new k("0.5");if($!==1||!T||!T[0])return new k(!$||$<0&&(!T||T[0])?NaN:T?W:1/0);if($=Math.sqrt(+U(W)),$==0||$==1/0?(O=Vi(T),(O.length+F)%2==0&&(O+="0"),$=Math.sqrt(+O),F=Hi((F+1)/2)-(F<0||F%2),$==1/0?O="5e"+F:(O=$.toExponential(),O=O.slice(0,O.indexOf("e")+1)+F),B=new k(O)):B=new k($+""),B.c[0]){for(F=B.e,$=F+X,$<3&&($=0);;)if(z=B,B=Y.times(z.plus(t(W,z,X,1))),Vi(z.c).slice(0,$)===(O=Vi(B.c)).slice(0,$))if(B.e<F&&--$,O=O.slice($-3,$+1),O=="9999"||!V&&O=="4999"){if(!V&&(q(z,z.e+a+2,0),z.times(z).eq(W))){B=z;break}X+=4,$+=4,V=1}else{(!+O||!+O.slice(1)&&O.charAt(0)=="5")&&(q(B,B.e+a+2,1),I=!B.times(B).eq(W));break}}return q(B,B.e+a+1,l,I)},n.toExponential=function(I,O){return I!=null&&(Xe(I,0,bi),I++),C(this,I,O,1)},n.toFixed=function(I,O){return I!=null&&(Xe(I,0,bi),I=I+this.e+1),C(this,I,O)},n.toFormat=function(I,O,B){var V,z=this;if(B==null)I!=null&&O&&typeof O=="object"?(B=O,O=null):I&&typeof I=="object"?(B=I,I=O=null):B=b;else if(typeof B!="object")throw Error(hi+"Argument not an object: "+B);if(V=z.toFixed(I,O),z.c){var W,T=V.split("."),$=+B.groupSize,F=+B.secondaryGroupSize,X=B.groupSeparator||"",Y=T[0],j=T[1],J=z.s<0,K=J?Y.slice(1):Y,et=K.length;if(F&&(W=$,$=F,F=W,et-=W),$>0&&et>0){for(W=et%$||$,Y=K.substr(0,W);W<et;W+=$)Y+=X+K.substr(W,$);F>0&&(Y+=X+K.slice(W)),J&&(Y="-"+Y)}V=j?Y+(B.decimalSeparator||"")+((F=+B.fractionGroupSize)?j.replace(new RegExp("\\d{"+F+"}\\B","g"),"$&"+(B.fractionGroupSeparator||"")):j):Y}return(B.prefix||"")+V+(B.suffix||"")},n.toFraction=function(I){var O,B,V,z,W,T,$,F,X,Y,j,J,K=this,et=K.c;if(I!=null&&($=new k(I),!$.isInteger()&&($.c||$.s!==1)||$.lt(s)))throw Error(hi+"Argument "+($.isInteger()?"out of range: ":"not an integer: ")+U($));if(!et)return new k(K);for(O=new k(s),X=B=new k(s),V=F=new k(s),J=Vi(et),W=O.e=J.length-K.e-1,O.c[0]=zc[(T=W%oe)<0?oe+T:T],I=!I||$.comparedTo(O)>0?W>0?O:X:$,T=m,m=1/0,$=new k(J),F.c[0]=0;Y=t($,O,0,1),z=B.plus(Y.times(V)),z.comparedTo(I)!=1;)B=V,V=z,X=F.plus(Y.times(z=X)),F=z,O=$.minus(Y.times(z=O)),$=z;return z=t(I.minus(B),V,0,1),F=F.plus(z.times(X)),B=B.plus(z.times(V)),F.s=X.s=K.s,W=W*2,j=t(X,V,W,l).minus(K).abs().comparedTo(t(F,B,W,l).minus(K).abs())<1?[X,V]:[F,B],m=T,j},n.toNumber=function(){return+U(this)},n.toPrecision=function(I,O){return I!=null&&Xe(I,1,bi),C(this,I,O,2)},n.toString=function(I){var O,B=this,V=B.s,z=B.e;return z===null?V?(O="Infinity",V<0&&(O="-"+O)):O="NaN":(I==null?O=z<=f||z>=d?Bl(Vi(B.c),z):jr(Vi(B.c),z,"0"):I===10&&N?(B=q(new k(B),a+z+1,l),O=jr(Vi(B.c),B.e,"0")):(Xe(I,2,S.length,"Base"),O=e(jr(Vi(B.c),z,"0"),10,I,V,!0)),V<0&&B.c[0]&&(O="-"+O)),O},n.valueOf=n.toJSON=function(){return U(this)},n._isBigNumber=!0,n[Symbol.toStringTag]="BigNumber",n[Symbol.for("nodejs.util.inspect.custom")]=n.valueOf,r!=null&&k.set(r),k}function Hi(r){var t=r|0;return r>0||r===t?t:t-1}function Vi(r){for(var t,e,i=1,n=r.length,s=r[0]+"";i<n;){for(t=r[i++]+"",e=oe-t.length;e--;t="0"+t);s+=t}for(n=s.length;s.charCodeAt(--n)===48;);return s.slice(0,n+1||1)}function To(r,t){var e,i,n=r.c,s=t.c,a=r.s,l=t.s,f=r.e,d=t.e;if(!a||!l)return null;if(e=n&&!n[0],i=s&&!s[0],e||i)return e?i?0:-l:a;if(a!=l)return a;if(e=a<0,i=f==d,!n||!s)return i?0:!n^e?1:-1;if(!i)return f>d^e?1:-1;for(l=(f=n.length)<(d=s.length)?f:d,a=0;a<l;a++)if(n[a]!=s[a])return n[a]>s[a]^e?1:-1;return f==d?0:f>d^e?1:-1}function Xe(r,t,e,i){if(r<t||r>e||r!==Zi(r))throw Error(hi+(i||"Argument")+(typeof r=="number"?r<t||r>e?" out of range: ":" not an integer: ":" not a primitive number: ")+String(r))}function zl(r){var t=r.c.length-1;return Hi(r.e/oe)==t&&r.c[t]%2!=0}function Bl(r,t){return(r.length>1?r.charAt(0)+"."+r.slice(1):r)+(t<0?"e":"e+")+t}function jr(r,t,e){var i,n;if(t<0){for(n=e+".";++t;n+=e);r=n+r}else if(i=r.length,++t>i){for(n=e,t-=i;--t;n+=e);r+=n}else t<i&&(r=r.slice(0,t)+"."+r.slice(t));return r}var Ir=H_(),kE=class{constructor(r){Wt(this,"key");Wt(this,"left",null);Wt(this,"right",null);this.key=r}},fu=class extends kE{constructor(r){super(r)}},ME=class{constructor(){Wt(this,"size",0);Wt(this,"modificationCount",0);Wt(this,"splayCount",0)}splay(r){const t=this.root;if(t==null)return this.compare(r,r),-1;let e=null,i=null,n=null,s=null,a=t;const l=this.compare;let f;for(;;)if(f=l(a.key,r),f>0){let d=a.left;if(d==null||(f=l(d.key,r),f>0&&(a.left=d.right,d.right=a,a=d,d=a.left,d==null)))break;e==null?i=a:e.left=a,e=a,a=d}else if(f<0){let d=a.right;if(d==null||(f=l(d.key,r),f<0&&(a.right=d.left,d.left=a,a=d,d=a.right,d==null)))break;n==null?s=a:n.right=a,n=a,a=d}else break;return n!=null&&(n.right=a.left,a.left=s),e!=null&&(e.left=a.right,a.right=i),this.root!==a&&(this.root=a,this.splayCount++),f}splayMin(r){let t=r,e=t.left;for(;e!=null;){const i=e;t.left=i.right,i.right=t,t=i,e=t.left}return t}splayMax(r){let t=r,e=t.right;for(;e!=null;){const i=e;t.right=i.left,i.left=t,t=i,e=t.right}return t}_delete(r){if(this.root==null||this.splay(r)!=0)return null;let e=this.root;const i=e,n=e.left;if(this.size--,n==null)this.root=e.right;else{const s=e.right;e=this.splayMax(n),e.right=s,this.root=e}return this.modificationCount++,i}addNewRoot(r,t){this.size++,this.modificationCount++;const e=this.root;if(e==null){this.root=r;return}t<0?(r.left=e,r.right=e.right,e.right=null):(r.right=e,r.left=e.left,e.left=null),this.root=r}_first(){const r=this.root;return r==null?null:(this.root=this.splayMin(r),this.root)}_last(){const r=this.root;return r==null?null:(this.root=this.splayMax(r),this.root)}clear(){this.root=null,this.size=0,this.modificationCount++}has(r){return this.validKey(r)&&this.splay(r)==0}defaultCompare(){return(r,t)=>r<t?-1:r>t?1:0}wrap(){return{getRoot:()=>this.root,setRoot:r=>{this.root=r},getSize:()=>this.size,getModificationCount:()=>this.modificationCount,getSplayCount:()=>this.splayCount,setSplayCount:r=>{this.splayCount=r},splay:r=>this.splay(r),has:r=>this.has(r)}}},hy,cy,Rh=class Iu extends ME{constructor(e,i){super();Wt(this,"root",null);Wt(this,"compare");Wt(this,"validKey");Wt(this,hy,"[object Set]");this.compare=e??this.defaultCompare(),this.validKey=i??(n=>n!=null&&n!=null)}delete(e){return this.validKey(e)?this._delete(e)!=null:!1}deleteAll(e){for(const i of e)this.delete(i)}forEach(e){const i=this[Symbol.iterator]();let n;for(;n=i.next(),!n.done;)e(n.value,n.value,this)}add(e){const i=this.splay(e);return i!=0&&this.addNewRoot(new fu(e),i),this}addAndReturn(e){const i=this.splay(e);return i!=0&&this.addNewRoot(new fu(e),i),this.root.key}addAll(e){for(const i of e)this.add(i)}isEmpty(){return this.root==null}isNotEmpty(){return this.root!=null}single(){if(this.size==0)throw"Bad state: No element";if(this.size>1)throw"Bad state: Too many element";return this.root.key}first(){if(this.size==0)throw"Bad state: No element";return this._first().key}last(){if(this.size==0)throw"Bad state: No element";return this._last().key}lastBefore(e){if(e==null)throw"Invalid arguments(s)";if(this.root==null)return null;if(this.splay(e)<0)return this.root.key;let n=this.root.left;if(n==null)return null;let s=n.right;for(;s!=null;)n=s,s=n.right;return n.key}firstAfter(e){if(e==null)throw"Invalid arguments(s)";if(this.root==null)return null;if(this.splay(e)>0)return this.root.key;let n=this.root.right;if(n==null)return null;let s=n.left;for(;s!=null;)n=s,s=n.left;return n.key}retainAll(e){const i=new Iu(this.compare,this.validKey),n=this.modificationCount;for(const s of e){if(n!=this.modificationCount)throw"Concurrent modification during iteration.";this.validKey(s)&&this.splay(s)==0&&i.add(this.root.key)}i.size!=this.size&&(this.root=i.root,this.size=i.size,this.modificationCount++)}lookup(e){return!this.validKey(e)||this.splay(e)!=0?null:this.root.key}intersection(e){const i=new Iu(this.compare,this.validKey);for(const n of this)e.has(n)&&i.add(n);return i}difference(e){const i=new Iu(this.compare,this.validKey);for(const n of this)e.has(n)||i.add(n);return i}union(e){const i=this.clone();return i.addAll(e),i}clone(){const e=new Iu(this.compare,this.validKey);return e.size=this.size,e.root=this.copyNode(this.root),e}copyNode(e){if(e==null)return null;function i(s,a){let l,f;do{if(l=s.left,f=s.right,l!=null){const d=new fu(l.key);a.left=d,i(l,d)}if(f!=null){const d=new fu(f.key);a.right=d,s=f,a=d}}while(f!=null)}const n=new fu(e.key);return i(e,n),n}toSet(){return this.clone()}entries(){return new SE(this.wrap())}keys(){return this[Symbol.iterator]()}values(){return this[Symbol.iterator]()}[(cy=Symbol.iterator,hy=Symbol.toStringTag,cy)](){return new LE(this.wrap())}},Y_=class{constructor(r){Wt(this,"tree");Wt(this,"path",new Array);Wt(this,"modificationCount",null);Wt(this,"splayCount");this.tree=r,this.splayCount=r.getSplayCount()}[Symbol.iterator](){return this}next(){return this.moveNext()?{done:!1,value:this.current()}:{done:!0,value:null}}current(){if(!this.path.length)return null;const r=this.path[this.path.length-1];return this.getValue(r)}rebuildPath(r){this.path.splice(0,this.path.length),this.tree.splay(r),this.path.push(this.tree.getRoot()),this.splayCount=this.tree.getSplayCount()}findLeftMostDescendent(r){for(;r!=null;)this.path.push(r),r=r.left}moveNext(){if(this.modificationCount!=this.tree.getModificationCount()){if(this.modificationCount==null){this.modificationCount=this.tree.getModificationCount();let e=this.tree.getRoot();for(;e!=null;)this.path.push(e),e=e.left;return this.path.length>0}throw"Concurrent modification during iteration."}if(!this.path.length)return!1;this.splayCount!=this.tree.getSplayCount()&&this.rebuildPath(this.path[this.path.length-1].key);let r=this.path[this.path.length-1],t=r.right;if(t!=null){for(;t!=null;)this.path.push(t),t=t.left;return!0}for(this.path.pop();this.path.length&&this.path[this.path.length-1].right===r;)r=this.path.pop();return this.path.length>0}},LE=class extends Y_{getValue(r){return r.key}},SE=class extends Y_{getValue(r){return[r.key,r.key]}},X_=r=>()=>r,Of=r=>{const t=r?(e,i)=>i.minus(e).abs().isLessThanOrEqualTo(r):X_(!1);return(e,i)=>t(e,i)?0:e.comparedTo(i)};function TE(r){const t=r?(e,i,n,s,a)=>e.exponentiatedBy(2).isLessThanOrEqualTo(s.minus(i).exponentiatedBy(2).plus(a.minus(n).exponentiatedBy(2)).times(r)):X_(!1);return(e,i,n)=>{const s=e.x,a=e.y,l=n.x,f=n.y,d=a.minus(f).times(i.x.minus(l)).minus(s.minus(l).times(i.y.minus(f)));return t(d,s,a,l,f)?0:d.comparedTo(0)}}var PE=r=>r,IE=r=>{if(r){const t=new Rh(Of(r)),e=new Rh(Of(r)),i=(s,a)=>a.addAndReturn(s),n=s=>({x:i(s.x,t),y:i(s.y,e)});return n({x:new Ir(0),y:new Ir(0)}),n}return PE},Rf=r=>({set:t=>{ds=Rf(t)},reset:()=>Rf(r),compare:Of(r),snap:IE(r),orient:TE(r)}),ds=Rf(),du=(r,t)=>r.ll.x.isLessThanOrEqualTo(t.x)&&t.x.isLessThanOrEqualTo(r.ur.x)&&r.ll.y.isLessThanOrEqualTo(t.y)&&t.y.isLessThanOrEqualTo(r.ur.y),Df=(r,t)=>{if(t.ur.x.isLessThan(r.ll.x)||r.ur.x.isLessThan(t.ll.x)||t.ur.y.isLessThan(r.ll.y)||r.ur.y.isLessThan(t.ll.y))return null;const e=r.ll.x.isLessThan(t.ll.x)?t.ll.x:r.ll.x,i=r.ur.x.isLessThan(t.ur.x)?r.ur.x:t.ur.x,n=r.ll.y.isLessThan(t.ll.y)?t.ll.y:r.ll.y,s=r.ur.y.isLessThan(t.ur.y)?r.ur.y:t.ur.y;return{ll:{x:e,y:n},ur:{x:i,y:s}}},gh=(r,t)=>r.x.times(t.y).minus(r.y.times(t.x)),W_=(r,t)=>r.x.times(t.x).plus(r.y.times(t.y)),Dh=r=>W_(r,r).sqrt(),CE=(r,t,e)=>{const i={x:t.x.minus(r.x),y:t.y.minus(r.y)},n={x:e.x.minus(r.x),y:e.y.minus(r.y)};return gh(n,i).div(Dh(n)).div(Dh(i))},AE=(r,t,e)=>{const i={x:t.x.minus(r.x),y:t.y.minus(r.y)},n={x:e.x.minus(r.x),y:e.y.minus(r.y)};return W_(n,i).div(Dh(n)).div(Dh(i))},Ig=(r,t,e)=>t.y.isZero()?null:{x:r.x.plus(t.x.div(t.y).times(e.minus(r.y))),y:e},Cg=(r,t,e)=>t.x.isZero()?null:{x:e,y:r.y.plus(t.y.div(t.x).times(e.minus(r.x)))},NE=(r,t,e,i)=>{if(t.x.isZero())return Cg(e,i,r.x);if(i.x.isZero())return Cg(r,t,e.x);if(t.y.isZero())return Ig(e,i,r.y);if(i.y.isZero())return Ig(r,t,e.y);const n=gh(t,i);if(n.isZero())return null;const s={x:e.x.minus(r.x),y:e.y.minus(r.y)},a=gh(s,t).div(n),l=gh(s,i).div(n),f=r.x.plus(l.times(t.x)),d=e.x.plus(a.times(i.x)),g=r.y.plus(l.times(t.y)),m=e.y.plus(a.times(i.y)),v=f.plus(d).div(2),_=g.plus(m).div(2);return{x:v,y:_}},Tr=class $_{constructor(t,e){Wt(this,"point");Wt(this,"isLeft");Wt(this,"segment");Wt(this,"otherSE");Wt(this,"consumedBy");t.events===void 0?t.events=[this]:t.events.push(this),this.point=t,this.isLeft=e}static compare(t,e){const i=$_.comparePoints(t.point,e.point);return i!==0?i:(t.point!==e.point&&t.link(e),t.isLeft!==e.isLeft?t.isLeft?1:-1:zh.compare(t.segment,e.segment))}static comparePoints(t,e){return t.x.isLessThan(e.x)?-1:t.x.isGreaterThan(e.x)?1:t.y.isLessThan(e.y)?-1:t.y.isGreaterThan(e.y)?1:0}link(t){if(t.point===this.point)throw new Error("Tried to link already linked events");const e=t.point.events;for(let i=0,n=e.length;i<n;i++){const s=e[i];this.point.events.push(s),s.point=this.point}this.checkForConsuming()}checkForConsuming(){const t=this.point.events.length;for(let e=0;e<t;e++){const i=this.point.events[e];if(i.segment.consumedBy===void 0)for(let n=e+1;n<t;n++){const s=this.point.events[n];s.consumedBy===void 0&&i.otherSE.point.events===s.otherSE.point.events&&i.segment.consume(s.segment)}}}getAvailableLinkedEvents(){const t=[];for(let e=0,i=this.point.events.length;e<i;e++){const n=this.point.events[e];n!==this&&!n.segment.ringOut&&n.segment.isInResult()&&t.push(n)}return t}getLeftmostComparator(t){const e=new Map,i=n=>{const s=n.otherSE;e.set(n,{sine:CE(this.point,t.point,s.point),cosine:AE(this.point,t.point,s.point)})};return(n,s)=>{e.has(n)||i(n),e.has(s)||i(s);const{sine:a,cosine:l}=e.get(n),{sine:f,cosine:d}=e.get(s);return a.isGreaterThanOrEqualTo(0)&&f.isGreaterThanOrEqualTo(0)?l.isLessThan(d)?1:l.isGreaterThan(d)?-1:0:a.isLessThan(0)&&f.isLessThan(0)?l.isLessThan(d)?-1:l.isGreaterThan(d)?1:0:f.isLessThan(a)?-1:f.isGreaterThan(a)?1:0}}},OE=class zf{constructor(t){Wt(this,"events");Wt(this,"poly");Wt(this,"_isExteriorRing");Wt(this,"_enclosingRing");this.events=t;for(let e=0,i=t.length;e<i;e++)t[e].segment.ringOut=this;this.poly=null}static factory(t){const e=[];for(let i=0,n=t.length;i<n;i++){const s=t[i];if(!s.isInResult()||s.ringOut)continue;let a=null,l=s.leftSE,f=s.rightSE;const d=[l],g=l.point,m=[];for(;a=l,l=f,d.push(l),l.point!==g;)for(;;){const v=l.getAvailableLinkedEvents();if(v.length===0){const b=d[0].point,S=d[d.length-1].point;throw new Error(`Unable to complete output ring starting at [${b.x}, ${b.y}]. Last matching segment found ends at [${S.x}, ${S.y}].`)}if(v.length===1){f=v[0].otherSE;break}let _=null;for(let b=0,S=m.length;b<S;b++)if(m[b].point===l.point){_=b;break}if(_!==null){const b=m.splice(_)[0],S=d.splice(b.index);S.unshift(S[0].otherSE),e.push(new zf(S.reverse()));continue}m.push({index:d.length,point:l.point});const w=l.getLeftmostComparator(a);f=v.sort(w)[0].otherSE;break}e.push(new zf(d))}return e}getGeom(){let t=this.events[0].point;const e=[t];for(let d=1,g=this.events.length-1;d<g;d++){const m=this.events[d].point,v=this.events[d+1].point;ds.orient(m,t,v)!==0&&(e.push(m),t=m)}if(e.length===1)return null;const i=e[0],n=e[1];ds.orient(i,t,n)===0&&e.shift(),e.push(e[0]);const s=this.isExteriorRing()?1:-1,a=this.isExteriorRing()?0:e.length-1,l=this.isExteriorRing()?e.length:-1,f=[];for(let d=a;d!=l;d+=s)f.push([e[d].x.toNumber(),e[d].y.toNumber()]);return f}isExteriorRing(){if(this._isExteriorRing===void 0){const t=this.enclosingRing();this._isExteriorRing=t?!t.isExteriorRing():!0}return this._isExteriorRing}enclosingRing(){return this._enclosingRing===void 0&&(this._enclosingRing=this._calcEnclosingRing()),this._enclosingRing}_calcEnclosingRing(){var n,s;let t=this.events[0];for(let a=1,l=this.events.length;a<l;a++){const f=this.events[a];Tr.compare(t,f)>0&&(t=f)}let e=t.segment.prevInResult(),i=e?e.prevInResult():null;for(;;){if(!e)return null;if(!i)return e.ringOut;if(i.ringOut!==e.ringOut)return((n=i.ringOut)==null?void 0:n.enclosingRing())!==e.ringOut?e.ringOut:(s=e.ringOut)==null?void 0:s.enclosingRing();e=i.prevInResult(),i=e?e.prevInResult():null}}},Ag=class{constructor(r){Wt(this,"exteriorRing");Wt(this,"interiorRings");this.exteriorRing=r,r.poly=this,this.interiorRings=[]}addInterior(r){this.interiorRings.push(r),r.poly=this}getGeom(){const r=this.exteriorRing.getGeom();if(r===null)return null;const t=[r];for(let e=0,i=this.interiorRings.length;e<i;e++){const n=this.interiorRings[e].getGeom();n!==null&&t.push(n)}return t}},RE=class{constructor(r){Wt(this,"rings");Wt(this,"polys");this.rings=r,this.polys=this._composePolys(r)}getGeom(){const r=[];for(let t=0,e=this.polys.length;t<e;t++){const i=this.polys[t].getGeom();i!==null&&r.push(i)}return r}_composePolys(r){var e;const t=[];for(let i=0,n=r.length;i<n;i++){const s=r[i];if(!s.poly)if(s.isExteriorRing())t.push(new Ag(s));else{const a=s.enclosingRing();a!=null&&a.poly||t.push(new Ag(a)),(e=a==null?void 0:a.poly)==null||e.addInterior(s)}}return t}},DE=class{constructor(r,t=zh.compare){Wt(this,"queue");Wt(this,"tree");Wt(this,"segments");this.queue=r,this.tree=new Rh(t),this.segments=[]}process(r){const t=r.segment,e=[];if(r.consumedBy)return r.isLeft?this.queue.delete(r.otherSE):this.tree.delete(t),e;r.isLeft&&this.tree.add(t);let i=t,n=t;do i=this.tree.lastBefore(i);while(i!=null&&i.consumedBy!=null);do n=this.tree.firstAfter(n);while(n!=null&&n.consumedBy!=null);if(r.isLeft){let s=null;if(i){const l=i.getIntersection(t);if(l!==null&&(t.isAnEndpoint(l)||(s=l),!i.isAnEndpoint(l))){const f=this._splitSafely(i,l);for(let d=0,g=f.length;d<g;d++)e.push(f[d])}}let a=null;if(n){const l=n.getIntersection(t);if(l!==null&&(t.isAnEndpoint(l)||(a=l),!n.isAnEndpoint(l))){const f=this._splitSafely(n,l);for(let d=0,g=f.length;d<g;d++)e.push(f[d])}}if(s!==null||a!==null){let l=null;s===null?l=a:a===null?l=s:l=Tr.comparePoints(s,a)<=0?s:a,this.queue.delete(t.rightSE),e.push(t.rightSE);const f=t.split(l);for(let d=0,g=f.length;d<g;d++)e.push(f[d])}e.length>0?(this.tree.delete(t),e.push(r)):(this.segments.push(t),t.prev=i)}else{if(i&&n){const s=i.getIntersection(n);if(s!==null){if(!i.isAnEndpoint(s)){const a=this._splitSafely(i,s);for(let l=0,f=a.length;l<f;l++)e.push(a[l])}if(!n.isAnEndpoint(s)){const a=this._splitSafely(n,s);for(let l=0,f=a.length;l<f;l++)e.push(a[l])}}}this.tree.delete(t)}return e}_splitSafely(r,t){this.tree.delete(r);const e=r.rightSE;this.queue.delete(e);const i=r.split(t);return i.push(e),r.consumedBy===void 0&&this.tree.add(r),i}},zE=class{constructor(){Wt(this,"type");Wt(this,"numMultiPolys")}run(r,t,e){Cu.type=r;const i=[new Og(t,!0)];for(let d=0,g=e.length;d<g;d++)i.push(new Og(e[d],!1));if(Cu.numMultiPolys=i.length,Cu.type==="difference"){const d=i[0];let g=1;for(;g<i.length;)Df(i[g].bbox,d.bbox)!==null?g++:i.splice(g,1)}if(Cu.type==="intersection")for(let d=0,g=i.length;d<g;d++){const m=i[d];for(let v=d+1,_=i.length;v<_;v++)if(Df(m.bbox,i[v].bbox)===null)return[]}const n=new Rh(Tr.compare);for(let d=0,g=i.length;d<g;d++){const m=i[d].getSweepEvents();for(let v=0,_=m.length;v<_;v++)n.add(m[v])}const s=new DE(n);let a=null;for(n.size!=0&&(a=n.first(),n.delete(a));a;){const d=s.process(a);for(let g=0,m=d.length;g<m;g++){const v=d[g];v.consumedBy===void 0&&n.add(v)}n.size!=0?(a=n.first(),n.delete(a)):a=null}ds.reset();const l=OE.factory(s.segments);return new RE(l).getGeom()}},Cu=new zE,Za=Cu,BE=0,zh=class mh{constructor(t,e,i,n){Wt(this,"id");Wt(this,"leftSE");Wt(this,"rightSE");Wt(this,"rings");Wt(this,"windings");Wt(this,"ringOut");Wt(this,"consumedBy");Wt(this,"prev");Wt(this,"_prevInResult");Wt(this,"_beforeState");Wt(this,"_afterState");Wt(this,"_isInResult");this.id=++BE,this.leftSE=t,t.segment=this,t.otherSE=e,this.rightSE=e,e.segment=this,e.otherSE=t,this.rings=i,this.windings=n}static compare(t,e){const i=t.leftSE.point.x,n=e.leftSE.point.x,s=t.rightSE.point.x,a=e.rightSE.point.x;if(a.isLessThan(i))return 1;if(s.isLessThan(n))return-1;const l=t.leftSE.point.y,f=e.leftSE.point.y,d=t.rightSE.point.y,g=e.rightSE.point.y;if(i.isLessThan(n)){if(f.isLessThan(l)&&f.isLessThan(d))return 1;if(f.isGreaterThan(l)&&f.isGreaterThan(d))return-1;const m=t.comparePoint(e.leftSE.point);if(m<0)return 1;if(m>0)return-1;const v=e.comparePoint(t.rightSE.point);return v!==0?v:-1}if(i.isGreaterThan(n)){if(l.isLessThan(f)&&l.isLessThan(g))return-1;if(l.isGreaterThan(f)&&l.isGreaterThan(g))return 1;const m=e.comparePoint(t.leftSE.point);if(m!==0)return m;const v=t.comparePoint(e.rightSE.point);return v<0?1:v>0?-1:1}if(l.isLessThan(f))return-1;if(l.isGreaterThan(f))return 1;if(s.isLessThan(a)){const m=e.comparePoint(t.rightSE.point);if(m!==0)return m}if(s.isGreaterThan(a)){const m=t.comparePoint(e.rightSE.point);if(m<0)return 1;if(m>0)return-1}if(!s.eq(a)){const m=d.minus(l),v=s.minus(i),_=g.minus(f),w=a.minus(n);if(m.isGreaterThan(v)&&_.isLessThan(w))return 1;if(m.isLessThan(v)&&_.isGreaterThan(w))return-1}return s.isGreaterThan(a)?1:s.isLessThan(a)||d.isLessThan(g)?-1:d.isGreaterThan(g)?1:t.id<e.id?-1:t.id>e.id?1:0}static fromRing(t,e,i){let n,s,a;const l=Tr.comparePoints(t,e);if(l<0)n=t,s=e,a=1;else if(l>0)n=e,s=t,a=-1;else throw new Error(`Tried to create degenerate segment at [${t.x}, ${t.y}]`);const f=new Tr(n,!0),d=new Tr(s,!1);return new mh(f,d,[i],[a])}replaceRightSE(t){this.rightSE=t,this.rightSE.segment=this,this.rightSE.otherSE=this.leftSE,this.leftSE.otherSE=this.rightSE}bbox(){const t=this.leftSE.point.y,e=this.rightSE.point.y;return{ll:{x:this.leftSE.point.x,y:t.isLessThan(e)?t:e},ur:{x:this.rightSE.point.x,y:t.isGreaterThan(e)?t:e}}}vector(){return{x:this.rightSE.point.x.minus(this.leftSE.point.x),y:this.rightSE.point.y.minus(this.leftSE.point.y)}}isAnEndpoint(t){return t.x.eq(this.leftSE.point.x)&&t.y.eq(this.leftSE.point.y)||t.x.eq(this.rightSE.point.x)&&t.y.eq(this.rightSE.point.y)}comparePoint(t){return ds.orient(this.leftSE.point,t,this.rightSE.point)}getIntersection(t){const e=this.bbox(),i=t.bbox(),n=Df(e,i);if(n===null)return null;const s=this.leftSE.point,a=this.rightSE.point,l=t.leftSE.point,f=t.rightSE.point,d=du(e,l)&&this.comparePoint(l)===0,g=du(i,s)&&t.comparePoint(s)===0,m=du(e,f)&&this.comparePoint(f)===0,v=du(i,a)&&t.comparePoint(a)===0;if(g&&d)return v&&!m?a:!v&&m?f:null;if(g)return m&&s.x.eq(f.x)&&s.y.eq(f.y)?null:s;if(d)return v&&a.x.eq(l.x)&&a.y.eq(l.y)?null:l;if(v&&m)return null;if(v)return a;if(m)return f;const _=NE(s,this.vector(),l,t.vector());return _===null||!du(n,_)?null:ds.snap(_)}split(t){const e=[],i=t.events!==void 0,n=new Tr(t,!0),s=new Tr(t,!1),a=this.rightSE;this.replaceRightSE(s),e.push(s),e.push(n);const l=new mh(n,a,this.rings.slice(),this.windings.slice());return Tr.comparePoints(l.leftSE.point,l.rightSE.point)>0&&l.swapEvents(),Tr.comparePoints(this.leftSE.point,this.rightSE.point)>0&&this.swapEvents(),i&&(n.checkForConsuming(),s.checkForConsuming()),e}swapEvents(){const t=this.rightSE;this.rightSE=this.leftSE,this.leftSE=t,this.leftSE.isLeft=!0,this.rightSE.isLeft=!1;for(let e=0,i=this.windings.length;e<i;e++)this.windings[e]*=-1}consume(t){let e=this,i=t;for(;e.consumedBy;)e=e.consumedBy;for(;i.consumedBy;)i=i.consumedBy;const n=mh.compare(e,i);if(n!==0){if(n>0){const s=e;e=i,i=s}if(e.prev===i){const s=e;e=i,i=s}for(let s=0,a=i.rings.length;s<a;s++){const l=i.rings[s],f=i.windings[s],d=e.rings.indexOf(l);d===-1?(e.rings.push(l),e.windings.push(f)):e.windings[d]+=f}i.rings=null,i.windings=null,i.consumedBy=e,i.leftSE.consumedBy=e.leftSE,i.rightSE.consumedBy=e.rightSE}}prevInResult(){return this._prevInResult!==void 0?this._prevInResult:(this.prev?this.prev.isInResult()?this._prevInResult=this.prev:this._prevInResult=this.prev.prevInResult():this._prevInResult=null,this._prevInResult)}beforeState(){if(this._beforeState!==void 0)return this._beforeState;if(!this.prev)this._beforeState={rings:[],windings:[],multiPolys:[]};else{const t=this.prev.consumedBy||this.prev;this._beforeState=t.afterState()}return this._beforeState}afterState(){if(this._afterState!==void 0)return this._afterState;const t=this.beforeState();this._afterState={rings:t.rings.slice(0),windings:t.windings.slice(0),multiPolys:[]};const e=this._afterState.rings,i=this._afterState.windings,n=this._afterState.multiPolys;for(let l=0,f=this.rings.length;l<f;l++){const d=this.rings[l],g=this.windings[l],m=e.indexOf(d);m===-1?(e.push(d),i.push(g)):i[m]+=g}const s=[],a=[];for(let l=0,f=e.length;l<f;l++){if(i[l]===0)continue;const d=e[l],g=d.poly;if(a.indexOf(g)===-1)if(d.isExterior)s.push(g);else{a.indexOf(g)===-1&&a.push(g);const m=s.indexOf(d.poly);m!==-1&&s.splice(m,1)}}for(let l=0,f=s.length;l<f;l++){const d=s[l].multiPoly;n.indexOf(d)===-1&&n.push(d)}return this._afterState}isInResult(){if(this.consumedBy)return!1;if(this._isInResult!==void 0)return this._isInResult;const t=this.beforeState().multiPolys,e=this.afterState().multiPolys;switch(Za.type){case"union":{const i=t.length===0,n=e.length===0;this._isInResult=i!==n;break}case"intersection":{let i,n;t.length<e.length?(i=t.length,n=e.length):(i=e.length,n=t.length),this._isInResult=n===Za.numMultiPolys&&i<n;break}case"xor":{const i=Math.abs(t.length-e.length);this._isInResult=i%2===1;break}case"difference":{const i=n=>n.length===1&&n[0].isSubject;this._isInResult=i(t)!==i(e);break}}return this._isInResult}},Ng=class{constructor(r,t,e){Wt(this,"poly");Wt(this,"isExterior");Wt(this,"segments");Wt(this,"bbox");if(!Array.isArray(r)||r.length===0)throw new Error("Input geometry is not a valid Polygon or MultiPolygon");if(this.poly=t,this.isExterior=e,this.segments=[],typeof r[0][0]!="number"||typeof r[0][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");const i=ds.snap({x:new Ir(r[0][0]),y:new Ir(r[0][1])});this.bbox={ll:{x:i.x,y:i.y},ur:{x:i.x,y:i.y}};let n=i;for(let s=1,a=r.length;s<a;s++){if(typeof r[s][0]!="number"||typeof r[s][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");const l=ds.snap({x:new Ir(r[s][0]),y:new Ir(r[s][1])});l.x.eq(n.x)&&l.y.eq(n.y)||(this.segments.push(zh.fromRing(n,l,this)),l.x.isLessThan(this.bbox.ll.x)&&(this.bbox.ll.x=l.x),l.y.isLessThan(this.bbox.ll.y)&&(this.bbox.ll.y=l.y),l.x.isGreaterThan(this.bbox.ur.x)&&(this.bbox.ur.x=l.x),l.y.isGreaterThan(this.bbox.ur.y)&&(this.bbox.ur.y=l.y),n=l)}(!i.x.eq(n.x)||!i.y.eq(n.y))&&this.segments.push(zh.fromRing(n,i,this))}getSweepEvents(){const r=[];for(let t=0,e=this.segments.length;t<e;t++){const i=this.segments[t];r.push(i.leftSE),r.push(i.rightSE)}return r}},FE=class{constructor(r,t){Wt(this,"multiPoly");Wt(this,"exteriorRing");Wt(this,"interiorRings");Wt(this,"bbox");if(!Array.isArray(r))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");this.exteriorRing=new Ng(r[0],this,!0),this.bbox={ll:{x:this.exteriorRing.bbox.ll.x,y:this.exteriorRing.bbox.ll.y},ur:{x:this.exteriorRing.bbox.ur.x,y:this.exteriorRing.bbox.ur.y}},this.interiorRings=[];for(let e=1,i=r.length;e<i;e++){const n=new Ng(r[e],this,!1);n.bbox.ll.x.isLessThan(this.bbox.ll.x)&&(this.bbox.ll.x=n.bbox.ll.x),n.bbox.ll.y.isLessThan(this.bbox.ll.y)&&(this.bbox.ll.y=n.bbox.ll.y),n.bbox.ur.x.isGreaterThan(this.bbox.ur.x)&&(this.bbox.ur.x=n.bbox.ur.x),n.bbox.ur.y.isGreaterThan(this.bbox.ur.y)&&(this.bbox.ur.y=n.bbox.ur.y),this.interiorRings.push(n)}this.multiPoly=t}getSweepEvents(){const r=this.exteriorRing.getSweepEvents();for(let t=0,e=this.interiorRings.length;t<e;t++){const i=this.interiorRings[t].getSweepEvents();for(let n=0,s=i.length;n<s;n++)r.push(i[n])}return r}},Og=class{constructor(r,t){Wt(this,"isSubject");Wt(this,"polys");Wt(this,"bbox");if(!Array.isArray(r))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");try{typeof r[0][0][0]=="number"&&(r=[r])}catch{}this.polys=[],this.bbox={ll:{x:new Ir(Number.POSITIVE_INFINITY),y:new Ir(Number.POSITIVE_INFINITY)},ur:{x:new Ir(Number.NEGATIVE_INFINITY),y:new Ir(Number.NEGATIVE_INFINITY)}};for(let e=0,i=r.length;e<i;e++){const n=new FE(r[e],this);n.bbox.ll.x.isLessThan(this.bbox.ll.x)&&(this.bbox.ll.x=n.bbox.ll.x),n.bbox.ll.y.isLessThan(this.bbox.ll.y)&&(this.bbox.ll.y=n.bbox.ll.y),n.bbox.ur.x.isGreaterThan(this.bbox.ur.x)&&(this.bbox.ur.x=n.bbox.ur.x),n.bbox.ur.y.isGreaterThan(this.bbox.ur.y)&&(this.bbox.ur.y=n.bbox.ur.y),this.polys.push(n)}this.isSubject=t}getSweepEvents(){const r=[];for(let t=0,e=this.polys.length;t<e;t++){const i=this.polys[t].getSweepEvents();for(let n=0,s=i.length;n<s;n++)r.push(i[n])}return r}},Ks=(r,...t)=>Za.run("union",r,t),J_=(r,...t)=>Za.run("intersection",r,t),UE=(r,...t)=>Za.run("xor",r,t),j_=(r,...t)=>Za.run("difference",r,t),GE=ds.set;const VE=Object.freeze(Object.defineProperty({__proto__:null,difference:j_,intersection:J_,setPrecision:GE,union:Ks,xor:UE},Symbol.toStringTag,{value:"Module"}));function qE(r){const t=[];if(Rn(r,n=>{t.push(n.coordinates)}),t.length<2)throw new Error("Must have at least two features");const e=r.features[0].properties||{},i=j_(t[0],...t.slice(1));return i.length===0?null:i.length===1?$t(i[0],e):pi(i,e)}function Bf(r){if(!r)throw new Error("geojson is required");var t=[];return vn(r,function(e){t.push(e)}),Yt(t)}function ZE(r,t={}){if(t=t||{},!ve(t))throw new Error("options is invalid");const{propertyName:e}=t;gs(r,"Polygon","dissolve");const i=[];if(e){const n={};ye(r,function(a){a.properties&&(Object.prototype.hasOwnProperty.call(n,a.properties[e])||(n[a.properties[e]]=[]),n[a.properties[e]].push(a))});const s=Object.keys(n);for(let a=0;a<s.length;a++){const l=pi(Ks.apply(null,n[s[a]].map(function(f){return f.geometry.coordinates})));l.properties&&(l.properties[e]=s[a],i.push(l))}}else return Bf(pi(Ks.apply(null,r.features.map(function(n){return n.geometry.coordinates}))));return Bf(Yt(i))}function HE(r,t,e=2){const i=me(r),n=me(t),s=i[0]-n[0],a=i[1]-n[1];return e===1?Math.abs(s)+Math.abs(a):Math.pow(Math.pow(s,e)+Math.pow(a,e),1/e)}function K_(r,t){var e,i;t=t||{};const n=t.threshold||1e4,s=t.p||2,a=(e=t.binary)!=null?e:!1,l=t.alpha||-1,f=(i=t.standardization)!=null?i:!1,d=[];ye(r,m=>{d.push(Dr(m))});const g=[];for(let m=0;m<d.length;m++)g[m]=[];for(let m=0;m<d.length;m++)for(let v=m;v<d.length;v++){m===v&&(g[m][v]=0);const _=HE(d[m],d[v],s);g[m][v]=_,g[v][m]=_}for(let m=0;m<d.length;m++)for(let v=0;v<d.length;v++){const _=g[m][v];_!==0&&(a?_<=n?g[m][v]=1:g[m][v]=0:_<=n?g[m][v]=Math.pow(_,l):g[m][v]=0)}if(f)for(let m=0;m<d.length;m++){const v=g[m].reduce((_,w)=>_+w,0);for(let _=0;_<d.length;_++)g[m][_]=g[m][_]/v}return g}function Ha(r,t,e,i={}){const n=t<0;let s=Bo(Math.abs(t),i.units,"meters");n&&(s=-Math.abs(s));const a=me(r),l=YE(a,s,e);return l[0]+=l[0]-a[0]>180?-360:a[0]-l[0]>180?360:0,re(l,i.properties)}function YE(r,t,e,i){i=i===void 0?yn:Number(i);const n=t/i,s=r[0]*Math.PI/180,a=je(r[1]),l=je(e),f=n*Math.cos(l);let d=a+f;Math.abs(d)>Math.PI/2&&(d=d>0?Math.PI-d:-Math.PI-d);const g=Math.log(Math.tan(d/2+Math.PI/4)/Math.tan(a/2+Math.PI/4)),m=Math.abs(g)>1e-11?f/g:Math.cos(a),v=n*Math.sin(l)/m;return[((s+v)*180/Math.PI+540)%360-180,d*180/Math.PI]}function Xs(r,t,e={}){const i=me(r),n=me(t);n[0]+=n[0]-i[0]>180?-360:i[0]-n[0]>180?360:0;const s=XE(i,n);return Bo(s,"meters",e.units)}function XE(r,t,e){e=e===void 0?yn:Number(e);const i=e,n=r[1]*Math.PI/180,s=t[1]*Math.PI/180,a=s-n;let l=Math.abs(t[0]-r[0])*Math.PI/180;l>Math.PI&&(l-=2*Math.PI);const f=Math.log(Math.tan(s/2+Math.PI/4)/Math.tan(n/2+Math.PI/4)),d=Math.abs(f)>1e-11?a/f:Math.cos(n);return Math.sqrt(a*a+d*d*l*l)*i}function Q_(r,t,e){if(e=e||{},!ve(e))throw new Error("options is invalid");const i=e.pivot,n=e.mutate;if(!r)throw new Error("geojson is required");if(t==null||isNaN(t))throw new Error("angle is required");if(t===0)return r;const s=i??Dr(r);return(n===!1||n===void 0)&&(r=bn(r)),Fe(r,function(a){const f=fs(s,a)+t,d=Xs(s,a),g=Jt(Ha(s,d,f));a[0]=g[0],a[1]=g[1]}),r}function tv(r,t,e,i){i=i||{};const n=i.steps||64,s=i.units||"kilometers",a=i.angle||0,l=i.pivot||r,f=i.properties||{};if(!r)throw new Error("center is required");if(!t)throw new Error("xSemiAxis is required");if(!e)throw new Error("ySemiAxis is required");if(!ve(i))throw new Error("options must be an object");if(!_n(n))throw new Error("steps must be a number");if(!_n(a))throw new Error("angle must be a number");const d=me(r);if(s!=="degrees"){const m=Ha(r,t,90,{units:s}),v=Ha(r,e,0,{units:s});t=me(m)[0]-d[0],e=me(v)[1]-d[1]}const g=[];for(let m=0;m<n;m+=1){const v=m*-360/n;let _=t*e/Math.sqrt(Math.pow(e,2)+Math.pow(t,2)*Math.pow(Rg(v),2)),w=t*e/Math.sqrt(Math.pow(t,2)+Math.pow(e,2)/Math.pow(Rg(v),2));if(v<-90&&v>=-270&&(_=-_),v<-180&&v>=-360&&(w=-w),s==="degrees"){const b=je(a),S=_*Math.cos(b)+w*Math.sin(b),N=w*Math.cos(b)-_*Math.sin(b);_=S,w=N}g.push([_+d[0],w+d[1]])}return g.push(g[0]),s==="degrees"?$t([g],f):Q_($t([g],f),a,{pivot:l})}function Rg(r){const t=r*Math.PI/180;return Math.tan(t)}function ev(r){return pl(Te(r))}function rc(r){const t=[];return r.type==="FeatureCollection"?ye(r,function(e){Fe(e,function(i){t.push(re(i,e.properties))})}):r.type==="Feature"?Fe(r,function(e){t.push(re(e,r.properties))}):Fe(r,function(e){t.push(re(e))}),Yt(t)}function WE(r,t){var e;if(t=t||{},!ve(t))throw new Error("options is invalid");const i=(e=t.mutate)!=null?e:!1;if(!r)throw new Error("geojson is required");return(i===!1||i===void 0)&&(r=bn(r)),Fe(r,function(n){var s=n[0],a=n[1];n[0]=a,n[1]=s}),r}var Dg=Math.PI/180,zg=180/Math.PI,tl=function(r,t){this.lon=r,this.lat=t,this.x=Dg*r,this.y=Dg*t};tl.prototype.view=function(){return String(this.lon).slice(0,4)+","+String(this.lat).slice(0,4)};tl.prototype.antipode=function(){var r=-1*this.lat,t=this.lon<0?180+this.lon:(180-this.lon)*-1;return new tl(t,r)};var nv=function(){this.coords=[],this.length=0};nv.prototype.move_to=function(r){this.length++,this.coords.push(r)};var zd=function(r){this.properties=r||{},this.geometries=[]};zd.prototype.json=function(){if(this.geometries.length<=0)return{geometry:{type:"LineString",coordinates:null},type:"Feature",properties:this.properties};if(this.geometries.length===1)return{geometry:{type:"LineString",coordinates:this.geometries[0].coords},type:"Feature",properties:this.properties};for(var r=[],t=0;t<this.geometries.length;t++)r.push(this.geometries[t].coords);return{geometry:{type:"MultiLineString",coordinates:r},type:"Feature",properties:this.properties}};zd.prototype.wkt=function(){for(var r="",t="LINESTRING(",e=function(s){t+=s[0]+" "+s[1]+","},i=0;i<this.geometries.length;i++){if(this.geometries[i].coords.length===0)return"LINESTRING(empty)";var n=this.geometries[i].coords;n.forEach(e),r+=t.substring(0,t.length-1)+")"}return r};var Bd=function(r,t,e){if(!r||r.x===void 0||r.y===void 0)throw new Error("GreatCircle constructor expects two args: start and end objects with x and y properties");if(!t||t.x===void 0||t.y===void 0)throw new Error("GreatCircle constructor expects two args: start and end objects with x and y properties");this.start=new tl(r.x,r.y),this.end=new tl(t.x,t.y),this.properties=e||{};var i=this.start.x-this.end.x,n=this.start.y-this.end.y,s=Math.pow(Math.sin(n/2),2)+Math.cos(this.start.y)*Math.cos(this.end.y)*Math.pow(Math.sin(i/2),2);if(this.g=2*Math.asin(Math.sqrt(s)),this.g===Math.PI)throw new Error("it appears "+r.view()+" and "+t.view()+" are 'antipodal', e.g diametrically opposite, thus there is no single route but rather infinite");if(isNaN(this.g))throw new Error("could not calculate great circle between "+r+" and "+t)};Bd.prototype.interpolate=function(r){var t=Math.sin((1-r)*this.g)/Math.sin(this.g),e=Math.sin(r*this.g)/Math.sin(this.g),i=t*Math.cos(this.start.y)*Math.cos(this.start.x)+e*Math.cos(this.end.y)*Math.cos(this.end.x),n=t*Math.cos(this.start.y)*Math.sin(this.start.x)+e*Math.cos(this.end.y)*Math.sin(this.end.x),s=t*Math.sin(this.start.y)+e*Math.sin(this.end.y),a=zg*Math.atan2(s,Math.sqrt(Math.pow(i,2)+Math.pow(n,2))),l=zg*Math.atan2(n,i);return[l,a]};Bd.prototype.Arc=function(r,t){var e=[];if(!r||r<=2)e.push([this.start.lon,this.start.lat]),e.push([this.end.lon,this.end.lat]);else for(var i=1/(r-1),n=0;n<r;++n){var s=i*n,a=this.interpolate(s);e.push(a)}for(var l=!1,f=0,d=t&&t.offset?t.offset:10,g=180-d,m=-180+d,v=360-d,_=1;_<e.length;++_){var w=e[_-1][0],b=e[_][0],S=Math.abs(b-w);S>v&&(b>g&&w<m||w>g&&b<m)?l=!0:S>f&&(f=S)}var N=[];if(l&&f<d){var k=[];N.push(k);for(var C=0;C<e.length;++C){var A=parseFloat(e[C][0]);if(C>0&&Math.abs(A-e[C-1][0])>v){var P=parseFloat(e[C-1][0]),q=parseFloat(e[C-1][1]),U=parseFloat(e[C][0]),I=parseFloat(e[C][1]);if(P>-180&&P<m&&U===180&&C+1<e.length&&e[C-1][0]>-180&&e[C-1][0]<m){k.push([-180,e[C][1]]),C++,k.push([e[C][0],e[C][1]]);continue}else if(P>g&&P<180&&U===-180&&C+1<e.length&&e[C-1][0]>g&&e[C-1][0]<180){k.push([180,e[C][1]]),C++,k.push([e[C][0],e[C][1]]);continue}if(P<m&&U>g){var O=P;P=U,U=O;var B=q;q=I,I=B}if(P>g&&U<m&&(U+=360),P<=180&&U>=180&&P<U){var V=(180-P)/(U-P),z=V*I+(1-V)*q;k.push([e[C-1][0]>g?180:-180,z]),k=[],k.push([e[C-1][0]>g?-180:180,z]),N.push(k)}else k=[],N.push(k);k.push([A,e[C][1]])}else k.push([e[C][0],e[C][1]])}}else{var W=[];N.push(W);for(var T=0;T<e.length;++T)W.push([e[T][0],e[T][1]])}for(var $=new zd(this.properties),F=0;F<N.length;++F){var X=new nv;$.geometries.push(X);for(var Y=N[F],j=0;j<Y.length;++j)X.move_to(Y[j])}return $};function $E(r,t,e){if(e=e||{},typeof e!="object")throw new Error("options is invalid");var i=e.properties,n=e.npoints,s=e.offset;if(r=me(r),t=me(t),i=i||{},n=n||100,r[0]===t[0]&&r[1]===t[1]){const f=Array(n);return f.fill([r[0],r[1]]),ge(f,i)}s=s||10;var a=new Bd({x:r[0],y:r[1]},{x:t[0],y:t[1]},i),l=a.Arc(n,{offset:s});return l.json()}/*!
 * Copyright (c) 2019, Dane Springmeyer
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions are
 * met:
 *
 *     * Redistributions of source code must retain the above copyright
 *       notice, this list of conditions and the following disclaimer.
 *     * Redistributions in binary form must reproduce the above copyright
 *       notice, this list of conditions and the following disclaimer in
 *       the documentation and/or other materials provided with the
 *       distribution.
 *
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
 * IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
 * THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
 * PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR
 * CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
 * EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
 * PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
 * PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
 * LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
 * NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
 * SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 */function Ya(r,t={}){const e=[];if(Rn(r,n=>{e.push(n.coordinates)}),e.length<2)throw new Error("Must specify at least 2 geometries");const i=J_(e[0],...e.slice(1));return i.length===0?null:i.length===1?$t(i[0],t.properties):pi(i,t.properties)}function iv(r,t,e={}){const i=JSON.stringify(e.properties||{}),[n,s,a,l]=r,f=(s+l)/2,d=(n+a)/2,m=t*2/we([n,f],[a,f],e)*(a-n),_=t*2/we([d,s],[d,l],e)*(l-s),w=m/2,b=w*2,S=Math.sqrt(3)/2*_,N=a-n,k=l-s,C=3/4*b,A=S,P=(N-b)/(b-w/2),q=Math.floor(P),U=(q*C-w/2-N)/2-w/2+C/2,I=Math.floor((k-S)/S);let O=(k-I*S)/2;const B=I*S-k>S/2;B&&(O-=S/4);const V=[],z=[];for(let T=0;T<6;T++){const $=2*Math.PI/6*T;V.push(Math.cos($)),z.push(Math.sin($))}const W=[];for(let T=0;T<=q;T++)for(let $=0;$<=I;$++){const F=T%2===1;if($===0&&F||$===0&&B)continue;const X=T*C+n-U;let Y=$*A+s+O;if(F&&(Y-=S/2),e.triangles===!0)jE([X,Y],m/2,_/2,JSON.parse(i),V,z).forEach(function(j){e.mask?Ya(Yt([e.mask,j]))&&W.push(j):W.push(j)});else{const j=JE([X,Y],m/2,_/2,JSON.parse(i),V,z);e.mask?Ya(Yt([e.mask,j]))&&W.push(j):W.push(j)}}return Yt(W)}function JE(r,t,e,i,n,s){const a=[];for(let l=0;l<6;l++){const f=r[0]+t*n[l],d=r[1]+e*s[l];a.push([f,d])}return a.push(a[0].slice()),$t([a],i)}function jE(r,t,e,i,n,s){const a=[];for(let l=0;l<6;l++){const f=[];f.push(r),f.push([r[0]+t*n[l],r[1]+e*s[l]]),f.push([r[0]+t*n[(l+1)%6],r[1]+e*s[(l+1)%6]]),f.push(r),a.push($t([f],i))}return a}function rv(r,t,e={}){e.mask&&!e.units&&(e.units="kilometers");for(var i=[],n=r[0],s=r[1],a=r[2],l=r[3],f=t/we([n,s],[a,s],e),d=f*(a-n),g=t/we([n,s],[n,l],e),m=g*(l-s),v=a-n,_=l-s,w=Math.floor(v/d),b=Math.floor(_/m),S=(v-w*d)/2,N=(_-b*m)/2,k=n+S;k<=a;){for(var C=s+N;C<=l;){var A=re([k,C],e.properties);e.mask?p_(A,e.mask)&&i.push(A):i.push(A),C+=m}k+=d}return Yt(i)}function sv(r,t,e,i={}){const n=[],s=r[0],a=r[1],l=r[2],f=r[3],d=l-s,g=Bo(t,i.units,"degrees"),m=f-a,v=Bo(e,i.units,"degrees"),_=Math.floor(Math.abs(d)/g),w=Math.floor(Math.abs(m)/v),b=(d-_*g)/2,S=(m-w*v)/2;let N=s+b;for(let k=0;k<_;k++){let C=a+S;for(let A=0;A<w;A++){const P=$t([[[N,C],[N,C+v],[N+g,C+v],[N+g,C],[N,C]]],i.properties);i.mask?c_(i.mask,P)&&n.push(P):n.push(P),C+=v}N+=g}return Yt(n)}function Fd(r,t,e={}){return sv(r,t,t,e)}function ov(r,t,e={}){for(var i=[],n=t/we([r[0],r[1]],[r[2],r[1]],e),s=n*(r[2]-r[0]),a=t/we([r[0],r[1]],[r[0],r[3]],e),l=a*(r[3]-r[1]),f=0,d=r[0];d<=r[2];){for(var g=0,m=r[1];m<=r[3];){var v=null,_=null;f%2===0&&g%2===0?(v=$t([[[d,m],[d,m+l],[d+s,m],[d,m]]],e.properties),_=$t([[[d,m+l],[d+s,m+l],[d+s,m],[d,m+l]]],e.properties)):f%2===0&&g%2===1?(v=$t([[[d,m],[d+s,m+l],[d+s,m],[d,m]]],e.properties),_=$t([[[d,m],[d,m+l],[d+s,m+l],[d,m]]],e.properties)):g%2===0&&f%2===1?(v=$t([[[d,m],[d,m+l],[d+s,m+l],[d,m]]],e.properties),_=$t([[[d,m],[d+s,m+l],[d+s,m],[d,m]]],e.properties)):g%2===1&&f%2===1&&(v=$t([[[d,m],[d,m+l],[d+s,m],[d,m]]],e.properties),_=$t([[[d,m+l],[d+s,m+l],[d+s,m],[d,m+l]]],e.properties)),e.mask?(Ya(Yt([e.mask,v]))&&i.push(v),Ya(Yt([e.mask,_]))&&i.push(_)):(i.push(v),i.push(_)),m+=l,g++}f++,d+=s}return Yt(i)}function KE(r,t,e){if(e=e||{},typeof e!="object")throw new Error("options is invalid");var i=e.gridType,n=e.property,s=e.weight,a=e.bbox;if(!r)throw new Error("points is required");if(gs(r,"Point","input must contain Points"),!t)throw new Error("cellSize is required");if(s!==void 0&&typeof s!="number")throw new Error("weight must be a number");n=n||"elevation",i=i||"square",s=s||1,a=a??Te(r),$u(a);var l;switch(i){case"point":case"points":l=rv(a,t,e);break;case"square":case"squares":l=Fd(a,t,e);break;case"hex":case"hexes":l=iv(a,t,e);break;case"triangle":case"triangles":l=ov(a,t,e);break;default:throw new Error("invalid gridType")}var f=[];return ye(l,function(d){var g=0,m=0;ye(r,function(_){var w=i==="point"?d:Dr(d),b=we(w,_,e),S;if(n!==void 0&&(S=_.properties[n]),S===void 0&&(S=_.geometry.coordinates[2]),S===void 0)throw new Error("zValue is missing");b===0&&(g=S);var N=1/Math.pow(b,s);m+=N,g+=N*S});var v=bn(d);v.properties[n]=g/m,f.push(v)}),Yt(f)}/*!
* MarchingSquaresJS
* version 1.3.3
* https://github.com/RaumZeit/MarchingSquares.js
*
* @license GNU Affero General Public License.
* Copyright (c) 2015-2019 Ronny Lorenz <ronny@tbi.univie.ac.at>
*/function QE(r,t,e){return r<t?(e-r)/(t-r):(r-e)/(r-t)}function tk(r,t,e,i){var n;return e>i&&(n=e,e=i,i=n),r<t?r<e?(e-r)/(t-r):(i-r)/(t-r):r>i?(r-i)/(r-t):(r-e)/(r-t)}function ek(r,t,e,i){return r<t?(e-r)/(t-r):(r-i)/(r-t)}function nk(r,t,e,i){return r<t?(i-r)/(t-r):(r-e)/(r-t)}function av(){this.successCallback=null,this.verbose=!1,this.polygons=!1,this.polygons_full=!1,this.linearRing=!0,this.noQuadTree=!1,this.noFrame=!1}function ik(r){var t,e,i,n,s;for(n=new av,r=r||{},s=Object.keys(n),t=0;t<s.length;t++)e=s[t],i=r[e],typeof i<"u"&&i!==null&&(n[e]=i);return n.polygons_full=!n.polygons,n.interpolate=tk,n.interpolate_a=ek,n.interpolate_b=nk,n}function rk(r){var t,e,i,n,s;for(n=new av,r=r||{},s=Object.keys(n),t=0;t<s.length;t++)e=s[t],i=r[e],typeof i<"u"&&i!==null&&(n[e]=i);return n.polygons_full=!n.polygons,n.interpolate=QE,n}function Bh(r,t,e,i){var n=[];return r.polygons.forEach(function(s){s.forEach(function(a){a[0]+=t,a[1]+=e}),i.linearRing&&s.push(s[0]),n.push(s)}),n}function uv(r,t,e,i){return e===0?(r+=1,t+=i[0][1]):e===1?r+=i[0][0]:e===2?t+=i[0][1]:e===3&&(r+=i[0][0],t+=1),[r,t]}function lv(r,t,e){return e===0?r++:e===1||(e===2?t++:e===3&&(r++,t++)),[r,t]}function sk(r,t,e){var i,n,s,a,l;for(i=!0,n=r[0].length,s=r.length,l=0;l<s;l++)if(r[l][0]<t||r[l][0]>e||r[l][n-1]<t||r[l][n-1]>e){i=!1;break}if(i&&(r[s-1][0]<t||r[s-1][0]>e||r[s-1][n-1]<t||r[s-1][n-1]>e)&&(i=!1),i){for(a=0;a<n-1;a++)if(r[0][a]<t||r[0][a]>e||r[s-1][a]<t||r[s-1][a]>e){i=!1;break}}return i}function ok(r,t){var e,i,n,s,a;for(e=!0,i=r[0].length,n=r.length,a=0;a<n;a++)if(r[a][0]>=t||r[a][i-1]>=t){e=!1;break}if(e&&(r[n-1][0]>=t||r[n-1][i-1]>=t)&&(e=!1),e){for(s=0;s<i-1;s++)if(r[0][s]>=t||r[n-1][s]>t){e=!1;break}}return e}function ak(r,t,e){var i,n,s,a,l,f,d,g,m,v,_,w,b,S,N,k,C=[],A=r.length-1,P=r[0].length-1,q=[["rt","rb"],["br","bl"],["lb","lt"],["tl","tr"]],U=[0,-1,0,1],I=[-1,0,1,0],O=["bl","lb","lt","tl","tr","rt","rb","br"],B={bl:1,br:1,lb:2,lt:2,tl:3,tr:3,rt:0,rb:0};return sk(r,e.minV,e.maxV)&&(e.linearRing?C.push([[0,0],[0,A],[P,A],[P,0],[0,0]]):C.push([[0,0],[0,A],[P,A],[P,0]])),t.forEach(function(V,z){V.forEach(function(W,T){for(i=null,s=0;s<8;s++)if(i=O[s],typeof W.edges[i]=="object"){for(n=[],a=W.edges[i],d=i,g=z,m=T,v=!1,_=[z+a.path[0][0],T+a.path[0][1]],n.push(_);!v&&(w=t[g][m],typeof w.edges[d]=="object");)if(a=w.edges[d],delete w.edges[d],N=a.path[1],N[0]+=g,N[1]+=m,n.push(N),d=a.move.enter,g=g+a.move.x,m=m+a.move.y,typeof t[g]>"u"||typeof t[g][m]>"u"){if(b=0,S=0,g===P)g--,b=0;else if(g<0)g++,b=2;else if(m===A)m--,b=3;else if(m<0)m++,b=1;else throw new Error("Left the grid somewhere in the interior!");if(g===z&&m===T&&b===B[i]){v=!0,d=i;break}for(;;){if(k=!1,S>4)throw new Error("Direction change counter overflow! This should never happen!");if(!(typeof t[g]>"u"||typeof t[g][m]>"u")){for(w=t[g][m],l=0;l<q[b].length;l++)if(f=q[b][l],typeof w.edges[f]=="object"){a=w.edges[f],n.push(uv(g,m,b,a.path)),d=f,k=!0;break}}if(k)break;if(n.push(lv(g,m,b)),g+=U[b],m+=I[b],(typeof t[g]>"u"||typeof t[g][m]>"u")&&(b===0&&m<0||b===1&&g<0||b===2&&m===A||b===3&&g===P)&&(g-=U[b],m-=I[b],b=(b+1)%4,S++),g===z&&m===T&&b===B[i]){v=!0,d=i;break}}}e.linearRing&&(n[n.length-1][0]!==_[0]||n[n.length-1][1]!==_[1])&&n.push(_),C.push(n)}})}),C}function uk(r,t,e){var i,n,s,a,l,f,d,g,m,v,_,w,b,S,N,k=[],C=r.length-1,A=r[0].length-1,P=["right","bottom","left","top"],q=[0,-1,0,1],U=[-1,0,1,0],I={bottom:1,left:2,top:3,right:0};return e.noFrame||ok(r,e.threshold)&&(e.linearRing?k.push([[0,0],[0,C],[A,C],[A,0],[0,0]]):k.push([[0,0],[0,C],[A,C],[A,0]])),t.forEach(function(O,B){O.forEach(function(V,z){for(i=null,n=0;n<4;n++)if(i=P[n],typeof V.edges[i]=="object"){for(l=[],s=V.edges[i],f=i,d=B,g=z,m=!1,v=[B+s.path[0][0],z+s.path[0][1]],l.push(v);!m&&(a=t[d][g],typeof a.edges[f]=="object");)if(s=a.edges[f],delete a.edges[f],_=s.path[1],_[0]+=d,_[1]+=g,l.push(_),f=s.move.enter,d=d+s.move.x,g=g+s.move.y,typeof t[d]>"u"||typeof t[d][g]>"u"){if(!e.linearRing)break;if(w=0,b=0,d===A?(d--,w=0):d<0?(d++,w=2):g===C?(g--,w=3):g<0&&(g++,w=1),d===B&&g===z&&w===I[i]){m=!0,f=i;break}for(;;){if(S=!1,b>4)throw new Error("Direction change counter overflow! This should never happen!");if(!(typeof t[d]>"u"||typeof t[d][g]>"u")&&(a=t[d][g],N=P[w],typeof a.edges[N]=="object")){s=a.edges[N],l.push(uv(d,g,w,s.path)),f=N,S=!0;break}if(S)break;if(l.push(lv(d,g,w)),d+=q[w],g+=U[w],(typeof t[d]>"u"||typeof t[d][g]>"u")&&(w===0&&g<0||w===1&&d<0||w===2&&g===C||w===3&&d===A)&&(d-=q[w],g-=U[w],w=(w+1)%4,b++),d===B&&g===z&&w===I[i]){m=!0,f=i;break}}}e.linearRing&&(l[l.length-1][0]!==v[0]||l[l.length-1][1]!==v[1])&&l.push(v),k.push(l)}})}),k}function Oo(r,t,e,i,n){var s=i,a=n,l=0,f=0;if(this.x=t,this.y=e,this.lowerBound=null,this.upperBound=null,this.childA=null,this.childB=null,this.childC=null,this.childD=null,i===1&&n===1)this.lowerBound=Math.min(r[e][t],r[e][t+1],r[e+1][t+1],r[e+1][t]),this.upperBound=Math.max(r[e][t],r[e][t+1],r[e+1][t+1],r[e+1][t]);else{if(i>1){for(;s!==0;)s=s>>1,l++;i===1<<l-1&&l--,s=1<<l-1}if(n>1){for(;a!==0;)a=a>>1,f++;n===1<<f-1&&f--,a=1<<f-1}this.childA=new Oo(r,t,e,s,a),this.lowerBound=this.childA.lowerBound,this.upperBound=this.childA.upperBound,i-s>0&&(this.childB=new Oo(r,t+s,e,i-s,a),this.lowerBound=Math.min(this.lowerBound,this.childB.lowerBound),this.upperBound=Math.max(this.upperBound,this.childB.upperBound),n-a>0&&(this.childC=new Oo(r,t+s,e+a,i-s,n-a),this.lowerBound=Math.min(this.lowerBound,this.childC.lowerBound),this.upperBound=Math.max(this.upperBound,this.childC.upperBound))),n-a>0&&(this.childD=new Oo(r,t,e+a,s,n-a),this.lowerBound=Math.min(this.lowerBound,this.childD.lowerBound),this.upperBound=Math.max(this.upperBound,this.childD.upperBound))}}Oo.prototype.cellsInBand=function(r,t,e){var i=[];return e=typeof e>"u"?!0:e,this.lowerBound>t||this.upperBound<r||(this.childA||this.childB||this.childC||this.childD?(this.childA&&(i=i.concat(this.childA.cellsInBand(r,t,e))),this.childB&&(i=i.concat(this.childB.cellsInBand(r,t,e))),this.childD&&(i=i.concat(this.childD.cellsInBand(r,t,e))),this.childC&&(i=i.concat(this.childC.cellsInBand(r,t,e)))):(e||this.lowerBound<=r||this.upperBound>=t)&&i.push({x:this.x,y:this.y})),i};Oo.prototype.cellsBelowThreshold=function(r,t){var e=[];return t=typeof t>"u"?!0:t,this.lowerBound>r||(this.childA||this.childB||this.childC||this.childD?(this.childA&&(e=e.concat(this.childA.cellsBelowThreshold(r,t))),this.childB&&(e=e.concat(this.childB.cellsBelowThreshold(r,t))),this.childD&&(e=e.concat(this.childD.cellsBelowThreshold(r,t))),this.childC&&(e=e.concat(this.childC.cellsBelowThreshold(r,t)))):(t||this.upperBound>=r)&&e.push({x:this.x,y:this.y})),e};function Fh(r){var t,e;if(!r)throw new Error("data is required");if(!Array.isArray(r)||!Array.isArray(r[0]))throw new Error("data must be scalar field, i.e. array of arrays");if(r.length<2)throw new Error("data must contain at least two rows");if(e=r[0].length,e<2)throw new Error("data must contain at least two columns");for(t=1;t<r.length;t++){if(!Array.isArray(r[t]))throw new Error("Row "+t+" is not an array");if(r[t].length!=e)throw new Error("unequal row lengths detected, please provide a regular grid")}this.data=r,this.root=new Oo(r,0,0,r[0].length-1,r.length-1)}function lk(r,t,e){var i,n,s,a=!1,l=!1,f=null,d=null,g=null,m=null,v=null,_=[];if(!r)throw new Error("data is required");if(t==null)throw new Error("threshold is required");if(e&&typeof e!="object")throw new Error("options must be an object");if(i=rk(e),r instanceof Fh)f=r,d=r.root,g=r.data,i.noQuadTree||(a=!0);else if(Array.isArray(r)&&Array.isArray(r[0]))g=r;else throw new Error("input is neither array of arrays nor object retrieved from 'QuadTree()'");if(Array.isArray(t)){for(l=!0,i.noQuadTree||(a=!0),n=0;n<t.length;n++)if(isNaN(+t[n]))throw new Error("threshold["+n+"] is not a number")}else{if(isNaN(+t))throw new Error("threshold must be a number or array of numbers");t=[t]}return a&&!d&&(f=new Fh(g),d=f.root,g=f.data),i.verbose&&(i.polygons?console.log("MarchingSquaresJS-isoLines: returning single lines (polygons) for each grid cell"):console.log("MarchingSquaresJS-isoLines: returning line paths (polygons) for entire data grid"),l&&console.log("MarchingSquaresJS-isoLines: multiple lines requested, returning array of line paths instead of lines for a single threshold")),t.forEach(function(w,b){if(v=[],i.threshold=w,i.verbose&&console.log("MarchingSquaresJS-isoLines: computing iso lines for threshold "+w),i.polygons)if(a)d.cellsBelowThreshold(i.threshold,!0).forEach(function(S){v=v.concat(Bh(Fl(g,S.x,S.y,i),S.x,S.y,i))});else for(s=0;s<g.length-1;++s)for(b=0;b<g[0].length-1;++b)v=v.concat(Bh(Fl(g,b,s,i),b,s,i));else{for(m=[],b=0;b<g[0].length-1;++b)m[b]=[];if(a)d.cellsBelowThreshold(i.threshold,!1).forEach(function(S){m[S.x][S.y]=Fl(g,S.x,S.y,i)});else for(b=0;b<g[0].length-1;++b)for(s=0;s<g.length-1;++s)m[b][s]=Fl(g,b,s,i);v=uk(g,m,i)}l?_.push(v):_=v,typeof i.successCallback=="function"&&i.successCallback(_,w)}),_}function Fl(r,t,e,i){var n,s,a,l,f,d,g=0,m=r[e+1][t],v=r[e+1][t+1],_=r[e][t+1],w=r[e][t],b=i.threshold;if(!(isNaN(w)||isNaN(_)||isNaN(v)||isNaN(m))){switch(g|=m>=b?8:0,g|=v>=b?4:0,g|=_>=b?2:0,g|=w>=b?1:0,g=+g,d={cval:g,polygons:[],edges:{},x0:w,x1:_,x2:v,x3:m},g){case 0:i.polygons&&d.polygons.push([[0,0],[0,1],[1,1],[1,0]]);break;case 15:break;case 14:n=i.interpolate(w,m,b),l=i.interpolate(w,_,b),i.polygons_full&&(d.edges.left={path:[[0,n],[l,0]],move:{x:0,y:-1,enter:"top"}}),i.polygons&&d.polygons.push([[0,0],[0,n],[l,0]]);break;case 13:l=i.interpolate(w,_,b),s=i.interpolate(_,v,b),i.polygons_full&&(d.edges.bottom={path:[[l,0],[1,s]],move:{x:1,y:0,enter:"left"}}),i.polygons&&d.polygons.push([[l,0],[1,s],[1,0]]);break;case 11:s=i.interpolate(_,v,b),a=i.interpolate(m,v,b),i.polygons_full&&(d.edges.right={path:[[1,s],[a,1]],move:{x:0,y:1,enter:"bottom"}}),i.polygons&&d.polygons.push([[1,s],[a,1],[1,1]]);break;case 7:n=i.interpolate(w,m,b),a=i.interpolate(m,v,b),i.polygons_full&&(d.edges.top={path:[[a,1],[0,n]],move:{x:-1,y:0,enter:"right"}}),i.polygons&&d.polygons.push([[a,1],[0,n],[0,1]]);break;case 1:n=i.interpolate(w,m,b),l=i.interpolate(w,_,b),i.polygons_full&&(d.edges.bottom={path:[[l,0],[0,n]],move:{x:-1,y:0,enter:"right"}}),i.polygons&&d.polygons.push([[l,0],[0,n],[0,1],[1,1],[1,0]]);break;case 2:l=i.interpolate(w,_,b),s=i.interpolate(_,v,b),i.polygons_full&&(d.edges.right={path:[[1,s],[l,0]],move:{x:0,y:-1,enter:"top"}}),i.polygons&&d.polygons.push([[0,0],[0,1],[1,1],[1,s],[l,0]]);break;case 4:s=i.interpolate(_,v,b),a=i.interpolate(m,v,b),i.polygons_full&&(d.edges.top={path:[[a,1],[1,s]],move:{x:1,y:0,enter:"left"}}),i.polygons&&d.polygons.push([[0,0],[0,1],[a,1],[1,s],[1,0]]);break;case 8:n=i.interpolate(w,m,b),a=i.interpolate(m,v,b),i.polygons_full&&(d.edges.left={path:[[0,n],[a,1]],move:{x:0,y:1,enter:"bottom"}}),i.polygons&&d.polygons.push([[0,0],[0,n],[a,1],[1,1],[1,0]]);break;case 12:n=i.interpolate(w,m,b),s=i.interpolate(_,v,b),i.polygons_full&&(d.edges.left={path:[[0,n],[1,s]],move:{x:1,y:0,enter:"left"}}),i.polygons&&d.polygons.push([[0,0],[0,n],[1,s],[1,0]]);break;case 9:l=i.interpolate(w,_,b),a=i.interpolate(m,v,b),i.polygons_full&&(d.edges.bottom={path:[[l,0],[a,1]],move:{x:0,y:1,enter:"bottom"}}),i.polygons&&d.polygons.push([[l,0],[a,1],[1,1],[1,0]]);break;case 3:n=i.interpolate(w,m,b),s=i.interpolate(_,v,b),i.polygons_full&&(d.edges.right={path:[[1,s],[0,n]],move:{x:-1,y:0,enter:"right"}}),i.polygons&&d.polygons.push([[0,n],[0,1],[1,1],[1,s]]);break;case 6:l=i.interpolate(w,_,b),a=i.interpolate(m,v,b),i.polygons_full&&(d.edges.top={path:[[a,1],[l,0]],move:{x:0,y:-1,enter:"top"}}),i.polygons&&d.polygons.push([[0,0],[0,1],[a,1],[l,0]]);break;case 10:n=i.interpolate(w,m,b),s=i.interpolate(_,v,b),l=i.interpolate(w,_,b),a=i.interpolate(m,v,b),f=(w+_+v+m)/4,i.polygons_full&&(f<b?(d.edges.left={path:[[0,n],[a,1]],move:{x:0,y:1,enter:"bottom"}},d.edges.right={path:[[1,s],[l,0]],move:{x:0,y:-1,enter:"top"}}):(d.edges.right={path:[[1,s],[a,1]],move:{x:0,y:1,enter:"bottom"}},d.edges.left={path:[[0,n],[l,0]],move:{x:0,y:-1,enter:"top"}})),i.polygons&&(f<b?d.polygons.push([[0,0],[0,n],[a,1],[1,1],[1,s],[l,0]]):(d.polygons.push([[0,0],[0,n],[l,0]]),d.polygons.push([[a,1],[1,1],[1,s]])));break;case 5:n=i.interpolate(w,m,b),s=i.interpolate(_,v,b),l=i.interpolate(w,_,b),a=i.interpolate(m,v,b),f=(w+_+v+m)/4,i.polygons_full&&(f<b?(d.edges.bottom={path:[[l,0],[0,n]],move:{x:-1,y:0,enter:"right"}},d.edges.top={path:[[a,1],[1,s]],move:{x:1,y:0,enter:"left"}}):(d.edges.top={path:[[a,1],[0,n]],move:{x:-1,y:0,enter:"right"}},d.edges.bottom={path:[[l,0],[1,s]],move:{x:1,y:0,enter:"left"}})),i.polygons&&(f<b?d.polygons.push([[0,n],[0,1],[a,1],[1,s],[1,0],[l,0]]):(d.polygons.push([[0,n],[0,1],[a,1]]),d.polygons.push([[l,0],[1,s],[1,0]])));break}return d}}var It={square:function(r,t,e,i,n,s){s.polygons&&r.polygons.push([[0,0],[0,1],[1,1],[1,0]])},triangle_bl:function(r,t,e,i,n,s){var a=s.interpolate(t,e,s.minV,s.maxV),l=s.interpolate(t,n,s.minV,s.maxV);s.polygons_full&&(r.edges.lb={path:[[0,l],[a,0]],move:{x:0,y:-1,enter:"tl"}}),s.polygons&&r.polygons.push([[0,l],[a,0],[0,0]])},triangle_br:function(r,t,e,i,n,s){var a=s.interpolate(t,e,s.minV,s.maxV),l=s.interpolate(e,i,s.minV,s.maxV);s.polygons_full&&(r.edges.br={path:[[a,0],[1,l]],move:{x:1,y:0,enter:"lb"}}),s.polygons&&r.polygons.push([[a,0],[1,l],[1,0]])},triangle_tr:function(r,t,e,i,n,s){var a=s.interpolate(e,i,s.minV,s.maxV),l=s.interpolate(n,i,s.minV,s.maxV);s.polygons_full&&(r.edges.rt={path:[[1,a],[l,1]],move:{x:0,y:1,enter:"br"}}),s.polygons&&r.polygons.push([[1,a],[l,1],[1,1]])},triangle_tl:function(r,t,e,i,n,s){var a=s.interpolate(n,i,s.minV,s.maxV),l=s.interpolate(t,n,s.minV,s.maxV);s.polygons_full&&(r.edges.tl={path:[[a,1],[0,l]],move:{x:-1,y:0,enter:"rt"}}),s.polygons&&r.polygons.push([[0,l],[0,1],[a,1]])},tetragon_t:function(r,t,e,i,n,s){var a=s.interpolate(e,i,s.minV,s.maxV),l=s.interpolate(t,n,s.minV,s.maxV);s.polygons_full&&(r.edges.rt={path:[[1,a],[0,l]],move:{x:-1,y:0,enter:"rt"}}),s.polygons&&r.polygons.push([[0,l],[0,1],[1,1],[1,a]])},tetragon_r:function(r,t,e,i,n,s){var a=s.interpolate(t,e,s.minV,s.maxV),l=s.interpolate(n,i,s.minV,s.maxV);s.polygons_full&&(r.edges.br={path:[[a,0],[l,1]],move:{x:0,y:1,enter:"br"}}),s.polygons&&r.polygons.push([[a,0],[l,1],[1,1],[1,0]])},tetragon_b:function(r,t,e,i,n,s){var a=s.interpolate(t,n,s.minV,s.maxV),l=s.interpolate(e,i,s.minV,s.maxV);s.polygons_full&&(r.edges.lb={path:[[0,a],[1,l]],move:{x:1,y:0,enter:"lb"}}),s.polygons&&r.polygons.push([[0,0],[0,a],[1,l],[1,0]])},tetragon_l:function(r,t,e,i,n,s){var a=s.interpolate(n,i,s.minV,s.maxV),l=s.interpolate(t,e,s.minV,s.maxV);s.polygons_full&&(r.edges.tl={path:[[a,1],[l,0]],move:{x:0,y:-1,enter:"tl"}}),s.polygons&&r.polygons.push([[0,0],[0,1],[a,1],[l,0]])},tetragon_bl:function(r,t,e,i,n,s){var a=s.interpolate_a(t,e,s.minV,s.maxV),l=s.interpolate_b(t,e,s.minV,s.maxV),f=s.interpolate_a(t,n,s.minV,s.maxV),d=s.interpolate_b(t,n,s.minV,s.maxV);s.polygons_full&&(r.edges.bl={path:[[a,0],[0,f]],move:{x:-1,y:0,enter:"rb"}},r.edges.lt={path:[[0,d],[l,0]],move:{x:0,y:-1,enter:"tr"}}),s.polygons&&r.polygons.push([[a,0],[0,f],[0,d],[l,0]])},tetragon_br:function(r,t,e,i,n,s){var a=s.interpolate_a(t,e,s.minV,s.maxV),l=s.interpolate_b(t,e,s.minV,s.maxV),f=s.interpolate_a(e,i,s.minV,s.maxV),d=s.interpolate_b(e,i,s.minV,s.maxV);s.polygons_full&&(r.edges.bl={path:[[a,0],[1,d]],move:{x:1,y:0,enter:"lt"}},r.edges.rb={path:[[1,f],[l,0]],move:{x:0,y:-1,enter:"tr"}}),s.polygons&&r.polygons.push([[a,0],[1,d],[1,f],[l,0]])},tetragon_tr:function(r,t,e,i,n,s){var a=s.interpolate_a(n,i,s.minV,s.maxV),l=s.interpolate_b(n,i,s.minV,s.maxV),f=s.interpolate_b(e,i,s.minV,s.maxV),d=s.interpolate_a(e,i,s.minV,s.maxV);s.polygons_full&&(r.edges.rb={path:[[1,d],[a,1]],move:{x:0,y:1,enter:"bl"}},r.edges.tr={path:[[l,1],[1,f]],move:{x:1,y:0,enter:"lt"}}),s.polygons&&r.polygons.push([[1,d],[a,1],[l,1],[1,f]])},tetragon_tl:function(r,t,e,i,n,s){var a=s.interpolate_a(n,i,s.minV,s.maxV),l=s.interpolate_b(n,i,s.minV,s.maxV),f=s.interpolate_b(t,n,s.minV,s.maxV),d=s.interpolate_a(t,n,s.minV,s.maxV);s.polygons_full&&(r.edges.tr={path:[[l,1],[0,d]],move:{x:-1,y:0,enter:"rb"}},r.edges.lt={path:[[0,f],[a,1]],move:{x:0,y:1,enter:"bl"}}),s.polygons&&r.polygons.push([[l,1],[0,d],[0,f],[a,1]])},tetragon_lr:function(r,t,e,i,n,s){var a=s.interpolate_a(t,n,s.minV,s.maxV),l=s.interpolate_b(t,n,s.minV,s.maxV),f=s.interpolate_b(e,i,s.minV,s.maxV),d=s.interpolate_a(e,i,s.minV,s.maxV);s.polygons_full&&(r.edges.lt={path:[[0,l],[1,f]],move:{x:1,y:0,enter:"lt"}},r.edges.rb={path:[[1,d],[0,a]],move:{x:-1,y:0,enter:"rb"}}),s.polygons&&r.polygons.push([[0,a],[0,l],[1,f],[1,d]])},tetragon_tb:function(r,t,e,i,n,s){var a=s.interpolate_a(n,i,s.minV,s.maxV),l=s.interpolate_b(n,i,s.minV,s.maxV),f=s.interpolate_b(t,e,s.minV,s.maxV),d=s.interpolate_a(t,e,s.minV,s.maxV);s.polygons_full&&(r.edges.tr={path:[[l,1],[f,0]],move:{x:0,y:-1,enter:"tr"}},r.edges.bl={path:[[d,0],[a,1]],move:{x:0,y:1,enter:"bl"}}),s.polygons&&r.polygons.push([[d,0],[a,1],[l,1],[f,0]])},pentagon_tr:function(r,t,e,i,n,s){var a=s.interpolate(n,i,s.minV,s.maxV),l=s.interpolate(e,i,s.minV,s.maxV);s.polygons_full&&(r.edges.tl={path:[[a,1],[1,l]],move:{x:1,y:0,enter:"lb"}}),s.polygons&&r.polygons.push([[0,0],[0,1],[a,1],[1,l],[1,0]])},pentagon_tl:function(r,t,e,i,n,s){var a=s.interpolate(t,n,s.minV,s.maxV),l=s.interpolate(n,i,s.minV,s.maxV);s.polygons_full&&(r.edges.lb={path:[[0,a],[l,1]],move:{x:0,y:1,enter:"br"}}),s.polygons&&r.polygons.push([[0,0],[0,a],[l,1],[1,1],[1,0]])},pentagon_br:function(r,t,e,i,n,s){var a=s.interpolate(t,e,s.minV,s.maxV),l=s.interpolate(e,i,s.minV,s.maxV);s.polygons_full&&(r.edges.rt={path:[[1,l],[a,0]],move:{x:0,y:-1,enter:"tl"}}),s.polygons&&r.polygons.push([[0,0],[0,1],[1,1],[1,l],[a,0]])},pentagon_bl:function(r,t,e,i,n,s){var a=s.interpolate(t,n,s.minV,s.maxV),l=s.interpolate(t,e,s.minV,s.maxV);s.polygons_full&&(r.edges.br={path:[[l,0],[0,a]],move:{x:-1,y:0,enter:"rt"}}),s.polygons&&r.polygons.push([[0,a],[0,1],[1,1],[1,0],[l,0]])},pentagon_tr_rl:function(r,t,e,i,n,s){var a=s.interpolate(t,n,s.minV,s.maxV),l=s.interpolate(n,i,s.minV,s.maxV),f=s.interpolate_b(e,i,s.minV,s.maxV),d=s.interpolate_a(e,i,s.minV,s.maxV);s.polygons_full&&(r.edges.tl={path:[[l,1],[1,f]],move:{x:1,y:0,enter:"lt"}},r.edges.rb={path:[[1,d],[0,a]],move:{x:-1,y:0,enter:"rt"}}),s.polygons&&r.polygons.push([[0,a],[0,1],[l,1],[1,f],[1,d]])},pentagon_rb_bt:function(r,t,e,i,n,s){var a=s.interpolate(e,i,s.minV,s.maxV),l=s.interpolate_b(t,e,s.minV,s.maxV),f=s.interpolate_a(t,e,s.minV,s.maxV),d=s.interpolate(n,i,s.minV,s.maxV);s.polygons_full&&(r.edges.rt={path:[[1,a],[l,0]],move:{x:0,y:-1,enter:"tr"}},r.edges.bl={path:[[f,0],[d,1]],move:{x:0,y:1,enter:"br"}}),s.polygons&&r.polygons.push([[d,1],[1,1],[1,a],[l,0],[f,0]])},pentagon_bl_lr:function(r,t,e,i,n,s){var a=s.interpolate(t,e,s.minV,s.maxV),l=s.interpolate_a(t,n,s.minV,s.maxV),f=s.interpolate_b(t,n,s.minV,s.maxV),d=s.interpolate(e,i,s.minV,s.maxV);s.polygons_full&&(r.edges.br={path:[[a,0],[0,l]],move:{x:-1,y:0,enter:"rb"}},r.edges.lt={path:[[0,f],[1,d]],move:{x:1,y:0,enter:"lb"}}),s.polygons&&r.polygons.push([[a,0],[0,l],[0,f],[1,d],[1,0]])},pentagon_lt_tb:function(r,t,e,i,n,s){var a=s.interpolate(t,n,s.minV,s.maxV),l=s.interpolate_a(n,i,s.minV,s.maxV),f=s.interpolate_b(n,i,s.minV,s.maxV),d=s.interpolate(t,e,s.minV,s.maxV);s.polygons_full&&(r.edges.lb={path:[[0,a],[l,1]],move:{x:0,y:1,enter:"bl"}},r.edges.tr={path:[[f,1],[d,0]],move:{x:0,y:-1,enter:"tl"}}),s.polygons&&r.polygons.push([[0,0],[0,a],[l,1],[f,1],[d,0]])},pentagon_bl_tb:function(r,t,e,i,n,s){var a=s.interpolate(t,n,s.minV,s.maxV),l=s.interpolate(n,i,s.minV,s.maxV),f=s.interpolate_b(t,e,s.minV,s.maxV),d=s.interpolate_a(t,e,s.minV,s.maxV);s.polygons_full&&(r.edges.bl={path:[[d,0],[0,a]],move:{x:-1,y:0,enter:"rt"}},r.edges.tl={path:[[l,1],[f,0]],move:{x:0,y:-1,enter:"tr"}}),s.polygons&&r.polygons.push([[0,a],[0,1],[l,1],[f,0],[d,0]])},pentagon_lt_rl:function(r,t,e,i,n,s){var a=s.interpolate_a(t,n,s.minV,s.maxV),l=s.interpolate_b(t,n,s.minV,s.maxV),f=s.interpolate(n,i,s.minV,s.maxV),d=s.interpolate(e,n,s.minV,s.maxV);s.polygons_full&&(r.edges.lt={path:[[0,l],[f,1]],move:{x:0,y:1,enter:"br"}},r.edges.rt={path:[[1,d],[0,a]],move:{x:-1,y:0,enter:"rb"}}),s.polygons&&r.polygons.push([[0,a],[0,l],[f,1],[1,1],[1,d]])},pentagon_tr_bt:function(r,t,e,i,n,s){var a=s.interpolate_a(n,i,s.minV,s.maxV),l=s.interpolate_b(n,i,s.minV,s.maxV),f=s.interpolate(e,i,s.minV,s.maxV),d=s.interpolate(t,e,s.minV,s.maxV);s.polygons_full&&(r.edges.br={path:[[d,0],[a,1]],move:{x:0,y:1,enter:"bl"}},r.edges.tr={path:[[l,1],[1,f]],move:{x:1,y:0,enter:"lb"}}),s.polygons&&r.polygons.push([[a,1],[l,1],[1,f],[1,0],[d,0]])},pentagon_rb_lr:function(r,t,e,i,n,s){var a=s.interpolate(t,n,s.minV,s.maxV),l=s.interpolate_b(e,i,s.minV,s.maxV),f=s.interpolate_a(e,i,s.minV,s.maxV),d=s.interpolate(t,e,s.minV,s.maxV);s.polygons_full&&(r.edges.lb={path:[[0,a],[1,l]],move:{x:1,y:0,enter:"lt"}},r.edges.rb={path:[[1,f],[d,0]],move:{x:0,y:-1,enter:"tl"}}),s.polygons&&r.polygons.push([[0,0],[0,a],[1,l],[1,f],[d,0]])},hexagon_lt_tr:function(r,t,e,i,n,s){var a=s.interpolate(t,n,s.minV,s.maxV),l=s.interpolate_a(n,i,s.minV,s.maxV),f=s.interpolate_b(n,i,s.minV,s.maxV),d=s.interpolate(e,i,s.minV,s.maxV);s.polygons_full&&(r.edges.lb={path:[[0,a],[l,1]],move:{x:0,y:1,enter:"bl"}},r.edges.tr={path:[[f,1],[1,d]],move:{x:1,y:0,enter:"lb"}}),s.polygons&&r.polygons.push([[0,0],[0,a],[l,1],[f,1],[1,d],[1,0]])},hexagon_bl_lt:function(r,t,e,i,n,s){var a=s.interpolate(t,e,s.minV,s.maxV),l=s.interpolate_a(t,n,s.minV,s.maxV),f=s.interpolate_b(t,n,s.minV,s.maxV),d=s.interpolate(n,i,s.minV,s.maxV);s.polygons_full&&(r.edges.br={path:[[a,0],[0,l]],move:{x:-1,y:0,enter:"rb"}},r.edges.lt={path:[[0,f],[d,1]],move:{x:0,y:1,enter:"br"}}),s.polygons&&r.polygons.push([[a,0],[0,l],[0,f],[d,1],[1,1],[1,0]])},hexagon_bl_rb:function(r,t,e,i,n,s){var a=s.interpolate_a(t,e,s.minV,s.maxV),l=s.interpolate_b(t,e,s.minV,s.maxV),f=s.interpolate(t,n,s.minV,s.maxV),d=s.interpolate(e,i,s.minV,s.maxV);s.polygons_full&&(r.edges.bl={path:[[a,0],[0,f]],move:{x:-1,y:0,enter:"rt"}},r.edges.rt={path:[[1,d],[l,0]],move:{x:0,y:-1,enter:"tr"}}),s.polygons&&r.polygons.push([[a,0],[0,f],[0,1],[1,1],[1,d],[l,0]])},hexagon_tr_rb:function(r,t,e,i,n,s){var a=s.interpolate(t,e,s.minV,s.maxV),l=s.interpolate(n,i,s.minV,s.maxV),f=s.interpolate_b(e,i,s.minV,s.maxV),d=s.interpolate_a(e,i,s.minV,s.maxV);s.polygons_full&&(r.edges.tl={path:[[l,1],[1,f]],move:{x:1,y:0,enter:"lt"}},r.edges.rb={path:[[1,d],[a,0]],move:{x:0,y:-1,enter:"tl"}}),s.polygons&&r.polygons.push([[0,0],[0,1],[l,1],[1,f],[1,d],[a,0]])},hexagon_lt_rb:function(r,t,e,i,n,s){var a=s.interpolate(t,n,s.minV,s.maxV),l=s.interpolate(n,i,s.minV,s.maxV),f=s.interpolate(e,i,s.minV,s.maxV),d=s.interpolate(t,e,s.minV,s.maxV);s.polygons_full&&(r.edges.lb={path:[[0,a],[l,1]],move:{x:0,y:1,enter:"br"}},r.edges.rt={path:[[1,f],[d,0]],move:{x:0,y:-1,enter:"tl"}}),s.polygons&&r.polygons.push([[0,0],[0,a],[l,1],[1,1],[1,f],[d,0]])},hexagon_bl_tr:function(r,t,e,i,n,s){var a=s.interpolate(t,e,s.minV,s.maxV),l=s.interpolate(t,n,s.minV,s.maxV),f=s.interpolate(n,i,s.minV,s.maxV),d=s.interpolate(e,i,s.minV,s.maxV);s.polygons_full&&(r.edges.br={path:[[a,0],[0,l]],move:{x:-1,y:0,enter:"rt"}},r.edges.tl={path:[[f,1],[1,d]],move:{x:1,y:0,enter:"lb"}}),s.polygons&&r.polygons.push([[a,0],[0,l],[0,1],[f,1],[1,d],[1,0]])},heptagon_tr:function(r,t,e,i,n,s){var a=s.interpolate_a(t,e,s.minV,s.maxV),l=s.interpolate_b(t,e,s.minV,s.maxV),f=s.interpolate_a(t,n,s.minV,s.maxV),d=s.interpolate_b(t,n,s.minV,s.maxV),g=s.interpolate(n,i,s.minV,s.maxV),m=s.interpolate(e,i,s.minV,s.maxV);s.polygons_full&&(r.edges.bl={path:[[a,0],[0,f]],move:{x:-1,y:0,enter:"rb"}},r.edges.lt={path:[[0,d],[g,1]],move:{x:0,y:1,enter:"br"}},r.edges.rt={path:[[1,m],[l,0]],move:{x:0,y:-1,enter:"tr"}}),s.polygons&&r.polygons.push([[a,0],[0,f],[0,d],[g,1],[1,1],[1,m],[l,0]])},heptagon_bl:function(r,t,e,i,n,s){var a=s.interpolate(t,e,s.minV,s.maxV),l=s.interpolate(t,n,s.minV,s.maxV),f=s.interpolate_a(n,i,s.minV,s.maxV),d=s.interpolate_b(n,i,s.minV,s.maxV),g=s.interpolate_b(e,i,s.minV,s.maxV),m=s.interpolate_a(e,i,s.minV,s.maxV);s.polygons_full&&(r.edges.lb={path:[[0,l],[f,1]],move:{x:0,y:1,enter:"bl"}},r.edges.tr={path:[[d,1],[1,g]],move:{x:1,y:0,enter:"lt"}},r.edges.rb={path:[[1,m],[a,0]],move:{x:0,y:-1,enter:"tl"}}),s.polygons&&r.polygons.push([[0,0],[0,l],[f,1],[d,1],[1,g],[1,m],[a,0]])},heptagon_tl:function(r,t,e,i,n,s){var a=s.interpolate_a(t,e,s.minV,s.maxV),l=s.interpolate_b(t,e,s.minV,s.maxV),f=s.interpolate(t,n,s.minV,s.maxV),d=s.interpolate(n,i,s.minV,s.maxV),g=s.interpolate_b(e,i,s.minV,s.maxV),m=s.interpolate_a(e,i,s.minV,s.maxV);s.polygons_full&&(r.edges.bl={path:[[a,0],[0,f]],move:{x:-1,y:0,enter:"rt"}},r.edges.tl={path:[[d,1],[1,g]],move:{x:1,y:0,enter:"lt"}},r.edges.rb={path:[[1,m],[l,0]],move:{x:0,y:-1,enter:"tr"}}),s.polygons&&r.polygons.push([[a,0],[0,f],[0,1],[d,1],[1,g],[1,m],[l,0]])},heptagon_br:function(r,t,e,i,n,s){var a=s.interpolate(t,e,s.minV,s.maxV),l=s.interpolate_a(t,n,s.minV,s.maxV),f=s.interpolate_b(t,n,s.minV,s.maxV),d=s.interpolate_a(n,i,s.minV,s.maxV),g=s.interpolate_b(n,i,s.minV,s.maxV),m=s.interpolate(e,i,s.minV,s.maxV);s.polygons_full&&(r.edges.br={path:[[a,0],[0,l]],move:{x:-1,y:0,enter:"rb"}},r.edges.lt={path:[[0,f],[d,1]],move:{x:0,y:1,enter:"bl"}},r.edges.tr={path:[[g,1],[1,m]],move:{x:1,y:0,enter:"lb"}}),s.polygons&&r.polygons.push([[a,0],[0,l],[0,f],[d,1],[g,1],[1,m],[1,0]])},octagon:function(r,t,e,i,n,s){var a=s.interpolate_a(t,e,s.minV,s.maxV),l=s.interpolate_b(t,e,s.minV,s.maxV),f=s.interpolate_a(t,n,s.minV,s.maxV),d=s.interpolate_b(t,n,s.minV,s.maxV),g=s.interpolate_a(n,i,s.minV,s.maxV),m=s.interpolate_b(n,i,s.minV,s.maxV),v=s.interpolate_b(e,i,s.minV,s.maxV),_=s.interpolate_a(e,i,s.minV,s.maxV);s.polygons_full&&(r.edges.bl={path:[[a,0],[0,f]],move:{x:-1,y:0,enter:"rb"}},r.edges.lt={path:[[0,d],[g,1]],move:{x:0,y:1,enter:"bl"}},r.edges.tr={path:[[m,1],[1,v]],move:{x:1,y:0,enter:"lt"}},r.edges.rb={path:[[1,_],[l,0]],move:{x:0,y:-1,enter:"tr"}}),s.polygons&&r.polygons.push([[a,0],[0,f],[0,d],[g,1],[m,1],[1,v],[1,_],[l,0]])}};function hk(r,t,e,i){var n,s,a,l=!1,f=null,d=null,g=null,m=null,v=!1,_=[],w=[],b=[];if(!r)throw new Error("data is required");if(t==null)throw new Error("lowerBound is required");if(e==null)throw new Error("bandWidth is required");if(a=ik(i),r instanceof Fh)f=r,d=r.root,g=r.data,a.noQuadTree||(l=!0);else if(Array.isArray(r)&&Array.isArray(r[0]))g=r;else throw new Error("input is neither array of arrays nor object retrieved from 'QuadTree()'");if(Array.isArray(t)){for(v=!0,a.noQuadTree||(l=!0),n=0;n<t.length;n++)if(isNaN(+t[n]))throw new Error("lowerBound["+n+"] is not a number");if(Array.isArray(e)){if(t.length!==e.length)throw new Error("lowerBound and bandWidth have unequal lengths");for(n=0;n<e.length;n++)if(isNaN(+e[n]))throw new Error("bandWidth["+n+"] is not a number")}else{if(isNaN(+e))throw new Error("bandWidth must be a number");for(_=[],n=0;n<t.length;n++)_.push(e);e=_}}else{if(isNaN(+t))throw new Error("lowerBound must be a number");if(t=[t],isNaN(+e))throw new Error("bandWidth must be a number");e=[e]}return l&&!d&&(f=new Fh(g),d=f.root,g=f.data),a.verbose&&(a.polygons?console.log("MarchingSquaresJS-isoBands: returning single polygons for each grid cell"):console.log("MarchingSquaresJS-isoBands: returning polygon paths for entire data grid"),v&&console.log("MarchingSquaresJS-isoBands: multiple bands requested, returning array of band polygons instead of polygons for a single band")),t.forEach(function(S,N){if(w=[],a.minV=S,a.maxV=S+e[N],a.verbose&&console.log("MarchingSquaresJS-isoBands: computing isobands for ["+S+":"+(S+e[N])+"]"),a.polygons)if(l)d.cellsInBand(a.minV,a.maxV,!0).forEach(function(k){w=w.concat(Bh(Ul(g,k.x,k.y,a),k.x,k.y,a))});else for(s=0;s<g.length-1;++s)for(n=0;n<g[0].length-1;++n)w=w.concat(Bh(Ul(g,n,s,a),n,s,a));else{for(m=[],n=0;n<g[0].length-1;++n)m[n]=[];if(l)d.cellsInBand(a.minV,a.maxV,!1).forEach(function(k){m[k.x][k.y]=Ul(g,k.x,k.y,a)});else for(n=0;n<g[0].length-1;++n)for(s=0;s<g.length-1;++s)m[n][s]=Ul(g,n,s,a);w=ak(g,m,a)}v?b.push(w):b=w,typeof a.successCallback=="function"&&a.successCallback(b,S,e[N])}),b}function ui(r,t,e,i,n,s){var a=(i+e+t+r)/4;return a>s?2:a<n?0:1}function Ul(r,t,e,i){var n,s,a=0,l=r[e+1][t],f=r[e+1][t+1],d=r[e][t+1],g=r[e][t],m=i.minV,v=i.maxV;if(!(isNaN(g)||isNaN(d)||isNaN(f)||isNaN(l))){switch(a|=l<m?0:l>v?128:64,a|=f<m?0:f>v?32:16,a|=d<m?0:d>v?8:4,a|=g<m?0:g>v?2:1,a=+a,s=0,n={cval:a,polygons:[],edges:{},x0:g,x1:d,x2:f,x3:l,x:t,y:e},a){case 85:It.square(n,g,d,f,l,i);case 0:case 170:break;case 169:It.triangle_bl(n,g,d,f,l,i);break;case 166:It.triangle_br(n,g,d,f,l,i);break;case 154:It.triangle_tr(n,g,d,f,l,i);break;case 106:It.triangle_tl(n,g,d,f,l,i);break;case 1:It.triangle_bl(n,g,d,f,l,i);break;case 4:It.triangle_br(n,g,d,f,l,i);break;case 16:It.triangle_tr(n,g,d,f,l,i);break;case 64:It.triangle_tl(n,g,d,f,l,i);break;case 168:It.tetragon_bl(n,g,d,f,l,i);break;case 162:It.tetragon_br(n,g,d,f,l,i);break;case 138:It.tetragon_tr(n,g,d,f,l,i);break;case 42:It.tetragon_tl(n,g,d,f,l,i);break;case 2:It.tetragon_bl(n,g,d,f,l,i);break;case 8:It.tetragon_br(n,g,d,f,l,i);break;case 32:It.tetragon_tr(n,g,d,f,l,i);break;case 128:It.tetragon_tl(n,g,d,f,l,i);break;case 5:It.tetragon_b(n,g,d,f,l,i);break;case 20:It.tetragon_r(n,g,d,f,l,i);break;case 80:It.tetragon_t(n,g,d,f,l,i);break;case 65:It.tetragon_l(n,g,d,f,l,i);break;case 165:It.tetragon_b(n,g,d,f,l,i);break;case 150:It.tetragon_r(n,g,d,f,l,i);break;case 90:It.tetragon_t(n,g,d,f,l,i);break;case 105:It.tetragon_l(n,g,d,f,l,i);break;case 160:It.tetragon_lr(n,g,d,f,l,i);break;case 130:It.tetragon_tb(n,g,d,f,l,i);break;case 10:It.tetragon_lr(n,g,d,f,l,i);break;case 40:It.tetragon_tb(n,g,d,f,l,i);break;case 101:It.pentagon_tr(n,g,d,f,l,i);break;case 149:It.pentagon_tl(n,g,d,f,l,i);break;case 86:It.pentagon_bl(n,g,d,f,l,i);break;case 89:It.pentagon_br(n,g,d,f,l,i);break;case 69:It.pentagon_tr(n,g,d,f,l,i);break;case 21:It.pentagon_tl(n,g,d,f,l,i);break;case 84:It.pentagon_bl(n,g,d,f,l,i);break;case 81:It.pentagon_br(n,g,d,f,l,i);break;case 96:It.pentagon_tr_rl(n,g,d,f,l,i);break;case 24:It.pentagon_rb_bt(n,g,d,f,l,i);break;case 6:It.pentagon_bl_lr(n,g,d,f,l,i);break;case 129:It.pentagon_lt_tb(n,g,d,f,l,i);break;case 74:It.pentagon_tr_rl(n,g,d,f,l,i);break;case 146:It.pentagon_rb_bt(n,g,d,f,l,i);break;case 164:It.pentagon_bl_lr(n,g,d,f,l,i);break;case 41:It.pentagon_lt_tb(n,g,d,f,l,i);break;case 66:It.pentagon_bl_tb(n,g,d,f,l,i);break;case 144:It.pentagon_lt_rl(n,g,d,f,l,i);break;case 36:It.pentagon_tr_bt(n,g,d,f,l,i);break;case 9:It.pentagon_rb_lr(n,g,d,f,l,i);break;case 104:It.pentagon_bl_tb(n,g,d,f,l,i);break;case 26:It.pentagon_lt_rl(n,g,d,f,l,i);break;case 134:It.pentagon_tr_bt(n,g,d,f,l,i);break;case 161:It.pentagon_rb_lr(n,g,d,f,l,i);break;case 37:It.hexagon_lt_tr(n,g,d,f,l,i);break;case 148:It.hexagon_bl_lt(n,g,d,f,l,i);break;case 82:It.hexagon_bl_rb(n,g,d,f,l,i);break;case 73:It.hexagon_tr_rb(n,g,d,f,l,i);break;case 133:It.hexagon_lt_tr(n,g,d,f,l,i);break;case 22:It.hexagon_bl_lt(n,g,d,f,l,i);break;case 88:It.hexagon_bl_rb(n,g,d,f,l,i);break;case 97:It.hexagon_tr_rb(n,g,d,f,l,i);break;case 145:It.hexagon_lt_rb(n,g,d,f,l,i);break;case 25:It.hexagon_lt_rb(n,g,d,f,l,i);break;case 70:It.hexagon_bl_tr(n,g,d,f,l,i);break;case 100:It.hexagon_bl_tr(n,g,d,f,l,i);break;case 17:s=ui(g,d,f,l,m,v),s===0?(It.triangle_bl(n,g,d,f,l,i),It.triangle_tr(n,g,d,f,l,i)):It.hexagon_lt_rb(n,g,d,f,l,i);break;case 68:s=ui(g,d,f,l,m,v),s===0?(It.triangle_tl(n,g,d,f,l,i),It.triangle_br(n,g,d,f,l,i)):It.hexagon_bl_tr(n,g,d,f,l,i);break;case 153:s=ui(g,d,f,l,m,v),s===2?(It.triangle_bl(n,g,d,f,l,i),It.triangle_tr(n,g,d,f,l,i)):It.hexagon_lt_rb(n,g,d,f,l,i);break;case 102:s=ui(g,d,f,l,m,v),s===2?(It.triangle_tl(n,g,d,f,l,i),It.triangle_br(n,g,d,f,l,i)):It.hexagon_bl_tr(n,g,d,f,l,i);break;case 152:s=ui(g,d,f,l,m,v),s===2?(It.triangle_tr(n,g,d,f,l,i),It.tetragon_bl(n,g,d,f,l,i)):It.heptagon_tr(n,g,d,f,l,i);break;case 137:s=ui(g,d,f,l,m,v),s===2?(It.triangle_bl(n,g,d,f,l,i),It.tetragon_tr(n,g,d,f,l,i)):It.heptagon_bl(n,g,d,f,l,i);break;case 98:s=ui(g,d,f,l,m,v),s===2?(It.triangle_tl(n,g,d,f,l,i),It.tetragon_br(n,g,d,f,l,i)):It.heptagon_tl(n,g,d,f,l,i);break;case 38:s=ui(g,d,f,l,m,v),s===2?(It.triangle_br(n,g,d,f,l,i),It.tetragon_tl(n,g,d,f,l,i)):It.heptagon_br(n,g,d,f,l,i);break;case 18:s=ui(g,d,f,l,m,v),s===0?(It.triangle_tr(n,g,d,f,l,i),It.tetragon_bl(n,g,d,f,l,i)):It.heptagon_tr(n,g,d,f,l,i);break;case 33:s=ui(g,d,f,l,m,v),s===0?(It.triangle_bl(n,g,d,f,l,i),It.tetragon_tr(n,g,d,f,l,i)):It.heptagon_bl(n,g,d,f,l,i);break;case 72:s=ui(g,d,f,l,m,v),s===0?(It.triangle_tl(n,g,d,f,l,i),It.tetragon_br(n,g,d,f,l,i)):It.heptagon_tl(n,g,d,f,l,i);break;case 132:s=ui(g,d,f,l,m,v),s===0?(It.triangle_br(n,g,d,f,l,i),It.tetragon_tl(n,g,d,f,l,i)):It.heptagon_br(n,g,d,f,l,i);break;case 136:s=ui(g,d,f,l,m,v),s===0?(It.tetragon_tl(n,g,d,f,l,i),It.tetragon_br(n,g,d,f,l,i)):s===1?It.octagon(n,g,d,f,l,i):(It.tetragon_bl(n,g,d,f,l,i),It.tetragon_tr(n,g,d,f,l,i));break;case 34:s=ui(g,d,f,l,m,v),s===0?(It.tetragon_bl(n,g,d,f,l,i),It.tetragon_tr(n,g,d,f,l,i)):s===1?It.octagon(n,g,d,f,l,i):(It.tetragon_tl(n,g,d,f,l,i),It.tetragon_br(n,g,d,f,l,i));break}return n}}var ck=Object.defineProperty,Bg=Object.getOwnPropertySymbols,fk=Object.prototype.hasOwnProperty,dk=Object.prototype.propertyIsEnumerable,Fg=(r,t,e)=>t in r?ck(r,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[t]=e,Ug=(r,t)=>{for(var e in t||(t={}))fk.call(t,e)&&Fg(r,e,t[e]);if(Bg)for(var e of Bg(t))dk.call(t,e)&&Fg(r,e,t[e]);return r};function pk(r,t){if(t=t||{},!ve(t))throw new Error("options is invalid");var e=t.zProperty||"elevation",i=t.flip,n=t.flags;gs(r,"Point","input must contain Points");for(var s=gk(r,i),a=[],l=0;l<s.length;l++){for(var f=s[l],d=[],g=0;g<f.length;g++){var m=f[g];m.properties[e]?d.push(m.properties[e]):d.push(0),n===!0&&(m.properties.matrixPosition=[l,g])}a.push(d)}return a}function gk(r,t){var e={};ye(r,function(s){var a=Jt(s)[1];e[a]||(e[a]=[]),e[a].push(s)});var i=Object.keys(e).map(function(s){var a=e[s],l=a.sort(function(f,d){return Jt(f)[0]-Jt(d)[0]});return l}),n=i.sort(function(s,a){return t?Jt(s[0])[1]-Jt(a[0])[1]:Jt(a[0])[1]-Jt(s[0])[1]});return n}function mk(r,t,e){if(e=e||{},!ve(e))throw new Error("options is invalid");const i=e.zProperty||"elevation",n=e.commonProperties||{},s=e.breaksProperties||[];if(gs(r,"Point","Input must contain Points"),!t)throw new Error("breaks is required");if(!Array.isArray(t))throw new Error("breaks is not an Array");if(!ve(n))throw new Error("commonProperties is not an Object");if(!Array.isArray(s))throw new Error("breaksProperties is not an Array");const a=pk(r,{zProperty:i,flip:!0});let l=yk(a,t,i);l=_k(l,a,r);const f=l.map((d,g)=>{if(s[g]&&!ve(s[g]))throw new Error("Each mappedProperty is required to be an Object");const m=Ug(Ug({},n),s[g]);return m[i]=d[i],pi(d.groupedRings,m)});return Yt(f)}function yk(r,t,e){const i=[];for(let n=1;n<t.length;n++){const s=+t[n-1],a=+t[n],l=hk(r,s,a-s),f=vk(l),d=xk(f);i.push({groupedRings:d,[e]:s+"-"+a})}return i}function _k(r,t,e){const i=Te(e),n=i[2]-i[0],s=i[3]-i[1],a=i[0],l=i[1],f=t[0].length-1,d=t.length-1,g=n/f,m=s/d;return r.map(function(v){return v.groupedRings=v.groupedRings.map(function(_){return _.map(function(w){return w.map(b=>[b[0]*g+a,b[1]*m+l])})}),v})}function vk(r){const t=r.map(function(e){return{ring:e,area:dl($t([e]))}});return t.sort(function(e,i){return i.area-e.area}),t.map(function(e){return e.ring})}function xk(r){const t=r.map(i=>({lrCoordinates:i,grouped:!1})),e=[];for(;!bk(t);)for(let i=0;i<t.length;i++)if(!t[i].grouped){const n=[];n.push(t[i].lrCoordinates),t[i].grouped=!0;const s=$t([t[i].lrCoordinates]);for(let a=i+1;a<t.length;a++)if(!t[a].grouped){const l=$t([t[a].lrCoordinates]);wk(l,s)&&(n.push(t[a].lrCoordinates),t[a].grouped=!0)}e.push(n)}return e}function wk(r,t){const e=rc(r);for(let i=0;i<e.features.length;i++)if(!ie(e.features[i],t))return!1;return!0}function bk(r){for(let t=0;t<r.length;t++)if(r[t].grouped===!1)return!1;return!0}var Ek=Object.defineProperty,Gg=Object.getOwnPropertySymbols,kk=Object.prototype.hasOwnProperty,Mk=Object.prototype.propertyIsEnumerable,Vg=(r,t,e)=>t in r?Ek(r,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[t]=e,qg=(r,t)=>{for(var e in t||(t={}))kk.call(t,e)&&Vg(r,e,t[e]);if(Gg)for(var e of Gg(t))Mk.call(t,e)&&Vg(r,e,t[e]);return r};function Lk(r,t){if(t=t||{},!ve(t))throw new Error("options is invalid");var e=t.zProperty||"elevation",i=t.flip,n=t.flags;gs(r,"Point","input must contain Points");for(var s=Sk(r,i),a=[],l=0;l<s.length;l++){for(var f=s[l],d=[],g=0;g<f.length;g++){var m=f[g];m.properties[e]?d.push(m.properties[e]):d.push(0),n===!0&&(m.properties.matrixPosition=[l,g])}a.push(d)}return a}function Sk(r,t){var e={};ye(r,function(s){var a=Jt(s)[1];e[a]||(e[a]=[]),e[a].push(s)});var i=Object.keys(e).map(function(s){var a=e[s],l=a.sort(function(f,d){return Jt(f)[0]-Jt(d)[0]});return l}),n=i.sort(function(s,a){return t?Jt(s[0])[1]-Jt(a[0])[1]:Jt(a[0])[1]-Jt(s[0])[1]});return n}function Tk(r,t,e){if(e=e||{},!ve(e))throw new Error("options is invalid");const i=e.zProperty||"elevation",n=e.commonProperties||{},s=e.breaksProperties||[];if(gs(r,"Point","Input must contain Points"),!t)throw new Error("breaks is required");if(!Array.isArray(t))throw new Error("breaks must be an Array");if(!ve(n))throw new Error("commonProperties must be an Object");if(!Array.isArray(s))throw new Error("breaksProperties must be an Array");const a=Lk(r,{zProperty:i,flip:!0}),l=Pk(a,t,i,n,s),f=Ik(l,a,r);return Yt(f)}function Pk(r,t,e,i,n){const s=[];for(let a=0;a<t.length;a++){const l=+t[a],f=qg(qg({},i),n[a]);f[e]=l;const d=no(lk(r,l,{linearRing:!1,noFrame:!0}),f);s.push(d)}return s}function Ik(r,t,e){const i=Te(e),n=i[2]-i[0],s=i[3]-i[1],a=i[0],l=i[1],f=t[0].length-1,d=t.length-1,g=n/f,m=s/d,v=_=>{_[0]=_[0]*g+a,_[1]=_[1]*m+l};return r.forEach(_=>{Fe(_,v)}),r}function Ck(r){let t,e;const i={type:"FeatureCollection",features:[]};if(r.type==="Feature"?e=r.geometry:e=r,e.type==="LineString")t=[e.coordinates];else if(e.type==="MultiLineString")t=e.coordinates;else if(e.type==="MultiPolygon")t=[].concat(...e.coordinates);else if(e.type==="Polygon")t=e.coordinates;else throw new Error("Input must be a LineString, MultiLineString, Polygon, or MultiPolygon Feature or Geometry");return t.forEach(n=>{t.forEach(s=>{for(let a=0;a<n.length-1;a++)for(let l=a;l<s.length-1;l++){if(n===s&&(Math.abs(a-l)===1||a===0&&l===n.length-2&&n[a][0]===n[n.length-1][0]&&n[a][1]===n[n.length-1][1]))continue;const f=Ak(n[a][0],n[a][1],n[a+1][0],n[a+1][1],s[l][0],s[l][1],s[l+1][0],s[l+1][1]);f&&i.features.push(re([f[0],f[1]]))}})}),i}function Ak(r,t,e,i,n,s,a,l){let f,d,g,m,v;const _={x:null,y:null,onLine1:!1,onLine2:!1};return f=(l-s)*(e-r)-(a-n)*(i-t),f===0?_.x!==null&&_.y!==null?_:!1:(d=t-s,g=r-n,m=(a-n)*d-(l-s)*g,v=(e-r)*d-(i-t)*g,d=m/f,g=v/f,_.x=r+d*(e-r),_.y=t+d*(i-t),d>=0&&d<=1&&(_.onLine1=!0),g>=0&&g<=1&&(_.onLine2=!0),_.onLine1&&_.onLine2?[_.x,_.y]:!1)}function hv(r,t={}){return bd(r,(e,i)=>{const n=i.geometry.coordinates;return e+we(n[0],n[1],t)},0)}function cv(r,t,e,i,n={}){const s=n.steps||64,a=Zg(e),l=Zg(i),f=!Array.isArray(r)&&r.type==="Feature"?r.properties:{};if(a===l)return ge(ml(r,t,n).geometry.coordinates[0],f);const d=a,g=a<l?l:l+360;let m=d;const v=[];let _=0;const w=(g-d)/s;for(;m<=g;)v.push(Fo(r,t,m,n).geometry.coordinates),_++,m=d+_*w;return ge(v,f)}function Zg(r){let t=r%360;return t<0&&(t+=360),t}function fv(r,t,e,i){if(i=i||{},!ve(i))throw new Error("options is invalid");var n,s=[];if(r.type==="Feature")n=r.geometry.coordinates;else if(r.type==="LineString")n=r.coordinates;else throw new Error("input must be a LineString Feature or Geometry");for(var a=n.length,l=0,f,d,g,m=0;m<n.length&&!(t>=l&&m===n.length-1);m++){if(l>t&&s.length===0){if(f=t-l,!f)return s.push(n[m]),ge(s);d=js(n[m],n[m-1])-180,g=Fo(n[m],f,d,i),s.push(g.geometry.coordinates)}if(l>=e)return f=e-l,f?(d=js(n[m],n[m-1])-180,g=Fo(n[m],f,d,i),s.push(g.geometry.coordinates),ge(s)):(s.push(n[m]),ge(s));if(l>=t&&s.push(n[m]),m===n.length-1)return ge(s);l+=we(n[m],n[m+1],i)}if(l<t&&n.length===a)throw new Error("Start position is beyond line");var v=n[n.length-1];return ge([v,v])}function Nk(r,t,e){if(e=e||{},!ve(e))throw new Error("options is invalid");var i=e.units,n=e.reverse;if(!r)throw new Error("geojson is required");if(t<=0)throw new Error("segmentLength must be greater than 0");var s=[];return vn(r,function(a){n&&(a.geometry.coordinates=a.geometry.coordinates.reverse()),Ok(a,t,i,function(l){s.push(l)})}),Yt(s)}function Ok(r,t,e,i){var n=hv(r,{units:e});if(n<=t)return i(r);var s=n/t;Number.isInteger(s)||(s=Math.floor(s)+1);for(var a=0;a<s;a++){var l=fv(r,t*a,t*(a+1),{units:e});i(l,a)}}function Uh(r){var t=r[0],e=r[1];return[e[0]-t[0],e[1]-t[1]]}function Ff(r,t){return r[0]*t[1]-t[0]*r[1]}function Rk(r,t){return[r[0]+t[0],r[1]+t[1]]}function Dk(r,t){return[r[0]-t[0],r[1]-t[1]]}function zk(r,t){return[r*t[0],r*t[1]]}function Bk(r,t){var e=r[0],i=Uh(r),n=t[0],s=Uh(t),a=Ff(i,s),l=Dk(n,e),f=Ff(l,s),d=f/a,g=Rk(e,zk(d,i));return g}function Fk(r,t){var e=Uh(r),i=Uh(t);return Ff(e,i)===0}function Uk(r,t){return Fk(r,t)?!1:Bk(r,t)}function Gk(r,t,e){if(e=e||{},!ve(e))throw new Error("options is invalid");var i=e.units;if(!r)throw new Error("geojson is required");if(t==null||isNaN(t))throw new Error("distance is required");var n=gi(r),s=r.properties;switch(n){case"LineString":return Hg(r,t,i);case"MultiLineString":var a=[];return vn(r,function(l){a.push(Hg(l,t,i).geometry.coordinates)}),no(a,s);default:throw new Error("geometry "+n+" is not supported")}}function Hg(r,t,e){var i=[],n=Qh(t,e),s=Jt(r),a=[];return s.forEach(function(l,f){if(f!==s.length-1){var d=Vk(l,s[f+1],n);if(i.push(d),f>0){var g=i[f-1],m=Uk(d,g);m!==!1&&(g[1]=m,d[0]=m),a.push(g[0]),f===s.length-2&&(a.push(d[0]),a.push(d[1]))}s.length===2&&(a.push(d[0]),a.push(d[1]))}}),ge(a,r.properties)}function Vk(r,t,e){var i=Math.sqrt((r[0]-t[0])*(r[0]-t[0])+(r[1]-t[1])*(r[1]-t[1])),n=r[0]+e*(t[1]-r[1])/i,s=t[0]+e*(t[1]-r[1])/i,a=r[1]+e*(r[0]-t[0])/i,l=t[1]+e*(r[0]-t[0])/i;return[[n,a],[s,l]]}function qk(r,t,e){var i=Jt(e);if(gi(e)!=="LineString")throw new Error("line must be a LineString");var n=os(e,r),s=os(e,t),a;n.properties.index<=s.properties.index?a=[n,s]:a=[s,n];for(var l=[a[0].geometry.coordinates],f=a[0].properties.index+1;f<a[1].properties.index+1;f++)l.push(i[f]);return l.push(a[1].geometry.coordinates),ge(l,e.properties)}function dv(r){var t=r[0],e=r[1],i=r[2],n=r[3],s=we(r.slice(0,2),[i,e]),a=we(r.slice(0,2),[t,n]);if(s>=a){var l=(e+n)/2;return[t,l-(i-t)/2,i,l+(i-t)/2]}else{var f=(t+i)/2;return[f-(n-e)/2,e,f+(n-e)/2,n]}}function pv(r,t){if(t=t??{},!ve(t))throw new Error("options is invalid");var e=t.precision,i=t.coordinates,n=t.mutate;if(e=e==null||isNaN(e)?6:e,i=i==null||isNaN(i)?3:i,!r)throw new Error("<geojson> is required");if(typeof e!="number")throw new Error("<precision> must be a number");if(typeof i!="number")throw new Error("<coordinates> must be a number");(n===!1||n===void 0)&&(r=JSON.parse(JSON.stringify(r)));var s=Math.pow(10,e);return Fe(r,function(a){Zk(a,s,i)}),r}function Zk(r,t,e){r.length>e&&r.splice(e,r.length);for(var i=0;i<r.length;i++)r[i]=Math.round(r[i]*t)/t;return r}function Hk(r,t){if(!r)throw new Error("line is required");if(!t)throw new Error("splitter is required");var e=gi(r),i=gi(t);if(e!=="LineString")throw new Error("line must be LineString");if(i==="FeatureCollection")throw new Error("splitter cannot be a FeatureCollection");if(i==="GeometryCollection")throw new Error("splitter cannot be a GeometryCollection");var n=pv(t,{precision:7});switch(i){case"Point":return Uf(r,n);case"MultiPoint":return Yg(r,n);case"LineString":case"MultiLineString":case"Polygon":case"MultiPolygon":return Yg(r,Or(r,n,{ignoreSelfIntersections:!0}))}}function Yg(r,t){var e=[],i=tc();return vn(t,function(n){if(e.forEach(function(l,f){l.id=f}),!e.length)e=Uf(r,n).features,e.forEach(function(l){l.bbox||(l.bbox=dv(Te(l)))}),i.load(Yt(e));else{var s=i.search(n);if(s.features.length){var a=gv(n,s);e=e.filter(function(l){return l.id!==a.id}),i.remove(a),ye(Uf(a,n),function(l){e.push(l),i.insert(l)})}}}),Yt(e)}function Uf(r,t){var e=[],i=Jt(r)[0],n=Jt(r)[r.geometry.coordinates.length-1];if(Bc(i,me(t))||Bc(n,me(t)))return Yt([r]);var s=tc(),a=Ku(r);s.load(a);var l=s.search(t);if(!l.features.length)return Yt([r]);var f=gv(t,l),d=[i],g=xd(a,function(m,v,_){var w=Jt(v)[1],b=me(t);return _===f.id?(m.push(b),e.push(ge(m)),Bc(b,w)?[b]:[b,w]):(m.push(w),m)},d);return g.length>1&&e.push(ge(g)),Yt(e)}function gv(r,t){if(!t.features.length)throw new Error("lines must contain features");if(t.features.length===1)return t.features[0];var e,i=1/0;return ye(t,function(n){var s=os(n,r),a=s.properties.dist;a<i&&(e=n,i=a)}),e}function Bc(r,t){return r[0]===t[0]&&r[1]===t[1]}function Yk(r,t={}){var e,i,n,s=t.properties,a=(e=t.autoComplete)!=null?e:!0,l=(i=t.orderCoords)!=null?i:!0,f=(n=t.mutate)!=null?n:!1;switch(f||(r=bn(r)),r.type){case"FeatureCollection":var d=[];return r.features.forEach(function(g){d.push(Jt(Xg(g,{},a,l)))}),pi(d,s);default:return Xg(r,s,a,l)}}function Xg(r,t,e,i){t=t||(r.type==="Feature"?r.properties:{});var n=Ae(r),s=n.coordinates,a=n.type;if(!s.length)throw new Error("line must contain coordinates");switch(a){case"LineString":return e&&(s=Wg(s)),$t([s],t);case"MultiLineString":var l=[],f=0;return s.forEach(function(d){if(e&&(d=Wg(d)),i){var g=Xk(Te(ge(d)));g>f?(l.unshift(d),f=g):l.push(d)}else l.push(d)}),$t(l,t);default:throw new Error("geometry type "+a+" is not supported")}}function Wg(r){var t=r[0],e=t[0],i=t[1],n=r[r.length-1],s=n[0],a=n[1];return(e!==s||i!==a)&&r.push(t),r}function Xk(r){var t=r[0],e=r[1],i=r[2],n=r[3];return Math.abs(t-i)*Math.abs(e-n)}function Wk(r,t,e){var i;const n=(i=e==null?void 0:e.mutate)!=null?i:!1;let s=t;t&&n===!1&&(s=bn(t));const a=Jk(s);let l=null;return r.type==="FeatureCollection"?l=$k(r):r.type==="Feature"?l=Gf(Ks(r.geometry.coordinates)):l=Gf(Ks(r.coordinates)),l.geometry.coordinates.forEach(function(f){a.geometry.coordinates.push(f[0])}),a}function $k(r){const t=r.features.length===2?Ks(r.features[0].geometry.coordinates,r.features[1].geometry.coordinates):Ks.apply(VE,r.features.map(function(e){return e.geometry.coordinates}));return Gf(t)}function Gf(r){return pi(r)}function Jk(r){let e=[[[180,90],[-180,90],[-180,-90],[180,-90],[180,90]]];return r&&(r.type==="Feature"?e=r.geometry.coordinates:e=r.coordinates),$t(e)}function jk(r,t){const e=we(r,t),i=js(r,t);return Fo(r,e/2,i)}function Kk(r,t){var e,i;const n=t.inputField,s=t.threshold||1e5,a=t.p||2,l=(e=t.binary)!=null?e:!1,f=t.alpha||-1,d=(i=t.standardization)!=null?i:!0,g=K_(r,{alpha:f,binary:l,p:a,standardization:d,threshold:s}),m=[];ye(r,B=>{const V=B.properties||{};m.push(V[n])});const v=mv(m),_=Qk(m);let w=0,b=0,S=0,N=0;const k=g.length;for(let B=0;B<k;B++){let V=0;for(let z=0;z<k;z++)w+=g[B][z]*(m[B]-v)*(m[z]-v),b+=g[B][z],S+=Math.pow(g[B][z]+g[z][B],2),V+=g[B][z]+g[z][B];N+=Math.pow(V,2)}S=.5*S;const C=w/b/_,A=-1/(k-1),P=k*k*S-k*N+3*(b*b),q=(k-1)*(k+1)*(b*b),U=P/q-A*A,I=Math.sqrt(U),O=(C-A)/I;return{expectedMoranIndex:A,moranIndex:C,stdNorm:I,zNorm:O}}function mv(r){let t=0;for(const e of r)t+=e;return t/r.length}function Qk(r){const t=mv(r);let e=0;for(const i of r)e+=Math.pow(i-t,2);return e/r.length}var tM=Object.defineProperty,eM=Object.defineProperties,nM=Object.getOwnPropertyDescriptors,$g=Object.getOwnPropertySymbols,iM=Object.prototype.hasOwnProperty,rM=Object.prototype.propertyIsEnumerable,Jg=(r,t,e)=>t in r?tM(r,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[t]=e,jg=(r,t)=>{for(var e in t||(t={}))iM.call(t,e)&&Jg(r,e,t[e]);if($g)for(var e of $g(t))rM.call(t,e)&&Jg(r,e,t[e]);return r},Kg=(r,t)=>eM(r,nM(t));function sc(r,t,e={}){if(!r)throw new Error("targetPoint is required");if(!t)throw new Error("points is required");let i=1/0,n=0;ye(t,(a,l)=>{const f=we(r,a,e);f<i&&(n=l,i=f)});const s=bn(t.features[n]);return Kg(jg({},s),{properties:Kg(jg({},s.properties),{featureIndex:n,distanceToPoint:i})})}function sM(r,t){t=t||{};const e=t.studyArea||pl(Te(r)),i=t.properties||{},n=t.units||"kilometers",s=[];ye(r,m=>{s.push(Dr(m))});const a=s.length,l=s.map((m,v)=>{const _=Yt(s.filter((w,b)=>b!==v));return we(m,sc(m,_).geometry.coordinates,{units:n})}).reduce((m,v)=>m+v,0)/a,f=a/md(dl(e),"meters",n),d=1/(2*Math.sqrt(f)),g=.26136/Math.sqrt(a*f);return i.nearestNeighborAnalysis={units:n,arealUnits:n+"",observedMeanDistance:l,expectedMeanDistance:d,nearestNeighborIndex:l/d,numberOfPoints:a,zScore:(l-d)/g},e.properties=i,e}function Ud(r,t,e={}){var i,n;const s=(i=e.method)!=null?i:"geodesic",a=(n=e.units)!=null?n:"kilometers";if(!r)throw new Error("pt is required");if(Array.isArray(r)?r=re(r):r.type==="Point"?r=Qe(r):Ju(r,"Point","point"),!t)throw new Error("line is required");Array.isArray(t)?t=ge(t):t.type==="LineString"?t=Qe(t):Ju(t,"LineString","line");let l=1/0;const f=r.geometry.coordinates;return ss(t,d=>{if(d){const g=d.geometry.coordinates[0],m=d.geometry.coordinates[1],v=oM(f,g,m,{method:s});v<l&&(l=v)}}),Bo(l,"degrees",a)}function oM(r,t,e,i){if(i.method==="geodesic")return os(ge([t,e]).geometry,r,{units:"degrees"}).properties.dist;const n=[e[0]-t[0],e[1]-t[1]],s=[r[0]-t[0],r[1]-t[1]],a=Qg(s,n);if(a<=0)return Xs(r,t,{units:"degrees"});const l=Qg(n,n);if(l<=a)return Xs(r,e,{units:"degrees"});const f=a/l,d=[t[0]+f*n[0],t[1]+f*n[1]];return Xs(r,d,{units:"degrees"})}function Qg(r,t){return r[0]*t[0]+r[1]*t[1]}var aM=Object.defineProperty,tm=Object.getOwnPropertySymbols,uM=Object.prototype.hasOwnProperty,lM=Object.prototype.propertyIsEnumerable,em=(r,t,e)=>t in r?aM(r,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[t]=e,Fc=(r,t)=>{for(var e in t||(t={}))uM.call(t,e)&&em(r,e,t[e]);if(tm)for(var e of tm(t))lM.call(t,e)&&em(r,e,t[e]);return r};function hM(r,t,e={}){const i=e.units,n=e.properties||{},s=cM(r);if(!s.features.length)throw new Error("points must contain features");if(!t)throw new Error("line is required");if(gi(t)!=="LineString")throw new Error("line must be a LineString");let a=1/0,l=null;return ye(s,f=>{const d=Ud(f,t,{units:i});d<a&&(a=d,l=f)}),l&&(l.properties=Fc(Fc(Fc({},{dist:a}),l.properties),n)),l}function cM(r){const t=[];switch(r.geometry?r.geometry.type:r.type){case"GeometryCollection":return Rn(r,i=>{i.type==="Point"&&t.push({type:"Feature",properties:{},geometry:i})}),{type:"FeatureCollection",features:t};case"FeatureCollection":return r.features=r.features.filter(i=>i.geometry.type==="Point"),r;default:throw new Error("points must be a Point Collection")}}function fM(r,t){const e=me(r),s=Ae(t).coordinates[0];if(s.length<4)throw new Error("OuterRing of a Polygon must have 4 or more Positions.");const a=t.type==="Feature"&&t.properties||{},l=a.a,f=a.b,d=a.c,g=e[0],m=e[1],v=s[0][0],_=s[0][1],w=l!==void 0?l:s[0][2],b=s[1][0],S=s[1][1],N=f!==void 0?f:s[1][2],k=s[2][0],C=s[2][1],A=d!==void 0?d:s[2][2];return(A*(g-v)*(m-S)+w*(g-b)*(m-C)+N*(g-k)*(m-_)-N*(g-v)*(m-C)-A*(g-b)*(m-_)-w*(g-k)*(m-S))/((g-v)*(m-S)+(g-b)*(m-C)+(g-k)*(m-_)-(g-v)*(m-C)-(g-b)*(m-_)-(g-k)*(m-S))}function dM(r){const t=pM(r),e=ec(t);let i=!1,n=0;for(;!i&&n<t.features.length;){const s=t.features[n].geometry;let a,l,f,d,g,m,v=!1;if(s.type==="Point")e.geometry.coordinates[0]===s.coordinates[0]&&e.geometry.coordinates[1]===s.coordinates[1]&&(i=!0);else if(s.type==="MultiPoint"){let _=!1,w=0;for(;!_&&w<s.coordinates.length;)e.geometry.coordinates[0]===s.coordinates[w][0]&&e.geometry.coordinates[1]===s.coordinates[w][1]&&(i=!0,_=!0),w++}else if(s.type==="LineString"){let _=0;for(;!v&&_<s.coordinates.length-1;)a=e.geometry.coordinates[0],l=e.geometry.coordinates[1],f=s.coordinates[_][0],d=s.coordinates[_][1],g=s.coordinates[_+1][0],m=s.coordinates[_+1][1],nm(a,l,f,d,g,m)&&(v=!0,i=!0),_++}else if(s.type==="MultiLineString"){let _=0;for(;_<s.coordinates.length;){v=!1;let w=0;const b=s.coordinates[_];for(;!v&&w<b.length-1;)a=e.geometry.coordinates[0],l=e.geometry.coordinates[1],f=b[w][0],d=b[w][1],g=b[w+1][0],m=b[w+1][1],nm(a,l,f,d,g,m)&&(v=!0,i=!0),w++;_++}}else(s.type==="Polygon"||s.type==="MultiPolygon")&&ie(e,s)&&(i=!0);n++}if(i)return e;{const s=Yt([]);for(let a=0;a<t.features.length;a++)s.features=s.features.concat(rc(t.features[a]).features);return re(sc(e,s).geometry.coordinates)}}function pM(r){return r.type!=="FeatureCollection"?r.type!=="Feature"?Yt([Qe(r)]):Yt([r]):r}function nm(r,t,e,i,n,s){const a=Math.sqrt((n-e)*(n-e)+(s-i)*(s-i)),l=Math.sqrt((r-e)*(r-e)+(t-i)*(t-i)),f=Math.sqrt((n-r)*(n-r)+(s-t)*(s-t));return a===l+f}function yv(r,t){const e=[];return ye(r,function(i){let n=!1;if(i.geometry.type==="Point")Rn(t,function(a){ie(i,a)&&(n=!0)}),n&&e.push(i);else if(i.geometry.type==="MultiPoint"){var s=[];Rn(t,function(a){Fe(i,function(l){ie(l,a)&&(n=!0,s.push(l))})}),n&&e.push(cl(s,i.properties))}else throw new Error("Input geometry must be a Point or MultiPoint")}),Yt(e)}function Vf(r,t,e={}){var i,n;const s=(i=e.method)!=null?i:"geodesic",a=(n=e.units)!=null?n:"kilometers";if(!r)throw new Error("point is required");if(!t)throw new Error("polygon or multi-polygon is required");const l=Ae(t);if(l.type==="MultiPolygon"){const g=l.coordinates.map(m=>Vf(r,$t(m),{method:s,units:a}));return Math.min(...g.map(Math.abs))*(ie(r,t)?-1:1)}if(l.coordinates.length>1){const[g,...m]=l.coordinates.map(_=>Vf(r,$t([_]),{method:s,units:a}));if(g>=0)return g;const v=Math.min(...m);return v<0?Math.abs(v):Math.min(v,Math.abs(g))}const f=Ua(l);let d=1/0;return vn(f,g=>{d=Math.min(d,Ud(r,g,{method:s,units:a}))}),ie(r,l)?-d:d}function gM(r){return(r>0)-(r<0)||+r}function Gd(r,t,e){const i=t[0]-r[0],n=t[1]-r[1],s=e[0]-t[0],a=e[1]-t[1];return gM(i*a-s*n)}function mM(r,t){const e=r.geometry.coordinates[0].map(a=>a[0]),i=r.geometry.coordinates[0].map(a=>a[1]),n=t.geometry.coordinates[0].map(a=>a[0]),s=t.geometry.coordinates[0].map(a=>a[1]);return Math.max.apply(null,e)===Math.max.apply(null,n)&&Math.max.apply(null,i)===Math.max.apply(null,s)&&Math.min.apply(null,e)===Math.min.apply(null,n)&&Math.min.apply(null,i)===Math.min.apply(null,s)}function im(r,t){return t.geometry.coordinates[0].every(e=>ie(re(e),r))}function yM(r,t){return r[0]===t[0]&&r[1]===t[1]}var rm=class _v{static buildId(t){return t.join(",")}constructor(t){this.id=_v.buildId(t),this.coordinates=t,this.innerEdges=[],this.outerEdges=[],this.outerEdgesSorted=!1}removeInnerEdge(t){this.innerEdges=this.innerEdges.filter(e=>e.from.id!==t.from.id)}removeOuterEdge(t){this.outerEdges=this.outerEdges.filter(e=>e.to.id!==t.to.id)}addOuterEdge(t){this.outerEdges.push(t),this.outerEdgesSorted=!1}sortOuterEdges(){this.outerEdgesSorted||(this.outerEdges.sort((t,e)=>{const i=t.to,n=e.to;if(i.coordinates[0]-this.coordinates[0]>=0&&n.coordinates[0]-this.coordinates[0]<0)return 1;if(i.coordinates[0]-this.coordinates[0]<0&&n.coordinates[0]-this.coordinates[0]>=0)return-1;if(i.coordinates[0]-this.coordinates[0]===0&&n.coordinates[0]-this.coordinates[0]===0)return i.coordinates[1]-this.coordinates[1]>=0||n.coordinates[1]-this.coordinates[1]>=0?i.coordinates[1]-n.coordinates[1]:n.coordinates[1]-i.coordinates[1];const s=Gd(this.coordinates,i.coordinates,n.coordinates);if(s<0)return 1;if(s>0)return-1;const a=Math.pow(i.coordinates[0]-this.coordinates[0],2)+Math.pow(i.coordinates[1]-this.coordinates[1],2),l=Math.pow(n.coordinates[0]-this.coordinates[0],2)+Math.pow(n.coordinates[1]-this.coordinates[1],2);return a-l}),this.outerEdgesSorted=!0)}getOuterEdges(){return this.sortOuterEdges(),this.outerEdges}getOuterEdge(t){return this.sortOuterEdges(),this.outerEdges[t]}addInnerEdge(t){this.innerEdges.push(t)}},_M=class vv{getSymetric(){return this.symetric||(this.symetric=new vv(this.to,this.from),this.symetric.symetric=this),this.symetric}constructor(t,e){this.from=t,this.to=e,this.next=void 0,this.label=void 0,this.symetric=void 0,this.ring=void 0,this.from.addOuterEdge(this),this.to.addInnerEdge(this)}deleteEdge(){this.from.removeOuterEdge(this),this.to.removeInnerEdge(this)}isEqual(t){return this.from.id===t.from.id&&this.to.id===t.to.id}toString(){return`Edge { ${this.from.id} -> ${this.to.id} }`}toLineString(){return ge([this.from.coordinates,this.to.coordinates])}compareTo(t){return Gd(t.from.coordinates,t.to.coordinates,this.to.coordinates)}},xv=class{constructor(){this.edges=[],this.polygon=void 0,this.envelope=void 0}push(r){this.edges.push(r),this.polygon=this.envelope=void 0}get(r){return this.edges[r]}get length(){return this.edges.length}forEach(r){this.edges.forEach(r)}map(r){return this.edges.map(r)}some(r){return this.edges.some(r)}isValid(){return!0}isHole(){const r=this.edges.reduce((n,s,a)=>(s.from.coordinates[1]>this.edges[n].from.coordinates[1]&&(n=a),n),0),t=(r===0?this.length:r)-1,e=(r+1)%this.length,i=Gd(this.edges[t].from.coordinates,this.edges[r].from.coordinates,this.edges[e].from.coordinates);return i===0?this.edges[t].from.coordinates[0]>this.edges[e].from.coordinates[0]:i>0}toMultiPoint(){return cl(this.edges.map(r=>r.from.coordinates))}toPolygon(){if(this.polygon)return this.polygon;const r=this.edges.map(t=>t.from.coordinates);return r.push(this.edges[0].from.coordinates),this.polygon=$t([r])}getEnvelope(){return this.envelope?this.envelope:this.envelope=ev(this.toPolygon())}static findEdgeRingContaining(r,t){const e=r.getEnvelope();let i,n;return t.forEach(s=>{const a=s.getEnvelope();if(n&&(i=n.getEnvelope()),!mM(a,e)&&im(a,e)){const l=r.map(d=>d.from.coordinates);let f;for(const d of l)s.some(g=>yM(d,g.from.coordinates))||(f=d);f&&s.inside(re(f))&&(!n||im(i,a))&&(n=s)}}),n}inside(r){return ie(r,this.toPolygon())}};function vM(r){if(!r)throw new Error("No geojson passed");if(r.type!=="FeatureCollection"&&r.type!=="GeometryCollection"&&r.type!=="MultiLineString"&&r.type!=="LineString"&&r.type!=="Feature")throw new Error(`Invalid input type '${r.type}'. Geojson must be FeatureCollection, GeometryCollection, LineString, MultiLineString or Feature`)}var xM=class wv{static fromGeoJson(t){vM(t);const e=new wv;return vn(t,i=>{Ju(i,"LineString","Graph::fromGeoJson"),_d(i,(n,s)=>{if(n){const a=e.getNode(n),l=e.getNode(s);e.addEdge(a,l)}return s})}),e}getNode(t){const e=rm.buildId(t);let i=this.nodes[e];return i||(i=this.nodes[e]=new rm(t)),i}addEdge(t,e){const i=new _M(t,e),n=i.getSymetric();this.edges.push(i),this.edges.push(n)}constructor(){this.edges=[],this.nodes={}}deleteDangles(){Object.keys(this.nodes).map(t=>this.nodes[t]).forEach(t=>this._removeIfDangle(t))}_removeIfDangle(t){if(t.innerEdges.length<=1){const e=t.getOuterEdges().map(i=>i.to);this.removeNode(t),e.forEach(i=>this._removeIfDangle(i))}}deleteCutEdges(){this._computeNextCWEdges(),this._findLabeledEdgeRings(),this.edges.forEach(t=>{t.label===t.symetric.label&&(this.removeEdge(t.symetric),this.removeEdge(t))})}_computeNextCWEdges(t){typeof t>"u"?Object.keys(this.nodes).forEach(e=>this._computeNextCWEdges(this.nodes[e])):t.getOuterEdges().forEach((e,i)=>{t.getOuterEdge((i===0?t.getOuterEdges().length:i)-1).symetric.next=e})}_computeNextCCWEdges(t,e){const i=t.getOuterEdges();let n,s;for(let a=i.length-1;a>=0;--a){let l=i[a],f=l.symetric,d,g;l.label===e&&(d=l),f.label===e&&(g=f),!(!d||!g)&&(g&&(s=g),d&&(s&&(s.next=d,s=void 0),n||(n=d)))}s&&(s.next=n)}_findLabeledEdgeRings(){const t=[];let e=0;return this.edges.forEach(i=>{if(i.label>=0)return;t.push(i);let n=i;do n.label=e,n=n.next;while(!i.isEqual(n));e++}),t}getEdgeRings(){this._computeNextCWEdges(),this.edges.forEach(e=>{e.label=void 0}),this._findLabeledEdgeRings().forEach(e=>{this._findIntersectionNodes(e).forEach(i=>{this._computeNextCCWEdges(i,e.label)})});const t=[];return this.edges.forEach(e=>{e.ring||t.push(this._findEdgeRing(e))}),t}_findIntersectionNodes(t){const e=[];let i=t;do{let n=0;i.from.getOuterEdges().forEach(s=>{s.label===t.label&&++n}),n>1&&e.push(i.from),i=i.next}while(!t.isEqual(i));return e}_findEdgeRing(t){let e=t;const i=new xv;do i.push(e),e.ring=i,e=e.next;while(!t.isEqual(e));return i}removeNode(t){t.getOuterEdges().forEach(e=>this.removeEdge(e)),t.innerEdges.forEach(e=>this.removeEdge(e)),delete this.nodes[t.id]}removeEdge(t){this.edges=this.edges.filter(e=>!e.isEqual(t)),t.deleteEdge()}};function wM(r){const t=xM.fromGeoJson(r);t.deleteDangles(),t.deleteCutEdges();const e=[],i=[];return t.getEdgeRings().filter(n=>n.isValid()).forEach(n=>{n.isHole()?e.push(n):i.push(n)}),e.forEach(n=>{xv.findEdgeRingContaining(n,i)&&i.push(n)}),Yt(i.map(n=>n.toPolygon()))}function bM(r,t){t=t||{},t.iterations=t.iterations||1;const{iterations:e}=t,i=[];if(!r)throw new Error("inputPolys is required");return Rn(r,function(n,s,a){if(n.type==="Polygon"){let l=[[]];for(let f=0;f<e;f++){let d=[],g=n;f>0&&(g=$t(l).geometry),EM(g,d),l=d.slice(0)}i.push($t(l,a))}else if(n.type==="MultiPolygon"){let l=[[[]]];for(let f=0;f<e;f++){let d=[],g=n;f>0&&(g=pi(l).geometry),kM(g,d),l=d.slice(0)}i.push(pi(l,a))}else throw new Error("geometry is invalid, must be Polygon or MultiPolygon")}),Yt(i)}function EM(r,t){var e,i;Fe(r,function(n,s,a,l,f){if(i!==f)t.push([]);else{var d=e[0],g=e[1],m=n[0],v=n[1];t[f].push([.75*d+.25*m,.75*g+.25*v]),t[f].push([.25*d+.75*m,.25*g+.75*v])}e=n,i=f},!1),t.forEach(function(n){n.push(n[0])})}function kM(r,t){let e,i,n;Fe(r,function(s,a,l,f,d){if(i!==f)t.push([[]]);else if(n!==d)t[f].push([]);else{var g=e[0],m=e[1],v=s[0],_=s[1];t[f][d].push([.75*g+.25*v,.75*m+.25*_]),t[f][d].push([.25*g+.75*v,.25*m+.75*_])}e=s,i=f,n=d},!1),t.forEach(function(s){s.forEach(function(a){a.push(a[0])})})}function MM(r,t){const e=Jt(r),i=Jt(t);let n=[],s=[],a;const l=Te(t);let f=0,d=null;switch(e[0]>l[0]&&e[0]<l[2]&&e[1]>l[1]&&e[1]<l[3]&&(d=sc(r,rc(t)),f=d.properties.featureIndex),gi(t)){case"Polygon":n=i[0][f],s=i[0][0],d!==null&&d.geometry.coordinates[1]<e[1]&&(s=i[0][f]),a=el(i[0][0],i[0][i[0].length-1],e),[n,s]=sm(i[0],e,a,n,s);break;case"MultiPolygon":for(var m=0,v=0,_=0,w=0;w<i[0].length;w++){m=w;for(var b=!1,S=0;S<i[0][w].length;S++){if(v=S,_===f){b=!0;break}_++}if(b)break}n=i[0][m][v],s=i[0][m][v],a=el(i[0][0][0],i[0][0][i[0][0].length-1],e),i.forEach(function(N){[n,s]=sm(N[0],e,a,n,s)});break}return Yt([re(n),re(s)])}function sm(r,t,e,i,n){for(let s=0;s<r.length;s++){const a=r[s];let l=r[s+1];s===r.length-1&&(l=r[0]);const f=el(a,l,t);e<=0&&f>0?SM(t,a,i)||(i=a):e>0&&f<=0&&(LM(t,a,n)||(n=a)),e=f}return[i,n]}function LM(r,t,e){return el(r,t,e)>0}function SM(r,t,e){return el(r,t,e)<0}function el(r,t,e){return(t[0]-r[0])*(e[1]-r[1])-(e[0]-r[0])*(t[1]-r[1])}function bv(r,t={}){return kv(r,"mercator",t)}function Ev(r,t={}){return kv(r,"wgs84",t)}function kv(r,t,e={}){e=e||{};var i=e.mutate;if(!r)throw new Error("geojson is required");return Array.isArray(r)&&_n(r[0])?r=t==="mercator"?om(r):am(r):(i!==!0&&(r=bn(r)),Fe(r,function(n){var s=t==="mercator"?om(n):am(n);n[0]=s[0],n[1]=s[1]})),r}function om(r){var t=Math.PI/180,e=6378137,i=20037508342789244e-9,n=Math.abs(r[0])<=180?r[0]:r[0]-TM(r[0])*360,s=[e*n*t,e*Math.log(Math.tan(Math.PI*.25+.5*r[1]*t))];return s[0]>i&&(s[0]=i),s[0]<-20037508342789244e-9&&(s[0]=-20037508342789244e-9),s[1]>i&&(s[1]=i),s[1]<-20037508342789244e-9&&(s[1]=-20037508342789244e-9),s}function am(r){var t=180/Math.PI,e=6378137;return[r[0]*t/e,(Math.PI*.5-2*Math.atan(Math.exp(-r[1]/e)))*t]}function TM(r){return r<0?-1:r>0?1:0}const PM=Object.freeze(Object.defineProperty({__proto__:null,toMercator:bv,toWgs84:Ev},Symbol.toStringTag,{value:"Module"}));function IM(r,t){t=t||{};const e=t.studyBbox||Te(r),i=t.confidenceLevel||20,n=r.features,s=n.length,a=dl(pl(e)),l=Math.sqrt(a/s*2),d=Fd(e,l,{units:"meters"}).features,g={};for(let U=0;U<d.length;U++)g[U]={box:Te(d[U]),cnt:0};let m=0;for(const U of n)for(const I of Object.keys(g)){const O=g[I].box;if(AM(me(U),O)){g[I].cnt+=1,m+=1;break}}let v=0;for(const U of Object.keys(g)){const I=g[U].cnt;I>v&&(v=I)}const _=[],w=Object.keys(g).length,b=m/w;let S=0;for(let U=0;U<v+1;U++)S+=Math.exp(-b)*Math.pow(b,U)/NM(U),_.push(S);const N=[];let k=0;for(let U=0;U<v+1;U++){for(const O of Object.keys(g))g[O].cnt===U&&(k+=1);const I=k/w;N.push(I)}let C=0;for(let U=0;U<v+1;U++){const I=Math.abs(_[U]-N[U]);I>C&&(C=I)}const P=CM[i]/Math.sqrt(w),q={criticalValue:P,isRandom:!0,maxAbsoluteDifference:C,observedDistribution:N};return C>P&&(q.isRandom=!1),q}var CM={20:1.07275,15:1.13795,10:1.22385,5:1.3581,2:1.51743,1:1.62762};function AM(r,t){return t[0]<=r[0]&&t[1]<=r[1]&&t[2]>=r[0]&&t[3]>=r[1]}function NM(r){const t=[];function e(i){return i===0||i===1?1:t[i]>0?t[i]:t[i]=e(i-1)*i}return e(r)}function Mv(r){return ac(r),oc(r)}function oc(r){return Array.isArray(r)?um(r):r&&r.bbox?um(r.bbox):[RM(),DM()]}function ac(r){r!=null&&(Array.isArray(r)?$u(r):r.bbox!=null&&$u(r.bbox))}function Lv(r,t={}){ac(t.bbox),r==null&&(r=1);const e=[];for(let i=0;i<r;i++)e.push(re(oc(t.bbox)));return Yt(e)}function Sv(r,t={}){ac(t.bbox),r==null&&(r=1),(t.bbox===void 0||t.bbox===null)&&(t.bbox=[-180,-90,180,90]),(!_n(t.num_vertices)||t.num_vertices===void 0)&&(t.num_vertices=10),(!_n(t.max_radial_length)||t.max_radial_length===void 0)&&(t.max_radial_length=10);const e=Math.abs(t.bbox[0]-t.bbox[2]),i=Math.abs(t.bbox[1]-t.bbox[3]),n=Math.min(e/2,i/2);if(t.max_radial_length>n)throw new Error("max_radial_length is greater than the radius of the bbox");const s=[t.bbox[0]+t.max_radial_length,t.bbox[1]+t.max_radial_length,t.bbox[2]-t.max_radial_length,t.bbox[3]-t.max_radial_length],a=[];for(let l=0;l<r;l++){let f=[];const d=[...Array(t.num_vertices+1)].map(Math.random);d.forEach((g,m,v)=>{v[m]=m>0?g+v[m-1]:g}),d.forEach(g=>{g=g*2*Math.PI/d[d.length-1];const m=Math.random();f.push([m*(t.max_radial_length||10)*Math.sin(g),m*(t.max_radial_length||10)*Math.cos(g)])}),f[f.length-1]=f[0],f=f.reverse().map(OM(oc(s))),a.push($t([f]))}return Yt(a)}function Tv(r,t={}){if(t=t||{},!ve(t))throw new Error("options is invalid");const e=t.bbox;ac(e);let i=t.num_vertices,n=t.max_length,s=t.max_rotation;r==null&&(r=1),(!_n(i)||i===void 0||i<2)&&(i=10),(!_n(n)||n===void 0)&&(n=1e-4),(!_n(s)||s===void 0)&&(s=Math.PI/8);const a=[];for(let l=0;l<r;l++){const d=[oc(e)];for(let g=0;g<i-1;g++){const v=(g===0?Math.random()*2*Math.PI:Math.tan((d[g][1]-d[g-1][1])/(d[g][0]-d[g-1][0])))+(Math.random()-.5)*s*2,_=Math.random()*n;d.push([d[g][0]+_*Math.cos(v),d[g][1]+_*Math.sin(v)])}a.push(ge(d))}return Yt(a)}function OM(r){return t=>[t[0]+r[0],t[1]+r[1]]}function Pv(){return Math.random()-.5}function RM(){return Pv()*360}function DM(){return Pv()*180}function um(r){return[Math.random()*(r[2]-r[0])+r[0],Math.random()*(r[3]-r[1])+r[1]]}const zM=Object.freeze(Object.defineProperty({__proto__:null,randomLineString:Tv,randomPoint:Lv,randomPolygon:Sv,randomPosition:Mv},Symbol.toStringTag,{value:"Module"}));function BM(r,t={}){var e,i;if(t=t||{},!ve(t))throw new Error("options is invalid");const n=(e=t.mutate)!=null?e:!1,s=(i=t.reverse)!=null?i:!1;if(!r)throw new Error("<geojson> is required");if(typeof s!="boolean")throw new Error("<reverse> must be a boolean");if(typeof n!="boolean")throw new Error("<mutate> must be a boolean");!n&&r.type!=="Point"&&r.type!=="MultiPoint"&&(r=bn(r));const a=[];switch(r.type){case"GeometryCollection":return Rn(r,function(l){yh(l,s)}),r;case"FeatureCollection":return ye(r,function(l){const f=yh(l,s);ye(f,function(d){a.push(d)})}),Yt(a)}return yh(r,s)}function yh(r,t){switch(r.type==="Feature"?r.geometry.type:r.type){case"GeometryCollection":return Rn(r,function(i){yh(i,t)}),r;case"LineString":return lm(Jt(r),t),r;case"Polygon":return hm(Jt(r),t),r;case"MultiLineString":return Jt(r).forEach(function(i){lm(i,t)}),r;case"MultiPolygon":return Jt(r).forEach(function(i){hm(i,t)}),r;case"Point":case"MultiPoint":return r}}function lm(r,t){Ph(r)===t&&r.reverse()}function hm(r,t){Ph(r[0])!==t&&r[0].reverse();for(let e=1;e<r.length;e++)Ph(r[e])===t&&r[e].reverse()}function FM(r,t){if(!r)throw new Error("fc is required");if(t==null)throw new Error("num is required");if(typeof t!="number")throw new Error("num must be a number");var e=Yt(UM(r.features,t));return e}function UM(r,t){for(var e=r.slice(0),i=r.length,n=i-t,s,a;i-- >n;)a=Math.floor((i+1)*Math.random()),s=e[a],e[a]=e[i],e[i]=s;return e.slice(n)}function GM(r,t,e,i,n={}){if(n=n||{},!ve(n))throw new Error("options is invalid");const s=n.properties;if(!r)throw new Error("center is required");if(e==null)throw new Error("bearing1 is required");if(i==null)throw new Error("bearing2 is required");if(!t)throw new Error("radius is required");if(typeof n!="object")throw new Error("options must be an object");if(cm(e)===cm(i))return ml(r,t,n);const a=Jt(r),l=cv(r,t,e,i,n),f=[[a]];return Fe(l,function(d){f[0].push(d)}),f[0].push(a),$t(f,s)}function cm(r){let t=r%360;return t<0&&(t+=360),t}function Iv(r,t,e){if(e=e||{},!ve(e))throw new Error("options is invalid");const i=e.origin||"centroid",n=e.mutate||!1;if(!r)throw new Error("geojson required");if(typeof t!="number"||t<=0)throw new Error("invalid factor");const s=Array.isArray(i)||typeof i=="object";return n!==!0&&(r=bn(r)),r.type==="FeatureCollection"&&!s?(ye(r,function(a,l){r.features[l]=fm(a,t,i)}),r):fm(r,t,i)}function fm(r,t,e){const i=gi(r)==="Point",n=VM(r,e);return t===1||i||(Fe(r,function(s){const a=Xs(n,s),l=fs(n,s),f=a*t,d=Jt(Ha(n,f,l));s[0]=d[0],s[1]=d[1],s.length===3&&(s[2]*=t)}),delete r.bbox),r}function VM(r,t){if(t==null&&(t="centroid"),Array.isArray(t)||typeof t=="object")return me(t);const e=r.bbox?r.bbox:Te(r,{recompute:!0}),i=e[0],n=e[1],s=e[2],a=e[3];switch(t){case"sw":case"southwest":case"westsouth":case"bottomleft":return re([i,n]);case"se":case"southeast":case"eastsouth":case"bottomright":return re([s,n]);case"nw":case"northwest":case"westnorth":case"topleft":return re([i,a]);case"ne":case"northeast":case"eastnorth":case"topright":return re([s,a]);case"center":return ec(r);case void 0:case null:case"centroid":return Dr(r);default:throw new Error("invalid origin")}}function dm(r){for(var t=r,e=[];t.parent;)e.unshift(t),t=t.parent;return e}function qM(){return new Cv(function(r){return r.f})}var uc={search:function(r,t,e,i){var n;r.cleanDirty(),i=i||{};var s=i.heuristic||uc.heuristics.manhattan,a=(n=i.closest)!=null?n:!1,l=qM(),f=t;for(t.h=s(t,e),l.push(t);l.size()>0;){var d=l.pop();if(d===e)return dm(d);d.closed=!0;for(var g=r.neighbors(d),m=0,v=g.length;m<v;++m){var _=g[m];if(!(_.closed||_.isWall())){var w=d.g+_.getCost(d),b=_.visited;(!b||w<_.g)&&(_.visited=!0,_.parent=d,_.h=_.h||s(_,e),_.g=w,_.f=_.g+_.h,r.markDirty(_),a&&(_.h<f.h||_.h===f.h&&_.g<f.g)&&(f=_),b?l.rescoreElement(_):l.push(_))}}}return a?dm(f):[]},heuristics:{manhattan:function(r,t){var e=Math.abs(t.x-r.x),i=Math.abs(t.y-r.y);return e+i},diagonal:function(r,t){var e=1,i=Math.sqrt(2),n=Math.abs(t.x-r.x),s=Math.abs(t.y-r.y);return e*(n+s)+(i-2*e)*Math.min(n,s)}},cleanNode:function(r){r.f=0,r.g=0,r.h=0,r.visited=!1,r.closed=!1,r.parent=null}};function eu(r,t){t=t||{},this.nodes=[],this.diagonal=!!t.diagonal,this.grid=[];for(var e=0;e<r.length;e++){this.grid[e]=[];for(var i=0,n=r[e];i<n.length;i++){var s=new lc(e,i,n[i]);this.grid[e][i]=s,this.nodes.push(s)}}this.init()}eu.prototype.init=function(){this.dirtyNodes=[];for(var r=0;r<this.nodes.length;r++)uc.cleanNode(this.nodes[r])};eu.prototype.cleanDirty=function(){for(var r=0;r<this.dirtyNodes.length;r++)uc.cleanNode(this.dirtyNodes[r]);this.dirtyNodes=[]};eu.prototype.markDirty=function(r){this.dirtyNodes.push(r)};eu.prototype.neighbors=function(r){var t=[],e=r.x,i=r.y,n=this.grid;return n[e-1]&&n[e-1][i]&&t.push(n[e-1][i]),n[e+1]&&n[e+1][i]&&t.push(n[e+1][i]),n[e]&&n[e][i-1]&&t.push(n[e][i-1]),n[e]&&n[e][i+1]&&t.push(n[e][i+1]),this.diagonal&&(n[e-1]&&n[e-1][i-1]&&t.push(n[e-1][i-1]),n[e+1]&&n[e+1][i-1]&&t.push(n[e+1][i-1]),n[e-1]&&n[e-1][i+1]&&t.push(n[e-1][i+1]),n[e+1]&&n[e+1][i+1]&&t.push(n[e+1][i+1])),t};eu.prototype.toString=function(){for(var r=[],t=this.grid,e,i,n,s,a=0,l=t.length;a<l;a++){for(e=[],i=t[a],n=0,s=i.length;n<s;n++)e.push(i[n].weight);r.push(e.join(" "))}return r.join(`
`)};function lc(r,t,e){this.x=r,this.y=t,this.weight=e}lc.prototype.toString=function(){return"["+this.x+" "+this.y+"]"};lc.prototype.getCost=function(r){return r&&r.x!==this.x&&r.y!==this.y?this.weight*1.41421:this.weight};lc.prototype.isWall=function(){return this.weight===0};function Cv(r){this.content=[],this.scoreFunction=r}Cv.prototype={push:function(r){this.content.push(r),this.sinkDown(this.content.length-1)},pop:function(){var r=this.content[0],t=this.content.pop();return this.content.length>0&&(this.content[0]=t,this.bubbleUp(0)),r},remove:function(r){var t=this.content.indexOf(r),e=this.content.pop();t!==this.content.length-1&&(this.content[t]=e,this.scoreFunction(e)<this.scoreFunction(r)?this.sinkDown(t):this.bubbleUp(t))},size:function(){return this.content.length},rescoreElement:function(r){this.sinkDown(this.content.indexOf(r))},sinkDown:function(r){for(var t=this.content[r];r>0;){var e=(r+1>>1)-1,i=this.content[e];if(this.scoreFunction(t)<this.scoreFunction(i))this.content[e]=t,this.content[r]=i,r=e;else break}},bubbleUp:function(r){for(var t=this.content.length,e=this.content[r],i=this.scoreFunction(e);;){var n=r+1<<1,s=n-1,a=null,l;if(s<t){var f=this.content[s];l=this.scoreFunction(f),l<i&&(a=s)}if(n<t){var d=this.content[n],g=this.scoreFunction(d);g<(a===null?i:l)&&(a=n)}if(a!==null)this.content[r]=this.content[a],this.content[a]=e,r=a;else break}}};function ZM(r,t,e={}){if(e=e||{},!ve(e))throw new Error("options is invalid");let i=e.obstacles||Yt([]),n=e.resolution||100;if(!r)throw new Error("start is required");if(!t)throw new Error("end is required");if(!_n(n)||n<=0)throw new Error("options.resolution must be a number, greater than 0");const s=me(r),a=me(t);if(r=re(s),t=re(a),i.type==="FeatureCollection"){if(i.features.length===0)return ge([s,a])}else if(i.type==="Polygon")i=Yt([Qe(Ae(i))]);else throw new Error("invalid obstacles");const l=i;l.features.push(r),l.features.push(t);const f=Te(Iv(pl(Te(l)),1.15)),[d,g,m,v]=f,w=we([d,g],[m,g],e)/n;l.features.pop(),l.features.pop();const S=w/we([d,g],[m,g],e)*(m-d),k=w/we([d,g],[d,v],e)*(v-g),C=m-d,A=v-g,P=Math.floor(C/S),q=Math.floor(A/k),U=(C-P*S)/2,I=(A-q*k)/2,O=[],B=[];let V,z,W=1/0,T=1/0,$=v-I,F=0;for(;$>=g;){const et=[],ft=[];let lt=d+U,ut=0;for(;lt<=m;){const mt=re([lt,$]),Et=HM(mt,i);et.push(Et?0:1),ft.push(lt+"|"+$);const at=we(mt,r);!Et&&at<W&&(W=at,V={x:ut,y:F});const Rt=we(mt,t);!Et&&Rt<T&&(T=Rt,z={x:ut,y:F}),lt+=S,ut++}B.push(et),O.push(ft),$-=k,F++}const X=new eu(B,{diagonal:!0}),Y=X.grid[V.y][V.x],j=X.grid[z.y][z.x],J=uc.search(X,Y,j),K=[s];return J.forEach(function(et){const ft=O[et.x][et.y].split("|");K.push([+ft[0],+ft[1]])}),K.push(a),Uo(ge(K))}function HM(r,t){for(let e=0;e<t.features.length;e++)if(ie(r,t.features[e]))return!0;return!1}function YM(r,t){var e=r[0]-t[0],i=r[1]-t[1];return e*e+i*i}function XM(r,t,e){var i=t[0],n=t[1],s=e[0]-i,a=e[1]-n;if(s!==0||a!==0){var l=((r[0]-i)*s+(r[1]-n)*a)/(s*s+a*a);l>1?(i=e[0],n=e[1]):l>0&&(i+=s*l,n+=a*l)}return s=r[0]-i,a=r[1]-n,s*s+a*a}function WM(r,t){for(var e=r[0],i=[e],n,s=1,a=r.length;s<a;s++)n=r[s],YM(n,e)>t&&(i.push(n),e=n);return e!==n&&i.push(n),i}function qf(r,t,e,i,n){for(var s=i,a,l=t+1;l<e;l++){var f=XM(r[l],r[t],r[e]);f>s&&(a=l,s=f)}s>i&&(a-t>1&&qf(r,t,a,i,n),n.push(r[a]),e-a>1&&qf(r,a,e,i,n))}function $M(r,t){var e=r.length-1,i=[r[0]];return qf(r,0,e,t,i),i.push(r[e]),i}function Gh(r,t,e){if(r.length<=2)return r;var i=t!==void 0?t*t:1;return r=e?r:WM(r,i),r=$M(r,i),r}function JM(r,t={}){var e,i,n;if(t=t??{},!ve(t))throw new Error("options is invalid");const s=(e=t.tolerance)!=null?e:1,a=(i=t.highQuality)!=null?i:!1,l=(n=t.mutate)!=null?n:!1;if(!r)throw new Error("geojson is required");if(s&&s<0)throw new Error("invalid tolerance");return l!==!0&&(r=bn(r)),Rn(r,function(f){jM(f,s,a)}),r}function jM(r,t,e){const i=r.type;if(i==="Point"||i==="MultiPoint")return r;if(Uo(r,{mutate:!0}),i!=="GeometryCollection")switch(i){case"LineString":r.coordinates=Gh(r.coordinates,t,e);break;case"MultiLineString":r.coordinates=r.coordinates.map(n=>Gh(n,t,e));break;case"Polygon":r.coordinates=pm(r.coordinates,t,e);break;case"MultiPolygon":r.coordinates=r.coordinates.map(n=>pm(n,t,e))}return r}function pm(r,t,e){return r.map(function(i){if(i.length<4)throw new Error("invalid polygon");let n=t,s=Gh(i,n,e);for(;!KM(s);)n-=n*.01,s=Gh(i,n,e);return(s[s.length-1][0]!==s[0][0]||s[s.length-1][1]!==s[0][1])&&s.push(s[0]),s})}function KM(r){return r.length<3?!1:!(r.length===3&&r[2][0]===r[0][0]&&r[2][1]===r[0][1])}function QM(r,t){var e;if(t=t||{},!ve(t))throw new Error("options is invalid");const i=t.steps||64,n=t.weight,s=t.properties||{};if(!_n(i))throw new Error("steps must be a number");if(!ve(s))throw new Error("properties must be a number");const a=ju(r).length,l=Pd(r,{weight:n});let f=0,d=0,g=0;ye(r,function(I){var O;const B=n&&((O=I.properties)==null?void 0:O[n])||1,V=gm(Jt(I),Jt(l));f+=Math.pow(V.x,2)*B,d+=Math.pow(V.y,2)*B,g+=V.x*V.y*B});const m=f-d,v=Math.sqrt(Math.pow(m,2)+4*Math.pow(g,2)),_=2*g,w=Math.atan((m+v)/_),b=w*180/Math.PI;let S=0,N=0,k=0;ye(r,function(I){var O;const B=n&&((O=I.properties)==null?void 0:O[n])||1,V=gm(Jt(I),Jt(l));S+=Math.pow(V.x*Math.cos(w)-V.y*Math.sin(w),2)*B,N+=Math.pow(V.x*Math.sin(w)+V.y*Math.cos(w),2)*B,k+=B});const C=Math.sqrt(2*S/k),A=Math.sqrt(2*N/k),P=tv(l,C,A,{units:"degrees",angle:b,steps:i,properties:s}),q=yv(r,Yt([P])),U={meanCenterCoordinates:Jt(l),semiMajorAxis:C,semiMinorAxis:A,numberOfFeatures:a,angle:b,percentageWithinEllipse:100*ju(q).length/a};return P.properties=(e=P.properties)!=null?e:{},P.properties.standardDeviationalEllipse=U,P}function gm(r,t){return{x:r[0]-t[0],y:r[1]-t[1]}}function tL(r,t,e,i){return r=bn(r),t=bn(t),ye(r,function(n){n.properties||(n.properties={}),ye(t,function(s){n.properties&&s.properties&&n.properties[i]===void 0&&ie(n,s)&&(n.properties[i]=s.properties[e])})}),r}var Gl={exports:{}},mm;function eL(){if(mm)return Gl.exports;mm=1,Gl.exports=r,Gl.exports.default=r;function r(F,X,Y){Y=Y||2;var j=X&&X.length,J=j?X[0]*Y:F.length,K=t(F,0,J,Y,!0),et=[];if(!K||K.next===K.prev)return et;var ft,lt,ut,mt,Et,at,Rt;if(j&&(K=f(F,X,K,Y)),F.length>80*Y){ft=ut=F[0],lt=mt=F[1];for(var xt=Y;xt<J;xt+=Y)Et=F[xt],at=F[xt+1],Et<ft&&(ft=Et),at<lt&&(lt=at),Et>ut&&(ut=Et),at>mt&&(mt=at);Rt=Math.max(ut-ft,mt-lt),Rt=Rt!==0?32767/Rt:0}return i(K,et,Y,ft,lt,Rt,0),et}function t(F,X,Y,j,J){var K,et;if(J===$(F,X,Y,j)>0)for(K=X;K<Y;K+=j)et=z(K,F[K],F[K+1],et);else for(K=Y-j;K>=X;K-=j)et=z(K,F[K],F[K+1],et);return et&&A(et,et.next)&&(W(et),et=et.next),et}function e(F,X){if(!F)return F;X||(X=F);var Y=F,j;do if(j=!1,!Y.steiner&&(A(Y,Y.next)||C(Y.prev,Y,Y.next)===0)){if(W(Y),Y=X=Y.prev,Y===Y.next)break;j=!0}else Y=Y.next;while(j||Y!==X);return X}function i(F,X,Y,j,J,K,et){if(F){!et&&K&&_(F,j,J,K);for(var ft=F,lt,ut;F.prev!==F.next;){if(lt=F.prev,ut=F.next,K?s(F,j,J,K):n(F)){X.push(lt.i/Y|0),X.push(F.i/Y|0),X.push(ut.i/Y|0),W(F),F=ut.next,ft=ut.next;continue}if(F=ut,F===ft){et?et===1?(F=a(e(F),X,Y),i(F,X,Y,j,J,K,2)):et===2&&l(F,X,Y,j,J,K):i(e(F),X,Y,j,J,K,1);break}}}}function n(F){var X=F.prev,Y=F,j=F.next;if(C(X,Y,j)>=0)return!1;for(var J=X.x,K=Y.x,et=j.x,ft=X.y,lt=Y.y,ut=j.y,mt=J<K?J<et?J:et:K<et?K:et,Et=ft<lt?ft<ut?ft:ut:lt<ut?lt:ut,at=J>K?J>et?J:et:K>et?K:et,Rt=ft>lt?ft>ut?ft:ut:lt>ut?lt:ut,xt=j.next;xt!==X;){if(xt.x>=mt&&xt.x<=at&&xt.y>=Et&&xt.y<=Rt&&N(J,ft,K,lt,et,ut,xt.x,xt.y)&&C(xt.prev,xt,xt.next)>=0)return!1;xt=xt.next}return!0}function s(F,X,Y,j){var J=F.prev,K=F,et=F.next;if(C(J,K,et)>=0)return!1;for(var ft=J.x,lt=K.x,ut=et.x,mt=J.y,Et=K.y,at=et.y,Rt=ft<lt?ft<ut?ft:ut:lt<ut?lt:ut,xt=mt<Et?mt<at?mt:at:Et<at?Et:at,_t=ft>lt?ft>ut?ft:ut:lt>ut?lt:ut,tt=mt>Et?mt>at?mt:at:Et>at?Et:at,wt=b(Rt,xt,X,Y,j),G=b(_t,tt,X,Y,j),ct=F.prevZ,ht=F.nextZ;ct&&ct.z>=wt&&ht&&ht.z<=G;){if(ct.x>=Rt&&ct.x<=_t&&ct.y>=xt&&ct.y<=tt&&ct!==J&&ct!==et&&N(ft,mt,lt,Et,ut,at,ct.x,ct.y)&&C(ct.prev,ct,ct.next)>=0||(ct=ct.prevZ,ht.x>=Rt&&ht.x<=_t&&ht.y>=xt&&ht.y<=tt&&ht!==J&&ht!==et&&N(ft,mt,lt,Et,ut,at,ht.x,ht.y)&&C(ht.prev,ht,ht.next)>=0))return!1;ht=ht.nextZ}for(;ct&&ct.z>=wt;){if(ct.x>=Rt&&ct.x<=_t&&ct.y>=xt&&ct.y<=tt&&ct!==J&&ct!==et&&N(ft,mt,lt,Et,ut,at,ct.x,ct.y)&&C(ct.prev,ct,ct.next)>=0)return!1;ct=ct.prevZ}for(;ht&&ht.z<=G;){if(ht.x>=Rt&&ht.x<=_t&&ht.y>=xt&&ht.y<=tt&&ht!==J&&ht!==et&&N(ft,mt,lt,Et,ut,at,ht.x,ht.y)&&C(ht.prev,ht,ht.next)>=0)return!1;ht=ht.nextZ}return!0}function a(F,X,Y){var j=F;do{var J=j.prev,K=j.next.next;!A(J,K)&&P(J,j,j.next,K)&&O(J,K)&&O(K,J)&&(X.push(J.i/Y|0),X.push(j.i/Y|0),X.push(K.i/Y|0),W(j),W(j.next),j=F=K),j=j.next}while(j!==F);return e(j)}function l(F,X,Y,j,J,K){var et=F;do{for(var ft=et.next.next;ft!==et.prev;){if(et.i!==ft.i&&k(et,ft)){var lt=V(et,ft);et=e(et,et.next),lt=e(lt,lt.next),i(et,X,Y,j,J,K,0),i(lt,X,Y,j,J,K,0);return}ft=ft.next}et=et.next}while(et!==F)}function f(F,X,Y,j){var J=[],K,et,ft,lt,ut;for(K=0,et=X.length;K<et;K++)ft=X[K]*j,lt=K<et-1?X[K+1]*j:F.length,ut=t(F,ft,lt,j,!1),ut===ut.next&&(ut.steiner=!0),J.push(S(ut));for(J.sort(d),K=0;K<J.length;K++)Y=g(J[K],Y);return Y}function d(F,X){return F.x-X.x}function g(F,X){var Y=m(F,X);if(!Y)return X;var j=V(Y,F);return e(j,j.next),e(Y,Y.next)}function m(F,X){var Y=X,j=F.x,J=F.y,K=-1/0,et;do{if(J<=Y.y&&J>=Y.next.y&&Y.next.y!==Y.y){var ft=Y.x+(J-Y.y)*(Y.next.x-Y.x)/(Y.next.y-Y.y);if(ft<=j&&ft>K&&(K=ft,et=Y.x<Y.next.x?Y:Y.next,ft===j))return et}Y=Y.next}while(Y!==X);if(!et)return null;var lt=et,ut=et.x,mt=et.y,Et=1/0,at;Y=et;do j>=Y.x&&Y.x>=ut&&j!==Y.x&&N(J<mt?j:K,J,ut,mt,J<mt?K:j,J,Y.x,Y.y)&&(at=Math.abs(J-Y.y)/(j-Y.x),O(Y,F)&&(at<Et||at===Et&&(Y.x>et.x||Y.x===et.x&&v(et,Y)))&&(et=Y,Et=at)),Y=Y.next;while(Y!==lt);return et}function v(F,X){return C(F.prev,F,X.prev)<0&&C(X.next,F,F.next)<0}function _(F,X,Y,j){var J=F;do J.z===0&&(J.z=b(J.x,J.y,X,Y,j)),J.prevZ=J.prev,J.nextZ=J.next,J=J.next;while(J!==F);J.prevZ.nextZ=null,J.prevZ=null,w(J)}function w(F){var X,Y,j,J,K,et,ft,lt,ut=1;do{for(Y=F,F=null,K=null,et=0;Y;){for(et++,j=Y,ft=0,X=0;X<ut&&(ft++,j=j.nextZ,!!j);X++);for(lt=ut;ft>0||lt>0&&j;)ft!==0&&(lt===0||!j||Y.z<=j.z)?(J=Y,Y=Y.nextZ,ft--):(J=j,j=j.nextZ,lt--),K?K.nextZ=J:F=J,J.prevZ=K,K=J;Y=j}K.nextZ=null,ut*=2}while(et>1);return F}function b(F,X,Y,j,J){return F=(F-Y)*J|0,X=(X-j)*J|0,F=(F|F<<8)&16711935,F=(F|F<<4)&252645135,F=(F|F<<2)&858993459,F=(F|F<<1)&1431655765,X=(X|X<<8)&16711935,X=(X|X<<4)&252645135,X=(X|X<<2)&858993459,X=(X|X<<1)&1431655765,F|X<<1}function S(F){var X=F,Y=F;do(X.x<Y.x||X.x===Y.x&&X.y<Y.y)&&(Y=X),X=X.next;while(X!==F);return Y}function N(F,X,Y,j,J,K,et,ft){return(J-et)*(X-ft)>=(F-et)*(K-ft)&&(F-et)*(j-ft)>=(Y-et)*(X-ft)&&(Y-et)*(K-ft)>=(J-et)*(j-ft)}function k(F,X){return F.next.i!==X.i&&F.prev.i!==X.i&&!I(F,X)&&(O(F,X)&&O(X,F)&&B(F,X)&&(C(F.prev,F,X.prev)||C(F,X.prev,X))||A(F,X)&&C(F.prev,F,F.next)>0&&C(X.prev,X,X.next)>0)}function C(F,X,Y){return(X.y-F.y)*(Y.x-X.x)-(X.x-F.x)*(Y.y-X.y)}function A(F,X){return F.x===X.x&&F.y===X.y}function P(F,X,Y,j){var J=U(C(F,X,Y)),K=U(C(F,X,j)),et=U(C(Y,j,F)),ft=U(C(Y,j,X));return!!(J!==K&&et!==ft||J===0&&q(F,Y,X)||K===0&&q(F,j,X)||et===0&&q(Y,F,j)||ft===0&&q(Y,X,j))}function q(F,X,Y){return X.x<=Math.max(F.x,Y.x)&&X.x>=Math.min(F.x,Y.x)&&X.y<=Math.max(F.y,Y.y)&&X.y>=Math.min(F.y,Y.y)}function U(F){return F>0?1:F<0?-1:0}function I(F,X){var Y=F;do{if(Y.i!==F.i&&Y.next.i!==F.i&&Y.i!==X.i&&Y.next.i!==X.i&&P(Y,Y.next,F,X))return!0;Y=Y.next}while(Y!==F);return!1}function O(F,X){return C(F.prev,F,F.next)<0?C(F,X,F.next)>=0&&C(F,F.prev,X)>=0:C(F,X,F.prev)<0||C(F,F.next,X)<0}function B(F,X){var Y=F,j=!1,J=(F.x+X.x)/2,K=(F.y+X.y)/2;do Y.y>K!=Y.next.y>K&&Y.next.y!==Y.y&&J<(Y.next.x-Y.x)*(K-Y.y)/(Y.next.y-Y.y)+Y.x&&(j=!j),Y=Y.next;while(Y!==F);return j}function V(F,X){var Y=new T(F.i,F.x,F.y),j=new T(X.i,X.x,X.y),J=F.next,K=X.prev;return F.next=X,X.prev=F,Y.next=J,J.prev=Y,j.next=Y,Y.prev=j,K.next=j,j.prev=K,j}function z(F,X,Y,j){var J=new T(F,X,Y);return j?(J.next=j.next,J.prev=j,j.next.prev=J,j.next=J):(J.prev=J,J.next=J),J}function W(F){F.next.prev=F.prev,F.prev.next=F.next,F.prevZ&&(F.prevZ.nextZ=F.nextZ),F.nextZ&&(F.nextZ.prevZ=F.prevZ)}function T(F,X,Y){this.i=F,this.x=X,this.y=Y,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}r.deviation=function(F,X,Y,j){var J=X&&X.length,K=J?X[0]*Y:F.length,et=Math.abs($(F,0,K,Y));if(J)for(var ft=0,lt=X.length;ft<lt;ft++){var ut=X[ft]*Y,mt=ft<lt-1?X[ft+1]*Y:F.length;et-=Math.abs($(F,ut,mt,Y))}var Et=0;for(ft=0;ft<j.length;ft+=3){var at=j[ft]*Y,Rt=j[ft+1]*Y,xt=j[ft+2]*Y;Et+=Math.abs((F[at]-F[xt])*(F[Rt+1]-F[at+1])-(F[at]-F[Rt])*(F[xt+1]-F[at+1]))}return et===0&&Et===0?0:Math.abs((Et-et)/et)};function $(F,X,Y,j){for(var J=0,K=X,et=Y-j;K<Y;K+=j)J+=(F[et]-F[K])*(F[K+1]+F[et+1]),et=K;return J}return r.flatten=function(F){for(var X=F[0][0].length,Y={vertices:[],holes:[],dimensions:X},j=0,J=0;J<F.length;J++){for(var K=0;K<F[J].length;K++)for(var et=0;et<X;et++)Y.vertices.push(F[J][K][et]);J>0&&(j+=F[J-1].length,Y.holes.push(j))}return Y},Gl.exports}var nL=eL();const iL=eo(nL);function rL(r){if(!r.geometry||r.geometry.type!=="Polygon"&&r.geometry.type!=="MultiPolygon")throw new Error("input must be a Polygon or MultiPolygon");const t={type:"FeatureCollection",features:[]};return r.geometry.type==="Polygon"?t.features=ym(r.geometry.coordinates):r.geometry.coordinates.forEach(function(e){t.features=t.features.concat(ym(e))}),t}function ym(r){const t=sL(r),e=2,i=iL(t.vertices,t.holes,e),n=[],s=[];i.forEach(function(l,f){const d=i[f];s.push([t.vertices[d*e],t.vertices[d*e+1]])});for(var a=0;a<s.length;a+=3){const l=s.slice(a,a+3);l.push(s[a]),n.push($t([l]))}return n}function sL(r){const t=r[0][0].length,e={vertices:[],holes:[],dimensions:t};let i=0;for(let n=0;n<r.length;n++){for(let s=0;s<r[n].length;s++)for(let a=0;a<t;a++)e.vertices.push(r[n][s][a]);n>0&&(i+=r[n-1].length,e.holes.push(i))}return e}function oL(r,t,e,i){if(i=i||{},!ve(i))throw new Error("options is invalid");var n=i.units,s=i.zTranslation,a=i.mutate;if(!r)throw new Error("geojson is required");if(t==null||isNaN(t))throw new Error("distance is required");if(s&&typeof s!="number"&&isNaN(s))throw new Error("zTranslation is not a number");if(s=s!==void 0?s:0,t===0&&s===0)return r;if(e==null||isNaN(e))throw new Error("direction is required");return t<0&&(t=-t,e=e+180),(a===!1||a===void 0)&&(r=bn(r)),Fe(r,function(l){var f=Jt(Ha(l,t,e,{units:n}));l[0]=f[0],l[1]=f[1],s&&l.length===3&&(l[2]+=s)}),r}function aL(r,t={}){const e=[];if(Rn(r,n=>{e.push(n.coordinates)}),e.length<2)throw new Error("Must have at least 2 geometries");const i=Ks(e[0],...e.slice(1));return i.length===0?null:i.length===1?$t(i[0],t.properties):pi(i,t.properties)}function uL(r,t,e){if(r.geometry.type!=="Polygon")throw new Error("The input feature must be a Polygon");e===void 0&&(e=1);var i=r.geometry.coordinates,n=[],s={};if(e){for(var a=[],l=0;l<i.length;l++)for(var f=0;f<i[l].length-1;f++)a.push(S(l,f));var d=new ci;d.load(a)}for(var g=0;g<i.length;g++)for(var m=0;m<i[g].length-1;m++)if(e){var v=d.search(S(g,m));v.forEach(function(N){var k=N.ring,C=N.edge;b(g,m,k,C)})}else for(var _=0;_<i.length;_++)for(var w=0;w<i[_].length-1;w++)b(g,m,_,w);return t||(n={type:"Feature",geometry:{type:"MultiPoint",coordinates:n}}),n;function b(N,k,C,A){var P=i[N][k],q=i[N][k+1],U=i[C][A],I=i[C][A+1],O=lL(P,q,U,I);if(O!==null){var B,V;if(q[0]!==P[0]?B=(O[0]-P[0])/(q[0]-P[0]):B=(O[1]-P[1])/(q[1]-P[1]),I[0]!==U[0]?V=(O[0]-U[0])/(I[0]-U[0]):V=(O[1]-U[1])/(I[1]-U[1]),!(B>=1||B<=0||V>=1||V<=0)){var z=O,W=!s[z];W&&(s[z]=!0),n.push(t(O,N,k,P,q,B,C,A,U,I,V,W))}}}function S(N,k){var C=i[N][k],A=i[N][k+1],P,q,U,I;return C[0]<A[0]?(P=C[0],q=A[0]):(P=A[0],q=C[0]),C[1]<A[1]?(U=C[1],I=A[1]):(U=A[1],I=C[1]),{minX:P,minY:U,maxX:q,maxY:I,ring:N,edge:k}}}function lL(r,t,e,i){if(Au(r,e)||Au(r,i)||Au(t,e)||Au(i,e))return null;var n=r[0],s=r[1],a=t[0],l=t[1],f=e[0],d=e[1],g=i[0],m=i[1],v=(n-a)*(d-m)-(s-l)*(f-g);if(v===0)return null;var _=((n*l-s*a)*(f-g)-(n-a)*(f*m-d*g))/v,w=((n*l-s*a)*(d-m)-(s-l)*(f*m-d*g))/v;return[_,w]}function Au(r,t){if(!r||!t||r.length!==t.length)return!1;for(var e=0,i=r.length;e<i;e++)if(r[e]instanceof Array&&t[e]instanceof Array){if(!Au(r[e],t[e]))return!1}else if(r[e]!==t[e])return!1;return!0}function hL(r){if(r.type!="Feature")throw new Error("The input must a geojson object of type Feature");if(r.geometry===void 0||r.geometry==null)throw new Error("The input must a geojson object with a non-empty geometry");if(r.geometry.type!="Polygon")throw new Error("The input must be a geojson Polygon");for(var t=r.geometry.coordinates.length,e=[],k=0;k<t;k++){var i=r.geometry.coordinates[k];Nu(i[0],i[i.length-1])||i.push(i[0]);for(var n=0;n<i.length-1;n++)e.push(i[n])}if(!fL(e))throw new Error("The input polygon may not have duplicate vertices (except for the first and last vertex of each ring)");var s=e.length,a=uL(r,function(lt,ut,mt,Et,at,Rt,xt,_t,tt,wt,G,ct){return[lt,ut,mt,Et,at,Rt,xt,_t,tt,wt,G,ct]}),l=a.length;if(l==0){for(var U=[],k=0;k<t;k++)U.push($t([r.geometry.coordinates[k]],{parent:-1,winding:cL(r.geometry.coordinates[k])}));var j=Yt(U);return J(),K(),j}for(var f=[],d=[],k=0;k<t;k++){f.push([]);for(var n=0;n<r.geometry.coordinates[k].length-1;n++)f[k].push([new _m(r.geometry.coordinates[k][Sa(n+1,r.geometry.coordinates[k].length-1)],1,[k,n],[k,Sa(n+1,r.geometry.coordinates[k].length-1)],void 0)]),d.push(new vm(r.geometry.coordinates[k][n],[k,Sa(n-1,r.geometry.coordinates[k].length-1)],[k,n],void 0,void 0,!1,!0))}for(var k=0;k<l;k++)f[a[k][1]][a[k][2]].push(new _m(a[k][0],a[k][5],[a[k][1],a[k][2]],[a[k][6],a[k][7]],void 0)),a[k][11]&&d.push(new vm(a[k][0],[a[k][1],a[k][2]],[a[k][6],a[k][7]],void 0,void 0,!0,!0));for(var g=d.length,k=0;k<f.length;k++)for(var n=0;n<f[k].length;n++)f[k][n].sort(function(ut,mt){return ut.param<mt.param?-1:1});for(var m=[],k=0;k<g;k++)m.push({minX:d[k].coord[0],minY:d[k].coord[1],maxX:d[k].coord[0],maxY:d[k].coord[1],index:k});var v=new ci;v.load(m);for(var k=0;k<f.length;k++)for(var n=0;n<f[k].length;n++)for(var _=0;_<f[k][n].length;_++){var w;_==f[k][n].length-1?w=f[k][Sa(n+1,r.geometry.coordinates[k].length-1)][0].coord:w=f[k][n][_+1].coord;var b=v.search({minX:w[0],minY:w[1],maxX:w[0],maxY:w[1]})[0];f[k][n][_].nxtIsectAlongEdgeIn=b.index}for(var k=0;k<f.length;k++)for(var n=0;n<f[k].length;n++)for(var _=0;_<f[k][n].length;_++){var w=f[k][n][_].coord,b=v.search({minX:w[0],minY:w[1],maxX:w[0],maxY:w[1]})[0],S=b.index;S<s?d[S].nxtIsectAlongRingAndEdge2=f[k][n][_].nxtIsectAlongEdgeIn:Nu(d[S].ringAndEdge1,f[k][n][_].ringAndEdgeIn)?d[S].nxtIsectAlongRingAndEdge1=f[k][n][_].nxtIsectAlongEdgeIn:d[S].nxtIsectAlongRingAndEdge2=f[k][n][_].nxtIsectAlongEdgeIn}for(var N=[],k=0,n=0;n<t;n++){for(var C=k,_=0;_<r.geometry.coordinates[n].length-1;_++)d[k].coord[0]<d[C].coord[0]&&(C=k),k++;for(var A=d[C].nxtIsectAlongRingAndEdge2,_=0;_<d.length;_++)if(d[_].nxtIsectAlongRingAndEdge1==C||d[_].nxtIsectAlongRingAndEdge2==C){var P=_;break}var q=_h([d[P].coord,d[C].coord,d[A].coord],!0)?1:-1;N.push({isect:C,parent:-1,winding:q})}N.sort(function(ft,lt){return d[ft.isect].coord>d[lt.isect].coord?-1:1});for(var U=[];N.length>0;){var I=N.pop(),O=I.isect,B=I.parent,V=I.winding,z=U.length,W=[d[O].coord],T=O;if(d[O].ringAndEdge1Walkable)var $=d[O].ringAndEdge1,F=d[O].nxtIsectAlongRingAndEdge1;else var $=d[O].ringAndEdge2,F=d[O].nxtIsectAlongRingAndEdge2;for(;!Nu(d[O].coord,d[F].coord);){W.push(d[F].coord);for(var X=void 0,k=0;k<N.length;k++)if(N[k].isect==F){X=k;break}if(X!=null&&N.splice(X,1),Nu($,d[F].ringAndEdge1)){if($=d[F].ringAndEdge2,d[F].ringAndEdge2Walkable=!1,d[F].ringAndEdge1Walkable){var Y={isect:F};_h([d[T].coord,d[F].coord,d[d[F].nxtIsectAlongRingAndEdge2].coord],V==1)?(Y.parent=B,Y.winding=-V):(Y.parent=z,Y.winding=V),N.push(Y)}T=F,F=d[F].nxtIsectAlongRingAndEdge2}else{if($=d[F].ringAndEdge1,d[F].ringAndEdge1Walkable=!1,d[F].ringAndEdge2Walkable){var Y={isect:F};_h([d[T].coord,d[F].coord,d[d[F].nxtIsectAlongRingAndEdge1].coord],V==1)?(Y.parent=B,Y.winding=-V):(Y.parent=z,Y.winding=V),N.push(Y)}T=F,F=d[F].nxtIsectAlongRingAndEdge1}}W.push(d[F].coord),U.push($t([W],{index:z,parent:B,winding:V,netWinding:void 0}))}var j=Yt(U);J(),K();function J(){for(var ft=[],lt=0;lt<j.features.length;lt++)j.features[lt].properties.parent==-1&&ft.push(lt);if(ft.length>1)for(var lt=0;lt<ft.length;lt++){for(var ut=-1,mt=1/0,Et=0;Et<j.features.length;Et++)ft[lt]!=Et&&ie(j.features[ft[lt]].geometry.coordinates[0][0],j.features[Et],{ignoreBoundary:!0})&&dl(j.features[Et])<mt&&(ut=Et);j.features[ft[lt]].properties.parent=ut}}function K(){for(var ft=0;ft<j.features.length;ft++)if(j.features[ft].properties.parent==-1){var lt=j.features[ft].properties.winding;j.features[ft].properties.netWinding=lt,et(ft,lt)}}function et(ft,lt){for(var ut=0;ut<j.features.length;ut++)if(j.features[ut].properties.parent==ft){var mt=lt+j.features[ut].properties.winding;j.features[ut].properties.netWinding=mt,et(ut,mt)}}return j}var _m=function(r,t,e,i,n){this.coord=r,this.param=t,this.ringAndEdgeIn=e,this.ringAndEdgeOut=i,this.nxtIsectAlongEdgeIn=n},vm=function(r,t,e,i,n,s,a){this.coord=r,this.ringAndEdge1=t,this.ringAndEdge2=e,this.nxtIsectAlongRingAndEdge1=i,this.nxtIsectAlongRingAndEdge2=n,this.ringAndEdge1Walkable=s,this.ringAndEdge2Walkable=a};function _h(r,t){if(typeof t>"u"&&(t=!0),r.length!=3)throw new Error("This function requires an array of three points [x,y]");var e=(r[1][0]-r[0][0])*(r[2][1]-r[0][1])-(r[1][1]-r[0][1])*(r[2][0]-r[0][0]);return e>=0==t}function cL(r){for(var t=0,e=0;e<r.length-1;e++)r[e][0]<r[t][0]&&(t=e);if(_h([r[Sa(t-1,r.length-1)],r[t],r[Sa(t+1,r.length-1)]],!0))var i=1;else var i=-1;return i}function Nu(r,t){if(!r||!t||r.length!=t.length)return!1;for(var e=0,i=r.length;e<i;e++)if(r[e]instanceof Array&&t[e]instanceof Array){if(!Nu(r[e],t[e]))return!1}else if(r[e]!=t[e])return!1;return!0}function Sa(r,t){return(r%t+t)%t}function fL(r){for(var t={},e=1,i=0,n=r.length;i<n;++i){if(Object.prototype.hasOwnProperty.call(t,r[i])){e=0;break}t[r[i]]=1}return e}function dL(r){var t=[];return vn(r,function(e){e.geometry.type==="Polygon"&&ye(hL(e),function(i){t.push($t(i.geometry.coordinates,e.properties))})}),Yt(t)}function xm(r){return function(){return r}}function pL(r){return r[0]}function gL(r){return r[1]}function Vh(){this._=null}function hc(r){r.U=r.C=r.L=r.R=r.P=r.N=null}Vh.prototype={constructor:Vh,insert:function(r,t){var e,i,n;if(r){if(t.P=r,t.N=r.N,r.N&&(r.N.P=t),r.N=t,r.R){for(r=r.R;r.L;)r=r.L;r.L=t}else r.R=t;e=r}else this._?(r=wm(this._),t.P=null,t.N=r,r.P=r.L=t,e=r):(t.P=t.N=null,this._=t,e=null);for(t.L=t.R=null,t.U=e,t.C=!0,r=t;e&&e.C;)i=e.U,e===i.L?(n=i.R,n&&n.C?(e.C=n.C=!1,i.C=!0,r=i):(r===e.R&&(pu(this,e),r=e,e=r.U),e.C=!1,i.C=!0,gu(this,i))):(n=i.L,n&&n.C?(e.C=n.C=!1,i.C=!0,r=i):(r===e.L&&(gu(this,e),r=e,e=r.U),e.C=!1,i.C=!0,pu(this,i))),e=r.U;this._.C=!1},remove:function(r){r.N&&(r.N.P=r.P),r.P&&(r.P.N=r.N),r.N=r.P=null;var t=r.U,e,i=r.L,n=r.R,s,a;if(i?n?s=wm(n):s=i:s=n,t?t.L===r?t.L=s:t.R=s:this._=s,i&&n?(a=s.C,s.C=r.C,s.L=i,i.U=s,s!==n?(t=s.U,s.U=r.U,r=s.R,t.L=r,s.R=n,n.U=s):(s.U=t,t=s,r=s.R)):(a=r.C,r=s),r&&(r.U=t),!a){if(r&&r.C){r.C=!1;return}do{if(r===this._)break;if(r===t.L){if(e=t.R,e.C&&(e.C=!1,t.C=!0,pu(this,t),e=t.R),e.L&&e.L.C||e.R&&e.R.C){(!e.R||!e.R.C)&&(e.L.C=!1,e.C=!0,gu(this,e),e=t.R),e.C=t.C,t.C=e.R.C=!1,pu(this,t),r=this._;break}}else if(e=t.L,e.C&&(e.C=!1,t.C=!0,gu(this,t),e=t.L),e.L&&e.L.C||e.R&&e.R.C){(!e.L||!e.L.C)&&(e.R.C=!1,e.C=!0,pu(this,e),e=t.L),e.C=t.C,t.C=e.L.C=!1,gu(this,t),r=this._;break}e.C=!0,r=t,t=t.U}while(!r.C);r&&(r.C=!1)}}};function pu(r,t){var e=t,i=t.R,n=e.U;n?n.L===e?n.L=i:n.R=i:r._=i,i.U=n,e.U=i,e.R=i.L,e.R&&(e.R.U=e),i.L=e}function gu(r,t){var e=t,i=t.L,n=e.U;n?n.L===e?n.L=i:n.R=i:r._=i,i.U=n,e.U=i,e.L=i.R,e.L&&(e.L.U=e),i.R=e}function wm(r){for(;r.L;)r=r.L;return r}function Ou(r,t,e,i){var n=[null,null],s=Xn.push(n)-1;return n.left=r,n.right=t,e&&qh(n,r,t,e),i&&qh(n,t,r,i),Si[r.index].halfedges.push(s),Si[t.index].halfedges.push(s),n}function mu(r,t,e){var i=[t,e];return i.left=r,i}function qh(r,t,e,i){!r[0]&&!r[1]?(r[0]=i,r.left=t,r.right=e):r.left===e?r[1]=i:r[0]=i}function mL(r,t,e,i,n){var s=r[0],a=r[1],l=s[0],f=s[1],d=a[0],g=a[1],m=0,v=1,_=d-l,w=g-f,b;if(b=t-l,!(!_&&b>0)){if(b/=_,_<0){if(b<m)return;b<v&&(v=b)}else if(_>0){if(b>v)return;b>m&&(m=b)}if(b=i-l,!(!_&&b<0)){if(b/=_,_<0){if(b>v)return;b>m&&(m=b)}else if(_>0){if(b<m)return;b<v&&(v=b)}if(b=e-f,!(!w&&b>0)){if(b/=w,w<0){if(b<m)return;b<v&&(v=b)}else if(w>0){if(b>v)return;b>m&&(m=b)}if(b=n-f,!(!w&&b<0)){if(b/=w,w<0){if(b>v)return;b>m&&(m=b)}else if(w>0){if(b<m)return;b<v&&(v=b)}return!(m>0)&&!(v<1)||(m>0&&(r[0]=[l+m*_,f+m*w]),v<1&&(r[1]=[l+v*_,f+v*w])),!0}}}}}function yL(r,t,e,i,n){var s=r[1];if(s)return!0;var a=r[0],l=r.left,f=r.right,d=l[0],g=l[1],m=f[0],v=f[1],_=(d+m)/2,w=(g+v)/2,b,S;if(v===g){if(_<t||_>=i)return;if(d>m){if(!a)a=[_,e];else if(a[1]>=n)return;s=[_,n]}else{if(!a)a=[_,n];else if(a[1]<e)return;s=[_,e]}}else if(b=(d-m)/(v-g),S=w-b*_,b<-1||b>1)if(d>m){if(!a)a=[(e-S)/b,e];else if(a[1]>=n)return;s=[(n-S)/b,n]}else{if(!a)a=[(n-S)/b,n];else if(a[1]<e)return;s=[(e-S)/b,e]}else if(g<v){if(!a)a=[t,b*t+S];else if(a[0]>=i)return;s=[i,b*i+S]}else{if(!a)a=[i,b*i+S];else if(a[0]<t)return;s=[t,b*t+S]}return r[0]=a,r[1]=s,!0}function _L(r,t,e,i){for(var n=Xn.length,s;n--;)(!yL(s=Xn[n],r,t,e,i)||!mL(s,r,t,e,i)||!(Math.abs(s[0][0]-s[1][0])>De||Math.abs(s[0][1]-s[1][1])>De))&&delete Xn[n]}function vL(r){return Si[r.index]={site:r,halfedges:[]}}function xL(r,t){var e=r.site,i=t.left,n=t.right;return e===n&&(n=i,i=e),n?Math.atan2(n[1]-i[1],n[0]-i[0]):(e===i?(i=t[1],n=t[0]):(i=t[0],n=t[1]),Math.atan2(i[0]-n[0],n[1]-i[1]))}function Av(r,t){return t[+(t.left!==r.site)]}function wL(r,t){return t[+(t.left===r.site)]}function bL(){for(var r=0,t=Si.length,e,i,n,s;r<t;++r)if((e=Si[r])&&(s=(i=e.halfedges).length)){var a=new Array(s),l=new Array(s);for(n=0;n<s;++n)a[n]=n,l[n]=xL(e,Xn[i[n]]);for(a.sort(function(f,d){return l[d]-l[f]}),n=0;n<s;++n)l[n]=i[a[n]];for(n=0;n<s;++n)i[n]=l[n]}}function EL(r,t,e,i){var n=Si.length,s,a,l,f,d,g,m,v,_,w,b,S,N=!0;for(s=0;s<n;++s)if(a=Si[s]){for(l=a.site,d=a.halfedges,f=d.length;f--;)Xn[d[f]]||d.splice(f,1);for(f=0,g=d.length;f<g;)w=wL(a,Xn[d[f]]),b=w[0],S=w[1],m=Av(a,Xn[d[++f%g]]),v=m[0],_=m[1],(Math.abs(b-v)>De||Math.abs(S-_)>De)&&(d.splice(f,0,Xn.push(mu(l,w,Math.abs(b-r)<De&&i-S>De?[r,Math.abs(v-r)<De?_:i]:Math.abs(S-i)<De&&e-b>De?[Math.abs(_-i)<De?v:e,i]:Math.abs(b-e)<De&&S-t>De?[e,Math.abs(v-e)<De?_:t]:Math.abs(S-t)<De&&b-r>De?[Math.abs(_-t)<De?v:r,t]:null))-1),++g);g&&(N=!1)}if(N){var k,C,A,P=1/0;for(s=0,N=null;s<n;++s)(a=Si[s])&&(l=a.site,k=l[0]-r,C=l[1]-t,A=k*k+C*C,A<P&&(P=A,N=a));if(N){var q=[r,t],U=[r,i],I=[e,i],O=[e,t];N.halfedges.push(Xn.push(mu(l=N.site,q,U))-1,Xn.push(mu(l,U,I))-1,Xn.push(mu(l,I,O))-1,Xn.push(mu(l,O,q))-1)}}for(s=0;s<n;++s)(a=Si[s])&&(a.halfedges.length||delete Si[s])}var Nv=[],Vd;function kL(){hc(this),this.x=this.y=this.arc=this.site=this.cy=null}function Ta(r){var t=r.P,e=r.N;if(!(!t||!e)){var i=t.site,n=r.site,s=e.site;if(i!==s){var a=n[0],l=n[1],f=i[0]-a,d=i[1]-l,g=s[0]-a,m=s[1]-l,v=2*(f*m-d*g);if(!(v>=-1e-12)){var _=f*f+d*d,w=g*g+m*m,b=(m*_-d*w)/v,S=(f*w-g*_)/v,N=Nv.pop()||new kL;N.arc=r,N.site=n,N.x=b+a,N.y=(N.cy=S+l)+Math.sqrt(b*b+S*S),r.circle=N;for(var k=null,C=nl._;C;)if(N.y<C.y||N.y===C.y&&N.x<=C.x)if(C.L)C=C.L;else{k=C.P;break}else if(C.R)C=C.R;else{k=C;break}nl.insert(k,N),k||(Vd=N)}}}}function Na(r){var t=r.circle;t&&(t.P||(Vd=t.N),nl.remove(t),Nv.push(t),hc(t),r.circle=null)}var Ov=[];function ML(){hc(this),this.edge=this.site=this.circle=null}function bm(r){var t=Ov.pop()||new ML;return t.site=r,t}function Uc(r){Na(r),Oa.remove(r),Ov.push(r),hc(r)}function LL(r){var t=r.circle,e=t.x,i=t.cy,n=[e,i],s=r.P,a=r.N,l=[r];Uc(r);for(var f=s;f.circle&&Math.abs(e-f.circle.x)<De&&Math.abs(i-f.circle.cy)<De;)s=f.P,l.unshift(f),Uc(f),f=s;l.unshift(f),Na(f);for(var d=a;d.circle&&Math.abs(e-d.circle.x)<De&&Math.abs(i-d.circle.cy)<De;)a=d.N,l.push(d),Uc(d),d=a;l.push(d),Na(d);var g=l.length,m;for(m=1;m<g;++m)d=l[m],f=l[m-1],qh(d.edge,f.site,d.site,n);f=l[0],d=l[g-1],d.edge=Ou(f.site,d.site,null,n),Ta(f),Ta(d)}function SL(r){for(var t=r[0],e=r[1],i,n,s,a,l=Oa._;l;)if(s=Rv(l,e)-t,s>De)l=l.L;else if(a=t-TL(l,e),a>De){if(!l.R){i=l;break}l=l.R}else{s>-1e-6?(i=l.P,n=l):a>-1e-6?(i=l,n=l.N):i=n=l;break}vL(r);var f=bm(r);if(Oa.insert(i,f),!(!i&&!n)){if(i===n){Na(i),n=bm(i.site),Oa.insert(f,n),f.edge=n.edge=Ou(i.site,f.site),Ta(i),Ta(n);return}if(!n){f.edge=Ou(i.site,f.site);return}Na(i),Na(n);var d=i.site,g=d[0],m=d[1],v=r[0]-g,_=r[1]-m,w=n.site,b=w[0]-g,S=w[1]-m,N=2*(v*S-_*b),k=v*v+_*_,C=b*b+S*S,A=[(S*k-_*C)/N+g,(v*C-b*k)/N+m];qh(n.edge,d,w,A),f.edge=Ou(d,r,null,A),n.edge=Ou(r,w,null,A),Ta(i),Ta(n)}}function Rv(r,t){var e=r.site,i=e[0],n=e[1],s=n-t;if(!s)return i;var a=r.P;if(!a)return-1/0;e=a.site;var l=e[0],f=e[1],d=f-t;if(!d)return l;var g=l-i,m=1/s-1/d,v=g/d;return m?(-v+Math.sqrt(v*v-2*m*(g*g/(-2*d)-f+d/2+n-s/2)))/m+i:(i+l)/2}function TL(r,t){var e=r.N;if(e)return Rv(e,t);var i=r.site;return i[1]===t?i[0]:1/0}var De=1e-6,Oa,Si,nl,Xn;function PL(r,t,e){return(r[0]-e[0])*(t[1]-r[1])-(r[0]-t[0])*(e[1]-r[1])}function IL(r,t){return t[1]-r[1]||t[0]-r[0]}function Zf(r,t){var e=r.sort(IL).pop(),i,n,s;for(Xn=[],Si=new Array(r.length),Oa=new Vh,nl=new Vh;;)if(s=Vd,e&&(!s||e[1]<s.y||e[1]===s.y&&e[0]<s.x))(e[0]!==i||e[1]!==n)&&(SL(e),i=e[0],n=e[1]),e=r.pop();else if(s)LL(s.arc);else break;if(bL(),t){var a=+t[0][0],l=+t[0][1],f=+t[1][0],d=+t[1][1];_L(a,l,f,d),EL(a,l,f,d)}this.edges=Xn,this.cells=Si,Oa=nl=Xn=Si=null}Zf.prototype={constructor:Zf,polygons:function(){var r=this.edges;return this.cells.map(function(t){var e=t.halfedges.map(function(i){return Av(t,r[i])});return e.data=t.site.data,e})},triangles:function(){var r=[],t=this.edges;return this.cells.forEach(function(e,i){if(l=(s=e.halfedges).length)for(var n=e.site,s,a=-1,l,f,d=t[s[l-1]],g=d.left===n?d.right:d.left;++a<l;)f=g,d=t[s[a]],g=d.left===n?d.right:d.left,f&&g&&i<f.index&&i<g.index&&PL(n,f,g)<0&&r.push([n.data,f.data,g.data])}),r},links:function(){return this.edges.filter(function(r){return r.right}).map(function(r){return{source:r.left.data,target:r.right.data}})},find:function(r,t,e){for(var i=this,n,s=i._found||0,a=i.cells.length,l;!(l=i.cells[s]);)if(++s>=a)return null;var f=r-l.site[0],d=t-l.site[1],g=f*f+d*d;do l=i.cells[n=s],s=null,l.halfedges.forEach(function(m){var v=i.edges[m],_=v.left;if(!((_===l.site||!_)&&!(_=v.right))){var w=r-_[0],b=t-_[1],S=w*w+b*b;S<g&&(g=S,s=_.index)}});while(s!==null);return i._found=n,e==null||g<=e*e?l.site:null}};function CL(){var r=pL,t=gL,e=null;function i(n){return new Zf(n.map(function(s,a){var l=[Math.round(r(s,a,n)/De)*De,Math.round(t(s,a,n)/De)*De];return l.index=a,l.data=s,l}),e)}return i.polygons=function(n){return i(n).polygons()},i.links=function(n){return i(n).links()},i.triangles=function(n){return i(n).triangles()},i.x=function(n){return arguments.length?(r=typeof n=="function"?n:xm(+n),i):r},i.y=function(n){return arguments.length?(t=typeof n=="function"?n:xm(+n),i):t},i.extent=function(n){return arguments.length?(e=n==null?null:[[+n[0][0],+n[0][1]],[+n[1][0],+n[1][1]]],i):e&&[[e[0][0],e[0][1]],[e[1][0],e[1][1]]]},i.size=function(n){return arguments.length?(e=n==null?null:[[0,0],[+n[0],+n[1]]],i):e&&[e[1][0]-e[0][0],e[1][1]-e[0][1]]},i}function AL(r){return r=r.slice(),r.push(r[0]),$t([r])}function NL(r,t){if(t=t||{},!ve(t))throw new Error("options is invalid");const e=t.bbox||[-180,-85,180,85];if(!r)throw new Error("points is required");if(!Array.isArray(e))throw new Error("bbox is invalid");return gs(r,"Point","points"),Yt(CL().x(i=>i.geometry.coordinates[0]).y(i=>i.geometry.coordinates[1]).extent([[e[0],e[1]],[e[2],e[3]]]).polygons(r.features).map(function(i,n){return Object.assign(AL(i),{properties:nc(r.features[n].properties)})}))}const OL=Object.freeze(Object.defineProperty({__proto__:null,along:hx,angle:cx,applyFilter:ic,area:dl,areaFactors:Th,azimuthToBearing:$y,bbox:Te,bboxClip:yx,bboxPolygon:pl,bearing:js,bearingToAzimuth:Fa,bezierSpline:wx,booleanClockwise:Ph,booleanConcave:bx,booleanContains:n_,booleanCrosses:u_,booleanDisjoint:Ld,booleanEqual:sw,booleanIntersects:c_,booleanOverlap:Lw,booleanParallel:Sw,booleanPointInPolygon:ie,booleanPointOnLine:ae,booleanTouches:Pw,booleanValid:Iw,booleanWithin:p_,buffer:_b,center:ec,centerMean:Pd,centerMedian:xb,centerOfMass:O_,centroid:Dr,circle:ml,cleanCoords:Uo,clone:bn,cloneProperties:nc,clusterEach:Cd,clusterReduce:B_,clusters:Db,clustersDbscan:Bb,clustersKmeans:qb,collect:Hb,collectionOf:gs,combine:Yb,concave:wE,containsNumber:yd,convertArea:md,convertLength:Bo,convex:N_,coordAll:ju,coordEach:Fe,coordReduce:_d,createBins:Ad,degreesToRadians:je,destination:Fo,difference:qE,dissolve:ZE,distance:we,distanceWeight:K_,earthRadius:yn,ellipse:tv,envelope:ev,explode:rc,factors:Kh,feature:Qe,featureCollection:Yt,featureEach:ye,featureOf:Ju,featureReduce:xd,filterProperties:F_,findPoint:e_,findSegment:t_,flatten:Bf,flattenEach:vn,flattenReduce:Qy,flip:WE,geojsonRbush:tc,geojsonType:jy,geomEach:Rn,geomReduce:wd,geometry:pd,geometryCollection:gd,getCluster:z_,getCoord:me,getCoords:Jt,getGeom:Ae,getType:gi,greatCircle:$E,helpers:ax,hexGrid:iv,interpolate:KE,intersect:Ya,invariant:ux,isNumber:_n,isObject:ve,isobands:mk,isolines:Tk,kinks:Ck,length:hv,lengthToDegrees:Qh,lengthToRadians:Ka,lineArc:cv,lineChunk:Nk,lineEach:Ed,lineIntersect:Or,lineOffset:Gk,lineOverlap:d_,lineReduce:kd,lineSegment:Ku,lineSlice:qk,lineSliceAlong:fv,lineSplit:Hk,lineString:ge,lineStrings:Xy,lineToPolygon:Yk,mask:Wk,meta:fx,midpoint:jk,moranIndex:Kk,multiLineString:no,multiPoint:cl,multiPolygon:pi,nearestNeighborAnalysis:sM,nearestPoint:sc,nearestPointOnLine:os,nearestPointToLine:hM,planepoint:fM,point:re,pointGrid:rv,pointOnFeature:dM,pointToLineDistance:Ud,pointToPolygonDistance:Vf,points:Hy,pointsWithinPolygon:yv,polygon:$t,polygonSmooth:bM,polygonTangents:MM,polygonToLine:Ua,polygonize:wM,polygons:Yy,projection:PM,propEach:vd,propReduce:Ky,propertiesContainsFilter:Nd,quadratAnalysis:IM,radiansToDegrees:cs,radiansToLength:fl,random:zM,randomLineString:Tv,randomPoint:Lv,randomPolygon:Sv,randomPosition:Mv,rectangleGrid:sv,rewind:BM,rhumbBearing:fs,rhumbDestination:Ha,rhumbDistance:Xs,round:Wy,sample:FM,sector:GM,segmentEach:ss,segmentReduce:bd,shortestPath:ZM,simplify:JM,square:dv,squareGrid:Fd,standardDeviationalEllipse:QM,tag:tL,tesselate:rL,tin:G_,toMercator:bv,toWgs84:Ev,transformRotate:Q_,transformScale:Iv,transformTranslate:oL,triangleGrid:ov,truncate:pv,union:aL,unkinkPolygon:dL,validateBBox:$u,validateId:Jy,voronoi:NL},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2010-2024 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const qd="172",Hf=0,RL=1,Dv=2,Em=1,km=100,Mm=204,Lm=205,Sm=3,DL=0,zv=300,Yf=1e3,Ru=1001,Xf=1002,zL=1003,BL=1004,FL=1005,Bv=1006,UL=1007,Fv=1008,GL=1009,VL=1015,Uv=1023,qL=2300,ZL=2301,HL=0,Zd="",Xi="srgb",Tm="srgb-linear",Pm="linear",Gc="srgb",ca=7680,Im=519,Cm=35044,Vl=2e3,Am=2001;class cc{addEventListener(t,e){this._listeners===void 0&&(this._listeners={});const i=this._listeners;i[t]===void 0&&(i[t]=[]),i[t].indexOf(e)===-1&&i[t].push(e)}hasEventListener(t,e){if(this._listeners===void 0)return!1;const i=this._listeners;return i[t]!==void 0&&i[t].indexOf(e)!==-1}removeEventListener(t,e){if(this._listeners===void 0)return;const n=this._listeners[t];if(n!==void 0){const s=n.indexOf(e);s!==-1&&n.splice(s,1)}}dispatchEvent(t){if(this._listeners===void 0)return;const i=this._listeners[t.type];if(i!==void 0){t.target=this;const n=i.slice(0);for(let s=0,a=n.length;s<a;s++)n[s].call(this,t);t.target=null}}}const Hn=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let Nm=1234567;const Gv=Math.PI/180,Vv=180/Math.PI;function Yo(){const r=Math.random()*4294967295|0,t=Math.random()*4294967295|0,e=Math.random()*4294967295|0,i=Math.random()*4294967295|0;return(Hn[r&255]+Hn[r>>8&255]+Hn[r>>16&255]+Hn[r>>24&255]+"-"+Hn[t&255]+Hn[t>>8&255]+"-"+Hn[t>>16&15|64]+Hn[t>>24&255]+"-"+Hn[e&63|128]+Hn[e>>8&255]+"-"+Hn[e>>16&255]+Hn[e>>24&255]+Hn[i&255]+Hn[i>>8&255]+Hn[i>>16&255]+Hn[i>>24&255]).toLowerCase()}function fe(r,t,e){return Math.max(t,Math.min(e,r))}function Hd(r,t){return(r%t+t)%t}function YL(r,t,e,i,n){return i+(r-t)*(n-i)/(e-t)}function XL(r,t,e){return r!==t?(e-r)/(t-r):0}function Gu(r,t,e){return(1-e)*r+e*t}function WL(r,t,e,i){return Gu(r,t,1-Math.exp(-e*i))}function $L(r,t=1){return t-Math.abs(Hd(r,t*2)-t)}function JL(r,t,e){return r<=t?0:r>=e?1:(r=(r-t)/(e-t),r*r*(3-2*r))}function jL(r,t,e){return r<=t?0:r>=e?1:(r=(r-t)/(e-t),r*r*r*(r*(r*6-15)+10))}function KL(r,t){return r+Math.floor(Math.random()*(t-r+1))}function QL(r,t){return r+Math.random()*(t-r)}function tS(r){return r*(.5-Math.random())}function eS(r){r!==void 0&&(Nm=r);let t=Nm+=1831565813;return t=Math.imul(t^t>>>15,t|1),t^=t+Math.imul(t^t>>>7,t|61),((t^t>>>14)>>>0)/4294967296}function nS(r){return r*Gv}function iS(r){return r*Vv}function rS(r){return(r&r-1)===0&&r!==0}function sS(r){return Math.pow(2,Math.ceil(Math.log(r)/Math.LN2))}function oS(r){return Math.pow(2,Math.floor(Math.log(r)/Math.LN2))}function aS(r,t,e,i,n){const s=Math.cos,a=Math.sin,l=s(e/2),f=a(e/2),d=s((t+i)/2),g=a((t+i)/2),m=s((t-i)/2),v=a((t-i)/2),_=s((i-t)/2),w=a((i-t)/2);switch(n){case"XYX":r.set(l*g,f*m,f*v,l*d);break;case"YZY":r.set(f*v,l*g,f*m,l*d);break;case"ZXZ":r.set(f*m,f*v,l*g,l*d);break;case"XZX":r.set(l*g,f*w,f*_,l*d);break;case"YXY":r.set(f*_,l*g,f*w,l*d);break;case"ZYZ":r.set(f*w,f*_,l*g,l*d);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+n)}}function ka(r,t){switch(t.constructor){case Float32Array:return r;case Uint32Array:return r/4294967295;case Uint16Array:return r/65535;case Uint8Array:return r/255;case Int32Array:return Math.max(r/2147483647,-1);case Int16Array:return Math.max(r/32767,-1);case Int8Array:return Math.max(r/127,-1);default:throw new Error("Invalid component type.")}}function Qn(r,t){switch(t.constructor){case Float32Array:return r;case Uint32Array:return Math.round(r*4294967295);case Uint16Array:return Math.round(r*65535);case Uint8Array:return Math.round(r*255);case Int32Array:return Math.round(r*2147483647);case Int16Array:return Math.round(r*32767);case Int8Array:return Math.round(r*127);default:throw new Error("Invalid component type.")}}const Wf={DEG2RAD:Gv,RAD2DEG:Vv,generateUUID:Yo,clamp:fe,euclideanModulo:Hd,mapLinear:YL,inverseLerp:XL,lerp:Gu,damp:WL,pingpong:$L,smoothstep:JL,smootherstep:jL,randInt:KL,randFloat:QL,randFloatSpread:tS,seededRandom:eS,degToRad:nS,radToDeg:iS,isPowerOfTwo:rS,ceilPowerOfTwo:sS,floorPowerOfTwo:oS,setQuaternionFromProperEuler:aS,normalize:Qn,denormalize:ka};class Ht{constructor(t=0,e=0){Ht.prototype.isVector2=!0,this.x=t,this.y=e}get width(){return this.x}set width(t){this.x=t}get height(){return this.y}set height(t){this.y=t}set(t,e){return this.x=t,this.y=e,this}setScalar(t){return this.x=t,this.y=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setComponent(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y)}copy(t){return this.x=t.x,this.y=t.y,this}add(t){return this.x+=t.x,this.y+=t.y,this}addScalar(t){return this.x+=t,this.y+=t,this}addVectors(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this}addScaledVector(t,e){return this.x+=t.x*e,this.y+=t.y*e,this}sub(t){return this.x-=t.x,this.y-=t.y,this}subScalar(t){return this.x-=t,this.y-=t,this}subVectors(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this}multiply(t){return this.x*=t.x,this.y*=t.y,this}multiplyScalar(t){return this.x*=t,this.y*=t,this}divide(t){return this.x/=t.x,this.y/=t.y,this}divideScalar(t){return this.multiplyScalar(1/t)}applyMatrix3(t){const e=this.x,i=this.y,n=t.elements;return this.x=n[0]*e+n[3]*i+n[6],this.y=n[1]*e+n[4]*i+n[7],this}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this}clamp(t,e){return this.x=fe(this.x,t.x,e.x),this.y=fe(this.y,t.y,e.y),this}clampScalar(t,e){return this.x=fe(this.x,t,e),this.y=fe(this.y,t,e),this}clampLength(t,e){const i=this.length();return this.divideScalar(i||1).multiplyScalar(fe(i,t,e))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(t){return this.x*t.x+this.y*t.y}cross(t){return this.x*t.y-this.y*t.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(t){const e=Math.sqrt(this.lengthSq()*t.lengthSq());if(e===0)return Math.PI/2;const i=this.dot(t)/e;return Math.acos(fe(i,-1,1))}distanceTo(t){return Math.sqrt(this.distanceToSquared(t))}distanceToSquared(t){const e=this.x-t.x,i=this.y-t.y;return e*e+i*i}manhattanDistanceTo(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this}lerpVectors(t,e,i){return this.x=t.x+(e.x-t.x)*i,this.y=t.y+(e.y-t.y)*i,this}equals(t){return t.x===this.x&&t.y===this.y}fromArray(t,e=0){return this.x=t[e],this.y=t[e+1],this}toArray(t=[],e=0){return t[e]=this.x,t[e+1]=this.y,t}fromBufferAttribute(t,e){return this.x=t.getX(e),this.y=t.getY(e),this}rotateAround(t,e){const i=Math.cos(e),n=Math.sin(e),s=this.x-t.x,a=this.y-t.y;return this.x=s*i-a*n+t.x,this.y=s*n+a*i+t.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class ro{constructor(t,e,i,n,s,a,l,f,d){ro.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],t!==void 0&&this.set(t,e,i,n,s,a,l,f,d)}set(t,e,i,n,s,a,l,f,d){const g=this.elements;return g[0]=t,g[1]=n,g[2]=l,g[3]=e,g[4]=s,g[5]=f,g[6]=i,g[7]=a,g[8]=d,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(t){const e=this.elements,i=t.elements;return e[0]=i[0],e[1]=i[1],e[2]=i[2],e[3]=i[3],e[4]=i[4],e[5]=i[5],e[6]=i[6],e[7]=i[7],e[8]=i[8],this}extractBasis(t,e,i){return t.setFromMatrix3Column(this,0),e.setFromMatrix3Column(this,1),i.setFromMatrix3Column(this,2),this}setFromMatrix4(t){const e=t.elements;return this.set(e[0],e[4],e[8],e[1],e[5],e[9],e[2],e[6],e[10]),this}multiply(t){return this.multiplyMatrices(this,t)}premultiply(t){return this.multiplyMatrices(t,this)}multiplyMatrices(t,e){const i=t.elements,n=e.elements,s=this.elements,a=i[0],l=i[3],f=i[6],d=i[1],g=i[4],m=i[7],v=i[2],_=i[5],w=i[8],b=n[0],S=n[3],N=n[6],k=n[1],C=n[4],A=n[7],P=n[2],q=n[5],U=n[8];return s[0]=a*b+l*k+f*P,s[3]=a*S+l*C+f*q,s[6]=a*N+l*A+f*U,s[1]=d*b+g*k+m*P,s[4]=d*S+g*C+m*q,s[7]=d*N+g*A+m*U,s[2]=v*b+_*k+w*P,s[5]=v*S+_*C+w*q,s[8]=v*N+_*A+w*U,this}multiplyScalar(t){const e=this.elements;return e[0]*=t,e[3]*=t,e[6]*=t,e[1]*=t,e[4]*=t,e[7]*=t,e[2]*=t,e[5]*=t,e[8]*=t,this}determinant(){const t=this.elements,e=t[0],i=t[1],n=t[2],s=t[3],a=t[4],l=t[5],f=t[6],d=t[7],g=t[8];return e*a*g-e*l*d-i*s*g+i*l*f+n*s*d-n*a*f}invert(){const t=this.elements,e=t[0],i=t[1],n=t[2],s=t[3],a=t[4],l=t[5],f=t[6],d=t[7],g=t[8],m=g*a-l*d,v=l*f-g*s,_=d*s-a*f,w=e*m+i*v+n*_;if(w===0)return this.set(0,0,0,0,0,0,0,0,0);const b=1/w;return t[0]=m*b,t[1]=(n*d-g*i)*b,t[2]=(l*i-n*a)*b,t[3]=v*b,t[4]=(g*e-n*f)*b,t[5]=(n*s-l*e)*b,t[6]=_*b,t[7]=(i*f-d*e)*b,t[8]=(a*e-i*s)*b,this}transpose(){let t;const e=this.elements;return t=e[1],e[1]=e[3],e[3]=t,t=e[2],e[2]=e[6],e[6]=t,t=e[5],e[5]=e[7],e[7]=t,this}getNormalMatrix(t){return this.setFromMatrix4(t).invert().transpose()}transposeIntoArray(t){const e=this.elements;return t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8],this}setUvTransform(t,e,i,n,s,a,l){const f=Math.cos(s),d=Math.sin(s);return this.set(i*f,i*d,-i*(f*a+d*l)+a+t,-n*d,n*f,-n*(-d*a+f*l)+l+e,0,0,1),this}scale(t,e){return this.premultiply(Vc.makeScale(t,e)),this}rotate(t){return this.premultiply(Vc.makeRotation(-t)),this}translate(t,e){return this.premultiply(Vc.makeTranslation(t,e)),this}makeTranslation(t,e){return t.isVector2?this.set(1,0,t.x,0,1,t.y,0,0,1):this.set(1,0,t,0,1,e,0,0,1),this}makeRotation(t){const e=Math.cos(t),i=Math.sin(t);return this.set(e,-i,0,i,e,0,0,0,1),this}makeScale(t,e){return this.set(t,0,0,0,e,0,0,0,1),this}equals(t){const e=this.elements,i=t.elements;for(let n=0;n<9;n++)if(e[n]!==i[n])return!1;return!0}fromArray(t,e=0){for(let i=0;i<9;i++)this.elements[i]=t[i+e];return this}toArray(t=[],e=0){const i=this.elements;return t[e]=i[0],t[e+1]=i[1],t[e+2]=i[2],t[e+3]=i[3],t[e+4]=i[4],t[e+5]=i[5],t[e+6]=i[6],t[e+7]=i[7],t[e+8]=i[8],t}clone(){return new this.constructor().fromArray(this.elements)}}const Vc=new ro;function uS(r){for(let t=r.length-1;t>=0;--t)if(r[t]>=65535)return!0;return!1}function Om(r){return document.createElementNS("http://www.w3.org/1999/xhtml",r)}const Rm=new ro().set(.4123908,.3575843,.1804808,.212639,.7151687,.0721923,.0193308,.1191948,.9505322),Dm=new ro().set(3.2409699,-1.5373832,-.4986108,-.9692436,1.8759675,.0415551,.0556301,-.203977,1.0569715);function lS(){const r={enabled:!0,workingColorSpace:Tm,spaces:{},convert:function(n,s,a){return this.enabled===!1||s===a||!s||!a||(this.spaces[s].transfer===Gc&&(n.r=ls(n.r),n.g=ls(n.g),n.b=ls(n.b)),this.spaces[s].primaries!==this.spaces[a].primaries&&(n.applyMatrix3(this.spaces[s].toXYZ),n.applyMatrix3(this.spaces[a].fromXYZ)),this.spaces[a].transfer===Gc&&(n.r=Ra(n.r),n.g=Ra(n.g),n.b=Ra(n.b))),n},fromWorkingColorSpace:function(n,s){return this.convert(n,this.workingColorSpace,s)},toWorkingColorSpace:function(n,s){return this.convert(n,s,this.workingColorSpace)},getPrimaries:function(n){return this.spaces[n].primaries},getTransfer:function(n){return n===Zd?Pm:this.spaces[n].transfer},getLuminanceCoefficients:function(n,s=this.workingColorSpace){return n.fromArray(this.spaces[s].luminanceCoefficients)},define:function(n){Object.assign(this.spaces,n)},_getMatrix:function(n,s,a){return n.copy(this.spaces[s].toXYZ).multiply(this.spaces[a].fromXYZ)},_getDrawingBufferColorSpace:function(n){return this.spaces[n].outputColorSpaceConfig.drawingBufferColorSpace},_getUnpackColorSpace:function(n=this.workingColorSpace){return this.spaces[n].workingColorSpaceConfig.unpackColorSpace}},t=[.64,.33,.3,.6,.15,.06],e=[.2126,.7152,.0722],i=[.3127,.329];return r.define({[Tm]:{primaries:t,whitePoint:i,transfer:Pm,toXYZ:Rm,fromXYZ:Dm,luminanceCoefficients:e,workingColorSpaceConfig:{unpackColorSpace:Xi},outputColorSpaceConfig:{drawingBufferColorSpace:Xi}},[Xi]:{primaries:t,whitePoint:i,transfer:Gc,toXYZ:Rm,fromXYZ:Dm,luminanceCoefficients:e,outputColorSpaceConfig:{drawingBufferColorSpace:Xi}}}),r}const fr=lS();function ls(r){return r<.04045?r*.0773993808:Math.pow(r*.9478672986+.0521327014,2.4)}function Ra(r){return r<.0031308?r*12.92:1.055*Math.pow(r,.41666)-.055}let fa;class hS{static getDataURL(t){if(/^data:/i.test(t.src)||typeof HTMLCanvasElement>"u")return t.src;let e;if(t instanceof HTMLCanvasElement)e=t;else{fa===void 0&&(fa=Om("canvas")),fa.width=t.width,fa.height=t.height;const i=fa.getContext("2d");t instanceof ImageData?i.putImageData(t,0,0):i.drawImage(t,0,0,t.width,t.height),e=fa}return e.width>2048||e.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",t),e.toDataURL("image/jpeg",.6)):e.toDataURL("image/png")}static sRGBToLinear(t){if(typeof HTMLImageElement<"u"&&t instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&t instanceof ImageBitmap){const e=Om("canvas");e.width=t.width,e.height=t.height;const i=e.getContext("2d");i.drawImage(t,0,0,t.width,t.height);const n=i.getImageData(0,0,t.width,t.height),s=n.data;for(let a=0;a<s.length;a++)s[a]=ls(s[a]/255)*255;return i.putImageData(n,0,0),e}else if(t.data){const e=t.data.slice(0);for(let i=0;i<e.length;i++)e instanceof Uint8Array||e instanceof Uint8ClampedArray?e[i]=Math.floor(ls(e[i]/255)*255):e[i]=ls(e[i]);return{data:e,width:t.width,height:t.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),t}}let cS=0;class qv{constructor(t=null){this.isSource=!0,Object.defineProperty(this,"id",{value:cS++}),this.uuid=Yo(),this.data=t,this.dataReady=!0,this.version=0}set needsUpdate(t){t===!0&&this.version++}toJSON(t){const e=t===void 0||typeof t=="string";if(!e&&t.images[this.uuid]!==void 0)return t.images[this.uuid];const i={uuid:this.uuid,url:""},n=this.data;if(n!==null){let s;if(Array.isArray(n)){s=[];for(let a=0,l=n.length;a<l;a++)n[a].isDataTexture?s.push(qc(n[a].image)):s.push(qc(n[a]))}else s=qc(n);i.url=s}return e||(t.images[this.uuid]=i),i}}function qc(r){return typeof HTMLImageElement<"u"&&r instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&r instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&r instanceof ImageBitmap?hS.getDataURL(r):r.data?{data:Array.from(r.data),width:r.width,height:r.height,type:r.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let fS=0;class Ws extends cc{constructor(t=Ws.DEFAULT_IMAGE,e=Ws.DEFAULT_MAPPING,i=Ru,n=Ru,s=Bv,a=Fv,l=Uv,f=GL,d=Ws.DEFAULT_ANISOTROPY,g=Zd){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:fS++}),this.uuid=Yo(),this.name="",this.source=new qv(t),this.mipmaps=[],this.mapping=e,this.channel=0,this.wrapS=i,this.wrapT=n,this.magFilter=s,this.minFilter=a,this.anisotropy=d,this.format=l,this.internalFormat=null,this.type=f,this.offset=new Ht(0,0),this.repeat=new Ht(1,1),this.center=new Ht(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new ro,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.colorSpace=g,this.userData={},this.version=0,this.onUpdate=null,this.renderTarget=null,this.isRenderTargetTexture=!1,this.pmremVersion=0}get image(){return this.source.data}set image(t=null){this.source.data=t}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(t){return this.name=t.name,this.source=t.source,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.channel=t.channel,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.internalFormat=t.internalFormat,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.center.copy(t.center),this.rotation=t.rotation,this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrix.copy(t.matrix),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.colorSpace=t.colorSpace,this.renderTarget=t.renderTarget,this.isRenderTargetTexture=t.isRenderTargetTexture,this.userData=JSON.parse(JSON.stringify(t.userData)),this.needsUpdate=!0,this}toJSON(t){const e=t===void 0||typeof t=="string";if(!e&&t.textures[this.uuid]!==void 0)return t.textures[this.uuid];const i={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(t).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(i.userData=this.userData),e||(t.textures[this.uuid]=i),i}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(t){if(this.mapping!==zv)return t;if(t.applyMatrix3(this.matrix),t.x<0||t.x>1)switch(this.wrapS){case Yf:t.x=t.x-Math.floor(t.x);break;case Ru:t.x=t.x<0?0:1;break;case Xf:Math.abs(Math.floor(t.x)%2)===1?t.x=Math.ceil(t.x)-t.x:t.x=t.x-Math.floor(t.x);break}if(t.y<0||t.y>1)switch(this.wrapT){case Yf:t.y=t.y-Math.floor(t.y);break;case Ru:t.y=t.y<0?0:1;break;case Xf:Math.abs(Math.floor(t.y)%2)===1?t.y=Math.ceil(t.y)-t.y:t.y=t.y-Math.floor(t.y);break}return this.flipY&&(t.y=1-t.y),t}set needsUpdate(t){t===!0&&(this.version++,this.source.needsUpdate=!0)}set needsPMREMUpdate(t){t===!0&&this.pmremVersion++}}Ws.DEFAULT_IMAGE=null;Ws.DEFAULT_MAPPING=zv;Ws.DEFAULT_ANISOTROPY=1;class yl{constructor(t=0,e=0,i=0,n=1){yl.prototype.isVector4=!0,this.x=t,this.y=e,this.z=i,this.w=n}get width(){return this.z}set width(t){this.z=t}get height(){return this.w}set height(t){this.w=t}set(t,e,i,n){return this.x=t,this.y=e,this.z=i,this.w=n,this}setScalar(t){return this.x=t,this.y=t,this.z=t,this.w=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setZ(t){return this.z=t,this}setW(t){return this.w=t,this}setComponent(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;case 3:this.w=e;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=t.w!==void 0?t.w:1,this}add(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this}addScalar(t){return this.x+=t,this.y+=t,this.z+=t,this.w+=t,this}addVectors(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this.w=t.w+e.w,this}addScaledVector(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this.w+=t.w*e,this}sub(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this}subScalar(t){return this.x-=t,this.y-=t,this.z-=t,this.w-=t,this}subVectors(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this.w=t.w-e.w,this}multiply(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z,this.w*=t.w,this}multiplyScalar(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this}applyMatrix4(t){const e=this.x,i=this.y,n=this.z,s=this.w,a=t.elements;return this.x=a[0]*e+a[4]*i+a[8]*n+a[12]*s,this.y=a[1]*e+a[5]*i+a[9]*n+a[13]*s,this.z=a[2]*e+a[6]*i+a[10]*n+a[14]*s,this.w=a[3]*e+a[7]*i+a[11]*n+a[15]*s,this}divide(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this.w/=t.w,this}divideScalar(t){return this.multiplyScalar(1/t)}setAxisAngleFromQuaternion(t){this.w=2*Math.acos(t.w);const e=Math.sqrt(1-t.w*t.w);return e<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=t.x/e,this.y=t.y/e,this.z=t.z/e),this}setAxisAngleFromRotationMatrix(t){let e,i,n,s;const f=t.elements,d=f[0],g=f[4],m=f[8],v=f[1],_=f[5],w=f[9],b=f[2],S=f[6],N=f[10];if(Math.abs(g-v)<.01&&Math.abs(m-b)<.01&&Math.abs(w-S)<.01){if(Math.abs(g+v)<.1&&Math.abs(m+b)<.1&&Math.abs(w+S)<.1&&Math.abs(d+_+N-3)<.1)return this.set(1,0,0,0),this;e=Math.PI;const C=(d+1)/2,A=(_+1)/2,P=(N+1)/2,q=(g+v)/4,U=(m+b)/4,I=(w+S)/4;return C>A&&C>P?C<.01?(i=0,n=.707106781,s=.707106781):(i=Math.sqrt(C),n=q/i,s=U/i):A>P?A<.01?(i=.707106781,n=0,s=.707106781):(n=Math.sqrt(A),i=q/n,s=I/n):P<.01?(i=.707106781,n=.707106781,s=0):(s=Math.sqrt(P),i=U/s,n=I/s),this.set(i,n,s,e),this}let k=Math.sqrt((S-w)*(S-w)+(m-b)*(m-b)+(v-g)*(v-g));return Math.abs(k)<.001&&(k=1),this.x=(S-w)/k,this.y=(m-b)/k,this.z=(v-g)/k,this.w=Math.acos((d+_+N-1)/2),this}setFromMatrixPosition(t){const e=t.elements;return this.x=e[12],this.y=e[13],this.z=e[14],this.w=e[15],this}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this.w=Math.min(this.w,t.w),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this.w=Math.max(this.w,t.w),this}clamp(t,e){return this.x=fe(this.x,t.x,e.x),this.y=fe(this.y,t.y,e.y),this.z=fe(this.z,t.z,e.z),this.w=fe(this.w,t.w,e.w),this}clampScalar(t,e){return this.x=fe(this.x,t,e),this.y=fe(this.y,t,e),this.z=fe(this.z,t,e),this.w=fe(this.w,t,e),this}clampLength(t,e){const i=this.length();return this.divideScalar(i||1).multiplyScalar(fe(i,t,e))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this.w+=(t.w-this.w)*e,this}lerpVectors(t,e,i){return this.x=t.x+(e.x-t.x)*i,this.y=t.y+(e.y-t.y)*i,this.z=t.z+(e.z-t.z)*i,this.w=t.w+(e.w-t.w)*i,this}equals(t){return t.x===this.x&&t.y===this.y&&t.z===this.z&&t.w===this.w}fromArray(t,e=0){return this.x=t[e],this.y=t[e+1],this.z=t[e+2],this.w=t[e+3],this}toArray(t=[],e=0){return t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t[e+3]=this.w,t}fromBufferAttribute(t,e){return this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this.w=t.getW(e),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class nu{constructor(t=0,e=0,i=0,n=1){this.isQuaternion=!0,this._x=t,this._y=e,this._z=i,this._w=n}static slerpFlat(t,e,i,n,s,a,l){let f=i[n+0],d=i[n+1],g=i[n+2],m=i[n+3];const v=s[a+0],_=s[a+1],w=s[a+2],b=s[a+3];if(l===0){t[e+0]=f,t[e+1]=d,t[e+2]=g,t[e+3]=m;return}if(l===1){t[e+0]=v,t[e+1]=_,t[e+2]=w,t[e+3]=b;return}if(m!==b||f!==v||d!==_||g!==w){let S=1-l;const N=f*v+d*_+g*w+m*b,k=N>=0?1:-1,C=1-N*N;if(C>Number.EPSILON){const P=Math.sqrt(C),q=Math.atan2(P,N*k);S=Math.sin(S*q)/P,l=Math.sin(l*q)/P}const A=l*k;if(f=f*S+v*A,d=d*S+_*A,g=g*S+w*A,m=m*S+b*A,S===1-l){const P=1/Math.sqrt(f*f+d*d+g*g+m*m);f*=P,d*=P,g*=P,m*=P}}t[e]=f,t[e+1]=d,t[e+2]=g,t[e+3]=m}static multiplyQuaternionsFlat(t,e,i,n,s,a){const l=i[n],f=i[n+1],d=i[n+2],g=i[n+3],m=s[a],v=s[a+1],_=s[a+2],w=s[a+3];return t[e]=l*w+g*m+f*_-d*v,t[e+1]=f*w+g*v+d*m-l*_,t[e+2]=d*w+g*_+l*v-f*m,t[e+3]=g*w-l*m-f*v-d*_,t}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get w(){return this._w}set w(t){this._w=t,this._onChangeCallback()}set(t,e,i,n){return this._x=t,this._y=e,this._z=i,this._w=n,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(t){return this._x=t.x,this._y=t.y,this._z=t.z,this._w=t.w,this._onChangeCallback(),this}setFromEuler(t,e=!0){const i=t._x,n=t._y,s=t._z,a=t._order,l=Math.cos,f=Math.sin,d=l(i/2),g=l(n/2),m=l(s/2),v=f(i/2),_=f(n/2),w=f(s/2);switch(a){case"XYZ":this._x=v*g*m+d*_*w,this._y=d*_*m-v*g*w,this._z=d*g*w+v*_*m,this._w=d*g*m-v*_*w;break;case"YXZ":this._x=v*g*m+d*_*w,this._y=d*_*m-v*g*w,this._z=d*g*w-v*_*m,this._w=d*g*m+v*_*w;break;case"ZXY":this._x=v*g*m-d*_*w,this._y=d*_*m+v*g*w,this._z=d*g*w+v*_*m,this._w=d*g*m-v*_*w;break;case"ZYX":this._x=v*g*m-d*_*w,this._y=d*_*m+v*g*w,this._z=d*g*w-v*_*m,this._w=d*g*m+v*_*w;break;case"YZX":this._x=v*g*m+d*_*w,this._y=d*_*m+v*g*w,this._z=d*g*w-v*_*m,this._w=d*g*m-v*_*w;break;case"XZY":this._x=v*g*m-d*_*w,this._y=d*_*m-v*g*w,this._z=d*g*w+v*_*m,this._w=d*g*m+v*_*w;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+a)}return e===!0&&this._onChangeCallback(),this}setFromAxisAngle(t,e){const i=e/2,n=Math.sin(i);return this._x=t.x*n,this._y=t.y*n,this._z=t.z*n,this._w=Math.cos(i),this._onChangeCallback(),this}setFromRotationMatrix(t){const e=t.elements,i=e[0],n=e[4],s=e[8],a=e[1],l=e[5],f=e[9],d=e[2],g=e[6],m=e[10],v=i+l+m;if(v>0){const _=.5/Math.sqrt(v+1);this._w=.25/_,this._x=(g-f)*_,this._y=(s-d)*_,this._z=(a-n)*_}else if(i>l&&i>m){const _=2*Math.sqrt(1+i-l-m);this._w=(g-f)/_,this._x=.25*_,this._y=(n+a)/_,this._z=(s+d)/_}else if(l>m){const _=2*Math.sqrt(1+l-i-m);this._w=(s-d)/_,this._x=(n+a)/_,this._y=.25*_,this._z=(f+g)/_}else{const _=2*Math.sqrt(1+m-i-l);this._w=(a-n)/_,this._x=(s+d)/_,this._y=(f+g)/_,this._z=.25*_}return this._onChangeCallback(),this}setFromUnitVectors(t,e){let i=t.dot(e)+1;return i<Number.EPSILON?(i=0,Math.abs(t.x)>Math.abs(t.z)?(this._x=-t.y,this._y=t.x,this._z=0,this._w=i):(this._x=0,this._y=-t.z,this._z=t.y,this._w=i)):(this._x=t.y*e.z-t.z*e.y,this._y=t.z*e.x-t.x*e.z,this._z=t.x*e.y-t.y*e.x,this._w=i),this.normalize()}angleTo(t){return 2*Math.acos(Math.abs(fe(this.dot(t),-1,1)))}rotateTowards(t,e){const i=this.angleTo(t);if(i===0)return this;const n=Math.min(1,e/i);return this.slerp(t,n),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(t){return this._x*t._x+this._y*t._y+this._z*t._z+this._w*t._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let t=this.length();return t===0?(this._x=0,this._y=0,this._z=0,this._w=1):(t=1/t,this._x=this._x*t,this._y=this._y*t,this._z=this._z*t,this._w=this._w*t),this._onChangeCallback(),this}multiply(t){return this.multiplyQuaternions(this,t)}premultiply(t){return this.multiplyQuaternions(t,this)}multiplyQuaternions(t,e){const i=t._x,n=t._y,s=t._z,a=t._w,l=e._x,f=e._y,d=e._z,g=e._w;return this._x=i*g+a*l+n*d-s*f,this._y=n*g+a*f+s*l-i*d,this._z=s*g+a*d+i*f-n*l,this._w=a*g-i*l-n*f-s*d,this._onChangeCallback(),this}slerp(t,e){if(e===0)return this;if(e===1)return this.copy(t);const i=this._x,n=this._y,s=this._z,a=this._w;let l=a*t._w+i*t._x+n*t._y+s*t._z;if(l<0?(this._w=-t._w,this._x=-t._x,this._y=-t._y,this._z=-t._z,l=-l):this.copy(t),l>=1)return this._w=a,this._x=i,this._y=n,this._z=s,this;const f=1-l*l;if(f<=Number.EPSILON){const _=1-e;return this._w=_*a+e*this._w,this._x=_*i+e*this._x,this._y=_*n+e*this._y,this._z=_*s+e*this._z,this.normalize(),this}const d=Math.sqrt(f),g=Math.atan2(d,l),m=Math.sin((1-e)*g)/d,v=Math.sin(e*g)/d;return this._w=a*m+this._w*v,this._x=i*m+this._x*v,this._y=n*m+this._y*v,this._z=s*m+this._z*v,this._onChangeCallback(),this}slerpQuaternions(t,e,i){return this.copy(t).slerp(e,i)}random(){const t=2*Math.PI*Math.random(),e=2*Math.PI*Math.random(),i=Math.random(),n=Math.sqrt(1-i),s=Math.sqrt(i);return this.set(n*Math.sin(t),n*Math.cos(t),s*Math.sin(e),s*Math.cos(e))}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._w===this._w}fromArray(t,e=0){return this._x=t[e],this._y=t[e+1],this._z=t[e+2],this._w=t[e+3],this._onChangeCallback(),this}toArray(t=[],e=0){return t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._w,t}fromBufferAttribute(t,e){return this._x=t.getX(e),this._y=t.getY(e),this._z=t.getZ(e),this._w=t.getW(e),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class Mt{constructor(t=0,e=0,i=0){Mt.prototype.isVector3=!0,this.x=t,this.y=e,this.z=i}set(t,e,i){return i===void 0&&(i=this.z),this.x=t,this.y=e,this.z=i,this}setScalar(t){return this.x=t,this.y=t,this.z=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setZ(t){return this.z=t,this}setComponent(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(t){return this.x=t.x,this.y=t.y,this.z=t.z,this}add(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this}addScalar(t){return this.x+=t,this.y+=t,this.z+=t,this}addVectors(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this}addScaledVector(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this}sub(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this}subScalar(t){return this.x-=t,this.y-=t,this.z-=t,this}subVectors(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this}multiply(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z,this}multiplyScalar(t){return this.x*=t,this.y*=t,this.z*=t,this}multiplyVectors(t,e){return this.x=t.x*e.x,this.y=t.y*e.y,this.z=t.z*e.z,this}applyEuler(t){return this.applyQuaternion(zm.setFromEuler(t))}applyAxisAngle(t,e){return this.applyQuaternion(zm.setFromAxisAngle(t,e))}applyMatrix3(t){const e=this.x,i=this.y,n=this.z,s=t.elements;return this.x=s[0]*e+s[3]*i+s[6]*n,this.y=s[1]*e+s[4]*i+s[7]*n,this.z=s[2]*e+s[5]*i+s[8]*n,this}applyNormalMatrix(t){return this.applyMatrix3(t).normalize()}applyMatrix4(t){const e=this.x,i=this.y,n=this.z,s=t.elements,a=1/(s[3]*e+s[7]*i+s[11]*n+s[15]);return this.x=(s[0]*e+s[4]*i+s[8]*n+s[12])*a,this.y=(s[1]*e+s[5]*i+s[9]*n+s[13])*a,this.z=(s[2]*e+s[6]*i+s[10]*n+s[14])*a,this}applyQuaternion(t){const e=this.x,i=this.y,n=this.z,s=t.x,a=t.y,l=t.z,f=t.w,d=2*(a*n-l*i),g=2*(l*e-s*n),m=2*(s*i-a*e);return this.x=e+f*d+a*m-l*g,this.y=i+f*g+l*d-s*m,this.z=n+f*m+s*g-a*d,this}project(t){return this.applyMatrix4(t.matrixWorldInverse).applyMatrix4(t.projectionMatrix)}unproject(t){return this.applyMatrix4(t.projectionMatrixInverse).applyMatrix4(t.matrixWorld)}transformDirection(t){const e=this.x,i=this.y,n=this.z,s=t.elements;return this.x=s[0]*e+s[4]*i+s[8]*n,this.y=s[1]*e+s[5]*i+s[9]*n,this.z=s[2]*e+s[6]*i+s[10]*n,this.normalize()}divide(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this}divideScalar(t){return this.multiplyScalar(1/t)}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this}clamp(t,e){return this.x=fe(this.x,t.x,e.x),this.y=fe(this.y,t.y,e.y),this.z=fe(this.z,t.z,e.z),this}clampScalar(t,e){return this.x=fe(this.x,t,e),this.y=fe(this.y,t,e),this.z=fe(this.z,t,e),this}clampLength(t,e){const i=this.length();return this.divideScalar(i||1).multiplyScalar(fe(i,t,e))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this}lerpVectors(t,e,i){return this.x=t.x+(e.x-t.x)*i,this.y=t.y+(e.y-t.y)*i,this.z=t.z+(e.z-t.z)*i,this}cross(t){return this.crossVectors(this,t)}crossVectors(t,e){const i=t.x,n=t.y,s=t.z,a=e.x,l=e.y,f=e.z;return this.x=n*f-s*l,this.y=s*a-i*f,this.z=i*l-n*a,this}projectOnVector(t){const e=t.lengthSq();if(e===0)return this.set(0,0,0);const i=t.dot(this)/e;return this.copy(t).multiplyScalar(i)}projectOnPlane(t){return Zc.copy(this).projectOnVector(t),this.sub(Zc)}reflect(t){return this.sub(Zc.copy(t).multiplyScalar(2*this.dot(t)))}angleTo(t){const e=Math.sqrt(this.lengthSq()*t.lengthSq());if(e===0)return Math.PI/2;const i=this.dot(t)/e;return Math.acos(fe(i,-1,1))}distanceTo(t){return Math.sqrt(this.distanceToSquared(t))}distanceToSquared(t){const e=this.x-t.x,i=this.y-t.y,n=this.z-t.z;return e*e+i*i+n*n}manhattanDistanceTo(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)}setFromSpherical(t){return this.setFromSphericalCoords(t.radius,t.phi,t.theta)}setFromSphericalCoords(t,e,i){const n=Math.sin(e)*t;return this.x=n*Math.sin(i),this.y=Math.cos(e)*t,this.z=n*Math.cos(i),this}setFromCylindrical(t){return this.setFromCylindricalCoords(t.radius,t.theta,t.y)}setFromCylindricalCoords(t,e,i){return this.x=t*Math.sin(e),this.y=i,this.z=t*Math.cos(e),this}setFromMatrixPosition(t){const e=t.elements;return this.x=e[12],this.y=e[13],this.z=e[14],this}setFromMatrixScale(t){const e=this.setFromMatrixColumn(t,0).length(),i=this.setFromMatrixColumn(t,1).length(),n=this.setFromMatrixColumn(t,2).length();return this.x=e,this.y=i,this.z=n,this}setFromMatrixColumn(t,e){return this.fromArray(t.elements,e*4)}setFromMatrix3Column(t,e){return this.fromArray(t.elements,e*3)}setFromEuler(t){return this.x=t._x,this.y=t._y,this.z=t._z,this}setFromColor(t){return this.x=t.r,this.y=t.g,this.z=t.b,this}equals(t){return t.x===this.x&&t.y===this.y&&t.z===this.z}fromArray(t,e=0){return this.x=t[e],this.y=t[e+1],this.z=t[e+2],this}toArray(t=[],e=0){return t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t}fromBufferAttribute(t,e){return this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const t=Math.random()*Math.PI*2,e=Math.random()*2-1,i=Math.sqrt(1-e*e);return this.x=i*Math.cos(t),this.y=e,this.z=i*Math.sin(t),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const Zc=new Mt,zm=new nu;class _l{constructor(t=new Mt(1/0,1/0,1/0),e=new Mt(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=t,this.max=e}set(t,e){return this.min.copy(t),this.max.copy(e),this}setFromArray(t){this.makeEmpty();for(let e=0,i=t.length;e<i;e+=3)this.expandByPoint(dr.fromArray(t,e));return this}setFromBufferAttribute(t){this.makeEmpty();for(let e=0,i=t.count;e<i;e++)this.expandByPoint(dr.fromBufferAttribute(t,e));return this}setFromPoints(t){this.makeEmpty();for(let e=0,i=t.length;e<i;e++)this.expandByPoint(t[e]);return this}setFromCenterAndSize(t,e){const i=dr.copy(e).multiplyScalar(.5);return this.min.copy(t).sub(i),this.max.copy(t).add(i),this}setFromObject(t,e=!1){return this.makeEmpty(),this.expandByObject(t,e)}clone(){return new this.constructor().copy(this)}copy(t){return this.min.copy(t.min),this.max.copy(t.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(t){return this.isEmpty()?t.set(0,0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(t){return this.isEmpty()?t.set(0,0,0):t.subVectors(this.max,this.min)}expandByPoint(t){return this.min.min(t),this.max.max(t),this}expandByVector(t){return this.min.sub(t),this.max.add(t),this}expandByScalar(t){return this.min.addScalar(-t),this.max.addScalar(t),this}expandByObject(t,e=!1){t.updateWorldMatrix(!1,!1);const i=t.geometry;if(i!==void 0){const s=i.getAttribute("position");if(e===!0&&s!==void 0&&t.isInstancedMesh!==!0)for(let a=0,l=s.count;a<l;a++)t.isMesh===!0?t.getVertexPosition(a,dr):dr.fromBufferAttribute(s,a),dr.applyMatrix4(t.matrixWorld),this.expandByPoint(dr);else t.boundingBox!==void 0?(t.boundingBox===null&&t.computeBoundingBox(),ql.copy(t.boundingBox)):(i.boundingBox===null&&i.computeBoundingBox(),ql.copy(i.boundingBox)),ql.applyMatrix4(t.matrixWorld),this.union(ql)}const n=t.children;for(let s=0,a=n.length;s<a;s++)this.expandByObject(n[s],e);return this}containsPoint(t){return t.x>=this.min.x&&t.x<=this.max.x&&t.y>=this.min.y&&t.y<=this.max.y&&t.z>=this.min.z&&t.z<=this.max.z}containsBox(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y&&this.min.z<=t.min.z&&t.max.z<=this.max.z}getParameter(t,e){return e.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y),(t.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(t){return t.max.x>=this.min.x&&t.min.x<=this.max.x&&t.max.y>=this.min.y&&t.min.y<=this.max.y&&t.max.z>=this.min.z&&t.min.z<=this.max.z}intersectsSphere(t){return this.clampPoint(t.center,dr),dr.distanceToSquared(t.center)<=t.radius*t.radius}intersectsPlane(t){let e,i;return t.normal.x>0?(e=t.normal.x*this.min.x,i=t.normal.x*this.max.x):(e=t.normal.x*this.max.x,i=t.normal.x*this.min.x),t.normal.y>0?(e+=t.normal.y*this.min.y,i+=t.normal.y*this.max.y):(e+=t.normal.y*this.max.y,i+=t.normal.y*this.min.y),t.normal.z>0?(e+=t.normal.z*this.min.z,i+=t.normal.z*this.max.z):(e+=t.normal.z*this.max.z,i+=t.normal.z*this.min.z),e<=-t.constant&&i>=-t.constant}intersectsTriangle(t){if(this.isEmpty())return!1;this.getCenter(yu),Zl.subVectors(this.max,yu),da.subVectors(t.a,yu),pa.subVectors(t.b,yu),ga.subVectors(t.c,yu),Us.subVectors(pa,da),Gs.subVectors(ga,pa),Po.subVectors(da,ga);let e=[0,-Us.z,Us.y,0,-Gs.z,Gs.y,0,-Po.z,Po.y,Us.z,0,-Us.x,Gs.z,0,-Gs.x,Po.z,0,-Po.x,-Us.y,Us.x,0,-Gs.y,Gs.x,0,-Po.y,Po.x,0];return!Hc(e,da,pa,ga,Zl)||(e=[1,0,0,0,1,0,0,0,1],!Hc(e,da,pa,ga,Zl))?!1:(Hl.crossVectors(Us,Gs),e=[Hl.x,Hl.y,Hl.z],Hc(e,da,pa,ga,Zl))}clampPoint(t,e){return e.copy(t).clamp(this.min,this.max)}distanceToPoint(t){return this.clampPoint(t,dr).distanceTo(t)}getBoundingSphere(t){return this.isEmpty()?t.makeEmpty():(this.getCenter(t.center),t.radius=this.getSize(dr).length()*.5),t}intersect(t){return this.min.max(t.min),this.max.min(t.max),this.isEmpty()&&this.makeEmpty(),this}union(t){return this.min.min(t.min),this.max.max(t.max),this}applyMatrix4(t){return this.isEmpty()?this:(Kr[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(t),Kr[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(t),Kr[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(t),Kr[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(t),Kr[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(t),Kr[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(t),Kr[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(t),Kr[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(t),this.setFromPoints(Kr),this)}translate(t){return this.min.add(t),this.max.add(t),this}equals(t){return t.min.equals(this.min)&&t.max.equals(this.max)}}const Kr=[new Mt,new Mt,new Mt,new Mt,new Mt,new Mt,new Mt,new Mt],dr=new Mt,ql=new _l,da=new Mt,pa=new Mt,ga=new Mt,Us=new Mt,Gs=new Mt,Po=new Mt,yu=new Mt,Zl=new Mt,Hl=new Mt,Io=new Mt;function Hc(r,t,e,i,n){for(let s=0,a=r.length-3;s<=a;s+=3){Io.fromArray(r,s);const l=n.x*Math.abs(Io.x)+n.y*Math.abs(Io.y)+n.z*Math.abs(Io.z),f=t.dot(Io),d=e.dot(Io),g=i.dot(Io);if(Math.max(-Math.max(f,d,g),Math.min(f,d,g))>l)return!1}return!0}const dS=new _l,_u=new Mt,Yc=new Mt;class Zv{constructor(t=new Mt,e=-1){this.isSphere=!0,this.center=t,this.radius=e}set(t,e){return this.center.copy(t),this.radius=e,this}setFromPoints(t,e){const i=this.center;e!==void 0?i.copy(e):dS.setFromPoints(t).getCenter(i);let n=0;for(let s=0,a=t.length;s<a;s++)n=Math.max(n,i.distanceToSquared(t[s]));return this.radius=Math.sqrt(n),this}copy(t){return this.center.copy(t.center),this.radius=t.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(t){return t.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(t){return t.distanceTo(this.center)-this.radius}intersectsSphere(t){const e=this.radius+t.radius;return t.center.distanceToSquared(this.center)<=e*e}intersectsBox(t){return t.intersectsSphere(this)}intersectsPlane(t){return Math.abs(t.distanceToPoint(this.center))<=this.radius}clampPoint(t,e){const i=this.center.distanceToSquared(t);return e.copy(t),i>this.radius*this.radius&&(e.sub(this.center).normalize(),e.multiplyScalar(this.radius).add(this.center)),e}getBoundingBox(t){return this.isEmpty()?(t.makeEmpty(),t):(t.set(this.center,this.center),t.expandByScalar(this.radius),t)}applyMatrix4(t){return this.center.applyMatrix4(t),this.radius=this.radius*t.getMaxScaleOnAxis(),this}translate(t){return this.center.add(t),this}expandByPoint(t){if(this.isEmpty())return this.center.copy(t),this.radius=0,this;_u.subVectors(t,this.center);const e=_u.lengthSq();if(e>this.radius*this.radius){const i=Math.sqrt(e),n=(i-this.radius)*.5;this.center.addScaledVector(_u,n/i),this.radius+=n}return this}union(t){return t.isEmpty()?this:this.isEmpty()?(this.copy(t),this):(this.center.equals(t.center)===!0?this.radius=Math.max(this.radius,t.radius):(Yc.subVectors(t.center,this.center).setLength(t.radius),this.expandByPoint(_u.copy(t.center).add(Yc)),this.expandByPoint(_u.copy(t.center).sub(Yc))),this)}equals(t){return t.center.equals(this.center)&&t.radius===this.radius}clone(){return new this.constructor().copy(this)}}const Qr=new Mt,Xc=new Mt,Yl=new Mt,Vs=new Mt,Wc=new Mt,Xl=new Mt,$c=new Mt;class pS{constructor(t=new Mt,e=new Mt(0,0,-1)){this.origin=t,this.direction=e}set(t,e){return this.origin.copy(t),this.direction.copy(e),this}copy(t){return this.origin.copy(t.origin),this.direction.copy(t.direction),this}at(t,e){return e.copy(this.origin).addScaledVector(this.direction,t)}lookAt(t){return this.direction.copy(t).sub(this.origin).normalize(),this}recast(t){return this.origin.copy(this.at(t,Qr)),this}closestPointToPoint(t,e){e.subVectors(t,this.origin);const i=e.dot(this.direction);return i<0?e.copy(this.origin):e.copy(this.origin).addScaledVector(this.direction,i)}distanceToPoint(t){return Math.sqrt(this.distanceSqToPoint(t))}distanceSqToPoint(t){const e=Qr.subVectors(t,this.origin).dot(this.direction);return e<0?this.origin.distanceToSquared(t):(Qr.copy(this.origin).addScaledVector(this.direction,e),Qr.distanceToSquared(t))}distanceSqToSegment(t,e,i,n){Xc.copy(t).add(e).multiplyScalar(.5),Yl.copy(e).sub(t).normalize(),Vs.copy(this.origin).sub(Xc);const s=t.distanceTo(e)*.5,a=-this.direction.dot(Yl),l=Vs.dot(this.direction),f=-Vs.dot(Yl),d=Vs.lengthSq(),g=Math.abs(1-a*a);let m,v,_,w;if(g>0)if(m=a*f-l,v=a*l-f,w=s*g,m>=0)if(v>=-w)if(v<=w){const b=1/g;m*=b,v*=b,_=m*(m+a*v+2*l)+v*(a*m+v+2*f)+d}else v=s,m=Math.max(0,-(a*v+l)),_=-m*m+v*(v+2*f)+d;else v=-s,m=Math.max(0,-(a*v+l)),_=-m*m+v*(v+2*f)+d;else v<=-w?(m=Math.max(0,-(-a*s+l)),v=m>0?-s:Math.min(Math.max(-s,-f),s),_=-m*m+v*(v+2*f)+d):v<=w?(m=0,v=Math.min(Math.max(-s,-f),s),_=v*(v+2*f)+d):(m=Math.max(0,-(a*s+l)),v=m>0?s:Math.min(Math.max(-s,-f),s),_=-m*m+v*(v+2*f)+d);else v=a>0?-s:s,m=Math.max(0,-(a*v+l)),_=-m*m+v*(v+2*f)+d;return i&&i.copy(this.origin).addScaledVector(this.direction,m),n&&n.copy(Xc).addScaledVector(Yl,v),_}intersectSphere(t,e){Qr.subVectors(t.center,this.origin);const i=Qr.dot(this.direction),n=Qr.dot(Qr)-i*i,s=t.radius*t.radius;if(n>s)return null;const a=Math.sqrt(s-n),l=i-a,f=i+a;return f<0?null:l<0?this.at(f,e):this.at(l,e)}intersectsSphere(t){return this.distanceSqToPoint(t.center)<=t.radius*t.radius}distanceToPlane(t){const e=t.normal.dot(this.direction);if(e===0)return t.distanceToPoint(this.origin)===0?0:null;const i=-(this.origin.dot(t.normal)+t.constant)/e;return i>=0?i:null}intersectPlane(t,e){const i=this.distanceToPlane(t);return i===null?null:this.at(i,e)}intersectsPlane(t){const e=t.distanceToPoint(this.origin);return e===0||t.normal.dot(this.direction)*e<0}intersectBox(t,e){let i,n,s,a,l,f;const d=1/this.direction.x,g=1/this.direction.y,m=1/this.direction.z,v=this.origin;return d>=0?(i=(t.min.x-v.x)*d,n=(t.max.x-v.x)*d):(i=(t.max.x-v.x)*d,n=(t.min.x-v.x)*d),g>=0?(s=(t.min.y-v.y)*g,a=(t.max.y-v.y)*g):(s=(t.max.y-v.y)*g,a=(t.min.y-v.y)*g),i>a||s>n||((s>i||isNaN(i))&&(i=s),(a<n||isNaN(n))&&(n=a),m>=0?(l=(t.min.z-v.z)*m,f=(t.max.z-v.z)*m):(l=(t.max.z-v.z)*m,f=(t.min.z-v.z)*m),i>f||l>n)||((l>i||i!==i)&&(i=l),(f<n||n!==n)&&(n=f),n<0)?null:this.at(i>=0?i:n,e)}intersectsBox(t){return this.intersectBox(t,Qr)!==null}intersectTriangle(t,e,i,n,s){Wc.subVectors(e,t),Xl.subVectors(i,t),$c.crossVectors(Wc,Xl);let a=this.direction.dot($c),l;if(a>0){if(n)return null;l=1}else if(a<0)l=-1,a=-a;else return null;Vs.subVectors(this.origin,t);const f=l*this.direction.dot(Xl.crossVectors(Vs,Xl));if(f<0)return null;const d=l*this.direction.dot(Wc.cross(Vs));if(d<0||f+d>a)return null;const g=-l*Vs.dot($c);return g<0?null:this.at(g/a,s)}applyMatrix4(t){return this.origin.applyMatrix4(t),this.direction.transformDirection(t),this}equals(t){return t.origin.equals(this.origin)&&t.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class di{constructor(t,e,i,n,s,a,l,f,d,g,m,v,_,w,b,S){di.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],t!==void 0&&this.set(t,e,i,n,s,a,l,f,d,g,m,v,_,w,b,S)}set(t,e,i,n,s,a,l,f,d,g,m,v,_,w,b,S){const N=this.elements;return N[0]=t,N[4]=e,N[8]=i,N[12]=n,N[1]=s,N[5]=a,N[9]=l,N[13]=f,N[2]=d,N[6]=g,N[10]=m,N[14]=v,N[3]=_,N[7]=w,N[11]=b,N[15]=S,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new di().fromArray(this.elements)}copy(t){const e=this.elements,i=t.elements;return e[0]=i[0],e[1]=i[1],e[2]=i[2],e[3]=i[3],e[4]=i[4],e[5]=i[5],e[6]=i[6],e[7]=i[7],e[8]=i[8],e[9]=i[9],e[10]=i[10],e[11]=i[11],e[12]=i[12],e[13]=i[13],e[14]=i[14],e[15]=i[15],this}copyPosition(t){const e=this.elements,i=t.elements;return e[12]=i[12],e[13]=i[13],e[14]=i[14],this}setFromMatrix3(t){const e=t.elements;return this.set(e[0],e[3],e[6],0,e[1],e[4],e[7],0,e[2],e[5],e[8],0,0,0,0,1),this}extractBasis(t,e,i){return t.setFromMatrixColumn(this,0),e.setFromMatrixColumn(this,1),i.setFromMatrixColumn(this,2),this}makeBasis(t,e,i){return this.set(t.x,e.x,i.x,0,t.y,e.y,i.y,0,t.z,e.z,i.z,0,0,0,0,1),this}extractRotation(t){const e=this.elements,i=t.elements,n=1/ma.setFromMatrixColumn(t,0).length(),s=1/ma.setFromMatrixColumn(t,1).length(),a=1/ma.setFromMatrixColumn(t,2).length();return e[0]=i[0]*n,e[1]=i[1]*n,e[2]=i[2]*n,e[3]=0,e[4]=i[4]*s,e[5]=i[5]*s,e[6]=i[6]*s,e[7]=0,e[8]=i[8]*a,e[9]=i[9]*a,e[10]=i[10]*a,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this}makeRotationFromEuler(t){const e=this.elements,i=t.x,n=t.y,s=t.z,a=Math.cos(i),l=Math.sin(i),f=Math.cos(n),d=Math.sin(n),g=Math.cos(s),m=Math.sin(s);if(t.order==="XYZ"){const v=a*g,_=a*m,w=l*g,b=l*m;e[0]=f*g,e[4]=-f*m,e[8]=d,e[1]=_+w*d,e[5]=v-b*d,e[9]=-l*f,e[2]=b-v*d,e[6]=w+_*d,e[10]=a*f}else if(t.order==="YXZ"){const v=f*g,_=f*m,w=d*g,b=d*m;e[0]=v+b*l,e[4]=w*l-_,e[8]=a*d,e[1]=a*m,e[5]=a*g,e[9]=-l,e[2]=_*l-w,e[6]=b+v*l,e[10]=a*f}else if(t.order==="ZXY"){const v=f*g,_=f*m,w=d*g,b=d*m;e[0]=v-b*l,e[4]=-a*m,e[8]=w+_*l,e[1]=_+w*l,e[5]=a*g,e[9]=b-v*l,e[2]=-a*d,e[6]=l,e[10]=a*f}else if(t.order==="ZYX"){const v=a*g,_=a*m,w=l*g,b=l*m;e[0]=f*g,e[4]=w*d-_,e[8]=v*d+b,e[1]=f*m,e[5]=b*d+v,e[9]=_*d-w,e[2]=-d,e[6]=l*f,e[10]=a*f}else if(t.order==="YZX"){const v=a*f,_=a*d,w=l*f,b=l*d;e[0]=f*g,e[4]=b-v*m,e[8]=w*m+_,e[1]=m,e[5]=a*g,e[9]=-l*g,e[2]=-d*g,e[6]=_*m+w,e[10]=v-b*m}else if(t.order==="XZY"){const v=a*f,_=a*d,w=l*f,b=l*d;e[0]=f*g,e[4]=-m,e[8]=d*g,e[1]=v*m+b,e[5]=a*g,e[9]=_*m-w,e[2]=w*m-_,e[6]=l*g,e[10]=b*m+v}return e[3]=0,e[7]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this}makeRotationFromQuaternion(t){return this.compose(gS,t,mS)}lookAt(t,e,i){const n=this.elements;return Ei.subVectors(t,e),Ei.lengthSq()===0&&(Ei.z=1),Ei.normalize(),qs.crossVectors(i,Ei),qs.lengthSq()===0&&(Math.abs(i.z)===1?Ei.x+=1e-4:Ei.z+=1e-4,Ei.normalize(),qs.crossVectors(i,Ei)),qs.normalize(),Wl.crossVectors(Ei,qs),n[0]=qs.x,n[4]=Wl.x,n[8]=Ei.x,n[1]=qs.y,n[5]=Wl.y,n[9]=Ei.y,n[2]=qs.z,n[6]=Wl.z,n[10]=Ei.z,this}multiply(t){return this.multiplyMatrices(this,t)}premultiply(t){return this.multiplyMatrices(t,this)}multiplyMatrices(t,e){const i=t.elements,n=e.elements,s=this.elements,a=i[0],l=i[4],f=i[8],d=i[12],g=i[1],m=i[5],v=i[9],_=i[13],w=i[2],b=i[6],S=i[10],N=i[14],k=i[3],C=i[7],A=i[11],P=i[15],q=n[0],U=n[4],I=n[8],O=n[12],B=n[1],V=n[5],z=n[9],W=n[13],T=n[2],$=n[6],F=n[10],X=n[14],Y=n[3],j=n[7],J=n[11],K=n[15];return s[0]=a*q+l*B+f*T+d*Y,s[4]=a*U+l*V+f*$+d*j,s[8]=a*I+l*z+f*F+d*J,s[12]=a*O+l*W+f*X+d*K,s[1]=g*q+m*B+v*T+_*Y,s[5]=g*U+m*V+v*$+_*j,s[9]=g*I+m*z+v*F+_*J,s[13]=g*O+m*W+v*X+_*K,s[2]=w*q+b*B+S*T+N*Y,s[6]=w*U+b*V+S*$+N*j,s[10]=w*I+b*z+S*F+N*J,s[14]=w*O+b*W+S*X+N*K,s[3]=k*q+C*B+A*T+P*Y,s[7]=k*U+C*V+A*$+P*j,s[11]=k*I+C*z+A*F+P*J,s[15]=k*O+C*W+A*X+P*K,this}multiplyScalar(t){const e=this.elements;return e[0]*=t,e[4]*=t,e[8]*=t,e[12]*=t,e[1]*=t,e[5]*=t,e[9]*=t,e[13]*=t,e[2]*=t,e[6]*=t,e[10]*=t,e[14]*=t,e[3]*=t,e[7]*=t,e[11]*=t,e[15]*=t,this}determinant(){const t=this.elements,e=t[0],i=t[4],n=t[8],s=t[12],a=t[1],l=t[5],f=t[9],d=t[13],g=t[2],m=t[6],v=t[10],_=t[14],w=t[3],b=t[7],S=t[11],N=t[15];return w*(+s*f*m-n*d*m-s*l*v+i*d*v+n*l*_-i*f*_)+b*(+e*f*_-e*d*v+s*a*v-n*a*_+n*d*g-s*f*g)+S*(+e*d*m-e*l*_-s*a*m+i*a*_+s*l*g-i*d*g)+N*(-n*l*g-e*f*m+e*l*v+n*a*m-i*a*v+i*f*g)}transpose(){const t=this.elements;let e;return e=t[1],t[1]=t[4],t[4]=e,e=t[2],t[2]=t[8],t[8]=e,e=t[6],t[6]=t[9],t[9]=e,e=t[3],t[3]=t[12],t[12]=e,e=t[7],t[7]=t[13],t[13]=e,e=t[11],t[11]=t[14],t[14]=e,this}setPosition(t,e,i){const n=this.elements;return t.isVector3?(n[12]=t.x,n[13]=t.y,n[14]=t.z):(n[12]=t,n[13]=e,n[14]=i),this}invert(){const t=this.elements,e=t[0],i=t[1],n=t[2],s=t[3],a=t[4],l=t[5],f=t[6],d=t[7],g=t[8],m=t[9],v=t[10],_=t[11],w=t[12],b=t[13],S=t[14],N=t[15],k=m*S*d-b*v*d+b*f*_-l*S*_-m*f*N+l*v*N,C=w*v*d-g*S*d-w*f*_+a*S*_+g*f*N-a*v*N,A=g*b*d-w*m*d+w*l*_-a*b*_-g*l*N+a*m*N,P=w*m*f-g*b*f-w*l*v+a*b*v+g*l*S-a*m*S,q=e*k+i*C+n*A+s*P;if(q===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const U=1/q;return t[0]=k*U,t[1]=(b*v*s-m*S*s-b*n*_+i*S*_+m*n*N-i*v*N)*U,t[2]=(l*S*s-b*f*s+b*n*d-i*S*d-l*n*N+i*f*N)*U,t[3]=(m*f*s-l*v*s-m*n*d+i*v*d+l*n*_-i*f*_)*U,t[4]=C*U,t[5]=(g*S*s-w*v*s+w*n*_-e*S*_-g*n*N+e*v*N)*U,t[6]=(w*f*s-a*S*s-w*n*d+e*S*d+a*n*N-e*f*N)*U,t[7]=(a*v*s-g*f*s+g*n*d-e*v*d-a*n*_+e*f*_)*U,t[8]=A*U,t[9]=(w*m*s-g*b*s-w*i*_+e*b*_+g*i*N-e*m*N)*U,t[10]=(a*b*s-w*l*s+w*i*d-e*b*d-a*i*N+e*l*N)*U,t[11]=(g*l*s-a*m*s-g*i*d+e*m*d+a*i*_-e*l*_)*U,t[12]=P*U,t[13]=(g*b*n-w*m*n+w*i*v-e*b*v-g*i*S+e*m*S)*U,t[14]=(w*l*n-a*b*n-w*i*f+e*b*f+a*i*S-e*l*S)*U,t[15]=(a*m*n-g*l*n+g*i*f-e*m*f-a*i*v+e*l*v)*U,this}scale(t){const e=this.elements,i=t.x,n=t.y,s=t.z;return e[0]*=i,e[4]*=n,e[8]*=s,e[1]*=i,e[5]*=n,e[9]*=s,e[2]*=i,e[6]*=n,e[10]*=s,e[3]*=i,e[7]*=n,e[11]*=s,this}getMaxScaleOnAxis(){const t=this.elements,e=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],i=t[4]*t[4]+t[5]*t[5]+t[6]*t[6],n=t[8]*t[8]+t[9]*t[9]+t[10]*t[10];return Math.sqrt(Math.max(e,i,n))}makeTranslation(t,e,i){return t.isVector3?this.set(1,0,0,t.x,0,1,0,t.y,0,0,1,t.z,0,0,0,1):this.set(1,0,0,t,0,1,0,e,0,0,1,i,0,0,0,1),this}makeRotationX(t){const e=Math.cos(t),i=Math.sin(t);return this.set(1,0,0,0,0,e,-i,0,0,i,e,0,0,0,0,1),this}makeRotationY(t){const e=Math.cos(t),i=Math.sin(t);return this.set(e,0,i,0,0,1,0,0,-i,0,e,0,0,0,0,1),this}makeRotationZ(t){const e=Math.cos(t),i=Math.sin(t);return this.set(e,-i,0,0,i,e,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(t,e){const i=Math.cos(e),n=Math.sin(e),s=1-i,a=t.x,l=t.y,f=t.z,d=s*a,g=s*l;return this.set(d*a+i,d*l-n*f,d*f+n*l,0,d*l+n*f,g*l+i,g*f-n*a,0,d*f-n*l,g*f+n*a,s*f*f+i,0,0,0,0,1),this}makeScale(t,e,i){return this.set(t,0,0,0,0,e,0,0,0,0,i,0,0,0,0,1),this}makeShear(t,e,i,n,s,a){return this.set(1,i,s,0,t,1,a,0,e,n,1,0,0,0,0,1),this}compose(t,e,i){const n=this.elements,s=e._x,a=e._y,l=e._z,f=e._w,d=s+s,g=a+a,m=l+l,v=s*d,_=s*g,w=s*m,b=a*g,S=a*m,N=l*m,k=f*d,C=f*g,A=f*m,P=i.x,q=i.y,U=i.z;return n[0]=(1-(b+N))*P,n[1]=(_+A)*P,n[2]=(w-C)*P,n[3]=0,n[4]=(_-A)*q,n[5]=(1-(v+N))*q,n[6]=(S+k)*q,n[7]=0,n[8]=(w+C)*U,n[9]=(S-k)*U,n[10]=(1-(v+b))*U,n[11]=0,n[12]=t.x,n[13]=t.y,n[14]=t.z,n[15]=1,this}decompose(t,e,i){const n=this.elements;let s=ma.set(n[0],n[1],n[2]).length();const a=ma.set(n[4],n[5],n[6]).length(),l=ma.set(n[8],n[9],n[10]).length();this.determinant()<0&&(s=-s),t.x=n[12],t.y=n[13],t.z=n[14],pr.copy(this);const d=1/s,g=1/a,m=1/l;return pr.elements[0]*=d,pr.elements[1]*=d,pr.elements[2]*=d,pr.elements[4]*=g,pr.elements[5]*=g,pr.elements[6]*=g,pr.elements[8]*=m,pr.elements[9]*=m,pr.elements[10]*=m,e.setFromRotationMatrix(pr),i.x=s,i.y=a,i.z=l,this}makePerspective(t,e,i,n,s,a,l=Vl){const f=this.elements,d=2*s/(e-t),g=2*s/(i-n),m=(e+t)/(e-t),v=(i+n)/(i-n);let _,w;if(l===Vl)_=-(a+s)/(a-s),w=-2*a*s/(a-s);else if(l===Am)_=-a/(a-s),w=-a*s/(a-s);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+l);return f[0]=d,f[4]=0,f[8]=m,f[12]=0,f[1]=0,f[5]=g,f[9]=v,f[13]=0,f[2]=0,f[6]=0,f[10]=_,f[14]=w,f[3]=0,f[7]=0,f[11]=-1,f[15]=0,this}makeOrthographic(t,e,i,n,s,a,l=Vl){const f=this.elements,d=1/(e-t),g=1/(i-n),m=1/(a-s),v=(e+t)*d,_=(i+n)*g;let w,b;if(l===Vl)w=(a+s)*m,b=-2*m;else if(l===Am)w=s*m,b=-1*m;else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+l);return f[0]=2*d,f[4]=0,f[8]=0,f[12]=-v,f[1]=0,f[5]=2*g,f[9]=0,f[13]=-_,f[2]=0,f[6]=0,f[10]=b,f[14]=-w,f[3]=0,f[7]=0,f[11]=0,f[15]=1,this}equals(t){const e=this.elements,i=t.elements;for(let n=0;n<16;n++)if(e[n]!==i[n])return!1;return!0}fromArray(t,e=0){for(let i=0;i<16;i++)this.elements[i]=t[i+e];return this}toArray(t=[],e=0){const i=this.elements;return t[e]=i[0],t[e+1]=i[1],t[e+2]=i[2],t[e+3]=i[3],t[e+4]=i[4],t[e+5]=i[5],t[e+6]=i[6],t[e+7]=i[7],t[e+8]=i[8],t[e+9]=i[9],t[e+10]=i[10],t[e+11]=i[11],t[e+12]=i[12],t[e+13]=i[13],t[e+14]=i[14],t[e+15]=i[15],t}}const ma=new Mt,pr=new di,gS=new Mt(0,0,0),mS=new Mt(1,1,1),qs=new Mt,Wl=new Mt,Ei=new Mt,Bm=new di,Fm=new nu;class Qs{constructor(t=0,e=0,i=0,n=Qs.DEFAULT_ORDER){this.isEuler=!0,this._x=t,this._y=e,this._z=i,this._order=n}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get order(){return this._order}set order(t){this._order=t,this._onChangeCallback()}set(t,e,i,n=this._order){return this._x=t,this._y=e,this._z=i,this._order=n,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this._onChangeCallback(),this}setFromRotationMatrix(t,e=this._order,i=!0){const n=t.elements,s=n[0],a=n[4],l=n[8],f=n[1],d=n[5],g=n[9],m=n[2],v=n[6],_=n[10];switch(e){case"XYZ":this._y=Math.asin(fe(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(-g,_),this._z=Math.atan2(-a,s)):(this._x=Math.atan2(v,d),this._z=0);break;case"YXZ":this._x=Math.asin(-fe(g,-1,1)),Math.abs(g)<.9999999?(this._y=Math.atan2(l,_),this._z=Math.atan2(f,d)):(this._y=Math.atan2(-m,s),this._z=0);break;case"ZXY":this._x=Math.asin(fe(v,-1,1)),Math.abs(v)<.9999999?(this._y=Math.atan2(-m,_),this._z=Math.atan2(-a,d)):(this._y=0,this._z=Math.atan2(f,s));break;case"ZYX":this._y=Math.asin(-fe(m,-1,1)),Math.abs(m)<.9999999?(this._x=Math.atan2(v,_),this._z=Math.atan2(f,s)):(this._x=0,this._z=Math.atan2(-a,d));break;case"YZX":this._z=Math.asin(fe(f,-1,1)),Math.abs(f)<.9999999?(this._x=Math.atan2(-g,d),this._y=Math.atan2(-m,s)):(this._x=0,this._y=Math.atan2(l,_));break;case"XZY":this._z=Math.asin(-fe(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(v,d),this._y=Math.atan2(l,s)):(this._x=Math.atan2(-g,_),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+e)}return this._order=e,i===!0&&this._onChangeCallback(),this}setFromQuaternion(t,e,i){return Bm.makeRotationFromQuaternion(t),this.setFromRotationMatrix(Bm,e,i)}setFromVector3(t,e=this._order){return this.set(t.x,t.y,t.z,e)}reorder(t){return Fm.setFromEuler(this),this.setFromQuaternion(Fm,t)}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order}fromArray(t){return this._x=t[0],this._y=t[1],this._z=t[2],t[3]!==void 0&&(this._order=t[3]),this._onChangeCallback(),this}toArray(t=[],e=0){return t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._order,t}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}Qs.DEFAULT_ORDER="XYZ";class yS{constructor(){this.mask=1}set(t){this.mask=(1<<t|0)>>>0}enable(t){this.mask|=1<<t|0}enableAll(){this.mask=-1}toggle(t){this.mask^=1<<t|0}disable(t){this.mask&=~(1<<t|0)}disableAll(){this.mask=0}test(t){return(this.mask&t.mask)!==0}isEnabled(t){return(this.mask&(1<<t|0))!==0}}let _S=0;const Um=new Mt,ya=new nu,ts=new di,$l=new Mt,vu=new Mt,vS=new Mt,xS=new nu,Gm=new Mt(1,0,0),Vm=new Mt(0,1,0),qm=new Mt(0,0,1),Zm={type:"added"},wS={type:"removed"},_a={type:"childadded",child:null},Jc={type:"childremoved",child:null};class yr extends cc{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:_S++}),this.uuid=Yo(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=yr.DEFAULT_UP.clone();const t=new Mt,e=new Qs,i=new nu,n=new Mt(1,1,1);function s(){i.setFromEuler(e,!1)}function a(){e.setFromQuaternion(i,void 0,!1)}e._onChange(s),i._onChange(a),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:t},rotation:{configurable:!0,enumerable:!0,value:e},quaternion:{configurable:!0,enumerable:!0,value:i},scale:{configurable:!0,enumerable:!0,value:n},modelViewMatrix:{value:new di},normalMatrix:{value:new ro}}),this.matrix=new di,this.matrixWorld=new di,this.matrixAutoUpdate=yr.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=yr.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new yS,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(t){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(t),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(t){return this.quaternion.premultiply(t),this}setRotationFromAxisAngle(t,e){this.quaternion.setFromAxisAngle(t,e)}setRotationFromEuler(t){this.quaternion.setFromEuler(t,!0)}setRotationFromMatrix(t){this.quaternion.setFromRotationMatrix(t)}setRotationFromQuaternion(t){this.quaternion.copy(t)}rotateOnAxis(t,e){return ya.setFromAxisAngle(t,e),this.quaternion.multiply(ya),this}rotateOnWorldAxis(t,e){return ya.setFromAxisAngle(t,e),this.quaternion.premultiply(ya),this}rotateX(t){return this.rotateOnAxis(Gm,t)}rotateY(t){return this.rotateOnAxis(Vm,t)}rotateZ(t){return this.rotateOnAxis(qm,t)}translateOnAxis(t,e){return Um.copy(t).applyQuaternion(this.quaternion),this.position.add(Um.multiplyScalar(e)),this}translateX(t){return this.translateOnAxis(Gm,t)}translateY(t){return this.translateOnAxis(Vm,t)}translateZ(t){return this.translateOnAxis(qm,t)}localToWorld(t){return this.updateWorldMatrix(!0,!1),t.applyMatrix4(this.matrixWorld)}worldToLocal(t){return this.updateWorldMatrix(!0,!1),t.applyMatrix4(ts.copy(this.matrixWorld).invert())}lookAt(t,e,i){t.isVector3?$l.copy(t):$l.set(t,e,i);const n=this.parent;this.updateWorldMatrix(!0,!1),vu.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?ts.lookAt(vu,$l,this.up):ts.lookAt($l,vu,this.up),this.quaternion.setFromRotationMatrix(ts),n&&(ts.extractRotation(n.matrixWorld),ya.setFromRotationMatrix(ts),this.quaternion.premultiply(ya.invert()))}add(t){if(arguments.length>1){for(let e=0;e<arguments.length;e++)this.add(arguments[e]);return this}return t===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",t),this):(t&&t.isObject3D?(t.removeFromParent(),t.parent=this,this.children.push(t),t.dispatchEvent(Zm),_a.child=t,this.dispatchEvent(_a),_a.child=null):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",t),this)}remove(t){if(arguments.length>1){for(let i=0;i<arguments.length;i++)this.remove(arguments[i]);return this}const e=this.children.indexOf(t);return e!==-1&&(t.parent=null,this.children.splice(e,1),t.dispatchEvent(wS),Jc.child=t,this.dispatchEvent(Jc),Jc.child=null),this}removeFromParent(){const t=this.parent;return t!==null&&t.remove(this),this}clear(){return this.remove(...this.children)}attach(t){return this.updateWorldMatrix(!0,!1),ts.copy(this.matrixWorld).invert(),t.parent!==null&&(t.parent.updateWorldMatrix(!0,!1),ts.multiply(t.parent.matrixWorld)),t.applyMatrix4(ts),t.removeFromParent(),t.parent=this,this.children.push(t),t.updateWorldMatrix(!1,!0),t.dispatchEvent(Zm),_a.child=t,this.dispatchEvent(_a),_a.child=null,this}getObjectById(t){return this.getObjectByProperty("id",t)}getObjectByName(t){return this.getObjectByProperty("name",t)}getObjectByProperty(t,e){if(this[t]===e)return this;for(let i=0,n=this.children.length;i<n;i++){const a=this.children[i].getObjectByProperty(t,e);if(a!==void 0)return a}}getObjectsByProperty(t,e,i=[]){this[t]===e&&i.push(this);const n=this.children;for(let s=0,a=n.length;s<a;s++)n[s].getObjectsByProperty(t,e,i);return i}getWorldPosition(t){return this.updateWorldMatrix(!0,!1),t.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(vu,t,vS),t}getWorldScale(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(vu,xS,t),t}getWorldDirection(t){this.updateWorldMatrix(!0,!1);const e=this.matrixWorld.elements;return t.set(e[8],e[9],e[10]).normalize()}raycast(){}traverse(t){t(this);const e=this.children;for(let i=0,n=e.length;i<n;i++)e[i].traverse(t)}traverseVisible(t){if(this.visible===!1)return;t(this);const e=this.children;for(let i=0,n=e.length;i<n;i++)e[i].traverseVisible(t)}traverseAncestors(t){const e=this.parent;e!==null&&(t(e),e.traverseAncestors(t))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1,t=!0);const e=this.children;for(let i=0,n=e.length;i<n;i++)e[i].updateMatrixWorld(t)}updateWorldMatrix(t,e){const i=this.parent;if(t===!0&&i!==null&&i.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),e===!0){const n=this.children;for(let s=0,a=n.length;s<a;s++)n[s].updateWorldMatrix(!1,!0)}}toJSON(t){const e=t===void 0||typeof t=="string",i={};e&&(t={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},i.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});const n={};n.uuid=this.uuid,n.type=this.type,this.name!==""&&(n.name=this.name),this.castShadow===!0&&(n.castShadow=!0),this.receiveShadow===!0&&(n.receiveShadow=!0),this.visible===!1&&(n.visible=!1),this.frustumCulled===!1&&(n.frustumCulled=!1),this.renderOrder!==0&&(n.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(n.userData=this.userData),n.layers=this.layers.mask,n.matrix=this.matrix.toArray(),n.up=this.up.toArray(),this.matrixAutoUpdate===!1&&(n.matrixAutoUpdate=!1),this.isInstancedMesh&&(n.type="InstancedMesh",n.count=this.count,n.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(n.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(n.type="BatchedMesh",n.perObjectFrustumCulled=this.perObjectFrustumCulled,n.sortObjects=this.sortObjects,n.drawRanges=this._drawRanges,n.reservedRanges=this._reservedRanges,n.visibility=this._visibility,n.active=this._active,n.bounds=this._bounds.map(l=>({boxInitialized:l.boxInitialized,boxMin:l.box.min.toArray(),boxMax:l.box.max.toArray(),sphereInitialized:l.sphereInitialized,sphereRadius:l.sphere.radius,sphereCenter:l.sphere.center.toArray()})),n.maxInstanceCount=this._maxInstanceCount,n.maxVertexCount=this._maxVertexCount,n.maxIndexCount=this._maxIndexCount,n.geometryInitialized=this._geometryInitialized,n.geometryCount=this._geometryCount,n.matricesTexture=this._matricesTexture.toJSON(t),this._colorsTexture!==null&&(n.colorsTexture=this._colorsTexture.toJSON(t)),this.boundingSphere!==null&&(n.boundingSphere={center:n.boundingSphere.center.toArray(),radius:n.boundingSphere.radius}),this.boundingBox!==null&&(n.boundingBox={min:n.boundingBox.min.toArray(),max:n.boundingBox.max.toArray()}));function s(l,f){return l[f.uuid]===void 0&&(l[f.uuid]=f.toJSON(t)),f.uuid}if(this.isScene)this.background&&(this.background.isColor?n.background=this.background.toJSON():this.background.isTexture&&(n.background=this.background.toJSON(t).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(n.environment=this.environment.toJSON(t).uuid);else if(this.isMesh||this.isLine||this.isPoints){n.geometry=s(t.geometries,this.geometry);const l=this.geometry.parameters;if(l!==void 0&&l.shapes!==void 0){const f=l.shapes;if(Array.isArray(f))for(let d=0,g=f.length;d<g;d++){const m=f[d];s(t.shapes,m)}else s(t.shapes,f)}}if(this.isSkinnedMesh&&(n.bindMode=this.bindMode,n.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(s(t.skeletons,this.skeleton),n.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const l=[];for(let f=0,d=this.material.length;f<d;f++)l.push(s(t.materials,this.material[f]));n.material=l}else n.material=s(t.materials,this.material);if(this.children.length>0){n.children=[];for(let l=0;l<this.children.length;l++)n.children.push(this.children[l].toJSON(t).object)}if(this.animations.length>0){n.animations=[];for(let l=0;l<this.animations.length;l++){const f=this.animations[l];n.animations.push(s(t.animations,f))}}if(e){const l=a(t.geometries),f=a(t.materials),d=a(t.textures),g=a(t.images),m=a(t.shapes),v=a(t.skeletons),_=a(t.animations),w=a(t.nodes);l.length>0&&(i.geometries=l),f.length>0&&(i.materials=f),d.length>0&&(i.textures=d),g.length>0&&(i.images=g),m.length>0&&(i.shapes=m),v.length>0&&(i.skeletons=v),_.length>0&&(i.animations=_),w.length>0&&(i.nodes=w)}return i.object=n,i;function a(l){const f=[];for(const d in l){const g=l[d];delete g.metadata,f.push(g)}return f}}clone(t){return new this.constructor().copy(this,t)}copy(t,e=!0){if(this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.rotation.order=t.rotation.order,this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldAutoUpdate=t.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.animations=t.animations.slice(),this.userData=JSON.parse(JSON.stringify(t.userData)),e===!0)for(let i=0;i<t.children.length;i++){const n=t.children[i];this.add(n.clone())}return this}}yr.DEFAULT_UP=new Mt(0,1,0);yr.DEFAULT_MATRIX_AUTO_UPDATE=!0;yr.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const gr=new Mt,es=new Mt,jc=new Mt,ns=new Mt,va=new Mt,xa=new Mt,Hm=new Mt,Kc=new Mt,Qc=new Mt,tf=new Mt,ef=new yl,nf=new yl,rf=new yl;class mr{constructor(t=new Mt,e=new Mt,i=new Mt){this.a=t,this.b=e,this.c=i}static getNormal(t,e,i,n){n.subVectors(i,e),gr.subVectors(t,e),n.cross(gr);const s=n.lengthSq();return s>0?n.multiplyScalar(1/Math.sqrt(s)):n.set(0,0,0)}static getBarycoord(t,e,i,n,s){gr.subVectors(n,e),es.subVectors(i,e),jc.subVectors(t,e);const a=gr.dot(gr),l=gr.dot(es),f=gr.dot(jc),d=es.dot(es),g=es.dot(jc),m=a*d-l*l;if(m===0)return s.set(0,0,0),null;const v=1/m,_=(d*f-l*g)*v,w=(a*g-l*f)*v;return s.set(1-_-w,w,_)}static containsPoint(t,e,i,n){return this.getBarycoord(t,e,i,n,ns)===null?!1:ns.x>=0&&ns.y>=0&&ns.x+ns.y<=1}static getInterpolation(t,e,i,n,s,a,l,f){return this.getBarycoord(t,e,i,n,ns)===null?(f.x=0,f.y=0,"z"in f&&(f.z=0),"w"in f&&(f.w=0),null):(f.setScalar(0),f.addScaledVector(s,ns.x),f.addScaledVector(a,ns.y),f.addScaledVector(l,ns.z),f)}static getInterpolatedAttribute(t,e,i,n,s,a){return ef.setScalar(0),nf.setScalar(0),rf.setScalar(0),ef.fromBufferAttribute(t,e),nf.fromBufferAttribute(t,i),rf.fromBufferAttribute(t,n),a.setScalar(0),a.addScaledVector(ef,s.x),a.addScaledVector(nf,s.y),a.addScaledVector(rf,s.z),a}static isFrontFacing(t,e,i,n){return gr.subVectors(i,e),es.subVectors(t,e),gr.cross(es).dot(n)<0}set(t,e,i){return this.a.copy(t),this.b.copy(e),this.c.copy(i),this}setFromPointsAndIndices(t,e,i,n){return this.a.copy(t[e]),this.b.copy(t[i]),this.c.copy(t[n]),this}setFromAttributeAndIndices(t,e,i,n){return this.a.fromBufferAttribute(t,e),this.b.fromBufferAttribute(t,i),this.c.fromBufferAttribute(t,n),this}clone(){return new this.constructor().copy(this)}copy(t){return this.a.copy(t.a),this.b.copy(t.b),this.c.copy(t.c),this}getArea(){return gr.subVectors(this.c,this.b),es.subVectors(this.a,this.b),gr.cross(es).length()*.5}getMidpoint(t){return t.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(t){return mr.getNormal(this.a,this.b,this.c,t)}getPlane(t){return t.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(t,e){return mr.getBarycoord(t,this.a,this.b,this.c,e)}getInterpolation(t,e,i,n,s){return mr.getInterpolation(t,this.a,this.b,this.c,e,i,n,s)}containsPoint(t){return mr.containsPoint(t,this.a,this.b,this.c)}isFrontFacing(t){return mr.isFrontFacing(this.a,this.b,this.c,t)}intersectsBox(t){return t.intersectsTriangle(this)}closestPointToPoint(t,e){const i=this.a,n=this.b,s=this.c;let a,l;va.subVectors(n,i),xa.subVectors(s,i),Kc.subVectors(t,i);const f=va.dot(Kc),d=xa.dot(Kc);if(f<=0&&d<=0)return e.copy(i);Qc.subVectors(t,n);const g=va.dot(Qc),m=xa.dot(Qc);if(g>=0&&m<=g)return e.copy(n);const v=f*m-g*d;if(v<=0&&f>=0&&g<=0)return a=f/(f-g),e.copy(i).addScaledVector(va,a);tf.subVectors(t,s);const _=va.dot(tf),w=xa.dot(tf);if(w>=0&&_<=w)return e.copy(s);const b=_*d-f*w;if(b<=0&&d>=0&&w<=0)return l=d/(d-w),e.copy(i).addScaledVector(xa,l);const S=g*w-_*m;if(S<=0&&m-g>=0&&_-w>=0)return Hm.subVectors(s,n),l=(m-g)/(m-g+(_-w)),e.copy(n).addScaledVector(Hm,l);const N=1/(S+b+v);return a=b*N,l=v*N,e.copy(i).addScaledVector(va,a).addScaledVector(xa,l)}equals(t){return t.a.equals(this.a)&&t.b.equals(this.b)&&t.c.equals(this.c)}}const Hv={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Zs={h:0,s:0,l:0},Jl={h:0,s:0,l:0};function sf(r,t,e){return e<0&&(e+=1),e>1&&(e-=1),e<1/6?r+(t-r)*6*e:e<1/2?t:e<2/3?r+(t-r)*6*(2/3-e):r}class Vo{constructor(t,e,i){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(t,e,i)}set(t,e,i){if(e===void 0&&i===void 0){const n=t;n&&n.isColor?this.copy(n):typeof n=="number"?this.setHex(n):typeof n=="string"&&this.setStyle(n)}else this.setRGB(t,e,i);return this}setScalar(t){return this.r=t,this.g=t,this.b=t,this}setHex(t,e=Xi){return t=Math.floor(t),this.r=(t>>16&255)/255,this.g=(t>>8&255)/255,this.b=(t&255)/255,fr.toWorkingColorSpace(this,e),this}setRGB(t,e,i,n=fr.workingColorSpace){return this.r=t,this.g=e,this.b=i,fr.toWorkingColorSpace(this,n),this}setHSL(t,e,i,n=fr.workingColorSpace){if(t=Hd(t,1),e=fe(e,0,1),i=fe(i,0,1),e===0)this.r=this.g=this.b=i;else{const s=i<=.5?i*(1+e):i+e-i*e,a=2*i-s;this.r=sf(a,s,t+1/3),this.g=sf(a,s,t),this.b=sf(a,s,t-1/3)}return fr.toWorkingColorSpace(this,n),this}setStyle(t,e=Xi){function i(s){s!==void 0&&parseFloat(s)<1&&console.warn("THREE.Color: Alpha component of "+t+" will be ignored.")}let n;if(n=/^(\w+)\(([^\)]*)\)/.exec(t)){let s;const a=n[1],l=n[2];switch(a){case"rgb":case"rgba":if(s=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(l))return i(s[4]),this.setRGB(Math.min(255,parseInt(s[1],10))/255,Math.min(255,parseInt(s[2],10))/255,Math.min(255,parseInt(s[3],10))/255,e);if(s=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(l))return i(s[4]),this.setRGB(Math.min(100,parseInt(s[1],10))/100,Math.min(100,parseInt(s[2],10))/100,Math.min(100,parseInt(s[3],10))/100,e);break;case"hsl":case"hsla":if(s=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(l))return i(s[4]),this.setHSL(parseFloat(s[1])/360,parseFloat(s[2])/100,parseFloat(s[3])/100,e);break;default:console.warn("THREE.Color: Unknown color model "+t)}}else if(n=/^\#([A-Fa-f\d]+)$/.exec(t)){const s=n[1],a=s.length;if(a===3)return this.setRGB(parseInt(s.charAt(0),16)/15,parseInt(s.charAt(1),16)/15,parseInt(s.charAt(2),16)/15,e);if(a===6)return this.setHex(parseInt(s,16),e);console.warn("THREE.Color: Invalid hex color "+t)}else if(t&&t.length>0)return this.setColorName(t,e);return this}setColorName(t,e=Xi){const i=Hv[t.toLowerCase()];return i!==void 0?this.setHex(i,e):console.warn("THREE.Color: Unknown color "+t),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(t){return this.r=t.r,this.g=t.g,this.b=t.b,this}copySRGBToLinear(t){return this.r=ls(t.r),this.g=ls(t.g),this.b=ls(t.b),this}copyLinearToSRGB(t){return this.r=Ra(t.r),this.g=Ra(t.g),this.b=Ra(t.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(t=Xi){return fr.fromWorkingColorSpace(Yn.copy(this),t),Math.round(fe(Yn.r*255,0,255))*65536+Math.round(fe(Yn.g*255,0,255))*256+Math.round(fe(Yn.b*255,0,255))}getHexString(t=Xi){return("000000"+this.getHex(t).toString(16)).slice(-6)}getHSL(t,e=fr.workingColorSpace){fr.fromWorkingColorSpace(Yn.copy(this),e);const i=Yn.r,n=Yn.g,s=Yn.b,a=Math.max(i,n,s),l=Math.min(i,n,s);let f,d;const g=(l+a)/2;if(l===a)f=0,d=0;else{const m=a-l;switch(d=g<=.5?m/(a+l):m/(2-a-l),a){case i:f=(n-s)/m+(n<s?6:0);break;case n:f=(s-i)/m+2;break;case s:f=(i-n)/m+4;break}f/=6}return t.h=f,t.s=d,t.l=g,t}getRGB(t,e=fr.workingColorSpace){return fr.fromWorkingColorSpace(Yn.copy(this),e),t.r=Yn.r,t.g=Yn.g,t.b=Yn.b,t}getStyle(t=Xi){fr.fromWorkingColorSpace(Yn.copy(this),t);const e=Yn.r,i=Yn.g,n=Yn.b;return t!==Xi?`color(${t} ${e.toFixed(3)} ${i.toFixed(3)} ${n.toFixed(3)})`:`rgb(${Math.round(e*255)},${Math.round(i*255)},${Math.round(n*255)})`}offsetHSL(t,e,i){return this.getHSL(Zs),this.setHSL(Zs.h+t,Zs.s+e,Zs.l+i)}add(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this}addColors(t,e){return this.r=t.r+e.r,this.g=t.g+e.g,this.b=t.b+e.b,this}addScalar(t){return this.r+=t,this.g+=t,this.b+=t,this}sub(t){return this.r=Math.max(0,this.r-t.r),this.g=Math.max(0,this.g-t.g),this.b=Math.max(0,this.b-t.b),this}multiply(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this}multiplyScalar(t){return this.r*=t,this.g*=t,this.b*=t,this}lerp(t,e){return this.r+=(t.r-this.r)*e,this.g+=(t.g-this.g)*e,this.b+=(t.b-this.b)*e,this}lerpColors(t,e,i){return this.r=t.r+(e.r-t.r)*i,this.g=t.g+(e.g-t.g)*i,this.b=t.b+(e.b-t.b)*i,this}lerpHSL(t,e){this.getHSL(Zs),t.getHSL(Jl);const i=Gu(Zs.h,Jl.h,e),n=Gu(Zs.s,Jl.s,e),s=Gu(Zs.l,Jl.l,e);return this.setHSL(i,n,s),this}setFromVector3(t){return this.r=t.x,this.g=t.y,this.b=t.z,this}applyMatrix3(t){const e=this.r,i=this.g,n=this.b,s=t.elements;return this.r=s[0]*e+s[3]*i+s[6]*n,this.g=s[1]*e+s[4]*i+s[7]*n,this.b=s[2]*e+s[5]*i+s[8]*n,this}equals(t){return t.r===this.r&&t.g===this.g&&t.b===this.b}fromArray(t,e=0){return this.r=t[e],this.g=t[e+1],this.b=t[e+2],this}toArray(t=[],e=0){return t[e]=this.r,t[e+1]=this.g,t[e+2]=this.b,t}fromBufferAttribute(t,e){return this.r=t.getX(e),this.g=t.getY(e),this.b=t.getZ(e),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const Yn=new Vo;Vo.NAMES=Hv;let bS=0;class Yv extends cc{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:bS++}),this.uuid=Yo(),this.name="",this.type="Material",this.blending=Em,this.side=Hf,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=Mm,this.blendDst=Lm,this.blendEquation=km,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new Vo(0,0,0),this.blendAlpha=0,this.depthFunc=Sm,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=Im,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=ca,this.stencilZFail=ca,this.stencilZPass=ca,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(t){this._alphaTest>0!=t>0&&this.version++,this._alphaTest=t}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(t){if(t!==void 0)for(const e in t){const i=t[e];if(i===void 0){console.warn(`THREE.Material: parameter '${e}' has value of undefined.`);continue}const n=this[e];if(n===void 0){console.warn(`THREE.Material: '${e}' is not a property of THREE.${this.type}.`);continue}n&&n.isColor?n.set(i):n&&n.isVector3&&i&&i.isVector3?n.copy(i):this[e]=i}}toJSON(t){const e=t===void 0||typeof t=="string";e&&(t={textures:{},images:{}});const i={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};i.uuid=this.uuid,i.type=this.type,this.name!==""&&(i.name=this.name),this.color&&this.color.isColor&&(i.color=this.color.getHex()),this.roughness!==void 0&&(i.roughness=this.roughness),this.metalness!==void 0&&(i.metalness=this.metalness),this.sheen!==void 0&&(i.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(i.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(i.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(i.emissive=this.emissive.getHex()),this.emissiveIntensity!==void 0&&this.emissiveIntensity!==1&&(i.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(i.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(i.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(i.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(i.shininess=this.shininess),this.clearcoat!==void 0&&(i.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(i.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(i.clearcoatMap=this.clearcoatMap.toJSON(t).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(i.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(t).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(i.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(t).uuid,i.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.dispersion!==void 0&&(i.dispersion=this.dispersion),this.iridescence!==void 0&&(i.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(i.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(i.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(i.iridescenceMap=this.iridescenceMap.toJSON(t).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(i.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(t).uuid),this.anisotropy!==void 0&&(i.anisotropy=this.anisotropy),this.anisotropyRotation!==void 0&&(i.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(i.anisotropyMap=this.anisotropyMap.toJSON(t).uuid),this.map&&this.map.isTexture&&(i.map=this.map.toJSON(t).uuid),this.matcap&&this.matcap.isTexture&&(i.matcap=this.matcap.toJSON(t).uuid),this.alphaMap&&this.alphaMap.isTexture&&(i.alphaMap=this.alphaMap.toJSON(t).uuid),this.lightMap&&this.lightMap.isTexture&&(i.lightMap=this.lightMap.toJSON(t).uuid,i.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(i.aoMap=this.aoMap.toJSON(t).uuid,i.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(i.bumpMap=this.bumpMap.toJSON(t).uuid,i.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(i.normalMap=this.normalMap.toJSON(t).uuid,i.normalMapType=this.normalMapType,i.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(i.displacementMap=this.displacementMap.toJSON(t).uuid,i.displacementScale=this.displacementScale,i.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(i.roughnessMap=this.roughnessMap.toJSON(t).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(i.metalnessMap=this.metalnessMap.toJSON(t).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(i.emissiveMap=this.emissiveMap.toJSON(t).uuid),this.specularMap&&this.specularMap.isTexture&&(i.specularMap=this.specularMap.toJSON(t).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(i.specularIntensityMap=this.specularIntensityMap.toJSON(t).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(i.specularColorMap=this.specularColorMap.toJSON(t).uuid),this.envMap&&this.envMap.isTexture&&(i.envMap=this.envMap.toJSON(t).uuid,this.combine!==void 0&&(i.combine=this.combine)),this.envMapRotation!==void 0&&(i.envMapRotation=this.envMapRotation.toArray()),this.envMapIntensity!==void 0&&(i.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(i.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(i.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(i.gradientMap=this.gradientMap.toJSON(t).uuid),this.transmission!==void 0&&(i.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(i.transmissionMap=this.transmissionMap.toJSON(t).uuid),this.thickness!==void 0&&(i.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(i.thicknessMap=this.thicknessMap.toJSON(t).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(i.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(i.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(i.size=this.size),this.shadowSide!==null&&(i.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(i.sizeAttenuation=this.sizeAttenuation),this.blending!==Em&&(i.blending=this.blending),this.side!==Hf&&(i.side=this.side),this.vertexColors===!0&&(i.vertexColors=!0),this.opacity<1&&(i.opacity=this.opacity),this.transparent===!0&&(i.transparent=!0),this.blendSrc!==Mm&&(i.blendSrc=this.blendSrc),this.blendDst!==Lm&&(i.blendDst=this.blendDst),this.blendEquation!==km&&(i.blendEquation=this.blendEquation),this.blendSrcAlpha!==null&&(i.blendSrcAlpha=this.blendSrcAlpha),this.blendDstAlpha!==null&&(i.blendDstAlpha=this.blendDstAlpha),this.blendEquationAlpha!==null&&(i.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(i.blendColor=this.blendColor.getHex()),this.blendAlpha!==0&&(i.blendAlpha=this.blendAlpha),this.depthFunc!==Sm&&(i.depthFunc=this.depthFunc),this.depthTest===!1&&(i.depthTest=this.depthTest),this.depthWrite===!1&&(i.depthWrite=this.depthWrite),this.colorWrite===!1&&(i.colorWrite=this.colorWrite),this.stencilWriteMask!==255&&(i.stencilWriteMask=this.stencilWriteMask),this.stencilFunc!==Im&&(i.stencilFunc=this.stencilFunc),this.stencilRef!==0&&(i.stencilRef=this.stencilRef),this.stencilFuncMask!==255&&(i.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==ca&&(i.stencilFail=this.stencilFail),this.stencilZFail!==ca&&(i.stencilZFail=this.stencilZFail),this.stencilZPass!==ca&&(i.stencilZPass=this.stencilZPass),this.stencilWrite===!0&&(i.stencilWrite=this.stencilWrite),this.rotation!==void 0&&this.rotation!==0&&(i.rotation=this.rotation),this.polygonOffset===!0&&(i.polygonOffset=!0),this.polygonOffsetFactor!==0&&(i.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(i.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(i.linewidth=this.linewidth),this.dashSize!==void 0&&(i.dashSize=this.dashSize),this.gapSize!==void 0&&(i.gapSize=this.gapSize),this.scale!==void 0&&(i.scale=this.scale),this.dithering===!0&&(i.dithering=!0),this.alphaTest>0&&(i.alphaTest=this.alphaTest),this.alphaHash===!0&&(i.alphaHash=!0),this.alphaToCoverage===!0&&(i.alphaToCoverage=!0),this.premultipliedAlpha===!0&&(i.premultipliedAlpha=!0),this.forceSinglePass===!0&&(i.forceSinglePass=!0),this.wireframe===!0&&(i.wireframe=!0),this.wireframeLinewidth>1&&(i.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(i.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(i.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(i.flatShading=!0),this.visible===!1&&(i.visible=!1),this.toneMapped===!1&&(i.toneMapped=!1),this.fog===!1&&(i.fog=!1),Object.keys(this.userData).length>0&&(i.userData=this.userData);function n(s){const a=[];for(const l in s){const f=s[l];delete f.metadata,a.push(f)}return a}if(e){const s=n(t.textures),a=n(t.images);s.length>0&&(i.textures=s),a.length>0&&(i.images=a)}return i}clone(){return new this.constructor().copy(this)}copy(t){this.name=t.name,this.blending=t.blending,this.side=t.side,this.vertexColors=t.vertexColors,this.opacity=t.opacity,this.transparent=t.transparent,this.blendSrc=t.blendSrc,this.blendDst=t.blendDst,this.blendEquation=t.blendEquation,this.blendSrcAlpha=t.blendSrcAlpha,this.blendDstAlpha=t.blendDstAlpha,this.blendEquationAlpha=t.blendEquationAlpha,this.blendColor.copy(t.blendColor),this.blendAlpha=t.blendAlpha,this.depthFunc=t.depthFunc,this.depthTest=t.depthTest,this.depthWrite=t.depthWrite,this.stencilWriteMask=t.stencilWriteMask,this.stencilFunc=t.stencilFunc,this.stencilRef=t.stencilRef,this.stencilFuncMask=t.stencilFuncMask,this.stencilFail=t.stencilFail,this.stencilZFail=t.stencilZFail,this.stencilZPass=t.stencilZPass,this.stencilWrite=t.stencilWrite;const e=t.clippingPlanes;let i=null;if(e!==null){const n=e.length;i=new Array(n);for(let s=0;s!==n;++s)i[s]=e[s].clone()}return this.clippingPlanes=i,this.clipIntersection=t.clipIntersection,this.clipShadows=t.clipShadows,this.shadowSide=t.shadowSide,this.colorWrite=t.colorWrite,this.precision=t.precision,this.polygonOffset=t.polygonOffset,this.polygonOffsetFactor=t.polygonOffsetFactor,this.polygonOffsetUnits=t.polygonOffsetUnits,this.dithering=t.dithering,this.alphaTest=t.alphaTest,this.alphaHash=t.alphaHash,this.alphaToCoverage=t.alphaToCoverage,this.premultipliedAlpha=t.premultipliedAlpha,this.forceSinglePass=t.forceSinglePass,this.visible=t.visible,this.toneMapped=t.toneMapped,this.userData=JSON.parse(JSON.stringify(t.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(t){t===!0&&this.version++}onBuild(){console.warn("Material: onBuild() has been removed.")}}class ES extends Yv{constructor(t){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new Vo(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Qs,this.combine=DL,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.envMapRotation.copy(t.envMapRotation),this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.fog=t.fog,this}}const mn=new Mt,jl=new Ht;class On{constructor(t,e,i=!1){if(Array.isArray(t))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=t,this.itemSize=e,this.count=t!==void 0?t.length/e:0,this.normalized=i,this.usage=Cm,this.updateRanges=[],this.gpuType=VL,this.version=0}onUploadCallback(){}set needsUpdate(t){t===!0&&this.version++}setUsage(t){return this.usage=t,this}addUpdateRange(t,e){this.updateRanges.push({start:t,count:e})}clearUpdateRanges(){this.updateRanges.length=0}copy(t){return this.name=t.name,this.array=new t.array.constructor(t.array),this.itemSize=t.itemSize,this.count=t.count,this.normalized=t.normalized,this.usage=t.usage,this.gpuType=t.gpuType,this}copyAt(t,e,i){t*=this.itemSize,i*=e.itemSize;for(let n=0,s=this.itemSize;n<s;n++)this.array[t+n]=e.array[i+n];return this}copyArray(t){return this.array.set(t),this}applyMatrix3(t){if(this.itemSize===2)for(let e=0,i=this.count;e<i;e++)jl.fromBufferAttribute(this,e),jl.applyMatrix3(t),this.setXY(e,jl.x,jl.y);else if(this.itemSize===3)for(let e=0,i=this.count;e<i;e++)mn.fromBufferAttribute(this,e),mn.applyMatrix3(t),this.setXYZ(e,mn.x,mn.y,mn.z);return this}applyMatrix4(t){for(let e=0,i=this.count;e<i;e++)mn.fromBufferAttribute(this,e),mn.applyMatrix4(t),this.setXYZ(e,mn.x,mn.y,mn.z);return this}applyNormalMatrix(t){for(let e=0,i=this.count;e<i;e++)mn.fromBufferAttribute(this,e),mn.applyNormalMatrix(t),this.setXYZ(e,mn.x,mn.y,mn.z);return this}transformDirection(t){for(let e=0,i=this.count;e<i;e++)mn.fromBufferAttribute(this,e),mn.transformDirection(t),this.setXYZ(e,mn.x,mn.y,mn.z);return this}set(t,e=0){return this.array.set(t,e),this}getComponent(t,e){let i=this.array[t*this.itemSize+e];return this.normalized&&(i=ka(i,this.array)),i}setComponent(t,e,i){return this.normalized&&(i=Qn(i,this.array)),this.array[t*this.itemSize+e]=i,this}getX(t){let e=this.array[t*this.itemSize];return this.normalized&&(e=ka(e,this.array)),e}setX(t,e){return this.normalized&&(e=Qn(e,this.array)),this.array[t*this.itemSize]=e,this}getY(t){let e=this.array[t*this.itemSize+1];return this.normalized&&(e=ka(e,this.array)),e}setY(t,e){return this.normalized&&(e=Qn(e,this.array)),this.array[t*this.itemSize+1]=e,this}getZ(t){let e=this.array[t*this.itemSize+2];return this.normalized&&(e=ka(e,this.array)),e}setZ(t,e){return this.normalized&&(e=Qn(e,this.array)),this.array[t*this.itemSize+2]=e,this}getW(t){let e=this.array[t*this.itemSize+3];return this.normalized&&(e=ka(e,this.array)),e}setW(t,e){return this.normalized&&(e=Qn(e,this.array)),this.array[t*this.itemSize+3]=e,this}setXY(t,e,i){return t*=this.itemSize,this.normalized&&(e=Qn(e,this.array),i=Qn(i,this.array)),this.array[t+0]=e,this.array[t+1]=i,this}setXYZ(t,e,i,n){return t*=this.itemSize,this.normalized&&(e=Qn(e,this.array),i=Qn(i,this.array),n=Qn(n,this.array)),this.array[t+0]=e,this.array[t+1]=i,this.array[t+2]=n,this}setXYZW(t,e,i,n,s){return t*=this.itemSize,this.normalized&&(e=Qn(e,this.array),i=Qn(i,this.array),n=Qn(n,this.array),s=Qn(s,this.array)),this.array[t+0]=e,this.array[t+1]=i,this.array[t+2]=n,this.array[t+3]=s,this}onUpload(t){return this.onUploadCallback=t,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const t={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(t.name=this.name),this.usage!==Cm&&(t.usage=this.usage),t}}class kS extends On{constructor(t,e,i){super(new Uint16Array(t),e,i)}}class MS extends On{constructor(t,e,i){super(new Uint32Array(t),e,i)}}class Da extends On{constructor(t,e,i){super(new Float32Array(t),e,i)}}let LS=0;const qi=new di,of=new yr,wa=new Mt,ki=new _l,xu=new _l,Tn=new Mt;class Xo extends cc{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:LS++}),this.uuid=Yo(),this.name="",this.type="BufferGeometry",this.index=null,this.indirect=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(t){return Array.isArray(t)?this.index=new(uS(t)?MS:kS)(t,1):this.index=t,this}setIndirect(t){return this.indirect=t,this}getIndirect(){return this.indirect}getAttribute(t){return this.attributes[t]}setAttribute(t,e){return this.attributes[t]=e,this}deleteAttribute(t){return delete this.attributes[t],this}hasAttribute(t){return this.attributes[t]!==void 0}addGroup(t,e,i=0){this.groups.push({start:t,count:e,materialIndex:i})}clearGroups(){this.groups=[]}setDrawRange(t,e){this.drawRange.start=t,this.drawRange.count=e}applyMatrix4(t){const e=this.attributes.position;e!==void 0&&(e.applyMatrix4(t),e.needsUpdate=!0);const i=this.attributes.normal;if(i!==void 0){const s=new ro().getNormalMatrix(t);i.applyNormalMatrix(s),i.needsUpdate=!0}const n=this.attributes.tangent;return n!==void 0&&(n.transformDirection(t),n.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(t){return qi.makeRotationFromQuaternion(t),this.applyMatrix4(qi),this}rotateX(t){return qi.makeRotationX(t),this.applyMatrix4(qi),this}rotateY(t){return qi.makeRotationY(t),this.applyMatrix4(qi),this}rotateZ(t){return qi.makeRotationZ(t),this.applyMatrix4(qi),this}translate(t,e,i){return qi.makeTranslation(t,e,i),this.applyMatrix4(qi),this}scale(t,e,i){return qi.makeScale(t,e,i),this.applyMatrix4(qi),this}lookAt(t){return of.lookAt(t),of.updateMatrix(),this.applyMatrix4(of.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(wa).negate(),this.translate(wa.x,wa.y,wa.z),this}setFromPoints(t){const e=this.getAttribute("position");if(e===void 0){const i=[];for(let n=0,s=t.length;n<s;n++){const a=t[n];i.push(a.x,a.y,a.z||0)}this.setAttribute("position",new Da(i,3))}else{const i=Math.min(t.length,e.count);for(let n=0;n<i;n++){const s=t[n];e.setXYZ(n,s.x,s.y,s.z||0)}t.length>e.count&&console.warn("THREE.BufferGeometry: Buffer size too small for points data. Use .dispose() and create a new geometry."),e.needsUpdate=!0}return this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new _l);const t=this.attributes.position,e=this.morphAttributes.position;if(t&&t.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box.",this),this.boundingBox.set(new Mt(-1/0,-1/0,-1/0),new Mt(1/0,1/0,1/0));return}if(t!==void 0){if(this.boundingBox.setFromBufferAttribute(t),e)for(let i=0,n=e.length;i<n;i++){const s=e[i];ki.setFromBufferAttribute(s),this.morphTargetsRelative?(Tn.addVectors(this.boundingBox.min,ki.min),this.boundingBox.expandByPoint(Tn),Tn.addVectors(this.boundingBox.max,ki.max),this.boundingBox.expandByPoint(Tn)):(this.boundingBox.expandByPoint(ki.min),this.boundingBox.expandByPoint(ki.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Zv);const t=this.attributes.position,e=this.morphAttributes.position;if(t&&t.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere.",this),this.boundingSphere.set(new Mt,1/0);return}if(t){const i=this.boundingSphere.center;if(ki.setFromBufferAttribute(t),e)for(let s=0,a=e.length;s<a;s++){const l=e[s];xu.setFromBufferAttribute(l),this.morphTargetsRelative?(Tn.addVectors(ki.min,xu.min),ki.expandByPoint(Tn),Tn.addVectors(ki.max,xu.max),ki.expandByPoint(Tn)):(ki.expandByPoint(xu.min),ki.expandByPoint(xu.max))}ki.getCenter(i);let n=0;for(let s=0,a=t.count;s<a;s++)Tn.fromBufferAttribute(t,s),n=Math.max(n,i.distanceToSquared(Tn));if(e)for(let s=0,a=e.length;s<a;s++){const l=e[s],f=this.morphTargetsRelative;for(let d=0,g=l.count;d<g;d++)Tn.fromBufferAttribute(l,d),f&&(wa.fromBufferAttribute(t,d),Tn.add(wa)),n=Math.max(n,i.distanceToSquared(Tn))}this.boundingSphere.radius=Math.sqrt(n),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const t=this.index,e=this.attributes;if(t===null||e.position===void 0||e.normal===void 0||e.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const i=e.position,n=e.normal,s=e.uv;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new On(new Float32Array(4*i.count),4));const a=this.getAttribute("tangent"),l=[],f=[];for(let I=0;I<i.count;I++)l[I]=new Mt,f[I]=new Mt;const d=new Mt,g=new Mt,m=new Mt,v=new Ht,_=new Ht,w=new Ht,b=new Mt,S=new Mt;function N(I,O,B){d.fromBufferAttribute(i,I),g.fromBufferAttribute(i,O),m.fromBufferAttribute(i,B),v.fromBufferAttribute(s,I),_.fromBufferAttribute(s,O),w.fromBufferAttribute(s,B),g.sub(d),m.sub(d),_.sub(v),w.sub(v);const V=1/(_.x*w.y-w.x*_.y);isFinite(V)&&(b.copy(g).multiplyScalar(w.y).addScaledVector(m,-_.y).multiplyScalar(V),S.copy(m).multiplyScalar(_.x).addScaledVector(g,-w.x).multiplyScalar(V),l[I].add(b),l[O].add(b),l[B].add(b),f[I].add(S),f[O].add(S),f[B].add(S))}let k=this.groups;k.length===0&&(k=[{start:0,count:t.count}]);for(let I=0,O=k.length;I<O;++I){const B=k[I],V=B.start,z=B.count;for(let W=V,T=V+z;W<T;W+=3)N(t.getX(W+0),t.getX(W+1),t.getX(W+2))}const C=new Mt,A=new Mt,P=new Mt,q=new Mt;function U(I){P.fromBufferAttribute(n,I),q.copy(P);const O=l[I];C.copy(O),C.sub(P.multiplyScalar(P.dot(O))).normalize(),A.crossVectors(q,O);const V=A.dot(f[I])<0?-1:1;a.setXYZW(I,C.x,C.y,C.z,V)}for(let I=0,O=k.length;I<O;++I){const B=k[I],V=B.start,z=B.count;for(let W=V,T=V+z;W<T;W+=3)U(t.getX(W+0)),U(t.getX(W+1)),U(t.getX(W+2))}}computeVertexNormals(){const t=this.index,e=this.getAttribute("position");if(e!==void 0){let i=this.getAttribute("normal");if(i===void 0)i=new On(new Float32Array(e.count*3),3),this.setAttribute("normal",i);else for(let v=0,_=i.count;v<_;v++)i.setXYZ(v,0,0,0);const n=new Mt,s=new Mt,a=new Mt,l=new Mt,f=new Mt,d=new Mt,g=new Mt,m=new Mt;if(t)for(let v=0,_=t.count;v<_;v+=3){const w=t.getX(v+0),b=t.getX(v+1),S=t.getX(v+2);n.fromBufferAttribute(e,w),s.fromBufferAttribute(e,b),a.fromBufferAttribute(e,S),g.subVectors(a,s),m.subVectors(n,s),g.cross(m),l.fromBufferAttribute(i,w),f.fromBufferAttribute(i,b),d.fromBufferAttribute(i,S),l.add(g),f.add(g),d.add(g),i.setXYZ(w,l.x,l.y,l.z),i.setXYZ(b,f.x,f.y,f.z),i.setXYZ(S,d.x,d.y,d.z)}else for(let v=0,_=e.count;v<_;v+=3)n.fromBufferAttribute(e,v+0),s.fromBufferAttribute(e,v+1),a.fromBufferAttribute(e,v+2),g.subVectors(a,s),m.subVectors(n,s),g.cross(m),i.setXYZ(v+0,g.x,g.y,g.z),i.setXYZ(v+1,g.x,g.y,g.z),i.setXYZ(v+2,g.x,g.y,g.z);this.normalizeNormals(),i.needsUpdate=!0}}normalizeNormals(){const t=this.attributes.normal;for(let e=0,i=t.count;e<i;e++)Tn.fromBufferAttribute(t,e),Tn.normalize(),t.setXYZ(e,Tn.x,Tn.y,Tn.z)}toNonIndexed(){function t(l,f){const d=l.array,g=l.itemSize,m=l.normalized,v=new d.constructor(f.length*g);let _=0,w=0;for(let b=0,S=f.length;b<S;b++){l.isInterleavedBufferAttribute?_=f[b]*l.data.stride+l.offset:_=f[b]*g;for(let N=0;N<g;N++)v[w++]=d[_++]}return new On(v,g,m)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const e=new Xo,i=this.index.array,n=this.attributes;for(const l in n){const f=n[l],d=t(f,i);e.setAttribute(l,d)}const s=this.morphAttributes;for(const l in s){const f=[],d=s[l];for(let g=0,m=d.length;g<m;g++){const v=d[g],_=t(v,i);f.push(_)}e.morphAttributes[l]=f}e.morphTargetsRelative=this.morphTargetsRelative;const a=this.groups;for(let l=0,f=a.length;l<f;l++){const d=a[l];e.addGroup(d.start,d.count,d.materialIndex)}return e}toJSON(){const t={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(t.uuid=this.uuid,t.type=this.type,this.name!==""&&(t.name=this.name),Object.keys(this.userData).length>0&&(t.userData=this.userData),this.parameters!==void 0){const f=this.parameters;for(const d in f)f[d]!==void 0&&(t[d]=f[d]);return t}t.data={attributes:{}};const e=this.index;e!==null&&(t.data.index={type:e.array.constructor.name,array:Array.prototype.slice.call(e.array)});const i=this.attributes;for(const f in i){const d=i[f];t.data.attributes[f]=d.toJSON(t.data)}const n={};let s=!1;for(const f in this.morphAttributes){const d=this.morphAttributes[f],g=[];for(let m=0,v=d.length;m<v;m++){const _=d[m];g.push(_.toJSON(t.data))}g.length>0&&(n[f]=g,s=!0)}s&&(t.data.morphAttributes=n,t.data.morphTargetsRelative=this.morphTargetsRelative);const a=this.groups;a.length>0&&(t.data.groups=JSON.parse(JSON.stringify(a)));const l=this.boundingSphere;return l!==null&&(t.data.boundingSphere={center:l.center.toArray(),radius:l.radius}),t}clone(){return new this.constructor().copy(this)}copy(t){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const e={};this.name=t.name;const i=t.index;i!==null&&this.setIndex(i.clone(e));const n=t.attributes;for(const d in n){const g=n[d];this.setAttribute(d,g.clone(e))}const s=t.morphAttributes;for(const d in s){const g=[],m=s[d];for(let v=0,_=m.length;v<_;v++)g.push(m[v].clone(e));this.morphAttributes[d]=g}this.morphTargetsRelative=t.morphTargetsRelative;const a=t.groups;for(let d=0,g=a.length;d<g;d++){const m=a[d];this.addGroup(m.start,m.count,m.materialIndex)}const l=t.boundingBox;l!==null&&(this.boundingBox=l.clone());const f=t.boundingSphere;return f!==null&&(this.boundingSphere=f.clone()),this.drawRange.start=t.drawRange.start,this.drawRange.count=t.drawRange.count,this.userData=t.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const Ym=new di,Co=new pS,Kl=new Zv,Xm=new Mt,Ql=new Mt,th=new Mt,eh=new Mt,af=new Mt,nh=new Mt,Wm=new Mt,ih=new Mt;class za extends yr{constructor(t=new Xo,e=new ES){super(),this.isMesh=!0,this.type="Mesh",this.geometry=t,this.material=e,this.updateMorphTargets()}copy(t,e){return super.copy(t,e),t.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=t.morphTargetInfluences.slice()),t.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},t.morphTargetDictionary)),this.material=Array.isArray(t.material)?t.material.slice():t.material,this.geometry=t.geometry,this}updateMorphTargets(){const e=this.geometry.morphAttributes,i=Object.keys(e);if(i.length>0){const n=e[i[0]];if(n!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,a=n.length;s<a;s++){const l=n[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[l]=s}}}}getVertexPosition(t,e){const i=this.geometry,n=i.attributes.position,s=i.morphAttributes.position,a=i.morphTargetsRelative;e.fromBufferAttribute(n,t);const l=this.morphTargetInfluences;if(s&&l){nh.set(0,0,0);for(let f=0,d=s.length;f<d;f++){const g=l[f],m=s[f];g!==0&&(af.fromBufferAttribute(m,t),a?nh.addScaledVector(af,g):nh.addScaledVector(af.sub(e),g))}e.add(nh)}return e}raycast(t,e){const i=this.geometry,n=this.material,s=this.matrixWorld;n!==void 0&&(i.boundingSphere===null&&i.computeBoundingSphere(),Kl.copy(i.boundingSphere),Kl.applyMatrix4(s),Co.copy(t.ray).recast(t.near),!(Kl.containsPoint(Co.origin)===!1&&(Co.intersectSphere(Kl,Xm)===null||Co.origin.distanceToSquared(Xm)>(t.far-t.near)**2))&&(Ym.copy(s).invert(),Co.copy(t.ray).applyMatrix4(Ym),!(i.boundingBox!==null&&Co.intersectsBox(i.boundingBox)===!1)&&this._computeIntersections(t,e,Co)))}_computeIntersections(t,e,i){let n;const s=this.geometry,a=this.material,l=s.index,f=s.attributes.position,d=s.attributes.uv,g=s.attributes.uv1,m=s.attributes.normal,v=s.groups,_=s.drawRange;if(l!==null)if(Array.isArray(a))for(let w=0,b=v.length;w<b;w++){const S=v[w],N=a[S.materialIndex],k=Math.max(S.start,_.start),C=Math.min(l.count,Math.min(S.start+S.count,_.start+_.count));for(let A=k,P=C;A<P;A+=3){const q=l.getX(A),U=l.getX(A+1),I=l.getX(A+2);n=rh(this,N,t,i,d,g,m,q,U,I),n&&(n.faceIndex=Math.floor(A/3),n.face.materialIndex=S.materialIndex,e.push(n))}}else{const w=Math.max(0,_.start),b=Math.min(l.count,_.start+_.count);for(let S=w,N=b;S<N;S+=3){const k=l.getX(S),C=l.getX(S+1),A=l.getX(S+2);n=rh(this,a,t,i,d,g,m,k,C,A),n&&(n.faceIndex=Math.floor(S/3),e.push(n))}}else if(f!==void 0)if(Array.isArray(a))for(let w=0,b=v.length;w<b;w++){const S=v[w],N=a[S.materialIndex],k=Math.max(S.start,_.start),C=Math.min(f.count,Math.min(S.start+S.count,_.start+_.count));for(let A=k,P=C;A<P;A+=3){const q=A,U=A+1,I=A+2;n=rh(this,N,t,i,d,g,m,q,U,I),n&&(n.faceIndex=Math.floor(A/3),n.face.materialIndex=S.materialIndex,e.push(n))}}else{const w=Math.max(0,_.start),b=Math.min(f.count,_.start+_.count);for(let S=w,N=b;S<N;S+=3){const k=S,C=S+1,A=S+2;n=rh(this,a,t,i,d,g,m,k,C,A),n&&(n.faceIndex=Math.floor(S/3),e.push(n))}}}}function SS(r,t,e,i,n,s,a,l){let f;if(t.side===RL?f=i.intersectTriangle(a,s,n,!0,l):f=i.intersectTriangle(n,s,a,t.side===Hf,l),f===null)return null;ih.copy(l),ih.applyMatrix4(r.matrixWorld);const d=e.ray.origin.distanceTo(ih);return d<e.near||d>e.far?null:{distance:d,point:ih.clone(),object:r}}function rh(r,t,e,i,n,s,a,l,f,d){r.getVertexPosition(l,Ql),r.getVertexPosition(f,th),r.getVertexPosition(d,eh);const g=SS(r,t,e,i,Ql,th,eh,Wm);if(g){const m=new Mt;mr.getBarycoord(Wm,Ql,th,eh,m),n&&(g.uv=mr.getInterpolatedAttribute(n,l,f,d,m,new Ht)),s&&(g.uv1=mr.getInterpolatedAttribute(s,l,f,d,m,new Ht)),a&&(g.normal=mr.getInterpolatedAttribute(a,l,f,d,m,new Mt),g.normal.dot(i.direction)>0&&g.normal.multiplyScalar(-1));const v={a:l,b:f,c:d,normal:new Mt,materialIndex:0};mr.getNormal(Ql,th,eh,v.normal),g.face=v,g.barycoord=m}return g}class $f extends yr{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.backgroundRotation=new Qs,this.environmentIntensity=1,this.environmentRotation=new Qs,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(t,e){return super.copy(t,e),t.background!==null&&(this.background=t.background.clone()),t.environment!==null&&(this.environment=t.environment.clone()),t.fog!==null&&(this.fog=t.fog.clone()),this.backgroundBlurriness=t.backgroundBlurriness,this.backgroundIntensity=t.backgroundIntensity,this.backgroundRotation.copy(t.backgroundRotation),this.environmentIntensity=t.environmentIntensity,this.environmentRotation.copy(t.environmentRotation),t.overrideMaterial!==null&&(this.overrideMaterial=t.overrideMaterial.clone()),this.matrixAutoUpdate=t.matrixAutoUpdate,this}toJSON(t){const e=super.toJSON(t);return this.fog!==null&&(e.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(e.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(e.object.backgroundIntensity=this.backgroundIntensity),e.object.backgroundRotation=this.backgroundRotation.toArray(),this.environmentIntensity!==1&&(e.object.environmentIntensity=this.environmentIntensity),e.object.environmentRotation=this.environmentRotation.toArray(),e}}class Xv extends yr{constructor(){super(),this.isGroup=!0,this.type="Group"}}class uf extends Ws{constructor(t,e,i,n,s,a,l,f,d,g,m,v){super(null,a,l,f,d,g,n,s,m,v),this.isCompressedTexture=!0,this.image={width:e,height:i},this.mipmaps=t,this.flipY=!1,this.generateMipmaps=!1}}class Br{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(t,e){const i=this.getUtoTmapping(t);return this.getPoint(i,e)}getPoints(t=5){const e=[];for(let i=0;i<=t;i++)e.push(this.getPoint(i/t));return e}getSpacedPoints(t=5){const e=[];for(let i=0;i<=t;i++)e.push(this.getPointAt(i/t));return e}getLength(){const t=this.getLengths();return t[t.length-1]}getLengths(t=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===t+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const e=[];let i,n=this.getPoint(0),s=0;e.push(0);for(let a=1;a<=t;a++)i=this.getPoint(a/t),s+=i.distanceTo(n),e.push(s),n=i;return this.cacheArcLengths=e,e}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(t,e){const i=this.getLengths();let n=0;const s=i.length;let a;e?a=e:a=t*i[s-1];let l=0,f=s-1,d;for(;l<=f;)if(n=Math.floor(l+(f-l)/2),d=i[n]-a,d<0)l=n+1;else if(d>0)f=n-1;else{f=n;break}if(n=f,i[n]===a)return n/(s-1);const g=i[n],v=i[n+1]-g,_=(a-g)/v;return(n+_)/(s-1)}getTangent(t,e){let n=t-1e-4,s=t+1e-4;n<0&&(n=0),s>1&&(s=1);const a=this.getPoint(n),l=this.getPoint(s),f=e||(a.isVector2?new Ht:new Mt);return f.copy(l).sub(a).normalize(),f}getTangentAt(t,e){const i=this.getUtoTmapping(t);return this.getTangent(i,e)}computeFrenetFrames(t,e){const i=new Mt,n=[],s=[],a=[],l=new Mt,f=new di;for(let _=0;_<=t;_++){const w=_/t;n[_]=this.getTangentAt(w,new Mt)}s[0]=new Mt,a[0]=new Mt;let d=Number.MAX_VALUE;const g=Math.abs(n[0].x),m=Math.abs(n[0].y),v=Math.abs(n[0].z);g<=d&&(d=g,i.set(1,0,0)),m<=d&&(d=m,i.set(0,1,0)),v<=d&&i.set(0,0,1),l.crossVectors(n[0],i).normalize(),s[0].crossVectors(n[0],l),a[0].crossVectors(n[0],s[0]);for(let _=1;_<=t;_++){if(s[_]=s[_-1].clone(),a[_]=a[_-1].clone(),l.crossVectors(n[_-1],n[_]),l.length()>Number.EPSILON){l.normalize();const w=Math.acos(fe(n[_-1].dot(n[_]),-1,1));s[_].applyMatrix4(f.makeRotationAxis(l,w))}a[_].crossVectors(n[_],s[_])}if(e===!0){let _=Math.acos(fe(s[0].dot(s[t]),-1,1));_/=t,n[0].dot(l.crossVectors(s[0],s[t]))>0&&(_=-_);for(let w=1;w<=t;w++)s[w].applyMatrix4(f.makeRotationAxis(n[w],_*w)),a[w].crossVectors(n[w],s[w])}return{tangents:n,normals:s,binormals:a}}clone(){return new this.constructor().copy(this)}copy(t){return this.arcLengthDivisions=t.arcLengthDivisions,this}toJSON(){const t={metadata:{version:4.6,type:"Curve",generator:"Curve.toJSON"}};return t.arcLengthDivisions=this.arcLengthDivisions,t.type=this.type,t}fromJSON(t){return this.arcLengthDivisions=t.arcLengthDivisions,this}}class Yd extends Br{constructor(t=0,e=0,i=1,n=1,s=0,a=Math.PI*2,l=!1,f=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=t,this.aY=e,this.xRadius=i,this.yRadius=n,this.aStartAngle=s,this.aEndAngle=a,this.aClockwise=l,this.aRotation=f}getPoint(t,e=new Ht){const i=e,n=Math.PI*2;let s=this.aEndAngle-this.aStartAngle;const a=Math.abs(s)<Number.EPSILON;for(;s<0;)s+=n;for(;s>n;)s-=n;s<Number.EPSILON&&(a?s=0:s=n),this.aClockwise===!0&&!a&&(s===n?s=-n:s=s-n);const l=this.aStartAngle+t*s;let f=this.aX+this.xRadius*Math.cos(l),d=this.aY+this.yRadius*Math.sin(l);if(this.aRotation!==0){const g=Math.cos(this.aRotation),m=Math.sin(this.aRotation),v=f-this.aX,_=d-this.aY;f=v*g-_*m+this.aX,d=v*m+_*g+this.aY}return i.set(f,d)}copy(t){return super.copy(t),this.aX=t.aX,this.aY=t.aY,this.xRadius=t.xRadius,this.yRadius=t.yRadius,this.aStartAngle=t.aStartAngle,this.aEndAngle=t.aEndAngle,this.aClockwise=t.aClockwise,this.aRotation=t.aRotation,this}toJSON(){const t=super.toJSON();return t.aX=this.aX,t.aY=this.aY,t.xRadius=this.xRadius,t.yRadius=this.yRadius,t.aStartAngle=this.aStartAngle,t.aEndAngle=this.aEndAngle,t.aClockwise=this.aClockwise,t.aRotation=this.aRotation,t}fromJSON(t){return super.fromJSON(t),this.aX=t.aX,this.aY=t.aY,this.xRadius=t.xRadius,this.yRadius=t.yRadius,this.aStartAngle=t.aStartAngle,this.aEndAngle=t.aEndAngle,this.aClockwise=t.aClockwise,this.aRotation=t.aRotation,this}}class TS extends Yd{constructor(t,e,i,n,s,a){super(t,e,i,i,n,s,a),this.isArcCurve=!0,this.type="ArcCurve"}}function Xd(){let r=0,t=0,e=0,i=0;function n(s,a,l,f){r=s,t=l,e=-3*s+3*a-2*l-f,i=2*s-2*a+l+f}return{initCatmullRom:function(s,a,l,f,d){n(a,l,d*(l-s),d*(f-a))},initNonuniformCatmullRom:function(s,a,l,f,d,g,m){let v=(a-s)/d-(l-s)/(d+g)+(l-a)/g,_=(l-a)/g-(f-a)/(g+m)+(f-l)/m;v*=g,_*=g,n(a,l,v,_)},calc:function(s){const a=s*s,l=a*s;return r+t*s+e*a+i*l}}}const sh=new Mt,lf=new Xd,hf=new Xd,cf=new Xd;class PS extends Br{constructor(t=[],e=!1,i="centripetal",n=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=t,this.closed=e,this.curveType=i,this.tension=n}getPoint(t,e=new Mt){const i=e,n=this.points,s=n.length,a=(s-(this.closed?0:1))*t;let l=Math.floor(a),f=a-l;this.closed?l+=l>0?0:(Math.floor(Math.abs(l)/s)+1)*s:f===0&&l===s-1&&(l=s-2,f=1);let d,g;this.closed||l>0?d=n[(l-1)%s]:(sh.subVectors(n[0],n[1]).add(n[0]),d=sh);const m=n[l%s],v=n[(l+1)%s];if(this.closed||l+2<s?g=n[(l+2)%s]:(sh.subVectors(n[s-1],n[s-2]).add(n[s-1]),g=sh),this.curveType==="centripetal"||this.curveType==="chordal"){const _=this.curveType==="chordal"?.5:.25;let w=Math.pow(d.distanceToSquared(m),_),b=Math.pow(m.distanceToSquared(v),_),S=Math.pow(v.distanceToSquared(g),_);b<1e-4&&(b=1),w<1e-4&&(w=b),S<1e-4&&(S=b),lf.initNonuniformCatmullRom(d.x,m.x,v.x,g.x,w,b,S),hf.initNonuniformCatmullRom(d.y,m.y,v.y,g.y,w,b,S),cf.initNonuniformCatmullRom(d.z,m.z,v.z,g.z,w,b,S)}else this.curveType==="catmullrom"&&(lf.initCatmullRom(d.x,m.x,v.x,g.x,this.tension),hf.initCatmullRom(d.y,m.y,v.y,g.y,this.tension),cf.initCatmullRom(d.z,m.z,v.z,g.z,this.tension));return i.set(lf.calc(f),hf.calc(f),cf.calc(f)),i}copy(t){super.copy(t),this.points=[];for(let e=0,i=t.points.length;e<i;e++){const n=t.points[e];this.points.push(n.clone())}return this.closed=t.closed,this.curveType=t.curveType,this.tension=t.tension,this}toJSON(){const t=super.toJSON();t.points=[];for(let e=0,i=this.points.length;e<i;e++){const n=this.points[e];t.points.push(n.toArray())}return t.closed=this.closed,t.curveType=this.curveType,t.tension=this.tension,t}fromJSON(t){super.fromJSON(t),this.points=[];for(let e=0,i=t.points.length;e<i;e++){const n=t.points[e];this.points.push(new Mt().fromArray(n))}return this.closed=t.closed,this.curveType=t.curveType,this.tension=t.tension,this}}function $m(r,t,e,i,n){const s=(i-t)*.5,a=(n-e)*.5,l=r*r,f=r*l;return(2*e-2*i+s+a)*f+(-3*e+3*i-2*s-a)*l+s*r+e}function IS(r,t){const e=1-r;return e*e*t}function CS(r,t){return 2*(1-r)*r*t}function AS(r,t){return r*r*t}function Vu(r,t,e,i){return IS(r,t)+CS(r,e)+AS(r,i)}function NS(r,t){const e=1-r;return e*e*e*t}function OS(r,t){const e=1-r;return 3*e*e*r*t}function RS(r,t){return 3*(1-r)*r*r*t}function DS(r,t){return r*r*r*t}function qu(r,t,e,i,n){return NS(r,t)+OS(r,e)+RS(r,i)+DS(r,n)}class Wv extends Br{constructor(t=new Ht,e=new Ht,i=new Ht,n=new Ht){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=t,this.v1=e,this.v2=i,this.v3=n}getPoint(t,e=new Ht){const i=e,n=this.v0,s=this.v1,a=this.v2,l=this.v3;return i.set(qu(t,n.x,s.x,a.x,l.x),qu(t,n.y,s.y,a.y,l.y)),i}copy(t){return super.copy(t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this.v3.copy(t.v3),this}toJSON(){const t=super.toJSON();return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t.v3=this.v3.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this.v3.fromArray(t.v3),this}}class zS extends Br{constructor(t=new Mt,e=new Mt,i=new Mt,n=new Mt){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=t,this.v1=e,this.v2=i,this.v3=n}getPoint(t,e=new Mt){const i=e,n=this.v0,s=this.v1,a=this.v2,l=this.v3;return i.set(qu(t,n.x,s.x,a.x,l.x),qu(t,n.y,s.y,a.y,l.y),qu(t,n.z,s.z,a.z,l.z)),i}copy(t){return super.copy(t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this.v3.copy(t.v3),this}toJSON(){const t=super.toJSON();return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t.v3=this.v3.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this.v3.fromArray(t.v3),this}}class $v extends Br{constructor(t=new Ht,e=new Ht){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=t,this.v2=e}getPoint(t,e=new Ht){const i=e;return t===1?i.copy(this.v2):(i.copy(this.v2).sub(this.v1),i.multiplyScalar(t).add(this.v1)),i}getPointAt(t,e){return this.getPoint(t,e)}getTangent(t,e=new Ht){return e.subVectors(this.v2,this.v1).normalize()}getTangentAt(t,e){return this.getTangent(t,e)}copy(t){return super.copy(t),this.v1.copy(t.v1),this.v2.copy(t.v2),this}toJSON(){const t=super.toJSON();return t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this}}class BS extends Br{constructor(t=new Mt,e=new Mt){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=t,this.v2=e}getPoint(t,e=new Mt){const i=e;return t===1?i.copy(this.v2):(i.copy(this.v2).sub(this.v1),i.multiplyScalar(t).add(this.v1)),i}getPointAt(t,e){return this.getPoint(t,e)}getTangent(t,e=new Mt){return e.subVectors(this.v2,this.v1).normalize()}getTangentAt(t,e){return this.getTangent(t,e)}copy(t){return super.copy(t),this.v1.copy(t.v1),this.v2.copy(t.v2),this}toJSON(){const t=super.toJSON();return t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this}}class Jv extends Br{constructor(t=new Ht,e=new Ht,i=new Ht){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=t,this.v1=e,this.v2=i}getPoint(t,e=new Ht){const i=e,n=this.v0,s=this.v1,a=this.v2;return i.set(Vu(t,n.x,s.x,a.x),Vu(t,n.y,s.y,a.y)),i}copy(t){return super.copy(t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this}toJSON(){const t=super.toJSON();return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this}}class FS extends Br{constructor(t=new Mt,e=new Mt,i=new Mt){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=t,this.v1=e,this.v2=i}getPoint(t,e=new Mt){const i=e,n=this.v0,s=this.v1,a=this.v2;return i.set(Vu(t,n.x,s.x,a.x),Vu(t,n.y,s.y,a.y),Vu(t,n.z,s.z,a.z)),i}copy(t){return super.copy(t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this}toJSON(){const t=super.toJSON();return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this}}class jv extends Br{constructor(t=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=t}getPoint(t,e=new Ht){const i=e,n=this.points,s=(n.length-1)*t,a=Math.floor(s),l=s-a,f=n[a===0?a:a-1],d=n[a],g=n[a>n.length-2?n.length-1:a+1],m=n[a>n.length-3?n.length-1:a+2];return i.set($m(l,f.x,d.x,g.x,m.x),$m(l,f.y,d.y,g.y,m.y)),i}copy(t){super.copy(t),this.points=[];for(let e=0,i=t.points.length;e<i;e++){const n=t.points[e];this.points.push(n.clone())}return this}toJSON(){const t=super.toJSON();t.points=[];for(let e=0,i=this.points.length;e<i;e++){const n=this.points[e];t.points.push(n.toArray())}return t}fromJSON(t){super.fromJSON(t),this.points=[];for(let e=0,i=t.points.length;e<i;e++){const n=t.points[e];this.points.push(new Ht().fromArray(n))}return this}}var Jf=Object.freeze({__proto__:null,ArcCurve:TS,CatmullRomCurve3:PS,CubicBezierCurve:Wv,CubicBezierCurve3:zS,EllipseCurve:Yd,LineCurve:$v,LineCurve3:BS,QuadraticBezierCurve:Jv,QuadraticBezierCurve3:FS,SplineCurve:jv});class US extends Br{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(t){this.curves.push(t)}closePath(){const t=this.curves[0].getPoint(0),e=this.curves[this.curves.length-1].getPoint(1);if(!t.equals(e)){const i=t.isVector2===!0?"LineCurve":"LineCurve3";this.curves.push(new Jf[i](e,t))}return this}getPoint(t,e){const i=t*this.getLength(),n=this.getCurveLengths();let s=0;for(;s<n.length;){if(n[s]>=i){const a=n[s]-i,l=this.curves[s],f=l.getLength(),d=f===0?0:1-a/f;return l.getPointAt(d,e)}s++}return null}getLength(){const t=this.getCurveLengths();return t[t.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const t=[];let e=0;for(let i=0,n=this.curves.length;i<n;i++)e+=this.curves[i].getLength(),t.push(e);return this.cacheLengths=t,t}getSpacedPoints(t=40){const e=[];for(let i=0;i<=t;i++)e.push(this.getPoint(i/t));return this.autoClose&&e.push(e[0]),e}getPoints(t=12){const e=[];let i;for(let n=0,s=this.curves;n<s.length;n++){const a=s[n],l=a.isEllipseCurve?t*2:a.isLineCurve||a.isLineCurve3?1:a.isSplineCurve?t*a.points.length:t,f=a.getPoints(l);for(let d=0;d<f.length;d++){const g=f[d];i&&i.equals(g)||(e.push(g),i=g)}}return this.autoClose&&e.length>1&&!e[e.length-1].equals(e[0])&&e.push(e[0]),e}copy(t){super.copy(t),this.curves=[];for(let e=0,i=t.curves.length;e<i;e++){const n=t.curves[e];this.curves.push(n.clone())}return this.autoClose=t.autoClose,this}toJSON(){const t=super.toJSON();t.autoClose=this.autoClose,t.curves=[];for(let e=0,i=this.curves.length;e<i;e++){const n=this.curves[e];t.curves.push(n.toJSON())}return t}fromJSON(t){super.fromJSON(t),this.autoClose=t.autoClose,this.curves=[];for(let e=0,i=t.curves.length;e<i;e++){const n=t.curves[e];this.curves.push(new Jf[n.type]().fromJSON(n))}return this}}class Jm extends US{constructor(t){super(),this.type="Path",this.currentPoint=new Ht,t&&this.setFromPoints(t)}setFromPoints(t){this.moveTo(t[0].x,t[0].y);for(let e=1,i=t.length;e<i;e++)this.lineTo(t[e].x,t[e].y);return this}moveTo(t,e){return this.currentPoint.set(t,e),this}lineTo(t,e){const i=new $v(this.currentPoint.clone(),new Ht(t,e));return this.curves.push(i),this.currentPoint.set(t,e),this}quadraticCurveTo(t,e,i,n){const s=new Jv(this.currentPoint.clone(),new Ht(t,e),new Ht(i,n));return this.curves.push(s),this.currentPoint.set(i,n),this}bezierCurveTo(t,e,i,n,s,a){const l=new Wv(this.currentPoint.clone(),new Ht(t,e),new Ht(i,n),new Ht(s,a));return this.curves.push(l),this.currentPoint.set(s,a),this}splineThru(t){const e=[this.currentPoint.clone()].concat(t),i=new jv(e);return this.curves.push(i),this.currentPoint.copy(t[t.length-1]),this}arc(t,e,i,n,s,a){const l=this.currentPoint.x,f=this.currentPoint.y;return this.absarc(t+l,e+f,i,n,s,a),this}absarc(t,e,i,n,s,a){return this.absellipse(t,e,i,i,n,s,a),this}ellipse(t,e,i,n,s,a,l,f){const d=this.currentPoint.x,g=this.currentPoint.y;return this.absellipse(t+d,e+g,i,n,s,a,l,f),this}absellipse(t,e,i,n,s,a,l,f){const d=new Yd(t,e,i,n,s,a,l,f);if(this.curves.length>0){const m=d.getPoint(0);m.equals(this.currentPoint)||this.lineTo(m.x,m.y)}this.curves.push(d);const g=d.getPoint(1);return this.currentPoint.copy(g),this}copy(t){return super.copy(t),this.currentPoint.copy(t.currentPoint),this}toJSON(){const t=super.toJSON();return t.currentPoint=this.currentPoint.toArray(),t}fromJSON(t){return super.fromJSON(t),this.currentPoint.fromArray(t.currentPoint),this}}class Wd extends Jm{constructor(t){super(t),this.uuid=Yo(),this.type="Shape",this.holes=[]}getPointsHoles(t){const e=[];for(let i=0,n=this.holes.length;i<n;i++)e[i]=this.holes[i].getPoints(t);return e}extractPoints(t){return{shape:this.getPoints(t),holes:this.getPointsHoles(t)}}copy(t){super.copy(t),this.holes=[];for(let e=0,i=t.holes.length;e<i;e++){const n=t.holes[e];this.holes.push(n.clone())}return this}toJSON(){const t=super.toJSON();t.uuid=this.uuid,t.holes=[];for(let e=0,i=this.holes.length;e<i;e++){const n=this.holes[e];t.holes.push(n.toJSON())}return t}fromJSON(t){super.fromJSON(t),this.uuid=t.uuid,this.holes=[];for(let e=0,i=t.holes.length;e<i;e++){const n=t.holes[e];this.holes.push(new Jm().fromJSON(n))}return this}}const GS={triangulate:function(r,t,e=2){const i=t&&t.length,n=i?t[0]*e:r.length;let s=Kv(r,0,n,e,!0);const a=[];if(!s||s.next===s.prev)return a;let l,f,d,g,m,v,_;if(i&&(s=YS(r,t,s,e)),r.length>80*e){l=d=r[0],f=g=r[1];for(let w=e;w<n;w+=e)m=r[w],v=r[w+1],m<l&&(l=m),v<f&&(f=v),m>d&&(d=m),v>g&&(g=v);_=Math.max(d-l,g-f),_=_!==0?32767/_:0}return il(s,a,e,l,f,_,0),a}};function Kv(r,t,e,i,n){let s,a;if(n===iT(r,t,e,i)>0)for(s=t;s<e;s+=i)a=jm(s,r[s],r[s+1],a);else for(s=e-i;s>=t;s-=i)a=jm(s,r[s],r[s+1],a);return a&&fc(a,a.next)&&(sl(a),a=a.next),a}function qo(r,t){if(!r)return r;t||(t=r);let e=r,i;do if(i=!1,!e.steiner&&(fc(e,e.next)||Je(e.prev,e,e.next)===0)){if(sl(e),e=t=e.prev,e===e.next)break;i=!0}else e=e.next;while(i||e!==t);return t}function il(r,t,e,i,n,s,a){if(!r)return;!a&&s&&jS(r,i,n,s);let l=r,f,d;for(;r.prev!==r.next;){if(f=r.prev,d=r.next,s?qS(r,i,n,s):VS(r)){t.push(f.i/e|0),t.push(r.i/e|0),t.push(d.i/e|0),sl(r),r=d.next,l=d.next;continue}if(r=d,r===l){a?a===1?(r=ZS(qo(r),t,e),il(r,t,e,i,n,s,2)):a===2&&HS(r,t,e,i,n,s):il(qo(r),t,e,i,n,s,1);break}}}function VS(r){const t=r.prev,e=r,i=r.next;if(Je(t,e,i)>=0)return!1;const n=t.x,s=e.x,a=i.x,l=t.y,f=e.y,d=i.y,g=n<s?n<a?n:a:s<a?s:a,m=l<f?l<d?l:d:f<d?f:d,v=n>s?n>a?n:a:s>a?s:a,_=l>f?l>d?l:d:f>d?f:d;let w=i.next;for(;w!==t;){if(w.x>=g&&w.x<=v&&w.y>=m&&w.y<=_&&Pa(n,l,s,f,a,d,w.x,w.y)&&Je(w.prev,w,w.next)>=0)return!1;w=w.next}return!0}function qS(r,t,e,i){const n=r.prev,s=r,a=r.next;if(Je(n,s,a)>=0)return!1;const l=n.x,f=s.x,d=a.x,g=n.y,m=s.y,v=a.y,_=l<f?l<d?l:d:f<d?f:d,w=g<m?g<v?g:v:m<v?m:v,b=l>f?l>d?l:d:f>d?f:d,S=g>m?g>v?g:v:m>v?m:v,N=jf(_,w,t,e,i),k=jf(b,S,t,e,i);let C=r.prevZ,A=r.nextZ;for(;C&&C.z>=N&&A&&A.z<=k;){if(C.x>=_&&C.x<=b&&C.y>=w&&C.y<=S&&C!==n&&C!==a&&Pa(l,g,f,m,d,v,C.x,C.y)&&Je(C.prev,C,C.next)>=0||(C=C.prevZ,A.x>=_&&A.x<=b&&A.y>=w&&A.y<=S&&A!==n&&A!==a&&Pa(l,g,f,m,d,v,A.x,A.y)&&Je(A.prev,A,A.next)>=0))return!1;A=A.nextZ}for(;C&&C.z>=N;){if(C.x>=_&&C.x<=b&&C.y>=w&&C.y<=S&&C!==n&&C!==a&&Pa(l,g,f,m,d,v,C.x,C.y)&&Je(C.prev,C,C.next)>=0)return!1;C=C.prevZ}for(;A&&A.z<=k;){if(A.x>=_&&A.x<=b&&A.y>=w&&A.y<=S&&A!==n&&A!==a&&Pa(l,g,f,m,d,v,A.x,A.y)&&Je(A.prev,A,A.next)>=0)return!1;A=A.nextZ}return!0}function ZS(r,t,e){let i=r;do{const n=i.prev,s=i.next.next;!fc(n,s)&&Qv(n,i,i.next,s)&&rl(n,s)&&rl(s,n)&&(t.push(n.i/e|0),t.push(i.i/e|0),t.push(s.i/e|0),sl(i),sl(i.next),i=r=s),i=i.next}while(i!==r);return qo(i)}function HS(r,t,e,i,n,s){let a=r;do{let l=a.next.next;for(;l!==a.prev;){if(a.i!==l.i&&tT(a,l)){let f=t0(a,l);a=qo(a,a.next),f=qo(f,f.next),il(a,t,e,i,n,s,0),il(f,t,e,i,n,s,0);return}l=l.next}a=a.next}while(a!==r)}function YS(r,t,e,i){const n=[];let s,a,l,f,d;for(s=0,a=t.length;s<a;s++)l=t[s]*i,f=s<a-1?t[s+1]*i:r.length,d=Kv(r,l,f,i,!1),d===d.next&&(d.steiner=!0),n.push(QS(d));for(n.sort(XS),s=0;s<n.length;s++)e=WS(n[s],e);return e}function XS(r,t){return r.x-t.x}function WS(r,t){const e=$S(r,t);if(!e)return t;const i=t0(e,r);return qo(i,i.next),qo(e,e.next)}function $S(r,t){let e=t,i=-1/0,n;const s=r.x,a=r.y;do{if(a<=e.y&&a>=e.next.y&&e.next.y!==e.y){const v=e.x+(a-e.y)*(e.next.x-e.x)/(e.next.y-e.y);if(v<=s&&v>i&&(i=v,n=e.x<e.next.x?e:e.next,v===s))return n}e=e.next}while(e!==t);if(!n)return null;const l=n,f=n.x,d=n.y;let g=1/0,m;e=n;do s>=e.x&&e.x>=f&&s!==e.x&&Pa(a<d?s:i,a,f,d,a<d?i:s,a,e.x,e.y)&&(m=Math.abs(a-e.y)/(s-e.x),rl(e,r)&&(m<g||m===g&&(e.x>n.x||e.x===n.x&&JS(n,e)))&&(n=e,g=m)),e=e.next;while(e!==l);return n}function JS(r,t){return Je(r.prev,r,t.prev)<0&&Je(t.next,r,r.next)<0}function jS(r,t,e,i){let n=r;do n.z===0&&(n.z=jf(n.x,n.y,t,e,i)),n.prevZ=n.prev,n.nextZ=n.next,n=n.next;while(n!==r);n.prevZ.nextZ=null,n.prevZ=null,KS(n)}function KS(r){let t,e,i,n,s,a,l,f,d=1;do{for(e=r,r=null,s=null,a=0;e;){for(a++,i=e,l=0,t=0;t<d&&(l++,i=i.nextZ,!!i);t++);for(f=d;l>0||f>0&&i;)l!==0&&(f===0||!i||e.z<=i.z)?(n=e,e=e.nextZ,l--):(n=i,i=i.nextZ,f--),s?s.nextZ=n:r=n,n.prevZ=s,s=n;e=i}s.nextZ=null,d*=2}while(a>1);return r}function jf(r,t,e,i,n){return r=(r-e)*n|0,t=(t-i)*n|0,r=(r|r<<8)&16711935,r=(r|r<<4)&252645135,r=(r|r<<2)&858993459,r=(r|r<<1)&1431655765,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,r|t<<1}function QS(r){let t=r,e=r;do(t.x<e.x||t.x===e.x&&t.y<e.y)&&(e=t),t=t.next;while(t!==r);return e}function Pa(r,t,e,i,n,s,a,l){return(n-a)*(t-l)>=(r-a)*(s-l)&&(r-a)*(i-l)>=(e-a)*(t-l)&&(e-a)*(s-l)>=(n-a)*(i-l)}function tT(r,t){return r.next.i!==t.i&&r.prev.i!==t.i&&!eT(r,t)&&(rl(r,t)&&rl(t,r)&&nT(r,t)&&(Je(r.prev,r,t.prev)||Je(r,t.prev,t))||fc(r,t)&&Je(r.prev,r,r.next)>0&&Je(t.prev,t,t.next)>0)}function Je(r,t,e){return(t.y-r.y)*(e.x-t.x)-(t.x-r.x)*(e.y-t.y)}function fc(r,t){return r.x===t.x&&r.y===t.y}function Qv(r,t,e,i){const n=ah(Je(r,t,e)),s=ah(Je(r,t,i)),a=ah(Je(e,i,r)),l=ah(Je(e,i,t));return!!(n!==s&&a!==l||n===0&&oh(r,e,t)||s===0&&oh(r,i,t)||a===0&&oh(e,r,i)||l===0&&oh(e,t,i))}function oh(r,t,e){return t.x<=Math.max(r.x,e.x)&&t.x>=Math.min(r.x,e.x)&&t.y<=Math.max(r.y,e.y)&&t.y>=Math.min(r.y,e.y)}function ah(r){return r>0?1:r<0?-1:0}function eT(r,t){let e=r;do{if(e.i!==r.i&&e.next.i!==r.i&&e.i!==t.i&&e.next.i!==t.i&&Qv(e,e.next,r,t))return!0;e=e.next}while(e!==r);return!1}function rl(r,t){return Je(r.prev,r,r.next)<0?Je(r,t,r.next)>=0&&Je(r,r.prev,t)>=0:Je(r,t,r.prev)<0||Je(r,r.next,t)<0}function nT(r,t){let e=r,i=!1;const n=(r.x+t.x)/2,s=(r.y+t.y)/2;do e.y>s!=e.next.y>s&&e.next.y!==e.y&&n<(e.next.x-e.x)*(s-e.y)/(e.next.y-e.y)+e.x&&(i=!i),e=e.next;while(e!==r);return i}function t0(r,t){const e=new Kf(r.i,r.x,r.y),i=new Kf(t.i,t.x,t.y),n=r.next,s=t.prev;return r.next=t,t.prev=r,e.next=n,n.prev=e,i.next=e,e.prev=i,s.next=i,i.prev=s,i}function jm(r,t,e,i){const n=new Kf(r,t,e);return i?(n.next=i.next,n.prev=i,i.next.prev=n,i.next=n):(n.prev=n,n.next=n),n}function sl(r){r.next.prev=r.prev,r.prev.next=r.next,r.prevZ&&(r.prevZ.nextZ=r.nextZ),r.nextZ&&(r.nextZ.prevZ=r.prevZ)}function Kf(r,t,e){this.i=r,this.x=t,this.y=e,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function iT(r,t,e,i){let n=0;for(let s=t,a=e-i;s<e;s+=i)n+=(r[a]-r[s])*(r[s+1]+r[a+1]),a=s;return n}class Zu{static area(t){const e=t.length;let i=0;for(let n=e-1,s=0;s<e;n=s++)i+=t[n].x*t[s].y-t[s].x*t[n].y;return i*.5}static isClockWise(t){return Zu.area(t)<0}static triangulateShape(t,e){const i=[],n=[],s=[];Km(t),Qm(i,t);let a=t.length;e.forEach(Km);for(let f=0;f<e.length;f++)n.push(a),a+=e[f].length,Qm(i,e[f]);const l=GS.triangulate(i,n);for(let f=0;f<l.length;f+=3)s.push(l.slice(f,f+3));return s}}function Km(r){const t=r.length;t>2&&r[t-1].equals(r[0])&&r.pop()}function Qm(r,t){for(let e=0;e<t.length;e++)r.push(t[e].x),r.push(t[e].y)}class zo extends Xo{constructor(t=new Wd([new Ht(.5,.5),new Ht(-.5,.5),new Ht(-.5,-.5),new Ht(.5,-.5)]),e={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:t,options:e},t=Array.isArray(t)?t:[t];const i=this,n=[],s=[];for(let l=0,f=t.length;l<f;l++){const d=t[l];a(d)}this.setAttribute("position",new Da(n,3)),this.setAttribute("uv",new Da(s,2)),this.computeVertexNormals();function a(l){const f=[],d=e.curveSegments!==void 0?e.curveSegments:12,g=e.steps!==void 0?e.steps:1,m=e.depth!==void 0?e.depth:1;let v=e.bevelEnabled!==void 0?e.bevelEnabled:!0,_=e.bevelThickness!==void 0?e.bevelThickness:.2,w=e.bevelSize!==void 0?e.bevelSize:_-.1,b=e.bevelOffset!==void 0?e.bevelOffset:0,S=e.bevelSegments!==void 0?e.bevelSegments:3;const N=e.extrudePath,k=e.UVGenerator!==void 0?e.UVGenerator:rT;let C,A=!1,P,q,U,I;N&&(C=N.getSpacedPoints(g),A=!0,v=!1,P=N.computeFrenetFrames(g,!1),q=new Mt,U=new Mt,I=new Mt),v||(S=0,_=0,w=0,b=0);const O=l.extractPoints(d);let B=O.shape;const V=O.holes;if(!Zu.isClockWise(B)){B=B.reverse();for(let tt=0,wt=V.length;tt<wt;tt++){const G=V[tt];Zu.isClockWise(G)&&(V[tt]=G.reverse())}}const W=Zu.triangulateShape(B,V),T=B;for(let tt=0,wt=V.length;tt<wt;tt++){const G=V[tt];B=B.concat(G)}function $(tt,wt,G){return wt||console.error("THREE.ExtrudeGeometry: vec does not exist"),tt.clone().addScaledVector(wt,G)}const F=B.length,X=W.length;function Y(tt,wt,G){let ct,ht,ot;const it=tt.x-wt.x,st=tt.y-wt.y,kt=G.x-tt.x,Lt=G.y-tt.y,yt=it*it+st*st,At=it*Lt-st*kt;if(Math.abs(At)>Number.EPSILON){const St=Math.sqrt(yt),Ct=Math.sqrt(kt*kt+Lt*Lt),Bt=wt.x-st/St,ue=wt.y+it/St,Pt=G.x-Lt/Ct,be=G.y+kt/Ct,Xt=((Pt-Bt)*Lt-(be-ue)*kt)/(it*Lt-st*kt);ct=Bt+it*Xt-tt.x,ht=ue+st*Xt-tt.y;const Ut=ct*ct+ht*ht;if(Ut<=2)return new Ht(ct,ht);ot=Math.sqrt(Ut/2)}else{let St=!1;it>Number.EPSILON?kt>Number.EPSILON&&(St=!0):it<-Number.EPSILON?kt<-Number.EPSILON&&(St=!0):Math.sign(st)===Math.sign(Lt)&&(St=!0),St?(ct=-st,ht=it,ot=Math.sqrt(yt)):(ct=it,ht=st,ot=Math.sqrt(yt/2))}return new Ht(ct/ot,ht/ot)}const j=[];for(let tt=0,wt=T.length,G=wt-1,ct=tt+1;tt<wt;tt++,G++,ct++)G===wt&&(G=0),ct===wt&&(ct=0),j[tt]=Y(T[tt],T[G],T[ct]);const J=[];let K,et=j.concat();for(let tt=0,wt=V.length;tt<wt;tt++){const G=V[tt];K=[];for(let ct=0,ht=G.length,ot=ht-1,it=ct+1;ct<ht;ct++,ot++,it++)ot===ht&&(ot=0),it===ht&&(it=0),K[ct]=Y(G[ct],G[ot],G[it]);J.push(K),et=et.concat(K)}for(let tt=0;tt<S;tt++){const wt=tt/S,G=_*Math.cos(wt*Math.PI/2),ct=w*Math.sin(wt*Math.PI/2)+b;for(let ht=0,ot=T.length;ht<ot;ht++){const it=$(T[ht],j[ht],ct);Et(it.x,it.y,-G)}for(let ht=0,ot=V.length;ht<ot;ht++){const it=V[ht];K=J[ht];for(let st=0,kt=it.length;st<kt;st++){const Lt=$(it[st],K[st],ct);Et(Lt.x,Lt.y,-G)}}}const ft=w+b;for(let tt=0;tt<F;tt++){const wt=v?$(B[tt],et[tt],ft):B[tt];A?(U.copy(P.normals[0]).multiplyScalar(wt.x),q.copy(P.binormals[0]).multiplyScalar(wt.y),I.copy(C[0]).add(U).add(q),Et(I.x,I.y,I.z)):Et(wt.x,wt.y,0)}for(let tt=1;tt<=g;tt++)for(let wt=0;wt<F;wt++){const G=v?$(B[wt],et[wt],ft):B[wt];A?(U.copy(P.normals[tt]).multiplyScalar(G.x),q.copy(P.binormals[tt]).multiplyScalar(G.y),I.copy(C[tt]).add(U).add(q),Et(I.x,I.y,I.z)):Et(G.x,G.y,m/g*tt)}for(let tt=S-1;tt>=0;tt--){const wt=tt/S,G=_*Math.cos(wt*Math.PI/2),ct=w*Math.sin(wt*Math.PI/2)+b;for(let ht=0,ot=T.length;ht<ot;ht++){const it=$(T[ht],j[ht],ct);Et(it.x,it.y,m+G)}for(let ht=0,ot=V.length;ht<ot;ht++){const it=V[ht];K=J[ht];for(let st=0,kt=it.length;st<kt;st++){const Lt=$(it[st],K[st],ct);A?Et(Lt.x,Lt.y+C[g-1].y,C[g-1].x+G):Et(Lt.x,Lt.y,m+G)}}}lt(),ut();function lt(){const tt=n.length/3;if(v){let wt=0,G=F*wt;for(let ct=0;ct<X;ct++){const ht=W[ct];at(ht[2]+G,ht[1]+G,ht[0]+G)}wt=g+S*2,G=F*wt;for(let ct=0;ct<X;ct++){const ht=W[ct];at(ht[0]+G,ht[1]+G,ht[2]+G)}}else{for(let wt=0;wt<X;wt++){const G=W[wt];at(G[2],G[1],G[0])}for(let wt=0;wt<X;wt++){const G=W[wt];at(G[0]+F*g,G[1]+F*g,G[2]+F*g)}}i.addGroup(tt,n.length/3-tt,0)}function ut(){const tt=n.length/3;let wt=0;mt(T,wt),wt+=T.length;for(let G=0,ct=V.length;G<ct;G++){const ht=V[G];mt(ht,wt),wt+=ht.length}i.addGroup(tt,n.length/3-tt,1)}function mt(tt,wt){let G=tt.length;for(;--G>=0;){const ct=G;let ht=G-1;ht<0&&(ht=tt.length-1);for(let ot=0,it=g+S*2;ot<it;ot++){const st=F*ot,kt=F*(ot+1),Lt=wt+ct+st,yt=wt+ht+st,At=wt+ht+kt,St=wt+ct+kt;Rt(Lt,yt,At,St)}}}function Et(tt,wt,G){f.push(tt),f.push(wt),f.push(G)}function at(tt,wt,G){xt(tt),xt(wt),xt(G);const ct=n.length/3,ht=k.generateTopUV(i,n,ct-3,ct-2,ct-1);_t(ht[0]),_t(ht[1]),_t(ht[2])}function Rt(tt,wt,G,ct){xt(tt),xt(wt),xt(ct),xt(wt),xt(G),xt(ct);const ht=n.length/3,ot=k.generateSideWallUV(i,n,ht-6,ht-3,ht-2,ht-1);_t(ot[0]),_t(ot[1]),_t(ot[3]),_t(ot[1]),_t(ot[2]),_t(ot[3])}function xt(tt){n.push(f[tt*3+0]),n.push(f[tt*3+1]),n.push(f[tt*3+2])}function _t(tt){s.push(tt.x),s.push(tt.y)}}}copy(t){return super.copy(t),this.parameters=Object.assign({},t.parameters),this}toJSON(){const t=super.toJSON(),e=this.parameters.shapes,i=this.parameters.options;return sT(e,i,t)}static fromJSON(t,e){const i=[];for(let s=0,a=t.shapes.length;s<a;s++){const l=e[t.shapes[s]];i.push(l)}const n=t.options.extrudePath;return n!==void 0&&(t.options.extrudePath=new Jf[n.type]().fromJSON(n)),new zo(i,t.options)}}const rT={generateTopUV:function(r,t,e,i,n){const s=t[e*3],a=t[e*3+1],l=t[i*3],f=t[i*3+1],d=t[n*3],g=t[n*3+1];return[new Ht(s,a),new Ht(l,f),new Ht(d,g)]},generateSideWallUV:function(r,t,e,i,n,s){const a=t[e*3],l=t[e*3+1],f=t[e*3+2],d=t[i*3],g=t[i*3+1],m=t[i*3+2],v=t[n*3],_=t[n*3+1],w=t[n*3+2],b=t[s*3],S=t[s*3+1],N=t[s*3+2];return Math.abs(l-g)<Math.abs(a-d)?[new Ht(a,1-f),new Ht(d,1-m),new Ht(v,1-w),new Ht(b,1-N)]:[new Ht(l,1-f),new Ht(g,1-m),new Ht(_,1-w),new Ht(S,1-N)]}};function sT(r,t,e){if(e.shapes=[],Array.isArray(r))for(let i=0,n=r.length;i<n;i++){const s=r[i];e.shapes.push(s.uuid)}else e.shapes.push(r.uuid);return e.options=Object.assign({},t),t.extrudePath!==void 0&&(e.options.extrudePath=t.extrudePath.toJSON()),e}class $d extends Xo{constructor(t=1,e=32,i=16,n=0,s=Math.PI*2,a=0,l=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:t,widthSegments:e,heightSegments:i,phiStart:n,phiLength:s,thetaStart:a,thetaLength:l},e=Math.max(3,Math.floor(e)),i=Math.max(2,Math.floor(i));const f=Math.min(a+l,Math.PI);let d=0;const g=[],m=new Mt,v=new Mt,_=[],w=[],b=[],S=[];for(let N=0;N<=i;N++){const k=[],C=N/i;let A=0;N===0&&a===0?A=.5/e:N===i&&f===Math.PI&&(A=-.5/e);for(let P=0;P<=e;P++){const q=P/e;m.x=-t*Math.cos(n+q*s)*Math.sin(a+C*l),m.y=t*Math.cos(a+C*l),m.z=t*Math.sin(n+q*s)*Math.sin(a+C*l),w.push(m.x,m.y,m.z),v.copy(m).normalize(),b.push(v.x,v.y,v.z),S.push(q+A,1-C),k.push(d++)}g.push(k)}for(let N=0;N<i;N++)for(let k=0;k<e;k++){const C=g[N][k+1],A=g[N][k],P=g[N+1][k],q=g[N+1][k+1];(N!==0||a>0)&&_.push(C,A,q),(N!==i-1||f<Math.PI)&&_.push(A,P,q)}this.setIndex(_),this.setAttribute("position",new Da(w,3)),this.setAttribute("normal",new Da(b,3)),this.setAttribute("uv",new Da(S,2))}copy(t){return super.copy(t),this.parameters=Object.assign({},t.parameters),this}static fromJSON(t){return new $d(t.radius,t.widthSegments,t.heightSegments,t.phiStart,t.phiLength,t.thetaStart,t.thetaLength)}}class Ba extends Yv{constructor(t){super(),this.isMeshStandardMaterial=!0,this.type="MeshStandardMaterial",this.defines={STANDARD:""},this.color=new Vo(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Vo(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=HL,this.normalScale=new Ht(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Qs,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.defines={STANDARD:""},this.color.copy(t.color),this.roughness=t.roughness,this.metalness=t.metalness,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.roughnessMap=t.roughnessMap,this.metalnessMap=t.metalnessMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.envMapRotation.copy(t.envMapRotation),this.envMapIntensity=t.envMapIntensity,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.flatShading=t.flatShading,this.fog=t.fog,this}}const Jd="\\[\\]\\.:\\/",oT=new RegExp("["+Jd+"]","g"),jd="[^"+Jd+"]",aT="[^"+Jd.replace("\\.","")+"]",uT=/((?:WC+[\/:])*)/.source.replace("WC",jd),lT=/(WCOD+)?/.source.replace("WCOD",aT),hT=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",jd),cT=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",jd),fT=new RegExp("^"+uT+lT+hT+cT+"$"),dT=["material","materials","bones","map"];class pT{constructor(t,e,i){const n=i||ke.parseTrackName(e);this._targetGroup=t,this._bindings=t.subscribe_(e,n)}getValue(t,e){this.bind();const i=this._targetGroup.nCachedObjects_,n=this._bindings[i];n!==void 0&&n.getValue(t,e)}setValue(t,e){const i=this._bindings;for(let n=this._targetGroup.nCachedObjects_,s=i.length;n!==s;++n)i[n].setValue(t,e)}bind(){const t=this._bindings;for(let e=this._targetGroup.nCachedObjects_,i=t.length;e!==i;++e)t[e].bind()}unbind(){const t=this._bindings;for(let e=this._targetGroup.nCachedObjects_,i=t.length;e!==i;++e)t[e].unbind()}}class ke{constructor(t,e,i){this.path=e,this.parsedPath=i||ke.parseTrackName(e),this.node=ke.findNode(t,this.parsedPath.nodeName),this.rootNode=t,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(t,e,i){return t&&t.isAnimationObjectGroup?new ke.Composite(t,e,i):new ke(t,e,i)}static sanitizeNodeName(t){return t.replace(/\s/g,"_").replace(oT,"")}static parseTrackName(t){const e=fT.exec(t);if(e===null)throw new Error("PropertyBinding: Cannot parse trackName: "+t);const i={nodeName:e[2],objectName:e[3],objectIndex:e[4],propertyName:e[5],propertyIndex:e[6]},n=i.nodeName&&i.nodeName.lastIndexOf(".");if(n!==void 0&&n!==-1){const s=i.nodeName.substring(n+1);dT.indexOf(s)!==-1&&(i.nodeName=i.nodeName.substring(0,n),i.objectName=s)}if(i.propertyName===null||i.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+t);return i}static findNode(t,e){if(e===void 0||e===""||e==="."||e===-1||e===t.name||e===t.uuid)return t;if(t.skeleton){const i=t.skeleton.getBoneByName(e);if(i!==void 0)return i}if(t.children){const i=function(s){for(let a=0;a<s.length;a++){const l=s[a];if(l.name===e||l.uuid===e)return l;const f=i(l.children);if(f)return f}return null},n=i(t.children);if(n)return n}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(t,e){t[e]=this.targetObject[this.propertyName]}_getValue_array(t,e){const i=this.resolvedProperty;for(let n=0,s=i.length;n!==s;++n)t[e++]=i[n]}_getValue_arrayElement(t,e){t[e]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(t,e){this.resolvedProperty.toArray(t,e)}_setValue_direct(t,e){this.targetObject[this.propertyName]=t[e]}_setValue_direct_setNeedsUpdate(t,e){this.targetObject[this.propertyName]=t[e],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(t,e){this.targetObject[this.propertyName]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(t,e){const i=this.resolvedProperty;for(let n=0,s=i.length;n!==s;++n)i[n]=t[e++]}_setValue_array_setNeedsUpdate(t,e){const i=this.resolvedProperty;for(let n=0,s=i.length;n!==s;++n)i[n]=t[e++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(t,e){const i=this.resolvedProperty;for(let n=0,s=i.length;n!==s;++n)i[n]=t[e++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(t,e){this.resolvedProperty[this.propertyIndex]=t[e]}_setValue_arrayElement_setNeedsUpdate(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(t,e){this.resolvedProperty.fromArray(t,e)}_setValue_fromArray_setNeedsUpdate(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(t,e){this.bind(),this.getValue(t,e)}_setValue_unbound(t,e){this.bind(),this.setValue(t,e)}bind(){let t=this.node;const e=this.parsedPath,i=e.objectName,n=e.propertyName;let s=e.propertyIndex;if(t||(t=ke.findNode(this.rootNode,e.nodeName),this.node=t),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!t){console.warn("THREE.PropertyBinding: No target node found for track: "+this.path+".");return}if(i){let d=e.objectIndex;switch(i){case"materials":if(!t.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!t.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}t=t.material.materials;break;case"bones":if(!t.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}t=t.skeleton.bones;for(let g=0;g<t.length;g++)if(t[g].name===d){d=g;break}break;case"map":if("map"in t){t=t.map;break}if(!t.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!t.material.map){console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);return}t=t.material.map;break;default:if(t[i]===void 0){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}t=t[i]}if(d!==void 0){if(t[d]===void 0){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,t);return}t=t[d]}}const a=t[n];if(a===void 0){const d=e.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+d+"."+n+" but it wasn't found.",t);return}let l=this.Versioning.None;this.targetObject=t,t.isMaterial===!0?l=this.Versioning.NeedsUpdate:t.isObject3D===!0&&(l=this.Versioning.MatrixWorldNeedsUpdate);let f=this.BindingType.Direct;if(s!==void 0){if(n==="morphTargetInfluences"){if(!t.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(!t.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}t.morphTargetDictionary[s]!==void 0&&(s=t.morphTargetDictionary[s])}f=this.BindingType.ArrayElement,this.resolvedProperty=a,this.propertyIndex=s}else a.fromArray!==void 0&&a.toArray!==void 0?(f=this.BindingType.HasFromToArray,this.resolvedProperty=a):Array.isArray(a)?(f=this.BindingType.EntireArray,this.resolvedProperty=a):this.propertyName=n;this.getValue=this.GetterByBindingType[f],this.setValue=this.SetterByBindingTypeAndVersioning[f][l]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}ke.Composite=pT;ke.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3};ke.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2};ke.prototype.GetterByBindingType=[ke.prototype._getValue_direct,ke.prototype._getValue_array,ke.prototype._getValue_arrayElement,ke.prototype._getValue_toArray];ke.prototype.SetterByBindingTypeAndVersioning=[[ke.prototype._setValue_direct,ke.prototype._setValue_direct_setNeedsUpdate,ke.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[ke.prototype._setValue_array,ke.prototype._setValue_array_setNeedsUpdate,ke.prototype._setValue_array_setMatrixWorldNeedsUpdate],[ke.prototype._setValue_arrayElement,ke.prototype._setValue_arrayElement_setNeedsUpdate,ke.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[ke.prototype._setValue_fromArray,ke.prototype._setValue_fromArray_setNeedsUpdate,ke.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];const ty=new Ht;class gT{constructor(t=new Ht(1/0,1/0),e=new Ht(-1/0,-1/0)){this.isBox2=!0,this.min=t,this.max=e}set(t,e){return this.min.copy(t),this.max.copy(e),this}setFromPoints(t){this.makeEmpty();for(let e=0,i=t.length;e<i;e++)this.expandByPoint(t[e]);return this}setFromCenterAndSize(t,e){const i=ty.copy(e).multiplyScalar(.5);return this.min.copy(t).sub(i),this.max.copy(t).add(i),this}clone(){return new this.constructor().copy(this)}copy(t){return this.min.copy(t.min),this.max.copy(t.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(t){return this.isEmpty()?t.set(0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(t){return this.isEmpty()?t.set(0,0):t.subVectors(this.max,this.min)}expandByPoint(t){return this.min.min(t),this.max.max(t),this}expandByVector(t){return this.min.sub(t),this.max.add(t),this}expandByScalar(t){return this.min.addScalar(-t),this.max.addScalar(t),this}containsPoint(t){return t.x>=this.min.x&&t.x<=this.max.x&&t.y>=this.min.y&&t.y<=this.max.y}containsBox(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y}getParameter(t,e){return e.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(t){return t.max.x>=this.min.x&&t.min.x<=this.max.x&&t.max.y>=this.min.y&&t.min.y<=this.max.y}clampPoint(t,e){return e.copy(t).clamp(this.min,this.max)}distanceToPoint(t){return this.clampPoint(t,ty).distanceTo(t)}intersect(t){return this.min.max(t.min),this.max.min(t.max),this.isEmpty()&&this.makeEmpty(),this}union(t){return this.min.min(t.min),this.max.max(t.max),this}translate(t){return this.min.add(t),this.max.add(t),this}equals(t){return t.min.equals(this.min)&&t.max.equals(this.max)}}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:qd}}));typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=qd);const ey={POSITION:["byte","byte normalized","unsigned byte","unsigned byte normalized","short","short normalized","unsigned short","unsigned short normalized"],NORMAL:["byte normalized","short normalized"],TANGENT:["byte normalized","short normalized"],TEXCOORD:["byte","byte normalized","unsigned byte","short","short normalized","unsigned short"]};class Zh{constructor(){this.textureUtils=null,this.pluginCallbacks=[],this.register(function(t){return new MT(t)}),this.register(function(t){return new LT(t)}),this.register(function(t){return new IT(t)}),this.register(function(t){return new CT(t)}),this.register(function(t){return new AT(t)}),this.register(function(t){return new NT(t)}),this.register(function(t){return new ST(t)}),this.register(function(t){return new TT(t)}),this.register(function(t){return new PT(t)}),this.register(function(t){return new OT(t)}),this.register(function(t){return new RT(t)}),this.register(function(t){return new DT(t)}),this.register(function(t){return new zT(t)}),this.register(function(t){return new BT(t)})}register(t){return this.pluginCallbacks.indexOf(t)===-1&&this.pluginCallbacks.push(t),this}unregister(t){return this.pluginCallbacks.indexOf(t)!==-1&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(t),1),this}setTextureUtils(t){return this.textureUtils=t,this}parse(t,e,i,n){const s=new kT,a=[];for(let l=0,f=this.pluginCallbacks.length;l<f;l++)a.push(this.pluginCallbacks[l](s));s.setPlugins(a),s.setTextureUtils(this.textureUtils),s.writeAsync(t,e,n).catch(i)}parseAsync(t,e){const i=this;return new Promise(function(n,s){i.parse(t,n,s,e)})}}const pe={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,BYTE:5120,UNSIGNED_BYTE:5121,SHORT:5122,UNSIGNED_SHORT:5123,INT:5124,UNSIGNED_INT:5125,FLOAT:5126,ARRAY_BUFFER:34962,ELEMENT_ARRAY_BUFFER:34963,NEAREST:9728,LINEAR:9729,NEAREST_MIPMAP_NEAREST:9984,LINEAR_MIPMAP_NEAREST:9985,NEAREST_MIPMAP_LINEAR:9986,LINEAR_MIPMAP_LINEAR:9987,CLAMP_TO_EDGE:33071,MIRRORED_REPEAT:33648,REPEAT:10497},ff="KHR_mesh_quantization",Ti={};Ti[zL]=pe.NEAREST;Ti[BL]=pe.NEAREST_MIPMAP_NEAREST;Ti[FL]=pe.NEAREST_MIPMAP_LINEAR;Ti[Bv]=pe.LINEAR;Ti[UL]=pe.LINEAR_MIPMAP_NEAREST;Ti[Fv]=pe.LINEAR_MIPMAP_LINEAR;Ti[Ru]=pe.CLAMP_TO_EDGE;Ti[Yf]=pe.REPEAT;Ti[Xf]=pe.MIRRORED_REPEAT;const ny={scale:"scale",position:"translation",quaternion:"rotation",morphTargetInfluences:"weights"},mT=new Vo,iy=12,yT=1179937895,_T=2,ry=8,vT=1313821514,xT=5130562;function Du(r,t){return r.length===t.length&&r.every(function(e,i){return e===t[i]})}function wT(r){return new TextEncoder().encode(r).buffer}function bT(r){return Du(r.elements,[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}function ET(r,t,e){const i={min:new Array(r.itemSize).fill(Number.POSITIVE_INFINITY),max:new Array(r.itemSize).fill(Number.NEGATIVE_INFINITY)};for(let n=t;n<t+e;n++)for(let s=0;s<r.itemSize;s++){let a;r.itemSize>4?a=r.array[n*r.itemSize+s]:(s===0?a=r.getX(n):s===1?a=r.getY(n):s===2?a=r.getZ(n):s===3&&(a=r.getW(n)),r.normalized===!0&&(a=Wf.normalize(a,r.array))),i.min[s]=Math.min(i.min[s],a),i.max[s]=Math.max(i.max[s],a)}return i}function e0(r){return Math.ceil(r/4)*4}function df(r,t=0){const e=e0(r.byteLength);if(e!==r.byteLength){const i=new Uint8Array(e);if(i.set(new Uint8Array(r)),t!==0)for(let n=r.byteLength;n<e;n++)i[n]=t;return i.buffer}return r}function sy(){return typeof document>"u"&&typeof OffscreenCanvas<"u"?new OffscreenCanvas(1,1):document.createElement("canvas")}function oy(r,t){if(r.toBlob!==void 0)return new Promise(i=>r.toBlob(i,t));let e;return t==="image/jpeg"?e=.92:t==="image/webp"&&(e=.8),r.convertToBlob({type:t,quality:e})}class kT{constructor(){this.plugins=[],this.options={},this.pending=[],this.buffers=[],this.byteOffset=0,this.buffers=[],this.nodeMap=new Map,this.skins=[],this.extensionsUsed={},this.extensionsRequired={},this.uids=new Map,this.uid=0,this.json={asset:{version:"2.0",generator:"THREE.GLTFExporter r"+qd}},this.cache={meshes:new Map,attributes:new Map,attributesNormalized:new Map,materials:new Map,textures:new Map,images:new Map},this.textureUtils=null}setPlugins(t){this.plugins=t}setTextureUtils(t){this.textureUtils=t}async writeAsync(t,e,i={}){this.options=Object.assign({binary:!1,trs:!1,onlyVisible:!0,maxTextureSize:1/0,animations:[],includeCustomExtensions:!1},i),this.options.animations.length>0&&(this.options.trs=!0),await this.processInputAsync(t),await Promise.all(this.pending);const n=this,s=n.buffers,a=n.json;i=n.options;const l=n.extensionsUsed,f=n.extensionsRequired,d=new Blob(s,{type:"application/octet-stream"}),g=Object.keys(l),m=Object.keys(f);if(g.length>0&&(a.extensionsUsed=g),m.length>0&&(a.extensionsRequired=m),a.buffers&&a.buffers.length>0&&(a.buffers[0].byteLength=d.size),i.binary===!0){const v=new FileReader;v.readAsArrayBuffer(d),v.onloadend=function(){const _=df(v.result),w=new DataView(new ArrayBuffer(ry));w.setUint32(0,_.byteLength,!0),w.setUint32(4,xT,!0);const b=df(wT(JSON.stringify(a)),32),S=new DataView(new ArrayBuffer(ry));S.setUint32(0,b.byteLength,!0),S.setUint32(4,vT,!0);const N=new ArrayBuffer(iy),k=new DataView(N);k.setUint32(0,yT,!0),k.setUint32(4,_T,!0);const C=iy+S.byteLength+b.byteLength+w.byteLength+_.byteLength;k.setUint32(8,C,!0);const A=new Blob([N,S,b,w,_],{type:"application/octet-stream"}),P=new FileReader;P.readAsArrayBuffer(A),P.onloadend=function(){e(P.result)}}}else if(a.buffers&&a.buffers.length>0){const v=new FileReader;v.readAsDataURL(d),v.onloadend=function(){const _=v.result;a.buffers[0].uri=_,e(a)}}else e(a)}serializeUserData(t,e){if(Object.keys(t.userData).length===0)return;const i=this.options,n=this.extensionsUsed;try{const s=JSON.parse(JSON.stringify(t.userData));if(i.includeCustomExtensions&&s.gltfExtensions){e.extensions===void 0&&(e.extensions={});for(const a in s.gltfExtensions)e.extensions[a]=s.gltfExtensions[a],n[a]=!0;delete s.gltfExtensions}Object.keys(s).length>0&&(e.extras=s)}catch(s){console.warn("THREE.GLTFExporter: userData of '"+t.name+"' won't be serialized because of JSON.stringify error - "+s.message)}}getUID(t,e=!1){if(this.uids.has(t)===!1){const n=new Map;n.set(!0,this.uid++),n.set(!1,this.uid++),this.uids.set(t,n)}return this.uids.get(t).get(e)}isNormalizedNormalAttribute(t){if(this.cache.attributesNormalized.has(t))return!1;const i=new Mt;for(let n=0,s=t.count;n<s;n++)if(Math.abs(i.fromBufferAttribute(t,n).length()-1)>5e-4)return!1;return!0}createNormalizedNormalAttribute(t){const e=this.cache;if(e.attributesNormalized.has(t))return e.attributesNormalized.get(t);const i=t.clone(),n=new Mt;for(let s=0,a=i.count;s<a;s++)n.fromBufferAttribute(i,s),n.x===0&&n.y===0&&n.z===0?n.setX(1):n.normalize(),i.setXYZ(s,n.x,n.y,n.z);return e.attributesNormalized.set(t,i),i}applyTextureTransform(t,e){let i=!1;const n={};(e.offset.x!==0||e.offset.y!==0)&&(n.offset=e.offset.toArray(),i=!0),e.rotation!==0&&(n.rotation=e.rotation,i=!0),(e.repeat.x!==1||e.repeat.y!==1)&&(n.scale=e.repeat.toArray(),i=!0),i&&(t.extensions=t.extensions||{},t.extensions.KHR_texture_transform=n,this.extensionsUsed.KHR_texture_transform=!0)}async buildMetalRoughTextureAsync(t,e){if(t===e)return t;function i(_){return _.colorSpace===Xi?function(b){return b<.04045?b*.0773993808:Math.pow(b*.9478672986+.0521327014,2.4)}:function(b){return b}}t instanceof uf&&(t=await this.decompressTextureAsync(t)),e instanceof uf&&(e=await this.decompressTextureAsync(e));const n=t?t.image:null,s=e?e.image:null,a=Math.max(n?n.width:0,s?s.width:0),l=Math.max(n?n.height:0,s?s.height:0),f=sy();f.width=a,f.height=l;const d=f.getContext("2d",{willReadFrequently:!0});d.fillStyle="#00ffff",d.fillRect(0,0,a,l);const g=d.getImageData(0,0,a,l);if(n){d.drawImage(n,0,0,a,l);const _=i(t),w=d.getImageData(0,0,a,l).data;for(let b=2;b<w.length;b+=4)g.data[b]=_(w[b]/256)*256}if(s){d.drawImage(s,0,0,a,l);const _=i(e),w=d.getImageData(0,0,a,l).data;for(let b=1;b<w.length;b+=4)g.data[b]=_(w[b]/256)*256}d.putImageData(g,0,0);const v=(t||e).clone();return v.source=new qv(f),v.colorSpace=Zd,v.channel=(t||e).channel,t&&e&&t.channel!==e.channel&&console.warn("THREE.GLTFExporter: UV channels for metalnessMap and roughnessMap textures must match."),console.warn("THREE.GLTFExporter: Merged metalnessMap and roughnessMap textures."),v}async decompressTextureAsync(t,e=1/0){if(this.textureUtils===null)throw new Error("THREE.GLTFExporter: setTextureUtils() must be called to process compressed textures.");return await this.textureUtils.decompress(t,e)}processBuffer(t){const e=this.json,i=this.buffers;return e.buffers||(e.buffers=[{byteLength:0}]),i.push(t),0}processBufferView(t,e,i,n,s){const a=this.json;a.bufferViews||(a.bufferViews=[]);let l;switch(e){case pe.BYTE:case pe.UNSIGNED_BYTE:l=1;break;case pe.SHORT:case pe.UNSIGNED_SHORT:l=2;break;default:l=4}let f=t.itemSize*l;s===pe.ARRAY_BUFFER&&(f=Math.ceil(f/4)*4);const d=e0(n*f),g=new DataView(new ArrayBuffer(d));let m=0;for(let w=i;w<i+n;w++){for(let b=0;b<t.itemSize;b++){let S;t.itemSize>4?S=t.array[w*t.itemSize+b]:(b===0?S=t.getX(w):b===1?S=t.getY(w):b===2?S=t.getZ(w):b===3&&(S=t.getW(w)),t.normalized===!0&&(S=Wf.normalize(S,t.array))),e===pe.FLOAT?g.setFloat32(m,S,!0):e===pe.INT?g.setInt32(m,S,!0):e===pe.UNSIGNED_INT?g.setUint32(m,S,!0):e===pe.SHORT?g.setInt16(m,S,!0):e===pe.UNSIGNED_SHORT?g.setUint16(m,S,!0):e===pe.BYTE?g.setInt8(m,S):e===pe.UNSIGNED_BYTE&&g.setUint8(m,S),m+=l}m%f!==0&&(m+=f-m%f)}const v={buffer:this.processBuffer(g.buffer),byteOffset:this.byteOffset,byteLength:d};return s!==void 0&&(v.target=s),s===pe.ARRAY_BUFFER&&(v.byteStride=f),this.byteOffset+=d,a.bufferViews.push(v),{id:a.bufferViews.length-1,byteLength:0}}processBufferViewImage(t){const e=this,i=e.json;return i.bufferViews||(i.bufferViews=[]),new Promise(function(n){const s=new FileReader;s.readAsArrayBuffer(t),s.onloadend=function(){const a=df(s.result),l={buffer:e.processBuffer(a),byteOffset:e.byteOffset,byteLength:a.byteLength};e.byteOffset+=a.byteLength,n(i.bufferViews.push(l)-1)}})}processAccessor(t,e,i,n){const s=this.json,a={1:"SCALAR",2:"VEC2",3:"VEC3",4:"VEC4",9:"MAT3",16:"MAT4"};let l;if(t.array.constructor===Float32Array)l=pe.FLOAT;else if(t.array.constructor===Int32Array)l=pe.INT;else if(t.array.constructor===Uint32Array)l=pe.UNSIGNED_INT;else if(t.array.constructor===Int16Array)l=pe.SHORT;else if(t.array.constructor===Uint16Array)l=pe.UNSIGNED_SHORT;else if(t.array.constructor===Int8Array)l=pe.BYTE;else if(t.array.constructor===Uint8Array)l=pe.UNSIGNED_BYTE;else throw new Error("THREE.GLTFExporter: Unsupported bufferAttribute component type: "+t.array.constructor.name);if(i===void 0&&(i=0),(n===void 0||n===1/0)&&(n=t.count),n===0)return null;const f=ET(t,i,n);let d;e!==void 0&&(d=t===e.index?pe.ELEMENT_ARRAY_BUFFER:pe.ARRAY_BUFFER);const g=this.processBufferView(t,l,i,n,d),m={bufferView:g.id,byteOffset:g.byteOffset,componentType:l,count:n,max:f.max,min:f.min,type:a[t.itemSize]};return t.normalized===!0&&(m.normalized=!0),s.accessors||(s.accessors=[]),s.accessors.push(m)-1}processImage(t,e,i,n="image/png"){if(t!==null){const s=this,a=s.cache,l=s.json,f=s.options,d=s.pending;a.images.has(t)||a.images.set(t,{});const g=a.images.get(t),m=n+":flipY/"+i.toString();if(g[m]!==void 0)return g[m];l.images||(l.images=[]);const v={mimeType:n},_=sy();_.width=Math.min(t.width,f.maxTextureSize),_.height=Math.min(t.height,f.maxTextureSize);const w=_.getContext("2d",{willReadFrequently:!0});if(i===!0&&(w.translate(0,_.height),w.scale(1,-1)),t.data!==void 0){e!==Uv&&console.error("GLTFExporter: Only RGBAFormat is supported.",e),(t.width>f.maxTextureSize||t.height>f.maxTextureSize)&&console.warn("GLTFExporter: Image size is bigger than maxTextureSize",t);const S=new Uint8ClampedArray(t.height*t.width*4);for(let N=0;N<S.length;N+=4)S[N+0]=t.data[N+0],S[N+1]=t.data[N+1],S[N+2]=t.data[N+2],S[N+3]=t.data[N+3];w.putImageData(new ImageData(S,t.width,t.height),0,0)}else if(typeof HTMLImageElement<"u"&&t instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&t instanceof ImageBitmap||typeof OffscreenCanvas<"u"&&t instanceof OffscreenCanvas)w.drawImage(t,0,0,_.width,_.height);else throw new Error("THREE.GLTFExporter: Invalid image type. Use HTMLImageElement, HTMLCanvasElement, ImageBitmap or OffscreenCanvas.");f.binary===!0?d.push(oy(_,n).then(S=>s.processBufferViewImage(S)).then(S=>{v.bufferView=S})):_.toDataURL!==void 0?v.uri=_.toDataURL(n):d.push(oy(_,n).then(S=>new FileReader().readAsDataURL(S)).then(S=>{v.uri=S}));const b=l.images.push(v)-1;return g[m]=b,b}else throw new Error("THREE.GLTFExporter: No valid image data found. Unable to process texture.")}processSampler(t){const e=this.json;e.samplers||(e.samplers=[]);const i={magFilter:Ti[t.magFilter],minFilter:Ti[t.minFilter],wrapS:Ti[t.wrapS],wrapT:Ti[t.wrapT]};return e.samplers.push(i)-1}async processTextureAsync(t){const i=this.options,n=this.cache,s=this.json;if(n.textures.has(t))return n.textures.get(t);s.textures||(s.textures=[]),t instanceof uf&&(t=await this.decompressTextureAsync(t,i.maxTextureSize));let a=t.userData.mimeType;a==="image/webp"&&(a="image/png");const l={sampler:this.processSampler(t),source:this.processImage(t.image,t.format,t.flipY,a)};t.name&&(l.name=t.name),await this._invokeAllAsync(async function(d){d.writeTexture&&await d.writeTexture(t,l)});const f=s.textures.push(l)-1;return n.textures.set(t,f),f}async processMaterialAsync(t){const e=this.cache,i=this.json;if(e.materials.has(t))return e.materials.get(t);if(t.isShaderMaterial)return console.warn("GLTFExporter: THREE.ShaderMaterial not supported."),null;i.materials||(i.materials=[]);const n={pbrMetallicRoughness:{}};t.isMeshStandardMaterial!==!0&&t.isMeshBasicMaterial!==!0&&console.warn("GLTFExporter: Use MeshStandardMaterial or MeshBasicMaterial for best results.");const s=t.color.toArray().concat([t.opacity]);if(Du(s,[1,1,1,1])||(n.pbrMetallicRoughness.baseColorFactor=s),t.isMeshStandardMaterial?(n.pbrMetallicRoughness.metallicFactor=t.metalness,n.pbrMetallicRoughness.roughnessFactor=t.roughness):(n.pbrMetallicRoughness.metallicFactor=0,n.pbrMetallicRoughness.roughnessFactor=1),t.metalnessMap||t.roughnessMap){const l=await this.buildMetalRoughTextureAsync(t.metalnessMap,t.roughnessMap),f={index:await this.processTextureAsync(l),texCoord:l.channel};this.applyTextureTransform(f,l),n.pbrMetallicRoughness.metallicRoughnessTexture=f}if(t.map){const l={index:await this.processTextureAsync(t.map),texCoord:t.map.channel};this.applyTextureTransform(l,t.map),n.pbrMetallicRoughness.baseColorTexture=l}if(t.emissive){const l=t.emissive;if(Math.max(l.r,l.g,l.b)>0&&(n.emissiveFactor=t.emissive.toArray()),t.emissiveMap){const d={index:await this.processTextureAsync(t.emissiveMap),texCoord:t.emissiveMap.channel};this.applyTextureTransform(d,t.emissiveMap),n.emissiveTexture=d}}if(t.normalMap){const l={index:await this.processTextureAsync(t.normalMap),texCoord:t.normalMap.channel};t.normalScale&&t.normalScale.x!==1&&(l.scale=t.normalScale.x),this.applyTextureTransform(l,t.normalMap),n.normalTexture=l}if(t.aoMap){const l={index:await this.processTextureAsync(t.aoMap),texCoord:t.aoMap.channel};t.aoMapIntensity!==1&&(l.strength=t.aoMapIntensity),this.applyTextureTransform(l,t.aoMap),n.occlusionTexture=l}t.transparent?n.alphaMode="BLEND":t.alphaTest>0&&(n.alphaMode="MASK",n.alphaCutoff=t.alphaTest),t.side===Dv&&(n.doubleSided=!0),t.name!==""&&(n.name=t.name),this.serializeUserData(t,n),await this._invokeAllAsync(async function(l){l.writeMaterialAsync&&await l.writeMaterialAsync(t,n)});const a=i.materials.push(n)-1;return e.materials.set(t,a),a}async processMeshAsync(t){const e=this.cache,i=this.json,n=[t.geometry.uuid];if(Array.isArray(t.material))for(let A=0,P=t.material.length;A<P;A++)n.push(t.material[A].uuid);else n.push(t.material.uuid);const s=n.join(":");if(e.meshes.has(s))return e.meshes.get(s);const a=t.geometry;let l;t.isLineSegments?l=pe.LINES:t.isLineLoop?l=pe.LINE_LOOP:t.isLine?l=pe.LINE_STRIP:t.isPoints?l=pe.POINTS:l=t.material.wireframe?pe.LINES:pe.TRIANGLES;const f={},d={},g=[],m=[],v={uv:"TEXCOORD_0",uv1:"TEXCOORD_1",uv2:"TEXCOORD_2",uv3:"TEXCOORD_3",color:"COLOR_0",skinWeight:"WEIGHTS_0",skinIndex:"JOINTS_0"},_=a.getAttribute("normal");_!==void 0&&!this.isNormalizedNormalAttribute(_)&&(console.warn("THREE.GLTFExporter: Creating normalized normal attribute from the non-normalized one."),a.setAttribute("normal",this.createNormalizedNormalAttribute(_)));let w=null;for(let A in a.attributes){if(A.slice(0,5)==="morph")continue;const P=a.attributes[A];if(A=v[A]||A.toUpperCase(),/^(POSITION|NORMAL|TANGENT|TEXCOORD_\d+|COLOR_\d+|JOINTS_\d+|WEIGHTS_\d+)$/.test(A)||(A="_"+A),e.attributes.has(this.getUID(P))){d[A]=e.attributes.get(this.getUID(P));continue}w=null;const U=P.array;A==="JOINTS_0"&&!(U instanceof Uint16Array)&&!(U instanceof Uint8Array)?(console.warn('GLTFExporter: Attribute "skinIndex" converted to type UNSIGNED_SHORT.'),w=new On(new Uint16Array(U),P.itemSize,P.normalized)):(U instanceof Uint32Array||U instanceof Int32Array)&&!A.startsWith("_")&&(console.warn(`GLTFExporter: Attribute "${A}" converted to type FLOAT.`),w=Zh.Utils.toFloat32BufferAttribute(P));const I=this.processAccessor(w||P,a);I!==null&&(A.startsWith("_")||this.detectMeshQuantization(A,P),d[A]=I,e.attributes.set(this.getUID(P),I))}if(_!==void 0&&a.setAttribute("normal",_),Object.keys(d).length===0)return null;if(t.morphTargetInfluences!==void 0&&t.morphTargetInfluences.length>0){const A=[],P=[],q={};if(t.morphTargetDictionary!==void 0)for(const U in t.morphTargetDictionary)q[t.morphTargetDictionary[U]]=U;for(let U=0;U<t.morphTargetInfluences.length;++U){const I={};let O=!1;for(const B in a.morphAttributes){if(B!=="position"&&B!=="normal"){O||(console.warn("GLTFExporter: Only POSITION and NORMAL morph are supported."),O=!0);continue}const V=a.morphAttributes[B][U],z=B.toUpperCase(),W=a.attributes[B];if(e.attributes.has(this.getUID(V,!0))){I[z]=e.attributes.get(this.getUID(V,!0));continue}const T=V.clone();if(!a.morphTargetsRelative)for(let $=0,F=V.count;$<F;$++)for(let X=0;X<V.itemSize;X++)X===0&&T.setX($,V.getX($)-W.getX($)),X===1&&T.setY($,V.getY($)-W.getY($)),X===2&&T.setZ($,V.getZ($)-W.getZ($)),X===3&&T.setW($,V.getW($)-W.getW($));I[z]=this.processAccessor(T,a),e.attributes.set(this.getUID(W,!0),I[z])}m.push(I),A.push(t.morphTargetInfluences[U]),t.morphTargetDictionary!==void 0&&P.push(q[U])}f.weights=A,P.length>0&&(f.extras={},f.extras.targetNames=P)}const b=Array.isArray(t.material);if(b&&a.groups.length===0)return null;let S=!1;if(b&&a.index===null){const A=[];for(let P=0,q=a.attributes.position.count;P<q;P++)A[P]=P;a.setIndex(A),S=!0}const N=b?t.material:[t.material],k=b?a.groups:[{materialIndex:0,start:void 0,count:void 0}];for(let A=0,P=k.length;A<P;A++){const q={mode:l,attributes:d};if(this.serializeUserData(a,q),m.length>0&&(q.targets=m),a.index!==null){let I=this.getUID(a.index);(k[A].start!==void 0||k[A].count!==void 0)&&(I+=":"+k[A].start+":"+k[A].count),e.attributes.has(I)?q.indices=e.attributes.get(I):(q.indices=this.processAccessor(a.index,a,k[A].start,k[A].count),e.attributes.set(I,q.indices)),q.indices===null&&delete q.indices}const U=await this.processMaterialAsync(N[k[A].materialIndex]);U!==null&&(q.material=U),g.push(q)}S===!0&&a.setIndex(null),f.primitives=g,i.meshes||(i.meshes=[]),await this._invokeAllAsync(function(A){A.writeMesh&&A.writeMesh(t,f)});const C=i.meshes.push(f)-1;return e.meshes.set(s,C),C}detectMeshQuantization(t,e){if(this.extensionsUsed[ff])return;let i;switch(e.array.constructor){case Int8Array:i="byte";break;case Uint8Array:i="unsigned byte";break;case Int16Array:i="short";break;case Uint16Array:i="unsigned short";break;default:return}e.normalized&&(i+=" normalized");const n=t.split("_",1)[0];ey[n]&&ey[n].includes(i)&&(this.extensionsUsed[ff]=!0,this.extensionsRequired[ff]=!0)}processCamera(t){const e=this.json;e.cameras||(e.cameras=[]);const i=t.isOrthographicCamera,n={type:i?"orthographic":"perspective"};return i?n.orthographic={xmag:t.right*2,ymag:t.top*2,zfar:t.far<=0?.001:t.far,znear:t.near<0?0:t.near}:n.perspective={aspectRatio:t.aspect,yfov:Wf.degToRad(t.fov),zfar:t.far<=0?.001:t.far,znear:t.near<0?0:t.near},t.name!==""&&(n.name=t.type),e.cameras.push(n)-1}processAnimation(t,e){const i=this.json,n=this.nodeMap;i.animations||(i.animations=[]),t=Zh.Utils.mergeMorphTargetTracks(t.clone(),e);const s=t.tracks,a=[],l=[];for(let f=0;f<s.length;++f){const d=s[f],g=ke.parseTrackName(d.name);let m=ke.findNode(e,g.nodeName);const v=ny[g.propertyName];if(g.objectName==="bones"&&(m.isSkinnedMesh===!0?m=m.skeleton.getBoneByName(g.objectIndex):m=void 0),!m||!v){console.warn('THREE.GLTFExporter: Could not export animation track "%s".',d.name);continue}const _=1;let w=d.values.length/d.times.length;v===ny.morphTargetInfluences&&(w/=m.morphTargetInfluences.length);let b;d.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline===!0?(b="CUBICSPLINE",w/=3):d.getInterpolation()===qL?b="STEP":b="LINEAR",l.push({input:this.processAccessor(new On(d.times,_)),output:this.processAccessor(new On(d.values,w)),interpolation:b}),a.push({sampler:l.length-1,target:{node:n.get(m),path:v}})}return i.animations.push({name:t.name||"clip_"+i.animations.length,samplers:l,channels:a}),i.animations.length-1}processSkin(t){const e=this.json,i=this.nodeMap,n=e.nodes[i.get(t)],s=t.skeleton;if(s===void 0)return null;const a=t.skeleton.bones[0];if(a===void 0)return null;const l=[],f=new Float32Array(s.bones.length*16),d=new di;for(let m=0;m<s.bones.length;++m)l.push(i.get(s.bones[m])),d.copy(s.boneInverses[m]),d.multiply(t.bindMatrix).toArray(f,m*16);return e.skins===void 0&&(e.skins=[]),e.skins.push({inverseBindMatrices:this.processAccessor(new On(f,16)),joints:l,skeleton:i.get(a)}),n.skin=e.skins.length-1}async processNodeAsync(t){const e=this.json,i=this.options,n=this.nodeMap;e.nodes||(e.nodes=[]);const s={};if(i.trs){const l=t.quaternion.toArray(),f=t.position.toArray(),d=t.scale.toArray();Du(l,[0,0,0,1])||(s.rotation=l),Du(f,[0,0,0])||(s.translation=f),Du(d,[1,1,1])||(s.scale=d)}else t.matrixAutoUpdate&&t.updateMatrix(),bT(t.matrix)===!1&&(s.matrix=t.matrix.elements);if(t.name!==""&&(s.name=String(t.name)),this.serializeUserData(t,s),t.isMesh||t.isLine||t.isPoints){const l=await this.processMeshAsync(t);l!==null&&(s.mesh=l)}else t.isCamera&&(s.camera=this.processCamera(t));if(t.isSkinnedMesh&&this.skins.push(t),t.children.length>0){const l=[];for(let f=0,d=t.children.length;f<d;f++){const g=t.children[f];if(g.visible||i.onlyVisible===!1){const m=await this.processNodeAsync(g);m!==null&&l.push(m)}}l.length>0&&(s.children=l)}await this._invokeAllAsync(function(l){l.writeNode&&l.writeNode(t,s)});const a=e.nodes.push(s)-1;return n.set(t,a),a}async processSceneAsync(t){const e=this.json,i=this.options;e.scenes||(e.scenes=[],e.scene=0);const n={};t.name!==""&&(n.name=t.name),e.scenes.push(n);const s=[];for(let a=0,l=t.children.length;a<l;a++){const f=t.children[a];if(f.visible||i.onlyVisible===!1){const d=await this.processNodeAsync(f);d!==null&&s.push(d)}}s.length>0&&(n.nodes=s),this.serializeUserData(t,n)}async processObjectsAsync(t){const e=new $f;e.name="AuxScene";for(let i=0;i<t.length;i++)e.children.push(t[i]);await this.processSceneAsync(e)}async processInputAsync(t){const e=this.options;t=t instanceof Array?t:[t],await this._invokeAllAsync(function(n){n.beforeParse&&n.beforeParse(t)});const i=[];for(let n=0;n<t.length;n++)t[n]instanceof $f?await this.processSceneAsync(t[n]):i.push(t[n]);i.length>0&&await this.processObjectsAsync(i);for(let n=0;n<this.skins.length;++n)this.processSkin(this.skins[n]);for(let n=0;n<e.animations.length;++n)this.processAnimation(e.animations[n],t[0]);await this._invokeAllAsync(function(n){n.afterParse&&n.afterParse(t)})}async _invokeAllAsync(t){for(let e=0,i=this.plugins.length;e<i;e++)await t(this.plugins[e])}}class MT{constructor(t){this.writer=t,this.name="KHR_lights_punctual"}writeNode(t,e){if(!t.isLight)return;if(!t.isDirectionalLight&&!t.isPointLight&&!t.isSpotLight){console.warn("THREE.GLTFExporter: Only directional, point, and spot lights are supported.",t);return}const i=this.writer,n=i.json,s=i.extensionsUsed,a={};t.name&&(a.name=t.name),a.color=t.color.toArray(),a.intensity=t.intensity,t.isDirectionalLight?a.type="directional":t.isPointLight?(a.type="point",t.distance>0&&(a.range=t.distance)):t.isSpotLight&&(a.type="spot",t.distance>0&&(a.range=t.distance),a.spot={},a.spot.innerConeAngle=(1-t.penumbra)*t.angle,a.spot.outerConeAngle=t.angle),t.decay!==void 0&&t.decay!==2&&console.warn("THREE.GLTFExporter: Light decay may be lost. glTF is physically-based, and expects light.decay=2."),t.target&&(t.target.parent!==t||t.target.position.x!==0||t.target.position.y!==0||t.target.position.z!==-1)&&console.warn("THREE.GLTFExporter: Light direction may be lost. For best results, make light.target a child of the light with position 0,0,-1."),s[this.name]||(n.extensions=n.extensions||{},n.extensions[this.name]={lights:[]},s[this.name]=!0);const l=n.extensions[this.name].lights;l.push(a),e.extensions=e.extensions||{},e.extensions[this.name]={light:l.length-1}}}class LT{constructor(t){this.writer=t,this.name="KHR_materials_unlit"}async writeMaterialAsync(t,e){if(!t.isMeshBasicMaterial)return;const n=this.writer.extensionsUsed;e.extensions=e.extensions||{},e.extensions[this.name]={},n[this.name]=!0,e.pbrMetallicRoughness.metallicFactor=0,e.pbrMetallicRoughness.roughnessFactor=.9}}class ST{constructor(t){this.writer=t,this.name="KHR_materials_clearcoat"}async writeMaterialAsync(t,e){if(!t.isMeshPhysicalMaterial||t.clearcoat===0)return;const i=this.writer,n=i.extensionsUsed,s={};if(s.clearcoatFactor=t.clearcoat,t.clearcoatMap){const a={index:await i.processTextureAsync(t.clearcoatMap),texCoord:t.clearcoatMap.channel};i.applyTextureTransform(a,t.clearcoatMap),s.clearcoatTexture=a}if(s.clearcoatRoughnessFactor=t.clearcoatRoughness,t.clearcoatRoughnessMap){const a={index:await i.processTextureAsync(t.clearcoatRoughnessMap),texCoord:t.clearcoatRoughnessMap.channel};i.applyTextureTransform(a,t.clearcoatRoughnessMap),s.clearcoatRoughnessTexture=a}if(t.clearcoatNormalMap){const a={index:await i.processTextureAsync(t.clearcoatNormalMap),texCoord:t.clearcoatNormalMap.channel};t.clearcoatNormalScale.x!==1&&(a.scale=t.clearcoatNormalScale.x),i.applyTextureTransform(a,t.clearcoatNormalMap),s.clearcoatNormalTexture=a}e.extensions=e.extensions||{},e.extensions[this.name]=s,n[this.name]=!0}}class TT{constructor(t){this.writer=t,this.name="KHR_materials_dispersion"}async writeMaterialAsync(t,e){if(!t.isMeshPhysicalMaterial||t.dispersion===0)return;const n=this.writer.extensionsUsed,s={};s.dispersion=t.dispersion,e.extensions=e.extensions||{},e.extensions[this.name]=s,n[this.name]=!0}}class PT{constructor(t){this.writer=t,this.name="KHR_materials_iridescence"}async writeMaterialAsync(t,e){if(!t.isMeshPhysicalMaterial||t.iridescence===0)return;const i=this.writer,n=i.extensionsUsed,s={};if(s.iridescenceFactor=t.iridescence,t.iridescenceMap){const a={index:await i.processTextureAsync(t.iridescenceMap),texCoord:t.iridescenceMap.channel};i.applyTextureTransform(a,t.iridescenceMap),s.iridescenceTexture=a}if(s.iridescenceIor=t.iridescenceIOR,s.iridescenceThicknessMinimum=t.iridescenceThicknessRange[0],s.iridescenceThicknessMaximum=t.iridescenceThicknessRange[1],t.iridescenceThicknessMap){const a={index:await i.processTextureAsync(t.iridescenceThicknessMap),texCoord:t.iridescenceThicknessMap.channel};i.applyTextureTransform(a,t.iridescenceThicknessMap),s.iridescenceThicknessTexture=a}e.extensions=e.extensions||{},e.extensions[this.name]=s,n[this.name]=!0}}class IT{constructor(t){this.writer=t,this.name="KHR_materials_transmission"}async writeMaterialAsync(t,e){if(!t.isMeshPhysicalMaterial||t.transmission===0)return;const i=this.writer,n=i.extensionsUsed,s={};if(s.transmissionFactor=t.transmission,t.transmissionMap){const a={index:await i.processTextureAsync(t.transmissionMap),texCoord:t.transmissionMap.channel};i.applyTextureTransform(a,t.transmissionMap),s.transmissionTexture=a}e.extensions=e.extensions||{},e.extensions[this.name]=s,n[this.name]=!0}}class CT{constructor(t){this.writer=t,this.name="KHR_materials_volume"}async writeMaterialAsync(t,e){if(!t.isMeshPhysicalMaterial||t.transmission===0)return;const i=this.writer,n=i.extensionsUsed,s={};if(s.thicknessFactor=t.thickness,t.thicknessMap){const a={index:await i.processTextureAsync(t.thicknessMap),texCoord:t.thicknessMap.channel};i.applyTextureTransform(a,t.thicknessMap),s.thicknessTexture=a}t.attenuationDistance!==1/0&&(s.attenuationDistance=t.attenuationDistance),s.attenuationColor=t.attenuationColor.toArray(),e.extensions=e.extensions||{},e.extensions[this.name]=s,n[this.name]=!0}}class AT{constructor(t){this.writer=t,this.name="KHR_materials_ior"}async writeMaterialAsync(t,e){if(!t.isMeshPhysicalMaterial||t.ior===1.5)return;const n=this.writer.extensionsUsed,s={};s.ior=t.ior,e.extensions=e.extensions||{},e.extensions[this.name]=s,n[this.name]=!0}}class NT{constructor(t){this.writer=t,this.name="KHR_materials_specular"}async writeMaterialAsync(t,e){if(!t.isMeshPhysicalMaterial||t.specularIntensity===1&&t.specularColor.equals(mT)&&!t.specularIntensityMap&&!t.specularColorMap)return;const i=this.writer,n=i.extensionsUsed,s={};if(t.specularIntensityMap){const a={index:await i.processTextureAsync(t.specularIntensityMap),texCoord:t.specularIntensityMap.channel};i.applyTextureTransform(a,t.specularIntensityMap),s.specularTexture=a}if(t.specularColorMap){const a={index:await i.processTextureAsync(t.specularColorMap),texCoord:t.specularColorMap.channel};i.applyTextureTransform(a,t.specularColorMap),s.specularColorTexture=a}s.specularFactor=t.specularIntensity,s.specularColorFactor=t.specularColor.toArray(),e.extensions=e.extensions||{},e.extensions[this.name]=s,n[this.name]=!0}}class OT{constructor(t){this.writer=t,this.name="KHR_materials_sheen"}async writeMaterialAsync(t,e){if(!t.isMeshPhysicalMaterial||t.sheen==0)return;const i=this.writer,n=i.extensionsUsed,s={};if(t.sheenRoughnessMap){const a={index:await i.processTextureAsync(t.sheenRoughnessMap),texCoord:t.sheenRoughnessMap.channel};i.applyTextureTransform(a,t.sheenRoughnessMap),s.sheenRoughnessTexture=a}if(t.sheenColorMap){const a={index:await i.processTextureAsync(t.sheenColorMap),texCoord:t.sheenColorMap.channel};i.applyTextureTransform(a,t.sheenColorMap),s.sheenColorTexture=a}s.sheenRoughnessFactor=t.sheenRoughness,s.sheenColorFactor=t.sheenColor.toArray(),e.extensions=e.extensions||{},e.extensions[this.name]=s,n[this.name]=!0}}class RT{constructor(t){this.writer=t,this.name="KHR_materials_anisotropy"}async writeMaterialAsync(t,e){if(!t.isMeshPhysicalMaterial||t.anisotropy==0)return;const i=this.writer,n=i.extensionsUsed,s={};if(t.anisotropyMap){const a={index:await i.processTextureAsync(t.anisotropyMap)};i.applyTextureTransform(a,t.anisotropyMap),s.anisotropyTexture=a}s.anisotropyStrength=t.anisotropy,s.anisotropyRotation=t.anisotropyRotation,e.extensions=e.extensions||{},e.extensions[this.name]=s,n[this.name]=!0}}class DT{constructor(t){this.writer=t,this.name="KHR_materials_emissive_strength"}async writeMaterialAsync(t,e){if(!t.isMeshStandardMaterial||t.emissiveIntensity===1)return;const n=this.writer.extensionsUsed,s={};s.emissiveStrength=t.emissiveIntensity,e.extensions=e.extensions||{},e.extensions[this.name]=s,n[this.name]=!0}}class zT{constructor(t){this.writer=t,this.name="EXT_materials_bump"}async writeMaterialAsync(t,e){if(!t.isMeshStandardMaterial||t.bumpScale===1&&!t.bumpMap)return;const i=this.writer,n=i.extensionsUsed,s={};if(t.bumpMap){const a={index:await i.processTextureAsync(t.bumpMap),texCoord:t.bumpMap.channel};i.applyTextureTransform(a,t.bumpMap),s.bumpTexture=a}s.bumpFactor=t.bumpScale,e.extensions=e.extensions||{},e.extensions[this.name]=s,n[this.name]=!0}}class BT{constructor(t){this.writer=t,this.name="EXT_mesh_gpu_instancing"}writeNode(t,e){if(!t.isInstancedMesh)return;const i=this.writer,n=t,s=new Float32Array(n.count*3),a=new Float32Array(n.count*4),l=new Float32Array(n.count*3),f=new di,d=new Mt,g=new nu,m=new Mt;for(let _=0;_<n.count;_++)n.getMatrixAt(_,f),f.decompose(d,g,m),d.toArray(s,_*3),g.toArray(a,_*4),m.toArray(l,_*3);const v={TRANSLATION:i.processAccessor(new On(s,3)),ROTATION:i.processAccessor(new On(a,4)),SCALE:i.processAccessor(new On(l,3))};n.instanceColor&&(v._COLOR_0=i.processAccessor(n.instanceColor)),e.extensions=e.extensions||{},e.extensions[this.name]={attributes:v},i.extensionsUsed[this.name]=!0,i.extensionsRequired[this.name]=!0}}Zh.Utils={insertKeyframe:function(r,t){const i=r.getValueSize(),n=new r.TimeBufferType(r.times.length+1),s=new r.ValueBufferType(r.values.length+i),a=r.createInterpolant(new r.ValueBufferType(i));let l;if(r.times.length===0){n[0]=t;for(let f=0;f<i;f++)s[f]=0;l=0}else if(t<r.times[0]){if(Math.abs(r.times[0]-t)<.001)return 0;n[0]=t,n.set(r.times,1),s.set(a.evaluate(t),0),s.set(r.values,i),l=0}else if(t>r.times[r.times.length-1]){if(Math.abs(r.times[r.times.length-1]-t)<.001)return r.times.length-1;n[n.length-1]=t,n.set(r.times,0),s.set(r.values,0),s.set(a.evaluate(t),r.values.length),l=n.length-1}else for(let f=0;f<r.times.length;f++){if(Math.abs(r.times[f]-t)<.001)return f;if(r.times[f]<t&&r.times[f+1]>t){n.set(r.times.slice(0,f+1),0),n[f+1]=t,n.set(r.times.slice(f+1),f+2),s.set(r.values.slice(0,(f+1)*i),0),s.set(a.evaluate(t),(f+1)*i),s.set(r.values.slice((f+1)*i),(f+2)*i),l=f+1;break}}return r.times=n,r.values=s,l},mergeMorphTargetTracks:function(r,t){const e=[],i={},n=r.tracks;for(let s=0;s<n.length;++s){let a=n[s];const l=ke.parseTrackName(a.name),f=ke.findNode(t,l.nodeName);if(l.propertyName!=="morphTargetInfluences"||l.propertyIndex===void 0){e.push(a);continue}if(a.createInterpolant!==a.InterpolantFactoryMethodDiscrete&&a.createInterpolant!==a.InterpolantFactoryMethodLinear){if(a.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline)throw new Error("THREE.GLTFExporter: Cannot merge tracks with glTF CUBICSPLINE interpolation.");console.warn("THREE.GLTFExporter: Morph target interpolation mode not yet supported. Using LINEAR instead."),a=a.clone(),a.setInterpolation(ZL)}const d=f.morphTargetInfluences.length,g=f.morphTargetDictionary[l.propertyIndex];if(g===void 0)throw new Error("THREE.GLTFExporter: Morph target name not found: "+l.propertyIndex);let m;if(i[f.uuid]===void 0){m=a.clone();const _=new m.ValueBufferType(d*m.times.length);for(let w=0;w<m.times.length;w++)_[w*d+g]=m.values[w];m.name=(l.nodeName||"")+".morphTargetInfluences",m.values=_,i[f.uuid]=m,e.push(m);continue}const v=a.createInterpolant(new a.ValueBufferType(1));m=i[f.uuid];for(let _=0;_<m.times.length;_++)m.values[_*d+g]=v.evaluate(m.times[_]);for(let _=0;_<a.times.length;_++){const w=this.insertKeyframe(m,a.times[_]);m.values[w*d+g]=a.values[_]}}return r.tracks=e,r},toFloat32BufferAttribute:function(r){const t=new On(new Float32Array(r.count*r.itemSize),r.itemSize,!1);if(!r.normalized&&!r.isInterleavedBufferAttribute)return t.array.set(r.array),t;for(let e=0,i=r.count;e<i;e++)for(let n=0;n<r.itemSize;n++)t.setComponent(e,n,r.getComponent(e,n));return t}};function FT(r,t=!1){const e=r[0].index!==null,i=new Set(Object.keys(r[0].attributes)),n=new Set(Object.keys(r[0].morphAttributes)),s={},a={},l=r[0].morphTargetsRelative,f=new Xo;let d=0;for(let g=0;g<r.length;++g){const m=r[g];let v=0;if(e!==(m.index!==null))return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+g+". All geometries must have compatible attributes; make sure index attribute exists among all geometries, or in none of them."),null;for(const _ in m.attributes){if(!i.has(_))return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+g+'. All geometries must have compatible attributes; make sure "'+_+'" attribute exists among all geometries, or in none of them.'),null;s[_]===void 0&&(s[_]=[]),s[_].push(m.attributes[_]),v++}if(v!==i.size)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+g+". Make sure all geometries have the same number of attributes."),null;if(l!==m.morphTargetsRelative)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+g+". .morphTargetsRelative must be consistent throughout all geometries."),null;for(const _ in m.morphAttributes){if(!n.has(_))return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+g+".  .morphAttributes must be consistent throughout all geometries."),null;a[_]===void 0&&(a[_]=[]),a[_].push(m.morphAttributes[_])}if(t){let _;if(e)_=m.index.count;else if(m.attributes.position!==void 0)_=m.attributes.position.count;else return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+g+". The geometry must have either an index or a position attribute"),null;f.addGroup(d,_,g),d+=_}}if(e){let g=0;const m=[];for(let v=0;v<r.length;++v){const _=r[v].index;for(let w=0;w<_.count;++w)m.push(_.getX(w)+g);g+=r[v].attributes.position.count}f.setIndex(m)}for(const g in s){const m=ay(s[g]);if(!m)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed while trying to merge the "+g+" attribute."),null;f.setAttribute(g,m)}for(const g in a){const m=a[g][0].length;if(m===0)break;f.morphAttributes=f.morphAttributes||{},f.morphAttributes[g]=[];for(let v=0;v<m;++v){const _=[];for(let b=0;b<a[g].length;++b)_.push(a[g][b][v]);const w=ay(_);if(!w)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed while trying to merge the "+g+" morphAttribute."),null;f.morphAttributes[g].push(w)}}return f}function ay(r){let t,e,i,n=-1,s=0;for(let d=0;d<r.length;++d){const g=r[d];if(t===void 0&&(t=g.array.constructor),t!==g.array.constructor)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.array must be of consistent array types across matching attributes."),null;if(e===void 0&&(e=g.itemSize),e!==g.itemSize)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.itemSize must be consistent across matching attributes."),null;if(i===void 0&&(i=g.normalized),i!==g.normalized)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.normalized must be consistent across matching attributes."),null;if(n===-1&&(n=g.gpuType),n!==g.gpuType)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.gpuType must be consistent across matching attributes."),null;s+=g.count*e}const a=new t(s),l=new On(a,e,i);let f=0;for(let d=0;d<r.length;++d){const g=r[d];if(g.isInterleavedBufferAttribute){const m=f/e;for(let v=0,_=g.count;v<_;v++)for(let w=0;w<e;w++){const b=g.getComponent(v,w);l.setComponent(v+m,w,b)}}else a.set(g.array,f);f+=g.count*e}return n!==void 0&&(l.gpuType=n),l}function UT(r,t,e=!0){if(!Array.isArray(r)||r.length<2)throw new Error("Invalid coordinate format. Expected [longitude, latitude].");const i=Number(r[0]),n=Number(r[1]);if(!isFinite(i)||!isFinite(n))throw new Error("Coordinate values must be finite numbers");let s;if(Array.isArray(t)&&t.length>=2)s=[Number(t[0]),Number(t[1])];else if(t&&typeof t=="object"&&t.lng!==void 0&&t.lat!==void 0)s=[Number(t.lng),Number(t.lat)];else throw new Error("Invalid reference coordinate");const a=[i,n],l=Xs(a,s)*1e3,f=fs(a,s)*Math.PI/180,d=l*Math.cos(f)*(e?-1:1),g=l*Math.sin(f);return new Ht(d,g)}function Qf(r,t){try{if(typeof r[0]=="number"){const i=[];for(let n=0;n<r.length;n+=2)i.push([r[n],r[n+1]]);r=i}return r.filter(i=>Array.isArray(i)&&i.length===2&&isFinite(i[0])&&isFinite(i[1])).length===0?null:new Wd(r.map(i=>UT(i,t)))}catch(e){return console.error("Error generating shape from coordinates:",r,e),null}}function uh(r){return typeof r=="string"?r.trim().endsWith(" m")?parseFloat(r.trim().slice(0,-2)):parseFloat(r):r}function n0(r,t){const e={depth:t,bevelEnabled:!1,curveSegments:1},i=new zo(r,e);return i.rotateX(-Math.PI/2),i.rotateY(Math.PI),i}function GT(r,t,e="flat"){let i;switch(e.toLowerCase()){case"flat":{const n={depth:t,bevelEnabled:!1,curveSegments:1};i=new zo(r,n);break}case"pyramidal":{const n=r.getPoints(20);if(n.length<3){console.warn("Not enough points for pyramidal roof");const s={depth:t,bevelEnabled:!1,curveSegments:1};i=new zo(r,s)}else{let s=new Ht(0,0);n.forEach(g=>s.add(g)),s.divideScalar(n.length);const a=[];n.forEach(g=>a.push(new Mt(g.x,g.y,0)));const l=a.length;a.push(new Mt(s.x,s.y,t));const f=[];for(let g=0;g<n.length;g++){let m=(g+1)%n.length;f.push(g,m,l)}i=new Xo;const d=new Float32Array(a.length*3);a.forEach((g,m)=>{d[m*3]=g.x,d[m*3+1]=g.y,d[m*3+2]=g.z}),i.setAttribute("position",new On(d,3)),i.setIndex(f),i.computeVertexNormals()}break}default:{console.warn("Roof type not yet supported, falling back to flat:",e);const n={depth:t,bevelEnabled:!1,curveSegments:1};i=new zo(r,n);break}}return i.rotateX(-Math.PI/2),i.rotateY(Math.PI),i}function VT(r,t){const e=r.properties,i=[];if(e["building:part"]&&e["building:part"].toLowerCase()==="yes"&&!e.building){const n=Qf(r.geometry.coordinates[0],t);if(n){const s=n0(n,1),a=new za(s,new Ba({color:10066329}));a.name="BuildingPart",i.push(a)}}return i}function qT(r,t){const e=r.properties;if(!e.building&&!e["building:part"])return null;const i=r.geometry.coordinates;let n,s;if(r.geometry.type==="Polygon")n=i[0],s=i.slice(1);else if(r.geometry.type==="MultiPolygon")n=i[0][0],s=i[0].slice(1);else return console.warn("Unsupported geometry type:",r.geometry.type),null;const a=Qf(n,t);if(!a)return null;if(a.holes=s.map(N=>Qf(N,t)).filter(Boolean),e["building:shape"]&&e["building:shape"].toLowerCase()==="sphere"){const N=a.getPoints();let k=new gT;N.forEach(W=>k.expandByPoint(W));const C=new Ht;k.getCenter(C);const A=uh(e.min_height||"0");let P=uh(e["building:height"]||e.height||"");(!P||isNaN(P)||P===0)&&(P=e["building:levels"]?parseFloat(e["building:levels"])*4:4);const U=(P-A)/2,I=k.getSize(new Ht),O=Math.max(I.x,I.y)/2,B=Math.max(U,O),V=new $d(B,16,16);V.rotateX(-Math.PI/2),V.rotateY(Math.PI),V.translate(-C.x,A+B,C.y);const z=new za(V,new Ba({color:10066329}));return z.name="BuildingSphere",z}const l=!!e["building:part"],f=l?2:4;let d=uh(e["building:height"]||e.height||"");(!d||isNaN(d)||d===0)&&(d=e["building:levels"]?parseFloat(e["building:levels"])*(l?2:4):f);let g=uh(e["roof:height"]||"");isNaN(g)&&(g=0);const m=d>g?d-g:d,v=n0(a,m),_=new za(v,new Ba({color:10066329}));_.name="BuildingWalls";let w=null;if(g>0){const N=e["roof:shape"]||"flat",k=GT(a,g,N);k&&(k.translate(0,m,0),w=new za(k,new Ba({color:10066329})),w.name="BuildingRoof")}const b=new Xv;return b.add(_),w&&b.add(w),VT(r,t).forEach(N=>b.add(N)),b}function uy(r){if(!r||r.length<3)return null;const t=r[0],e=r[r.length-1];return t[0]!==e[0]||t[1]!==e[1]?[...r,t]:r}function ZT(r,t){if(!r.geometry||!t.length)return!1;const e=uy(r.geometry.coordinates[0]);if(!e)return!1;const i=$t([e]);for(const n of t){if(!n.geometry)continue;const s=uy(n.geometry.coordinates[0]);if(!s)continue;const a=$t([s]);if(n_(i,a))return!0}return!1}function HT(r,t){const e=[],i=[];for(const f of r.features){const d=f.properties;d.building&&!d["building:part"]?e.push(f):d["building:part"]&&i.push(f)}const a=[...e.filter(f=>!ZT(f,i)),...i].map(f=>qT(f,t)).filter(Boolean),l=new Xv;return a.forEach(f=>l.add(f)),l}function YT(r,t){const e=HT(r,t),i=[];return e.traverse(n=>{if(n.isMesh){n.updateMatrix();let s=n.geometry.clone().applyMatrix4(n.matrix);if(s.index!==null&&(s=s.toNonIndexed()),!s.attributes.uv){const a=s.attributes.position.count,l=new Float32Array(a*2);s.setAttribute("uv",new On(l,2))}i.push(s)}}),i.length>0?FT(i,!0):null}async function XT(r,t,e,i){if(!r){console.error("fetchData: latlngs is undefined or null.");return}if(r.center&&r.radius){if(!r.center.lat||!r.center.lng){console.error("fetchData: latlngs.center is missing lat or lng.");return}}else if(!Array.isArray(r)||r.length===0){console.error("fetchData: latlngs is not a valid polygon array.");return}let n,s;if(r.center&&r.radius){const a=r.center,l=r.radius/111320,f=r.radius/(111320*Math.cos(a.lat*Math.PI/180));n={lat:a.lat-l,lng:a.lng-f},s={lat:a.lat+l,lng:a.lng+f}}else{const a=L.latLngBounds(r);n=a.getSouthWest(),s=a.getNorthEast()}e(n),i(s);try{const a="https://overpass-api.de/api/interpreter",l=`
    [out:json];
    (

    way["building"](${n.lat},${n.lng},${s.lat},${s.lng});
    relation["building"](${n.lat},${n.lng},${s.lat},${s.lng});
    
    way["building:part"](${n.lat},${n.lng},${s.lat},${s.lng});
    relation["building:part"](${n.lat},${n.lng},${s.lat},${s.lng});
    
    way["roof:shape"](${n.lat},${n.lng},${s.lat},${s.lng});
    relation["roof:shape"](${n.lat},${n.lng},${s.lat},${s.lng});
    way["roof:height"](${n.lat},${n.lng},${s.lat},${s.lng});
    relation["roof:height"](${n.lat},${n.lng},${s.lat},${s.lng});
    way["roof:colour"](${n.lat},${n.lng},${s.lat},${s.lng});
    relation["roof:colour"](${n.lat},${n.lng},${s.lat},${s.lng});

    );
    out body;
    >;
    out skel qt;
  `,f=await fetch(a,{method:"POST",body:l,headers:{"Content-Type":"application/x-www-form-urlencoded"}});if(!f.ok)return;const d=await f.json(),g=ox(d);t.set(g)}catch(a){console.error("Error fetching data:",a)}}function WT(r,t,e){let i;if(t.subscribe(s=>{i=s})(),!i||!r)return;let n;try{if(r.center&&r.radius){const l=[r.center.lng,r.center.lat],f=r.radius/1e3;n=ml(l,f,{steps:64})}else{const l=[...r];r.length>0&&(r[0].lat!==r[r.length-1].lat||r[0].lng!==r[r.length-1].lng)&&l.push(r[0]),n=$t([l.map(f=>[f.lng,f.lat])])}const s=i.features.map(l=>{const f=l.geometry;if(!f||!f.coordinates||f.type!=="Polygon"&&f.type!=="MultiPolygon")return null;const d=pd(f.type,f.coordinates),g=Yt([Qe(d),n]);try{const m=Ya(g);if(m&&m.geometry)return{...l,geometry:m.geometry}}catch(m){console.warn("Error clipping feature:",l,"Error:",m)}return null}).filter(Boolean);if(s.length===0)return;const a={type:"FeatureCollection",features:s};e.set(a)}catch(s){console.error("Error during clipping:",s)}}async function $T({clippedGeoJSON:r,latlngs:t,southWest:e,northEast:i,selectedLayer:n,referencePoint:s}){if(r)try{const a=new K1;a.file("buildings.geojson",JSON.stringify(r,null,2));const l=await JT(t,e,i,n);if(l){const _=await new Promise(w=>l.toBlob(w,"image/png"));a.file("map.png",_)}const d={bbox:[e.lng,e.lat,i.lng,i.lat],clipPath:t,referencePoint:s};a.file("config.json",JSON.stringify(d,null,2));try{const _=new $f,w=YT(r,s);if(w){const k=new Ba({color:10066329}),C=new za(w,k);C.name="Buildings",_.add(C)}const b=jT(t,s);b&&_.add(b);const S=new Zh,N=await new Promise((k,C)=>{S.parse(_,A=>k(new Blob([JSON.stringify(A)],{type:"application/json"})),C)});a.file("scene.gltf",N)}catch(_){console.error("Error generating 3D model:",_)}const g=await a.generateAsync({type:"blob"}),m=URL.createObjectURL(g),v=document.createElement("a");v.href=m,v.download="vantage-scene-setup.zip",v.click(),URL.revokeObjectURL(m)}catch(a){console.error("Error during download:",a)}}async function JT(r,t,e,i){if(!r||!i)return null;const n=256,s=17,a=(B,V,z)=>{const W=2**z,T=Math.floor((V+180)/360*W),$=Math.floor((1-Math.log(Math.tan(B*Math.PI/180)+1/Math.cos(B*Math.PI/180))/Math.PI)/2*W);return{x:T,y:$}},l=a(t.lat,t.lng,s),f=a(e.lat,e.lng,s),d={x:Math.min(l.x,f.x),y:Math.min(l.y,f.y)},g={x:Math.max(l.x,f.x),y:Math.max(l.y,f.y)},m=g.x-d.x+1,v=g.y-d.y+1,_=document.createElement("canvas"),w=_.getContext("2d");_.width=m*n,_.height=v*n;const b=[];for(let B=d.x;B<=g.x;B++)for(let V=d.y;V<=g.y;V++){const z=i.value.replace("{z}",s).replace("{x}",B).replace("{y}",V);b.push({url:z,x:B-d.x,y:V-d.y})}(await Promise.all(b.map(B=>fetch(B.url).then(V=>{if(!V.ok)throw new Error(`Failed to fetch tile: ${B.url}`);return V.blob()}).then(V=>createImageBitmap(V)).then(V=>({img:V,x:B.x,y:B.y}))))).forEach(({img:B,x:V,y:z})=>{const W=V*n,T=z*n;w.drawImage(B,W,T,n,n)});const N=(B,V,z)=>{const W=2**z*n,T=(V+180)/360*W,$=(1-Math.log(Math.tan(B*Math.PI/180)+1/Math.cos(B*Math.PI/180))/Math.PI)/2*W;return{x:T,y:$}},k=N(e.lat,t.lng,s),C=N(t.lat,e.lng,s),A=k.x-d.x*n,P=k.y-d.y*n,q=C.x-k.x,U=C.y-k.y,I=document.createElement("canvas");return I.width=q,I.height=U,I.getContext("2d").drawImage(_,A,P,q,U,0,0,q,U),I}function ly(r,t,e=!0){if(!Array.isArray(r)||r.length!==2)throw new Error("Invalid coordinate format. Expected [longitude, latitude].");const i=Xs(r,t)*1e3,n=fs(r,t)*Math.PI/180,s=i*Math.cos(n)*(e?-1:1),a=i*Math.sin(n);return new Ht(s,a)}function jT(r,t){if(!r)return null;let e;if(r.center&&r.radius){const d=[r.center.lng,r.center.lat],g=r.radius;e=ml(d,g/1e3,{steps:64}).geometry.coordinates[0].map(v=>ly(v,t))}else if(Array.isArray(r))e=r.map(d=>{const g=[d.lng,d.lat];return ly(g,t)});else return console.error("Invalid latlngs format"),null;if(!e.length)return null;const i=new Wd(e.map(d=>new Ht(d.x,d.y))),s={depth:2,bevelEnabled:!1},a=new zo(i,s);a.rotateX(-Math.PI/2),a.rotateY(Math.PI/2),a.translate(0,-2,0);const l=new Ba({color:14540253,side:Dv}),f=new za(a,l);return f.name="Ground",f}var KT=to('<button>Copy Reference Point</button> <label>Set Reference Point:</label> <input type="text" placeholder="Enter lat, lon"> <button>Set</button>',1);function QT(r,t){ll(t,!1);const[e,i]=dd(),n=()=>Bu(Wu,"$clippedGeoJSON",e),s=()=>Bu(Uu,"$referencePoint",e);let a=rs("");function l(){if(s()){const v=`${s()[1]}, ${s()[0]}`;navigator.clipboard.writeText(v).then(()=>{alert("Reference point copied to clipboard!")}).catch(_=>console.error("Failed to copy",_))}}function f(){const v=Vt(a).split(",").map(_=>parseFloat(_.trim()));v.length===2&&!isNaN(v[0])&&!isNaN(v[1])&&Mf(Uu,[v[1],v[0]])}Ma(()=>(n(),OL),()=>{n()&&Mf(Uu,Dr(n()).geometry.coordinates)}),ad(),jh();var d=x1(),g=gf(d);{var m=v=>{var _=KT(),w=gf(_),b=ti(w,4),S=ti(b,2);Do("click",w,l),Ef(b,()=>Vt(a),N=>Oe(a,N)),Do("click",S,f),as(v,_)};bf(g,v=>{n()&&v(m)})}as(r,d),hl(),i()}var tP=to('<p class="svelte-2cdl2a">Draw a shape on the map.</p>'),eP=to('<p class="svelte-2cdl2a">The selected area is too large. Please reduce the area.</p>'),nP=to('<div class="svelte-2cdl2a"><!> <!> <button class="svelte-2cdl2a">Fetch Data</button> <button class="svelte-2cdl2a">Clip Data</button> <button class="svelte-2cdl2a">Download Data</button> <hr> <!></div>');function iP(r,t){ll(t,!1);const[e,i]=dd(),n=()=>Bu(Wu,"$clippedGeoJSON",e),s=()=>Bu(Uu,"$referencePoint",e),a=()=>Bu(hh,"$osmGeoJSON",e);let l=Fu(t,"area",8),f=Fu(t,"latlngs",8),d=Fu(t,"selectedLayer",8),g,m,v=rs(!1);function _(V){g=V}function w(V){m=V}function b(){XT(f(),hh,_,w)}function S(){WT(f(),hh,Wu)}async function N(){await $T({clippedGeoJSON:n(),latlngs:f(),southWest:g,northEast:m,selectedLayer:d(),referencePoint:s()})}Ma(()=>cd(l()),()=>{Oe(v,l()&&l()<=8e6)}),ad(),jh();var k=nP(),C=Hu(k);{var A=V=>{var z=tP();as(V,z)};bf(C,V=>{l()||V(A)})}var P=ti(C,2);{var q=V=>{var z=eP();as(V,z)};bf(P,V=>{l()&&!Vt(v)&&V(q)})}var U=ti(P,2),I=ti(U,2),O=ti(I,2),B=ti(O,4);QT(B,{}),Ty(()=>{U.disabled=!l(),I.disabled=!a(),O.disabled=!n()}),Do("click",U,b),Do("click",I,S),Do("click",O,N),as(r,k),hl(),i()}var rP=to("<div><h1>Vantage Scene Setup</h1> <p>Export the relevant data to setup Vantage.</p> <!> <!> <!></div>");function sP(r){const[t,e]=dd();let i=rs(null),n=rs(),s=rs([]);const a=_=>{Oe(n,_.detail.layer)},l=_=>{const w=_.detail.layer;if(w instanceof L.Circle){const b=w.getLatLng(),S=w.getRadius();Oe(i,Math.PI*Math.pow(S,2)),Oe(s,{center:b,radius:S})}else Oe(i,L.GeometryUtil.geodesicArea(w._latlngs[0])),Oe(s,w._latlngs[0])},f=_=>{Oe(i,_.detail.area),Oe(s,_.detail.latlngs),Mf(Wu,Vt(s))};var d=rP(),g=ti(Hu(d),4);V1(g,{get selectedLayer(){return Vt(n)},set selectedLayer(_){Oe(n,_)},$$events:{change:a},$$legacy:!0});var m=ti(g,2);$1(m,{get selectedLayer(){return Vt(n)},$$events:{shapeDrawn:l,shapeEdited:f}});var v=ti(m,2);iP(v,{get area(){return Vt(i)},get latlngs(){return Vt(s)},get selectedLayer(){return Vt(n)}}),as(r,d),e()}b1(sP,{target:document.getElementById("app")});
