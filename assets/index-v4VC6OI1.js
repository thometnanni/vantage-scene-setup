var Sf=Object.defineProperty;var kf=(h,t,e)=>t in h?Sf(h,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):h[t]=e;var zt=(h,t,e)=>kf(h,typeof t!="symbol"?t+"":t,e);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function e(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=e(i);fetch(i.href,s)}})();const Wl=!1;var Ca=Array.isArray,Af=Array.prototype.indexOf,sl=Array.from,Pf=Object.defineProperty,Yr=Object.getOwnPropertyDescriptor,Cf=Object.getOwnPropertyDescriptors,zf=Object.prototype,If=Array.prototype,oc=Object.getPrototypeOf;const jr=()=>{};function Of(h){return h()}function Nh(h){for(var t=0;t<h.length;t++)h[t]()}const Pi=2,ac=4,Qs=8,ol=16,Ci=32,to=64,Fh=128,hr=256,ga=512,Ye=1024,In=2048,eo=4096,Ui=8192,ts=16384,Rf=32768,al=65536,Df=1<<17,Bf=1<<19,hc=1<<20,nr=Symbol("$state"),Nf=Symbol("legacy props");function lc(h){return h===this.v}function uc(h,t){return h!=h?t==t:h!==t||h!==null&&typeof h=="object"||typeof h=="function"}function hl(h){return!uc(h,this.v)}function Ff(h){throw new Error("https://svelte.dev/e/effect_in_teardown")}function Uf(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function Zf(h){throw new Error("https://svelte.dev/e/effect_orphan")}function Gf(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function Hf(h){throw new Error("https://svelte.dev/e/props_invalid_value")}function Wf(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function Vf(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function qf(){throw new Error("https://svelte.dev/e/state_unsafe_local_read")}function Yf(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}let es=!1,jf=!1;function Xf(){es=!0}const Jf=1,$f=2,Kf=16,Qf=1,td=2,ed=4,id=8,nd=16,rd=2,He=Symbol();function ti(h,t){var e={f:0,v:h,reactions:null,equals:lc,rv:0,wv:0};return e}function za(h,t=!1){var r;const e=ti(h);return t||(e.equals=hl),es&&ne!==null&&ne.l!==null&&((r=ne.l).s??(r.s=[])).push(e),e}function Xr(h,t=!1){return sd(za(h,t))}function sd(h){return ee!==null&&ee.f&Pi&&(Zi===null?_d([h]):Zi.push(h)),h}function le(h,t){return ee!==null&&ml()&&ee.f&(Pi|ol)&&(Zi===null||!Zi.includes(h))&&Yf(),cc(h,t)}function cc(h,t){return h.equals(t)||(h.v,h.v=t,h.wv=Ic(),fc(h,In),ml()&&Yt!==null&&Yt.f&Ye&&!(Yt.f&Ci)&&(Oe!==null&&Oe.includes(h)?(zi(Yt,In),Ra(Yt)):Pn===null?gd([h]):Pn.push(h))),t}function fc(h,t){var e=h.reactions;if(e!==null)for(var r=ml(),i=e.length,s=0;s<i;s++){var o=e[s],l=o.f;l&In||!r&&o===Yt||(zi(o,t),l&(Ye|hr)&&(l&Pi?fc(o,eo):Ra(o)))}}let od=!1;function Wr(h,t=null,e){if(typeof h!="object"||h===null||nr in h)return h;const r=oc(h);if(r!==zf&&r!==If)return h;var i=new Map,s=Ca(h),o=ti(0);s&&i.set("length",ti(h.length));var l;return new Proxy(h,{defineProperty(u,f,d){(!("value"in d)||d.configurable===!1||d.enumerable===!1||d.writable===!1)&&Wf();var p=i.get(f);return p===void 0?(p=ti(d.value),i.set(f,p)):le(p,Wr(d.value,l)),!0},deleteProperty(u,f){var d=i.get(f);if(d===void 0)f in u&&i.set(f,ti(He));else{if(s&&typeof f=="string"){var p=i.get("length"),g=Number(f);Number.isInteger(g)&&g<p.v&&le(p,g)}le(d,He),Vl(o)}return!0},get(u,f,d){var x;if(f===nr)return h;var p=i.get(f),g=f in u;if(p===void 0&&(!g||(x=Yr(u,f))!=null&&x.writable)&&(p=ti(Wr(g?u[f]:He,l)),i.set(f,p)),p!==void 0){var m=Bt(p);return m===He?void 0:m}return Reflect.get(u,f,d)},getOwnPropertyDescriptor(u,f){var d=Reflect.getOwnPropertyDescriptor(u,f);if(d&&"value"in d){var p=i.get(f);p&&(d.value=Bt(p))}else if(d===void 0){var g=i.get(f),m=g==null?void 0:g.v;if(g!==void 0&&m!==He)return{enumerable:!0,configurable:!0,value:m,writable:!0}}return d},has(u,f){var m;if(f===nr)return!0;var d=i.get(f),p=d!==void 0&&d.v!==He||Reflect.has(u,f);if(d!==void 0||Yt!==null&&(!p||(m=Yr(u,f))!=null&&m.writable)){d===void 0&&(d=ti(p?Wr(u[f],l):He),i.set(f,d));var g=Bt(d);if(g===He)return!1}return p},set(u,f,d,p){var N;var g=i.get(f),m=f in u;if(s&&f==="length")for(var x=d;x<g.v;x+=1){var y=i.get(x+"");y!==void 0?le(y,He):x in u&&(y=ti(He),i.set(x+"",y))}g===void 0?(!m||(N=Yr(u,f))!=null&&N.writable)&&(g=ti(void 0),le(g,Wr(d,l)),i.set(f,g)):(m=g.v!==He,le(g,Wr(d,l)));var b=Reflect.getOwnPropertyDescriptor(u,f);if(b!=null&&b.set&&b.set.call(p,d),!m){if(s&&typeof f=="string"){var P=i.get("length"),A=Number(f);Number.isInteger(A)&&A>=P.v&&le(P,A+1)}Vl(o)}return!0},ownKeys(u){Bt(o);var f=Reflect.ownKeys(u).filter(g=>{var m=i.get(g);return m===void 0||m.v!==He});for(var[d,p]of i)p.v!==He&&!(d in u)&&f.push(d);return f},setPrototypeOf(){Vf()}})}function Vl(h,t=1){le(h,h.v+t)}var ql,dc,pc;function ad(){if(ql===void 0){ql=window;var h=Element.prototype,t=Node.prototype;dc=Yr(t,"firstChild").get,pc=Yr(t,"nextSibling").get,h.__click=void 0,h.__className="",h.__attributes=null,h.__styles=null,h.__e=void 0,Text.prototype.__t=void 0}}function mc(h=""){return document.createTextNode(h)}function _c(h){return dc.call(h)}function ll(h){return pc.call(h)}function ya(h,t){return _c(h)}function kn(h,t=1,e=!1){let r=h;for(;t--;)r=ll(r);return r}function hd(h){h.textContent=""}function va(h){var t=Pi|In;Yt===null?t|=hr:Yt.f|=hc;var e=ee!==null&&ee.f&Pi?ee:null;const r={children:null,ctx:ne,deps:null,equals:lc,f:t,fn:h,reactions:null,rv:0,v:null,wv:0,parent:e??Yt};return e!==null&&(e.children??(e.children=[])).push(r),r}function ld(h){const t=va(h);return t.equals=hl,t}function gc(h){var t=h.children;if(t!==null){h.children=null;for(var e=0;e<t.length;e+=1){var r=t[e];r.f&Pi?ul(r):On(r)}}}function ud(h){for(var t=h.parent;t!==null;){if(!(t.f&Pi))return t;t=t.parent}return null}function yc(h){var t,e=Yt;Hi(ud(h));try{gc(h),t=Oc(h)}finally{Hi(e)}return t}function vc(h){var t=yc(h),e=(er||h.f&hr)&&h.deps!==null?eo:Ye;zi(h,e),h.equals(t)||(h.v=t,h.wv=Ic())}function ul(h){gc(h),Xs(h,0),zi(h,ts),h.v=h.children=h.deps=h.ctx=h.reactions=null}function xc(h){Yt===null&&ee===null&&Zf(),ee!==null&&ee.f&hr&&Uf(),pl&&Ff()}function cd(h,t){var e=t.last;e===null?t.last=t.first=h:(e.next=h,h.prev=e,t.last=h)}function is(h,t,e,r=!0){var i=(h&to)!==0,s=Yt,o={ctx:ne,deps:null,deriveds:null,nodes_start:null,nodes_end:null,f:h|In,first:null,fn:t,last:null,next:null,parent:i?null:s,prev:null,teardown:null,transitions:null,wv:0};if(e){var l=Jr;try{Yl(!0),io(o),o.f|=Rf}catch(d){throw On(o),d}finally{Yl(l)}}else t!==null&&Ra(o);var u=e&&o.deps===null&&o.first===null&&o.nodes_start===null&&o.teardown===null&&(o.f&hc)===0;if(!u&&!i&&r&&(s!==null&&cd(o,s),ee!==null&&ee.f&Pi)){var f=ee;(f.children??(f.children=[])).push(o)}return o}function wc(h){const t=is(Qs,null,!1);return zi(t,Ye),t.teardown=h,t}function Uh(h){xc();var t=Yt!==null&&(Yt.f&Ci)!==0&&ne!==null&&!ne.m;if(t){var e=ne;(e.e??(e.e=[])).push({fn:h,effect:Yt,reaction:ee})}else{var r=cl(h);return r}}function fd(h){return xc(),Ia(h)}function dd(h){const t=is(to,h,!0);return(e={})=>new Promise(r=>{e.outro?xa(t,()=>{On(t),r(void 0)}):(On(t),r(void 0))})}function cl(h){return is(ac,h,!1)}function ca(h,t){var e=ne,r={effect:null,ran:!1};e.l.r1.push(r),r.effect=Ia(()=>{h(),!r.ran&&(r.ran=!0,le(e.l.r2,!0),sr(t))})}function bc(){var h=ne;Ia(()=>{if(Bt(h.l.r2)){for(var t of h.l.r1){var e=t.effect;e.f&Ye&&zi(e,eo),ns(e)&&io(e),t.ran=!1}h.l.r2.v=!1}})}function Ia(h){return is(Qs,h,!0)}function Lc(h){return fl(h)}function fl(h,t=0){return is(Qs|ol|t,h,!0)}function js(h,t=!0){return is(Qs|Ci,h,!0,t)}function Mc(h){var t=h.teardown;if(t!==null){const e=pl,r=ee;jl(!0),Rn(null);try{t.call(null)}finally{jl(e),Rn(r)}}}function Ec(h){var t=h.deriveds;if(t!==null){h.deriveds=null;for(var e=0;e<t.length;e+=1)ul(t[e])}}function Tc(h,t=!1){var e=h.first;for(h.first=h.last=null;e!==null;){var r=e.next;On(e,t),e=r}}function pd(h){for(var t=h.first;t!==null;){var e=t.next;t.f&Ci||On(t),t=e}}function On(h,t=!0){var e=!1;if((t||h.f&Bf)&&h.nodes_start!==null){for(var r=h.nodes_start,i=h.nodes_end;r!==null;){var s=r===i?null:ll(r);r.remove(),r=s}e=!0}Tc(h,t&&!e),Ec(h),Xs(h,0),zi(h,ts);var o=h.transitions;if(o!==null)for(const u of o)u.stop();Mc(h);var l=h.parent;l!==null&&l.first!==null&&Sc(h),h.next=h.prev=h.teardown=h.ctx=h.deps=h.fn=h.nodes_start=h.nodes_end=null}function Sc(h){var t=h.parent,e=h.prev,r=h.next;e!==null&&(e.next=r),r!==null&&(r.prev=e),t!==null&&(t.first===h&&(t.first=r),t.last===h&&(t.last=e))}function xa(h,t){var e=[];dl(h,e,!0),kc(e,()=>{On(h),t&&t()})}function kc(h,t){var e=h.length;if(e>0){var r=()=>--e||t();for(var i of h)i.out(r)}else t()}function dl(h,t,e){if(!(h.f&Ui)){if(h.f^=Ui,h.transitions!==null)for(const o of h.transitions)(o.is_global||e)&&t.push(o);for(var r=h.first;r!==null;){var i=r.next,s=(r.f&al)!==0||(r.f&Ci)!==0;dl(r,t,s?e:!1),r=i}}}function wa(h){Ac(h,!0)}function Ac(h,t){if(h.f&Ui){ns(h)&&io(h),h.f^=Ui;for(var e=h.first;e!==null;){var r=e.next,i=(e.f&al)!==0||(e.f&Ci)!==0;Ac(e,i?t:!1),e=r}if(h.transitions!==null)for(const s of h.transitions)(s.is_global||t)&&s.in()}}let Zh=!1,Gh=[];function md(){Zh=!1;const h=Gh.slice();Gh=[],Nh(h)}function Pc(h){Zh||(Zh=!0,queueMicrotask(md)),Gh.push(h)}function Cc(h){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}let fa=!1,ba=!1,La=null,Jr=!1,pl=!1;function Yl(h){Jr=h}function jl(h){pl=h}let Hh=[],Hs=0;let ee=null;function Rn(h){ee=h}let Yt=null;function Hi(h){Yt=h}let Zi=null;function _d(h){Zi=h}let Oe=null,Qe=0,Pn=null;function gd(h){Pn=h}let zc=1,Ma=0,er=!1,ne=null;function Ic(){return++zc}function ml(){return!es||ne!==null&&ne.l===null}function ns(h){var f;var t=h.f;if(t&In)return!0;if(t&eo){var e=h.deps,r=(t&hr)!==0;if(e!==null){var i,s,o=(t&ga)!==0,l=r&&Yt!==null&&!er,u=e.length;if(o||l){for(i=0;i<u;i++)s=e[i],(o||!((f=s==null?void 0:s.reactions)!=null&&f.includes(h)))&&(s.reactions??(s.reactions=[])).push(h);o&&(h.f^=ga)}for(i=0;i<u;i++)if(s=e[i],ns(s)&&vc(s),s.wv>h.wv)return!0}(!r||Yt!==null&&!er)&&zi(h,Ye)}return!1}function yd(h,t){for(var e=t;e!==null;){if(e.f&Fh)try{e.fn(h);return}catch{e.f^=Fh}e=e.parent}throw fa=!1,h}function vd(h){return(h.f&ts)===0&&(h.parent===null||(h.parent.f&Fh)===0)}function Oa(h,t,e,r){if(fa){if(e===null&&(fa=!1),vd(t))throw h;return}e!==null&&(fa=!0);{yd(h,t);return}}function Oc(h){var g;var t=Oe,e=Qe,r=Pn,i=ee,s=er,o=Zi,l=ne,u=h.f;Oe=null,Qe=0,Pn=null,ee=u&(Ci|to)?null:h,er=!Jr&&(u&hr)!==0,Zi=null,ne=h.ctx,Ma++;try{var f=(0,h.fn)(),d=h.deps;if(Oe!==null){var p;if(Xs(h,Qe),d!==null&&Qe>0)for(d.length=Qe+Oe.length,p=0;p<Oe.length;p++)d[Qe+p]=Oe[p];else h.deps=d=Oe;if(!er)for(p=Qe;p<d.length;p++)((g=d[p]).reactions??(g.reactions=[])).push(h)}else d!==null&&Qe<d.length&&(Xs(h,Qe),d.length=Qe);return i!==null&&Ma++,f}finally{Oe=t,Qe=e,Pn=r,ee=i,er=s,Zi=o,ne=l}}function xd(h,t){let e=t.reactions;if(e!==null){var r=Af.call(e,h);if(r!==-1){var i=e.length-1;i===0?e=t.reactions=null:(e[r]=e[i],e.pop())}}e===null&&t.f&Pi&&(Oe===null||!Oe.includes(t))&&(zi(t,eo),t.f&(hr|ga)||(t.f^=ga),Xs(t,0))}function Xs(h,t){var e=h.deps;if(e!==null)for(var r=t;r<e.length;r++)xd(h,e[r])}function io(h){var t=h.f;if(!(t&ts)){zi(h,Ye);var e=Yt,r=ne;Yt=h;try{t&ol?pd(h):Tc(h),Ec(h),Mc(h);var i=Oc(h);h.teardown=typeof i=="function"?i:null,h.wv=zc;var s=h.deps,o;Wl&&jf&&h.f&In}catch(l){Oa(l,h,e,r||h.ctx)}finally{Yt=e}}}function wd(){if(Hs>1e3){Hs=0;try{Gf()}catch(h){if(La!==null)Oa(h,La,null);else throw h}}Hs++}function bd(h){var t=h.length;if(t!==0){wd();var e=Jr;Jr=!0;try{for(var r=0;r<t;r++){var i=h[r];i.f&Ye||(i.f^=Ye);var s=[];Rc(i,s),Ld(s)}}finally{Jr=e}}}function Ld(h){var t=h.length;if(t!==0)for(var e=0;e<t;e++){var r=h[e];if(!(r.f&(ts|Ui)))try{ns(r)&&(io(r),r.deps===null&&r.first===null&&r.nodes_start===null&&(r.teardown===null?Sc(r):r.fn=null))}catch(i){Oa(i,r,null,r.ctx)}}}function Md(){if(ba=!1,Hs>1001)return;const h=Hh;Hh=[],bd(h),ba||(Hs=0,La=null)}function Ra(h){ba||(ba=!0,queueMicrotask(Md)),La=h;for(var t=h;t.parent!==null;){t=t.parent;var e=t.f;if(e&(to|Ci)){if(!(e&Ye))return;t.f^=Ye}}Hh.push(t)}function Rc(h,t){var e=h.first,r=[];t:for(;e!==null;){var i=e.f,s=(i&Ci)!==0,o=s&&(i&Ye)!==0,l=e.next;if(!o&&!(i&Ui))if(i&Qs){if(s)e.f^=Ye;else try{ns(e)&&io(e)}catch(p){Oa(p,e,null,e.ctx)}var u=e.first;if(u!==null){e=u;continue}}else i&ac&&r.push(e);if(l===null){let p=e.parent;for(;p!==null;){if(h===p)break t;var f=p.next;if(f!==null){e=f;continue t}p=p.parent}}e=l}for(var d=0;d<r.length;d++)u=r[d],t.push(u),Rc(u,t)}function Bt(h){var d;var t=h.f,e=(t&Pi)!==0;if(e&&t&ts){var r=yc(h);return ul(h),r}if(ee!==null){Zi!==null&&Zi.includes(h)&&qf();var i=ee.deps;h.rv<Ma&&(h.rv=Ma,Oe===null&&i!==null&&i[Qe]===h?Qe++:Oe===null?Oe=[h]:Oe.push(h),Pn!==null&&Yt!==null&&Yt.f&Ye&&!(Yt.f&Ci)&&Pn.includes(h)&&(zi(Yt,In),Ra(Yt)))}else if(e&&h.deps===null)for(var s=h,o=s.parent,l=s;o!==null;)if(o.f&Pi){var u=o;l=u,o=u.parent}else{var f=o;(d=f.deriveds)!=null&&d.includes(l)||(f.deriveds??(f.deriveds=[])).push(l);break}return e&&(s=h,ns(s)&&vc(s)),h.v}function sr(h){const t=ee;try{return ee=null,h()}finally{ee=t}}const Ed=-7169;function zi(h,t){h.f=h.f&Ed|t}function Da(h,t=!1,e){ne={p:ne,c:null,e:null,m:!1,s:h,x:null,l:null},es&&!t&&(ne.l={s:null,u:null,r1:[],r2:ti(!1)})}function Ba(h){const t=ne;if(t!==null){const o=t.e;if(o!==null){var e=Yt,r=ee;t.e=null;try{for(var i=0;i<o.length;i++){var s=o[i];Hi(s.effect),Rn(s.reaction),cl(s.fn)}}finally{Hi(e),Rn(r)}}ne=t.p,t.m=!0}return{}}function _l(h){if(!(typeof h!="object"||!h||h instanceof EventTarget)){if(nr in h)Wh(h);else if(!Array.isArray(h))for(let t in h){const e=h[t];typeof e=="object"&&e&&nr in e&&Wh(e)}}}function Wh(h,t=new Set){if(typeof h=="object"&&h!==null&&!(h instanceof EventTarget)&&!t.has(h)){t.add(h),h instanceof Date&&h.getTime();for(let r in h)try{Wh(h[r],t)}catch{}const e=oc(h);if(e!==Object.prototype&&e!==Array.prototype&&e!==Map.prototype&&e!==Set.prototype&&e!==Date.prototype){const r=Cf(e);for(let i in r){const s=r[i].get;if(s)try{s.call(h)}catch{}}}}}const Td=["touchstart","touchmove"];function Sd(h){return Td.includes(h)}function kd(h){var t=ee,e=Yt;Rn(null),Hi(null);try{return h()}finally{Rn(t),Hi(e)}}const Ad=new Set,Xl=new Set;function Pd(h,t,e,r){function i(s){if(r.capture||Ds.call(t,s),!s.cancelBubble)return kd(()=>e.call(this,s))}return h.startsWith("pointer")||h.startsWith("touch")||h==="wheel"?Pc(()=>{t.addEventListener(h,i,r)}):t.addEventListener(h,i,r),i}function da(h,t,e,r,i){var s={capture:r,passive:i},o=Pd(h,t,e,s);(t===document.body||t===window||t===document)&&wc(()=>{t.removeEventListener(h,o,s)})}function Ds(h){var A;var t=this,e=t.ownerDocument,r=h.type,i=((A=h.composedPath)==null?void 0:A.call(h))||[],s=i[0]||h.target,o=0,l=h.__root;if(l){var u=i.indexOf(l);if(u!==-1&&(t===document||t===window)){h.__root=t;return}var f=i.indexOf(t);if(f===-1)return;u<=f&&(o=u)}if(s=i[o]||h.target,s!==t){Pf(h,"currentTarget",{configurable:!0,get(){return s||e}});var d=ee,p=Yt;Rn(null),Hi(null);try{for(var g,m=[];s!==null;){var x=s.assignedSlot||s.parentNode||s.host||null;try{var y=s["__"+r];if(y!==void 0&&!s.disabled)if(Ca(y)){var[b,...P]=y;b.apply(s,[h,...P])}else y.call(s,h)}catch(N){g?m.push(N):g=N}if(h.cancelBubble||x===t||x===null)break;s=x}if(g){for(let N of m)queueMicrotask(()=>{throw N});throw g}}finally{h.__root=t,delete h.currentTarget,Rn(d),Hi(p)}}}function Cd(h){var t=document.createElement("template");return t.innerHTML=h,t.content}function zd(h,t){var e=Yt;e.nodes_start===null&&(e.nodes_start=h,e.nodes_end=t)}function lr(h,t){var e=(t&rd)!==0,r,i=!h.startsWith("<!>");return()=>{r===void 0&&(r=Cd(i?h:"<!>"+h),r=_c(r));var s=e?document.importNode(r,!0):r.cloneNode(!0);return zd(s,s),s}}function rr(h,t){h!==null&&h.before(t)}function Id(h,t){var e=t==null?"":typeof t=="object"?t+"":t;e!==(h.__t??(h.__t=h.nodeValue))&&(h.__t=e,h.nodeValue=e==null?"":e+"")}function Od(h,t){return Rd(h,t)}const Cr=new Map;function Rd(h,{target:t,anchor:e,props:r={},events:i,context:s,intro:o=!0}){ad();var l=new Set,u=p=>{for(var g=0;g<p.length;g++){var m=p[g];if(!l.has(m)){l.add(m);var x=Sd(m);t.addEventListener(m,Ds,{passive:x});var y=Cr.get(m);y===void 0?(document.addEventListener(m,Ds,{passive:x}),Cr.set(m,1)):Cr.set(m,y+1)}}};u(sl(Ad)),Xl.add(u);var f=void 0,d=dd(()=>{var p=e??t.appendChild(mc());return js(()=>{if(s){Da({});var g=ne;g.c=s}i&&(r.$$events=i),f=h(p,r)||{},s&&Ba()}),()=>{var x;for(var g of l){t.removeEventListener(g,Ds);var m=Cr.get(g);--m===0?(document.removeEventListener(g,Ds),Cr.delete(g)):Cr.set(g,m)}Xl.delete(u),p!==e&&((x=p.parentNode)==null||x.removeChild(p))}});return Dd.set(f,d),f}let Dd=new WeakMap;function Jl(h,t,e=!1){var r=h,i=null,s=null,o=He,l=e?al:0,u=!1;const f=(p,g=!0)=>{u=!0,d(g,p)},d=(p,g)=>{o!==(o=p)&&(o?(i?wa(i):g&&(i=js(()=>g(r))),s&&xa(s,()=>{s=null})):(s?wa(s):g&&(s=js(()=>g(r))),i&&xa(i,()=>{i=null})))};fl(()=>{u=!1,t(f),u||d(null,null)},l)}function Bd(h,t){return t}function Nd(h,t,e,r){for(var i=[],s=t.length,o=0;o<s;o++)dl(t[o].e,i,!0);var l=s>0&&i.length===0&&e!==null;if(l){var u=e.parentNode;hd(u),u.append(e),r.clear(),Sn(h,t[0].prev,t[s-1].next)}kc(i,()=>{for(var f=0;f<s;f++){var d=t[f];l||(r.delete(d.k),Sn(h,d.prev,d.next)),On(d.e,!l)}})}function Fd(h,t,e,r,i,s=null){var o=h,l={flags:t,items:new Map,first:null};{var u=h;o=u.appendChild(mc())}var f=null,d=!1;fl(()=>{var p=e(),g=Ca(p)?p:p==null?[]:sl(p),m=g.length;if(!(d&&m===0)){d=m===0;{var x=ee;Ud(g,l,o,i,t,(x.f&Ui)!==0,r)}s!==null&&(m===0?f?wa(f):f=js(()=>s(o)):f!==null&&xa(f,()=>{f=null}))}})}function Ud(h,t,e,r,i,s,o,l){var u=h.length,f=t.items,d=t.first,p=d,g,m=null,x=[],y=[],b,P,A,N;for(N=0;N<u;N+=1){if(b=h[N],P=o(b,N),A=f.get(P),A===void 0){var G=p?p.e.nodes_start:e;m=Gd(G,t,m,m===null?t.first:m.next,b,P,N,r,i),f.set(P,m),x=[],y=[],p=m.next;continue}if(Zd(A,b,N),A.e.f&Ui&&wa(A.e),A!==p){if(g!==void 0&&g.has(A)){if(x.length<y.length){var z=y[0],K;m=z.prev;var q=x[0],T=x[x.length-1];for(K=0;K<x.length;K+=1)$l(x[K],z,e);for(K=0;K<y.length;K+=1)g.delete(y[K]);Sn(t,q.prev,T.next),Sn(t,m,q),Sn(t,T,z),p=z,m=T,N-=1,x=[],y=[]}else g.delete(A),$l(A,p,e),Sn(t,A.prev,A.next),Sn(t,A,m===null?t.first:m.next),Sn(t,m,A),m=A;continue}for(x=[],y=[];p!==null&&p.k!==P;)(s||!(p.e.f&Ui))&&(g??(g=new Set)).add(p),y.push(p),p=p.next;if(p===null)continue;A=p}x.push(A),m=A,p=A.next}if(p!==null||g!==void 0){for(var k=g===void 0?[]:sl(g);p!==null;)(s||!(p.e.f&Ui))&&k.push(p),p=p.next;var I=k.length;if(I>0){var F=u===0?e:null;Nd(t,k,F,f)}}Yt.first=t.first&&t.first.e,Yt.last=m&&m.e}function Zd(h,t,e,r){cc(h.v,t),h.i=e}function Gd(h,t,e,r,i,s,o,l,u,f){var d=(u&Jf)!==0,p=(u&Kf)===0,g=d?p?za(i):ti(i):i,m=u&$f?ti(o):o,x={i:m,v:g,k:s,a:null,e:null,prev:e,next:r};try{return x.e=js(()=>l(h,g,m),od),x.e.prev=e&&e.e,x.e.next=r&&r.e,e===null?t.first=x:(e.next=x,e.e.next=x.e),r!==null&&(r.prev=x,r.e.prev=x.e),x}finally{}}function $l(h,t,e){for(var r=h.next?h.next.e.nodes_start:e,i=t?t.e.nodes_start:e,s=h.e.nodes_start;s!==r;){var o=ll(s);i.before(s),s=o}}function Sn(h,t,e){t===null?h.first=e:(t.next=e,t.e.next=e&&e.e),e!==null&&(e.prev=t,e.e.prev=t&&t.e)}function Hd(h,t){t?h.hasAttribute("selected")||h.setAttribute("selected",""):h.removeAttribute("selected")}function Kl(h,t){return h===t||(h==null?void 0:h[nr])===t}function Wd(h={},t,e,r){return cl(()=>{var i,s;return Ia(()=>{i=s,s=[],sr(()=>{h!==e(...s)&&(t(h,...s),i&&Kl(e(...i),h)&&t(null,...i))})}),()=>{Pc(()=>{s&&Kl(e(...s),h)&&t(null,...s)})}}),h}function gl(h=!1){const t=ne,e=t.l.u;if(!e)return;let r=()=>_l(t.s);if(h){let i=0,s={};const o=va(()=>{let l=!1;const u=t.s;for(const f in u)u[f]!==s[f]&&(s[f]=u[f],l=!0);return l&&i++,i});r=()=>Bt(o)}e.b.length&&fd(()=>{Ql(t,r),Nh(e.b)}),Uh(()=>{const i=sr(()=>e.m.map(Of));return()=>{for(const s of i)typeof s=="function"&&s()}}),e.a.length&&Uh(()=>{Ql(t,r),Nh(e.a)})}function Ql(h,t){if(h.l.s)for(const e of h.l.s)Bt(e);t()}function Vd(h){var t=ti(0);return function(){return arguments.length===1?(le(t,Bt(t)+1),arguments[0]):(Bt(t),h())}}function qd(h,t,e){if(h==null)return t(void 0),jr;const r=sr(()=>h.subscribe(t,e));return r.unsubscribe?()=>r.unsubscribe():r}let Zo=!1;function tu(h,t,e){const r=e[t]??(e[t]={store:null,source:za(void 0),unsubscribe:jr});if(r.store!==h)if(r.unsubscribe(),r.store=h??null,h==null)r.source.v=void 0,r.unsubscribe=jr;else{var i=!0;r.unsubscribe=qd(h,s=>{i?r.source.v=s:le(r.source,s)}),i=!1}return Bt(r.source)}function Yd(h,t){return h.set(t),t}function Dc(){const h={};return wc(()=>{for(var t in h)h[t].unsubscribe()}),h}function jd(h){var t=Zo;try{return Zo=!1,[h(),Zo]}finally{Zo=t}}function eu(h){for(var t=Yt,e=Yt;t!==null&&!(t.f&(Ci|to));)t=t.parent;try{return Hi(t),h()}finally{Hi(e)}}function Ws(h,t,e,r){var q;var i=(e&Qf)!==0,s=!es||(e&td)!==0,o=(e&id)!==0,l=(e&nd)!==0,u=!1,f;o?[f,u]=jd(()=>h[t]):f=h[t];var d=nr in h||Nf in h,p=o&&(((q=Yr(h,t))==null?void 0:q.set)??(d&&t in h&&(T=>h[t]=T)))||void 0,g=r,m=!0,x=!1,y=()=>(x=!0,m&&(m=!1,l?g=sr(r):g=r),g);f===void 0&&r!==void 0&&(p&&s&&Hf(),f=y(),p&&p(f));var b;if(s)b=()=>{var T=h[t];return T===void 0?y():(m=!0,x=!1,T)};else{var P=eu(()=>(i?va:ld)(()=>h[t]));P.f|=Df,b=()=>{var T=Bt(P);return T!==void 0&&(g=void 0),T===void 0?g:T}}if(!(e&ed))return b;if(p){var A=h.$$legacy;return function(T,k){return arguments.length>0?((!s||!k||A||u)&&p(k?b():T),T):b()}}var N=!1,G=!1,z=za(f),K=eu(()=>va(()=>{var T=b(),k=Bt(z);return N?(N=!1,G=!0,k):(G=!1,z.v=T)}));return i||(K.equals=hl),function(T,k){if(arguments.length>0){const I=k?Bt(K):s&&o?Wr(T):T;return K.equals(I)||(N=!0,le(z,I),x&&g!==void 0&&(g=I),sr(()=>Bt(K))),T}return Bt(K)}}function Xd(h){ne===null&&Cc(),es&&ne.l!==null?$d(ne).m.push(h):Uh(()=>{const t=sr(h);if(typeof t=="function")return t})}function Jd(h,t,{bubbles:e=!1,cancelable:r=!1}={}){return new CustomEvent(h,{detail:t,bubbles:e,cancelable:r})}function Bc(){const h=ne;return h===null&&Cc(),(t,e,r)=>{var s;const i=(s=h.s.$$events)==null?void 0:s[t];if(i){const o=Ca(i)?i.slice():[i],l=Jd(t,e,r);for(const u of o)u.call(h.x,l);return!l.defaultPrevented}return!0}}function $d(h){var t=h.l;return t.u??(t.u={a:[],b:[],m:[]})}const Kd="5";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(Kd);Xf();const zr=[];function Nc(h,t=jr){let e=null;const r=new Set;function i(l){if(uc(h,l)&&(h=l,e)){const u=!zr.length;for(const f of r)f[1](),zr.push(f,h);if(u){for(let f=0;f<zr.length;f+=2)zr[f][0](zr[f+1]);zr.length=0}}}function s(l){i(l(h))}function o(l,u=jr){const f=[l,u];return r.add(f),r.size===1&&(e=t(i,s)||jr),l(h),()=>{r.delete(f),r.size===0&&e&&(e(),e=null)}}return{set:i,update:s,subscribe:o}}const pa=Nc(null),Ea=Nc(null);var Qd=lr("<option> </option>"),tp=lr('<div class="svelte-1lvjhsb"><label for="layer-selector">Select Map Layer:</label> <select id="layer-selector"></select></div>');function ep(h,t){Da(t,!1);const e=[{label:"OpenStreetMap Default",value:"https://tile.openstreetmap.org/{z}/{x}/{y}.png",attribution:"&copy; OpenStreetMap contributors"},{label:"CartoDB Positron",value:"https://basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png",attribution:"&copy; OpenStreetMap contributors &copy; CartoDB"},{label:"CartoDB Dark Matter",value:"https://basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png",attribution:"&copy; OpenStreetMap contributors &copy; CartoDB"},{label:"OpenTopoMap",value:"https://tile.opentopomap.org/{z}/{x}/{y}.png",attribution:"&copy; OpenStreetMap contributors &copy; OpenTopoMap"},{label:"ESRI Satellite",value:"https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}",attribution:"Tiles &copy; Esri &mdash; Source: Esri, i-cubed, USDA, USGS, AEX, GeoEye, Getmapping, Aerogrid, IGN, IGP, UPR-EGP, and the GIS User Community"},{label:"ESRI World Imagery",value:"https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}",attribution:"Tiles &copy; Esri &mdash; Source: Esri, i-cubed, USDA, USGS, AEX, GeoEye, Getmapping, Aerogrid, IGN, IGP, UPR-EGP, and the GIS User Community"},{label:"ESRI World Street Map",value:"https://server.arcgisonline.com/ArcGIS/rest/services/World_Street_Map/MapServer/tile/{z}/{y}/{x}",attribution:"Tiles &copy; Esri &mdash; Source: Esri, DeLorme, NAVTEQ"},{label:"ESRI World Topo Map",value:"https://server.arcgisonline.com/ArcGIS/rest/services/World_Topo_Map/MapServer/tile/{z}/{y}/{x}",attribution:"Tiles &copy; Esri &mdash; Source: Esri, DeLorme, NAVTEQ"}];let r=Ws(t,"selectedLayer",28,()=>e[0]);const i=Bc(),s=u=>{r(u),i("change",{layer:u})};gl();var o=tp(),l=kn(ya(o),2);Fd(l,5,()=>e,Bd,(u,f)=>{var d=Qd(),p={},g=ya(d);Lc(()=>{p!==(p=Bt(f).value)&&(d.value=(d.__value=Bt(f).value)==null?"":Bt(f).value),Hd(d,Bt(f)===r()),Id(g,Bt(f).label)}),rr(u,d)}),da("change",l,u=>s(e[u.target.selectedIndex])),rr(h,o),Ba()}var An=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function yl(h){return h&&h.__esModule&&Object.prototype.hasOwnProperty.call(h,"default")?h.default:h}var Bs={exports:{}};/* @preserve
 * Leaflet 1.9.4, a JS library for interactive maps. https://leafletjs.com
 * (c) 2010-2023 Vladimir Agafonkin, (c) 2010-2011 CloudMade
 */var ip=Bs.exports,iu;function np(){return iu||(iu=1,function(h,t){(function(e,r){r(t)})(ip,function(e){var r="1.9.4";function i(n){var a,c,_,E;for(c=1,_=arguments.length;c<_;c++){E=arguments[c];for(a in E)n[a]=E[a]}return n}var s=Object.create||function(){function n(){}return function(a){return n.prototype=a,new n}}();function o(n,a){var c=Array.prototype.slice;if(n.bind)return n.bind.apply(n,c.call(arguments,1));var _=c.call(arguments,2);return function(){return n.apply(a,_.length?_.concat(c.call(arguments)):arguments)}}var l=0;function u(n){return"_leaflet_id"in n||(n._leaflet_id=++l),n._leaflet_id}function f(n,a,c){var _,E,R,J;return J=function(){_=!1,E&&(R.apply(c,E),E=!1)},R=function(){_?E=arguments:(n.apply(c,arguments),setTimeout(J,a),_=!0)},R}function d(n,a,c){var _=a[1],E=a[0],R=_-E;return n===_&&c?n:((n-E)%R+R)%R+E}function p(){return!1}function g(n,a){if(a===!1)return n;var c=Math.pow(10,a===void 0?6:a);return Math.round(n*c)/c}function m(n){return n.trim?n.trim():n.replace(/^\s+|\s+$/g,"")}function x(n){return m(n).split(/\s+/)}function y(n,a){Object.prototype.hasOwnProperty.call(n,"options")||(n.options=n.options?s(n.options):{});for(var c in a)n.options[c]=a[c];return n.options}function b(n,a,c){var _=[];for(var E in n)_.push(encodeURIComponent(c?E.toUpperCase():E)+"="+encodeURIComponent(n[E]));return(!a||a.indexOf("?")===-1?"?":"&")+_.join("&")}var P=/\{ *([\w_ -]+) *\}/g;function A(n,a){return n.replace(P,function(c,_){var E=a[_];if(E===void 0)throw new Error("No value provided for variable "+c);return typeof E=="function"&&(E=E(a)),E})}var N=Array.isArray||function(n){return Object.prototype.toString.call(n)==="[object Array]"};function G(n,a){for(var c=0;c<n.length;c++)if(n[c]===a)return c;return-1}var z="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function K(n){return window["webkit"+n]||window["moz"+n]||window["ms"+n]}var q=0;function T(n){var a=+new Date,c=Math.max(0,16-(a-q));return q=a+c,window.setTimeout(n,c)}var k=window.requestAnimationFrame||K("RequestAnimationFrame")||T,I=window.cancelAnimationFrame||K("CancelAnimationFrame")||K("CancelRequestAnimationFrame")||function(n){window.clearTimeout(n)};function F(n,a,c){if(c&&k===T)n.call(a);else return k.call(window,o(n,a))}function S(n){n&&I.call(window,n)}var O={__proto__:null,extend:i,create:s,bind:o,get lastId(){return l},stamp:u,throttle:f,wrapNum:d,falseFn:p,formatNum:g,trim:m,splitWords:x,setOptions:y,getParamString:b,template:A,isArray:N,indexOf:G,emptyImageUrl:z,requestFn:k,cancelFn:I,requestAnimFrame:F,cancelAnimFrame:S};function v(){}v.extend=function(n){var a=function(){y(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},c=a.__super__=this.prototype,_=s(c);_.constructor=a,a.prototype=_;for(var E in this)Object.prototype.hasOwnProperty.call(this,E)&&E!=="prototype"&&E!=="__super__"&&(a[E]=this[E]);return n.statics&&i(a,n.statics),n.includes&&(C(n.includes),i.apply(null,[_].concat(n.includes))),i(_,n),delete _.statics,delete _.includes,_.options&&(_.options=c.options?s(c.options):{},i(_.options,n.options)),_._initHooks=[],_.callInitHooks=function(){if(!this._initHooksCalled){c.callInitHooks&&c.callInitHooks.call(this),this._initHooksCalled=!0;for(var R=0,J=_._initHooks.length;R<J;R++)_._initHooks[R].call(this)}},a},v.include=function(n){var a=this.prototype.options;return i(this.prototype,n),n.options&&(this.prototype.options=a,this.mergeOptions(n.options)),this},v.mergeOptions=function(n){return i(this.prototype.options,n),this},v.addInitHook=function(n){var a=Array.prototype.slice.call(arguments,1),c=typeof n=="function"?n:function(){this[n].apply(this,a)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(c),this};function C(n){if(!(typeof L>"u"||!L||!L.Mixin)){n=N(n)?n:[n];for(var a=0;a<n.length;a++)n[a]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",new Error().stack)}}var U={on:function(n,a,c){if(typeof n=="object")for(var _ in n)this._on(_,n[_],a);else{n=x(n);for(var E=0,R=n.length;E<R;E++)this._on(n[E],a,c)}return this},off:function(n,a,c){if(!arguments.length)delete this._events;else if(typeof n=="object")for(var _ in n)this._off(_,n[_],a);else{n=x(n);for(var E=arguments.length===1,R=0,J=n.length;R<J;R++)E?this._off(n[R]):this._off(n[R],a,c)}return this},_on:function(n,a,c,_){if(typeof a!="function"){console.warn("wrong listener type: "+typeof a);return}if(this._listens(n,a,c)===!1){c===this&&(c=void 0);var E={fn:a,ctx:c};_&&(E.once=!0),this._events=this._events||{},this._events[n]=this._events[n]||[],this._events[n].push(E)}},_off:function(n,a,c){var _,E,R;if(this._events&&(_=this._events[n],!!_)){if(arguments.length===1){if(this._firingCount)for(E=0,R=_.length;E<R;E++)_[E].fn=p;delete this._events[n];return}if(typeof a!="function"){console.warn("wrong listener type: "+typeof a);return}var J=this._listens(n,a,c);if(J!==!1){var nt=_[J];this._firingCount&&(nt.fn=p,this._events[n]=_=_.slice()),_.splice(J,1)}}},fire:function(n,a,c){if(!this.listens(n,c))return this;var _=i({},a,{type:n,target:this,sourceTarget:a&&a.sourceTarget||this});if(this._events){var E=this._events[n];if(E){this._firingCount=this._firingCount+1||1;for(var R=0,J=E.length;R<J;R++){var nt=E[R],st=nt.fn;nt.once&&this.off(n,st,nt.ctx),st.call(nt.ctx||this,_)}this._firingCount--}}return c&&this._propagateEvent(_),this},listens:function(n,a,c,_){typeof n!="string"&&console.warn('"string" type argument expected');var E=a;typeof a!="function"&&(_=!!a,E=void 0,c=void 0);var R=this._events&&this._events[n];if(R&&R.length&&this._listens(n,E,c)!==!1)return!0;if(_){for(var J in this._eventParents)if(this._eventParents[J].listens(n,a,c,_))return!0}return!1},_listens:function(n,a,c){if(!this._events)return!1;var _=this._events[n]||[];if(!a)return!!_.length;c===this&&(c=void 0);for(var E=0,R=_.length;E<R;E++)if(_[E].fn===a&&_[E].ctx===c)return E;return!1},once:function(n,a,c){if(typeof n=="object")for(var _ in n)this._on(_,n[_],a,!0);else{n=x(n);for(var E=0,R=n.length;E<R;E++)this._on(n[E],a,c,!0)}return this},addEventParent:function(n){return this._eventParents=this._eventParents||{},this._eventParents[u(n)]=n,this},removeEventParent:function(n){return this._eventParents&&delete this._eventParents[u(n)],this},_propagateEvent:function(n){for(var a in this._eventParents)this._eventParents[a].fire(n.type,i({layer:n.target,propagatedFrom:n.target},n),!0)}};U.addEventListener=U.on,U.removeEventListener=U.clearAllEventListeners=U.off,U.addOneTimeEventListener=U.once,U.fireEvent=U.fire,U.hasEventListeners=U.listens;var H=v.extend(U);function W(n,a,c){this.x=c?Math.round(n):n,this.y=c?Math.round(a):a}var V=Math.trunc||function(n){return n>0?Math.floor(n):Math.ceil(n)};W.prototype={clone:function(){return new W(this.x,this.y)},add:function(n){return this.clone()._add(et(n))},_add:function(n){return this.x+=n.x,this.y+=n.y,this},subtract:function(n){return this.clone()._subtract(et(n))},_subtract:function(n){return this.x-=n.x,this.y-=n.y,this},divideBy:function(n){return this.clone()._divideBy(n)},_divideBy:function(n){return this.x/=n,this.y/=n,this},multiplyBy:function(n){return this.clone()._multiplyBy(n)},_multiplyBy:function(n){return this.x*=n,this.y*=n,this},scaleBy:function(n){return new W(this.x*n.x,this.y*n.y)},unscaleBy:function(n){return new W(this.x/n.x,this.y/n.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=V(this.x),this.y=V(this.y),this},distanceTo:function(n){n=et(n);var a=n.x-this.x,c=n.y-this.y;return Math.sqrt(a*a+c*c)},equals:function(n){return n=et(n),n.x===this.x&&n.y===this.y},contains:function(n){return n=et(n),Math.abs(n.x)<=Math.abs(this.x)&&Math.abs(n.y)<=Math.abs(this.y)},toString:function(){return"Point("+g(this.x)+", "+g(this.y)+")"}};function et(n,a,c){return n instanceof W?n:N(n)?new W(n[0],n[1]):n==null?n:typeof n=="object"&&"x"in n&&"y"in n?new W(n.x,n.y):new W(n,a,c)}function Y(n,a){if(n)for(var c=a?[n,a]:n,_=0,E=c.length;_<E;_++)this.extend(c[_])}Y.prototype={extend:function(n){var a,c;if(!n)return this;if(n instanceof W||typeof n[0]=="number"||"x"in n)a=c=et(n);else if(n=Q(n),a=n.min,c=n.max,!a||!c)return this;return!this.min&&!this.max?(this.min=a.clone(),this.max=c.clone()):(this.min.x=Math.min(a.x,this.min.x),this.max.x=Math.max(c.x,this.max.x),this.min.y=Math.min(a.y,this.min.y),this.max.y=Math.max(c.y,this.max.y)),this},getCenter:function(n){return et((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,n)},getBottomLeft:function(){return et(this.min.x,this.max.y)},getTopRight:function(){return et(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(n){var a,c;return typeof n[0]=="number"||n instanceof W?n=et(n):n=Q(n),n instanceof Y?(a=n.min,c=n.max):a=c=n,a.x>=this.min.x&&c.x<=this.max.x&&a.y>=this.min.y&&c.y<=this.max.y},intersects:function(n){n=Q(n);var a=this.min,c=this.max,_=n.min,E=n.max,R=E.x>=a.x&&_.x<=c.x,J=E.y>=a.y&&_.y<=c.y;return R&&J},overlaps:function(n){n=Q(n);var a=this.min,c=this.max,_=n.min,E=n.max,R=E.x>a.x&&_.x<c.x,J=E.y>a.y&&_.y<c.y;return R&&J},isValid:function(){return!!(this.min&&this.max)},pad:function(n){var a=this.min,c=this.max,_=Math.abs(a.x-c.x)*n,E=Math.abs(a.y-c.y)*n;return Q(et(a.x-_,a.y-E),et(c.x+_,c.y+E))},equals:function(n){return n?(n=Q(n),this.min.equals(n.getTopLeft())&&this.max.equals(n.getBottomRight())):!1}};function Q(n,a){return!n||n instanceof Y?n:new Y(n,a)}function pt(n,a){if(n)for(var c=a?[n,a]:n,_=0,E=c.length;_<E;_++)this.extend(c[_])}pt.prototype={extend:function(n){var a=this._southWest,c=this._northEast,_,E;if(n instanceof rt)_=n,E=n;else if(n instanceof pt){if(_=n._southWest,E=n._northEast,!_||!E)return this}else return n?this.extend(mt(n)||ct(n)):this;return!a&&!c?(this._southWest=new rt(_.lat,_.lng),this._northEast=new rt(E.lat,E.lng)):(a.lat=Math.min(_.lat,a.lat),a.lng=Math.min(_.lng,a.lng),c.lat=Math.max(E.lat,c.lat),c.lng=Math.max(E.lng,c.lng)),this},pad:function(n){var a=this._southWest,c=this._northEast,_=Math.abs(a.lat-c.lat)*n,E=Math.abs(a.lng-c.lng)*n;return new pt(new rt(a.lat-_,a.lng-E),new rt(c.lat+_,c.lng+E))},getCenter:function(){return new rt((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new rt(this.getNorth(),this.getWest())},getSouthEast:function(){return new rt(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(n){typeof n[0]=="number"||n instanceof rt||"lat"in n?n=mt(n):n=ct(n);var a=this._southWest,c=this._northEast,_,E;return n instanceof pt?(_=n.getSouthWest(),E=n.getNorthEast()):_=E=n,_.lat>=a.lat&&E.lat<=c.lat&&_.lng>=a.lng&&E.lng<=c.lng},intersects:function(n){n=ct(n);var a=this._southWest,c=this._northEast,_=n.getSouthWest(),E=n.getNorthEast(),R=E.lat>=a.lat&&_.lat<=c.lat,J=E.lng>=a.lng&&_.lng<=c.lng;return R&&J},overlaps:function(n){n=ct(n);var a=this._southWest,c=this._northEast,_=n.getSouthWest(),E=n.getNorthEast(),R=E.lat>a.lat&&_.lat<c.lat,J=E.lng>a.lng&&_.lng<c.lng;return R&&J},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(n,a){return n?(n=ct(n),this._southWest.equals(n.getSouthWest(),a)&&this._northEast.equals(n.getNorthEast(),a)):!1},isValid:function(){return!!(this._southWest&&this._northEast)}};function ct(n,a){return n instanceof pt?n:new pt(n,a)}function rt(n,a,c){if(isNaN(n)||isNaN(a))throw new Error("Invalid LatLng object: ("+n+", "+a+")");this.lat=+n,this.lng=+a,c!==void 0&&(this.alt=+c)}rt.prototype={equals:function(n,a){if(!n)return!1;n=mt(n);var c=Math.max(Math.abs(this.lat-n.lat),Math.abs(this.lng-n.lng));return c<=(a===void 0?1e-9:a)},toString:function(n){return"LatLng("+g(this.lat,n)+", "+g(this.lng,n)+")"},distanceTo:function(n){return kt.distance(this,mt(n))},wrap:function(){return kt.wrapLatLng(this)},toBounds:function(n){var a=180*n/40075017,c=a/Math.cos(Math.PI/180*this.lat);return ct([this.lat-a,this.lng-c],[this.lat+a,this.lng+c])},clone:function(){return new rt(this.lat,this.lng,this.alt)}};function mt(n,a,c){return n instanceof rt?n:N(n)&&typeof n[0]!="object"?n.length===3?new rt(n[0],n[1],n[2]):n.length===2?new rt(n[0],n[1]):null:n==null?n:typeof n=="object"&&"lat"in n?new rt(n.lat,"lng"in n?n.lng:n.lon,n.alt):a===void 0?null:new rt(n,a,c)}var St={latLngToPoint:function(n,a){var c=this.projection.project(n),_=this.scale(a);return this.transformation._transform(c,_)},pointToLatLng:function(n,a){var c=this.scale(a),_=this.transformation.untransform(n,c);return this.projection.unproject(_)},project:function(n){return this.projection.project(n)},unproject:function(n){return this.projection.unproject(n)},scale:function(n){return 256*Math.pow(2,n)},zoom:function(n){return Math.log(n/256)/Math.LN2},getProjectedBounds:function(n){if(this.infinite)return null;var a=this.projection.bounds,c=this.scale(n),_=this.transformation.transform(a.min,c),E=this.transformation.transform(a.max,c);return new Y(_,E)},infinite:!1,wrapLatLng:function(n){var a=this.wrapLng?d(n.lng,this.wrapLng,!0):n.lng,c=this.wrapLat?d(n.lat,this.wrapLat,!0):n.lat,_=n.alt;return new rt(c,a,_)},wrapLatLngBounds:function(n){var a=n.getCenter(),c=this.wrapLatLng(a),_=a.lat-c.lat,E=a.lng-c.lng;if(_===0&&E===0)return n;var R=n.getSouthWest(),J=n.getNorthEast(),nt=new rt(R.lat-_,R.lng-E),st=new rt(J.lat-_,J.lng-E);return new pt(nt,st)}},kt=i({},St,{wrapLng:[-180,180],R:6371e3,distance:function(n,a){var c=Math.PI/180,_=n.lat*c,E=a.lat*c,R=Math.sin((a.lat-n.lat)*c/2),J=Math.sin((a.lng-n.lng)*c/2),nt=R*R+Math.cos(_)*Math.cos(E)*J*J,st=2*Math.atan2(Math.sqrt(nt),Math.sqrt(1-nt));return this.R*st}}),It=6378137,wt={R:It,MAX_LATITUDE:85.0511287798,project:function(n){var a=Math.PI/180,c=this.MAX_LATITUDE,_=Math.max(Math.min(c,n.lat),-c),E=Math.sin(_*a);return new W(this.R*n.lng*a,this.R*Math.log((1+E)/(1-E))/2)},unproject:function(n){var a=180/Math.PI;return new rt((2*Math.atan(Math.exp(n.y/this.R))-Math.PI/2)*a,n.x*a/this.R)},bounds:function(){var n=It*Math.PI;return new Y([-n,-n],[n,n])}()};function vt(n,a,c,_){if(N(n)){this._a=n[0],this._b=n[1],this._c=n[2],this._d=n[3];return}this._a=n,this._b=a,this._c=c,this._d=_}vt.prototype={transform:function(n,a){return this._transform(n.clone(),a)},_transform:function(n,a){return a=a||1,n.x=a*(this._a*n.x+this._b),n.y=a*(this._c*n.y+this._d),n},untransform:function(n,a){return a=a||1,new W((n.x/a-this._b)/this._a,(n.y/a-this._d)/this._c)}};function ht(n,a,c,_){return new vt(n,a,c,_)}var ft=i({},kt,{code:"EPSG:3857",projection:wt,transformation:function(){var n=.5/(Math.PI*wt.R);return ht(n,.5,-n,.5)}()}),M=i({},ft,{code:"EPSG:900913"});function tt(n){return document.createElementNS("http://www.w3.org/2000/svg",n)}function $(n,a){var c="",_,E,R,J,nt,st;for(_=0,R=n.length;_<R;_++){for(nt=n[_],E=0,J=nt.length;E<J;E++)st=nt[E],c+=(E?"L":"M")+st.x+" "+st.y;c+=a?At.svg?"z":"x":""}return c||"M0 0"}var Z=document.documentElement.style,B="ActiveXObject"in window,X=B&&!document.addEventListener,ot="msLaunchUri"in navigator&&!("documentMode"in document),lt=si("webkit"),it=si("android"),_t=si("android 2")||si("android 3"),xt=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),gt=it&&si("Google")&&xt<537&&!("AudioNode"in window),Et=!!window.opera,Wt=!ot&&si("chrome"),Tt=si("gecko")&&!lt&&!Et&&!B,$t=!Wt&&si("safari"),fe=si("phantom"),se="OTransition"in Z,ye=navigator.platform.indexOf("Win")===0,Jt=B&&"transition"in Z,ve="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!_t,oe="MozPerspective"in Z,xe=!window.L_DISABLE_3D&&(Jt||ve||oe)&&!se&&!fe,Fe=typeof orientation<"u"||si("mobile"),ii=Fe&&lt,ni=Fe&&ve,yi=!window.PointerEvent&&window.MSPointerEvent,je=!!(window.PointerEvent||yi),ie="ontouchstart"in window||!!window.TouchEvent,Ii=!window.L_NO_TOUCH&&(ie||je),ri=Fe&&Et,os=Fe&&Tt,so=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,oo=function(){var n=!1;try{var a=Object.defineProperty({},"passive",{get:function(){n=!0}});window.addEventListener("testPassiveEventSupport",p,a),window.removeEventListener("testPassiveEventSupport",p,a)}catch{}return n}(),fr=function(){return!!document.createElement("canvas").getContext}(),dr=!!(document.createElementNS&&tt("svg").createSVGRect),Za=!!dr&&function(){var n=document.createElement("div");return n.innerHTML="<svg/>",(n.firstChild&&n.firstChild.namespaceURI)==="http://www.w3.org/2000/svg"}(),ao=!dr&&function(){try{var n=document.createElement("div");n.innerHTML='<v:shape adj="1"/>';var a=n.firstChild;return a.style.behavior="url(#default#VML)",a&&typeof a.adj=="object"}catch{return!1}}(),Ga=navigator.platform.indexOf("Mac")===0,ho=navigator.platform.indexOf("Linux")===0;function si(n){return navigator.userAgent.toLowerCase().indexOf(n)>=0}var At={ie:B,ielt9:X,edge:ot,webkit:lt,android:it,android23:_t,androidStock:gt,opera:Et,chrome:Wt,gecko:Tt,safari:$t,phantom:fe,opera12:se,win:ye,ie3d:Jt,webkit3d:ve,gecko3d:oe,any3d:xe,mobile:Fe,mobileWebkit:ii,mobileWebkit3d:ni,msPointer:yi,pointer:je,touch:Ii,touchNative:ie,mobileOpera:ri,mobileGecko:os,retina:so,passiveEvents:oo,canvas:fr,svg:dr,vml:ao,inlineSvg:Za,mac:Ga,linux:ho},as=At.msPointer?"MSPointerDown":"pointerdown",pr=At.msPointer?"MSPointerMove":"pointermove",fn=At.msPointer?"MSPointerUp":"pointerup",mr=At.msPointer?"MSPointerCancel":"pointercancel",Nn={touchstart:as,touchmove:pr,touchend:fn,touchcancel:mr},_r={touchstart:co,touchmove:Oi,touchend:Oi,touchcancel:Oi},oi={},lo=!1;function Ha(n,a,c){return a==="touchstart"&&gr(),_r[a]?(c=_r[a].bind(this,c),n.addEventListener(Nn[a],c,!1),c):(console.warn("wrong event specified:",a),p)}function Wa(n,a,c){if(!Nn[a]){console.warn("wrong event specified:",a);return}n.removeEventListener(Nn[a],c,!1)}function Va(n){oi[n.pointerId]=n}function qa(n){oi[n.pointerId]&&(oi[n.pointerId]=n)}function uo(n){delete oi[n.pointerId]}function gr(){lo||(document.addEventListener(as,Va,!0),document.addEventListener(pr,qa,!0),document.addEventListener(fn,uo,!0),document.addEventListener(mr,uo,!0),lo=!0)}function Oi(n,a){if(a.pointerType!==(a.MSPOINTER_TYPE_MOUSE||"mouse")){a.touches=[];for(var c in oi)a.touches.push(oi[c]);a.changedTouches=[a],n(a)}}function co(n,a){a.MSPOINTER_TYPE_TOUCH&&a.pointerType===a.MSPOINTER_TYPE_TOUCH&&be(a),Oi(n,a)}function Zt(n){var a={},c,_;for(_ in n)c=n[_],a[_]=c&&c.bind?c.bind(n):c;return n=a,a.type="dblclick",a.detail=2,a.isTrusted=!1,a._simulated=!0,a}var Vi=200;function Ya(n,a){n.addEventListener("dblclick",a);var c=0,_;function E(R){if(R.detail!==1){_=R.detail;return}if(!(R.pointerType==="mouse"||R.sourceCapabilities&&!R.sourceCapabilities.firesTouchEvents)){var J=_o(R);if(!(J.some(function(st){return st instanceof HTMLLabelElement&&st.attributes.for})&&!J.some(function(st){return st instanceof HTMLInputElement||st instanceof HTMLSelectElement}))){var nt=Date.now();nt-c<=Vi?(_++,_===2&&a(Zt(R))):_=1,c=nt}}}return n.addEventListener("click",E),{dblclick:a,simDblclick:E}}function ja(n,a){n.removeEventListener("dblclick",a.dblclick),n.removeEventListener("click",a.simDblclick)}var hs=xr(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),Fn=xr(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),fo=Fn==="webkitTransition"||Fn==="OTransition"?Fn+"End":"transitionend";function ai(n){return typeof n=="string"?document.getElementById(n):n}function Un(n,a){var c=n.style[a]||n.currentStyle&&n.currentStyle[a];if((!c||c==="auto")&&document.defaultView){var _=document.defaultView.getComputedStyle(n,null);c=_?_[a]:null}return c==="auto"?null:c}function jt(n,a,c){var _=document.createElement(n);return _.className=a||"",c&&c.appendChild(_),_}function re(n){var a=n.parentNode;a&&a.removeChild(n)}function yr(n){for(;n.firstChild;)n.removeChild(n.firstChild)}function dn(n){var a=n.parentNode;a&&a.lastChild!==n&&a.appendChild(n)}function Ae(n){var a=n.parentNode;a&&a.firstChild!==n&&a.insertBefore(n,a.firstChild)}function ls(n,a){if(n.classList!==void 0)return n.classList.contains(a);var c=vr(n);return c.length>0&&new RegExp("(^|\\s)"+a+"(\\s|$)").test(c)}function Ft(n,a){if(n.classList!==void 0)for(var c=x(a),_=0,E=c.length;_<E;_++)n.classList.add(c[_]);else if(!ls(n,a)){var R=vr(n);us(n,(R?R+" ":"")+a)}}function ae(n,a){n.classList!==void 0?n.classList.remove(a):us(n,m((" "+vr(n)+" ").replace(" "+a+" "," ")))}function us(n,a){n.className.baseVal===void 0?n.className=a:n.className.baseVal=a}function vr(n){return n.correspondingElement&&(n=n.correspondingElement),n.className.baseVal===void 0?n.className:n.className.baseVal}function Se(n,a){"opacity"in n.style?n.style.opacity=a:"filter"in n.style&&Xa(n,a)}function Xa(n,a){var c=!1,_="DXImageTransform.Microsoft.Alpha";try{c=n.filters.item(_)}catch{if(a===1)return}a=Math.round(a*100),c?(c.Enabled=a!==100,c.Opacity=a):n.style.filter+=" progid:"+_+"(opacity="+a+")"}function xr(n){for(var a=document.documentElement.style,c=0;c<n.length;c++)if(n[c]in a)return n[c];return!1}function we(n,a,c){var _=a||new W(0,0);n.style[hs]=(At.ie3d?"translate("+_.x+"px,"+_.y+"px)":"translate3d("+_.x+"px,"+_.y+"px,0)")+(c?" scale("+c+")":"")}function ce(n,a){n._leaflet_pos=a,At.any3d?we(n,a):(n.style.left=a.x+"px",n.style.top=a.y+"px")}function qi(n){return n._leaflet_pos||new W(0,0)}var Zn,Gn,cs;if("onselectstart"in document)Zn=function(){Rt(window,"selectstart",be)},Gn=function(){Kt(window,"selectstart",be)};else{var pn=xr(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);Zn=function(){if(pn){var n=document.documentElement.style;cs=n[pn],n[pn]="none"}},Gn=function(){pn&&(document.documentElement.style[pn]=cs,cs=void 0)}}function Hn(){Rt(window,"dragstart",be)}function wr(){Kt(window,"dragstart",be)}var Yi,fs;function Ri(n){for(;n.tabIndex===-1;)n=n.parentNode;n.style&&(br(),Yi=n,fs=n.style.outlineStyle,n.style.outlineStyle="none",Rt(window,"keydown",br))}function br(){Yi&&(Yi.style.outlineStyle=fs,Yi=void 0,fs=void 0,Kt(window,"keydown",br))}function po(n){do n=n.parentNode;while((!n.offsetWidth||!n.offsetHeight)&&n!==document.body);return n}function ds(n){var a=n.getBoundingClientRect();return{x:a.width/n.offsetWidth||1,y:a.height/n.offsetHeight||1,boundingClientRect:a}}var Ja={__proto__:null,TRANSFORM:hs,TRANSITION:Fn,TRANSITION_END:fo,get:ai,getStyle:Un,create:jt,remove:re,empty:yr,toFront:dn,toBack:Ae,hasClass:ls,addClass:Ft,removeClass:ae,setClass:us,getClass:vr,setOpacity:Se,testProp:xr,setTransform:we,setPosition:ce,getPosition:qi,get disableTextSelection(){return Zn},get enableTextSelection(){return Gn},disableImageDrag:Hn,enableImageDrag:wr,preventOutline:Ri,restoreOutline:br,getSizedParentNode:po,getScale:ds};function Rt(n,a,c,_){if(a&&typeof a=="object")for(var E in a)ps(n,E,a[E],c);else{a=x(a);for(var R=0,J=a.length;R<J;R++)ps(n,a[R],c,_)}return this}var hi="_leaflet_events";function Kt(n,a,c,_){if(arguments.length===1)mo(n),delete n[hi];else if(a&&typeof a=="object")for(var E in a)ms(n,E,a[E],c);else if(a=x(a),arguments.length===2)mo(n,function(nt){return G(a,nt)!==-1});else for(var R=0,J=a.length;R<J;R++)ms(n,a[R],c,_);return this}function mo(n,a){for(var c in n[hi]){var _=c.split(/\d/)[0];(!a||a(_))&&ms(n,_,null,null,c)}}var Wn={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function ps(n,a,c,_){var E=a+u(c)+(_?"_"+u(_):"");if(n[hi]&&n[hi][E])return this;var R=function(nt){return c.call(_||n,nt||window.event)},J=R;!At.touchNative&&At.pointer&&a.indexOf("touch")===0?R=Ha(n,a,R):At.touch&&a==="dblclick"?R=Ya(n,R):"addEventListener"in n?a==="touchstart"||a==="touchmove"||a==="wheel"||a==="mousewheel"?n.addEventListener(Wn[a]||a,R,At.passiveEvents?{passive:!1}:!1):a==="mouseenter"||a==="mouseleave"?(R=function(nt){nt=nt||window.event,gs(n,nt)&&J(nt)},n.addEventListener(Wn[a],R,!1)):n.addEventListener(a,J,!1):n.attachEvent("on"+a,R),n[hi]=n[hi]||{},n[hi][E]=R}function ms(n,a,c,_,E){E=E||a+u(c)+(_?"_"+u(_):"");var R=n[hi]&&n[hi][E];if(!R)return this;!At.touchNative&&At.pointer&&a.indexOf("touch")===0?Wa(n,a,R):At.touch&&a==="dblclick"?ja(n,R):"removeEventListener"in n?n.removeEventListener(Wn[a]||a,R,!1):n.detachEvent("on"+a,R),n[hi][E]=null}function ji(n){return n.stopPropagation?n.stopPropagation():n.originalEvent?n.originalEvent._stopped=!0:n.cancelBubble=!0,this}function _s(n){return ps(n,"wheel",ji),this}function mn(n){return Rt(n,"mousedown touchstart dblclick contextmenu",ji),n._leaflet_disable_click=!0,this}function be(n){return n.preventDefault?n.preventDefault():n.returnValue=!1,this}function Di(n){return be(n),ji(n),this}function _o(n){if(n.composedPath)return n.composedPath();for(var a=[],c=n.target;c;)a.push(c),c=c.parentNode;return a}function go(n,a){if(!a)return new W(n.clientX,n.clientY);var c=ds(a),_=c.boundingClientRect;return new W((n.clientX-_.left)/c.x-a.clientLeft,(n.clientY-_.top)/c.y-a.clientTop)}var yo=At.linux&&At.chrome?window.devicePixelRatio:At.mac?window.devicePixelRatio*3:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function vo(n){return At.edge?n.wheelDeltaY/2:n.deltaY&&n.deltaMode===0?-n.deltaY/yo:n.deltaY&&n.deltaMode===1?-n.deltaY*20:n.deltaY&&n.deltaMode===2?-n.deltaY*60:n.deltaX||n.deltaZ?0:n.wheelDelta?(n.wheelDeltaY||n.wheelDelta)/2:n.detail&&Math.abs(n.detail)<32765?-n.detail*20:n.detail?n.detail/-32765*60:0}function gs(n,a){var c=a.relatedTarget;if(!c)return!0;try{for(;c&&c!==n;)c=c.parentNode}catch{return!1}return c!==n}var $a={__proto__:null,on:Rt,off:Kt,stopPropagation:ji,disableScrollPropagation:_s,disableClickPropagation:mn,preventDefault:be,stop:Di,getPropagationPath:_o,getMousePosition:go,getWheelDelta:vo,isExternalTarget:gs,addListener:Rt,removeListener:Kt},xo=H.extend({run:function(n,a,c,_){this.stop(),this._el=n,this._inProgress=!0,this._duration=c||.25,this._easeOutPower=1/Math.max(_||.5,.2),this._startPos=qi(n),this._offset=a.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=F(this._animate,this),this._step()},_step:function(n){var a=+new Date-this._startTime,c=this._duration*1e3;a<c?this._runFrame(this._easeOut(a/c),n):(this._runFrame(1),this._complete())},_runFrame:function(n,a){var c=this._startPos.add(this._offset.multiplyBy(n));a&&c._round(),ce(this._el,c),this.fire("step")},_complete:function(){S(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(n){return 1-Math.pow(1-n,this._easeOutPower)}}),Vt=H.extend({options:{crs:ft,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(n,a){a=y(this,a),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(n),this._initLayout(),this._onResize=o(this._onResize,this),this._initEvents(),a.maxBounds&&this.setMaxBounds(a.maxBounds),a.zoom!==void 0&&(this._zoom=this._limitZoom(a.zoom)),a.center&&a.zoom!==void 0&&this.setView(mt(a.center),a.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=Fn&&At.any3d&&!At.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),Rt(this._proxy,fo,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(n,a,c){if(a=a===void 0?this._zoom:this._limitZoom(a),n=this._limitCenter(mt(n),a,this.options.maxBounds),c=c||{},this._stop(),this._loaded&&!c.reset&&c!==!0){c.animate!==void 0&&(c.zoom=i({animate:c.animate},c.zoom),c.pan=i({animate:c.animate,duration:c.duration},c.pan));var _=this._zoom!==a?this._tryAnimatedZoom&&this._tryAnimatedZoom(n,a,c.zoom):this._tryAnimatedPan(n,c.pan);if(_)return clearTimeout(this._sizeTimer),this}return this._resetView(n,a,c.pan&&c.pan.noMoveStart),this},setZoom:function(n,a){return this._loaded?this.setView(this.getCenter(),n,{zoom:a}):(this._zoom=n,this)},zoomIn:function(n,a){return n=n||(At.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+n,a)},zoomOut:function(n,a){return n=n||(At.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-n,a)},setZoomAround:function(n,a,c){var _=this.getZoomScale(a),E=this.getSize().divideBy(2),R=n instanceof W?n:this.latLngToContainerPoint(n),J=R.subtract(E).multiplyBy(1-1/_),nt=this.containerPointToLatLng(E.add(J));return this.setView(nt,a,{zoom:c})},_getBoundsCenterZoom:function(n,a){a=a||{},n=n.getBounds?n.getBounds():ct(n);var c=et(a.paddingTopLeft||a.padding||[0,0]),_=et(a.paddingBottomRight||a.padding||[0,0]),E=this.getBoundsZoom(n,!1,c.add(_));if(E=typeof a.maxZoom=="number"?Math.min(a.maxZoom,E):E,E===1/0)return{center:n.getCenter(),zoom:E};var R=_.subtract(c).divideBy(2),J=this.project(n.getSouthWest(),E),nt=this.project(n.getNorthEast(),E),st=this.unproject(J.add(nt).divideBy(2).add(R),E);return{center:st,zoom:E}},fitBounds:function(n,a){if(n=ct(n),!n.isValid())throw new Error("Bounds are not valid.");var c=this._getBoundsCenterZoom(n,a);return this.setView(c.center,c.zoom,a)},fitWorld:function(n){return this.fitBounds([[-90,-180],[90,180]],n)},panTo:function(n,a){return this.setView(n,this._zoom,{pan:a})},panBy:function(n,a){if(n=et(n).round(),a=a||{},!n.x&&!n.y)return this.fire("moveend");if(a.animate!==!0&&!this.getSize().contains(n))return this._resetView(this.unproject(this.project(this.getCenter()).add(n)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new xo,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),a.noMoveStart||this.fire("movestart"),a.animate!==!1){Ft(this._mapPane,"leaflet-pan-anim");var c=this._getMapPanePos().subtract(n).round();this._panAnim.run(this._mapPane,c,a.duration||.25,a.easeLinearity)}else this._rawPanBy(n),this.fire("move").fire("moveend");return this},flyTo:function(n,a,c){if(c=c||{},c.animate===!1||!At.any3d)return this.setView(n,a,c);this._stop();var _=this.project(this.getCenter()),E=this.project(n),R=this.getSize(),J=this._zoom;n=mt(n),a=a===void 0?J:a;var nt=Math.max(R.x,R.y),st=nt*this.getZoomScale(J,a),dt=E.distanceTo(_)||1,Mt=1.42,Ot=Mt*Mt;function Gt(_e){var Uo=_e?-1:1,Lf=_e?st:nt,Mf=st*st-nt*nt+Uo*Ot*Ot*dt*dt,Ef=2*Lf*Ot*dt,rh=Mf/Ef,Hl=Math.sqrt(rh*rh+1)-rh,Tf=Hl<1e-9?-18:Math.log(Hl);return Tf}function De(_e){return(Math.exp(_e)-Math.exp(-_e))/2}function Ee(_e){return(Math.exp(_e)+Math.exp(-_e))/2}function fi(_e){return De(_e)/Ee(_e)}var Ge=Gt(0);function Pr(_e){return nt*(Ee(Ge)/Ee(Ge+Mt*_e))}function vf(_e){return nt*(Ee(Ge)*fi(Ge+Mt*_e)-De(Ge))/Ot}function xf(_e){return 1-Math.pow(1-_e,1.5)}var wf=Date.now(),Zl=(Gt(1)-Ge)/Mt,bf=c.duration?1e3*c.duration:1e3*Zl*.8;function Gl(){var _e=(Date.now()-wf)/bf,Uo=xf(_e)*Zl;_e<=1?(this._flyToFrame=F(Gl,this),this._move(this.unproject(_.add(E.subtract(_).multiplyBy(vf(Uo)/dt)),J),this.getScaleZoom(nt/Pr(Uo),J),{flyTo:!0})):this._move(n,a)._moveEnd(!0)}return this._moveStart(!0,c.noMoveStart),Gl.call(this),this},flyToBounds:function(n,a){var c=this._getBoundsCenterZoom(n,a);return this.flyTo(c.center,c.zoom,a)},setMaxBounds:function(n){return n=ct(n),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),n.isValid()?(this.options.maxBounds=n,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(n){var a=this.options.minZoom;return this.options.minZoom=n,this._loaded&&a!==n&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(n):this},setMaxZoom:function(n){var a=this.options.maxZoom;return this.options.maxZoom=n,this._loaded&&a!==n&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(n):this},panInsideBounds:function(n,a){this._enforcingBounds=!0;var c=this.getCenter(),_=this._limitCenter(c,this._zoom,ct(n));return c.equals(_)||this.panTo(_,a),this._enforcingBounds=!1,this},panInside:function(n,a){a=a||{};var c=et(a.paddingTopLeft||a.padding||[0,0]),_=et(a.paddingBottomRight||a.padding||[0,0]),E=this.project(this.getCenter()),R=this.project(n),J=this.getPixelBounds(),nt=Q([J.min.add(c),J.max.subtract(_)]),st=nt.getSize();if(!nt.contains(R)){this._enforcingBounds=!0;var dt=R.subtract(nt.getCenter()),Mt=nt.extend(R).getSize().subtract(st);E.x+=dt.x<0?-Mt.x:Mt.x,E.y+=dt.y<0?-Mt.y:Mt.y,this.panTo(this.unproject(E),a),this._enforcingBounds=!1}return this},invalidateSize:function(n){if(!this._loaded)return this;n=i({animate:!1,pan:!0},n===!0?{animate:!0}:n);var a=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var c=this.getSize(),_=a.divideBy(2).round(),E=c.divideBy(2).round(),R=_.subtract(E);return!R.x&&!R.y?this:(n.animate&&n.pan?this.panBy(R):(n.pan&&this._rawPanBy(R),this.fire("move"),n.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(o(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:a,newSize:c}))},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(n){if(n=this._locateOptions=i({timeout:1e4,watch:!1},n),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var a=o(this._handleGeolocationResponse,this),c=o(this._handleGeolocationError,this);return n.watch?this._locationWatchId=navigator.geolocation.watchPosition(a,c,n):navigator.geolocation.getCurrentPosition(a,c,n),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(n){if(this._container._leaflet_id){var a=n.code,c=n.message||(a===1?"permission denied":a===2?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:a,message:"Geolocation error: "+c+"."})}},_handleGeolocationResponse:function(n){if(this._container._leaflet_id){var a=n.coords.latitude,c=n.coords.longitude,_=new rt(a,c),E=_.toBounds(n.coords.accuracy*2),R=this._locateOptions;if(R.setView){var J=this.getBoundsZoom(E);this.setView(_,R.maxZoom?Math.min(J,R.maxZoom):J)}var nt={latlng:_,bounds:E,timestamp:n.timestamp};for(var st in n.coords)typeof n.coords[st]=="number"&&(nt[st]=n.coords[st]);this.fire("locationfound",nt)}},addHandler:function(n,a){if(!a)return this;var c=this[n]=new a(this);return this._handlers.push(c),this.options[n]&&c.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch{this._container._leaflet_id=void 0,this._containerId=void 0}this._locationWatchId!==void 0&&this.stopLocate(),this._stop(),re(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(S(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload");var n;for(n in this._layers)this._layers[n].remove();for(n in this._panes)re(this._panes[n]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(n,a){var c="leaflet-pane"+(n?" leaflet-"+n.replace("Pane","")+"-pane":""),_=jt("div",c,a||this._mapPane);return n&&(this._panes[n]=_),_},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var n=this.getPixelBounds(),a=this.unproject(n.getBottomLeft()),c=this.unproject(n.getTopRight());return new pt(a,c)},getMinZoom:function(){return this.options.minZoom===void 0?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===void 0?this._layersMaxZoom===void 0?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(n,a,c){n=ct(n),c=et(c||[0,0]);var _=this.getZoom()||0,E=this.getMinZoom(),R=this.getMaxZoom(),J=n.getNorthWest(),nt=n.getSouthEast(),st=this.getSize().subtract(c),dt=Q(this.project(nt,_),this.project(J,_)).getSize(),Mt=At.any3d?this.options.zoomSnap:1,Ot=st.x/dt.x,Gt=st.y/dt.y,De=a?Math.max(Ot,Gt):Math.min(Ot,Gt);return _=this.getScaleZoom(De,_),Mt&&(_=Math.round(_/(Mt/100))*(Mt/100),_=a?Math.ceil(_/Mt)*Mt:Math.floor(_/Mt)*Mt),Math.max(E,Math.min(R,_))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new W(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(n,a){var c=this._getTopLeftPoint(n,a);return new Y(c,c.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(n){return this.options.crs.getProjectedBounds(n===void 0?this.getZoom():n)},getPane:function(n){return typeof n=="string"?this._panes[n]:n},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(n,a){var c=this.options.crs;return a=a===void 0?this._zoom:a,c.scale(n)/c.scale(a)},getScaleZoom:function(n,a){var c=this.options.crs;a=a===void 0?this._zoom:a;var _=c.zoom(n*c.scale(a));return isNaN(_)?1/0:_},project:function(n,a){return a=a===void 0?this._zoom:a,this.options.crs.latLngToPoint(mt(n),a)},unproject:function(n,a){return a=a===void 0?this._zoom:a,this.options.crs.pointToLatLng(et(n),a)},layerPointToLatLng:function(n){var a=et(n).add(this.getPixelOrigin());return this.unproject(a)},latLngToLayerPoint:function(n){var a=this.project(mt(n))._round();return a._subtract(this.getPixelOrigin())},wrapLatLng:function(n){return this.options.crs.wrapLatLng(mt(n))},wrapLatLngBounds:function(n){return this.options.crs.wrapLatLngBounds(ct(n))},distance:function(n,a){return this.options.crs.distance(mt(n),mt(a))},containerPointToLayerPoint:function(n){return et(n).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(n){return et(n).add(this._getMapPanePos())},containerPointToLatLng:function(n){var a=this.containerPointToLayerPoint(et(n));return this.layerPointToLatLng(a)},latLngToContainerPoint:function(n){return this.layerPointToContainerPoint(this.latLngToLayerPoint(mt(n)))},mouseEventToContainerPoint:function(n){return go(n,this._container)},mouseEventToLayerPoint:function(n){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(n))},mouseEventToLatLng:function(n){return this.layerPointToLatLng(this.mouseEventToLayerPoint(n))},_initContainer:function(n){var a=this._container=ai(n);if(a){if(a._leaflet_id)throw new Error("Map container is already initialized.")}else throw new Error("Map container not found.");Rt(a,"scroll",this._onScroll,this),this._containerId=u(a)},_initLayout:function(){var n=this._container;this._fadeAnimated=this.options.fadeAnimation&&At.any3d,Ft(n,"leaflet-container"+(At.touch?" leaflet-touch":"")+(At.retina?" leaflet-retina":"")+(At.ielt9?" leaflet-oldie":"")+(At.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var a=Un(n,"position");a!=="absolute"&&a!=="relative"&&a!=="fixed"&&a!=="sticky"&&(n.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var n=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),ce(this._mapPane,new W(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(Ft(n.markerPane,"leaflet-zoom-hide"),Ft(n.shadowPane,"leaflet-zoom-hide"))},_resetView:function(n,a,c){ce(this._mapPane,new W(0,0));var _=!this._loaded;this._loaded=!0,a=this._limitZoom(a),this.fire("viewprereset");var E=this._zoom!==a;this._moveStart(E,c)._move(n,a)._moveEnd(E),this.fire("viewreset"),_&&this.fire("load")},_moveStart:function(n,a){return n&&this.fire("zoomstart"),a||this.fire("movestart"),this},_move:function(n,a,c,_){a===void 0&&(a=this._zoom);var E=this._zoom!==a;return this._zoom=a,this._lastCenter=n,this._pixelOrigin=this._getNewPixelOrigin(n),_?c&&c.pinch&&this.fire("zoom",c):((E||c&&c.pinch)&&this.fire("zoom",c),this.fire("move",c)),this},_moveEnd:function(n){return n&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return S(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(n){ce(this._mapPane,this._getMapPanePos().subtract(n))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(n){this._targets={},this._targets[u(this._container)]=this;var a=n?Kt:Rt;a(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&a(window,"resize",this._onResize,this),At.any3d&&this.options.transform3DLimit&&(n?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){S(this._resizeRequest),this._resizeRequest=F(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var n=this._getMapPanePos();Math.max(Math.abs(n.x),Math.abs(n.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(n,a){for(var c=[],_,E=a==="mouseout"||a==="mouseover",R=n.target||n.srcElement,J=!1;R;){if(_=this._targets[u(R)],_&&(a==="click"||a==="preclick")&&this._draggableMoved(_)){J=!0;break}if(_&&_.listens(a,!0)&&(E&&!gs(R,n)||(c.push(_),E))||R===this._container)break;R=R.parentNode}return!c.length&&!J&&!E&&this.listens(a,!0)&&(c=[this]),c},_isClickDisabled:function(n){for(;n&&n!==this._container;){if(n._leaflet_disable_click)return!0;n=n.parentNode}},_handleDOMEvent:function(n){var a=n.target||n.srcElement;if(!(!this._loaded||a._leaflet_disable_events||n.type==="click"&&this._isClickDisabled(a))){var c=n.type;c==="mousedown"&&Ri(a),this._fireDOMEvent(n,c)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(n,a,c){if(n.type==="click"){var _=i({},n);_.type="preclick",this._fireDOMEvent(_,_.type,c)}var E=this._findEventTargets(n,a);if(c){for(var R=[],J=0;J<c.length;J++)c[J].listens(a,!0)&&R.push(c[J]);E=R.concat(E)}if(E.length){a==="contextmenu"&&be(n);var nt=E[0],st={originalEvent:n};if(n.type!=="keypress"&&n.type!=="keydown"&&n.type!=="keyup"){var dt=nt.getLatLng&&(!nt._radius||nt._radius<=10);st.containerPoint=dt?this.latLngToContainerPoint(nt.getLatLng()):this.mouseEventToContainerPoint(n),st.layerPoint=this.containerPointToLayerPoint(st.containerPoint),st.latlng=dt?nt.getLatLng():this.layerPointToLatLng(st.layerPoint)}for(J=0;J<E.length;J++)if(E[J].fire(a,st,!0),st.originalEvent._stopped||E[J].options.bubblingMouseEvents===!1&&G(this._mouseEvents,a)!==-1)return}},_draggableMoved:function(n){return n=n.dragging&&n.dragging.enabled()?n:this,n.dragging&&n.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var n=0,a=this._handlers.length;n<a;n++)this._handlers[n].disable()},whenReady:function(n,a){return this._loaded?n.call(a||this,{target:this}):this.on("load",n,a),this},_getMapPanePos:function(){return qi(this._mapPane)||new W(0,0)},_moved:function(){var n=this._getMapPanePos();return n&&!n.equals([0,0])},_getTopLeftPoint:function(n,a){var c=n&&a!==void 0?this._getNewPixelOrigin(n,a):this.getPixelOrigin();return c.subtract(this._getMapPanePos())},_getNewPixelOrigin:function(n,a){var c=this.getSize()._divideBy(2);return this.project(n,a)._subtract(c)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(n,a,c){var _=this._getNewPixelOrigin(c,a);return this.project(n,a)._subtract(_)},_latLngBoundsToNewLayerBounds:function(n,a,c){var _=this._getNewPixelOrigin(c,a);return Q([this.project(n.getSouthWest(),a)._subtract(_),this.project(n.getNorthWest(),a)._subtract(_),this.project(n.getSouthEast(),a)._subtract(_),this.project(n.getNorthEast(),a)._subtract(_)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(n){return this.latLngToLayerPoint(n).subtract(this._getCenterLayerPoint())},_limitCenter:function(n,a,c){if(!c)return n;var _=this.project(n,a),E=this.getSize().divideBy(2),R=new Y(_.subtract(E),_.add(E)),J=this._getBoundsOffset(R,c,a);return Math.abs(J.x)<=1&&Math.abs(J.y)<=1?n:this.unproject(_.add(J),a)},_limitOffset:function(n,a){if(!a)return n;var c=this.getPixelBounds(),_=new Y(c.min.add(n),c.max.add(n));return n.add(this._getBoundsOffset(_,a))},_getBoundsOffset:function(n,a,c){var _=Q(this.project(a.getNorthEast(),c),this.project(a.getSouthWest(),c)),E=_.min.subtract(n.min),R=_.max.subtract(n.max),J=this._rebound(E.x,-R.x),nt=this._rebound(E.y,-R.y);return new W(J,nt)},_rebound:function(n,a){return n+a>0?Math.round(n-a)/2:Math.max(0,Math.ceil(n))-Math.max(0,Math.floor(a))},_limitZoom:function(n){var a=this.getMinZoom(),c=this.getMaxZoom(),_=At.any3d?this.options.zoomSnap:1;return _&&(n=Math.round(n/_)*_),Math.max(a,Math.min(c,n))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){ae(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(n,a){var c=this._getCenterOffset(n)._trunc();return(a&&a.animate)!==!0&&!this.getSize().contains(c)?!1:(this.panBy(c,a),!0)},_createAnimProxy:function(){var n=this._proxy=jt("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(n),this.on("zoomanim",function(a){var c=hs,_=this._proxy.style[c];we(this._proxy,this.project(a.center,a.zoom),this.getZoomScale(a.zoom,1)),_===this._proxy.style[c]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){re(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var n=this.getCenter(),a=this.getZoom();we(this._proxy,this.project(n,a),this.getZoomScale(a,1))},_catchTransitionEnd:function(n){this._animatingZoom&&n.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(n,a,c){if(this._animatingZoom)return!0;if(c=c||{},!this._zoomAnimated||c.animate===!1||this._nothingToAnimate()||Math.abs(a-this._zoom)>this.options.zoomAnimationThreshold)return!1;var _=this.getZoomScale(a),E=this._getCenterOffset(n)._divideBy(1-1/_);return c.animate!==!0&&!this.getSize().contains(E)?!1:(F(function(){this._moveStart(!0,c.noMoveStart||!1)._animateZoom(n,a,!0)},this),!0)},_animateZoom:function(n,a,c,_){this._mapPane&&(c&&(this._animatingZoom=!0,this._animateToCenter=n,this._animateToZoom=a,Ft(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:n,zoom:a,noUpdate:_}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(o(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&ae(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});function Ka(n,a){return new Vt(n,a)}var Re=v.extend({options:{position:"topright"},initialize:function(n){y(this,n)},getPosition:function(){return this.options.position},setPosition:function(n){var a=this._map;return a&&a.removeControl(this),this.options.position=n,a&&a.addControl(this),this},getContainer:function(){return this._container},addTo:function(n){this.remove(),this._map=n;var a=this._container=this.onAdd(n),c=this.getPosition(),_=n._controlCorners[c];return Ft(a,"leaflet-control"),c.indexOf("bottom")!==-1?_.insertBefore(a,_.firstChild):_.appendChild(a),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(re(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(n){this._map&&n&&n.screenX>0&&n.screenY>0&&this._map.getContainer().focus()}}),Vn=function(n){return new Re(n)};Vt.include({addControl:function(n){return n.addTo(this),this},removeControl:function(n){return n.remove(),this},_initControlPos:function(){var n=this._controlCorners={},a="leaflet-",c=this._controlContainer=jt("div",a+"control-container",this._container);function _(E,R){var J=a+E+" "+a+R;n[E+R]=jt("div",J,c)}_("top","left"),_("top","right"),_("bottom","left"),_("bottom","right")},_clearControlPos:function(){for(var n in this._controlCorners)re(this._controlCorners[n]);re(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var wo=Re.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(n,a,c,_){return c<_?-1:_<c?1:0}},initialize:function(n,a,c){y(this,c),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._preventClick=!1;for(var _ in n)this._addLayer(n[_],_);for(_ in a)this._addLayer(a[_],_,!0)},onAdd:function(n){this._initLayout(),this._update(),this._map=n,n.on("zoomend",this._checkDisabledLayers,this);for(var a=0;a<this._layers.length;a++)this._layers[a].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(n){return Re.prototype.addTo.call(this,n),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var n=0;n<this._layers.length;n++)this._layers[n].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(n,a){return this._addLayer(n,a),this._map?this._update():this},addOverlay:function(n,a){return this._addLayer(n,a,!0),this._map?this._update():this},removeLayer:function(n){n.off("add remove",this._onLayerChange,this);var a=this._getLayer(u(n));return a&&this._layers.splice(this._layers.indexOf(a),1),this._map?this._update():this},expand:function(){Ft(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var n=this._map.getSize().y-(this._container.offsetTop+50);return n<this._section.clientHeight?(Ft(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=n+"px"):ae(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return ae(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var n="leaflet-control-layers",a=this._container=jt("div",n),c=this.options.collapsed;a.setAttribute("aria-haspopup",!0),mn(a),_s(a);var _=this._section=jt("section",n+"-list");c&&(this._map.on("click",this.collapse,this),Rt(a,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var E=this._layersLink=jt("a",n+"-toggle",a);E.href="#",E.title="Layers",E.setAttribute("role","button"),Rt(E,{keydown:function(R){R.keyCode===13&&this._expandSafely()},click:function(R){be(R),this._expandSafely()}},this),c||this.expand(),this._baseLayersList=jt("div",n+"-base",_),this._separator=jt("div",n+"-separator",_),this._overlaysList=jt("div",n+"-overlays",_),a.appendChild(_)},_getLayer:function(n){for(var a=0;a<this._layers.length;a++)if(this._layers[a]&&u(this._layers[a].layer)===n)return this._layers[a]},_addLayer:function(n,a,c){this._map&&n.on("add remove",this._onLayerChange,this),this._layers.push({layer:n,name:a,overlay:c}),this.options.sortLayers&&this._layers.sort(o(function(_,E){return this.options.sortFunction(_.layer,E.layer,_.name,E.name)},this)),this.options.autoZIndex&&n.setZIndex&&(this._lastZIndex++,n.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;yr(this._baseLayersList),yr(this._overlaysList),this._layerControlInputs=[];var n,a,c,_,E=0;for(c=0;c<this._layers.length;c++)_=this._layers[c],this._addItem(_),a=a||_.overlay,n=n||!_.overlay,E+=_.overlay?0:1;return this.options.hideSingleBase&&(n=n&&E>1,this._baseLayersList.style.display=n?"":"none"),this._separator.style.display=a&&n?"":"none",this},_onLayerChange:function(n){this._handlingClick||this._update();var a=this._getLayer(u(n.target)),c=a.overlay?n.type==="add"?"overlayadd":"overlayremove":n.type==="add"?"baselayerchange":null;c&&this._map.fire(c,a)},_createRadioElement:function(n,a){var c='<input type="radio" class="leaflet-control-layers-selector" name="'+n+'"'+(a?' checked="checked"':"")+"/>",_=document.createElement("div");return _.innerHTML=c,_.firstChild},_addItem:function(n){var a=document.createElement("label"),c=this._map.hasLayer(n.layer),_;n.overlay?(_=document.createElement("input"),_.type="checkbox",_.className="leaflet-control-layers-selector",_.defaultChecked=c):_=this._createRadioElement("leaflet-base-layers_"+u(this),c),this._layerControlInputs.push(_),_.layerId=u(n.layer),Rt(_,"click",this._onInputClick,this);var E=document.createElement("span");E.innerHTML=" "+n.name;var R=document.createElement("span");a.appendChild(R),R.appendChild(_),R.appendChild(E);var J=n.overlay?this._overlaysList:this._baseLayersList;return J.appendChild(a),this._checkDisabledLayers(),a},_onInputClick:function(){if(!this._preventClick){var n=this._layerControlInputs,a,c,_=[],E=[];this._handlingClick=!0;for(var R=n.length-1;R>=0;R--)a=n[R],c=this._getLayer(a.layerId).layer,a.checked?_.push(c):a.checked||E.push(c);for(R=0;R<E.length;R++)this._map.hasLayer(E[R])&&this._map.removeLayer(E[R]);for(R=0;R<_.length;R++)this._map.hasLayer(_[R])||this._map.addLayer(_[R]);this._handlingClick=!1,this._refocusOnMap()}},_checkDisabledLayers:function(){for(var n=this._layerControlInputs,a,c,_=this._map.getZoom(),E=n.length-1;E>=0;E--)a=n[E],c=this._getLayer(a.layerId).layer,a.disabled=c.options.minZoom!==void 0&&_<c.options.minZoom||c.options.maxZoom!==void 0&&_>c.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var n=this._section;this._preventClick=!0,Rt(n,"click",be),this.expand();var a=this;setTimeout(function(){Kt(n,"click",be),a._preventClick=!1})}}),Qa=function(n,a,c){return new wo(n,a,c)},ys=Re.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(n){var a="leaflet-control-zoom",c=jt("div",a+" leaflet-bar"),_=this.options;return this._zoomInButton=this._createButton(_.zoomInText,_.zoomInTitle,a+"-in",c,this._zoomIn),this._zoomOutButton=this._createButton(_.zoomOutText,_.zoomOutTitle,a+"-out",c,this._zoomOut),this._updateDisabled(),n.on("zoomend zoomlevelschange",this._updateDisabled,this),c},onRemove:function(n){n.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(n){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(n.shiftKey?3:1))},_zoomOut:function(n){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(n.shiftKey?3:1))},_createButton:function(n,a,c,_,E){var R=jt("a",c,_);return R.innerHTML=n,R.href="#",R.title=a,R.setAttribute("role","button"),R.setAttribute("aria-label",a),mn(R),Rt(R,"click",Di),Rt(R,"click",E,this),Rt(R,"click",this._refocusOnMap,this),R},_updateDisabled:function(){var n=this._map,a="leaflet-disabled";ae(this._zoomInButton,a),ae(this._zoomOutButton,a),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||n._zoom===n.getMinZoom())&&(Ft(this._zoomOutButton,a),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||n._zoom===n.getMaxZoom())&&(Ft(this._zoomInButton,a),this._zoomInButton.setAttribute("aria-disabled","true"))}});Vt.mergeOptions({zoomControl:!0}),Vt.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new ys,this.addControl(this.zoomControl))});var th=function(n){return new ys(n)},bo=Re.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(n){var a="leaflet-control-scale",c=jt("div",a),_=this.options;return this._addScales(_,a+"-line",c),n.on(_.updateWhenIdle?"moveend":"move",this._update,this),n.whenReady(this._update,this),c},onRemove:function(n){n.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(n,a,c){n.metric&&(this._mScale=jt("div",a,c)),n.imperial&&(this._iScale=jt("div",a,c))},_update:function(){var n=this._map,a=n.getSize().y/2,c=n.distance(n.containerPointToLatLng([0,a]),n.containerPointToLatLng([this.options.maxWidth,a]));this._updateScales(c)},_updateScales:function(n){this.options.metric&&n&&this._updateMetric(n),this.options.imperial&&n&&this._updateImperial(n)},_updateMetric:function(n){var a=this._getRoundNum(n),c=a<1e3?a+" m":a/1e3+" km";this._updateScale(this._mScale,c,a/n)},_updateImperial:function(n){var a=n*3.2808399,c,_,E;a>5280?(c=a/5280,_=this._getRoundNum(c),this._updateScale(this._iScale,_+" mi",_/c)):(E=this._getRoundNum(a),this._updateScale(this._iScale,E+" ft",E/a))},_updateScale:function(n,a,c){n.style.width=Math.round(this.options.maxWidth*c)+"px",n.innerHTML=a},_getRoundNum:function(n){var a=Math.pow(10,(Math.floor(n)+"").length-1),c=n/a;return c=c>=10?10:c>=5?5:c>=3?3:c>=2?2:1,a*c}}),Lo=function(n){return new bo(n)},vs='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg>',xs=Re.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(At.inlineSvg?vs+" ":"")+"Leaflet</a>"},initialize:function(n){y(this,n),this._attributions={}},onAdd:function(n){n.attributionControl=this,this._container=jt("div","leaflet-control-attribution"),mn(this._container);for(var a in n._layers)n._layers[a].getAttribution&&this.addAttribution(n._layers[a].getAttribution());return this._update(),n.on("layeradd",this._addAttribution,this),this._container},onRemove:function(n){n.off("layeradd",this._addAttribution,this)},_addAttribution:function(n){n.layer.getAttribution&&(this.addAttribution(n.layer.getAttribution()),n.layer.once("remove",function(){this.removeAttribution(n.layer.getAttribution())},this))},setPrefix:function(n){return this.options.prefix=n,this._update(),this},addAttribution:function(n){return n?(this._attributions[n]||(this._attributions[n]=0),this._attributions[n]++,this._update(),this):this},removeAttribution:function(n){return n?(this._attributions[n]&&(this._attributions[n]--,this._update()),this):this},_update:function(){if(this._map){var n=[];for(var a in this._attributions)this._attributions[a]&&n.push(a);var c=[];this.options.prefix&&c.push(this.options.prefix),n.length&&c.push(n.join(", ")),this._container.innerHTML=c.join(' <span aria-hidden="true">|</span> ')}}});Vt.mergeOptions({attributionControl:!0}),Vt.addInitHook(function(){this.options.attributionControl&&new xs().addTo(this)});var eh=function(n){return new xs(n)};Re.Layers=wo,Re.Zoom=ys,Re.Scale=bo,Re.Attribution=xs,Vn.layers=Qa,Vn.zoom=th,Vn.scale=Lo,Vn.attribution=eh;var li=v.extend({initialize:function(n){this._map=n},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});li.addTo=function(n,a){return n.addHandler(a,this),this};var ih={Events:U},ws=At.touch?"touchstart mousedown":"mousedown",Bi=H.extend({options:{clickTolerance:3},initialize:function(n,a,c,_){y(this,_),this._element=n,this._dragStartTarget=a||n,this._preventOutline=c},enable:function(){this._enabled||(Rt(this._dragStartTarget,ws,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(Bi._dragging===this&&this.finishDrag(!0),Kt(this._dragStartTarget,ws,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(n){if(this._enabled&&(this._moved=!1,!ls(this._element,"leaflet-zoom-anim"))){if(n.touches&&n.touches.length!==1){Bi._dragging===this&&this.finishDrag();return}if(!(Bi._dragging||n.shiftKey||n.which!==1&&n.button!==1&&!n.touches)&&(Bi._dragging=this,this._preventOutline&&Ri(this._element),Hn(),Zn(),!this._moving)){this.fire("down");var a=n.touches?n.touches[0]:n,c=po(this._element);this._startPoint=new W(a.clientX,a.clientY),this._startPos=qi(this._element),this._parentScale=ds(c);var _=n.type==="mousedown";Rt(document,_?"mousemove":"touchmove",this._onMove,this),Rt(document,_?"mouseup":"touchend touchcancel",this._onUp,this)}}},_onMove:function(n){if(this._enabled){if(n.touches&&n.touches.length>1){this._moved=!0;return}var a=n.touches&&n.touches.length===1?n.touches[0]:n,c=new W(a.clientX,a.clientY)._subtract(this._startPoint);!c.x&&!c.y||Math.abs(c.x)+Math.abs(c.y)<this.options.clickTolerance||(c.x/=this._parentScale.x,c.y/=this._parentScale.y,be(n),this._moved||(this.fire("dragstart"),this._moved=!0,Ft(document.body,"leaflet-dragging"),this._lastTarget=n.target||n.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),Ft(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(c),this._moving=!0,this._lastEvent=n,this._updatePosition())}},_updatePosition:function(){var n={originalEvent:this._lastEvent};this.fire("predrag",n),ce(this._element,this._newPos),this.fire("drag",n)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(n){ae(document.body,"leaflet-dragging"),this._lastTarget&&(ae(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),Kt(document,"mousemove touchmove",this._onMove,this),Kt(document,"mouseup touchend touchcancel",this._onUp,this),wr(),Gn();var a=this._moved&&this._moving;this._moving=!1,Bi._dragging=!1,a&&this.fire("dragend",{noInertia:n,distance:this._newPos.distanceTo(this._startPos)})}});function Mo(n,a,c){var _,E=[1,4,2,8],R,J,nt,st,dt,Mt,Ot,Gt;for(R=0,Mt=n.length;R<Mt;R++)n[R]._code=Ji(n[R],a);for(nt=0;nt<4;nt++){for(Ot=E[nt],_=[],R=0,Mt=n.length,J=Mt-1;R<Mt;J=R++)st=n[R],dt=n[J],st._code&Ot?dt._code&Ot||(Gt=_n(dt,st,Ot,a,c),Gt._code=Ji(Gt,a),_.push(Gt)):(dt._code&Ot&&(Gt=_n(dt,st,Ot,a,c),Gt._code=Ji(Gt,a),_.push(Gt)),_.push(st));n=_}return n}function Eo(n,a){var c,_,E,R,J,nt,st,dt,Mt;if(!n||n.length===0)throw new Error("latlngs not passed");Ue(n)||(console.warn("latlngs are not flat! Only the first ring will be used"),n=n[0]);var Ot=mt([0,0]),Gt=ct(n),De=Gt.getNorthWest().distanceTo(Gt.getSouthWest())*Gt.getNorthEast().distanceTo(Gt.getNorthWest());De<1700&&(Ot=bs(n));var Ee=n.length,fi=[];for(c=0;c<Ee;c++){var Ge=mt(n[c]);fi.push(a.project(mt([Ge.lat-Ot.lat,Ge.lng-Ot.lng])))}for(nt=st=dt=0,c=0,_=Ee-1;c<Ee;_=c++)E=fi[c],R=fi[_],J=E.y*R.x-R.y*E.x,st+=(E.x+R.x)*J,dt+=(E.y+R.y)*J,nt+=J*3;nt===0?Mt=fi[0]:Mt=[st/nt,dt/nt];var Pr=a.unproject(et(Mt));return mt([Pr.lat+Ot.lat,Pr.lng+Ot.lng])}function bs(n){for(var a=0,c=0,_=0,E=0;E<n.length;E++){var R=mt(n[E]);a+=R.lat,c+=R.lng,_++}return mt([a/_,c/_])}var Lr={__proto__:null,clipPolygon:Mo,polygonCenter:Eo,centroid:bs};function To(n,a){if(!a||!n.length)return n.slice();var c=a*a;return n=nh(n,c),n=ui(n,c),n}function Xi(n,a,c){return Math.sqrt(qn(n,a,c,!0))}function So(n,a,c){return qn(n,a,c)}function ui(n,a){var c=n.length,_=typeof Uint8Array<"u"?Uint8Array:Array,E=new _(c);E[0]=E[c-1]=1,Ls(n,E,a,0,c-1);var R,J=[];for(R=0;R<c;R++)E[R]&&J.push(n[R]);return J}function Ls(n,a,c,_,E){var R=0,J,nt,st;for(nt=_+1;nt<=E-1;nt++)st=qn(n[nt],n[_],n[E],!0),st>R&&(J=nt,R=st);R>c&&(a[J]=1,Ls(n,a,c,_,J),Ls(n,a,c,J,E))}function nh(n,a){for(var c=[n[0]],_=1,E=0,R=n.length;_<R;_++)Mr(n[_],n[E])>a&&(c.push(n[_]),E=_);return E<R-1&&c.push(n[R-1]),c}var ko;function Ao(n,a,c,_,E){var R=_?ko:Ji(n,c),J=Ji(a,c),nt,st,dt;for(ko=J;;){if(!(R|J))return[n,a];if(R&J)return!1;nt=R||J,st=_n(n,a,nt,c,E),dt=Ji(st,c),nt===R?(n=st,R=dt):(a=st,J=dt)}}function _n(n,a,c,_,E){var R=a.x-n.x,J=a.y-n.y,nt=_.min,st=_.max,dt,Mt;return c&8?(dt=n.x+R*(st.y-n.y)/J,Mt=st.y):c&4?(dt=n.x+R*(nt.y-n.y)/J,Mt=nt.y):c&2?(dt=st.x,Mt=n.y+J*(st.x-n.x)/R):c&1&&(dt=nt.x,Mt=n.y+J*(nt.x-n.x)/R),new W(dt,Mt,E)}function Ji(n,a){var c=0;return n.x<a.min.x?c|=1:n.x>a.max.x&&(c|=2),n.y<a.min.y?c|=4:n.y>a.max.y&&(c|=8),c}function Mr(n,a){var c=a.x-n.x,_=a.y-n.y;return c*c+_*_}function qn(n,a,c,_){var E=a.x,R=a.y,J=c.x-E,nt=c.y-R,st=J*J+nt*nt,dt;return st>0&&(dt=((n.x-E)*J+(n.y-R)*nt)/st,dt>1?(E=c.x,R=c.y):dt>0&&(E+=J*dt,R+=nt*dt)),J=n.x-E,nt=n.y-R,_?J*J+nt*nt:new W(E,R)}function Ue(n){return!N(n[0])||typeof n[0][0]!="object"&&typeof n[0][0]<"u"}function Yn(n){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),Ue(n)}function Ms(n,a){var c,_,E,R,J,nt,st,dt;if(!n||n.length===0)throw new Error("latlngs not passed");Ue(n)||(console.warn("latlngs are not flat! Only the first ring will be used"),n=n[0]);var Mt=mt([0,0]),Ot=ct(n),Gt=Ot.getNorthWest().distanceTo(Ot.getSouthWest())*Ot.getNorthEast().distanceTo(Ot.getNorthWest());Gt<1700&&(Mt=bs(n));var De=n.length,Ee=[];for(c=0;c<De;c++){var fi=mt(n[c]);Ee.push(a.project(mt([fi.lat-Mt.lat,fi.lng-Mt.lng])))}for(c=0,_=0;c<De-1;c++)_+=Ee[c].distanceTo(Ee[c+1])/2;if(_===0)dt=Ee[0];else for(c=0,R=0;c<De-1;c++)if(J=Ee[c],nt=Ee[c+1],E=J.distanceTo(nt),R+=E,R>_){st=(R-_)/E,dt=[nt.x-st*(nt.x-J.x),nt.y-st*(nt.y-J.y)];break}var Ge=a.unproject(et(dt));return mt([Ge.lat+Mt.lat,Ge.lng+Mt.lng])}var Po={__proto__:null,simplify:To,pointToSegmentDistance:Xi,closestPointOnSegment:So,clipSegment:Ao,_getEdgeIntersection:_n,_getBitCode:Ji,_sqClosestPointOnSegment:qn,isFlat:Ue,_flat:Yn,polylineCenter:Ms},Es={project:function(n){return new W(n.lng,n.lat)},unproject:function(n){return new rt(n.y,n.x)},bounds:new Y([-180,-90],[180,90])},Ts={R:6378137,R_MINOR:6356752314245179e-9,bounds:new Y([-2003750834279e-5,-1549657073972e-5],[2003750834279e-5,1876465623138e-5]),project:function(n){var a=Math.PI/180,c=this.R,_=n.lat*a,E=this.R_MINOR/c,R=Math.sqrt(1-E*E),J=R*Math.sin(_),nt=Math.tan(Math.PI/4-_/2)/Math.pow((1-J)/(1+J),R/2);return _=-c*Math.log(Math.max(nt,1e-10)),new W(n.lng*a*c,_)},unproject:function(n){for(var a=180/Math.PI,c=this.R,_=this.R_MINOR/c,E=Math.sqrt(1-_*_),R=Math.exp(-n.y/c),J=Math.PI/2-2*Math.atan(R),nt=0,st=.1,dt;nt<15&&Math.abs(st)>1e-7;nt++)dt=E*Math.sin(J),dt=Math.pow((1-dt)/(1+dt),E/2),st=Math.PI/2-2*Math.atan(R*dt)-J,J+=st;return new rt(J*a,n.x*a/c)}},Er={__proto__:null,LonLat:Es,Mercator:Ts,SphericalMercator:wt},$i=i({},kt,{code:"EPSG:3395",projection:Ts,transformation:function(){var n=.5/(Math.PI*Ts.R);return ht(n,.5,-n,.5)}()}),Co=i({},kt,{code:"EPSG:4326",projection:Es,transformation:ht(1/180,1,-1/180,.5)}),zo=i({},St,{projection:Es,transformation:ht(1,0,-1,0),scale:function(n){return Math.pow(2,n)},zoom:function(n){return Math.log(n)/Math.LN2},distance:function(n,a){var c=a.lng-n.lng,_=a.lat-n.lat;return Math.sqrt(c*c+_*_)},infinite:!0});St.Earth=kt,St.EPSG3395=$i,St.EPSG3857=ft,St.EPSG900913=M,St.EPSG4326=Co,St.Simple=zo;var Pe=H.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(n){return n.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(n){return n&&n.removeLayer(this),this},getPane:function(n){return this._map.getPane(n?this.options[n]||n:this.options.pane)},addInteractiveTarget:function(n){return this._map._targets[u(n)]=this,this},removeInteractiveTarget:function(n){return delete this._map._targets[u(n)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(n){var a=n.target;if(a.hasLayer(this)){if(this._map=a,this._zoomAnimated=a._zoomAnimated,this.getEvents){var c=this.getEvents();a.on(c,this),this.once("remove",function(){a.off(c,this)},this)}this.onAdd(a),this.fire("add"),a.fire("layeradd",{layer:this})}}});Vt.include({addLayer:function(n){if(!n._layerAdd)throw new Error("The provided object is not a Layer.");var a=u(n);return this._layers[a]?this:(this._layers[a]=n,n._mapToAdd=this,n.beforeAdd&&n.beforeAdd(this),this.whenReady(n._layerAdd,n),this)},removeLayer:function(n){var a=u(n);return this._layers[a]?(this._loaded&&n.onRemove(this),delete this._layers[a],this._loaded&&(this.fire("layerremove",{layer:n}),n.fire("remove")),n._map=n._mapToAdd=null,this):this},hasLayer:function(n){return u(n)in this._layers},eachLayer:function(n,a){for(var c in this._layers)n.call(a,this._layers[c]);return this},_addLayers:function(n){n=n?N(n)?n:[n]:[];for(var a=0,c=n.length;a<c;a++)this.addLayer(n[a])},_addZoomLimit:function(n){(!isNaN(n.options.maxZoom)||!isNaN(n.options.minZoom))&&(this._zoomBoundLayers[u(n)]=n,this._updateZoomLevels())},_removeZoomLimit:function(n){var a=u(n);this._zoomBoundLayers[a]&&(delete this._zoomBoundLayers[a],this._updateZoomLevels())},_updateZoomLevels:function(){var n=1/0,a=-1/0,c=this._getZoomSpan();for(var _ in this._zoomBoundLayers){var E=this._zoomBoundLayers[_].options;n=E.minZoom===void 0?n:Math.min(n,E.minZoom),a=E.maxZoom===void 0?a:Math.max(a,E.maxZoom)}this._layersMaxZoom=a===-1/0?void 0:a,this._layersMinZoom=n===1/0?void 0:n,c!==this._getZoomSpan()&&this.fire("zoomlevelschange"),this.options.maxZoom===void 0&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),this.options.minZoom===void 0&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var gn=Pe.extend({initialize:function(n,a){y(this,a),this._layers={};var c,_;if(n)for(c=0,_=n.length;c<_;c++)this.addLayer(n[c])},addLayer:function(n){var a=this.getLayerId(n);return this._layers[a]=n,this._map&&this._map.addLayer(n),this},removeLayer:function(n){var a=n in this._layers?n:this.getLayerId(n);return this._map&&this._layers[a]&&this._map.removeLayer(this._layers[a]),delete this._layers[a],this},hasLayer:function(n){var a=typeof n=="number"?n:this.getLayerId(n);return a in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(n){var a=Array.prototype.slice.call(arguments,1),c,_;for(c in this._layers)_=this._layers[c],_[n]&&_[n].apply(_,a);return this},onAdd:function(n){this.eachLayer(n.addLayer,n)},onRemove:function(n){this.eachLayer(n.removeLayer,n)},eachLayer:function(n,a){for(var c in this._layers)n.call(a,this._layers[c]);return this},getLayer:function(n){return this._layers[n]},getLayers:function(){var n=[];return this.eachLayer(n.push,n),n},setZIndex:function(n){return this.invoke("setZIndex",n)},getLayerId:function(n){return u(n)}}),yn=function(n,a){return new gn(n,a)},Ce=gn.extend({addLayer:function(n){return this.hasLayer(n)?this:(n.addEventParent(this),gn.prototype.addLayer.call(this,n),this.fire("layeradd",{layer:n}))},removeLayer:function(n){return this.hasLayer(n)?(n in this._layers&&(n=this._layers[n]),n.removeEventParent(this),gn.prototype.removeLayer.call(this,n),this.fire("layerremove",{layer:n})):this},setStyle:function(n){return this.invoke("setStyle",n)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var n=new pt;for(var a in this._layers){var c=this._layers[a];n.extend(c.getBounds?c.getBounds():c.getLatLng())}return n}}),ke=function(n,a){return new Ce(n,a)},Ze=v.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(n){y(this,n)},createIcon:function(n){return this._createIcon("icon",n)},createShadow:function(n){return this._createIcon("shadow",n)},_createIcon:function(n,a){var c=this._getIconUrl(n);if(!c){if(n==="icon")throw new Error("iconUrl not set in Icon options (see the docs).");return null}var _=this._createImg(c,a&&a.tagName==="IMG"?a:null);return this._setIconStyles(_,n),(this.options.crossOrigin||this.options.crossOrigin==="")&&(_.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),_},_setIconStyles:function(n,a){var c=this.options,_=c[a+"Size"];typeof _=="number"&&(_=[_,_]);var E=et(_),R=et(a==="shadow"&&c.shadowAnchor||c.iconAnchor||E&&E.divideBy(2,!0));n.className="leaflet-marker-"+a+" "+(c.className||""),R&&(n.style.marginLeft=-R.x+"px",n.style.marginTop=-R.y+"px"),E&&(n.style.width=E.x+"px",n.style.height=E.y+"px")},_createImg:function(n,a){return a=a||document.createElement("img"),a.src=n,a},_getIconUrl:function(n){return At.retina&&this.options[n+"RetinaUrl"]||this.options[n+"Url"]}});function Ss(n){return new Ze(n)}var Ki=Ze.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(n){return typeof Ki.imagePath!="string"&&(Ki.imagePath=this._detectIconPath()),(this.options.imagePath||Ki.imagePath)+Ze.prototype._getIconUrl.call(this,n)},_stripUrl:function(n){var a=function(c,_,E){var R=_.exec(c);return R&&R[E]};return n=a(n,/^url\((['"])?(.+)\1\)$/,2),n&&a(n,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var n=jt("div","leaflet-default-icon-path",document.body),a=Un(n,"background-image")||Un(n,"backgroundImage");if(document.body.removeChild(n),a=this._stripUrl(a),a)return a;var c=document.querySelector('link[href$="leaflet.css"]');return c?c.href.substring(0,c.href.length-11-1):""}}),Io=li.extend({initialize:function(n){this._marker=n},addHooks:function(){var n=this._marker._icon;this._draggable||(this._draggable=new Bi(n,n,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),Ft(n,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&ae(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(n){var a=this._marker,c=a._map,_=this._marker.options.autoPanSpeed,E=this._marker.options.autoPanPadding,R=qi(a._icon),J=c.getPixelBounds(),nt=c.getPixelOrigin(),st=Q(J.min._subtract(nt).add(E),J.max._subtract(nt).subtract(E));if(!st.contains(R)){var dt=et((Math.max(st.max.x,R.x)-st.max.x)/(J.max.x-st.max.x)-(Math.min(st.min.x,R.x)-st.min.x)/(J.min.x-st.min.x),(Math.max(st.max.y,R.y)-st.max.y)/(J.max.y-st.max.y)-(Math.min(st.min.y,R.y)-st.min.y)/(J.min.y-st.min.y)).multiplyBy(_);c.panBy(dt,{animate:!1}),this._draggable._newPos._add(dt),this._draggable._startPos._add(dt),ce(a._icon,this._draggable._newPos),this._onDrag(n),this._panRequest=F(this._adjustPan.bind(this,n))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(n){this._marker.options.autoPan&&(S(this._panRequest),this._panRequest=F(this._adjustPan.bind(this,n)))},_onDrag:function(n){var a=this._marker,c=a._shadow,_=qi(a._icon),E=a._map.layerPointToLatLng(_);c&&ce(c,_),a._latlng=E,n.latlng=E,n.oldLatLng=this._oldLatLng,a.fire("move",n).fire("drag",n)},_onDragEnd:function(n){S(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",n)}}),Qi=Pe.extend({options:{icon:new Ki,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(n,a){y(this,a),this._latlng=mt(n)},onAdd:function(n){this._zoomAnimated=this._zoomAnimated&&n.options.markerZoomAnimation,this._zoomAnimated&&n.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(n){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&n.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(n){var a=this._latlng;return this._latlng=mt(n),this.update(),this.fire("move",{oldLatLng:a,latlng:this._latlng})},setZIndexOffset:function(n){return this.options.zIndexOffset=n,this.update()},getIcon:function(){return this.options.icon},setIcon:function(n){return this.options.icon=n,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var n=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(n)}return this},_initIcon:function(){var n=this.options,a="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),c=n.icon.createIcon(this._icon),_=!1;c!==this._icon&&(this._icon&&this._removeIcon(),_=!0,n.title&&(c.title=n.title),c.tagName==="IMG"&&(c.alt=n.alt||"")),Ft(c,a),n.keyboard&&(c.tabIndex="0",c.setAttribute("role","button")),this._icon=c,n.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&Rt(c,"focus",this._panOnFocus,this);var E=n.icon.createShadow(this._shadow),R=!1;E!==this._shadow&&(this._removeShadow(),R=!0),E&&(Ft(E,a),E.alt=""),this._shadow=E,n.opacity<1&&this._updateOpacity(),_&&this.getPane().appendChild(this._icon),this._initInteraction(),E&&R&&this.getPane(n.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&Kt(this._icon,"focus",this._panOnFocus,this),re(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&re(this._shadow),this._shadow=null},_setPos:function(n){this._icon&&ce(this._icon,n),this._shadow&&ce(this._shadow,n),this._zIndex=n.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(n){this._icon&&(this._icon.style.zIndex=this._zIndex+n)},_animateZoom:function(n){var a=this._map._latLngToNewLayerPoint(this._latlng,n.zoom,n.center).round();this._setPos(a)},_initInteraction:function(){if(this.options.interactive&&(Ft(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),Io)){var n=this.options.draggable;this.dragging&&(n=this.dragging.enabled(),this.dragging.disable()),this.dragging=new Io(this),n&&this.dragging.enable()}},setOpacity:function(n){return this.options.opacity=n,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var n=this.options.opacity;this._icon&&Se(this._icon,n),this._shadow&&Se(this._shadow,n)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var n=this._map;if(n){var a=this.options.icon.options,c=a.iconSize?et(a.iconSize):et(0,0),_=a.iconAnchor?et(a.iconAnchor):et(0,0);n.panInside(this._latlng,{paddingTopLeft:_,paddingBottomRight:c.subtract(_)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function Tr(n,a){return new Qi(n,a)}var pe=Pe.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(n){this._renderer=n.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(n){return y(this,n),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&n&&Object.prototype.hasOwnProperty.call(n,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),vi=pe.extend({options:{fill:!0,radius:10},initialize:function(n,a){y(this,a),this._latlng=mt(n),this._radius=this.options.radius},setLatLng:function(n){var a=this._latlng;return this._latlng=mt(n),this.redraw(),this.fire("move",{oldLatLng:a,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(n){return this.options.radius=this._radius=n,this.redraw()},getRadius:function(){return this._radius},setStyle:function(n){var a=n&&n.radius||this._radius;return pe.prototype.setStyle.call(this,n),this.setRadius(a),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var n=this._radius,a=this._radiusY||n,c=this._clickTolerance(),_=[n+c,a+c];this._pxBounds=new Y(this._point.subtract(_),this._point.add(_))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(n){return n.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function Oo(n,a){return new vi(n,a)}var vn=vi.extend({initialize:function(n,a,c){if(typeof a=="number"&&(a=i({},c,{radius:a})),y(this,a),this._latlng=mt(n),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(n){return this._mRadius=n,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var n=[this._radius,this._radiusY||this._radius];return new pt(this._map.layerPointToLatLng(this._point.subtract(n)),this._map.layerPointToLatLng(this._point.add(n)))},setStyle:pe.prototype.setStyle,_project:function(){var n=this._latlng.lng,a=this._latlng.lat,c=this._map,_=c.options.crs;if(_.distance===kt.distance){var E=Math.PI/180,R=this._mRadius/kt.R/E,J=c.project([a+R,n]),nt=c.project([a-R,n]),st=J.add(nt).divideBy(2),dt=c.unproject(st).lat,Mt=Math.acos((Math.cos(R*E)-Math.sin(a*E)*Math.sin(dt*E))/(Math.cos(a*E)*Math.cos(dt*E)))/E;(isNaN(Mt)||Mt===0)&&(Mt=R/Math.cos(Math.PI/180*a)),this._point=st.subtract(c.getPixelOrigin()),this._radius=isNaN(Mt)?0:st.x-c.project([dt,n-Mt]).x,this._radiusY=st.y-J.y}else{var Ot=_.unproject(_.project(this._latlng).subtract([this._mRadius,0]));this._point=c.latLngToLayerPoint(this._latlng),this._radius=this._point.x-c.latLngToLayerPoint(Ot).x}this._updateBounds()}});function Sr(n,a,c){return new vn(n,a,c)}var ci=pe.extend({options:{smoothFactor:1,noClip:!1},initialize:function(n,a){y(this,a),this._setLatLngs(n)},getLatLngs:function(){return this._latlngs},setLatLngs:function(n){return this._setLatLngs(n),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(n){for(var a=1/0,c=null,_=qn,E,R,J=0,nt=this._parts.length;J<nt;J++)for(var st=this._parts[J],dt=1,Mt=st.length;dt<Mt;dt++){E=st[dt-1],R=st[dt];var Ot=_(n,E,R,!0);Ot<a&&(a=Ot,c=_(n,E,R))}return c&&(c.distance=Math.sqrt(a)),c},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return Ms(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(n,a){return a=a||this._defaultShape(),n=mt(n),a.push(n),this._bounds.extend(n),this.redraw()},_setLatLngs:function(n){this._bounds=new pt,this._latlngs=this._convertLatLngs(n)},_defaultShape:function(){return Ue(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(n){for(var a=[],c=Ue(n),_=0,E=n.length;_<E;_++)c?(a[_]=mt(n[_]),this._bounds.extend(a[_])):a[_]=this._convertLatLngs(n[_]);return a},_project:function(){var n=new Y;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,n),this._bounds.isValid()&&n.isValid()&&(this._rawPxBounds=n,this._updateBounds())},_updateBounds:function(){var n=this._clickTolerance(),a=new W(n,n);this._rawPxBounds&&(this._pxBounds=new Y([this._rawPxBounds.min.subtract(a),this._rawPxBounds.max.add(a)]))},_projectLatlngs:function(n,a,c){var _=n[0]instanceof rt,E=n.length,R,J;if(_){for(J=[],R=0;R<E;R++)J[R]=this._map.latLngToLayerPoint(n[R]),c.extend(J[R]);a.push(J)}else for(R=0;R<E;R++)this._projectLatlngs(n[R],a,c)},_clipPoints:function(){var n=this._renderer._bounds;if(this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(n))){if(this.options.noClip){this._parts=this._rings;return}var a=this._parts,c,_,E,R,J,nt,st;for(c=0,E=0,R=this._rings.length;c<R;c++)for(st=this._rings[c],_=0,J=st.length;_<J-1;_++)nt=Ao(st[_],st[_+1],n,_,!0),nt&&(a[E]=a[E]||[],a[E].push(nt[0]),(nt[1]!==st[_+1]||_===J-2)&&(a[E].push(nt[1]),E++))}},_simplifyPoints:function(){for(var n=this._parts,a=this.options.smoothFactor,c=0,_=n.length;c<_;c++)n[c]=To(n[c],a)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(n,a){var c,_,E,R,J,nt,st=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(n))return!1;for(c=0,R=this._parts.length;c<R;c++)for(nt=this._parts[c],_=0,J=nt.length,E=J-1;_<J;E=_++)if(!(!a&&_===0)&&Xi(n,nt[E],nt[_])<=st)return!0;return!1}});function Ro(n,a){return new ci(n,a)}ci._flat=Yn;var tn=ci.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return Eo(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(n){var a=ci.prototype._convertLatLngs.call(this,n),c=a.length;return c>=2&&a[0]instanceof rt&&a[0].equals(a[c-1])&&a.pop(),a},_setLatLngs:function(n){ci.prototype._setLatLngs.call(this,n),Ue(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return Ue(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var n=this._renderer._bounds,a=this.options.weight,c=new W(a,a);if(n=new Y(n.min.subtract(c),n.max.add(c)),this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(n))){if(this.options.noClip){this._parts=this._rings;return}for(var _=0,E=this._rings.length,R;_<E;_++)R=Mo(this._rings[_],n,!0),R.length&&this._parts.push(R)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(n){var a=!1,c,_,E,R,J,nt,st,dt;if(!this._pxBounds||!this._pxBounds.contains(n))return!1;for(R=0,st=this._parts.length;R<st;R++)for(c=this._parts[R],J=0,dt=c.length,nt=dt-1;J<dt;nt=J++)_=c[J],E=c[nt],_.y>n.y!=E.y>n.y&&n.x<(E.x-_.x)*(n.y-_.y)/(E.y-_.y)+_.x&&(a=!a);return a||ci.prototype._containsPoint.call(this,n,!0)}});function Do(n,a){return new tn(n,a)}var Me=Ce.extend({initialize:function(n,a){y(this,a),this._layers={},n&&this.addData(n)},addData:function(n){var a=N(n)?n:n.features,c,_,E;if(a){for(c=0,_=a.length;c<_;c++)E=a[c],(E.geometries||E.geometry||E.features||E.coordinates)&&this.addData(E);return this}var R=this.options;if(R.filter&&!R.filter(n))return this;var J=jn(n,R);return J?(J.feature=w(n),J.defaultOptions=J.options,this.resetStyle(J),R.onEachFeature&&R.onEachFeature(n,J),this.addLayer(J)):this},resetStyle:function(n){return n===void 0?this.eachLayer(this.resetStyle,this):(n.options=i({},n.defaultOptions),this._setLayerStyle(n,this.options.style),this)},setStyle:function(n){return this.eachLayer(function(a){this._setLayerStyle(a,n)},this)},_setLayerStyle:function(n,a){n.setStyle&&(typeof a=="function"&&(a=a(n.feature)),n.setStyle(a))}});function jn(n,a){var c=n.type==="Feature"?n.geometry:n,_=c?c.coordinates:null,E=[],R=a&&a.pointToLayer,J=a&&a.coordsToLatLng||kr,nt,st,dt,Mt;if(!_&&!c)return null;switch(c.type){case"Point":return nt=J(_),Bo(R,n,nt,a);case"MultiPoint":for(dt=0,Mt=_.length;dt<Mt;dt++)nt=J(_[dt]),E.push(Bo(R,n,nt,a));return new Ce(E);case"LineString":case"MultiLineString":return st=xn(_,c.type==="LineString"?0:1,J),new ci(st,a);case"Polygon":case"MultiPolygon":return st=xn(_,c.type==="Polygon"?1:2,J),new tn(st,a);case"GeometryCollection":for(dt=0,Mt=c.geometries.length;dt<Mt;dt++){var Ot=jn({geometry:c.geometries[dt],type:"Feature",properties:n.properties},a);Ot&&E.push(Ot)}return new Ce(E);case"FeatureCollection":for(dt=0,Mt=c.features.length;dt<Mt;dt++){var Gt=jn(c.features[dt],a);Gt&&E.push(Gt)}return new Ce(E);default:throw new Error("Invalid GeoJSON object.")}}function Bo(n,a,c,_){return n?n(a,c):new Qi(c,_&&_.markersInheritOptions&&_)}function kr(n){return new rt(n[1],n[0],n[2])}function xn(n,a,c){for(var _=[],E=0,R=n.length,J;E<R;E++)J=a?xn(n[E],a-1,c):(c||kr)(n[E]),_.push(J);return _}function Ar(n,a){return n=mt(n),n.alt!==void 0?[g(n.lng,a),g(n.lat,a),g(n.alt,a)]:[g(n.lng,a),g(n.lat,a)]}function Xn(n,a,c,_){for(var E=[],R=0,J=n.length;R<J;R++)E.push(a?Xn(n[R],Ue(n[R])?0:a-1,c,_):Ar(n[R],_));return!a&&c&&E.length>0&&E.push(E[0].slice()),E}function en(n,a){return n.feature?i({},n.feature,{geometry:a}):w(a)}function w(n){return n.type==="Feature"||n.type==="FeatureCollection"?n:{type:"Feature",properties:{},geometry:n}}var D={toGeoJSON:function(n){return en(this,{type:"Point",coordinates:Ar(this.getLatLng(),n)})}};Qi.include(D),vn.include(D),vi.include(D),ci.include({toGeoJSON:function(n){var a=!Ue(this._latlngs),c=Xn(this._latlngs,a?1:0,!1,n);return en(this,{type:(a?"Multi":"")+"LineString",coordinates:c})}}),tn.include({toGeoJSON:function(n){var a=!Ue(this._latlngs),c=a&&!Ue(this._latlngs[0]),_=Xn(this._latlngs,c?2:a?1:0,!0,n);return a||(_=[_]),en(this,{type:(c?"Multi":"")+"Polygon",coordinates:_})}}),gn.include({toMultiPoint:function(n){var a=[];return this.eachLayer(function(c){a.push(c.toGeoJSON(n).geometry.coordinates)}),en(this,{type:"MultiPoint",coordinates:a})},toGeoJSON:function(n){var a=this.feature&&this.feature.geometry&&this.feature.geometry.type;if(a==="MultiPoint")return this.toMultiPoint(n);var c=a==="GeometryCollection",_=[];return this.eachLayer(function(E){if(E.toGeoJSON){var R=E.toGeoJSON(n);if(c)_.push(R.geometry);else{var J=w(R);J.type==="FeatureCollection"?_.push.apply(_,J.features):_.push(J)}}}),c?en(this,{geometries:_,type:"GeometryCollection"}):{type:"FeatureCollection",features:_}}});function j(n,a){return new Me(n,a)}var at=j,bt=Pe.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(n,a,c){this._url=n,this._bounds=ct(a),y(this,c)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(Ft(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){re(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(n){return this.options.opacity=n,this._image&&this._updateOpacity(),this},setStyle:function(n){return n.opacity&&this.setOpacity(n.opacity),this},bringToFront:function(){return this._map&&dn(this._image),this},bringToBack:function(){return this._map&&Ae(this._image),this},setUrl:function(n){return this._url=n,this._image&&(this._image.src=n),this},setBounds:function(n){return this._bounds=ct(n),this._map&&this._reset(),this},getEvents:function(){var n={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(n.zoomanim=this._animateZoom),n},setZIndex:function(n){return this.options.zIndex=n,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var n=this._url.tagName==="IMG",a=this._image=n?this._url:jt("img");if(Ft(a,"leaflet-image-layer"),this._zoomAnimated&&Ft(a,"leaflet-zoom-animated"),this.options.className&&Ft(a,this.options.className),a.onselectstart=p,a.onmousemove=p,a.onload=o(this.fire,this,"load"),a.onerror=o(this._overlayOnError,this,"error"),(this.options.crossOrigin||this.options.crossOrigin==="")&&(a.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),n){this._url=a.src;return}a.src=this._url,a.alt=this.options.alt},_animateZoom:function(n){var a=this._map.getZoomScale(n.zoom),c=this._map._latLngBoundsToNewLayerBounds(this._bounds,n.zoom,n.center).min;we(this._image,c,a)},_reset:function(){var n=this._image,a=new Y(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),c=a.getSize();ce(n,a.min),n.style.width=c.x+"px",n.style.height=c.y+"px"},_updateOpacity:function(){Se(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var n=this.options.errorOverlayUrl;n&&this._url!==n&&(this._url=n,this._image.src=n)},getCenter:function(){return this._bounds.getCenter()}}),yt=function(n,a,c){return new bt(n,a,c)},Lt=bt.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var n=this._url.tagName==="VIDEO",a=this._image=n?this._url:jt("video");if(Ft(a,"leaflet-image-layer"),this._zoomAnimated&&Ft(a,"leaflet-zoom-animated"),this.options.className&&Ft(a,this.options.className),a.onselectstart=p,a.onmousemove=p,a.onloadeddata=o(this.fire,this,"load"),n){for(var c=a.getElementsByTagName("source"),_=[],E=0;E<c.length;E++)_.push(c[E].src);this._url=c.length>0?_:[a.src];return}N(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(a.style,"objectFit")&&(a.style.objectFit="fill"),a.autoplay=!!this.options.autoplay,a.loop=!!this.options.loop,a.muted=!!this.options.muted,a.playsInline=!!this.options.playsInline;for(var R=0;R<this._url.length;R++){var J=jt("source");J.src=this._url[R],a.appendChild(J)}}});function Ct(n,a,c){return new Lt(n,a,c)}var Dt=bt.extend({_initImage:function(){var n=this._image=this._url;Ft(n,"leaflet-image-layer"),this._zoomAnimated&&Ft(n,"leaflet-zoom-animated"),this.options.className&&Ft(n,this.options.className),n.onselectstart=p,n.onmousemove=p}});function Qt(n,a,c){return new Dt(n,a,c)}var Ut=Pe.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(n,a){n&&(n instanceof rt||N(n))?(this._latlng=mt(n),y(this,a)):(y(this,n),this._source=a),this.options.content&&(this._content=this.options.content)},openOn:function(n){return n=arguments.length?n:this._source._map,n.hasLayer(this)||n.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(n){return this._map?this.close():(arguments.length?this._source=n:n=this._source,this._prepareOpen(),this.openOn(n._map)),this},onAdd:function(n){this._zoomAnimated=n._zoomAnimated,this._container||this._initLayout(),n._fadeAnimated&&Se(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),n._fadeAnimated&&Se(this._container,1),this.bringToFront(),this.options.interactive&&(Ft(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(n){n._fadeAnimated?(Se(this._container,0),this._removeTimeout=setTimeout(o(re,void 0,this._container),200)):re(this._container),this.options.interactive&&(ae(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(n){return this._latlng=mt(n),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(n){return this._content=n,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var n={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(n.zoomanim=this._animateZoom),n},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&dn(this._container),this},bringToBack:function(){return this._map&&Ae(this._container),this},_prepareOpen:function(n){var a=this._source;if(!a._map)return!1;if(a instanceof Ce){a=null;var c=this._source._layers;for(var _ in c)if(c[_]._map){a=c[_];break}if(!a)return!1;this._source=a}if(!n)if(a.getCenter)n=a.getCenter();else if(a.getLatLng)n=a.getLatLng();else if(a.getBounds)n=a.getBounds().getCenter();else throw new Error("Unable to get source layer LatLng.");return this.setLatLng(n),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var n=this._contentNode,a=typeof this._content=="function"?this._content(this._source||this):this._content;if(typeof a=="string")n.innerHTML=a;else{for(;n.hasChildNodes();)n.removeChild(n.firstChild);n.appendChild(a)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var n=this._map.latLngToLayerPoint(this._latlng),a=et(this.options.offset),c=this._getAnchor();this._zoomAnimated?ce(this._container,n.add(c)):a=a.add(n).add(c);var _=this._containerBottom=-a.y,E=this._containerLeft=-Math.round(this._containerWidth/2)+a.x;this._container.style.bottom=_+"px",this._container.style.left=E+"px"}},_getAnchor:function(){return[0,0]}});Vt.include({_initOverlay:function(n,a,c,_){var E=a;return E instanceof n||(E=new n(_).setContent(a)),c&&E.setLatLng(c),E}}),Pe.include({_initOverlay:function(n,a,c,_){var E=c;return E instanceof n?(y(E,_),E._source=this):(E=a&&!_?a:new n(_,this),E.setContent(c)),E}});var te=Ut.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(n){return n=arguments.length?n:this._source._map,!n.hasLayer(this)&&n._popup&&n._popup.options.autoClose&&n.removeLayer(n._popup),n._popup=this,Ut.prototype.openOn.call(this,n)},onAdd:function(n){Ut.prototype.onAdd.call(this,n),n.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof pe||this._source.on("preclick",ji))},onRemove:function(n){Ut.prototype.onRemove.call(this,n),n.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof pe||this._source.off("preclick",ji))},getEvents:function(){var n=Ut.prototype.getEvents.call(this);return(this.options.closeOnClick!==void 0?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(n.preclick=this.close),this.options.keepInView&&(n.moveend=this._adjustPan),n},_initLayout:function(){var n="leaflet-popup",a=this._container=jt("div",n+" "+(this.options.className||"")+" leaflet-zoom-animated"),c=this._wrapper=jt("div",n+"-content-wrapper",a);if(this._contentNode=jt("div",n+"-content",c),mn(a),_s(this._contentNode),Rt(a,"contextmenu",ji),this._tipContainer=jt("div",n+"-tip-container",a),this._tip=jt("div",n+"-tip",this._tipContainer),this.options.closeButton){var _=this._closeButton=jt("a",n+"-close-button",a);_.setAttribute("role","button"),_.setAttribute("aria-label","Close popup"),_.href="#close",_.innerHTML='<span aria-hidden="true">&#215;</span>',Rt(_,"click",function(E){be(E),this.close()},this)}},_updateLayout:function(){var n=this._contentNode,a=n.style;a.width="",a.whiteSpace="nowrap";var c=n.offsetWidth;c=Math.min(c,this.options.maxWidth),c=Math.max(c,this.options.minWidth),a.width=c+1+"px",a.whiteSpace="",a.height="";var _=n.offsetHeight,E=this.options.maxHeight,R="leaflet-popup-scrolled";E&&_>E?(a.height=E+"px",Ft(n,R)):ae(n,R),this._containerWidth=this._container.offsetWidth},_animateZoom:function(n){var a=this._map._latLngToNewLayerPoint(this._latlng,n.zoom,n.center),c=this._getAnchor();ce(this._container,a.add(c))},_adjustPan:function(){if(this.options.autoPan){if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning){this._autopanning=!1;return}var n=this._map,a=parseInt(Un(this._container,"marginBottom"),10)||0,c=this._container.offsetHeight+a,_=this._containerWidth,E=new W(this._containerLeft,-c-this._containerBottom);E._add(qi(this._container));var R=n.layerPointToContainerPoint(E),J=et(this.options.autoPanPadding),nt=et(this.options.autoPanPaddingTopLeft||J),st=et(this.options.autoPanPaddingBottomRight||J),dt=n.getSize(),Mt=0,Ot=0;R.x+_+st.x>dt.x&&(Mt=R.x+_-dt.x+st.x),R.x-Mt-nt.x<0&&(Mt=R.x-nt.x),R.y+c+st.y>dt.y&&(Ot=R.y+c-dt.y+st.y),R.y-Ot-nt.y<0&&(Ot=R.y-nt.y),(Mt||Ot)&&(this.options.keepInView&&(this._autopanning=!0),n.fire("autopanstart").panBy([Mt,Ot]))}},_getAnchor:function(){return et(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),me=function(n,a){return new te(n,a)};Vt.mergeOptions({closePopupOnClick:!0}),Vt.include({openPopup:function(n,a,c){return this._initOverlay(te,n,a,c).openOn(this),this},closePopup:function(n){return n=arguments.length?n:this._popup,n&&n.close(),this}}),Pe.include({bindPopup:function(n,a){return this._popup=this._initOverlay(te,this._popup,n,a),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(n){return this._popup&&(this instanceof Ce||(this._popup._source=this),this._popup._prepareOpen(n||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return this._popup?this._popup.isOpen():!1},setPopupContent:function(n){return this._popup&&this._popup.setContent(n),this},getPopup:function(){return this._popup},_openPopup:function(n){if(!(!this._popup||!this._map)){Di(n);var a=n.layer||n.target;if(this._popup._source===a&&!(a instanceof pe)){this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(n.latlng);return}this._popup._source=a,this.openPopup(n.latlng)}},_movePopup:function(n){this._popup.setLatLng(n.latlng)},_onKeyPress:function(n){n.originalEvent.keyCode===13&&this._openPopup(n)}});var de=Ut.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(n){Ut.prototype.onAdd.call(this,n),this.setOpacity(this.options.opacity),n.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(n){Ut.prototype.onRemove.call(this,n),n.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var n=Ut.prototype.getEvents.call(this);return this.options.permanent||(n.preclick=this.close),n},_initLayout:function(){var n="leaflet-tooltip",a=n+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=jt("div",a),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+u(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(n){var a,c,_=this._map,E=this._container,R=_.latLngToContainerPoint(_.getCenter()),J=_.layerPointToContainerPoint(n),nt=this.options.direction,st=E.offsetWidth,dt=E.offsetHeight,Mt=et(this.options.offset),Ot=this._getAnchor();nt==="top"?(a=st/2,c=dt):nt==="bottom"?(a=st/2,c=0):nt==="center"?(a=st/2,c=dt/2):nt==="right"?(a=0,c=dt/2):nt==="left"?(a=st,c=dt/2):J.x<R.x?(nt="right",a=0,c=dt/2):(nt="left",a=st+(Mt.x+Ot.x)*2,c=dt/2),n=n.subtract(et(a,c,!0)).add(Mt).add(Ot),ae(E,"leaflet-tooltip-right"),ae(E,"leaflet-tooltip-left"),ae(E,"leaflet-tooltip-top"),ae(E,"leaflet-tooltip-bottom"),Ft(E,"leaflet-tooltip-"+nt),ce(E,n)},_updatePosition:function(){var n=this._map.latLngToLayerPoint(this._latlng);this._setPosition(n)},setOpacity:function(n){this.options.opacity=n,this._container&&Se(this._container,n)},_animateZoom:function(n){var a=this._map._latLngToNewLayerPoint(this._latlng,n.zoom,n.center);this._setPosition(a)},_getAnchor:function(){return et(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),Le=function(n,a){return new de(n,a)};Vt.include({openTooltip:function(n,a,c){return this._initOverlay(de,n,a,c).openOn(this),this},closeTooltip:function(n){return n.close(),this}}),Pe.include({bindTooltip:function(n,a){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(de,this._tooltip,n,a),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(n){if(!(!n&&this._tooltipHandlersAdded)){var a=n?"off":"on",c={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?c.add=this._openTooltip:(c.mouseover=this._openTooltip,c.mouseout=this.closeTooltip,c.click=this._openTooltip,this._map?this._addFocusListeners():c.add=this._addFocusListeners),this._tooltip.options.sticky&&(c.mousemove=this._moveTooltip),this[a](c),this._tooltipHandlersAdded=!n}},openTooltip:function(n){return this._tooltip&&(this instanceof Ce||(this._tooltip._source=this),this._tooltip._prepareOpen(n)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(n){return this._tooltip&&this._tooltip.setContent(n),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(n){var a=typeof n.getElement=="function"&&n.getElement();a&&(Rt(a,"focus",function(){this._tooltip._source=n,this.openTooltip()},this),Rt(a,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(n){var a=typeof n.getElement=="function"&&n.getElement();a&&a.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(n){if(!(!this._tooltip||!this._map)){if(this._map.dragging&&this._map.dragging.moving()&&!this._openOnceFlag){this._openOnceFlag=!0;var a=this;this._map.once("moveend",function(){a._openOnceFlag=!1,a._openTooltip(n)});return}this._tooltip._source=n.layer||n.target,this.openTooltip(this._tooltip.options.sticky?n.latlng:void 0)}},_moveTooltip:function(n){var a=n.latlng,c,_;this._tooltip.options.sticky&&n.originalEvent&&(c=this._map.mouseEventToContainerPoint(n.originalEvent),_=this._map.containerPointToLayerPoint(c),a=this._map.layerPointToLatLng(_)),this._tooltip.setLatLng(a)}});var xi=Ze.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(n){var a=n&&n.tagName==="DIV"?n:document.createElement("div"),c=this.options;if(c.html instanceof Element?(yr(a),a.appendChild(c.html)):a.innerHTML=c.html!==!1?c.html:"",c.bgPos){var _=et(c.bgPos);a.style.backgroundPosition=-_.x+"px "+-_.y+"px"}return this._setIconStyles(a,"icon"),a},createShadow:function(){return null}});function wi(n){return new xi(n)}Ze.Default=Ki;var Xe=Pe.extend({options:{tileSize:256,opacity:1,updateWhenIdle:At.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(n){y(this,n)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(n){n._addZoomLimit(this)},onRemove:function(n){this._removeAllTiles(),re(this._container),n._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(dn(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(Ae(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(n){return this.options.opacity=n,this._updateOpacity(),this},setZIndex:function(n){return this.options.zIndex=n,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var n=this._clampZoom(this._map.getZoom());n!==this._tileZoom&&(this._tileZoom=n,this._updateLevels()),this._update()}return this},getEvents:function(){var n={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=f(this._onMoveEnd,this.options.updateInterval,this)),n.move=this._onMove),this._zoomAnimated&&(n.zoomanim=this._animateZoom),n},createTile:function(){return document.createElement("div")},getTileSize:function(){var n=this.options.tileSize;return n instanceof W?n:new W(n,n)},_updateZIndex:function(){this._container&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(n){for(var a=this.getPane().children,c=-n(-1/0,1/0),_=0,E=a.length,R;_<E;_++)R=a[_].style.zIndex,a[_]!==this._container&&R&&(c=n(c,+R));isFinite(c)&&(this.options.zIndex=c+n(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!At.ielt9){Se(this._container,this.options.opacity);var n=+new Date,a=!1,c=!1;for(var _ in this._tiles){var E=this._tiles[_];if(!(!E.current||!E.loaded)){var R=Math.min(1,(n-E.loaded)/200);Se(E.el,R),R<1?a=!0:(E.active?c=!0:this._onOpaqueTile(E),E.active=!0)}}c&&!this._noPrune&&this._pruneTiles(),a&&(S(this._fadeFrame),this._fadeFrame=F(this._updateOpacity,this))}},_onOpaqueTile:p,_initContainer:function(){this._container||(this._container=jt("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var n=this._tileZoom,a=this.options.maxZoom;if(n!==void 0){for(var c in this._levels)c=Number(c),this._levels[c].el.children.length||c===n?(this._levels[c].el.style.zIndex=a-Math.abs(n-c),this._onUpdateLevel(c)):(re(this._levels[c].el),this._removeTilesAtZoom(c),this._onRemoveLevel(c),delete this._levels[c]);var _=this._levels[n],E=this._map;return _||(_=this._levels[n]={},_.el=jt("div","leaflet-tile-container leaflet-zoom-animated",this._container),_.el.style.zIndex=a,_.origin=E.project(E.unproject(E.getPixelOrigin()),n).round(),_.zoom=n,this._setZoomTransform(_,E.getCenter(),E.getZoom()),p(_.el.offsetWidth),this._onCreateLevel(_)),this._level=_,_}},_onUpdateLevel:p,_onRemoveLevel:p,_onCreateLevel:p,_pruneTiles:function(){if(this._map){var n,a,c=this._map.getZoom();if(c>this.options.maxZoom||c<this.options.minZoom){this._removeAllTiles();return}for(n in this._tiles)a=this._tiles[n],a.retain=a.current;for(n in this._tiles)if(a=this._tiles[n],a.current&&!a.active){var _=a.coords;this._retainParent(_.x,_.y,_.z,_.z-5)||this._retainChildren(_.x,_.y,_.z,_.z+2)}for(n in this._tiles)this._tiles[n].retain||this._removeTile(n)}},_removeTilesAtZoom:function(n){for(var a in this._tiles)this._tiles[a].coords.z===n&&this._removeTile(a)},_removeAllTiles:function(){for(var n in this._tiles)this._removeTile(n)},_invalidateAll:function(){for(var n in this._levels)re(this._levels[n].el),this._onRemoveLevel(Number(n)),delete this._levels[n];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(n,a,c,_){var E=Math.floor(n/2),R=Math.floor(a/2),J=c-1,nt=new W(+E,+R);nt.z=+J;var st=this._tileCoordsToKey(nt),dt=this._tiles[st];return dt&&dt.active?(dt.retain=!0,!0):(dt&&dt.loaded&&(dt.retain=!0),J>_?this._retainParent(E,R,J,_):!1)},_retainChildren:function(n,a,c,_){for(var E=2*n;E<2*n+2;E++)for(var R=2*a;R<2*a+2;R++){var J=new W(E,R);J.z=c+1;var nt=this._tileCoordsToKey(J),st=this._tiles[nt];if(st&&st.active){st.retain=!0;continue}else st&&st.loaded&&(st.retain=!0);c+1<_&&this._retainChildren(E,R,c+1,_)}},_resetView:function(n){var a=n&&(n.pinch||n.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),a,a)},_animateZoom:function(n){this._setView(n.center,n.zoom,!0,n.noUpdate)},_clampZoom:function(n){var a=this.options;return a.minNativeZoom!==void 0&&n<a.minNativeZoom?a.minNativeZoom:a.maxNativeZoom!==void 0&&a.maxNativeZoom<n?a.maxNativeZoom:n},_setView:function(n,a,c,_){var E=Math.round(a);this.options.maxZoom!==void 0&&E>this.options.maxZoom||this.options.minZoom!==void 0&&E<this.options.minZoom?E=void 0:E=this._clampZoom(E);var R=this.options.updateWhenZooming&&E!==this._tileZoom;(!_||R)&&(this._tileZoom=E,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),E!==void 0&&this._update(n),c||this._pruneTiles(),this._noPrune=!!c),this._setZoomTransforms(n,a)},_setZoomTransforms:function(n,a){for(var c in this._levels)this._setZoomTransform(this._levels[c],n,a)},_setZoomTransform:function(n,a,c){var _=this._map.getZoomScale(c,n.zoom),E=n.origin.multiplyBy(_).subtract(this._map._getNewPixelOrigin(a,c)).round();At.any3d?we(n.el,E,_):ce(n.el,E)},_resetGrid:function(){var n=this._map,a=n.options.crs,c=this._tileSize=this.getTileSize(),_=this._tileZoom,E=this._map.getPixelWorldBounds(this._tileZoom);E&&(this._globalTileRange=this._pxBoundsToTileRange(E)),this._wrapX=a.wrapLng&&!this.options.noWrap&&[Math.floor(n.project([0,a.wrapLng[0]],_).x/c.x),Math.ceil(n.project([0,a.wrapLng[1]],_).x/c.y)],this._wrapY=a.wrapLat&&!this.options.noWrap&&[Math.floor(n.project([a.wrapLat[0],0],_).y/c.x),Math.ceil(n.project([a.wrapLat[1],0],_).y/c.y)]},_onMoveEnd:function(){!this._map||this._map._animatingZoom||this._update()},_getTiledPixelBounds:function(n){var a=this._map,c=a._animatingZoom?Math.max(a._animateToZoom,a.getZoom()):a.getZoom(),_=a.getZoomScale(c,this._tileZoom),E=a.project(n,this._tileZoom).floor(),R=a.getSize().divideBy(_*2);return new Y(E.subtract(R),E.add(R))},_update:function(n){var a=this._map;if(a){var c=this._clampZoom(a.getZoom());if(n===void 0&&(n=a.getCenter()),this._tileZoom!==void 0){var _=this._getTiledPixelBounds(n),E=this._pxBoundsToTileRange(_),R=E.getCenter(),J=[],nt=this.options.keepBuffer,st=new Y(E.getBottomLeft().subtract([nt,-nt]),E.getTopRight().add([nt,-nt]));if(!(isFinite(E.min.x)&&isFinite(E.min.y)&&isFinite(E.max.x)&&isFinite(E.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var dt in this._tiles){var Mt=this._tiles[dt].coords;(Mt.z!==this._tileZoom||!st.contains(new W(Mt.x,Mt.y)))&&(this._tiles[dt].current=!1)}if(Math.abs(c-this._tileZoom)>1){this._setView(n,c);return}for(var Ot=E.min.y;Ot<=E.max.y;Ot++)for(var Gt=E.min.x;Gt<=E.max.x;Gt++){var De=new W(Gt,Ot);if(De.z=this._tileZoom,!!this._isValidTile(De)){var Ee=this._tiles[this._tileCoordsToKey(De)];Ee?Ee.current=!0:J.push(De)}}if(J.sort(function(Ge,Pr){return Ge.distanceTo(R)-Pr.distanceTo(R)}),J.length!==0){this._loading||(this._loading=!0,this.fire("loading"));var fi=document.createDocumentFragment();for(Gt=0;Gt<J.length;Gt++)this._addTile(J[Gt],fi);this._level.el.appendChild(fi)}}}},_isValidTile:function(n){var a=this._map.options.crs;if(!a.infinite){var c=this._globalTileRange;if(!a.wrapLng&&(n.x<c.min.x||n.x>c.max.x)||!a.wrapLat&&(n.y<c.min.y||n.y>c.max.y))return!1}if(!this.options.bounds)return!0;var _=this._tileCoordsToBounds(n);return ct(this.options.bounds).overlaps(_)},_keyToBounds:function(n){return this._tileCoordsToBounds(this._keyToTileCoords(n))},_tileCoordsToNwSe:function(n){var a=this._map,c=this.getTileSize(),_=n.scaleBy(c),E=_.add(c),R=a.unproject(_,n.z),J=a.unproject(E,n.z);return[R,J]},_tileCoordsToBounds:function(n){var a=this._tileCoordsToNwSe(n),c=new pt(a[0],a[1]);return this.options.noWrap||(c=this._map.wrapLatLngBounds(c)),c},_tileCoordsToKey:function(n){return n.x+":"+n.y+":"+n.z},_keyToTileCoords:function(n){var a=n.split(":"),c=new W(+a[0],+a[1]);return c.z=+a[2],c},_removeTile:function(n){var a=this._tiles[n];a&&(re(a.el),delete this._tiles[n],this.fire("tileunload",{tile:a.el,coords:this._keyToTileCoords(n)}))},_initTile:function(n){Ft(n,"leaflet-tile");var a=this.getTileSize();n.style.width=a.x+"px",n.style.height=a.y+"px",n.onselectstart=p,n.onmousemove=p,At.ielt9&&this.options.opacity<1&&Se(n,this.options.opacity)},_addTile:function(n,a){var c=this._getTilePos(n),_=this._tileCoordsToKey(n),E=this.createTile(this._wrapCoords(n),o(this._tileReady,this,n));this._initTile(E),this.createTile.length<2&&F(o(this._tileReady,this,n,null,E)),ce(E,c),this._tiles[_]={el:E,coords:n,current:!0},a.appendChild(E),this.fire("tileloadstart",{tile:E,coords:n})},_tileReady:function(n,a,c){a&&this.fire("tileerror",{error:a,tile:c,coords:n});var _=this._tileCoordsToKey(n);c=this._tiles[_],c&&(c.loaded=+new Date,this._map._fadeAnimated?(Se(c.el,0),S(this._fadeFrame),this._fadeFrame=F(this._updateOpacity,this)):(c.active=!0,this._pruneTiles()),a||(Ft(c.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:c.el,coords:n})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),At.ielt9||!this._map._fadeAnimated?F(this._pruneTiles,this):setTimeout(o(this._pruneTiles,this),250)))},_getTilePos:function(n){return n.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(n){var a=new W(this._wrapX?d(n.x,this._wrapX):n.x,this._wrapY?d(n.y,this._wrapY):n.y);return a.z=n.z,a},_pxBoundsToTileRange:function(n){var a=this.getTileSize();return new Y(n.min.unscaleBy(a).floor(),n.max.unscaleBy(a).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var n in this._tiles)if(!this._tiles[n].loaded)return!1;return!0}});function No(n){return new Xe(n)}var bi=Xe.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(n,a){this._url=n,a=y(this,a),a.detectRetina&&At.retina&&a.maxZoom>0?(a.tileSize=Math.floor(a.tileSize/2),a.zoomReverse?(a.zoomOffset--,a.minZoom=Math.min(a.maxZoom,a.minZoom+1)):(a.zoomOffset++,a.maxZoom=Math.max(a.minZoom,a.maxZoom-1)),a.minZoom=Math.max(0,a.minZoom)):a.zoomReverse?a.minZoom=Math.min(a.maxZoom,a.minZoom):a.maxZoom=Math.max(a.minZoom,a.maxZoom),typeof a.subdomains=="string"&&(a.subdomains=a.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(n,a){return this._url===n&&a===void 0&&(a=!0),this._url=n,a||this.redraw(),this},createTile:function(n,a){var c=document.createElement("img");return Rt(c,"load",o(this._tileOnLoad,this,a,c)),Rt(c,"error",o(this._tileOnError,this,a,c)),(this.options.crossOrigin||this.options.crossOrigin==="")&&(c.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),typeof this.options.referrerPolicy=="string"&&(c.referrerPolicy=this.options.referrerPolicy),c.alt="",c.src=this.getTileUrl(n),c},getTileUrl:function(n){var a={r:At.retina?"@2x":"",s:this._getSubdomain(n),x:n.x,y:n.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var c=this._globalTileRange.max.y-n.y;this.options.tms&&(a.y=c),a["-y"]=c}return A(this._url,i(a,this.options))},_tileOnLoad:function(n,a){At.ielt9?setTimeout(o(n,this,null,a),0):n(null,a)},_tileOnError:function(n,a,c){var _=this.options.errorTileUrl;_&&a.getAttribute("src")!==_&&(a.src=_),n(c,a)},_onTileRemove:function(n){n.tile.onload=null},_getZoomForUrl:function(){var n=this._tileZoom,a=this.options.maxZoom,c=this.options.zoomReverse,_=this.options.zoomOffset;return c&&(n=a-n),n+_},_getSubdomain:function(n){var a=Math.abs(n.x+n.y)%this.options.subdomains.length;return this.options.subdomains[a]},_abortLoading:function(){var n,a;for(n in this._tiles)if(this._tiles[n].coords.z!==this._tileZoom&&(a=this._tiles[n].el,a.onload=p,a.onerror=p,!a.complete)){a.src=z;var c=this._tiles[n].coords;re(a),delete this._tiles[n],this.fire("tileabort",{tile:a,coords:c})}},_removeTile:function(n){var a=this._tiles[n];if(a)return a.el.setAttribute("src",z),Xe.prototype._removeTile.call(this,n)},_tileReady:function(n,a,c){if(!(!this._map||c&&c.getAttribute("src")===z))return Xe.prototype._tileReady.call(this,n,a,c)}});function Jn(n,a){return new bi(n,a)}var Al=bi.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(n,a){this._url=n;var c=i({},this.defaultWmsParams);for(var _ in a)_ in this.options||(c[_]=a[_]);a=y(this,a);var E=a.detectRetina&&At.retina?2:1,R=this.getTileSize();c.width=R.x*E,c.height=R.y*E,this.wmsParams=c},onAdd:function(n){this._crs=this.options.crs||n.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var a=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[a]=this._crs.code,bi.prototype.onAdd.call(this,n)},getTileUrl:function(n){var a=this._tileCoordsToNwSe(n),c=this._crs,_=Q(c.project(a[0]),c.project(a[1])),E=_.min,R=_.max,J=(this._wmsVersion>=1.3&&this._crs===Co?[E.y,E.x,R.y,R.x]:[E.x,E.y,R.x,R.y]).join(","),nt=bi.prototype.getTileUrl.call(this,n);return nt+b(this.wmsParams,nt,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+J},setParams:function(n,a){return i(this.wmsParams,n),a||this.redraw(),this}});function pf(n,a){return new Al(n,a)}bi.WMS=Al,Jn.wms=pf;var nn=Pe.extend({options:{padding:.1},initialize:function(n){y(this,n),u(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),Ft(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var n={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(n.zoomanim=this._onAnimZoom),n},_onAnimZoom:function(n){this._updateTransform(n.center,n.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(n,a){var c=this._map.getZoomScale(a,this._zoom),_=this._map.getSize().multiplyBy(.5+this.options.padding),E=this._map.project(this._center,a),R=_.multiplyBy(-c).add(E).subtract(this._map._getNewPixelOrigin(n,a));At.any3d?we(this._container,R,c):ce(this._container,R)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var n in this._layers)this._layers[n]._reset()},_onZoomEnd:function(){for(var n in this._layers)this._layers[n]._project()},_updatePaths:function(){for(var n in this._layers)this._layers[n]._update()},_update:function(){var n=this.options.padding,a=this._map.getSize(),c=this._map.containerPointToLayerPoint(a.multiplyBy(-n)).round();this._bounds=new Y(c,c.add(a.multiplyBy(1+n*2)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),Pl=nn.extend({options:{tolerance:0},getEvents:function(){var n=nn.prototype.getEvents.call(this);return n.viewprereset=this._onViewPreReset,n},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){nn.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var n=this._container=document.createElement("canvas");Rt(n,"mousemove",this._onMouseMove,this),Rt(n,"click dblclick mousedown mouseup contextmenu",this._onClick,this),Rt(n,"mouseout",this._handleMouseOut,this),n._leaflet_disable_events=!0,this._ctx=n.getContext("2d")},_destroyContainer:function(){S(this._redrawRequest),delete this._ctx,re(this._container),Kt(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){var n;this._redrawBounds=null;for(var a in this._layers)n=this._layers[a],n._update();this._redraw()}},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){nn.prototype._update.call(this);var n=this._bounds,a=this._container,c=n.getSize(),_=At.retina?2:1;ce(a,n.min),a.width=_*c.x,a.height=_*c.y,a.style.width=c.x+"px",a.style.height=c.y+"px",At.retina&&this._ctx.scale(2,2),this._ctx.translate(-n.min.x,-n.min.y),this.fire("update")}},_reset:function(){nn.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(n){this._updateDashArray(n),this._layers[u(n)]=n;var a=n._order={layer:n,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=a),this._drawLast=a,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(n){this._requestRedraw(n)},_removePath:function(n){var a=n._order,c=a.next,_=a.prev;c?c.prev=_:this._drawLast=_,_?_.next=c:this._drawFirst=c,delete n._order,delete this._layers[u(n)],this._requestRedraw(n)},_updatePath:function(n){this._extendRedrawBounds(n),n._project(),n._update(),this._requestRedraw(n)},_updateStyle:function(n){this._updateDashArray(n),this._requestRedraw(n)},_updateDashArray:function(n){if(typeof n.options.dashArray=="string"){var a=n.options.dashArray.split(/[, ]+/),c=[],_,E;for(E=0;E<a.length;E++){if(_=Number(a[E]),isNaN(_))return;c.push(_)}n.options._dashArray=c}else n.options._dashArray=n.options.dashArray},_requestRedraw:function(n){this._map&&(this._extendRedrawBounds(n),this._redrawRequest=this._redrawRequest||F(this._redraw,this))},_extendRedrawBounds:function(n){if(n._pxBounds){var a=(n.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new Y,this._redrawBounds.extend(n._pxBounds.min.subtract([a,a])),this._redrawBounds.extend(n._pxBounds.max.add([a,a]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var n=this._redrawBounds;if(n){var a=n.getSize();this._ctx.clearRect(n.min.x,n.min.y,a.x,a.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var n,a=this._redrawBounds;if(this._ctx.save(),a){var c=a.getSize();this._ctx.beginPath(),this._ctx.rect(a.min.x,a.min.y,c.x,c.y),this._ctx.clip()}this._drawing=!0;for(var _=this._drawFirst;_;_=_.next)n=_.layer,(!a||n._pxBounds&&n._pxBounds.intersects(a))&&n._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(n,a){if(this._drawing){var c,_,E,R,J=n._parts,nt=J.length,st=this._ctx;if(nt){for(st.beginPath(),c=0;c<nt;c++){for(_=0,E=J[c].length;_<E;_++)R=J[c][_],st[_?"lineTo":"moveTo"](R.x,R.y);a&&st.closePath()}this._fillStroke(st,n)}}},_updateCircle:function(n){if(!(!this._drawing||n._empty())){var a=n._point,c=this._ctx,_=Math.max(Math.round(n._radius),1),E=(Math.max(Math.round(n._radiusY),1)||_)/_;E!==1&&(c.save(),c.scale(1,E)),c.beginPath(),c.arc(a.x,a.y/E,_,0,Math.PI*2,!1),E!==1&&c.restore(),this._fillStroke(c,n)}},_fillStroke:function(n,a){var c=a.options;c.fill&&(n.globalAlpha=c.fillOpacity,n.fillStyle=c.fillColor||c.color,n.fill(c.fillRule||"evenodd")),c.stroke&&c.weight!==0&&(n.setLineDash&&n.setLineDash(a.options&&a.options._dashArray||[]),n.globalAlpha=c.opacity,n.lineWidth=c.weight,n.strokeStyle=c.color,n.lineCap=c.lineCap,n.lineJoin=c.lineJoin,n.stroke())},_onClick:function(n){for(var a=this._map.mouseEventToLayerPoint(n),c,_,E=this._drawFirst;E;E=E.next)c=E.layer,c.options.interactive&&c._containsPoint(a)&&(!(n.type==="click"||n.type==="preclick")||!this._map._draggableMoved(c))&&(_=c);this._fireEvent(_?[_]:!1,n)},_onMouseMove:function(n){if(!(!this._map||this._map.dragging.moving()||this._map._animatingZoom)){var a=this._map.mouseEventToLayerPoint(n);this._handleMouseHover(n,a)}},_handleMouseOut:function(n){var a=this._hoveredLayer;a&&(ae(this._container,"leaflet-interactive"),this._fireEvent([a],n,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(n,a){if(!this._mouseHoverThrottled){for(var c,_,E=this._drawFirst;E;E=E.next)c=E.layer,c.options.interactive&&c._containsPoint(a)&&(_=c);_!==this._hoveredLayer&&(this._handleMouseOut(n),_&&(Ft(this._container,"leaflet-interactive"),this._fireEvent([_],n,"mouseover"),this._hoveredLayer=_)),this._fireEvent(this._hoveredLayer?[this._hoveredLayer]:!1,n),this._mouseHoverThrottled=!0,setTimeout(o(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(n,a,c){this._map._fireDOMEvent(a,c||a.type,n)},_bringToFront:function(n){var a=n._order;if(a){var c=a.next,_=a.prev;if(c)c.prev=_;else return;_?_.next=c:c&&(this._drawFirst=c),a.prev=this._drawLast,this._drawLast.next=a,a.next=null,this._drawLast=a,this._requestRedraw(n)}},_bringToBack:function(n){var a=n._order;if(a){var c=a.next,_=a.prev;if(_)_.next=c;else return;c?c.prev=_:_&&(this._drawLast=_),a.prev=null,a.next=this._drawFirst,this._drawFirst.prev=a,this._drawFirst=a,this._requestRedraw(n)}}});function Cl(n){return At.canvas?new Pl(n):null}var ks=function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(n){return document.createElement("<lvml:"+n+' class="lvml">')}}catch{}return function(n){return document.createElement("<"+n+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}(),mf={_initContainer:function(){this._container=jt("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(nn.prototype._update.call(this),this.fire("update"))},_initPath:function(n){var a=n._container=ks("shape");Ft(a,"leaflet-vml-shape "+(this.options.className||"")),a.coordsize="1 1",n._path=ks("path"),a.appendChild(n._path),this._updateStyle(n),this._layers[u(n)]=n},_addPath:function(n){var a=n._container;this._container.appendChild(a),n.options.interactive&&n.addInteractiveTarget(a)},_removePath:function(n){var a=n._container;re(a),n.removeInteractiveTarget(a),delete this._layers[u(n)]},_updateStyle:function(n){var a=n._stroke,c=n._fill,_=n.options,E=n._container;E.stroked=!!_.stroke,E.filled=!!_.fill,_.stroke?(a||(a=n._stroke=ks("stroke")),E.appendChild(a),a.weight=_.weight+"px",a.color=_.color,a.opacity=_.opacity,_.dashArray?a.dashStyle=N(_.dashArray)?_.dashArray.join(" "):_.dashArray.replace(/( *, *)/g," "):a.dashStyle="",a.endcap=_.lineCap.replace("butt","flat"),a.joinstyle=_.lineJoin):a&&(E.removeChild(a),n._stroke=null),_.fill?(c||(c=n._fill=ks("fill")),E.appendChild(c),c.color=_.fillColor||_.color,c.opacity=_.fillOpacity):c&&(E.removeChild(c),n._fill=null)},_updateCircle:function(n){var a=n._point.round(),c=Math.round(n._radius),_=Math.round(n._radiusY||c);this._setPath(n,n._empty()?"M0 0":"AL "+a.x+","+a.y+" "+c+","+_+" 0,"+65535*360)},_setPath:function(n,a){n._path.v=a},_bringToFront:function(n){dn(n._container)},_bringToBack:function(n){Ae(n._container)}},Fo=At.vml?ks:tt,As=nn.extend({_initContainer:function(){this._container=Fo("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=Fo("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){re(this._container),Kt(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){nn.prototype._update.call(this);var n=this._bounds,a=n.getSize(),c=this._container;(!this._svgSize||!this._svgSize.equals(a))&&(this._svgSize=a,c.setAttribute("width",a.x),c.setAttribute("height",a.y)),ce(c,n.min),c.setAttribute("viewBox",[n.min.x,n.min.y,a.x,a.y].join(" ")),this.fire("update")}},_initPath:function(n){var a=n._path=Fo("path");n.options.className&&Ft(a,n.options.className),n.options.interactive&&Ft(a,"leaflet-interactive"),this._updateStyle(n),this._layers[u(n)]=n},_addPath:function(n){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(n._path),n.addInteractiveTarget(n._path)},_removePath:function(n){re(n._path),n.removeInteractiveTarget(n._path),delete this._layers[u(n)]},_updatePath:function(n){n._project(),n._update()},_updateStyle:function(n){var a=n._path,c=n.options;a&&(c.stroke?(a.setAttribute("stroke",c.color),a.setAttribute("stroke-opacity",c.opacity),a.setAttribute("stroke-width",c.weight),a.setAttribute("stroke-linecap",c.lineCap),a.setAttribute("stroke-linejoin",c.lineJoin),c.dashArray?a.setAttribute("stroke-dasharray",c.dashArray):a.removeAttribute("stroke-dasharray"),c.dashOffset?a.setAttribute("stroke-dashoffset",c.dashOffset):a.removeAttribute("stroke-dashoffset")):a.setAttribute("stroke","none"),c.fill?(a.setAttribute("fill",c.fillColor||c.color),a.setAttribute("fill-opacity",c.fillOpacity),a.setAttribute("fill-rule",c.fillRule||"evenodd")):a.setAttribute("fill","none"))},_updatePoly:function(n,a){this._setPath(n,$(n._parts,a))},_updateCircle:function(n){var a=n._point,c=Math.max(Math.round(n._radius),1),_=Math.max(Math.round(n._radiusY),1)||c,E="a"+c+","+_+" 0 1,0 ",R=n._empty()?"M0 0":"M"+(a.x-c)+","+a.y+E+c*2+",0 "+E+-c*2+",0 ";this._setPath(n,R)},_setPath:function(n,a){n._path.setAttribute("d",a)},_bringToFront:function(n){dn(n._path)},_bringToBack:function(n){Ae(n._path)}});At.vml&&As.include(mf);function zl(n){return At.svg||At.vml?new As(n):null}Vt.include({getRenderer:function(n){var a=n.options.renderer||this._getPaneRenderer(n.options.pane)||this.options.renderer||this._renderer;return a||(a=this._renderer=this._createRenderer()),this.hasLayer(a)||this.addLayer(a),a},_getPaneRenderer:function(n){if(n==="overlayPane"||n===void 0)return!1;var a=this._paneRenderers[n];return a===void 0&&(a=this._createRenderer({pane:n}),this._paneRenderers[n]=a),a},_createRenderer:function(n){return this.options.preferCanvas&&Cl(n)||zl(n)}});var Il=tn.extend({initialize:function(n,a){tn.prototype.initialize.call(this,this._boundsToLatLngs(n),a)},setBounds:function(n){return this.setLatLngs(this._boundsToLatLngs(n))},_boundsToLatLngs:function(n){return n=ct(n),[n.getSouthWest(),n.getNorthWest(),n.getNorthEast(),n.getSouthEast()]}});function _f(n,a){return new Il(n,a)}As.create=Fo,As.pointsToPath=$,Me.geometryToLayer=jn,Me.coordsToLatLng=kr,Me.coordsToLatLngs=xn,Me.latLngToCoords=Ar,Me.latLngsToCoords=Xn,Me.getFeature=en,Me.asFeature=w,Vt.mergeOptions({boxZoom:!0});var Ol=li.extend({initialize:function(n){this._map=n,this._container=n._container,this._pane=n._panes.overlayPane,this._resetStateTimeout=0,n.on("unload",this._destroy,this)},addHooks:function(){Rt(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){Kt(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){re(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){this._resetStateTimeout!==0&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(n){if(!n.shiftKey||n.which!==1&&n.button!==1)return!1;this._clearDeferredResetState(),this._resetState(),Zn(),Hn(),this._startPoint=this._map.mouseEventToContainerPoint(n),Rt(document,{contextmenu:Di,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(n){this._moved||(this._moved=!0,this._box=jt("div","leaflet-zoom-box",this._container),Ft(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(n);var a=new Y(this._point,this._startPoint),c=a.getSize();ce(this._box,a.min),this._box.style.width=c.x+"px",this._box.style.height=c.y+"px"},_finish:function(){this._moved&&(re(this._box),ae(this._container,"leaflet-crosshair")),Gn(),wr(),Kt(document,{contextmenu:Di,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(n){if(!(n.which!==1&&n.button!==1)&&(this._finish(),!!this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(o(this._resetState,this),0);var a=new pt(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(a).fire("boxzoomend",{boxZoomBounds:a})}},_onKeyDown:function(n){n.keyCode===27&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});Vt.addInitHook("addHandler","boxZoom",Ol),Vt.mergeOptions({doubleClickZoom:!0});var Rl=li.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(n){var a=this._map,c=a.getZoom(),_=a.options.zoomDelta,E=n.originalEvent.shiftKey?c-_:c+_;a.options.doubleClickZoom==="center"?a.setZoom(E):a.setZoomAround(n.containerPoint,E)}});Vt.addInitHook("addHandler","doubleClickZoom",Rl),Vt.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var Dl=li.extend({addHooks:function(){if(!this._draggable){var n=this._map;this._draggable=new Bi(n._mapPane,n._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),n.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),n.on("zoomend",this._onZoomEnd,this),n.whenReady(this._onZoomEnd,this))}Ft(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){ae(this._map._container,"leaflet-grab"),ae(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var n=this._map;if(n._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var a=ct(this._map.options.maxBounds);this._offsetLimit=Q(this._map.latLngToContainerPoint(a.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(a.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;n.fire("movestart").fire("dragstart"),n.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(n){if(this._map.options.inertia){var a=this._lastTime=+new Date,c=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(c),this._times.push(a),this._prunePositions(a)}this._map.fire("move",n).fire("drag",n)},_prunePositions:function(n){for(;this._positions.length>1&&n-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var n=this._map.getSize().divideBy(2),a=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=a.subtract(n).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(n,a){return n-(n-a)*this._viscosity},_onPreDragLimit:function(){if(!(!this._viscosity||!this._offsetLimit)){var n=this._draggable._newPos.subtract(this._draggable._startPos),a=this._offsetLimit;n.x<a.min.x&&(n.x=this._viscousLimit(n.x,a.min.x)),n.y<a.min.y&&(n.y=this._viscousLimit(n.y,a.min.y)),n.x>a.max.x&&(n.x=this._viscousLimit(n.x,a.max.x)),n.y>a.max.y&&(n.y=this._viscousLimit(n.y,a.max.y)),this._draggable._newPos=this._draggable._startPos.add(n)}},_onPreDragWrap:function(){var n=this._worldWidth,a=Math.round(n/2),c=this._initialWorldOffset,_=this._draggable._newPos.x,E=(_-a+c)%n+a-c,R=(_+a+c)%n-a-c,J=Math.abs(E+c)<Math.abs(R+c)?E:R;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=J},_onDragEnd:function(n){var a=this._map,c=a.options,_=!c.inertia||n.noInertia||this._times.length<2;if(a.fire("dragend",n),_)a.fire("moveend");else{this._prunePositions(+new Date);var E=this._lastPos.subtract(this._positions[0]),R=(this._lastTime-this._times[0])/1e3,J=c.easeLinearity,nt=E.multiplyBy(J/R),st=nt.distanceTo([0,0]),dt=Math.min(c.inertiaMaxSpeed,st),Mt=nt.multiplyBy(dt/st),Ot=dt/(c.inertiaDeceleration*J),Gt=Mt.multiplyBy(-Ot/2).round();!Gt.x&&!Gt.y?a.fire("moveend"):(Gt=a._limitOffset(Gt,a.options.maxBounds),F(function(){a.panBy(Gt,{duration:Ot,easeLinearity:J,noMoveStart:!0,animate:!0})}))}}});Vt.addInitHook("addHandler","dragging",Dl),Vt.mergeOptions({keyboard:!0,keyboardPanDelta:80});var Bl=li.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(n){this._map=n,this._setPanDelta(n.options.keyboardPanDelta),this._setZoomDelta(n.options.zoomDelta)},addHooks:function(){var n=this._map._container;n.tabIndex<=0&&(n.tabIndex="0"),Rt(n,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),Kt(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var n=document.body,a=document.documentElement,c=n.scrollTop||a.scrollTop,_=n.scrollLeft||a.scrollLeft;this._map._container.focus(),window.scrollTo(_,c)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(n){var a=this._panKeys={},c=this.keyCodes,_,E;for(_=0,E=c.left.length;_<E;_++)a[c.left[_]]=[-1*n,0];for(_=0,E=c.right.length;_<E;_++)a[c.right[_]]=[n,0];for(_=0,E=c.down.length;_<E;_++)a[c.down[_]]=[0,n];for(_=0,E=c.up.length;_<E;_++)a[c.up[_]]=[0,-1*n]},_setZoomDelta:function(n){var a=this._zoomKeys={},c=this.keyCodes,_,E;for(_=0,E=c.zoomIn.length;_<E;_++)a[c.zoomIn[_]]=n;for(_=0,E=c.zoomOut.length;_<E;_++)a[c.zoomOut[_]]=-n},_addHooks:function(){Rt(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){Kt(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(n){if(!(n.altKey||n.ctrlKey||n.metaKey)){var a=n.keyCode,c=this._map,_;if(a in this._panKeys){if(!c._panAnim||!c._panAnim._inProgress)if(_=this._panKeys[a],n.shiftKey&&(_=et(_).multiplyBy(3)),c.options.maxBounds&&(_=c._limitOffset(et(_),c.options.maxBounds)),c.options.worldCopyJump){var E=c.wrapLatLng(c.unproject(c.project(c.getCenter()).add(_)));c.panTo(E)}else c.panBy(_)}else if(a in this._zoomKeys)c.setZoom(c.getZoom()+(n.shiftKey?3:1)*this._zoomKeys[a]);else if(a===27&&c._popup&&c._popup.options.closeOnEscapeKey)c.closePopup();else return;Di(n)}}});Vt.addInitHook("addHandler","keyboard",Bl),Vt.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var Nl=li.extend({addHooks:function(){Rt(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){Kt(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(n){var a=vo(n),c=this._map.options.wheelDebounceTime;this._delta+=a,this._lastMousePos=this._map.mouseEventToContainerPoint(n),this._startTime||(this._startTime=+new Date);var _=Math.max(c-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(o(this._performZoom,this),_),Di(n)},_performZoom:function(){var n=this._map,a=n.getZoom(),c=this._map.options.zoomSnap||0;n._stop();var _=this._delta/(this._map.options.wheelPxPerZoomLevel*4),E=4*Math.log(2/(1+Math.exp(-Math.abs(_))))/Math.LN2,R=c?Math.ceil(E/c)*c:E,J=n._limitZoom(a+(this._delta>0?R:-R))-a;this._delta=0,this._startTime=null,J&&(n.options.scrollWheelZoom==="center"?n.setZoom(a+J):n.setZoomAround(this._lastMousePos,a+J))}});Vt.addInitHook("addHandler","scrollWheelZoom",Nl);var gf=600;Vt.mergeOptions({tapHold:At.touchNative&&At.safari&&At.mobile,tapTolerance:15});var Fl=li.extend({addHooks:function(){Rt(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){Kt(this._map._container,"touchstart",this._onDown,this)},_onDown:function(n){if(clearTimeout(this._holdTimeout),n.touches.length===1){var a=n.touches[0];this._startPos=this._newPos=new W(a.clientX,a.clientY),this._holdTimeout=setTimeout(o(function(){this._cancel(),this._isTapValid()&&(Rt(document,"touchend",be),Rt(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",a))},this),gf),Rt(document,"touchend touchcancel contextmenu",this._cancel,this),Rt(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function n(){Kt(document,"touchend",be),Kt(document,"touchend touchcancel",n)},_cancel:function(){clearTimeout(this._holdTimeout),Kt(document,"touchend touchcancel contextmenu",this._cancel,this),Kt(document,"touchmove",this._onMove,this)},_onMove:function(n){var a=n.touches[0];this._newPos=new W(a.clientX,a.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(n,a){var c=new MouseEvent(n,{bubbles:!0,cancelable:!0,view:window,screenX:a.screenX,screenY:a.screenY,clientX:a.clientX,clientY:a.clientY});c._simulated=!0,a.target.dispatchEvent(c)}});Vt.addInitHook("addHandler","tapHold",Fl),Vt.mergeOptions({touchZoom:At.touch,bounceAtZoomLimits:!0});var Ul=li.extend({addHooks:function(){Ft(this._map._container,"leaflet-touch-zoom"),Rt(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){ae(this._map._container,"leaflet-touch-zoom"),Kt(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(n){var a=this._map;if(!(!n.touches||n.touches.length!==2||a._animatingZoom||this._zooming)){var c=a.mouseEventToContainerPoint(n.touches[0]),_=a.mouseEventToContainerPoint(n.touches[1]);this._centerPoint=a.getSize()._divideBy(2),this._startLatLng=a.containerPointToLatLng(this._centerPoint),a.options.touchZoom!=="center"&&(this._pinchStartLatLng=a.containerPointToLatLng(c.add(_)._divideBy(2))),this._startDist=c.distanceTo(_),this._startZoom=a.getZoom(),this._moved=!1,this._zooming=!0,a._stop(),Rt(document,"touchmove",this._onTouchMove,this),Rt(document,"touchend touchcancel",this._onTouchEnd,this),be(n)}},_onTouchMove:function(n){if(!(!n.touches||n.touches.length!==2||!this._zooming)){var a=this._map,c=a.mouseEventToContainerPoint(n.touches[0]),_=a.mouseEventToContainerPoint(n.touches[1]),E=c.distanceTo(_)/this._startDist;if(this._zoom=a.getScaleZoom(E,this._startZoom),!a.options.bounceAtZoomLimits&&(this._zoom<a.getMinZoom()&&E<1||this._zoom>a.getMaxZoom()&&E>1)&&(this._zoom=a._limitZoom(this._zoom)),a.options.touchZoom==="center"){if(this._center=this._startLatLng,E===1)return}else{var R=c._add(_)._divideBy(2)._subtract(this._centerPoint);if(E===1&&R.x===0&&R.y===0)return;this._center=a.unproject(a.project(this._pinchStartLatLng,this._zoom).subtract(R),this._zoom)}this._moved||(a._moveStart(!0,!1),this._moved=!0),S(this._animRequest);var J=o(a._move,a,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=F(J,this,!0),be(n)}},_onTouchEnd:function(){if(!this._moved||!this._zooming){this._zooming=!1;return}this._zooming=!1,S(this._animRequest),Kt(document,"touchmove",this._onTouchMove,this),Kt(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))}});Vt.addInitHook("addHandler","touchZoom",Ul),Vt.BoxZoom=Ol,Vt.DoubleClickZoom=Rl,Vt.Drag=Dl,Vt.Keyboard=Bl,Vt.ScrollWheelZoom=Nl,Vt.TapHold=Fl,Vt.TouchZoom=Ul,e.Bounds=Y,e.Browser=At,e.CRS=St,e.Canvas=Pl,e.Circle=vn,e.CircleMarker=vi,e.Class=v,e.Control=Re,e.DivIcon=xi,e.DivOverlay=Ut,e.DomEvent=$a,e.DomUtil=Ja,e.Draggable=Bi,e.Evented=H,e.FeatureGroup=Ce,e.GeoJSON=Me,e.GridLayer=Xe,e.Handler=li,e.Icon=Ze,e.ImageOverlay=bt,e.LatLng=rt,e.LatLngBounds=pt,e.Layer=Pe,e.LayerGroup=gn,e.LineUtil=Po,e.Map=Vt,e.Marker=Qi,e.Mixin=ih,e.Path=pe,e.Point=W,e.PolyUtil=Lr,e.Polygon=tn,e.Polyline=ci,e.Popup=te,e.PosAnimation=xo,e.Projection=Er,e.Rectangle=Il,e.Renderer=nn,e.SVG=As,e.SVGOverlay=Dt,e.TileLayer=bi,e.Tooltip=de,e.Transformation=vt,e.Util=O,e.VideoOverlay=Lt,e.bind=o,e.bounds=Q,e.canvas=Cl,e.circle=Sr,e.circleMarker=Oo,e.control=Vn,e.divIcon=wi,e.extend=i,e.featureGroup=ke,e.geoJSON=j,e.geoJson=at,e.gridLayer=No,e.icon=Ss,e.imageOverlay=yt,e.latLng=mt,e.latLngBounds=ct,e.layerGroup=yn,e.map=Ka,e.marker=Tr,e.point=et,e.polygon=Do,e.polyline=Ro,e.popup=me,e.rectangle=_f,e.setOptions=y,e.stamp=u,e.svg=zl,e.svgOverlay=Qt,e.tileLayer=Jn,e.tooltip=Le,e.transformation=ht,e.version=r,e.videoOverlay=Ct;var yf=window.L;e.noConflict=function(){return window.L=yf,this},window.L=e})}(Bs,Bs.exports)),Bs.exports}var rp=np();const sp=yl(rp);(function(h,t,e){function r(i,s){for(;(i=i.parentElement)&&!i.classList.contains(s););return i}L.drawVersion="1.0.4",L.Draw={},L.drawLocal={draw:{toolbar:{actions:{title:"Cancel drawing",text:"Cancel"},finish:{title:"Finish drawing",text:"Finish"},undo:{title:"Delete last point drawn",text:"Delete last point"},buttons:{polyline:"Draw a polyline",polygon:"Draw a polygon",rectangle:"Draw a rectangle",circle:"Draw a circle",marker:"Draw a marker",circlemarker:"Draw a circlemarker"}},handlers:{circle:{tooltip:{start:"Click and drag to draw circle."},radius:"Radius"},circlemarker:{tooltip:{start:"Click map to place circle marker."}},marker:{tooltip:{start:"Click map to place marker."}},polygon:{tooltip:{start:"Click to start drawing shape.",cont:"Click to continue drawing shape.",end:"Click first point to close this shape."}},polyline:{error:"<strong>Error:</strong> shape edges cannot cross!",tooltip:{start:"Click to start drawing line.",cont:"Click to continue drawing line.",end:"Click last point to finish line."}},rectangle:{tooltip:{start:"Click and drag to draw rectangle."}},simpleshape:{tooltip:{end:"Release mouse to finish drawing."}}}},edit:{toolbar:{actions:{save:{title:"Save changes",text:"Save"},cancel:{title:"Cancel editing, discards all changes",text:"Cancel"},clearAll:{title:"Clear all layers",text:"Clear All"}},buttons:{edit:"Edit layers",editDisabled:"No layers to edit",remove:"Delete layers",removeDisabled:"No layers to delete"}},handlers:{edit:{tooltip:{text:"Drag handles or markers to edit features.",subtext:"Click cancel to undo changes."}},remove:{tooltip:{text:"Click on a feature to remove."}}}}},L.Draw.Event={},L.Draw.Event.CREATED="draw:created",L.Draw.Event.EDITED="draw:edited",L.Draw.Event.DELETED="draw:deleted",L.Draw.Event.DRAWSTART="draw:drawstart",L.Draw.Event.DRAWSTOP="draw:drawstop",L.Draw.Event.DRAWVERTEX="draw:drawvertex",L.Draw.Event.EDITSTART="draw:editstart",L.Draw.Event.EDITMOVE="draw:editmove",L.Draw.Event.EDITRESIZE="draw:editresize",L.Draw.Event.EDITVERTEX="draw:editvertex",L.Draw.Event.EDITSTOP="draw:editstop",L.Draw.Event.DELETESTART="draw:deletestart",L.Draw.Event.DELETESTOP="draw:deletestop",L.Draw.Event.TOOLBAROPENED="draw:toolbaropened",L.Draw.Event.TOOLBARCLOSED="draw:toolbarclosed",L.Draw.Event.MARKERCONTEXT="draw:markercontext",L.Draw=L.Draw||{},L.Draw.Feature=L.Handler.extend({initialize:function(i,s){this._map=i,this._container=i._container,this._overlayPane=i._panes.overlayPane,this._popupPane=i._panes.popupPane,s&&s.shapeOptions&&(s.shapeOptions=L.Util.extend({},this.options.shapeOptions,s.shapeOptions)),L.setOptions(this,s);var o=L.version.split(".");parseInt(o[0],10)===1&&parseInt(o[1],10)>=2?L.Draw.Feature.include(L.Evented.prototype):L.Draw.Feature.include(L.Mixin.Events)},enable:function(){this._enabled||(L.Handler.prototype.enable.call(this),this.fire("enabled",{handler:this.type}),this._map.fire(L.Draw.Event.DRAWSTART,{layerType:this.type}))},disable:function(){this._enabled&&(L.Handler.prototype.disable.call(this),this._map.fire(L.Draw.Event.DRAWSTOP,{layerType:this.type}),this.fire("disabled",{handler:this.type}))},addHooks:function(){var i=this._map;i&&(L.DomUtil.disableTextSelection(),i.getContainer().focus(),this._tooltip=new L.Draw.Tooltip(this._map),L.DomEvent.on(this._container,"keyup",this._cancelDrawing,this))},removeHooks:function(){this._map&&(L.DomUtil.enableTextSelection(),this._tooltip.dispose(),this._tooltip=null,L.DomEvent.off(this._container,"keyup",this._cancelDrawing,this))},setOptions:function(i){L.setOptions(this,i)},_fireCreatedEvent:function(i){this._map.fire(L.Draw.Event.CREATED,{layer:i,layerType:this.type})},_cancelDrawing:function(i){i.keyCode===27&&(this._map.fire("draw:canceled",{layerType:this.type}),this.disable())}}),L.Draw.Polyline=L.Draw.Feature.extend({statics:{TYPE:"polyline"},Poly:L.Polyline,options:{allowIntersection:!0,repeatMode:!1,drawError:{color:"#b00b00",timeout:2500},icon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon"}),touchIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-touch-icon"}),guidelineDistance:20,maxGuideLineLength:4e3,shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!1,clickable:!0},metric:!0,feet:!0,nautic:!1,showLength:!0,zIndexOffset:2e3,factor:1,maxPoints:0},initialize:function(i,s){L.Browser.touch&&(this.options.icon=this.options.touchIcon),this.options.drawError.message=L.drawLocal.draw.handlers.polyline.error,s&&s.drawError&&(s.drawError=L.Util.extend({},this.options.drawError,s.drawError)),this.type=L.Draw.Polyline.TYPE,L.Draw.Feature.prototype.initialize.call(this,i,s)},addHooks:function(){L.Draw.Feature.prototype.addHooks.call(this),this._map&&(this._markers=[],this._markerGroup=new L.LayerGroup,this._map.addLayer(this._markerGroup),this._poly=new L.Polyline([],this.options.shapeOptions),this._tooltip.updateContent(this._getTooltipText()),this._mouseMarker||(this._mouseMarker=L.marker(this._map.getCenter(),{icon:L.divIcon({className:"leaflet-mouse-marker",iconAnchor:[20,20],iconSize:[40,40]}),opacity:0,zIndexOffset:this.options.zIndexOffset})),this._mouseMarker.on("mouseout",this._onMouseOut,this).on("mousemove",this._onMouseMove,this).on("mousedown",this._onMouseDown,this).on("mouseup",this._onMouseUp,this).addTo(this._map),this._map.on("mouseup",this._onMouseUp,this).on("mousemove",this._onMouseMove,this).on("zoomlevelschange",this._onZoomEnd,this).on("touchstart",this._onTouch,this).on("zoomend",this._onZoomEnd,this))},removeHooks:function(){L.Draw.Feature.prototype.removeHooks.call(this),this._clearHideErrorTimeout(),this._cleanUpShape(),this._map.removeLayer(this._markerGroup),delete this._markerGroup,delete this._markers,this._map.removeLayer(this._poly),delete this._poly,this._mouseMarker.off("mousedown",this._onMouseDown,this).off("mouseout",this._onMouseOut,this).off("mouseup",this._onMouseUp,this).off("mousemove",this._onMouseMove,this),this._map.removeLayer(this._mouseMarker),delete this._mouseMarker,this._clearGuides(),this._map.off("mouseup",this._onMouseUp,this).off("mousemove",this._onMouseMove,this).off("zoomlevelschange",this._onZoomEnd,this).off("zoomend",this._onZoomEnd,this).off("touchstart",this._onTouch,this).off("click",this._onTouch,this)},deleteLastVertex:function(){if(!(this._markers.length<=1)){var i=this._markers.pop(),s=this._poly,o=s.getLatLngs(),l=o.splice(-1,1)[0];this._poly.setLatLngs(o),this._markerGroup.removeLayer(i),s.getLatLngs().length<2&&this._map.removeLayer(s),this._vertexChanged(l,!1)}},addVertex:function(i){if(this._markers.length>=2&&!this.options.allowIntersection&&this._poly.newLatLngIntersects(i))return void this._showErrorTooltip();this._errorShown&&this._hideErrorTooltip(),this._markers.push(this._createMarker(i)),this._poly.addLatLng(i),this._poly.getLatLngs().length===2&&this._map.addLayer(this._poly),this._vertexChanged(i,!0)},completeShape:function(){this._markers.length<=1||!this._shapeIsValid()||(this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable())},_finishShape:function(){var i=this._poly._defaultShape?this._poly._defaultShape():this._poly.getLatLngs(),s=this._poly.newLatLngIntersects(i[i.length-1]);if(!this.options.allowIntersection&&s||!this._shapeIsValid())return void this._showErrorTooltip();this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable()},_shapeIsValid:function(){return!0},_onZoomEnd:function(){this._markers!==null&&this._updateGuide()},_onMouseMove:function(i){var s=this._map.mouseEventToLayerPoint(i.originalEvent),o=this._map.layerPointToLatLng(s);this._currentLatLng=o,this._updateTooltip(o),this._updateGuide(s),this._mouseMarker.setLatLng(o),L.DomEvent.preventDefault(i.originalEvent)},_vertexChanged:function(i,s){this._map.fire(L.Draw.Event.DRAWVERTEX,{layers:this._markerGroup}),this._updateFinishHandler(),this._updateRunningMeasure(i,s),this._clearGuides(),this._updateTooltip()},_onMouseDown:function(i){if(!this._clickHandled&&!this._touchHandled&&!this._disableMarkers){this._onMouseMove(i),this._clickHandled=!0,this._disableNewMarkers();var s=i.originalEvent,o=s.clientX,l=s.clientY;this._startPoint.call(this,o,l)}},_startPoint:function(i,s){this._mouseDownOrigin=L.point(i,s)},_onMouseUp:function(i){var s=i.originalEvent,o=s.clientX,l=s.clientY;this._endPoint.call(this,o,l,i),this._clickHandled=null},_endPoint:function(i,s,o){if(this._mouseDownOrigin){var l=L.point(i,s).distanceTo(this._mouseDownOrigin),u=this._calculateFinishDistance(o.latlng);this.options.maxPoints>1&&this.options.maxPoints==this._markers.length+1?(this.addVertex(o.latlng),this._finishShape()):u<10&&L.Browser.touch?this._finishShape():Math.abs(l)<9*(h.devicePixelRatio||1)&&this.addVertex(o.latlng),this._enableNewMarkers()}this._mouseDownOrigin=null},_onTouch:function(i){var s,o,l=i.originalEvent;!l.touches||!l.touches[0]||this._clickHandled||this._touchHandled||this._disableMarkers||(s=l.touches[0].clientX,o=l.touches[0].clientY,this._disableNewMarkers(),this._touchHandled=!0,this._startPoint.call(this,s,o),this._endPoint.call(this,s,o,i),this._touchHandled=null),this._clickHandled=null},_onMouseOut:function(){this._tooltip&&this._tooltip._onMouseOut.call(this._tooltip)},_calculateFinishDistance:function(i){var s;if(this._markers.length>0){var o;if(this.type===L.Draw.Polyline.TYPE)o=this._markers[this._markers.length-1];else{if(this.type!==L.Draw.Polygon.TYPE)return 1/0;o=this._markers[0]}var l=this._map.latLngToContainerPoint(o.getLatLng()),u=new L.Marker(i,{icon:this.options.icon,zIndexOffset:2*this.options.zIndexOffset}),f=this._map.latLngToContainerPoint(u.getLatLng());s=l.distanceTo(f)}else s=1/0;return s},_updateFinishHandler:function(){var i=this._markers.length;i>1&&this._markers[i-1].on("click",this._finishShape,this),i>2&&this._markers[i-2].off("click",this._finishShape,this)},_createMarker:function(i){var s=new L.Marker(i,{icon:this.options.icon,zIndexOffset:2*this.options.zIndexOffset});return this._markerGroup.addLayer(s),s},_updateGuide:function(i){var s=this._markers?this._markers.length:0;s>0&&(i=i||this._map.latLngToLayerPoint(this._currentLatLng),this._clearGuides(),this._drawGuide(this._map.latLngToLayerPoint(this._markers[s-1].getLatLng()),i))},_updateTooltip:function(i){var s=this._getTooltipText();i&&this._tooltip.updatePosition(i),this._errorShown||this._tooltip.updateContent(s)},_drawGuide:function(i,s){var o,l,u,f=Math.floor(Math.sqrt(Math.pow(s.x-i.x,2)+Math.pow(s.y-i.y,2))),d=this.options.guidelineDistance,p=this.options.maxGuideLineLength,g=f>p?f-p:d;for(this._guidesContainer||(this._guidesContainer=L.DomUtil.create("div","leaflet-draw-guides",this._overlayPane));g<f;g+=this.options.guidelineDistance)o=g/f,l={x:Math.floor(i.x*(1-o)+o*s.x),y:Math.floor(i.y*(1-o)+o*s.y)},u=L.DomUtil.create("div","leaflet-draw-guide-dash",this._guidesContainer),u.style.backgroundColor=this._errorShown?this.options.drawError.color:this.options.shapeOptions.color,L.DomUtil.setPosition(u,l)},_updateGuideColor:function(i){if(this._guidesContainer)for(var s=0,o=this._guidesContainer.childNodes.length;s<o;s++)this._guidesContainer.childNodes[s].style.backgroundColor=i},_clearGuides:function(){if(this._guidesContainer)for(;this._guidesContainer.firstChild;)this._guidesContainer.removeChild(this._guidesContainer.firstChild)},_getTooltipText:function(){var i,s,o=this.options.showLength;return this._markers.length===0?i={text:L.drawLocal.draw.handlers.polyline.tooltip.start}:(s=o?this._getMeasurementString():"",i=this._markers.length===1?{text:L.drawLocal.draw.handlers.polyline.tooltip.cont,subtext:s}:{text:L.drawLocal.draw.handlers.polyline.tooltip.end,subtext:s}),i},_updateRunningMeasure:function(i,s){var o,l,u=this._markers.length;this._markers.length===1?this._measurementRunningTotal=0:(o=u-(s?2:1),l=L.GeometryUtil.isVersion07x()?i.distanceTo(this._markers[o].getLatLng())*(this.options.factor||1):this._map.distance(i,this._markers[o].getLatLng())*(this.options.factor||1),this._measurementRunningTotal+=l*(s?1:-1))},_getMeasurementString:function(){var i,s=this._currentLatLng,o=this._markers[this._markers.length-1].getLatLng();return i=L.GeometryUtil.isVersion07x()?o&&s&&s.distanceTo?this._measurementRunningTotal+s.distanceTo(o)*(this.options.factor||1):this._measurementRunningTotal||0:o&&s?this._measurementRunningTotal+this._map.distance(s,o)*(this.options.factor||1):this._measurementRunningTotal||0,L.GeometryUtil.readableDistance(i,this.options.metric,this.options.feet,this.options.nautic,this.options.precision)},_showErrorTooltip:function(){this._errorShown=!0,this._tooltip.showAsError().updateContent({text:this.options.drawError.message}),this._updateGuideColor(this.options.drawError.color),this._poly.setStyle({color:this.options.drawError.color}),this._clearHideErrorTimeout(),this._hideErrorTimeout=setTimeout(L.Util.bind(this._hideErrorTooltip,this),this.options.drawError.timeout)},_hideErrorTooltip:function(){this._errorShown=!1,this._clearHideErrorTimeout(),this._tooltip.removeError().updateContent(this._getTooltipText()),this._updateGuideColor(this.options.shapeOptions.color),this._poly.setStyle({color:this.options.shapeOptions.color})},_clearHideErrorTimeout:function(){this._hideErrorTimeout&&(clearTimeout(this._hideErrorTimeout),this._hideErrorTimeout=null)},_disableNewMarkers:function(){this._disableMarkers=!0},_enableNewMarkers:function(){setTimeout((function(){this._disableMarkers=!1}).bind(this),50)},_cleanUpShape:function(){this._markers.length>1&&this._markers[this._markers.length-1].off("click",this._finishShape,this)},_fireCreatedEvent:function(){var i=new this.Poly(this._poly.getLatLngs(),this.options.shapeOptions);L.Draw.Feature.prototype._fireCreatedEvent.call(this,i)}}),L.Draw.Polygon=L.Draw.Polyline.extend({statics:{TYPE:"polygon"},Poly:L.Polygon,options:{showArea:!1,showLength:!1,shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0},metric:!0,feet:!0,nautic:!1,precision:{}},initialize:function(i,s){L.Draw.Polyline.prototype.initialize.call(this,i,s),this.type=L.Draw.Polygon.TYPE},_updateFinishHandler:function(){var i=this._markers.length;i===1&&this._markers[0].on("click",this._finishShape,this),i>2&&(this._markers[i-1].on("dblclick",this._finishShape,this),i>3&&this._markers[i-2].off("dblclick",this._finishShape,this))},_getTooltipText:function(){var i,s;return this._markers.length===0?i=L.drawLocal.draw.handlers.polygon.tooltip.start:this._markers.length<3?(i=L.drawLocal.draw.handlers.polygon.tooltip.cont,s=this._getMeasurementString()):(i=L.drawLocal.draw.handlers.polygon.tooltip.end,s=this._getMeasurementString()),{text:i,subtext:s}},_getMeasurementString:function(){var i=this._area,s="";return i||this.options.showLength?(this.options.showLength&&(s=L.Draw.Polyline.prototype._getMeasurementString.call(this)),i&&(s+="<br>"+L.GeometryUtil.readableArea(i,this.options.metric,this.options.precision)),s):null},_shapeIsValid:function(){return this._markers.length>=3},_vertexChanged:function(i,s){var o;!this.options.allowIntersection&&this.options.showArea&&(o=this._poly.getLatLngs(),this._area=L.GeometryUtil.geodesicArea(o)),L.Draw.Polyline.prototype._vertexChanged.call(this,i,s)},_cleanUpShape:function(){var i=this._markers.length;i>0&&(this._markers[0].off("click",this._finishShape,this),i>2&&this._markers[i-1].off("dblclick",this._finishShape,this))}}),L.SimpleShape={},L.Draw.SimpleShape=L.Draw.Feature.extend({options:{repeatMode:!1},initialize:function(i,s){this._endLabelText=L.drawLocal.draw.handlers.simpleshape.tooltip.end,L.Draw.Feature.prototype.initialize.call(this,i,s)},addHooks:function(){L.Draw.Feature.prototype.addHooks.call(this),this._map&&(this._mapDraggable=this._map.dragging.enabled(),this._mapDraggable&&this._map.dragging.disable(),this._container.style.cursor="crosshair",this._tooltip.updateContent({text:this._initialLabelText}),this._map.on("mousedown",this._onMouseDown,this).on("mousemove",this._onMouseMove,this).on("touchstart",this._onMouseDown,this).on("touchmove",this._onMouseMove,this),t.addEventListener("touchstart",L.DomEvent.preventDefault,{passive:!1}))},removeHooks:function(){L.Draw.Feature.prototype.removeHooks.call(this),this._map&&(this._mapDraggable&&this._map.dragging.enable(),this._container.style.cursor="",this._map.off("mousedown",this._onMouseDown,this).off("mousemove",this._onMouseMove,this).off("touchstart",this._onMouseDown,this).off("touchmove",this._onMouseMove,this),L.DomEvent.off(t,"mouseup",this._onMouseUp,this),L.DomEvent.off(t,"touchend",this._onMouseUp,this),t.removeEventListener("touchstart",L.DomEvent.preventDefault),this._shape&&(this._map.removeLayer(this._shape),delete this._shape)),this._isDrawing=!1},_getTooltipText:function(){return{text:this._endLabelText}},_onMouseDown:function(i){this._isDrawing=!0,this._startLatLng=i.latlng,L.DomEvent.on(t,"mouseup",this._onMouseUp,this).on(t,"touchend",this._onMouseUp,this).preventDefault(i.originalEvent)},_onMouseMove:function(i){var s=i.latlng;this._tooltip.updatePosition(s),this._isDrawing&&(this._tooltip.updateContent(this._getTooltipText()),this._drawShape(s))},_onMouseUp:function(){this._shape&&this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable()}}),L.Draw.Rectangle=L.Draw.SimpleShape.extend({statics:{TYPE:"rectangle"},options:{shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0},showArea:!0,metric:!0},initialize:function(i,s){this.type=L.Draw.Rectangle.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.rectangle.tooltip.start,L.Draw.SimpleShape.prototype.initialize.call(this,i,s)},disable:function(){this._enabled&&(this._isCurrentlyTwoClickDrawing=!1,L.Draw.SimpleShape.prototype.disable.call(this))},_onMouseUp:function(i){if(!this._shape&&!this._isCurrentlyTwoClickDrawing)return void(this._isCurrentlyTwoClickDrawing=!0);this._isCurrentlyTwoClickDrawing&&!r(i.target,"leaflet-pane")||L.Draw.SimpleShape.prototype._onMouseUp.call(this)},_drawShape:function(i){this._shape?this._shape.setBounds(new L.LatLngBounds(this._startLatLng,i)):(this._shape=new L.Rectangle(new L.LatLngBounds(this._startLatLng,i),this.options.shapeOptions),this._map.addLayer(this._shape))},_fireCreatedEvent:function(){var i=new L.Rectangle(this._shape.getBounds(),this.options.shapeOptions);L.Draw.SimpleShape.prototype._fireCreatedEvent.call(this,i)},_getTooltipText:function(){var i,s,o,l=L.Draw.SimpleShape.prototype._getTooltipText.call(this),u=this._shape,f=this.options.showArea;return u&&(i=this._shape._defaultShape?this._shape._defaultShape():this._shape.getLatLngs(),s=L.GeometryUtil.geodesicArea(i),o=f?L.GeometryUtil.readableArea(s,this.options.metric):""),{text:l.text,subtext:o}}}),L.Draw.Marker=L.Draw.Feature.extend({statics:{TYPE:"marker"},options:{icon:new L.Icon.Default,repeatMode:!1,zIndexOffset:2e3},initialize:function(i,s){this.type=L.Draw.Marker.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.marker.tooltip.start,L.Draw.Feature.prototype.initialize.call(this,i,s)},addHooks:function(){L.Draw.Feature.prototype.addHooks.call(this),this._map&&(this._tooltip.updateContent({text:this._initialLabelText}),this._mouseMarker||(this._mouseMarker=L.marker(this._map.getCenter(),{icon:L.divIcon({className:"leaflet-mouse-marker",iconAnchor:[20,20],iconSize:[40,40]}),opacity:0,zIndexOffset:this.options.zIndexOffset})),this._mouseMarker.on("click",this._onClick,this).addTo(this._map),this._map.on("mousemove",this._onMouseMove,this),this._map.on("click",this._onTouch,this))},removeHooks:function(){L.Draw.Feature.prototype.removeHooks.call(this),this._map&&(this._map.off("click",this._onClick,this).off("click",this._onTouch,this),this._marker&&(this._marker.off("click",this._onClick,this),this._map.removeLayer(this._marker),delete this._marker),this._mouseMarker.off("click",this._onClick,this),this._map.removeLayer(this._mouseMarker),delete this._mouseMarker,this._map.off("mousemove",this._onMouseMove,this))},_onMouseMove:function(i){var s=i.latlng;this._tooltip.updatePosition(s),this._mouseMarker.setLatLng(s),this._marker?(s=this._mouseMarker.getLatLng(),this._marker.setLatLng(s)):(this._marker=this._createMarker(s),this._marker.on("click",this._onClick,this),this._map.on("click",this._onClick,this).addLayer(this._marker))},_createMarker:function(i){return new L.Marker(i,{icon:this.options.icon,zIndexOffset:this.options.zIndexOffset})},_onClick:function(){this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable()},_onTouch:function(i){this._onMouseMove(i),this._onClick()},_fireCreatedEvent:function(){var i=new L.Marker.Touch(this._marker.getLatLng(),{icon:this.options.icon});L.Draw.Feature.prototype._fireCreatedEvent.call(this,i)}}),L.Draw.CircleMarker=L.Draw.Marker.extend({statics:{TYPE:"circlemarker"},options:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0,zIndexOffset:2e3},initialize:function(i,s){this.type=L.Draw.CircleMarker.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.circlemarker.tooltip.start,L.Draw.Feature.prototype.initialize.call(this,i,s)},_fireCreatedEvent:function(){var i=new L.CircleMarker(this._marker.getLatLng(),this.options);L.Draw.Feature.prototype._fireCreatedEvent.call(this,i)},_createMarker:function(i){return new L.CircleMarker(i,this.options)}}),L.Draw.Circle=L.Draw.SimpleShape.extend({statics:{TYPE:"circle"},options:{shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0},showRadius:!0,metric:!0,feet:!0,nautic:!1},initialize:function(i,s){this.type=L.Draw.Circle.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.circle.tooltip.start,L.Draw.SimpleShape.prototype.initialize.call(this,i,s)},_drawShape:function(i){if(L.GeometryUtil.isVersion07x())var s=this._startLatLng.distanceTo(i);else var s=this._map.distance(this._startLatLng,i);this._shape?this._shape.setRadius(s):(this._shape=new L.Circle(this._startLatLng,s,this.options.shapeOptions),this._map.addLayer(this._shape))},_fireCreatedEvent:function(){var i=new L.Circle(this._startLatLng,this._shape.getRadius(),this.options.shapeOptions);L.Draw.SimpleShape.prototype._fireCreatedEvent.call(this,i)},_onMouseMove:function(i){var s,o=i.latlng,l=this.options.showRadius,u=this.options.metric;if(this._tooltip.updatePosition(o),this._isDrawing){this._drawShape(o),s=this._shape.getRadius().toFixed(1);var f="";l&&(f=L.drawLocal.draw.handlers.circle.radius+": "+L.GeometryUtil.readableDistance(s,u,this.options.feet,this.options.nautic)),this._tooltip.updateContent({text:this._endLabelText,subtext:f})}}}),L.Edit=L.Edit||{},L.Edit.Marker=L.Handler.extend({initialize:function(i,s){this._marker=i,L.setOptions(this,s)},addHooks:function(){var i=this._marker;i.dragging.enable(),i.on("dragend",this._onDragEnd,i),this._toggleMarkerHighlight()},removeHooks:function(){var i=this._marker;i.dragging.disable(),i.off("dragend",this._onDragEnd,i),this._toggleMarkerHighlight()},_onDragEnd:function(i){var s=i.target;s.edited=!0,this._map.fire(L.Draw.Event.EDITMOVE,{layer:s})},_toggleMarkerHighlight:function(){var i=this._marker._icon;i&&(i.style.display="none",L.DomUtil.hasClass(i,"leaflet-edit-marker-selected")?(L.DomUtil.removeClass(i,"leaflet-edit-marker-selected"),this._offsetMarker(i,-4)):(L.DomUtil.addClass(i,"leaflet-edit-marker-selected"),this._offsetMarker(i,4)),i.style.display="")},_offsetMarker:function(i,s){var o=parseInt(i.style.marginTop,10)-s,l=parseInt(i.style.marginLeft,10)-s;i.style.marginTop=o+"px",i.style.marginLeft=l+"px"}}),L.Marker.addInitHook(function(){L.Edit.Marker&&(this.editing=new L.Edit.Marker(this),this.options.editable&&this.editing.enable())}),L.Edit=L.Edit||{},L.Edit.Poly=L.Handler.extend({initialize:function(i){this.latlngs=[i._latlngs],i._holes&&(this.latlngs=this.latlngs.concat(i._holes)),this._poly=i,this._poly.on("revert-edited",this._updateLatLngs,this)},_defaultShape:function(){return L.Polyline._flat?L.Polyline._flat(this._poly._latlngs)?this._poly._latlngs:this._poly._latlngs[0]:this._poly._latlngs},_eachVertexHandler:function(i){for(var s=0;s<this._verticesHandlers.length;s++)i(this._verticesHandlers[s])},addHooks:function(){this._initHandlers(),this._eachVertexHandler(function(i){i.addHooks()})},removeHooks:function(){this._eachVertexHandler(function(i){i.removeHooks()})},updateMarkers:function(){this._eachVertexHandler(function(i){i.updateMarkers()})},_initHandlers:function(){this._verticesHandlers=[];for(var i=0;i<this.latlngs.length;i++)this._verticesHandlers.push(new L.Edit.PolyVerticesEdit(this._poly,this.latlngs[i],this._poly.options.poly))},_updateLatLngs:function(i){this.latlngs=[i.layer._latlngs],i.layer._holes&&(this.latlngs=this.latlngs.concat(i.layer._holes))}}),L.Edit.PolyVerticesEdit=L.Handler.extend({options:{icon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon"}),touchIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-touch-icon"}),drawError:{color:"#b00b00",timeout:1e3}},initialize:function(i,s,o){L.Browser.touch&&(this.options.icon=this.options.touchIcon),this._poly=i,o&&o.drawError&&(o.drawError=L.Util.extend({},this.options.drawError,o.drawError)),this._latlngs=s,L.setOptions(this,o)},_defaultShape:function(){return L.Polyline._flat?L.Polyline._flat(this._latlngs)?this._latlngs:this._latlngs[0]:this._latlngs},addHooks:function(){var i=this._poly,s=i._path;i instanceof L.Polygon||(i.options.fill=!1,i.options.editing&&(i.options.editing.fill=!1)),s&&i.options.editing&&i.options.editing.className&&(i.options.original.className&&i.options.original.className.split(" ").forEach(function(o){L.DomUtil.removeClass(s,o)}),i.options.editing.className.split(" ").forEach(function(o){L.DomUtil.addClass(s,o)})),i.setStyle(i.options.editing),this._poly._map&&(this._map=this._poly._map,this._markerGroup||this._initMarkers(),this._poly._map.addLayer(this._markerGroup))},removeHooks:function(){var i=this._poly,s=i._path;s&&i.options.editing&&i.options.editing.className&&(i.options.editing.className.split(" ").forEach(function(o){L.DomUtil.removeClass(s,o)}),i.options.original.className&&i.options.original.className.split(" ").forEach(function(o){L.DomUtil.addClass(s,o)})),i.setStyle(i.options.original),i._map&&(i._map.removeLayer(this._markerGroup),delete this._markerGroup,delete this._markers)},updateMarkers:function(){this._markerGroup.clearLayers(),this._initMarkers()},_initMarkers:function(){this._markerGroup||(this._markerGroup=new L.LayerGroup),this._markers=[];var i,s,o,l,u=this._defaultShape();for(i=0,o=u.length;i<o;i++)l=this._createMarker(u[i],i),l.on("click",this._onMarkerClick,this),l.on("contextmenu",this._onContextMenu,this),this._markers.push(l);var f,d;for(i=0,s=o-1;i<o;s=i++)(i!==0||L.Polygon&&this._poly instanceof L.Polygon)&&(f=this._markers[s],d=this._markers[i],this._createMiddleMarker(f,d),this._updatePrevNext(f,d))},_createMarker:function(i,s){var o=new L.Marker.Touch(i,{draggable:!0,icon:this.options.icon});return o._origLatLng=i,o._index=s,o.on("dragstart",this._onMarkerDragStart,this).on("drag",this._onMarkerDrag,this).on("dragend",this._fireEdit,this).on("touchmove",this._onTouchMove,this).on("touchend",this._fireEdit,this).on("MSPointerMove",this._onTouchMove,this).on("MSPointerUp",this._fireEdit,this),this._markerGroup.addLayer(o),o},_onMarkerDragStart:function(){this._poly.fire("editstart")},_spliceLatLngs:function(){var i=this._defaultShape(),s=[].splice.apply(i,arguments);return this._poly._convertLatLngs(i,!0),this._poly.redraw(),s},_removeMarker:function(i){var s=i._index;this._markerGroup.removeLayer(i),this._markers.splice(s,1),this._spliceLatLngs(s,1),this._updateIndexes(s,-1),i.off("dragstart",this._onMarkerDragStart,this).off("drag",this._onMarkerDrag,this).off("dragend",this._fireEdit,this).off("touchmove",this._onMarkerDrag,this).off("touchend",this._fireEdit,this).off("click",this._onMarkerClick,this).off("MSPointerMove",this._onTouchMove,this).off("MSPointerUp",this._fireEdit,this)},_fireEdit:function(){this._poly.edited=!0,this._poly.fire("edit"),this._poly._map.fire(L.Draw.Event.EDITVERTEX,{layers:this._markerGroup,poly:this._poly})},_onMarkerDrag:function(i){var s=i.target,o=this._poly,l=L.LatLngUtil.cloneLatLng(s._origLatLng);if(L.extend(s._origLatLng,s._latlng),o.options.poly){var u=o._map._editTooltip;if(!o.options.poly.allowIntersection&&o.intersects()){L.extend(s._origLatLng,l),s.setLatLng(l);var f=o.options.color;o.setStyle({color:this.options.drawError.color}),u&&u.updateContent({text:L.drawLocal.draw.handlers.polyline.error}),setTimeout(function(){o.setStyle({color:f}),u&&u.updateContent({text:L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.edit.handlers.edit.tooltip.subtext})},1e3)}}s._middleLeft&&s._middleLeft.setLatLng(this._getMiddleLatLng(s._prev,s)),s._middleRight&&s._middleRight.setLatLng(this._getMiddleLatLng(s,s._next)),this._poly._bounds._southWest=L.latLng(1/0,1/0),this._poly._bounds._northEast=L.latLng(-1/0,-1/0);var d=this._poly.getLatLngs();this._poly._convertLatLngs(d,!0),this._poly.redraw(),this._poly.fire("editdrag")},_onMarkerClick:function(i){var s=L.Polygon&&this._poly instanceof L.Polygon?4:3,o=i.target;this._defaultShape().length<s||(this._removeMarker(o),this._updatePrevNext(o._prev,o._next),o._middleLeft&&this._markerGroup.removeLayer(o._middleLeft),o._middleRight&&this._markerGroup.removeLayer(o._middleRight),o._prev&&o._next?this._createMiddleMarker(o._prev,o._next):o._prev?o._next||(o._prev._middleRight=null):o._next._middleLeft=null,this._fireEdit())},_onContextMenu:function(i){var s=i.target;this._poly,this._poly._map.fire(L.Draw.Event.MARKERCONTEXT,{marker:s,layers:this._markerGroup,poly:this._poly}),L.DomEvent.stopPropagation},_onTouchMove:function(i){var s=this._map.mouseEventToLayerPoint(i.originalEvent.touches[0]),o=this._map.layerPointToLatLng(s),l=i.target;L.extend(l._origLatLng,o),l._middleLeft&&l._middleLeft.setLatLng(this._getMiddleLatLng(l._prev,l)),l._middleRight&&l._middleRight.setLatLng(this._getMiddleLatLng(l,l._next)),this._poly.redraw(),this.updateMarkers()},_updateIndexes:function(i,s){this._markerGroup.eachLayer(function(o){o._index>i&&(o._index+=s)})},_createMiddleMarker:function(i,s){var o,l,u,f=this._getMiddleLatLng(i,s),d=this._createMarker(f);d.setOpacity(.6),i._middleRight=s._middleLeft=d,l=function(){d.off("touchmove",l,this);var p=s._index;d._index=p,d.off("click",o,this).on("click",this._onMarkerClick,this),f.lat=d.getLatLng().lat,f.lng=d.getLatLng().lng,this._spliceLatLngs(p,0,f),this._markers.splice(p,0,d),d.setOpacity(1),this._updateIndexes(p,1),s._index++,this._updatePrevNext(i,d),this._updatePrevNext(d,s),this._poly.fire("editstart")},u=function(){d.off("dragstart",l,this),d.off("dragend",u,this),d.off("touchmove",l,this),this._createMiddleMarker(i,d),this._createMiddleMarker(d,s)},o=function(){l.call(this),u.call(this),this._fireEdit()},d.on("click",o,this).on("dragstart",l,this).on("dragend",u,this).on("touchmove",l,this),this._markerGroup.addLayer(d)},_updatePrevNext:function(i,s){i&&(i._next=s),s&&(s._prev=i)},_getMiddleLatLng:function(i,s){var o=this._poly._map,l=o.project(i.getLatLng()),u=o.project(s.getLatLng());return o.unproject(l._add(u)._divideBy(2))}}),L.Polyline.addInitHook(function(){this.editing||(L.Edit.Poly&&(this.editing=new L.Edit.Poly(this),this.options.editable&&this.editing.enable()),this.on("add",function(){this.editing&&this.editing.enabled()&&this.editing.addHooks()}),this.on("remove",function(){this.editing&&this.editing.enabled()&&this.editing.removeHooks()}))}),L.Edit=L.Edit||{},L.Edit.SimpleShape=L.Handler.extend({options:{moveIcon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-move"}),resizeIcon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-resize"}),touchMoveIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-move leaflet-touch-icon"}),touchResizeIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-resize leaflet-touch-icon"})},initialize:function(i,s){L.Browser.touch&&(this.options.moveIcon=this.options.touchMoveIcon,this.options.resizeIcon=this.options.touchResizeIcon),this._shape=i,L.Util.setOptions(this,s)},addHooks:function(){var i=this._shape;this._shape._map&&(this._map=this._shape._map,i.setStyle(i.options.editing),i._map&&(this._map=i._map,this._markerGroup||this._initMarkers(),this._map.addLayer(this._markerGroup)))},removeHooks:function(){var i=this._shape;if(i.setStyle(i.options.original),i._map){this._unbindMarker(this._moveMarker);for(var s=0,o=this._resizeMarkers.length;s<o;s++)this._unbindMarker(this._resizeMarkers[s]);this._resizeMarkers=null,this._map.removeLayer(this._markerGroup),delete this._markerGroup}this._map=null},updateMarkers:function(){this._markerGroup.clearLayers(),this._initMarkers()},_initMarkers:function(){this._markerGroup||(this._markerGroup=new L.LayerGroup),this._createMoveMarker(),this._createResizeMarker()},_createMoveMarker:function(){},_createResizeMarker:function(){},_createMarker:function(i,s){var o=new L.Marker.Touch(i,{draggable:!0,icon:s,zIndexOffset:10});return this._bindMarker(o),this._markerGroup.addLayer(o),o},_bindMarker:function(i){i.on("dragstart",this._onMarkerDragStart,this).on("drag",this._onMarkerDrag,this).on("dragend",this._onMarkerDragEnd,this).on("touchstart",this._onTouchStart,this).on("touchmove",this._onTouchMove,this).on("MSPointerMove",this._onTouchMove,this).on("touchend",this._onTouchEnd,this).on("MSPointerUp",this._onTouchEnd,this)},_unbindMarker:function(i){i.off("dragstart",this._onMarkerDragStart,this).off("drag",this._onMarkerDrag,this).off("dragend",this._onMarkerDragEnd,this).off("touchstart",this._onTouchStart,this).off("touchmove",this._onTouchMove,this).off("MSPointerMove",this._onTouchMove,this).off("touchend",this._onTouchEnd,this).off("MSPointerUp",this._onTouchEnd,this)},_onMarkerDragStart:function(i){i.target.setOpacity(0),this._shape.fire("editstart")},_fireEdit:function(){this._shape.edited=!0,this._shape.fire("edit")},_onMarkerDrag:function(i){var s=i.target,o=s.getLatLng();s===this._moveMarker?this._move(o):this._resize(o),this._shape.redraw(),this._shape.fire("editdrag")},_onMarkerDragEnd:function(i){i.target.setOpacity(1),this._fireEdit()},_onTouchStart:function(i){if(L.Edit.SimpleShape.prototype._onMarkerDragStart.call(this,i),typeof this._getCorners=="function"){var s=this._getCorners(),o=i.target,l=o._cornerIndex;o.setOpacity(0),this._oppositeCorner=s[(l+2)%4],this._toggleCornerMarkers(0,l)}this._shape.fire("editstart")},_onTouchMove:function(i){var s=this._map.mouseEventToLayerPoint(i.originalEvent.touches[0]),o=this._map.layerPointToLatLng(s);return i.target===this._moveMarker?this._move(o):this._resize(o),this._shape.redraw(),!1},_onTouchEnd:function(i){i.target.setOpacity(1),this.updateMarkers(),this._fireEdit()},_move:function(){},_resize:function(){}}),L.Edit=L.Edit||{},L.Edit.Rectangle=L.Edit.SimpleShape.extend({_createMoveMarker:function(){var i=this._shape.getBounds(),s=i.getCenter();this._moveMarker=this._createMarker(s,this.options.moveIcon)},_createResizeMarker:function(){var i=this._getCorners();this._resizeMarkers=[];for(var s=0,o=i.length;s<o;s++)this._resizeMarkers.push(this._createMarker(i[s],this.options.resizeIcon)),this._resizeMarkers[s]._cornerIndex=s},_onMarkerDragStart:function(i){L.Edit.SimpleShape.prototype._onMarkerDragStart.call(this,i);var s=this._getCorners(),o=i.target,l=o._cornerIndex;this._oppositeCorner=s[(l+2)%4],this._toggleCornerMarkers(0,l)},_onMarkerDragEnd:function(i){var s,o,l=i.target;l===this._moveMarker&&(s=this._shape.getBounds(),o=s.getCenter(),l.setLatLng(o)),this._toggleCornerMarkers(1),this._repositionCornerMarkers(),L.Edit.SimpleShape.prototype._onMarkerDragEnd.call(this,i)},_move:function(i){for(var s,o=this._shape._defaultShape?this._shape._defaultShape():this._shape.getLatLngs(),l=this._shape.getBounds(),u=l.getCenter(),f=[],d=0,p=o.length;d<p;d++)s=[o[d].lat-u.lat,o[d].lng-u.lng],f.push([i.lat+s[0],i.lng+s[1]]);this._shape.setLatLngs(f),this._repositionCornerMarkers(),this._map.fire(L.Draw.Event.EDITMOVE,{layer:this._shape})},_resize:function(i){var s;this._shape.setBounds(L.latLngBounds(i,this._oppositeCorner)),s=this._shape.getBounds(),this._moveMarker.setLatLng(s.getCenter()),this._map.fire(L.Draw.Event.EDITRESIZE,{layer:this._shape})},_getCorners:function(){var i=this._shape.getBounds();return[i.getNorthWest(),i.getNorthEast(),i.getSouthEast(),i.getSouthWest()]},_toggleCornerMarkers:function(i){for(var s=0,o=this._resizeMarkers.length;s<o;s++)this._resizeMarkers[s].setOpacity(i)},_repositionCornerMarkers:function(){for(var i=this._getCorners(),s=0,o=this._resizeMarkers.length;s<o;s++)this._resizeMarkers[s].setLatLng(i[s])}}),L.Rectangle.addInitHook(function(){L.Edit.Rectangle&&(this.editing=new L.Edit.Rectangle(this),this.options.editable&&this.editing.enable())}),L.Edit=L.Edit||{},L.Edit.CircleMarker=L.Edit.SimpleShape.extend({_createMoveMarker:function(){var i=this._shape.getLatLng();this._moveMarker=this._createMarker(i,this.options.moveIcon)},_createResizeMarker:function(){this._resizeMarkers=[]},_move:function(i){if(this._resizeMarkers.length){var s=this._getResizeMarkerPoint(i);this._resizeMarkers[0].setLatLng(s)}this._shape.setLatLng(i),this._map.fire(L.Draw.Event.EDITMOVE,{layer:this._shape})}}),L.CircleMarker.addInitHook(function(){L.Edit.CircleMarker&&(this.editing=new L.Edit.CircleMarker(this),this.options.editable&&this.editing.enable()),this.on("add",function(){this.editing&&this.editing.enabled()&&this.editing.addHooks()}),this.on("remove",function(){this.editing&&this.editing.enabled()&&this.editing.removeHooks()})}),L.Edit=L.Edit||{},L.Edit.Circle=L.Edit.CircleMarker.extend({_createResizeMarker:function(){var i=this._shape.getLatLng(),s=this._getResizeMarkerPoint(i);this._resizeMarkers=[],this._resizeMarkers.push(this._createMarker(s,this.options.resizeIcon))},_getResizeMarkerPoint:function(i){var s=this._shape._radius*Math.cos(Math.PI/4),o=this._map.project(i);return this._map.unproject([o.x+s,o.y-s])},_resize:function(i){var s=this._moveMarker.getLatLng();L.GeometryUtil.isVersion07x()?radius=s.distanceTo(i):radius=this._map.distance(s,i),this._shape.setRadius(radius),this._map.editTooltip&&this._map._editTooltip.updateContent({text:L.drawLocal.edit.handlers.edit.tooltip.subtext+"<br />"+L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.draw.handlers.circle.radius+": "+L.GeometryUtil.readableDistance(radius,!0,this.options.feet,this.options.nautic)}),this._shape.setRadius(radius),this._map.fire(L.Draw.Event.EDITRESIZE,{layer:this._shape})}}),L.Circle.addInitHook(function(){L.Edit.Circle&&(this.editing=new L.Edit.Circle(this),this.options.editable&&this.editing.enable())}),L.Map.mergeOptions({touchExtend:!0}),L.Map.TouchExtend=L.Handler.extend({initialize:function(i){this._map=i,this._container=i._container,this._pane=i._panes.overlayPane},addHooks:function(){L.DomEvent.on(this._container,"touchstart",this._onTouchStart,this),L.DomEvent.on(this._container,"touchend",this._onTouchEnd,this),L.DomEvent.on(this._container,"touchmove",this._onTouchMove,this),this._detectIE()?(L.DomEvent.on(this._container,"MSPointerDown",this._onTouchStart,this),L.DomEvent.on(this._container,"MSPointerUp",this._onTouchEnd,this),L.DomEvent.on(this._container,"MSPointerMove",this._onTouchMove,this),L.DomEvent.on(this._container,"MSPointerCancel",this._onTouchCancel,this)):(L.DomEvent.on(this._container,"touchcancel",this._onTouchCancel,this),L.DomEvent.on(this._container,"touchleave",this._onTouchLeave,this))},removeHooks:function(){L.DomEvent.off(this._container,"touchstart",this._onTouchStart,this),L.DomEvent.off(this._container,"touchend",this._onTouchEnd,this),L.DomEvent.off(this._container,"touchmove",this._onTouchMove,this),this._detectIE()?(L.DomEvent.off(this._container,"MSPointerDown",this._onTouchStart,this),L.DomEvent.off(this._container,"MSPointerUp",this._onTouchEnd,this),L.DomEvent.off(this._container,"MSPointerMove",this._onTouchMove,this),L.DomEvent.off(this._container,"MSPointerCancel",this._onTouchCancel,this)):(L.DomEvent.off(this._container,"touchcancel",this._onTouchCancel,this),L.DomEvent.off(this._container,"touchleave",this._onTouchLeave,this))},_touchEvent:function(i,s){var o={};if(i.touches!==void 0){if(!i.touches.length)return;o=i.touches[0]}else if(i.pointerType!=="touch"||(o=i,!this._filterClick(i)))return;var l=this._map.mouseEventToContainerPoint(o),u=this._map.mouseEventToLayerPoint(o),f=this._map.layerPointToLatLng(u);this._map.fire(s,{latlng:f,layerPoint:u,containerPoint:l,pageX:o.pageX,pageY:o.pageY,originalEvent:i})},_filterClick:function(i){var s=i.timeStamp||i.originalEvent.timeStamp,o=L.DomEvent._lastClick&&s-L.DomEvent._lastClick;return o&&o>100&&o<500||i.target._simulatedClick&&!i._simulated?(L.DomEvent.stop(i),!1):(L.DomEvent._lastClick=s,!0)},_onTouchStart:function(i){this._map._loaded&&this._touchEvent(i,"touchstart")},_onTouchEnd:function(i){this._map._loaded&&this._touchEvent(i,"touchend")},_onTouchCancel:function(i){if(this._map._loaded){var s="touchcancel";this._detectIE()&&(s="pointercancel"),this._touchEvent(i,s)}},_onTouchLeave:function(i){this._map._loaded&&this._touchEvent(i,"touchleave")},_onTouchMove:function(i){this._map._loaded&&this._touchEvent(i,"touchmove")},_detectIE:function(){var i=h.navigator.userAgent,s=i.indexOf("MSIE ");if(s>0)return parseInt(i.substring(s+5,i.indexOf(".",s)),10);if(i.indexOf("Trident/")>0){var o=i.indexOf("rv:");return parseInt(i.substring(o+3,i.indexOf(".",o)),10)}var l=i.indexOf("Edge/");return l>0&&parseInt(i.substring(l+5,i.indexOf(".",l)),10)}}),L.Map.addInitHook("addHandler","touchExtend",L.Map.TouchExtend),L.Marker.Touch=L.Marker.extend({_initInteraction:function(){return this.addInteractiveTarget?L.Marker.prototype._initInteraction.apply(this):this._initInteractionLegacy()},_initInteractionLegacy:function(){if(this.options.clickable){var i=this._icon,s=["dblclick","mousedown","mouseover","mouseout","contextmenu","touchstart","touchend","touchmove"];this._detectIE?s.concat(["MSPointerDown","MSPointerUp","MSPointerMove","MSPointerCancel"]):s.concat(["touchcancel"]),L.DomUtil.addClass(i,"leaflet-clickable"),L.DomEvent.on(i,"click",this._onMouseClick,this),L.DomEvent.on(i,"keypress",this._onKeyPress,this);for(var o=0;o<s.length;o++)L.DomEvent.on(i,s[o],this._fireMouseEvent,this);L.Handler.MarkerDrag&&(this.dragging=new L.Handler.MarkerDrag(this),this.options.draggable&&this.dragging.enable())}},_detectIE:function(){var i=h.navigator.userAgent,s=i.indexOf("MSIE ");if(s>0)return parseInt(i.substring(s+5,i.indexOf(".",s)),10);if(i.indexOf("Trident/")>0){var o=i.indexOf("rv:");return parseInt(i.substring(o+3,i.indexOf(".",o)),10)}var l=i.indexOf("Edge/");return l>0&&parseInt(i.substring(l+5,i.indexOf(".",l)),10)}}),L.LatLngUtil={cloneLatLngs:function(i){for(var s=[],o=0,l=i.length;o<l;o++)Array.isArray(i[o])?s.push(L.LatLngUtil.cloneLatLngs(i[o])):s.push(this.cloneLatLng(i[o]));return s},cloneLatLng:function(i){return L.latLng(i.lat,i.lng)}},function(){var i={km:2,ha:2,m:0,mi:2,ac:2,yd:0,ft:0,nm:2};L.GeometryUtil=L.extend(L.GeometryUtil||{},{geodesicArea:function(s){var o,l,u=s.length,f=0,d=Math.PI/180;if(u>2){for(var p=0;p<u;p++)o=s[p],l=s[(p+1)%u],f+=(l.lng-o.lng)*d*(2+Math.sin(o.lat*d)+Math.sin(l.lat*d));f=6378137*f*6378137/2}return Math.abs(f)},formattedNumber:function(s,o){var l=parseFloat(s).toFixed(o),u=L.drawLocal.format&&L.drawLocal.format.numeric,f=u&&u.delimiters,d=f&&f.thousands,p=f&&f.decimal;if(d||p){var g=l.split(".");l=d?g[0].replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1"+d):g[0],p=p||".",g.length>1&&(l=l+p+g[1])}return l},readableArea:function(s,o,d){var u,f,d=L.Util.extend({},i,d);return o?(f=["ha","m"],type=typeof o,type==="string"?f=[o]:type!=="boolean"&&(f=o),u=s>=1e6&&f.indexOf("km")!==-1?L.GeometryUtil.formattedNumber(1e-6*s,d.km)+" km":s>=1e4&&f.indexOf("ha")!==-1?L.GeometryUtil.formattedNumber(1e-4*s,d.ha)+" ha":L.GeometryUtil.formattedNumber(s,d.m)+" m"):(s/=.836127,u=s>=3097600?L.GeometryUtil.formattedNumber(s/3097600,d.mi)+" mi":s>=4840?L.GeometryUtil.formattedNumber(s/4840,d.ac)+" acres":L.GeometryUtil.formattedNumber(s,d.yd)+" yd"),u},readableDistance:function(s,o,l,u,p){var d,p=L.Util.extend({},i,p);switch(o?typeof o=="string"?o:"metric":l?"feet":u?"nauticalMile":"yards"){case"metric":d=s>1e3?L.GeometryUtil.formattedNumber(s/1e3,p.km)+" km":L.GeometryUtil.formattedNumber(s,p.m)+" m";break;case"feet":s*=3.28083,d=L.GeometryUtil.formattedNumber(s,p.ft)+" ft";break;case"nauticalMile":s*=.53996,d=L.GeometryUtil.formattedNumber(s/1e3,p.nm)+" nm";break;case"yards":default:s*=1.09361,d=s>1760?L.GeometryUtil.formattedNumber(s/1760,p.mi)+" miles":L.GeometryUtil.formattedNumber(s,p.yd)+" yd"}return d},isVersion07x:function(){var s=L.version.split(".");return parseInt(s[0],10)===0&&parseInt(s[1],10)===7}})}(),L.Util.extend(L.LineUtil,{segmentsIntersect:function(i,s,o,l){return this._checkCounterclockwise(i,o,l)!==this._checkCounterclockwise(s,o,l)&&this._checkCounterclockwise(i,s,o)!==this._checkCounterclockwise(i,s,l)},_checkCounterclockwise:function(i,s,o){return(o.y-i.y)*(s.x-i.x)>(s.y-i.y)*(o.x-i.x)}}),L.Polyline.include({intersects:function(){var i,s,o,l=this._getProjectedPoints(),u=l?l.length:0;if(this._tooFewPointsForIntersection())return!1;for(i=u-1;i>=3;i--)if(s=l[i-1],o=l[i],this._lineSegmentsIntersectsRange(s,o,i-2))return!0;return!1},newLatLngIntersects:function(i,s){return!!this._map&&this.newPointIntersects(this._map.latLngToLayerPoint(i),s)},newPointIntersects:function(i,s){var o=this._getProjectedPoints(),l=o?o.length:0,u=o?o[l-1]:null,f=l-2;return!this._tooFewPointsForIntersection(1)&&this._lineSegmentsIntersectsRange(u,i,f,s?1:0)},_tooFewPointsForIntersection:function(i){var s=this._getProjectedPoints(),o=s?s.length:0;return o+=i||0,!s||o<=3},_lineSegmentsIntersectsRange:function(i,s,o,l){var u,f,d=this._getProjectedPoints();l=l||0;for(var p=o;p>l;p--)if(u=d[p-1],f=d[p],L.LineUtil.segmentsIntersect(i,s,u,f))return!0;return!1},_getProjectedPoints:function(){if(!this._defaultShape)return this._originalPoints;for(var i=[],s=this._defaultShape(),o=0;o<s.length;o++)i.push(this._map.latLngToLayerPoint(s[o]));return i}}),L.Polygon.include({intersects:function(){var i,s,o,l,u=this._getProjectedPoints();return!this._tooFewPointsForIntersection()&&(!!L.Polyline.prototype.intersects.call(this)||(i=u.length,s=u[0],o=u[i-1],l=i-2,this._lineSegmentsIntersectsRange(o,s,l,1)))}}),L.Control.Draw=L.Control.extend({options:{position:"topleft",draw:{},edit:!1},initialize:function(i){if(L.version<"0.7")throw new Error("Leaflet.draw 0.2.3+ requires Leaflet 0.7.0+. Download latest from https://github.com/Leaflet/Leaflet/");L.Control.prototype.initialize.call(this,i);var s;this._toolbars={},L.DrawToolbar&&this.options.draw&&(s=new L.DrawToolbar(this.options.draw),this._toolbars[L.DrawToolbar.TYPE]=s,this._toolbars[L.DrawToolbar.TYPE].on("enable",this._toolbarEnabled,this)),L.EditToolbar&&this.options.edit&&(s=new L.EditToolbar(this.options.edit),this._toolbars[L.EditToolbar.TYPE]=s,this._toolbars[L.EditToolbar.TYPE].on("enable",this._toolbarEnabled,this)),L.toolbar=this},onAdd:function(i){var s,o=L.DomUtil.create("div","leaflet-draw"),l=!1;for(var u in this._toolbars)this._toolbars.hasOwnProperty(u)&&(s=this._toolbars[u].addToolbar(i))&&(l||(L.DomUtil.hasClass(s,"leaflet-draw-toolbar-top")||L.DomUtil.addClass(s.childNodes[0],"leaflet-draw-toolbar-top"),l=!0),o.appendChild(s));return o},onRemove:function(){for(var i in this._toolbars)this._toolbars.hasOwnProperty(i)&&this._toolbars[i].removeToolbar()},setDrawingOptions:function(i){for(var s in this._toolbars)this._toolbars[s]instanceof L.DrawToolbar&&this._toolbars[s].setOptions(i)},_toolbarEnabled:function(i){var s=i.target;for(var o in this._toolbars)this._toolbars[o]!==s&&this._toolbars[o].disable()}}),L.Map.mergeOptions({drawControlTooltips:!0,drawControl:!1}),L.Map.addInitHook(function(){this.options.drawControl&&(this.drawControl=new L.Control.Draw,this.addControl(this.drawControl))}),L.Toolbar=L.Class.extend({initialize:function(i){L.setOptions(this,i),this._modes={},this._actionButtons=[],this._activeMode=null;var s=L.version.split(".");parseInt(s[0],10)===1&&parseInt(s[1],10)>=2?L.Toolbar.include(L.Evented.prototype):L.Toolbar.include(L.Mixin.Events)},enabled:function(){return this._activeMode!==null},disable:function(){this.enabled()&&this._activeMode.handler.disable()},addToolbar:function(i){var s,o=L.DomUtil.create("div","leaflet-draw-section"),l=0,u=this._toolbarClass||"",f=this.getModeHandlers(i);for(this._toolbarContainer=L.DomUtil.create("div","leaflet-draw-toolbar leaflet-bar"),this._map=i,s=0;s<f.length;s++)f[s].enabled&&this._initModeHandler(f[s].handler,this._toolbarContainer,l++,u,f[s].title);if(l)return this._lastButtonIndex=--l,this._actionsContainer=L.DomUtil.create("ul","leaflet-draw-actions"),o.appendChild(this._toolbarContainer),o.appendChild(this._actionsContainer),o},removeToolbar:function(){for(var i in this._modes)this._modes.hasOwnProperty(i)&&(this._disposeButton(this._modes[i].button,this._modes[i].handler.enable,this._modes[i].handler),this._modes[i].handler.disable(),this._modes[i].handler.off("enabled",this._handlerActivated,this).off("disabled",this._handlerDeactivated,this));this._modes={};for(var s=0,o=this._actionButtons.length;s<o;s++)this._disposeButton(this._actionButtons[s].button,this._actionButtons[s].callback,this);this._actionButtons=[],this._actionsContainer=null},_initModeHandler:function(i,s,o,l,u){var f=i.type;this._modes[f]={},this._modes[f].handler=i,this._modes[f].button=this._createButton({type:f,title:u,className:l+"-"+f,container:s,callback:this._modes[f].handler.enable,context:this._modes[f].handler}),this._modes[f].buttonIndex=o,this._modes[f].handler.on("enabled",this._handlerActivated,this).on("disabled",this._handlerDeactivated,this)},_detectIOS:function(){return/iPad|iPhone|iPod/.test(navigator.userAgent)&&!h.MSStream},_createButton:function(i){var s=L.DomUtil.create("a",i.className||"",i.container),o=L.DomUtil.create("span","sr-only",i.container);s.href="#",s.appendChild(o),i.title&&(s.title=i.title,o.innerHTML=i.title),i.text&&(s.innerHTML=i.text,o.innerHTML=i.text);var l=this._detectIOS()?"touchstart":"click";return L.DomEvent.on(s,"click",L.DomEvent.stopPropagation).on(s,"mousedown",L.DomEvent.stopPropagation).on(s,"dblclick",L.DomEvent.stopPropagation).on(s,"touchstart",L.DomEvent.stopPropagation).on(s,"click",L.DomEvent.preventDefault).on(s,l,i.callback,i.context),s},_disposeButton:function(i,s){var o=this._detectIOS()?"touchstart":"click";L.DomEvent.off(i,"click",L.DomEvent.stopPropagation).off(i,"mousedown",L.DomEvent.stopPropagation).off(i,"dblclick",L.DomEvent.stopPropagation).off(i,"touchstart",L.DomEvent.stopPropagation).off(i,"click",L.DomEvent.preventDefault).off(i,o,s)},_handlerActivated:function(i){this.disable(),this._activeMode=this._modes[i.handler],L.DomUtil.addClass(this._activeMode.button,"leaflet-draw-toolbar-button-enabled"),this._showActionsToolbar(),this.fire("enable")},_handlerDeactivated:function(){this._hideActionsToolbar(),L.DomUtil.removeClass(this._activeMode.button,"leaflet-draw-toolbar-button-enabled"),this._activeMode=null,this.fire("disable")},_createActions:function(i){var s,o,l,u,f=this._actionsContainer,d=this.getActions(i),p=d.length;for(o=0,l=this._actionButtons.length;o<l;o++)this._disposeButton(this._actionButtons[o].button,this._actionButtons[o].callback);for(this._actionButtons=[];f.firstChild;)f.removeChild(f.firstChild);for(var g=0;g<p;g++)"enabled"in d[g]&&!d[g].enabled||(s=L.DomUtil.create("li","",f),u=this._createButton({title:d[g].title,text:d[g].text,container:s,callback:d[g].callback,context:d[g].context}),this._actionButtons.push({button:u,callback:d[g].callback}))},_showActionsToolbar:function(){var i=this._activeMode.buttonIndex,s=this._lastButtonIndex,o=this._activeMode.button.offsetTop-1;this._createActions(this._activeMode.handler),this._actionsContainer.style.top=o+"px",i===0&&(L.DomUtil.addClass(this._toolbarContainer,"leaflet-draw-toolbar-notop"),L.DomUtil.addClass(this._actionsContainer,"leaflet-draw-actions-top")),i===s&&(L.DomUtil.addClass(this._toolbarContainer,"leaflet-draw-toolbar-nobottom"),L.DomUtil.addClass(this._actionsContainer,"leaflet-draw-actions-bottom")),this._actionsContainer.style.display="block",this._map.fire(L.Draw.Event.TOOLBAROPENED)},_hideActionsToolbar:function(){this._actionsContainer.style.display="none",L.DomUtil.removeClass(this._toolbarContainer,"leaflet-draw-toolbar-notop"),L.DomUtil.removeClass(this._toolbarContainer,"leaflet-draw-toolbar-nobottom"),L.DomUtil.removeClass(this._actionsContainer,"leaflet-draw-actions-top"),L.DomUtil.removeClass(this._actionsContainer,"leaflet-draw-actions-bottom"),this._map.fire(L.Draw.Event.TOOLBARCLOSED)}}),L.Draw=L.Draw||{},L.Draw.Tooltip=L.Class.extend({initialize:function(i){this._map=i,this._popupPane=i._panes.popupPane,this._visible=!1,this._container=i.options.drawControlTooltips?L.DomUtil.create("div","leaflet-draw-tooltip",this._popupPane):null,this._singleLineLabel=!1,this._map.on("mouseout",this._onMouseOut,this)},dispose:function(){this._map.off("mouseout",this._onMouseOut,this),this._container&&(this._popupPane.removeChild(this._container),this._container=null)},updateContent:function(i){return this._container?(i.subtext=i.subtext||"",i.subtext.length!==0||this._singleLineLabel?i.subtext.length>0&&this._singleLineLabel&&(L.DomUtil.removeClass(this._container,"leaflet-draw-tooltip-single"),this._singleLineLabel=!1):(L.DomUtil.addClass(this._container,"leaflet-draw-tooltip-single"),this._singleLineLabel=!0),this._container.innerHTML=(i.subtext.length>0?'<span class="leaflet-draw-tooltip-subtext">'+i.subtext+"</span><br />":"")+"<span>"+i.text+"</span>",i.text||i.subtext?(this._visible=!0,this._container.style.visibility="inherit"):(this._visible=!1,this._container.style.visibility="hidden"),this):this},updatePosition:function(i){var s=this._map.latLngToLayerPoint(i),o=this._container;return this._container&&(this._visible&&(o.style.visibility="inherit"),L.DomUtil.setPosition(o,s)),this},showAsError:function(){return this._container&&L.DomUtil.addClass(this._container,"leaflet-error-draw-tooltip"),this},removeError:function(){return this._container&&L.DomUtil.removeClass(this._container,"leaflet-error-draw-tooltip"),this},_onMouseOut:function(){this._container&&(this._container.style.visibility="hidden")}}),L.DrawToolbar=L.Toolbar.extend({statics:{TYPE:"draw"},options:{polyline:{},polygon:{},rectangle:{},circle:{},marker:{},circlemarker:{}},initialize:function(i){for(var s in this.options)this.options.hasOwnProperty(s)&&i[s]&&(i[s]=L.extend({},this.options[s],i[s]));this._toolbarClass="leaflet-draw-draw",L.Toolbar.prototype.initialize.call(this,i)},getModeHandlers:function(i){return[{enabled:this.options.polyline,handler:new L.Draw.Polyline(i,this.options.polyline),title:L.drawLocal.draw.toolbar.buttons.polyline},{enabled:this.options.polygon,handler:new L.Draw.Polygon(i,this.options.polygon),title:L.drawLocal.draw.toolbar.buttons.polygon},{enabled:this.options.rectangle,handler:new L.Draw.Rectangle(i,this.options.rectangle),title:L.drawLocal.draw.toolbar.buttons.rectangle},{enabled:this.options.circle,handler:new L.Draw.Circle(i,this.options.circle),title:L.drawLocal.draw.toolbar.buttons.circle},{enabled:this.options.marker,handler:new L.Draw.Marker(i,this.options.marker),title:L.drawLocal.draw.toolbar.buttons.marker},{enabled:this.options.circlemarker,handler:new L.Draw.CircleMarker(i,this.options.circlemarker),title:L.drawLocal.draw.toolbar.buttons.circlemarker}]},getActions:function(i){return[{enabled:i.completeShape,title:L.drawLocal.draw.toolbar.finish.title,text:L.drawLocal.draw.toolbar.finish.text,callback:i.completeShape,context:i},{enabled:i.deleteLastVertex,title:L.drawLocal.draw.toolbar.undo.title,text:L.drawLocal.draw.toolbar.undo.text,callback:i.deleteLastVertex,context:i},{title:L.drawLocal.draw.toolbar.actions.title,text:L.drawLocal.draw.toolbar.actions.text,callback:this.disable,context:this}]},setOptions:function(i){L.setOptions(this,i);for(var s in this._modes)this._modes.hasOwnProperty(s)&&i.hasOwnProperty(s)&&this._modes[s].handler.setOptions(i[s])}}),L.EditToolbar=L.Toolbar.extend({statics:{TYPE:"edit"},options:{edit:{selectedPathOptions:{dashArray:"10, 10",fill:!0,fillColor:"#fe57a1",fillOpacity:.1,maintainColor:!1}},remove:{},poly:null,featureGroup:null},initialize:function(i){i.edit&&(i.edit.selectedPathOptions===void 0&&(i.edit.selectedPathOptions=this.options.edit.selectedPathOptions),i.edit.selectedPathOptions=L.extend({},this.options.edit.selectedPathOptions,i.edit.selectedPathOptions)),i.remove&&(i.remove=L.extend({},this.options.remove,i.remove)),i.poly&&(i.poly=L.extend({},this.options.poly,i.poly)),this._toolbarClass="leaflet-draw-edit",L.Toolbar.prototype.initialize.call(this,i),this._selectedFeatureCount=0},getModeHandlers:function(i){var s=this.options.featureGroup;return[{enabled:this.options.edit,handler:new L.EditToolbar.Edit(i,{featureGroup:s,selectedPathOptions:this.options.edit.selectedPathOptions,poly:this.options.poly}),title:L.drawLocal.edit.toolbar.buttons.edit},{enabled:this.options.remove,handler:new L.EditToolbar.Delete(i,{featureGroup:s}),title:L.drawLocal.edit.toolbar.buttons.remove}]},getActions:function(i){var s=[{title:L.drawLocal.edit.toolbar.actions.save.title,text:L.drawLocal.edit.toolbar.actions.save.text,callback:this._save,context:this},{title:L.drawLocal.edit.toolbar.actions.cancel.title,text:L.drawLocal.edit.toolbar.actions.cancel.text,callback:this.disable,context:this}];return i.removeAllLayers&&s.push({title:L.drawLocal.edit.toolbar.actions.clearAll.title,text:L.drawLocal.edit.toolbar.actions.clearAll.text,callback:this._clearAllLayers,context:this}),s},addToolbar:function(i){var s=L.Toolbar.prototype.addToolbar.call(this,i);return this._checkDisabled(),this.options.featureGroup.on("layeradd layerremove",this._checkDisabled,this),s},removeToolbar:function(){this.options.featureGroup.off("layeradd layerremove",this._checkDisabled,this),L.Toolbar.prototype.removeToolbar.call(this)},disable:function(){this.enabled()&&(this._activeMode.handler.revertLayers(),L.Toolbar.prototype.disable.call(this))},_save:function(){this._activeMode.handler.save(),this._activeMode&&this._activeMode.handler.disable()},_clearAllLayers:function(){this._activeMode.handler.removeAllLayers(),this._activeMode&&this._activeMode.handler.disable()},_checkDisabled:function(){var i,s=this.options.featureGroup,o=s.getLayers().length!==0;this.options.edit&&(i=this._modes[L.EditToolbar.Edit.TYPE].button,o?L.DomUtil.removeClass(i,"leaflet-disabled"):L.DomUtil.addClass(i,"leaflet-disabled"),i.setAttribute("title",o?L.drawLocal.edit.toolbar.buttons.edit:L.drawLocal.edit.toolbar.buttons.editDisabled)),this.options.remove&&(i=this._modes[L.EditToolbar.Delete.TYPE].button,o?L.DomUtil.removeClass(i,"leaflet-disabled"):L.DomUtil.addClass(i,"leaflet-disabled"),i.setAttribute("title",o?L.drawLocal.edit.toolbar.buttons.remove:L.drawLocal.edit.toolbar.buttons.removeDisabled))}}),L.EditToolbar.Edit=L.Handler.extend({statics:{TYPE:"edit"},initialize:function(i,s){if(L.Handler.prototype.initialize.call(this,i),L.setOptions(this,s),this._featureGroup=s.featureGroup,!(this._featureGroup instanceof L.FeatureGroup))throw new Error("options.featureGroup must be a L.FeatureGroup");this._uneditedLayerProps={},this.type=L.EditToolbar.Edit.TYPE;var o=L.version.split(".");parseInt(o[0],10)===1&&parseInt(o[1],10)>=2?L.EditToolbar.Edit.include(L.Evented.prototype):L.EditToolbar.Edit.include(L.Mixin.Events)},enable:function(){!this._enabled&&this._hasAvailableLayers()&&(this.fire("enabled",{handler:this.type}),this._map.fire(L.Draw.Event.EDITSTART,{handler:this.type}),L.Handler.prototype.enable.call(this),this._featureGroup.on("layeradd",this._enableLayerEdit,this).on("layerremove",this._disableLayerEdit,this))},disable:function(){this._enabled&&(this._featureGroup.off("layeradd",this._enableLayerEdit,this).off("layerremove",this._disableLayerEdit,this),L.Handler.prototype.disable.call(this),this._map.fire(L.Draw.Event.EDITSTOP,{handler:this.type}),this.fire("disabled",{handler:this.type}))},addHooks:function(){var i=this._map;i&&(i.getContainer().focus(),this._featureGroup.eachLayer(this._enableLayerEdit,this),this._tooltip=new L.Draw.Tooltip(this._map),this._tooltip.updateContent({text:L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.edit.handlers.edit.tooltip.subtext}),i._editTooltip=this._tooltip,this._updateTooltip(),this._map.on("mousemove",this._onMouseMove,this).on("touchmove",this._onMouseMove,this).on("MSPointerMove",this._onMouseMove,this).on(L.Draw.Event.EDITVERTEX,this._updateTooltip,this))},removeHooks:function(){this._map&&(this._featureGroup.eachLayer(this._disableLayerEdit,this),this._uneditedLayerProps={},this._tooltip.dispose(),this._tooltip=null,this._map.off("mousemove",this._onMouseMove,this).off("touchmove",this._onMouseMove,this).off("MSPointerMove",this._onMouseMove,this).off(L.Draw.Event.EDITVERTEX,this._updateTooltip,this))},revertLayers:function(){this._featureGroup.eachLayer(function(i){this._revertLayer(i)},this)},save:function(){var i=new L.LayerGroup;this._featureGroup.eachLayer(function(s){s.edited&&(i.addLayer(s),s.edited=!1)}),this._map.fire(L.Draw.Event.EDITED,{layers:i})},_backupLayer:function(i){var s=L.Util.stamp(i);this._uneditedLayerProps[s]||(i instanceof L.Polyline||i instanceof L.Polygon||i instanceof L.Rectangle?this._uneditedLayerProps[s]={latlngs:L.LatLngUtil.cloneLatLngs(i.getLatLngs())}:i instanceof L.Circle?this._uneditedLayerProps[s]={latlng:L.LatLngUtil.cloneLatLng(i.getLatLng()),radius:i.getRadius()}:(i instanceof L.Marker||i instanceof L.CircleMarker)&&(this._uneditedLayerProps[s]={latlng:L.LatLngUtil.cloneLatLng(i.getLatLng())}))},_getTooltipText:function(){return{text:L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.edit.handlers.edit.tooltip.subtext}},_updateTooltip:function(){this._tooltip.updateContent(this._getTooltipText())},_revertLayer:function(i){var s=L.Util.stamp(i);i.edited=!1,this._uneditedLayerProps.hasOwnProperty(s)&&(i instanceof L.Polyline||i instanceof L.Polygon||i instanceof L.Rectangle?i.setLatLngs(this._uneditedLayerProps[s].latlngs):i instanceof L.Circle?(i.setLatLng(this._uneditedLayerProps[s].latlng),i.setRadius(this._uneditedLayerProps[s].radius)):(i instanceof L.Marker||i instanceof L.CircleMarker)&&i.setLatLng(this._uneditedLayerProps[s].latlng),i.fire("revert-edited",{layer:i}))},_enableLayerEdit:function(i){var s,o,l=i.layer||i.target||i;this._backupLayer(l),this.options.poly&&(o=L.Util.extend({},this.options.poly),l.options.poly=o),this.options.selectedPathOptions&&(s=L.Util.extend({},this.options.selectedPathOptions),s.maintainColor&&(s.color=l.options.color,s.fillColor=l.options.fillColor),l.options.original=L.extend({},l.options),l.options.editing=s),l instanceof L.Marker?(l.editing&&l.editing.enable(),l.dragging.enable(),l.on("dragend",this._onMarkerDragEnd).on("touchmove",this._onTouchMove,this).on("MSPointerMove",this._onTouchMove,this).on("touchend",this._onMarkerDragEnd,this).on("MSPointerUp",this._onMarkerDragEnd,this)):l.editing.enable()},_disableLayerEdit:function(i){var s=i.layer||i.target||i;s.edited=!1,s.editing&&s.editing.disable(),delete s.options.editing,delete s.options.original,this._selectedPathOptions&&(s instanceof L.Marker?this._toggleMarkerHighlight(s):(s.setStyle(s.options.previousOptions),delete s.options.previousOptions)),s instanceof L.Marker?(s.dragging.disable(),s.off("dragend",this._onMarkerDragEnd,this).off("touchmove",this._onTouchMove,this).off("MSPointerMove",this._onTouchMove,this).off("touchend",this._onMarkerDragEnd,this).off("MSPointerUp",this._onMarkerDragEnd,this)):s.editing.disable()},_onMouseMove:function(i){this._tooltip.updatePosition(i.latlng)},_onMarkerDragEnd:function(i){var s=i.target;s.edited=!0,this._map.fire(L.Draw.Event.EDITMOVE,{layer:s})},_onTouchMove:function(i){var s=i.originalEvent.changedTouches[0],o=this._map.mouseEventToLayerPoint(s),l=this._map.layerPointToLatLng(o);i.target.setLatLng(l)},_hasAvailableLayers:function(){return this._featureGroup.getLayers().length!==0}}),L.EditToolbar.Delete=L.Handler.extend({statics:{TYPE:"remove"},initialize:function(i,s){if(L.Handler.prototype.initialize.call(this,i),L.Util.setOptions(this,s),this._deletableLayers=this.options.featureGroup,!(this._deletableLayers instanceof L.FeatureGroup))throw new Error("options.featureGroup must be a L.FeatureGroup");this.type=L.EditToolbar.Delete.TYPE;var o=L.version.split(".");parseInt(o[0],10)===1&&parseInt(o[1],10)>=2?L.EditToolbar.Delete.include(L.Evented.prototype):L.EditToolbar.Delete.include(L.Mixin.Events)},enable:function(){!this._enabled&&this._hasAvailableLayers()&&(this.fire("enabled",{handler:this.type}),this._map.fire(L.Draw.Event.DELETESTART,{handler:this.type}),L.Handler.prototype.enable.call(this),this._deletableLayers.on("layeradd",this._enableLayerDelete,this).on("layerremove",this._disableLayerDelete,this))},disable:function(){this._enabled&&(this._deletableLayers.off("layeradd",this._enableLayerDelete,this).off("layerremove",this._disableLayerDelete,this),L.Handler.prototype.disable.call(this),this._map.fire(L.Draw.Event.DELETESTOP,{handler:this.type}),this.fire("disabled",{handler:this.type}))},addHooks:function(){var i=this._map;i&&(i.getContainer().focus(),this._deletableLayers.eachLayer(this._enableLayerDelete,this),this._deletedLayers=new L.LayerGroup,this._tooltip=new L.Draw.Tooltip(this._map),this._tooltip.updateContent({text:L.drawLocal.edit.handlers.remove.tooltip.text}),this._map.on("mousemove",this._onMouseMove,this))},removeHooks:function(){this._map&&(this._deletableLayers.eachLayer(this._disableLayerDelete,this),this._deletedLayers=null,this._tooltip.dispose(),this._tooltip=null,this._map.off("mousemove",this._onMouseMove,this))},revertLayers:function(){this._deletedLayers.eachLayer(function(i){this._deletableLayers.addLayer(i),i.fire("revert-deleted",{layer:i})},this)},save:function(){this._map.fire(L.Draw.Event.DELETED,{layers:this._deletedLayers})},removeAllLayers:function(){this._deletableLayers.eachLayer(function(i){this._removeLayer({layer:i})},this),this.save()},_enableLayerDelete:function(i){(i.layer||i.target||i).on("click",this._removeLayer,this)},_disableLayerDelete:function(i){var s=i.layer||i.target||i;s.off("click",this._removeLayer,this),this._deletedLayers.removeLayer(s)},_removeLayer:function(i){var s=i.layer||i.target||i;this._deletableLayers.removeLayer(s),this._deletedLayers.addLayer(s),s.fire("deleted")},_onMouseMove:function(i){this._tooltip.updatePosition(i.latlng)},_hasAvailableLayers:function(){return this._deletableLayers.getLayers().length!==0}})})(window,document);var Li=Vd(()=>sp),op=lr('<div style="height: 600px; width: 100%;" class="svelte-1ymq5l"></div>');function ap(h,t){Da(t,!1);let e=Ws(t,"selectedLayer",8),r=Xr(),i=Xr(null),s=null,o=null;const l=Bc(),u=p=>{Bt(i)&&(s&&Bt(i).removeLayer(s),p?(s=Li().tileLayer(p.value,{attribution:p.attribution}),s.addTo(Bt(i))):(s=Li().tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:"&copy; OpenStreetMap contributors"}),s.addTo(Bt(i))))},f=p=>{o&&Bt(i).removeLayer(o),o=Li().geoJSON(p,{style:{color:"blue",fillColor:"blue",fillOpacity:.6,weight:2}}).addTo(Bt(i))};Xd(()=>{Li().GeometryUtil&&Li(Li().GeometryUtil.readableArea=function(m,x){const y=x?["m","ha","km"]:["ft","ac","mi"],b=x?[1e4,1e6]:[43560,27878400];let P=0;for(;m>b[P]&&P<b.length-1;)m/=b[P],P++;return`${m.toFixed(2)} ${y[P]}`}),le(i,Li().map(Bt(r)).setView([52.474,13.43],13)),u(e());const p=new(Li()).FeatureGroup;Bt(i).addLayer(p);const g=new(Li()).Control.Draw({draw:{polyline:!1,polygon:{shapeOptions:{color:"var(--highlite)",fillColor:"var(--highlite)",fillOpacity:.2,weight:2}},rectangle:{shapeOptions:{color:"var(--highlite)",fillColor:"var(--highlite)",fillOpacity:.2,weight:2}},circle:!0,marker:!1,circlemarker:!1},edit:{featureGroup:p,edit:{selectedPathOptions:{color:"var(--stroke)",fillColor:"var(--highlite)",fillOpacity:.2,weight:2}}}});Bt(i).addControl(g),Bt(i).on(Li().Draw.Event.CREATED,m=>{const{layer:x}=m;p.clearLayers(),x.setStyle({color:"var(--stroke)",fillColor:"var(--highlite)",fillOpacity:.2,weight:2}),p.addLayer(x),l("shapeDrawn",{layer:x})}),Bt(i).on("draw:edited",m=>{m.layers.eachLayer(y=>{const b=Li().GeometryUtil.geodesicArea(y.getLatLngs()[0]),P=y.getLatLngs()[0];l("shapeEdited",{layer:y,area:b,latlngs:P})})}),Bt(i).on("zoomend",()=>{l("mapZoomed",{zoom:Bt(i).getZoom()})})}),ca(()=>Bt(i),()=>{pa.subscribe(p=>{p&&Bt(i)&&f(p)})}),ca(()=>Bt(i),()=>{Ea.subscribe(p=>{p&&Bt(i)&&f(p)})}),ca(()=>_l(e()),()=>{e()&&u(e())}),bc(),gl();var d=op();Wd(d,p=>le(r,p),()=>Bt(r)),rr(h,d),Ba()}function Go(h){throw new Error('Could not dynamically require "'+h+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var sh={exports:{}};/*!

JSZip v3.10.1 - A JavaScript class for generating and reading zip files
<http://stuartk.com/jszip>

(c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.

JSZip uses the library pako released under the MIT license :
https://github.com/nodeca/pako/blob/main/LICENSE
*/var nu;function hp(){return nu||(nu=1,function(h,t){(function(e){h.exports=e()})(function(){return function e(r,i,s){function o(f,d){if(!i[f]){if(!r[f]){var p=typeof Go=="function"&&Go;if(!d&&p)return p(f,!0);if(l)return l(f,!0);var g=new Error("Cannot find module '"+f+"'");throw g.code="MODULE_NOT_FOUND",g}var m=i[f]={exports:{}};r[f][0].call(m.exports,function(x){var y=r[f][1][x];return o(y||x)},m,m.exports,e,r,i,s)}return i[f].exports}for(var l=typeof Go=="function"&&Go,u=0;u<s.length;u++)o(s[u]);return o}({1:[function(e,r,i){var s=e("./utils"),o=e("./support"),l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";i.encode=function(u){for(var f,d,p,g,m,x,y,b=[],P=0,A=u.length,N=A,G=s.getTypeOf(u)!=="string";P<u.length;)N=A-P,p=G?(f=u[P++],d=P<A?u[P++]:0,P<A?u[P++]:0):(f=u.charCodeAt(P++),d=P<A?u.charCodeAt(P++):0,P<A?u.charCodeAt(P++):0),g=f>>2,m=(3&f)<<4|d>>4,x=1<N?(15&d)<<2|p>>6:64,y=2<N?63&p:64,b.push(l.charAt(g)+l.charAt(m)+l.charAt(x)+l.charAt(y));return b.join("")},i.decode=function(u){var f,d,p,g,m,x,y=0,b=0,P="data:";if(u.substr(0,P.length)===P)throw new Error("Invalid base64 input, it looks like a data url.");var A,N=3*(u=u.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(u.charAt(u.length-1)===l.charAt(64)&&N--,u.charAt(u.length-2)===l.charAt(64)&&N--,N%1!=0)throw new Error("Invalid base64 input, bad content length.");for(A=o.uint8array?new Uint8Array(0|N):new Array(0|N);y<u.length;)f=l.indexOf(u.charAt(y++))<<2|(g=l.indexOf(u.charAt(y++)))>>4,d=(15&g)<<4|(m=l.indexOf(u.charAt(y++)))>>2,p=(3&m)<<6|(x=l.indexOf(u.charAt(y++))),A[b++]=f,m!==64&&(A[b++]=d),x!==64&&(A[b++]=p);return A}},{"./support":30,"./utils":32}],2:[function(e,r,i){var s=e("./external"),o=e("./stream/DataWorker"),l=e("./stream/Crc32Probe"),u=e("./stream/DataLengthProbe");function f(d,p,g,m,x){this.compressedSize=d,this.uncompressedSize=p,this.crc32=g,this.compression=m,this.compressedContent=x}f.prototype={getContentWorker:function(){var d=new o(s.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new u("data_length")),p=this;return d.on("end",function(){if(this.streamInfo.data_length!==p.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),d},getCompressedWorker:function(){return new o(s.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},f.createWorkerFrom=function(d,p,g){return d.pipe(new l).pipe(new u("uncompressedSize")).pipe(p.compressWorker(g)).pipe(new u("compressedSize")).withStreamInfo("compression",p)},r.exports=f},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(e,r,i){var s=e("./stream/GenericWorker");i.STORE={magic:"\0\0",compressWorker:function(){return new s("STORE compression")},uncompressWorker:function(){return new s("STORE decompression")}},i.DEFLATE=e("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(e,r,i){var s=e("./utils"),o=function(){for(var l,u=[],f=0;f<256;f++){l=f;for(var d=0;d<8;d++)l=1&l?3988292384^l>>>1:l>>>1;u[f]=l}return u}();r.exports=function(l,u){return l!==void 0&&l.length?s.getTypeOf(l)!=="string"?function(f,d,p,g){var m=o,x=g+p;f^=-1;for(var y=g;y<x;y++)f=f>>>8^m[255&(f^d[y])];return-1^f}(0|u,l,l.length,0):function(f,d,p,g){var m=o,x=g+p;f^=-1;for(var y=g;y<x;y++)f=f>>>8^m[255&(f^d.charCodeAt(y))];return-1^f}(0|u,l,l.length,0):0}},{"./utils":32}],5:[function(e,r,i){i.base64=!1,i.binary=!1,i.dir=!1,i.createFolders=!0,i.date=null,i.compression=null,i.compressionOptions=null,i.comment=null,i.unixPermissions=null,i.dosPermissions=null},{}],6:[function(e,r,i){var s=null;s=typeof Promise<"u"?Promise:e("lie"),r.exports={Promise:s}},{lie:37}],7:[function(e,r,i){var s=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",o=e("pako"),l=e("./utils"),u=e("./stream/GenericWorker"),f=s?"uint8array":"array";function d(p,g){u.call(this,"FlateWorker/"+p),this._pako=null,this._pakoAction=p,this._pakoOptions=g,this.meta={}}i.magic="\b\0",l.inherits(d,u),d.prototype.processChunk=function(p){this.meta=p.meta,this._pako===null&&this._createPako(),this._pako.push(l.transformTo(f,p.data),!1)},d.prototype.flush=function(){u.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},d.prototype.cleanUp=function(){u.prototype.cleanUp.call(this),this._pako=null},d.prototype._createPako=function(){this._pako=new o[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var p=this;this._pako.onData=function(g){p.push({data:g,meta:p.meta})}},i.compressWorker=function(p){return new d("Deflate",p)},i.uncompressWorker=function(){return new d("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(e,r,i){function s(m,x){var y,b="";for(y=0;y<x;y++)b+=String.fromCharCode(255&m),m>>>=8;return b}function o(m,x,y,b,P,A){var N,G,z=m.file,K=m.compression,q=A!==f.utf8encode,T=l.transformTo("string",A(z.name)),k=l.transformTo("string",f.utf8encode(z.name)),I=z.comment,F=l.transformTo("string",A(I)),S=l.transformTo("string",f.utf8encode(I)),O=k.length!==z.name.length,v=S.length!==I.length,C="",U="",H="",W=z.dir,V=z.date,et={crc32:0,compressedSize:0,uncompressedSize:0};x&&!y||(et.crc32=m.crc32,et.compressedSize=m.compressedSize,et.uncompressedSize=m.uncompressedSize);var Y=0;x&&(Y|=8),q||!O&&!v||(Y|=2048);var Q=0,pt=0;W&&(Q|=16),P==="UNIX"?(pt=798,Q|=function(rt,mt){var St=rt;return rt||(St=mt?16893:33204),(65535&St)<<16}(z.unixPermissions,W)):(pt=20,Q|=function(rt){return 63&(rt||0)}(z.dosPermissions)),N=V.getUTCHours(),N<<=6,N|=V.getUTCMinutes(),N<<=5,N|=V.getUTCSeconds()/2,G=V.getUTCFullYear()-1980,G<<=4,G|=V.getUTCMonth()+1,G<<=5,G|=V.getUTCDate(),O&&(U=s(1,1)+s(d(T),4)+k,C+="up"+s(U.length,2)+U),v&&(H=s(1,1)+s(d(F),4)+S,C+="uc"+s(H.length,2)+H);var ct="";return ct+=`
\0`,ct+=s(Y,2),ct+=K.magic,ct+=s(N,2),ct+=s(G,2),ct+=s(et.crc32,4),ct+=s(et.compressedSize,4),ct+=s(et.uncompressedSize,4),ct+=s(T.length,2),ct+=s(C.length,2),{fileRecord:p.LOCAL_FILE_HEADER+ct+T+C,dirRecord:p.CENTRAL_FILE_HEADER+s(pt,2)+ct+s(F.length,2)+"\0\0\0\0"+s(Q,4)+s(b,4)+T+C+F}}var l=e("../utils"),u=e("../stream/GenericWorker"),f=e("../utf8"),d=e("../crc32"),p=e("../signature");function g(m,x,y,b){u.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=x,this.zipPlatform=y,this.encodeFileName=b,this.streamFiles=m,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}l.inherits(g,u),g.prototype.push=function(m){var x=m.meta.percent||0,y=this.entriesCount,b=this._sources.length;this.accumulate?this.contentBuffer.push(m):(this.bytesWritten+=m.data.length,u.prototype.push.call(this,{data:m.data,meta:{currentFile:this.currentFile,percent:y?(x+100*(y-b-1))/y:100}}))},g.prototype.openedSource=function(m){this.currentSourceOffset=this.bytesWritten,this.currentFile=m.file.name;var x=this.streamFiles&&!m.file.dir;if(x){var y=o(m,x,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:y.fileRecord,meta:{percent:0}})}else this.accumulate=!0},g.prototype.closedSource=function(m){this.accumulate=!1;var x=this.streamFiles&&!m.file.dir,y=o(m,x,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(y.dirRecord),x)this.push({data:function(b){return p.DATA_DESCRIPTOR+s(b.crc32,4)+s(b.compressedSize,4)+s(b.uncompressedSize,4)}(m),meta:{percent:100}});else for(this.push({data:y.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},g.prototype.flush=function(){for(var m=this.bytesWritten,x=0;x<this.dirRecords.length;x++)this.push({data:this.dirRecords[x],meta:{percent:100}});var y=this.bytesWritten-m,b=function(P,A,N,G,z){var K=l.transformTo("string",z(G));return p.CENTRAL_DIRECTORY_END+"\0\0\0\0"+s(P,2)+s(P,2)+s(A,4)+s(N,4)+s(K.length,2)+K}(this.dirRecords.length,y,m,this.zipComment,this.encodeFileName);this.push({data:b,meta:{percent:100}})},g.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},g.prototype.registerPrevious=function(m){this._sources.push(m);var x=this;return m.on("data",function(y){x.processChunk(y)}),m.on("end",function(){x.closedSource(x.previous.streamInfo),x._sources.length?x.prepareNextSource():x.end()}),m.on("error",function(y){x.error(y)}),this},g.prototype.resume=function(){return!!u.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},g.prototype.error=function(m){var x=this._sources;if(!u.prototype.error.call(this,m))return!1;for(var y=0;y<x.length;y++)try{x[y].error(m)}catch{}return!0},g.prototype.lock=function(){u.prototype.lock.call(this);for(var m=this._sources,x=0;x<m.length;x++)m[x].lock()},r.exports=g},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(e,r,i){var s=e("../compressions"),o=e("./ZipFileWorker");i.generateWorker=function(l,u,f){var d=new o(u.streamFiles,f,u.platform,u.encodeFileName),p=0;try{l.forEach(function(g,m){p++;var x=function(A,N){var G=A||N,z=s[G];if(!z)throw new Error(G+" is not a valid compression method !");return z}(m.options.compression,u.compression),y=m.options.compressionOptions||u.compressionOptions||{},b=m.dir,P=m.date;m._compressWorker(x,y).withStreamInfo("file",{name:g,dir:b,date:P,comment:m.comment||"",unixPermissions:m.unixPermissions,dosPermissions:m.dosPermissions}).pipe(d)}),d.entriesCount=p}catch(g){d.error(g)}return d}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(e,r,i){function s(){if(!(this instanceof s))return new s;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var o=new s;for(var l in this)typeof this[l]!="function"&&(o[l]=this[l]);return o}}(s.prototype=e("./object")).loadAsync=e("./load"),s.support=e("./support"),s.defaults=e("./defaults"),s.version="3.10.1",s.loadAsync=function(o,l){return new s().loadAsync(o,l)},s.external=e("./external"),r.exports=s},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(e,r,i){var s=e("./utils"),o=e("./external"),l=e("./utf8"),u=e("./zipEntries"),f=e("./stream/Crc32Probe"),d=e("./nodejsUtils");function p(g){return new o.Promise(function(m,x){var y=g.decompressed.getContentWorker().pipe(new f);y.on("error",function(b){x(b)}).on("end",function(){y.streamInfo.crc32!==g.decompressed.crc32?x(new Error("Corrupted zip : CRC32 mismatch")):m()}).resume()})}r.exports=function(g,m){var x=this;return m=s.extend(m||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:l.utf8decode}),d.isNode&&d.isStream(g)?o.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):s.prepareContent("the loaded zip file",g,!0,m.optimizedBinaryString,m.base64).then(function(y){var b=new u(m);return b.load(y),b}).then(function(y){var b=[o.Promise.resolve(y)],P=y.files;if(m.checkCRC32)for(var A=0;A<P.length;A++)b.push(p(P[A]));return o.Promise.all(b)}).then(function(y){for(var b=y.shift(),P=b.files,A=0;A<P.length;A++){var N=P[A],G=N.fileNameStr,z=s.resolve(N.fileNameStr);x.file(z,N.decompressed,{binary:!0,optimizedBinaryString:!0,date:N.date,dir:N.dir,comment:N.fileCommentStr.length?N.fileCommentStr:null,unixPermissions:N.unixPermissions,dosPermissions:N.dosPermissions,createFolders:m.createFolders}),N.dir||(x.file(z).unsafeOriginalName=G)}return b.zipComment.length&&(x.comment=b.zipComment),x})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(e,r,i){var s=e("../utils"),o=e("../stream/GenericWorker");function l(u,f){o.call(this,"Nodejs stream input adapter for "+u),this._upstreamEnded=!1,this._bindStream(f)}s.inherits(l,o),l.prototype._bindStream=function(u){var f=this;(this._stream=u).pause(),u.on("data",function(d){f.push({data:d,meta:{percent:0}})}).on("error",function(d){f.isPaused?this.generatedError=d:f.error(d)}).on("end",function(){f.isPaused?f._upstreamEnded=!0:f.end()})},l.prototype.pause=function(){return!!o.prototype.pause.call(this)&&(this._stream.pause(),!0)},l.prototype.resume=function(){return!!o.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},r.exports=l},{"../stream/GenericWorker":28,"../utils":32}],13:[function(e,r,i){var s=e("readable-stream").Readable;function o(l,u,f){s.call(this,u),this._helper=l;var d=this;l.on("data",function(p,g){d.push(p)||d._helper.pause(),f&&f(g)}).on("error",function(p){d.emit("error",p)}).on("end",function(){d.push(null)})}e("../utils").inherits(o,s),o.prototype._read=function(){this._helper.resume()},r.exports=o},{"../utils":32,"readable-stream":16}],14:[function(e,r,i){r.exports={isNode:typeof Buffer<"u",newBufferFrom:function(s,o){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(s,o);if(typeof s=="number")throw new Error('The "data" argument must not be a number');return new Buffer(s,o)},allocBuffer:function(s){if(Buffer.alloc)return Buffer.alloc(s);var o=new Buffer(s);return o.fill(0),o},isBuffer:function(s){return Buffer.isBuffer(s)},isStream:function(s){return s&&typeof s.on=="function"&&typeof s.pause=="function"&&typeof s.resume=="function"}}},{}],15:[function(e,r,i){function s(z,K,q){var T,k=l.getTypeOf(K),I=l.extend(q||{},d);I.date=I.date||new Date,I.compression!==null&&(I.compression=I.compression.toUpperCase()),typeof I.unixPermissions=="string"&&(I.unixPermissions=parseInt(I.unixPermissions,8)),I.unixPermissions&&16384&I.unixPermissions&&(I.dir=!0),I.dosPermissions&&16&I.dosPermissions&&(I.dir=!0),I.dir&&(z=P(z)),I.createFolders&&(T=b(z))&&A.call(this,T,!0);var F=k==="string"&&I.binary===!1&&I.base64===!1;q&&q.binary!==void 0||(I.binary=!F),(K instanceof p&&K.uncompressedSize===0||I.dir||!K||K.length===0)&&(I.base64=!1,I.binary=!0,K="",I.compression="STORE",k="string");var S=null;S=K instanceof p||K instanceof u?K:x.isNode&&x.isStream(K)?new y(z,K):l.prepareContent(z,K,I.binary,I.optimizedBinaryString,I.base64);var O=new g(z,S,I);this.files[z]=O}var o=e("./utf8"),l=e("./utils"),u=e("./stream/GenericWorker"),f=e("./stream/StreamHelper"),d=e("./defaults"),p=e("./compressedObject"),g=e("./zipObject"),m=e("./generate"),x=e("./nodejsUtils"),y=e("./nodejs/NodejsStreamInputAdapter"),b=function(z){z.slice(-1)==="/"&&(z=z.substring(0,z.length-1));var K=z.lastIndexOf("/");return 0<K?z.substring(0,K):""},P=function(z){return z.slice(-1)!=="/"&&(z+="/"),z},A=function(z,K){return K=K!==void 0?K:d.createFolders,z=P(z),this.files[z]||s.call(this,z,null,{dir:!0,createFolders:K}),this.files[z]};function N(z){return Object.prototype.toString.call(z)==="[object RegExp]"}var G={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(z){var K,q,T;for(K in this.files)T=this.files[K],(q=K.slice(this.root.length,K.length))&&K.slice(0,this.root.length)===this.root&&z(q,T)},filter:function(z){var K=[];return this.forEach(function(q,T){z(q,T)&&K.push(T)}),K},file:function(z,K,q){if(arguments.length!==1)return z=this.root+z,s.call(this,z,K,q),this;if(N(z)){var T=z;return this.filter(function(I,F){return!F.dir&&T.test(I)})}var k=this.files[this.root+z];return k&&!k.dir?k:null},folder:function(z){if(!z)return this;if(N(z))return this.filter(function(k,I){return I.dir&&z.test(k)});var K=this.root+z,q=A.call(this,K),T=this.clone();return T.root=q.name,T},remove:function(z){z=this.root+z;var K=this.files[z];if(K||(z.slice(-1)!=="/"&&(z+="/"),K=this.files[z]),K&&!K.dir)delete this.files[z];else for(var q=this.filter(function(k,I){return I.name.slice(0,z.length)===z}),T=0;T<q.length;T++)delete this.files[q[T].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(z){var K,q={};try{if((q=l.extend(z||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:o.utf8encode})).type=q.type.toLowerCase(),q.compression=q.compression.toUpperCase(),q.type==="binarystring"&&(q.type="string"),!q.type)throw new Error("No output type specified.");l.checkSupport(q.type),q.platform!=="darwin"&&q.platform!=="freebsd"&&q.platform!=="linux"&&q.platform!=="sunos"||(q.platform="UNIX"),q.platform==="win32"&&(q.platform="DOS");var T=q.comment||this.comment||"";K=m.generateWorker(this,q,T)}catch(k){(K=new u("error")).error(k)}return new f(K,q.type||"string",q.mimeType)},generateAsync:function(z,K){return this.generateInternalStream(z).accumulate(K)},generateNodeStream:function(z,K){return(z=z||{}).type||(z.type="nodebuffer"),this.generateInternalStream(z).toNodejsStream(K)}};r.exports=G},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(e,r,i){r.exports=e("stream")},{stream:void 0}],17:[function(e,r,i){var s=e("./DataReader");function o(l){s.call(this,l);for(var u=0;u<this.data.length;u++)l[u]=255&l[u]}e("../utils").inherits(o,s),o.prototype.byteAt=function(l){return this.data[this.zero+l]},o.prototype.lastIndexOfSignature=function(l){for(var u=l.charCodeAt(0),f=l.charCodeAt(1),d=l.charCodeAt(2),p=l.charCodeAt(3),g=this.length-4;0<=g;--g)if(this.data[g]===u&&this.data[g+1]===f&&this.data[g+2]===d&&this.data[g+3]===p)return g-this.zero;return-1},o.prototype.readAndCheckSignature=function(l){var u=l.charCodeAt(0),f=l.charCodeAt(1),d=l.charCodeAt(2),p=l.charCodeAt(3),g=this.readData(4);return u===g[0]&&f===g[1]&&d===g[2]&&p===g[3]},o.prototype.readData=function(l){if(this.checkOffset(l),l===0)return[];var u=this.data.slice(this.zero+this.index,this.zero+this.index+l);return this.index+=l,u},r.exports=o},{"../utils":32,"./DataReader":18}],18:[function(e,r,i){var s=e("../utils");function o(l){this.data=l,this.length=l.length,this.index=0,this.zero=0}o.prototype={checkOffset:function(l){this.checkIndex(this.index+l)},checkIndex:function(l){if(this.length<this.zero+l||l<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+l+"). Corrupted zip ?")},setIndex:function(l){this.checkIndex(l),this.index=l},skip:function(l){this.setIndex(this.index+l)},byteAt:function(){},readInt:function(l){var u,f=0;for(this.checkOffset(l),u=this.index+l-1;u>=this.index;u--)f=(f<<8)+this.byteAt(u);return this.index+=l,f},readString:function(l){return s.transformTo("string",this.readData(l))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var l=this.readInt(4);return new Date(Date.UTC(1980+(l>>25&127),(l>>21&15)-1,l>>16&31,l>>11&31,l>>5&63,(31&l)<<1))}},r.exports=o},{"../utils":32}],19:[function(e,r,i){var s=e("./Uint8ArrayReader");function o(l){s.call(this,l)}e("../utils").inherits(o,s),o.prototype.readData=function(l){this.checkOffset(l);var u=this.data.slice(this.zero+this.index,this.zero+this.index+l);return this.index+=l,u},r.exports=o},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(e,r,i){var s=e("./DataReader");function o(l){s.call(this,l)}e("../utils").inherits(o,s),o.prototype.byteAt=function(l){return this.data.charCodeAt(this.zero+l)},o.prototype.lastIndexOfSignature=function(l){return this.data.lastIndexOf(l)-this.zero},o.prototype.readAndCheckSignature=function(l){return l===this.readData(4)},o.prototype.readData=function(l){this.checkOffset(l);var u=this.data.slice(this.zero+this.index,this.zero+this.index+l);return this.index+=l,u},r.exports=o},{"../utils":32,"./DataReader":18}],21:[function(e,r,i){var s=e("./ArrayReader");function o(l){s.call(this,l)}e("../utils").inherits(o,s),o.prototype.readData=function(l){if(this.checkOffset(l),l===0)return new Uint8Array(0);var u=this.data.subarray(this.zero+this.index,this.zero+this.index+l);return this.index+=l,u},r.exports=o},{"../utils":32,"./ArrayReader":17}],22:[function(e,r,i){var s=e("../utils"),o=e("../support"),l=e("./ArrayReader"),u=e("./StringReader"),f=e("./NodeBufferReader"),d=e("./Uint8ArrayReader");r.exports=function(p){var g=s.getTypeOf(p);return s.checkSupport(g),g!=="string"||o.uint8array?g==="nodebuffer"?new f(p):o.uint8array?new d(s.transformTo("uint8array",p)):new l(s.transformTo("array",p)):new u(p)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(e,r,i){i.LOCAL_FILE_HEADER="PK",i.CENTRAL_FILE_HEADER="PK",i.CENTRAL_DIRECTORY_END="PK",i.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",i.ZIP64_CENTRAL_DIRECTORY_END="PK",i.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(e,r,i){var s=e("./GenericWorker"),o=e("../utils");function l(u){s.call(this,"ConvertWorker to "+u),this.destType=u}o.inherits(l,s),l.prototype.processChunk=function(u){this.push({data:o.transformTo(this.destType,u.data),meta:u.meta})},r.exports=l},{"../utils":32,"./GenericWorker":28}],25:[function(e,r,i){var s=e("./GenericWorker"),o=e("../crc32");function l(){s.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}e("../utils").inherits(l,s),l.prototype.processChunk=function(u){this.streamInfo.crc32=o(u.data,this.streamInfo.crc32||0),this.push(u)},r.exports=l},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(e,r,i){var s=e("../utils"),o=e("./GenericWorker");function l(u){o.call(this,"DataLengthProbe for "+u),this.propName=u,this.withStreamInfo(u,0)}s.inherits(l,o),l.prototype.processChunk=function(u){if(u){var f=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=f+u.data.length}o.prototype.processChunk.call(this,u)},r.exports=l},{"../utils":32,"./GenericWorker":28}],27:[function(e,r,i){var s=e("../utils"),o=e("./GenericWorker");function l(u){o.call(this,"DataWorker");var f=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,u.then(function(d){f.dataIsReady=!0,f.data=d,f.max=d&&d.length||0,f.type=s.getTypeOf(d),f.isPaused||f._tickAndRepeat()},function(d){f.error(d)})}s.inherits(l,o),l.prototype.cleanUp=function(){o.prototype.cleanUp.call(this),this.data=null},l.prototype.resume=function(){return!!o.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,s.delay(this._tickAndRepeat,[],this)),!0)},l.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(s.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},l.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var u=null,f=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":u=this.data.substring(this.index,f);break;case"uint8array":u=this.data.subarray(this.index,f);break;case"array":case"nodebuffer":u=this.data.slice(this.index,f)}return this.index=f,this.push({data:u,meta:{percent:this.max?this.index/this.max*100:0}})},r.exports=l},{"../utils":32,"./GenericWorker":28}],28:[function(e,r,i){function s(o){this.name=o||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}s.prototype={push:function(o){this.emit("data",o)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(o){this.emit("error",o)}return!0},error:function(o){return!this.isFinished&&(this.isPaused?this.generatedError=o:(this.isFinished=!0,this.emit("error",o),this.previous&&this.previous.error(o),this.cleanUp()),!0)},on:function(o,l){return this._listeners[o].push(l),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(o,l){if(this._listeners[o])for(var u=0;u<this._listeners[o].length;u++)this._listeners[o][u].call(this,l)},pipe:function(o){return o.registerPrevious(this)},registerPrevious:function(o){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=o.streamInfo,this.mergeStreamInfo(),this.previous=o;var l=this;return o.on("data",function(u){l.processChunk(u)}),o.on("end",function(){l.end()}),o.on("error",function(u){l.error(u)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var o=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),o=!0),this.previous&&this.previous.resume(),!o},flush:function(){},processChunk:function(o){this.push(o)},withStreamInfo:function(o,l){return this.extraStreamInfo[o]=l,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var o in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,o)&&(this.streamInfo[o]=this.extraStreamInfo[o])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var o="Worker "+this.name;return this.previous?this.previous+" -> "+o:o}},r.exports=s},{}],29:[function(e,r,i){var s=e("../utils"),o=e("./ConvertWorker"),l=e("./GenericWorker"),u=e("../base64"),f=e("../support"),d=e("../external"),p=null;if(f.nodestream)try{p=e("../nodejs/NodejsStreamOutputAdapter")}catch{}function g(x,y){return new d.Promise(function(b,P){var A=[],N=x._internalType,G=x._outputType,z=x._mimeType;x.on("data",function(K,q){A.push(K),y&&y(q)}).on("error",function(K){A=[],P(K)}).on("end",function(){try{var K=function(q,T,k){switch(q){case"blob":return s.newBlob(s.transformTo("arraybuffer",T),k);case"base64":return u.encode(T);default:return s.transformTo(q,T)}}(G,function(q,T){var k,I=0,F=null,S=0;for(k=0;k<T.length;k++)S+=T[k].length;switch(q){case"string":return T.join("");case"array":return Array.prototype.concat.apply([],T);case"uint8array":for(F=new Uint8Array(S),k=0;k<T.length;k++)F.set(T[k],I),I+=T[k].length;return F;case"nodebuffer":return Buffer.concat(T);default:throw new Error("concat : unsupported type '"+q+"'")}}(N,A),z);b(K)}catch(q){P(q)}A=[]}).resume()})}function m(x,y,b){var P=y;switch(y){case"blob":case"arraybuffer":P="uint8array";break;case"base64":P="string"}try{this._internalType=P,this._outputType=y,this._mimeType=b,s.checkSupport(P),this._worker=x.pipe(new o(P)),x.lock()}catch(A){this._worker=new l("error"),this._worker.error(A)}}m.prototype={accumulate:function(x){return g(this,x)},on:function(x,y){var b=this;return x==="data"?this._worker.on(x,function(P){y.call(b,P.data,P.meta)}):this._worker.on(x,function(){s.delay(y,arguments,b)}),this},resume:function(){return s.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(x){if(s.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new p(this,{objectMode:this._outputType!=="nodebuffer"},x)}},r.exports=m},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(e,r,i){if(i.base64=!0,i.array=!0,i.string=!0,i.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",i.nodebuffer=typeof Buffer<"u",i.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")i.blob=!1;else{var s=new ArrayBuffer(0);try{i.blob=new Blob([s],{type:"application/zip"}).size===0}catch{try{var o=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);o.append(s),i.blob=o.getBlob("application/zip").size===0}catch{i.blob=!1}}}try{i.nodestream=!!e("readable-stream").Readable}catch{i.nodestream=!1}},{"readable-stream":16}],31:[function(e,r,i){for(var s=e("./utils"),o=e("./support"),l=e("./nodejsUtils"),u=e("./stream/GenericWorker"),f=new Array(256),d=0;d<256;d++)f[d]=252<=d?6:248<=d?5:240<=d?4:224<=d?3:192<=d?2:1;f[254]=f[254]=1;function p(){u.call(this,"utf-8 decode"),this.leftOver=null}function g(){u.call(this,"utf-8 encode")}i.utf8encode=function(m){return o.nodebuffer?l.newBufferFrom(m,"utf-8"):function(x){var y,b,P,A,N,G=x.length,z=0;for(A=0;A<G;A++)(64512&(b=x.charCodeAt(A)))==55296&&A+1<G&&(64512&(P=x.charCodeAt(A+1)))==56320&&(b=65536+(b-55296<<10)+(P-56320),A++),z+=b<128?1:b<2048?2:b<65536?3:4;for(y=o.uint8array?new Uint8Array(z):new Array(z),A=N=0;N<z;A++)(64512&(b=x.charCodeAt(A)))==55296&&A+1<G&&(64512&(P=x.charCodeAt(A+1)))==56320&&(b=65536+(b-55296<<10)+(P-56320),A++),b<128?y[N++]=b:(b<2048?y[N++]=192|b>>>6:(b<65536?y[N++]=224|b>>>12:(y[N++]=240|b>>>18,y[N++]=128|b>>>12&63),y[N++]=128|b>>>6&63),y[N++]=128|63&b);return y}(m)},i.utf8decode=function(m){return o.nodebuffer?s.transformTo("nodebuffer",m).toString("utf-8"):function(x){var y,b,P,A,N=x.length,G=new Array(2*N);for(y=b=0;y<N;)if((P=x[y++])<128)G[b++]=P;else if(4<(A=f[P]))G[b++]=65533,y+=A-1;else{for(P&=A===2?31:A===3?15:7;1<A&&y<N;)P=P<<6|63&x[y++],A--;1<A?G[b++]=65533:P<65536?G[b++]=P:(P-=65536,G[b++]=55296|P>>10&1023,G[b++]=56320|1023&P)}return G.length!==b&&(G.subarray?G=G.subarray(0,b):G.length=b),s.applyFromCharCode(G)}(m=s.transformTo(o.uint8array?"uint8array":"array",m))},s.inherits(p,u),p.prototype.processChunk=function(m){var x=s.transformTo(o.uint8array?"uint8array":"array",m.data);if(this.leftOver&&this.leftOver.length){if(o.uint8array){var y=x;(x=new Uint8Array(y.length+this.leftOver.length)).set(this.leftOver,0),x.set(y,this.leftOver.length)}else x=this.leftOver.concat(x);this.leftOver=null}var b=function(A,N){var G;for((N=N||A.length)>A.length&&(N=A.length),G=N-1;0<=G&&(192&A[G])==128;)G--;return G<0||G===0?N:G+f[A[G]]>N?G:N}(x),P=x;b!==x.length&&(o.uint8array?(P=x.subarray(0,b),this.leftOver=x.subarray(b,x.length)):(P=x.slice(0,b),this.leftOver=x.slice(b,x.length))),this.push({data:i.utf8decode(P),meta:m.meta})},p.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:i.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},i.Utf8DecodeWorker=p,s.inherits(g,u),g.prototype.processChunk=function(m){this.push({data:i.utf8encode(m.data),meta:m.meta})},i.Utf8EncodeWorker=g},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(e,r,i){var s=e("./support"),o=e("./base64"),l=e("./nodejsUtils"),u=e("./external");function f(y){return y}function d(y,b){for(var P=0;P<y.length;++P)b[P]=255&y.charCodeAt(P);return b}e("setimmediate"),i.newBlob=function(y,b){i.checkSupport("blob");try{return new Blob([y],{type:b})}catch{try{var P=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return P.append(y),P.getBlob(b)}catch{throw new Error("Bug : can't construct the Blob.")}}};var p={stringifyByChunk:function(y,b,P){var A=[],N=0,G=y.length;if(G<=P)return String.fromCharCode.apply(null,y);for(;N<G;)b==="array"||b==="nodebuffer"?A.push(String.fromCharCode.apply(null,y.slice(N,Math.min(N+P,G)))):A.push(String.fromCharCode.apply(null,y.subarray(N,Math.min(N+P,G)))),N+=P;return A.join("")},stringifyByChar:function(y){for(var b="",P=0;P<y.length;P++)b+=String.fromCharCode(y[P]);return b},applyCanBeUsed:{uint8array:function(){try{return s.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}}(),nodebuffer:function(){try{return s.nodebuffer&&String.fromCharCode.apply(null,l.allocBuffer(1)).length===1}catch{return!1}}()}};function g(y){var b=65536,P=i.getTypeOf(y),A=!0;if(P==="uint8array"?A=p.applyCanBeUsed.uint8array:P==="nodebuffer"&&(A=p.applyCanBeUsed.nodebuffer),A)for(;1<b;)try{return p.stringifyByChunk(y,P,b)}catch{b=Math.floor(b/2)}return p.stringifyByChar(y)}function m(y,b){for(var P=0;P<y.length;P++)b[P]=y[P];return b}i.applyFromCharCode=g;var x={};x.string={string:f,array:function(y){return d(y,new Array(y.length))},arraybuffer:function(y){return x.string.uint8array(y).buffer},uint8array:function(y){return d(y,new Uint8Array(y.length))},nodebuffer:function(y){return d(y,l.allocBuffer(y.length))}},x.array={string:g,array:f,arraybuffer:function(y){return new Uint8Array(y).buffer},uint8array:function(y){return new Uint8Array(y)},nodebuffer:function(y){return l.newBufferFrom(y)}},x.arraybuffer={string:function(y){return g(new Uint8Array(y))},array:function(y){return m(new Uint8Array(y),new Array(y.byteLength))},arraybuffer:f,uint8array:function(y){return new Uint8Array(y)},nodebuffer:function(y){return l.newBufferFrom(new Uint8Array(y))}},x.uint8array={string:g,array:function(y){return m(y,new Array(y.length))},arraybuffer:function(y){return y.buffer},uint8array:f,nodebuffer:function(y){return l.newBufferFrom(y)}},x.nodebuffer={string:g,array:function(y){return m(y,new Array(y.length))},arraybuffer:function(y){return x.nodebuffer.uint8array(y).buffer},uint8array:function(y){return m(y,new Uint8Array(y.length))},nodebuffer:f},i.transformTo=function(y,b){if(b=b||"",!y)return b;i.checkSupport(y);var P=i.getTypeOf(b);return x[P][y](b)},i.resolve=function(y){for(var b=y.split("/"),P=[],A=0;A<b.length;A++){var N=b[A];N==="."||N===""&&A!==0&&A!==b.length-1||(N===".."?P.pop():P.push(N))}return P.join("/")},i.getTypeOf=function(y){return typeof y=="string"?"string":Object.prototype.toString.call(y)==="[object Array]"?"array":s.nodebuffer&&l.isBuffer(y)?"nodebuffer":s.uint8array&&y instanceof Uint8Array?"uint8array":s.arraybuffer&&y instanceof ArrayBuffer?"arraybuffer":void 0},i.checkSupport=function(y){if(!s[y.toLowerCase()])throw new Error(y+" is not supported by this platform")},i.MAX_VALUE_16BITS=65535,i.MAX_VALUE_32BITS=-1,i.pretty=function(y){var b,P,A="";for(P=0;P<(y||"").length;P++)A+="\\x"+((b=y.charCodeAt(P))<16?"0":"")+b.toString(16).toUpperCase();return A},i.delay=function(y,b,P){setImmediate(function(){y.apply(P||null,b||[])})},i.inherits=function(y,b){function P(){}P.prototype=b.prototype,y.prototype=new P},i.extend=function(){var y,b,P={};for(y=0;y<arguments.length;y++)for(b in arguments[y])Object.prototype.hasOwnProperty.call(arguments[y],b)&&P[b]===void 0&&(P[b]=arguments[y][b]);return P},i.prepareContent=function(y,b,P,A,N){return u.Promise.resolve(b).then(function(G){return s.blob&&(G instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(G))!==-1)&&typeof FileReader<"u"?new u.Promise(function(z,K){var q=new FileReader;q.onload=function(T){z(T.target.result)},q.onerror=function(T){K(T.target.error)},q.readAsArrayBuffer(G)}):G}).then(function(G){var z=i.getTypeOf(G);return z?(z==="arraybuffer"?G=i.transformTo("uint8array",G):z==="string"&&(N?G=o.decode(G):P&&A!==!0&&(G=function(K){return d(K,s.uint8array?new Uint8Array(K.length):new Array(K.length))}(G))),G):u.Promise.reject(new Error("Can't read the data of '"+y+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(e,r,i){var s=e("./reader/readerFor"),o=e("./utils"),l=e("./signature"),u=e("./zipEntry"),f=e("./support");function d(p){this.files=[],this.loadOptions=p}d.prototype={checkSignature:function(p){if(!this.reader.readAndCheckSignature(p)){this.reader.index-=4;var g=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+o.pretty(g)+", expected "+o.pretty(p)+")")}},isSignature:function(p,g){var m=this.reader.index;this.reader.setIndex(p);var x=this.reader.readString(4)===g;return this.reader.setIndex(m),x},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var p=this.reader.readData(this.zipCommentLength),g=f.uint8array?"uint8array":"array",m=o.transformTo(g,p);this.zipComment=this.loadOptions.decodeFileName(m)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var p,g,m,x=this.zip64EndOfCentralSize-44;0<x;)p=this.reader.readInt(2),g=this.reader.readInt(4),m=this.reader.readData(g),this.zip64ExtensibleData[p]={id:p,length:g,value:m}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var p,g;for(p=0;p<this.files.length;p++)g=this.files[p],this.reader.setIndex(g.localHeaderOffset),this.checkSignature(l.LOCAL_FILE_HEADER),g.readLocalPart(this.reader),g.handleUTF8(),g.processAttributes()},readCentralDir:function(){var p;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(l.CENTRAL_FILE_HEADER);)(p=new u({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(p);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var p=this.reader.lastIndexOfSignature(l.CENTRAL_DIRECTORY_END);if(p<0)throw this.isSignature(0,l.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(p);var g=p;if(this.checkSignature(l.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===o.MAX_VALUE_16BITS||this.diskWithCentralDirStart===o.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===o.MAX_VALUE_16BITS||this.centralDirRecords===o.MAX_VALUE_16BITS||this.centralDirSize===o.MAX_VALUE_32BITS||this.centralDirOffset===o.MAX_VALUE_32BITS){if(this.zip64=!0,(p=this.reader.lastIndexOfSignature(l.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(p),this.checkSignature(l.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,l.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(l.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(l.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var m=this.centralDirOffset+this.centralDirSize;this.zip64&&(m+=20,m+=12+this.zip64EndOfCentralSize);var x=g-m;if(0<x)this.isSignature(g,l.CENTRAL_FILE_HEADER)||(this.reader.zero=x);else if(x<0)throw new Error("Corrupted zip: missing "+Math.abs(x)+" bytes.")},prepareReader:function(p){this.reader=s(p)},load:function(p){this.prepareReader(p),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},r.exports=d},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(e,r,i){var s=e("./reader/readerFor"),o=e("./utils"),l=e("./compressedObject"),u=e("./crc32"),f=e("./utf8"),d=e("./compressions"),p=e("./support");function g(m,x){this.options=m,this.loadOptions=x}g.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(m){var x,y;if(m.skip(22),this.fileNameLength=m.readInt(2),y=m.readInt(2),this.fileName=m.readData(this.fileNameLength),m.skip(y),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((x=function(b){for(var P in d)if(Object.prototype.hasOwnProperty.call(d,P)&&d[P].magic===b)return d[P];return null}(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+o.pretty(this.compressionMethod)+" unknown (inner file : "+o.transformTo("string",this.fileName)+")");this.decompressed=new l(this.compressedSize,this.uncompressedSize,this.crc32,x,m.readData(this.compressedSize))},readCentralPart:function(m){this.versionMadeBy=m.readInt(2),m.skip(2),this.bitFlag=m.readInt(2),this.compressionMethod=m.readString(2),this.date=m.readDate(),this.crc32=m.readInt(4),this.compressedSize=m.readInt(4),this.uncompressedSize=m.readInt(4);var x=m.readInt(2);if(this.extraFieldsLength=m.readInt(2),this.fileCommentLength=m.readInt(2),this.diskNumberStart=m.readInt(2),this.internalFileAttributes=m.readInt(2),this.externalFileAttributes=m.readInt(4),this.localHeaderOffset=m.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");m.skip(x),this.readExtraFields(m),this.parseZIP64ExtraField(m),this.fileComment=m.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var m=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),m==0&&(this.dosPermissions=63&this.externalFileAttributes),m==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var m=s(this.extraFields[1].value);this.uncompressedSize===o.MAX_VALUE_32BITS&&(this.uncompressedSize=m.readInt(8)),this.compressedSize===o.MAX_VALUE_32BITS&&(this.compressedSize=m.readInt(8)),this.localHeaderOffset===o.MAX_VALUE_32BITS&&(this.localHeaderOffset=m.readInt(8)),this.diskNumberStart===o.MAX_VALUE_32BITS&&(this.diskNumberStart=m.readInt(4))}},readExtraFields:function(m){var x,y,b,P=m.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});m.index+4<P;)x=m.readInt(2),y=m.readInt(2),b=m.readData(y),this.extraFields[x]={id:x,length:y,value:b};m.setIndex(P)},handleUTF8:function(){var m=p.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=f.utf8decode(this.fileName),this.fileCommentStr=f.utf8decode(this.fileComment);else{var x=this.findExtraFieldUnicodePath();if(x!==null)this.fileNameStr=x;else{var y=o.transformTo(m,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(y)}var b=this.findExtraFieldUnicodeComment();if(b!==null)this.fileCommentStr=b;else{var P=o.transformTo(m,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(P)}}},findExtraFieldUnicodePath:function(){var m=this.extraFields[28789];if(m){var x=s(m.value);return x.readInt(1)!==1||u(this.fileName)!==x.readInt(4)?null:f.utf8decode(x.readData(m.length-5))}return null},findExtraFieldUnicodeComment:function(){var m=this.extraFields[25461];if(m){var x=s(m.value);return x.readInt(1)!==1||u(this.fileComment)!==x.readInt(4)?null:f.utf8decode(x.readData(m.length-5))}return null}},r.exports=g},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(e,r,i){function s(x,y,b){this.name=x,this.dir=b.dir,this.date=b.date,this.comment=b.comment,this.unixPermissions=b.unixPermissions,this.dosPermissions=b.dosPermissions,this._data=y,this._dataBinary=b.binary,this.options={compression:b.compression,compressionOptions:b.compressionOptions}}var o=e("./stream/StreamHelper"),l=e("./stream/DataWorker"),u=e("./utf8"),f=e("./compressedObject"),d=e("./stream/GenericWorker");s.prototype={internalStream:function(x){var y=null,b="string";try{if(!x)throw new Error("No output type specified.");var P=(b=x.toLowerCase())==="string"||b==="text";b!=="binarystring"&&b!=="text"||(b="string"),y=this._decompressWorker();var A=!this._dataBinary;A&&!P&&(y=y.pipe(new u.Utf8EncodeWorker)),!A&&P&&(y=y.pipe(new u.Utf8DecodeWorker))}catch(N){(y=new d("error")).error(N)}return new o(y,b,"")},async:function(x,y){return this.internalStream(x).accumulate(y)},nodeStream:function(x,y){return this.internalStream(x||"nodebuffer").toNodejsStream(y)},_compressWorker:function(x,y){if(this._data instanceof f&&this._data.compression.magic===x.magic)return this._data.getCompressedWorker();var b=this._decompressWorker();return this._dataBinary||(b=b.pipe(new u.Utf8EncodeWorker)),f.createWorkerFrom(b,x,y)},_decompressWorker:function(){return this._data instanceof f?this._data.getContentWorker():this._data instanceof d?this._data:new l(this._data)}};for(var p=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],g=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},m=0;m<p.length;m++)s.prototype[p[m]]=g;r.exports=s},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(e,r,i){(function(s){var o,l,u=s.MutationObserver||s.WebKitMutationObserver;if(u){var f=0,d=new u(x),p=s.document.createTextNode("");d.observe(p,{characterData:!0}),o=function(){p.data=f=++f%2}}else if(s.setImmediate||s.MessageChannel===void 0)o="document"in s&&"onreadystatechange"in s.document.createElement("script")?function(){var y=s.document.createElement("script");y.onreadystatechange=function(){x(),y.onreadystatechange=null,y.parentNode.removeChild(y),y=null},s.document.documentElement.appendChild(y)}:function(){setTimeout(x,0)};else{var g=new s.MessageChannel;g.port1.onmessage=x,o=function(){g.port2.postMessage(0)}}var m=[];function x(){var y,b;l=!0;for(var P=m.length;P;){for(b=m,m=[],y=-1;++y<P;)b[y]();P=m.length}l=!1}r.exports=function(y){m.push(y)!==1||l||o()}}).call(this,typeof An<"u"?An:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(e,r,i){var s=e("immediate");function o(){}var l={},u=["REJECTED"],f=["FULFILLED"],d=["PENDING"];function p(P){if(typeof P!="function")throw new TypeError("resolver must be a function");this.state=d,this.queue=[],this.outcome=void 0,P!==o&&y(this,P)}function g(P,A,N){this.promise=P,typeof A=="function"&&(this.onFulfilled=A,this.callFulfilled=this.otherCallFulfilled),typeof N=="function"&&(this.onRejected=N,this.callRejected=this.otherCallRejected)}function m(P,A,N){s(function(){var G;try{G=A(N)}catch(z){return l.reject(P,z)}G===P?l.reject(P,new TypeError("Cannot resolve promise with itself")):l.resolve(P,G)})}function x(P){var A=P&&P.then;if(P&&(typeof P=="object"||typeof P=="function")&&typeof A=="function")return function(){A.apply(P,arguments)}}function y(P,A){var N=!1;function G(q){N||(N=!0,l.reject(P,q))}function z(q){N||(N=!0,l.resolve(P,q))}var K=b(function(){A(z,G)});K.status==="error"&&G(K.value)}function b(P,A){var N={};try{N.value=P(A),N.status="success"}catch(G){N.status="error",N.value=G}return N}(r.exports=p).prototype.finally=function(P){if(typeof P!="function")return this;var A=this.constructor;return this.then(function(N){return A.resolve(P()).then(function(){return N})},function(N){return A.resolve(P()).then(function(){throw N})})},p.prototype.catch=function(P){return this.then(null,P)},p.prototype.then=function(P,A){if(typeof P!="function"&&this.state===f||typeof A!="function"&&this.state===u)return this;var N=new this.constructor(o);return this.state!==d?m(N,this.state===f?P:A,this.outcome):this.queue.push(new g(N,P,A)),N},g.prototype.callFulfilled=function(P){l.resolve(this.promise,P)},g.prototype.otherCallFulfilled=function(P){m(this.promise,this.onFulfilled,P)},g.prototype.callRejected=function(P){l.reject(this.promise,P)},g.prototype.otherCallRejected=function(P){m(this.promise,this.onRejected,P)},l.resolve=function(P,A){var N=b(x,A);if(N.status==="error")return l.reject(P,N.value);var G=N.value;if(G)y(P,G);else{P.state=f,P.outcome=A;for(var z=-1,K=P.queue.length;++z<K;)P.queue[z].callFulfilled(A)}return P},l.reject=function(P,A){P.state=u,P.outcome=A;for(var N=-1,G=P.queue.length;++N<G;)P.queue[N].callRejected(A);return P},p.resolve=function(P){return P instanceof this?P:l.resolve(new this(o),P)},p.reject=function(P){var A=new this(o);return l.reject(A,P)},p.all=function(P){var A=this;if(Object.prototype.toString.call(P)!=="[object Array]")return this.reject(new TypeError("must be an array"));var N=P.length,G=!1;if(!N)return this.resolve([]);for(var z=new Array(N),K=0,q=-1,T=new this(o);++q<N;)k(P[q],q);return T;function k(I,F){A.resolve(I).then(function(S){z[F]=S,++K!==N||G||(G=!0,l.resolve(T,z))},function(S){G||(G=!0,l.reject(T,S))})}},p.race=function(P){var A=this;if(Object.prototype.toString.call(P)!=="[object Array]")return this.reject(new TypeError("must be an array"));var N=P.length,G=!1;if(!N)return this.resolve([]);for(var z=-1,K=new this(o);++z<N;)q=P[z],A.resolve(q).then(function(T){G||(G=!0,l.resolve(K,T))},function(T){G||(G=!0,l.reject(K,T))});var q;return K}},{immediate:36}],38:[function(e,r,i){var s={};(0,e("./lib/utils/common").assign)(s,e("./lib/deflate"),e("./lib/inflate"),e("./lib/zlib/constants")),r.exports=s},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(e,r,i){var s=e("./zlib/deflate"),o=e("./utils/common"),l=e("./utils/strings"),u=e("./zlib/messages"),f=e("./zlib/zstream"),d=Object.prototype.toString,p=0,g=-1,m=0,x=8;function y(P){if(!(this instanceof y))return new y(P);this.options=o.assign({level:g,method:x,chunkSize:16384,windowBits:15,memLevel:8,strategy:m,to:""},P||{});var A=this.options;A.raw&&0<A.windowBits?A.windowBits=-A.windowBits:A.gzip&&0<A.windowBits&&A.windowBits<16&&(A.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new f,this.strm.avail_out=0;var N=s.deflateInit2(this.strm,A.level,A.method,A.windowBits,A.memLevel,A.strategy);if(N!==p)throw new Error(u[N]);if(A.header&&s.deflateSetHeader(this.strm,A.header),A.dictionary){var G;if(G=typeof A.dictionary=="string"?l.string2buf(A.dictionary):d.call(A.dictionary)==="[object ArrayBuffer]"?new Uint8Array(A.dictionary):A.dictionary,(N=s.deflateSetDictionary(this.strm,G))!==p)throw new Error(u[N]);this._dict_set=!0}}function b(P,A){var N=new y(A);if(N.push(P,!0),N.err)throw N.msg||u[N.err];return N.result}y.prototype.push=function(P,A){var N,G,z=this.strm,K=this.options.chunkSize;if(this.ended)return!1;G=A===~~A?A:A===!0?4:0,typeof P=="string"?z.input=l.string2buf(P):d.call(P)==="[object ArrayBuffer]"?z.input=new Uint8Array(P):z.input=P,z.next_in=0,z.avail_in=z.input.length;do{if(z.avail_out===0&&(z.output=new o.Buf8(K),z.next_out=0,z.avail_out=K),(N=s.deflate(z,G))!==1&&N!==p)return this.onEnd(N),!(this.ended=!0);z.avail_out!==0&&(z.avail_in!==0||G!==4&&G!==2)||(this.options.to==="string"?this.onData(l.buf2binstring(o.shrinkBuf(z.output,z.next_out))):this.onData(o.shrinkBuf(z.output,z.next_out)))}while((0<z.avail_in||z.avail_out===0)&&N!==1);return G===4?(N=s.deflateEnd(this.strm),this.onEnd(N),this.ended=!0,N===p):G!==2||(this.onEnd(p),!(z.avail_out=0))},y.prototype.onData=function(P){this.chunks.push(P)},y.prototype.onEnd=function(P){P===p&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=o.flattenChunks(this.chunks)),this.chunks=[],this.err=P,this.msg=this.strm.msg},i.Deflate=y,i.deflate=b,i.deflateRaw=function(P,A){return(A=A||{}).raw=!0,b(P,A)},i.gzip=function(P,A){return(A=A||{}).gzip=!0,b(P,A)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(e,r,i){var s=e("./zlib/inflate"),o=e("./utils/common"),l=e("./utils/strings"),u=e("./zlib/constants"),f=e("./zlib/messages"),d=e("./zlib/zstream"),p=e("./zlib/gzheader"),g=Object.prototype.toString;function m(y){if(!(this instanceof m))return new m(y);this.options=o.assign({chunkSize:16384,windowBits:0,to:""},y||{});var b=this.options;b.raw&&0<=b.windowBits&&b.windowBits<16&&(b.windowBits=-b.windowBits,b.windowBits===0&&(b.windowBits=-15)),!(0<=b.windowBits&&b.windowBits<16)||y&&y.windowBits||(b.windowBits+=32),15<b.windowBits&&b.windowBits<48&&!(15&b.windowBits)&&(b.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new d,this.strm.avail_out=0;var P=s.inflateInit2(this.strm,b.windowBits);if(P!==u.Z_OK)throw new Error(f[P]);this.header=new p,s.inflateGetHeader(this.strm,this.header)}function x(y,b){var P=new m(b);if(P.push(y,!0),P.err)throw P.msg||f[P.err];return P.result}m.prototype.push=function(y,b){var P,A,N,G,z,K,q=this.strm,T=this.options.chunkSize,k=this.options.dictionary,I=!1;if(this.ended)return!1;A=b===~~b?b:b===!0?u.Z_FINISH:u.Z_NO_FLUSH,typeof y=="string"?q.input=l.binstring2buf(y):g.call(y)==="[object ArrayBuffer]"?q.input=new Uint8Array(y):q.input=y,q.next_in=0,q.avail_in=q.input.length;do{if(q.avail_out===0&&(q.output=new o.Buf8(T),q.next_out=0,q.avail_out=T),(P=s.inflate(q,u.Z_NO_FLUSH))===u.Z_NEED_DICT&&k&&(K=typeof k=="string"?l.string2buf(k):g.call(k)==="[object ArrayBuffer]"?new Uint8Array(k):k,P=s.inflateSetDictionary(this.strm,K)),P===u.Z_BUF_ERROR&&I===!0&&(P=u.Z_OK,I=!1),P!==u.Z_STREAM_END&&P!==u.Z_OK)return this.onEnd(P),!(this.ended=!0);q.next_out&&(q.avail_out!==0&&P!==u.Z_STREAM_END&&(q.avail_in!==0||A!==u.Z_FINISH&&A!==u.Z_SYNC_FLUSH)||(this.options.to==="string"?(N=l.utf8border(q.output,q.next_out),G=q.next_out-N,z=l.buf2string(q.output,N),q.next_out=G,q.avail_out=T-G,G&&o.arraySet(q.output,q.output,N,G,0),this.onData(z)):this.onData(o.shrinkBuf(q.output,q.next_out)))),q.avail_in===0&&q.avail_out===0&&(I=!0)}while((0<q.avail_in||q.avail_out===0)&&P!==u.Z_STREAM_END);return P===u.Z_STREAM_END&&(A=u.Z_FINISH),A===u.Z_FINISH?(P=s.inflateEnd(this.strm),this.onEnd(P),this.ended=!0,P===u.Z_OK):A!==u.Z_SYNC_FLUSH||(this.onEnd(u.Z_OK),!(q.avail_out=0))},m.prototype.onData=function(y){this.chunks.push(y)},m.prototype.onEnd=function(y){y===u.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=o.flattenChunks(this.chunks)),this.chunks=[],this.err=y,this.msg=this.strm.msg},i.Inflate=m,i.inflate=x,i.inflateRaw=function(y,b){return(b=b||{}).raw=!0,x(y,b)},i.ungzip=x},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(e,r,i){var s=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";i.assign=function(u){for(var f=Array.prototype.slice.call(arguments,1);f.length;){var d=f.shift();if(d){if(typeof d!="object")throw new TypeError(d+"must be non-object");for(var p in d)d.hasOwnProperty(p)&&(u[p]=d[p])}}return u},i.shrinkBuf=function(u,f){return u.length===f?u:u.subarray?u.subarray(0,f):(u.length=f,u)};var o={arraySet:function(u,f,d,p,g){if(f.subarray&&u.subarray)u.set(f.subarray(d,d+p),g);else for(var m=0;m<p;m++)u[g+m]=f[d+m]},flattenChunks:function(u){var f,d,p,g,m,x;for(f=p=0,d=u.length;f<d;f++)p+=u[f].length;for(x=new Uint8Array(p),f=g=0,d=u.length;f<d;f++)m=u[f],x.set(m,g),g+=m.length;return x}},l={arraySet:function(u,f,d,p,g){for(var m=0;m<p;m++)u[g+m]=f[d+m]},flattenChunks:function(u){return[].concat.apply([],u)}};i.setTyped=function(u){u?(i.Buf8=Uint8Array,i.Buf16=Uint16Array,i.Buf32=Int32Array,i.assign(i,o)):(i.Buf8=Array,i.Buf16=Array,i.Buf32=Array,i.assign(i,l))},i.setTyped(s)},{}],42:[function(e,r,i){var s=e("./common"),o=!0,l=!0;try{String.fromCharCode.apply(null,[0])}catch{o=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{l=!1}for(var u=new s.Buf8(256),f=0;f<256;f++)u[f]=252<=f?6:248<=f?5:240<=f?4:224<=f?3:192<=f?2:1;function d(p,g){if(g<65537&&(p.subarray&&l||!p.subarray&&o))return String.fromCharCode.apply(null,s.shrinkBuf(p,g));for(var m="",x=0;x<g;x++)m+=String.fromCharCode(p[x]);return m}u[254]=u[254]=1,i.string2buf=function(p){var g,m,x,y,b,P=p.length,A=0;for(y=0;y<P;y++)(64512&(m=p.charCodeAt(y)))==55296&&y+1<P&&(64512&(x=p.charCodeAt(y+1)))==56320&&(m=65536+(m-55296<<10)+(x-56320),y++),A+=m<128?1:m<2048?2:m<65536?3:4;for(g=new s.Buf8(A),y=b=0;b<A;y++)(64512&(m=p.charCodeAt(y)))==55296&&y+1<P&&(64512&(x=p.charCodeAt(y+1)))==56320&&(m=65536+(m-55296<<10)+(x-56320),y++),m<128?g[b++]=m:(m<2048?g[b++]=192|m>>>6:(m<65536?g[b++]=224|m>>>12:(g[b++]=240|m>>>18,g[b++]=128|m>>>12&63),g[b++]=128|m>>>6&63),g[b++]=128|63&m);return g},i.buf2binstring=function(p){return d(p,p.length)},i.binstring2buf=function(p){for(var g=new s.Buf8(p.length),m=0,x=g.length;m<x;m++)g[m]=p.charCodeAt(m);return g},i.buf2string=function(p,g){var m,x,y,b,P=g||p.length,A=new Array(2*P);for(m=x=0;m<P;)if((y=p[m++])<128)A[x++]=y;else if(4<(b=u[y]))A[x++]=65533,m+=b-1;else{for(y&=b===2?31:b===3?15:7;1<b&&m<P;)y=y<<6|63&p[m++],b--;1<b?A[x++]=65533:y<65536?A[x++]=y:(y-=65536,A[x++]=55296|y>>10&1023,A[x++]=56320|1023&y)}return d(A,x)},i.utf8border=function(p,g){var m;for((g=g||p.length)>p.length&&(g=p.length),m=g-1;0<=m&&(192&p[m])==128;)m--;return m<0||m===0?g:m+u[p[m]]>g?m:g}},{"./common":41}],43:[function(e,r,i){r.exports=function(s,o,l,u){for(var f=65535&s|0,d=s>>>16&65535|0,p=0;l!==0;){for(l-=p=2e3<l?2e3:l;d=d+(f=f+o[u++]|0)|0,--p;);f%=65521,d%=65521}return f|d<<16|0}},{}],44:[function(e,r,i){r.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(e,r,i){var s=function(){for(var o,l=[],u=0;u<256;u++){o=u;for(var f=0;f<8;f++)o=1&o?3988292384^o>>>1:o>>>1;l[u]=o}return l}();r.exports=function(o,l,u,f){var d=s,p=f+u;o^=-1;for(var g=f;g<p;g++)o=o>>>8^d[255&(o^l[g])];return-1^o}},{}],46:[function(e,r,i){var s,o=e("../utils/common"),l=e("./trees"),u=e("./adler32"),f=e("./crc32"),d=e("./messages"),p=0,g=4,m=0,x=-2,y=-1,b=4,P=2,A=8,N=9,G=286,z=30,K=19,q=2*G+1,T=15,k=3,I=258,F=I+k+1,S=42,O=113,v=1,C=2,U=3,H=4;function W(M,tt){return M.msg=d[tt],tt}function V(M){return(M<<1)-(4<M?9:0)}function et(M){for(var tt=M.length;0<=--tt;)M[tt]=0}function Y(M){var tt=M.state,$=tt.pending;$>M.avail_out&&($=M.avail_out),$!==0&&(o.arraySet(M.output,tt.pending_buf,tt.pending_out,$,M.next_out),M.next_out+=$,tt.pending_out+=$,M.total_out+=$,M.avail_out-=$,tt.pending-=$,tt.pending===0&&(tt.pending_out=0))}function Q(M,tt){l._tr_flush_block(M,0<=M.block_start?M.block_start:-1,M.strstart-M.block_start,tt),M.block_start=M.strstart,Y(M.strm)}function pt(M,tt){M.pending_buf[M.pending++]=tt}function ct(M,tt){M.pending_buf[M.pending++]=tt>>>8&255,M.pending_buf[M.pending++]=255&tt}function rt(M,tt){var $,Z,B=M.max_chain_length,X=M.strstart,ot=M.prev_length,lt=M.nice_match,it=M.strstart>M.w_size-F?M.strstart-(M.w_size-F):0,_t=M.window,xt=M.w_mask,gt=M.prev,Et=M.strstart+I,Wt=_t[X+ot-1],Tt=_t[X+ot];M.prev_length>=M.good_match&&(B>>=2),lt>M.lookahead&&(lt=M.lookahead);do if(_t[($=tt)+ot]===Tt&&_t[$+ot-1]===Wt&&_t[$]===_t[X]&&_t[++$]===_t[X+1]){X+=2,$++;do;while(_t[++X]===_t[++$]&&_t[++X]===_t[++$]&&_t[++X]===_t[++$]&&_t[++X]===_t[++$]&&_t[++X]===_t[++$]&&_t[++X]===_t[++$]&&_t[++X]===_t[++$]&&_t[++X]===_t[++$]&&X<Et);if(Z=I-(Et-X),X=Et-I,ot<Z){if(M.match_start=tt,lt<=(ot=Z))break;Wt=_t[X+ot-1],Tt=_t[X+ot]}}while((tt=gt[tt&xt])>it&&--B!=0);return ot<=M.lookahead?ot:M.lookahead}function mt(M){var tt,$,Z,B,X,ot,lt,it,_t,xt,gt=M.w_size;do{if(B=M.window_size-M.lookahead-M.strstart,M.strstart>=gt+(gt-F)){for(o.arraySet(M.window,M.window,gt,gt,0),M.match_start-=gt,M.strstart-=gt,M.block_start-=gt,tt=$=M.hash_size;Z=M.head[--tt],M.head[tt]=gt<=Z?Z-gt:0,--$;);for(tt=$=gt;Z=M.prev[--tt],M.prev[tt]=gt<=Z?Z-gt:0,--$;);B+=gt}if(M.strm.avail_in===0)break;if(ot=M.strm,lt=M.window,it=M.strstart+M.lookahead,_t=B,xt=void 0,xt=ot.avail_in,_t<xt&&(xt=_t),$=xt===0?0:(ot.avail_in-=xt,o.arraySet(lt,ot.input,ot.next_in,xt,it),ot.state.wrap===1?ot.adler=u(ot.adler,lt,xt,it):ot.state.wrap===2&&(ot.adler=f(ot.adler,lt,xt,it)),ot.next_in+=xt,ot.total_in+=xt,xt),M.lookahead+=$,M.lookahead+M.insert>=k)for(X=M.strstart-M.insert,M.ins_h=M.window[X],M.ins_h=(M.ins_h<<M.hash_shift^M.window[X+1])&M.hash_mask;M.insert&&(M.ins_h=(M.ins_h<<M.hash_shift^M.window[X+k-1])&M.hash_mask,M.prev[X&M.w_mask]=M.head[M.ins_h],M.head[M.ins_h]=X,X++,M.insert--,!(M.lookahead+M.insert<k)););}while(M.lookahead<F&&M.strm.avail_in!==0)}function St(M,tt){for(var $,Z;;){if(M.lookahead<F){if(mt(M),M.lookahead<F&&tt===p)return v;if(M.lookahead===0)break}if($=0,M.lookahead>=k&&(M.ins_h=(M.ins_h<<M.hash_shift^M.window[M.strstart+k-1])&M.hash_mask,$=M.prev[M.strstart&M.w_mask]=M.head[M.ins_h],M.head[M.ins_h]=M.strstart),$!==0&&M.strstart-$<=M.w_size-F&&(M.match_length=rt(M,$)),M.match_length>=k)if(Z=l._tr_tally(M,M.strstart-M.match_start,M.match_length-k),M.lookahead-=M.match_length,M.match_length<=M.max_lazy_match&&M.lookahead>=k){for(M.match_length--;M.strstart++,M.ins_h=(M.ins_h<<M.hash_shift^M.window[M.strstart+k-1])&M.hash_mask,$=M.prev[M.strstart&M.w_mask]=M.head[M.ins_h],M.head[M.ins_h]=M.strstart,--M.match_length!=0;);M.strstart++}else M.strstart+=M.match_length,M.match_length=0,M.ins_h=M.window[M.strstart],M.ins_h=(M.ins_h<<M.hash_shift^M.window[M.strstart+1])&M.hash_mask;else Z=l._tr_tally(M,0,M.window[M.strstart]),M.lookahead--,M.strstart++;if(Z&&(Q(M,!1),M.strm.avail_out===0))return v}return M.insert=M.strstart<k-1?M.strstart:k-1,tt===g?(Q(M,!0),M.strm.avail_out===0?U:H):M.last_lit&&(Q(M,!1),M.strm.avail_out===0)?v:C}function kt(M,tt){for(var $,Z,B;;){if(M.lookahead<F){if(mt(M),M.lookahead<F&&tt===p)return v;if(M.lookahead===0)break}if($=0,M.lookahead>=k&&(M.ins_h=(M.ins_h<<M.hash_shift^M.window[M.strstart+k-1])&M.hash_mask,$=M.prev[M.strstart&M.w_mask]=M.head[M.ins_h],M.head[M.ins_h]=M.strstart),M.prev_length=M.match_length,M.prev_match=M.match_start,M.match_length=k-1,$!==0&&M.prev_length<M.max_lazy_match&&M.strstart-$<=M.w_size-F&&(M.match_length=rt(M,$),M.match_length<=5&&(M.strategy===1||M.match_length===k&&4096<M.strstart-M.match_start)&&(M.match_length=k-1)),M.prev_length>=k&&M.match_length<=M.prev_length){for(B=M.strstart+M.lookahead-k,Z=l._tr_tally(M,M.strstart-1-M.prev_match,M.prev_length-k),M.lookahead-=M.prev_length-1,M.prev_length-=2;++M.strstart<=B&&(M.ins_h=(M.ins_h<<M.hash_shift^M.window[M.strstart+k-1])&M.hash_mask,$=M.prev[M.strstart&M.w_mask]=M.head[M.ins_h],M.head[M.ins_h]=M.strstart),--M.prev_length!=0;);if(M.match_available=0,M.match_length=k-1,M.strstart++,Z&&(Q(M,!1),M.strm.avail_out===0))return v}else if(M.match_available){if((Z=l._tr_tally(M,0,M.window[M.strstart-1]))&&Q(M,!1),M.strstart++,M.lookahead--,M.strm.avail_out===0)return v}else M.match_available=1,M.strstart++,M.lookahead--}return M.match_available&&(Z=l._tr_tally(M,0,M.window[M.strstart-1]),M.match_available=0),M.insert=M.strstart<k-1?M.strstart:k-1,tt===g?(Q(M,!0),M.strm.avail_out===0?U:H):M.last_lit&&(Q(M,!1),M.strm.avail_out===0)?v:C}function It(M,tt,$,Z,B){this.good_length=M,this.max_lazy=tt,this.nice_length=$,this.max_chain=Z,this.func=B}function wt(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=A,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new o.Buf16(2*q),this.dyn_dtree=new o.Buf16(2*(2*z+1)),this.bl_tree=new o.Buf16(2*(2*K+1)),et(this.dyn_ltree),et(this.dyn_dtree),et(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new o.Buf16(T+1),this.heap=new o.Buf16(2*G+1),et(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new o.Buf16(2*G+1),et(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function vt(M){var tt;return M&&M.state?(M.total_in=M.total_out=0,M.data_type=P,(tt=M.state).pending=0,tt.pending_out=0,tt.wrap<0&&(tt.wrap=-tt.wrap),tt.status=tt.wrap?S:O,M.adler=tt.wrap===2?0:1,tt.last_flush=p,l._tr_init(tt),m):W(M,x)}function ht(M){var tt=vt(M);return tt===m&&function($){$.window_size=2*$.w_size,et($.head),$.max_lazy_match=s[$.level].max_lazy,$.good_match=s[$.level].good_length,$.nice_match=s[$.level].nice_length,$.max_chain_length=s[$.level].max_chain,$.strstart=0,$.block_start=0,$.lookahead=0,$.insert=0,$.match_length=$.prev_length=k-1,$.match_available=0,$.ins_h=0}(M.state),tt}function ft(M,tt,$,Z,B,X){if(!M)return x;var ot=1;if(tt===y&&(tt=6),Z<0?(ot=0,Z=-Z):15<Z&&(ot=2,Z-=16),B<1||N<B||$!==A||Z<8||15<Z||tt<0||9<tt||X<0||b<X)return W(M,x);Z===8&&(Z=9);var lt=new wt;return(M.state=lt).strm=M,lt.wrap=ot,lt.gzhead=null,lt.w_bits=Z,lt.w_size=1<<lt.w_bits,lt.w_mask=lt.w_size-1,lt.hash_bits=B+7,lt.hash_size=1<<lt.hash_bits,lt.hash_mask=lt.hash_size-1,lt.hash_shift=~~((lt.hash_bits+k-1)/k),lt.window=new o.Buf8(2*lt.w_size),lt.head=new o.Buf16(lt.hash_size),lt.prev=new o.Buf16(lt.w_size),lt.lit_bufsize=1<<B+6,lt.pending_buf_size=4*lt.lit_bufsize,lt.pending_buf=new o.Buf8(lt.pending_buf_size),lt.d_buf=1*lt.lit_bufsize,lt.l_buf=3*lt.lit_bufsize,lt.level=tt,lt.strategy=X,lt.method=$,ht(M)}s=[new It(0,0,0,0,function(M,tt){var $=65535;for($>M.pending_buf_size-5&&($=M.pending_buf_size-5);;){if(M.lookahead<=1){if(mt(M),M.lookahead===0&&tt===p)return v;if(M.lookahead===0)break}M.strstart+=M.lookahead,M.lookahead=0;var Z=M.block_start+$;if((M.strstart===0||M.strstart>=Z)&&(M.lookahead=M.strstart-Z,M.strstart=Z,Q(M,!1),M.strm.avail_out===0)||M.strstart-M.block_start>=M.w_size-F&&(Q(M,!1),M.strm.avail_out===0))return v}return M.insert=0,tt===g?(Q(M,!0),M.strm.avail_out===0?U:H):(M.strstart>M.block_start&&(Q(M,!1),M.strm.avail_out),v)}),new It(4,4,8,4,St),new It(4,5,16,8,St),new It(4,6,32,32,St),new It(4,4,16,16,kt),new It(8,16,32,32,kt),new It(8,16,128,128,kt),new It(8,32,128,256,kt),new It(32,128,258,1024,kt),new It(32,258,258,4096,kt)],i.deflateInit=function(M,tt){return ft(M,tt,A,15,8,0)},i.deflateInit2=ft,i.deflateReset=ht,i.deflateResetKeep=vt,i.deflateSetHeader=function(M,tt){return M&&M.state?M.state.wrap!==2?x:(M.state.gzhead=tt,m):x},i.deflate=function(M,tt){var $,Z,B,X;if(!M||!M.state||5<tt||tt<0)return M?W(M,x):x;if(Z=M.state,!M.output||!M.input&&M.avail_in!==0||Z.status===666&&tt!==g)return W(M,M.avail_out===0?-5:x);if(Z.strm=M,$=Z.last_flush,Z.last_flush=tt,Z.status===S)if(Z.wrap===2)M.adler=0,pt(Z,31),pt(Z,139),pt(Z,8),Z.gzhead?(pt(Z,(Z.gzhead.text?1:0)+(Z.gzhead.hcrc?2:0)+(Z.gzhead.extra?4:0)+(Z.gzhead.name?8:0)+(Z.gzhead.comment?16:0)),pt(Z,255&Z.gzhead.time),pt(Z,Z.gzhead.time>>8&255),pt(Z,Z.gzhead.time>>16&255),pt(Z,Z.gzhead.time>>24&255),pt(Z,Z.level===9?2:2<=Z.strategy||Z.level<2?4:0),pt(Z,255&Z.gzhead.os),Z.gzhead.extra&&Z.gzhead.extra.length&&(pt(Z,255&Z.gzhead.extra.length),pt(Z,Z.gzhead.extra.length>>8&255)),Z.gzhead.hcrc&&(M.adler=f(M.adler,Z.pending_buf,Z.pending,0)),Z.gzindex=0,Z.status=69):(pt(Z,0),pt(Z,0),pt(Z,0),pt(Z,0),pt(Z,0),pt(Z,Z.level===9?2:2<=Z.strategy||Z.level<2?4:0),pt(Z,3),Z.status=O);else{var ot=A+(Z.w_bits-8<<4)<<8;ot|=(2<=Z.strategy||Z.level<2?0:Z.level<6?1:Z.level===6?2:3)<<6,Z.strstart!==0&&(ot|=32),ot+=31-ot%31,Z.status=O,ct(Z,ot),Z.strstart!==0&&(ct(Z,M.adler>>>16),ct(Z,65535&M.adler)),M.adler=1}if(Z.status===69)if(Z.gzhead.extra){for(B=Z.pending;Z.gzindex<(65535&Z.gzhead.extra.length)&&(Z.pending!==Z.pending_buf_size||(Z.gzhead.hcrc&&Z.pending>B&&(M.adler=f(M.adler,Z.pending_buf,Z.pending-B,B)),Y(M),B=Z.pending,Z.pending!==Z.pending_buf_size));)pt(Z,255&Z.gzhead.extra[Z.gzindex]),Z.gzindex++;Z.gzhead.hcrc&&Z.pending>B&&(M.adler=f(M.adler,Z.pending_buf,Z.pending-B,B)),Z.gzindex===Z.gzhead.extra.length&&(Z.gzindex=0,Z.status=73)}else Z.status=73;if(Z.status===73)if(Z.gzhead.name){B=Z.pending;do{if(Z.pending===Z.pending_buf_size&&(Z.gzhead.hcrc&&Z.pending>B&&(M.adler=f(M.adler,Z.pending_buf,Z.pending-B,B)),Y(M),B=Z.pending,Z.pending===Z.pending_buf_size)){X=1;break}X=Z.gzindex<Z.gzhead.name.length?255&Z.gzhead.name.charCodeAt(Z.gzindex++):0,pt(Z,X)}while(X!==0);Z.gzhead.hcrc&&Z.pending>B&&(M.adler=f(M.adler,Z.pending_buf,Z.pending-B,B)),X===0&&(Z.gzindex=0,Z.status=91)}else Z.status=91;if(Z.status===91)if(Z.gzhead.comment){B=Z.pending;do{if(Z.pending===Z.pending_buf_size&&(Z.gzhead.hcrc&&Z.pending>B&&(M.adler=f(M.adler,Z.pending_buf,Z.pending-B,B)),Y(M),B=Z.pending,Z.pending===Z.pending_buf_size)){X=1;break}X=Z.gzindex<Z.gzhead.comment.length?255&Z.gzhead.comment.charCodeAt(Z.gzindex++):0,pt(Z,X)}while(X!==0);Z.gzhead.hcrc&&Z.pending>B&&(M.adler=f(M.adler,Z.pending_buf,Z.pending-B,B)),X===0&&(Z.status=103)}else Z.status=103;if(Z.status===103&&(Z.gzhead.hcrc?(Z.pending+2>Z.pending_buf_size&&Y(M),Z.pending+2<=Z.pending_buf_size&&(pt(Z,255&M.adler),pt(Z,M.adler>>8&255),M.adler=0,Z.status=O)):Z.status=O),Z.pending!==0){if(Y(M),M.avail_out===0)return Z.last_flush=-1,m}else if(M.avail_in===0&&V(tt)<=V($)&&tt!==g)return W(M,-5);if(Z.status===666&&M.avail_in!==0)return W(M,-5);if(M.avail_in!==0||Z.lookahead!==0||tt!==p&&Z.status!==666){var lt=Z.strategy===2?function(it,_t){for(var xt;;){if(it.lookahead===0&&(mt(it),it.lookahead===0)){if(_t===p)return v;break}if(it.match_length=0,xt=l._tr_tally(it,0,it.window[it.strstart]),it.lookahead--,it.strstart++,xt&&(Q(it,!1),it.strm.avail_out===0))return v}return it.insert=0,_t===g?(Q(it,!0),it.strm.avail_out===0?U:H):it.last_lit&&(Q(it,!1),it.strm.avail_out===0)?v:C}(Z,tt):Z.strategy===3?function(it,_t){for(var xt,gt,Et,Wt,Tt=it.window;;){if(it.lookahead<=I){if(mt(it),it.lookahead<=I&&_t===p)return v;if(it.lookahead===0)break}if(it.match_length=0,it.lookahead>=k&&0<it.strstart&&(gt=Tt[Et=it.strstart-1])===Tt[++Et]&&gt===Tt[++Et]&&gt===Tt[++Et]){Wt=it.strstart+I;do;while(gt===Tt[++Et]&&gt===Tt[++Et]&&gt===Tt[++Et]&&gt===Tt[++Et]&&gt===Tt[++Et]&&gt===Tt[++Et]&&gt===Tt[++Et]&&gt===Tt[++Et]&&Et<Wt);it.match_length=I-(Wt-Et),it.match_length>it.lookahead&&(it.match_length=it.lookahead)}if(it.match_length>=k?(xt=l._tr_tally(it,1,it.match_length-k),it.lookahead-=it.match_length,it.strstart+=it.match_length,it.match_length=0):(xt=l._tr_tally(it,0,it.window[it.strstart]),it.lookahead--,it.strstart++),xt&&(Q(it,!1),it.strm.avail_out===0))return v}return it.insert=0,_t===g?(Q(it,!0),it.strm.avail_out===0?U:H):it.last_lit&&(Q(it,!1),it.strm.avail_out===0)?v:C}(Z,tt):s[Z.level].func(Z,tt);if(lt!==U&&lt!==H||(Z.status=666),lt===v||lt===U)return M.avail_out===0&&(Z.last_flush=-1),m;if(lt===C&&(tt===1?l._tr_align(Z):tt!==5&&(l._tr_stored_block(Z,0,0,!1),tt===3&&(et(Z.head),Z.lookahead===0&&(Z.strstart=0,Z.block_start=0,Z.insert=0))),Y(M),M.avail_out===0))return Z.last_flush=-1,m}return tt!==g?m:Z.wrap<=0?1:(Z.wrap===2?(pt(Z,255&M.adler),pt(Z,M.adler>>8&255),pt(Z,M.adler>>16&255),pt(Z,M.adler>>24&255),pt(Z,255&M.total_in),pt(Z,M.total_in>>8&255),pt(Z,M.total_in>>16&255),pt(Z,M.total_in>>24&255)):(ct(Z,M.adler>>>16),ct(Z,65535&M.adler)),Y(M),0<Z.wrap&&(Z.wrap=-Z.wrap),Z.pending!==0?m:1)},i.deflateEnd=function(M){var tt;return M&&M.state?(tt=M.state.status)!==S&&tt!==69&&tt!==73&&tt!==91&&tt!==103&&tt!==O&&tt!==666?W(M,x):(M.state=null,tt===O?W(M,-3):m):x},i.deflateSetDictionary=function(M,tt){var $,Z,B,X,ot,lt,it,_t,xt=tt.length;if(!M||!M.state||(X=($=M.state).wrap)===2||X===1&&$.status!==S||$.lookahead)return x;for(X===1&&(M.adler=u(M.adler,tt,xt,0)),$.wrap=0,xt>=$.w_size&&(X===0&&(et($.head),$.strstart=0,$.block_start=0,$.insert=0),_t=new o.Buf8($.w_size),o.arraySet(_t,tt,xt-$.w_size,$.w_size,0),tt=_t,xt=$.w_size),ot=M.avail_in,lt=M.next_in,it=M.input,M.avail_in=xt,M.next_in=0,M.input=tt,mt($);$.lookahead>=k;){for(Z=$.strstart,B=$.lookahead-(k-1);$.ins_h=($.ins_h<<$.hash_shift^$.window[Z+k-1])&$.hash_mask,$.prev[Z&$.w_mask]=$.head[$.ins_h],$.head[$.ins_h]=Z,Z++,--B;);$.strstart=Z,$.lookahead=k-1,mt($)}return $.strstart+=$.lookahead,$.block_start=$.strstart,$.insert=$.lookahead,$.lookahead=0,$.match_length=$.prev_length=k-1,$.match_available=0,M.next_in=lt,M.input=it,M.avail_in=ot,$.wrap=X,m},i.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(e,r,i){r.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(e,r,i){r.exports=function(s,o){var l,u,f,d,p,g,m,x,y,b,P,A,N,G,z,K,q,T,k,I,F,S,O,v,C;l=s.state,u=s.next_in,v=s.input,f=u+(s.avail_in-5),d=s.next_out,C=s.output,p=d-(o-s.avail_out),g=d+(s.avail_out-257),m=l.dmax,x=l.wsize,y=l.whave,b=l.wnext,P=l.window,A=l.hold,N=l.bits,G=l.lencode,z=l.distcode,K=(1<<l.lenbits)-1,q=(1<<l.distbits)-1;t:do{N<15&&(A+=v[u++]<<N,N+=8,A+=v[u++]<<N,N+=8),T=G[A&K];e:for(;;){if(A>>>=k=T>>>24,N-=k,(k=T>>>16&255)===0)C[d++]=65535&T;else{if(!(16&k)){if(!(64&k)){T=G[(65535&T)+(A&(1<<k)-1)];continue e}if(32&k){l.mode=12;break t}s.msg="invalid literal/length code",l.mode=30;break t}I=65535&T,(k&=15)&&(N<k&&(A+=v[u++]<<N,N+=8),I+=A&(1<<k)-1,A>>>=k,N-=k),N<15&&(A+=v[u++]<<N,N+=8,A+=v[u++]<<N,N+=8),T=z[A&q];i:for(;;){if(A>>>=k=T>>>24,N-=k,!(16&(k=T>>>16&255))){if(!(64&k)){T=z[(65535&T)+(A&(1<<k)-1)];continue i}s.msg="invalid distance code",l.mode=30;break t}if(F=65535&T,N<(k&=15)&&(A+=v[u++]<<N,(N+=8)<k&&(A+=v[u++]<<N,N+=8)),m<(F+=A&(1<<k)-1)){s.msg="invalid distance too far back",l.mode=30;break t}if(A>>>=k,N-=k,(k=d-p)<F){if(y<(k=F-k)&&l.sane){s.msg="invalid distance too far back",l.mode=30;break t}if(O=P,(S=0)===b){if(S+=x-k,k<I){for(I-=k;C[d++]=P[S++],--k;);S=d-F,O=C}}else if(b<k){if(S+=x+b-k,(k-=b)<I){for(I-=k;C[d++]=P[S++],--k;);if(S=0,b<I){for(I-=k=b;C[d++]=P[S++],--k;);S=d-F,O=C}}}else if(S+=b-k,k<I){for(I-=k;C[d++]=P[S++],--k;);S=d-F,O=C}for(;2<I;)C[d++]=O[S++],C[d++]=O[S++],C[d++]=O[S++],I-=3;I&&(C[d++]=O[S++],1<I&&(C[d++]=O[S++]))}else{for(S=d-F;C[d++]=C[S++],C[d++]=C[S++],C[d++]=C[S++],2<(I-=3););I&&(C[d++]=C[S++],1<I&&(C[d++]=C[S++]))}break}}break}}while(u<f&&d<g);u-=I=N>>3,A&=(1<<(N-=I<<3))-1,s.next_in=u,s.next_out=d,s.avail_in=u<f?f-u+5:5-(u-f),s.avail_out=d<g?g-d+257:257-(d-g),l.hold=A,l.bits=N}},{}],49:[function(e,r,i){var s=e("../utils/common"),o=e("./adler32"),l=e("./crc32"),u=e("./inffast"),f=e("./inftrees"),d=1,p=2,g=0,m=-2,x=1,y=852,b=592;function P(S){return(S>>>24&255)+(S>>>8&65280)+((65280&S)<<8)+((255&S)<<24)}function A(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new s.Buf16(320),this.work=new s.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function N(S){var O;return S&&S.state?(O=S.state,S.total_in=S.total_out=O.total=0,S.msg="",O.wrap&&(S.adler=1&O.wrap),O.mode=x,O.last=0,O.havedict=0,O.dmax=32768,O.head=null,O.hold=0,O.bits=0,O.lencode=O.lendyn=new s.Buf32(y),O.distcode=O.distdyn=new s.Buf32(b),O.sane=1,O.back=-1,g):m}function G(S){var O;return S&&S.state?((O=S.state).wsize=0,O.whave=0,O.wnext=0,N(S)):m}function z(S,O){var v,C;return S&&S.state?(C=S.state,O<0?(v=0,O=-O):(v=1+(O>>4),O<48&&(O&=15)),O&&(O<8||15<O)?m:(C.window!==null&&C.wbits!==O&&(C.window=null),C.wrap=v,C.wbits=O,G(S))):m}function K(S,O){var v,C;return S?(C=new A,(S.state=C).window=null,(v=z(S,O))!==g&&(S.state=null),v):m}var q,T,k=!0;function I(S){if(k){var O;for(q=new s.Buf32(512),T=new s.Buf32(32),O=0;O<144;)S.lens[O++]=8;for(;O<256;)S.lens[O++]=9;for(;O<280;)S.lens[O++]=7;for(;O<288;)S.lens[O++]=8;for(f(d,S.lens,0,288,q,0,S.work,{bits:9}),O=0;O<32;)S.lens[O++]=5;f(p,S.lens,0,32,T,0,S.work,{bits:5}),k=!1}S.lencode=q,S.lenbits=9,S.distcode=T,S.distbits=5}function F(S,O,v,C){var U,H=S.state;return H.window===null&&(H.wsize=1<<H.wbits,H.wnext=0,H.whave=0,H.window=new s.Buf8(H.wsize)),C>=H.wsize?(s.arraySet(H.window,O,v-H.wsize,H.wsize,0),H.wnext=0,H.whave=H.wsize):(C<(U=H.wsize-H.wnext)&&(U=C),s.arraySet(H.window,O,v-C,U,H.wnext),(C-=U)?(s.arraySet(H.window,O,v-C,C,0),H.wnext=C,H.whave=H.wsize):(H.wnext+=U,H.wnext===H.wsize&&(H.wnext=0),H.whave<H.wsize&&(H.whave+=U))),0}i.inflateReset=G,i.inflateReset2=z,i.inflateResetKeep=N,i.inflateInit=function(S){return K(S,15)},i.inflateInit2=K,i.inflate=function(S,O){var v,C,U,H,W,V,et,Y,Q,pt,ct,rt,mt,St,kt,It,wt,vt,ht,ft,M,tt,$,Z,B=0,X=new s.Buf8(4),ot=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!S||!S.state||!S.output||!S.input&&S.avail_in!==0)return m;(v=S.state).mode===12&&(v.mode=13),W=S.next_out,U=S.output,et=S.avail_out,H=S.next_in,C=S.input,V=S.avail_in,Y=v.hold,Q=v.bits,pt=V,ct=et,tt=g;t:for(;;)switch(v.mode){case x:if(v.wrap===0){v.mode=13;break}for(;Q<16;){if(V===0)break t;V--,Y+=C[H++]<<Q,Q+=8}if(2&v.wrap&&Y===35615){X[v.check=0]=255&Y,X[1]=Y>>>8&255,v.check=l(v.check,X,2,0),Q=Y=0,v.mode=2;break}if(v.flags=0,v.head&&(v.head.done=!1),!(1&v.wrap)||(((255&Y)<<8)+(Y>>8))%31){S.msg="incorrect header check",v.mode=30;break}if((15&Y)!=8){S.msg="unknown compression method",v.mode=30;break}if(Q-=4,M=8+(15&(Y>>>=4)),v.wbits===0)v.wbits=M;else if(M>v.wbits){S.msg="invalid window size",v.mode=30;break}v.dmax=1<<M,S.adler=v.check=1,v.mode=512&Y?10:12,Q=Y=0;break;case 2:for(;Q<16;){if(V===0)break t;V--,Y+=C[H++]<<Q,Q+=8}if(v.flags=Y,(255&v.flags)!=8){S.msg="unknown compression method",v.mode=30;break}if(57344&v.flags){S.msg="unknown header flags set",v.mode=30;break}v.head&&(v.head.text=Y>>8&1),512&v.flags&&(X[0]=255&Y,X[1]=Y>>>8&255,v.check=l(v.check,X,2,0)),Q=Y=0,v.mode=3;case 3:for(;Q<32;){if(V===0)break t;V--,Y+=C[H++]<<Q,Q+=8}v.head&&(v.head.time=Y),512&v.flags&&(X[0]=255&Y,X[1]=Y>>>8&255,X[2]=Y>>>16&255,X[3]=Y>>>24&255,v.check=l(v.check,X,4,0)),Q=Y=0,v.mode=4;case 4:for(;Q<16;){if(V===0)break t;V--,Y+=C[H++]<<Q,Q+=8}v.head&&(v.head.xflags=255&Y,v.head.os=Y>>8),512&v.flags&&(X[0]=255&Y,X[1]=Y>>>8&255,v.check=l(v.check,X,2,0)),Q=Y=0,v.mode=5;case 5:if(1024&v.flags){for(;Q<16;){if(V===0)break t;V--,Y+=C[H++]<<Q,Q+=8}v.length=Y,v.head&&(v.head.extra_len=Y),512&v.flags&&(X[0]=255&Y,X[1]=Y>>>8&255,v.check=l(v.check,X,2,0)),Q=Y=0}else v.head&&(v.head.extra=null);v.mode=6;case 6:if(1024&v.flags&&(V<(rt=v.length)&&(rt=V),rt&&(v.head&&(M=v.head.extra_len-v.length,v.head.extra||(v.head.extra=new Array(v.head.extra_len)),s.arraySet(v.head.extra,C,H,rt,M)),512&v.flags&&(v.check=l(v.check,C,rt,H)),V-=rt,H+=rt,v.length-=rt),v.length))break t;v.length=0,v.mode=7;case 7:if(2048&v.flags){if(V===0)break t;for(rt=0;M=C[H+rt++],v.head&&M&&v.length<65536&&(v.head.name+=String.fromCharCode(M)),M&&rt<V;);if(512&v.flags&&(v.check=l(v.check,C,rt,H)),V-=rt,H+=rt,M)break t}else v.head&&(v.head.name=null);v.length=0,v.mode=8;case 8:if(4096&v.flags){if(V===0)break t;for(rt=0;M=C[H+rt++],v.head&&M&&v.length<65536&&(v.head.comment+=String.fromCharCode(M)),M&&rt<V;);if(512&v.flags&&(v.check=l(v.check,C,rt,H)),V-=rt,H+=rt,M)break t}else v.head&&(v.head.comment=null);v.mode=9;case 9:if(512&v.flags){for(;Q<16;){if(V===0)break t;V--,Y+=C[H++]<<Q,Q+=8}if(Y!==(65535&v.check)){S.msg="header crc mismatch",v.mode=30;break}Q=Y=0}v.head&&(v.head.hcrc=v.flags>>9&1,v.head.done=!0),S.adler=v.check=0,v.mode=12;break;case 10:for(;Q<32;){if(V===0)break t;V--,Y+=C[H++]<<Q,Q+=8}S.adler=v.check=P(Y),Q=Y=0,v.mode=11;case 11:if(v.havedict===0)return S.next_out=W,S.avail_out=et,S.next_in=H,S.avail_in=V,v.hold=Y,v.bits=Q,2;S.adler=v.check=1,v.mode=12;case 12:if(O===5||O===6)break t;case 13:if(v.last){Y>>>=7&Q,Q-=7&Q,v.mode=27;break}for(;Q<3;){if(V===0)break t;V--,Y+=C[H++]<<Q,Q+=8}switch(v.last=1&Y,Q-=1,3&(Y>>>=1)){case 0:v.mode=14;break;case 1:if(I(v),v.mode=20,O!==6)break;Y>>>=2,Q-=2;break t;case 2:v.mode=17;break;case 3:S.msg="invalid block type",v.mode=30}Y>>>=2,Q-=2;break;case 14:for(Y>>>=7&Q,Q-=7&Q;Q<32;){if(V===0)break t;V--,Y+=C[H++]<<Q,Q+=8}if((65535&Y)!=(Y>>>16^65535)){S.msg="invalid stored block lengths",v.mode=30;break}if(v.length=65535&Y,Q=Y=0,v.mode=15,O===6)break t;case 15:v.mode=16;case 16:if(rt=v.length){if(V<rt&&(rt=V),et<rt&&(rt=et),rt===0)break t;s.arraySet(U,C,H,rt,W),V-=rt,H+=rt,et-=rt,W+=rt,v.length-=rt;break}v.mode=12;break;case 17:for(;Q<14;){if(V===0)break t;V--,Y+=C[H++]<<Q,Q+=8}if(v.nlen=257+(31&Y),Y>>>=5,Q-=5,v.ndist=1+(31&Y),Y>>>=5,Q-=5,v.ncode=4+(15&Y),Y>>>=4,Q-=4,286<v.nlen||30<v.ndist){S.msg="too many length or distance symbols",v.mode=30;break}v.have=0,v.mode=18;case 18:for(;v.have<v.ncode;){for(;Q<3;){if(V===0)break t;V--,Y+=C[H++]<<Q,Q+=8}v.lens[ot[v.have++]]=7&Y,Y>>>=3,Q-=3}for(;v.have<19;)v.lens[ot[v.have++]]=0;if(v.lencode=v.lendyn,v.lenbits=7,$={bits:v.lenbits},tt=f(0,v.lens,0,19,v.lencode,0,v.work,$),v.lenbits=$.bits,tt){S.msg="invalid code lengths set",v.mode=30;break}v.have=0,v.mode=19;case 19:for(;v.have<v.nlen+v.ndist;){for(;It=(B=v.lencode[Y&(1<<v.lenbits)-1])>>>16&255,wt=65535&B,!((kt=B>>>24)<=Q);){if(V===0)break t;V--,Y+=C[H++]<<Q,Q+=8}if(wt<16)Y>>>=kt,Q-=kt,v.lens[v.have++]=wt;else{if(wt===16){for(Z=kt+2;Q<Z;){if(V===0)break t;V--,Y+=C[H++]<<Q,Q+=8}if(Y>>>=kt,Q-=kt,v.have===0){S.msg="invalid bit length repeat",v.mode=30;break}M=v.lens[v.have-1],rt=3+(3&Y),Y>>>=2,Q-=2}else if(wt===17){for(Z=kt+3;Q<Z;){if(V===0)break t;V--,Y+=C[H++]<<Q,Q+=8}Q-=kt,M=0,rt=3+(7&(Y>>>=kt)),Y>>>=3,Q-=3}else{for(Z=kt+7;Q<Z;){if(V===0)break t;V--,Y+=C[H++]<<Q,Q+=8}Q-=kt,M=0,rt=11+(127&(Y>>>=kt)),Y>>>=7,Q-=7}if(v.have+rt>v.nlen+v.ndist){S.msg="invalid bit length repeat",v.mode=30;break}for(;rt--;)v.lens[v.have++]=M}}if(v.mode===30)break;if(v.lens[256]===0){S.msg="invalid code -- missing end-of-block",v.mode=30;break}if(v.lenbits=9,$={bits:v.lenbits},tt=f(d,v.lens,0,v.nlen,v.lencode,0,v.work,$),v.lenbits=$.bits,tt){S.msg="invalid literal/lengths set",v.mode=30;break}if(v.distbits=6,v.distcode=v.distdyn,$={bits:v.distbits},tt=f(p,v.lens,v.nlen,v.ndist,v.distcode,0,v.work,$),v.distbits=$.bits,tt){S.msg="invalid distances set",v.mode=30;break}if(v.mode=20,O===6)break t;case 20:v.mode=21;case 21:if(6<=V&&258<=et){S.next_out=W,S.avail_out=et,S.next_in=H,S.avail_in=V,v.hold=Y,v.bits=Q,u(S,ct),W=S.next_out,U=S.output,et=S.avail_out,H=S.next_in,C=S.input,V=S.avail_in,Y=v.hold,Q=v.bits,v.mode===12&&(v.back=-1);break}for(v.back=0;It=(B=v.lencode[Y&(1<<v.lenbits)-1])>>>16&255,wt=65535&B,!((kt=B>>>24)<=Q);){if(V===0)break t;V--,Y+=C[H++]<<Q,Q+=8}if(It&&!(240&It)){for(vt=kt,ht=It,ft=wt;It=(B=v.lencode[ft+((Y&(1<<vt+ht)-1)>>vt)])>>>16&255,wt=65535&B,!(vt+(kt=B>>>24)<=Q);){if(V===0)break t;V--,Y+=C[H++]<<Q,Q+=8}Y>>>=vt,Q-=vt,v.back+=vt}if(Y>>>=kt,Q-=kt,v.back+=kt,v.length=wt,It===0){v.mode=26;break}if(32&It){v.back=-1,v.mode=12;break}if(64&It){S.msg="invalid literal/length code",v.mode=30;break}v.extra=15&It,v.mode=22;case 22:if(v.extra){for(Z=v.extra;Q<Z;){if(V===0)break t;V--,Y+=C[H++]<<Q,Q+=8}v.length+=Y&(1<<v.extra)-1,Y>>>=v.extra,Q-=v.extra,v.back+=v.extra}v.was=v.length,v.mode=23;case 23:for(;It=(B=v.distcode[Y&(1<<v.distbits)-1])>>>16&255,wt=65535&B,!((kt=B>>>24)<=Q);){if(V===0)break t;V--,Y+=C[H++]<<Q,Q+=8}if(!(240&It)){for(vt=kt,ht=It,ft=wt;It=(B=v.distcode[ft+((Y&(1<<vt+ht)-1)>>vt)])>>>16&255,wt=65535&B,!(vt+(kt=B>>>24)<=Q);){if(V===0)break t;V--,Y+=C[H++]<<Q,Q+=8}Y>>>=vt,Q-=vt,v.back+=vt}if(Y>>>=kt,Q-=kt,v.back+=kt,64&It){S.msg="invalid distance code",v.mode=30;break}v.offset=wt,v.extra=15&It,v.mode=24;case 24:if(v.extra){for(Z=v.extra;Q<Z;){if(V===0)break t;V--,Y+=C[H++]<<Q,Q+=8}v.offset+=Y&(1<<v.extra)-1,Y>>>=v.extra,Q-=v.extra,v.back+=v.extra}if(v.offset>v.dmax){S.msg="invalid distance too far back",v.mode=30;break}v.mode=25;case 25:if(et===0)break t;if(rt=ct-et,v.offset>rt){if((rt=v.offset-rt)>v.whave&&v.sane){S.msg="invalid distance too far back",v.mode=30;break}mt=rt>v.wnext?(rt-=v.wnext,v.wsize-rt):v.wnext-rt,rt>v.length&&(rt=v.length),St=v.window}else St=U,mt=W-v.offset,rt=v.length;for(et<rt&&(rt=et),et-=rt,v.length-=rt;U[W++]=St[mt++],--rt;);v.length===0&&(v.mode=21);break;case 26:if(et===0)break t;U[W++]=v.length,et--,v.mode=21;break;case 27:if(v.wrap){for(;Q<32;){if(V===0)break t;V--,Y|=C[H++]<<Q,Q+=8}if(ct-=et,S.total_out+=ct,v.total+=ct,ct&&(S.adler=v.check=v.flags?l(v.check,U,ct,W-ct):o(v.check,U,ct,W-ct)),ct=et,(v.flags?Y:P(Y))!==v.check){S.msg="incorrect data check",v.mode=30;break}Q=Y=0}v.mode=28;case 28:if(v.wrap&&v.flags){for(;Q<32;){if(V===0)break t;V--,Y+=C[H++]<<Q,Q+=8}if(Y!==(4294967295&v.total)){S.msg="incorrect length check",v.mode=30;break}Q=Y=0}v.mode=29;case 29:tt=1;break t;case 30:tt=-3;break t;case 31:return-4;case 32:default:return m}return S.next_out=W,S.avail_out=et,S.next_in=H,S.avail_in=V,v.hold=Y,v.bits=Q,(v.wsize||ct!==S.avail_out&&v.mode<30&&(v.mode<27||O!==4))&&F(S,S.output,S.next_out,ct-S.avail_out)?(v.mode=31,-4):(pt-=S.avail_in,ct-=S.avail_out,S.total_in+=pt,S.total_out+=ct,v.total+=ct,v.wrap&&ct&&(S.adler=v.check=v.flags?l(v.check,U,ct,S.next_out-ct):o(v.check,U,ct,S.next_out-ct)),S.data_type=v.bits+(v.last?64:0)+(v.mode===12?128:0)+(v.mode===20||v.mode===15?256:0),(pt==0&&ct===0||O===4)&&tt===g&&(tt=-5),tt)},i.inflateEnd=function(S){if(!S||!S.state)return m;var O=S.state;return O.window&&(O.window=null),S.state=null,g},i.inflateGetHeader=function(S,O){var v;return S&&S.state&&2&(v=S.state).wrap?((v.head=O).done=!1,g):m},i.inflateSetDictionary=function(S,O){var v,C=O.length;return S&&S.state?(v=S.state).wrap!==0&&v.mode!==11?m:v.mode===11&&o(1,O,C,0)!==v.check?-3:F(S,O,C,C)?(v.mode=31,-4):(v.havedict=1,g):m},i.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(e,r,i){var s=e("../utils/common"),o=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],l=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],u=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],f=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];r.exports=function(d,p,g,m,x,y,b,P){var A,N,G,z,K,q,T,k,I,F=P.bits,S=0,O=0,v=0,C=0,U=0,H=0,W=0,V=0,et=0,Y=0,Q=null,pt=0,ct=new s.Buf16(16),rt=new s.Buf16(16),mt=null,St=0;for(S=0;S<=15;S++)ct[S]=0;for(O=0;O<m;O++)ct[p[g+O]]++;for(U=F,C=15;1<=C&&ct[C]===0;C--);if(C<U&&(U=C),C===0)return x[y++]=20971520,x[y++]=20971520,P.bits=1,0;for(v=1;v<C&&ct[v]===0;v++);for(U<v&&(U=v),S=V=1;S<=15;S++)if(V<<=1,(V-=ct[S])<0)return-1;if(0<V&&(d===0||C!==1))return-1;for(rt[1]=0,S=1;S<15;S++)rt[S+1]=rt[S]+ct[S];for(O=0;O<m;O++)p[g+O]!==0&&(b[rt[p[g+O]]++]=O);if(q=d===0?(Q=mt=b,19):d===1?(Q=o,pt-=257,mt=l,St-=257,256):(Q=u,mt=f,-1),S=v,K=y,W=O=Y=0,G=-1,z=(et=1<<(H=U))-1,d===1&&852<et||d===2&&592<et)return 1;for(;;){for(T=S-W,I=b[O]<q?(k=0,b[O]):b[O]>q?(k=mt[St+b[O]],Q[pt+b[O]]):(k=96,0),A=1<<S-W,v=N=1<<H;x[K+(Y>>W)+(N-=A)]=T<<24|k<<16|I|0,N!==0;);for(A=1<<S-1;Y&A;)A>>=1;if(A!==0?(Y&=A-1,Y+=A):Y=0,O++,--ct[S]==0){if(S===C)break;S=p[g+b[O]]}if(U<S&&(Y&z)!==G){for(W===0&&(W=U),K+=v,V=1<<(H=S-W);H+W<C&&!((V-=ct[H+W])<=0);)H++,V<<=1;if(et+=1<<H,d===1&&852<et||d===2&&592<et)return 1;x[G=Y&z]=U<<24|H<<16|K-y|0}}return Y!==0&&(x[K+Y]=S-W<<24|64<<16|0),P.bits=U,0}},{"../utils/common":41}],51:[function(e,r,i){r.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(e,r,i){var s=e("../utils/common"),o=0,l=1;function u(B){for(var X=B.length;0<=--X;)B[X]=0}var f=0,d=29,p=256,g=p+1+d,m=30,x=19,y=2*g+1,b=15,P=16,A=7,N=256,G=16,z=17,K=18,q=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],T=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],k=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],I=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],F=new Array(2*(g+2));u(F);var S=new Array(2*m);u(S);var O=new Array(512);u(O);var v=new Array(256);u(v);var C=new Array(d);u(C);var U,H,W,V=new Array(m);function et(B,X,ot,lt,it){this.static_tree=B,this.extra_bits=X,this.extra_base=ot,this.elems=lt,this.max_length=it,this.has_stree=B&&B.length}function Y(B,X){this.dyn_tree=B,this.max_code=0,this.stat_desc=X}function Q(B){return B<256?O[B]:O[256+(B>>>7)]}function pt(B,X){B.pending_buf[B.pending++]=255&X,B.pending_buf[B.pending++]=X>>>8&255}function ct(B,X,ot){B.bi_valid>P-ot?(B.bi_buf|=X<<B.bi_valid&65535,pt(B,B.bi_buf),B.bi_buf=X>>P-B.bi_valid,B.bi_valid+=ot-P):(B.bi_buf|=X<<B.bi_valid&65535,B.bi_valid+=ot)}function rt(B,X,ot){ct(B,ot[2*X],ot[2*X+1])}function mt(B,X){for(var ot=0;ot|=1&B,B>>>=1,ot<<=1,0<--X;);return ot>>>1}function St(B,X,ot){var lt,it,_t=new Array(b+1),xt=0;for(lt=1;lt<=b;lt++)_t[lt]=xt=xt+ot[lt-1]<<1;for(it=0;it<=X;it++){var gt=B[2*it+1];gt!==0&&(B[2*it]=mt(_t[gt]++,gt))}}function kt(B){var X;for(X=0;X<g;X++)B.dyn_ltree[2*X]=0;for(X=0;X<m;X++)B.dyn_dtree[2*X]=0;for(X=0;X<x;X++)B.bl_tree[2*X]=0;B.dyn_ltree[2*N]=1,B.opt_len=B.static_len=0,B.last_lit=B.matches=0}function It(B){8<B.bi_valid?pt(B,B.bi_buf):0<B.bi_valid&&(B.pending_buf[B.pending++]=B.bi_buf),B.bi_buf=0,B.bi_valid=0}function wt(B,X,ot,lt){var it=2*X,_t=2*ot;return B[it]<B[_t]||B[it]===B[_t]&&lt[X]<=lt[ot]}function vt(B,X,ot){for(var lt=B.heap[ot],it=ot<<1;it<=B.heap_len&&(it<B.heap_len&&wt(X,B.heap[it+1],B.heap[it],B.depth)&&it++,!wt(X,lt,B.heap[it],B.depth));)B.heap[ot]=B.heap[it],ot=it,it<<=1;B.heap[ot]=lt}function ht(B,X,ot){var lt,it,_t,xt,gt=0;if(B.last_lit!==0)for(;lt=B.pending_buf[B.d_buf+2*gt]<<8|B.pending_buf[B.d_buf+2*gt+1],it=B.pending_buf[B.l_buf+gt],gt++,lt===0?rt(B,it,X):(rt(B,(_t=v[it])+p+1,X),(xt=q[_t])!==0&&ct(B,it-=C[_t],xt),rt(B,_t=Q(--lt),ot),(xt=T[_t])!==0&&ct(B,lt-=V[_t],xt)),gt<B.last_lit;);rt(B,N,X)}function ft(B,X){var ot,lt,it,_t=X.dyn_tree,xt=X.stat_desc.static_tree,gt=X.stat_desc.has_stree,Et=X.stat_desc.elems,Wt=-1;for(B.heap_len=0,B.heap_max=y,ot=0;ot<Et;ot++)_t[2*ot]!==0?(B.heap[++B.heap_len]=Wt=ot,B.depth[ot]=0):_t[2*ot+1]=0;for(;B.heap_len<2;)_t[2*(it=B.heap[++B.heap_len]=Wt<2?++Wt:0)]=1,B.depth[it]=0,B.opt_len--,gt&&(B.static_len-=xt[2*it+1]);for(X.max_code=Wt,ot=B.heap_len>>1;1<=ot;ot--)vt(B,_t,ot);for(it=Et;ot=B.heap[1],B.heap[1]=B.heap[B.heap_len--],vt(B,_t,1),lt=B.heap[1],B.heap[--B.heap_max]=ot,B.heap[--B.heap_max]=lt,_t[2*it]=_t[2*ot]+_t[2*lt],B.depth[it]=(B.depth[ot]>=B.depth[lt]?B.depth[ot]:B.depth[lt])+1,_t[2*ot+1]=_t[2*lt+1]=it,B.heap[1]=it++,vt(B,_t,1),2<=B.heap_len;);B.heap[--B.heap_max]=B.heap[1],function(Tt,$t){var fe,se,ye,Jt,ve,oe,xe=$t.dyn_tree,Fe=$t.max_code,ii=$t.stat_desc.static_tree,ni=$t.stat_desc.has_stree,yi=$t.stat_desc.extra_bits,je=$t.stat_desc.extra_base,ie=$t.stat_desc.max_length,Ii=0;for(Jt=0;Jt<=b;Jt++)Tt.bl_count[Jt]=0;for(xe[2*Tt.heap[Tt.heap_max]+1]=0,fe=Tt.heap_max+1;fe<y;fe++)ie<(Jt=xe[2*xe[2*(se=Tt.heap[fe])+1]+1]+1)&&(Jt=ie,Ii++),xe[2*se+1]=Jt,Fe<se||(Tt.bl_count[Jt]++,ve=0,je<=se&&(ve=yi[se-je]),oe=xe[2*se],Tt.opt_len+=oe*(Jt+ve),ni&&(Tt.static_len+=oe*(ii[2*se+1]+ve)));if(Ii!==0){do{for(Jt=ie-1;Tt.bl_count[Jt]===0;)Jt--;Tt.bl_count[Jt]--,Tt.bl_count[Jt+1]+=2,Tt.bl_count[ie]--,Ii-=2}while(0<Ii);for(Jt=ie;Jt!==0;Jt--)for(se=Tt.bl_count[Jt];se!==0;)Fe<(ye=Tt.heap[--fe])||(xe[2*ye+1]!==Jt&&(Tt.opt_len+=(Jt-xe[2*ye+1])*xe[2*ye],xe[2*ye+1]=Jt),se--)}}(B,X),St(_t,Wt,B.bl_count)}function M(B,X,ot){var lt,it,_t=-1,xt=X[1],gt=0,Et=7,Wt=4;for(xt===0&&(Et=138,Wt=3),X[2*(ot+1)+1]=65535,lt=0;lt<=ot;lt++)it=xt,xt=X[2*(lt+1)+1],++gt<Et&&it===xt||(gt<Wt?B.bl_tree[2*it]+=gt:it!==0?(it!==_t&&B.bl_tree[2*it]++,B.bl_tree[2*G]++):gt<=10?B.bl_tree[2*z]++:B.bl_tree[2*K]++,_t=it,Wt=(gt=0)===xt?(Et=138,3):it===xt?(Et=6,3):(Et=7,4))}function tt(B,X,ot){var lt,it,_t=-1,xt=X[1],gt=0,Et=7,Wt=4;for(xt===0&&(Et=138,Wt=3),lt=0;lt<=ot;lt++)if(it=xt,xt=X[2*(lt+1)+1],!(++gt<Et&&it===xt)){if(gt<Wt)for(;rt(B,it,B.bl_tree),--gt!=0;);else it!==0?(it!==_t&&(rt(B,it,B.bl_tree),gt--),rt(B,G,B.bl_tree),ct(B,gt-3,2)):gt<=10?(rt(B,z,B.bl_tree),ct(B,gt-3,3)):(rt(B,K,B.bl_tree),ct(B,gt-11,7));_t=it,Wt=(gt=0)===xt?(Et=138,3):it===xt?(Et=6,3):(Et=7,4)}}u(V);var $=!1;function Z(B,X,ot,lt){ct(B,(f<<1)+(lt?1:0),3),function(it,_t,xt,gt){It(it),pt(it,xt),pt(it,~xt),s.arraySet(it.pending_buf,it.window,_t,xt,it.pending),it.pending+=xt}(B,X,ot)}i._tr_init=function(B){$||(function(){var X,ot,lt,it,_t,xt=new Array(b+1);for(it=lt=0;it<d-1;it++)for(C[it]=lt,X=0;X<1<<q[it];X++)v[lt++]=it;for(v[lt-1]=it,it=_t=0;it<16;it++)for(V[it]=_t,X=0;X<1<<T[it];X++)O[_t++]=it;for(_t>>=7;it<m;it++)for(V[it]=_t<<7,X=0;X<1<<T[it]-7;X++)O[256+_t++]=it;for(ot=0;ot<=b;ot++)xt[ot]=0;for(X=0;X<=143;)F[2*X+1]=8,X++,xt[8]++;for(;X<=255;)F[2*X+1]=9,X++,xt[9]++;for(;X<=279;)F[2*X+1]=7,X++,xt[7]++;for(;X<=287;)F[2*X+1]=8,X++,xt[8]++;for(St(F,g+1,xt),X=0;X<m;X++)S[2*X+1]=5,S[2*X]=mt(X,5);U=new et(F,q,p+1,g,b),H=new et(S,T,0,m,b),W=new et(new Array(0),k,0,x,A)}(),$=!0),B.l_desc=new Y(B.dyn_ltree,U),B.d_desc=new Y(B.dyn_dtree,H),B.bl_desc=new Y(B.bl_tree,W),B.bi_buf=0,B.bi_valid=0,kt(B)},i._tr_stored_block=Z,i._tr_flush_block=function(B,X,ot,lt){var it,_t,xt=0;0<B.level?(B.strm.data_type===2&&(B.strm.data_type=function(gt){var Et,Wt=4093624447;for(Et=0;Et<=31;Et++,Wt>>>=1)if(1&Wt&&gt.dyn_ltree[2*Et]!==0)return o;if(gt.dyn_ltree[18]!==0||gt.dyn_ltree[20]!==0||gt.dyn_ltree[26]!==0)return l;for(Et=32;Et<p;Et++)if(gt.dyn_ltree[2*Et]!==0)return l;return o}(B)),ft(B,B.l_desc),ft(B,B.d_desc),xt=function(gt){var Et;for(M(gt,gt.dyn_ltree,gt.l_desc.max_code),M(gt,gt.dyn_dtree,gt.d_desc.max_code),ft(gt,gt.bl_desc),Et=x-1;3<=Et&&gt.bl_tree[2*I[Et]+1]===0;Et--);return gt.opt_len+=3*(Et+1)+5+5+4,Et}(B),it=B.opt_len+3+7>>>3,(_t=B.static_len+3+7>>>3)<=it&&(it=_t)):it=_t=ot+5,ot+4<=it&&X!==-1?Z(B,X,ot,lt):B.strategy===4||_t===it?(ct(B,2+(lt?1:0),3),ht(B,F,S)):(ct(B,4+(lt?1:0),3),function(gt,Et,Wt,Tt){var $t;for(ct(gt,Et-257,5),ct(gt,Wt-1,5),ct(gt,Tt-4,4),$t=0;$t<Tt;$t++)ct(gt,gt.bl_tree[2*I[$t]+1],3);tt(gt,gt.dyn_ltree,Et-1),tt(gt,gt.dyn_dtree,Wt-1)}(B,B.l_desc.max_code+1,B.d_desc.max_code+1,xt+1),ht(B,B.dyn_ltree,B.dyn_dtree)),kt(B),lt&&It(B)},i._tr_tally=function(B,X,ot){return B.pending_buf[B.d_buf+2*B.last_lit]=X>>>8&255,B.pending_buf[B.d_buf+2*B.last_lit+1]=255&X,B.pending_buf[B.l_buf+B.last_lit]=255&ot,B.last_lit++,X===0?B.dyn_ltree[2*ot]++:(B.matches++,X--,B.dyn_ltree[2*(v[ot]+p+1)]++,B.dyn_dtree[2*Q(X)]++),B.last_lit===B.lit_bufsize-1},i._tr_align=function(B){ct(B,2,3),rt(B,N,F),function(X){X.bi_valid===16?(pt(X,X.bi_buf),X.bi_buf=0,X.bi_valid=0):8<=X.bi_valid&&(X.pending_buf[X.pending++]=255&X.bi_buf,X.bi_buf>>=8,X.bi_valid-=8)}(B)}},{"../utils/common":41}],53:[function(e,r,i){r.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(e,r,i){(function(s){(function(o,l){if(!o.setImmediate){var u,f,d,p,g=1,m={},x=!1,y=o.document,b=Object.getPrototypeOf&&Object.getPrototypeOf(o);b=b&&b.setTimeout?b:o,u={}.toString.call(o.process)==="[object process]"?function(G){process.nextTick(function(){A(G)})}:function(){if(o.postMessage&&!o.importScripts){var G=!0,z=o.onmessage;return o.onmessage=function(){G=!1},o.postMessage("","*"),o.onmessage=z,G}}()?(p="setImmediate$"+Math.random()+"$",o.addEventListener?o.addEventListener("message",N,!1):o.attachEvent("onmessage",N),function(G){o.postMessage(p+G,"*")}):o.MessageChannel?((d=new MessageChannel).port1.onmessage=function(G){A(G.data)},function(G){d.port2.postMessage(G)}):y&&"onreadystatechange"in y.createElement("script")?(f=y.documentElement,function(G){var z=y.createElement("script");z.onreadystatechange=function(){A(G),z.onreadystatechange=null,f.removeChild(z),z=null},f.appendChild(z)}):function(G){setTimeout(A,0,G)},b.setImmediate=function(G){typeof G!="function"&&(G=new Function(""+G));for(var z=new Array(arguments.length-1),K=0;K<z.length;K++)z[K]=arguments[K+1];var q={callback:G,args:z};return m[g]=q,u(g),g++},b.clearImmediate=P}function P(G){delete m[G]}function A(G){if(x)setTimeout(A,0,G);else{var z=m[G];if(z){x=!0;try{(function(K){var q=K.callback,T=K.args;switch(T.length){case 0:q();break;case 1:q(T[0]);break;case 2:q(T[0],T[1]);break;case 3:q(T[0],T[1],T[2]);break;default:q.apply(l,T)}})(z)}finally{P(G),x=!1}}}}function N(G){G.source===o&&typeof G.data=="string"&&G.data.indexOf(p)===0&&A(+G.data.slice(p.length))}})(typeof self>"u"?s===void 0?this:s:self)}).call(this,typeof An<"u"?An:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})}(sh)),sh.exports}var lp=hp();const up=yl(lp);var Ns={exports:{}};/**
 * @license
 * lodash (Custom Build) <https://lodash.com/>
 * Build: `lodash exports="node" include="clone,merge,isEmpty,isArray,compact,each" -d`
 * Copyright jQuery Foundation and other contributors <https://jquery.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */var cp=Ns.exports,ru;function fp(){return ru||(ru=1,function(h,t){(function(){var e,r="4.15.0",i=200,s="Expected a function",o="__lodash_hash_undefined__",l=1,u=2,f=9007199254740991,d="[object Arguments]",p="[object Array]",g="[object Boolean]",m="[object Date]",x="[object Error]",y="[object Function]",b="[object GeneratorFunction]",P="[object Map]",A="[object Number]",N="[object Object]",G="[object Promise]",z="[object RegExp]",K="[object Set]",q="[object String]",T="[object Symbol]",k="[object WeakMap]",I="[object ArrayBuffer]",F="[object DataView]",S="[object Float32Array]",O="[object Float64Array]",v="[object Int8Array]",C="[object Int16Array]",U="[object Int32Array]",H="[object Uint8Array]",W="[object Uint8ClampedArray]",V="[object Uint16Array]",et="[object Uint32Array]",Y=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Q=/^\w*$/,pt=/^\./,ct=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,rt=/[\\^$.*+?()[\]{}|]/g,mt=/\\(\\)?/g,St=/\w*$/,kt=/^\[object .+?Constructor\]$/,It=/^(?:0|[1-9]\d*)$/,wt={};wt[S]=wt[O]=wt[v]=wt[C]=wt[U]=wt[H]=wt[W]=wt[V]=wt[et]=!0,wt[d]=wt[p]=wt[I]=wt[g]=wt[F]=wt[m]=wt[x]=wt[y]=wt[P]=wt[A]=wt[N]=wt[z]=wt[K]=wt[q]=wt[k]=!1;var vt={};vt[d]=vt[p]=vt[I]=vt[F]=vt[g]=vt[m]=vt[S]=vt[O]=vt[v]=vt[C]=vt[U]=vt[P]=vt[A]=vt[N]=vt[z]=vt[K]=vt[q]=vt[T]=vt[H]=vt[W]=vt[V]=vt[et]=!0,vt[x]=vt[y]=vt[k]=!1;var ht=typeof An=="object"&&An&&An.Object===Object&&An,ft=typeof self=="object"&&self&&self.Object===Object&&self,M=ht||ft||Function("return this")(),tt=t&&!t.nodeType&&t,$=tt&&!0&&h&&!h.nodeType&&h,Z=$&&$.exports===tt,B=Z&&ht.process,X=function(){try{return B&&B.binding("util")}catch{}}(),ot=X&&X.isTypedArray;function lt(w,D){return w.set(D[0],D[1]),w}function it(w,D){return w.add(D),w}function _t(w,D,j){switch(j.length){case 0:return w.call(D);case 1:return w.call(D,j[0]);case 2:return w.call(D,j[0],j[1]);case 3:return w.call(D,j[0],j[1],j[2])}return w.apply(D,j)}function xt(w,D){for(var j=-1,at=w?w.length:0;++j<at&&D(w[j],j,w)!==!1;);return w}function gt(w,D){for(var j=-1,at=D.length,bt=w.length;++j<at;)w[bt+j]=D[j];return w}function Et(w,D,j,at){for(var bt=-1,yt=w?w.length:0;++bt<yt;)j=D(j,w[bt],bt,w);return j}function Wt(w,D){for(var j=-1,at=w?w.length:0;++j<at;)if(D(w[j],j,w))return!0;return!1}function Tt(w){return function(D){return D==null?e:D[w]}}function $t(w,D){for(var j=-1,at=Array(w);++j<w;)at[j]=D(j);return at}function fe(w){return function(D){return w(D)}}function se(w,D){return w==null?e:w[D]}function ye(w){var D=!1;if(w!=null&&typeof w.toString!="function")try{D=!!(w+"")}catch{}return D}function Jt(w){var D=-1,j=Array(w.size);return w.forEach(function(at,bt){j[++D]=[bt,at]}),j}function ve(w,D){return function(j){return w(D(j))}}function oe(w){var D=-1,j=Array(w.size);return w.forEach(function(at){j[++D]=at}),j}var xe=Array.prototype,Fe=Function.prototype,ii=Object.prototype,ni=M["__core-js_shared__"],yi=function(){var w=/[^.]+$/.exec(ni&&ni.keys&&ni.keys.IE_PROTO||"");return w?"Symbol(src)_1."+w:""}(),je=Fe.toString,ie=ii.hasOwnProperty,Ii=je.call(Object),ri=ii.toString,os=RegExp("^"+je.call(ie).replace(rt,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),so=Z?M.Buffer:e,oo=M.Symbol,fr=M.Uint8Array,dr=ve(Object.getPrototypeOf,Object),Za=Object.create,ao=ii.propertyIsEnumerable,Ga=xe.splice,ho=Object.getOwnPropertySymbols,si=so?so.isBuffer:e,At=ve(Object.keys,Object),as=Math.max,pr=Xi(M,"DataView"),fn=Xi(M,"Map"),mr=Xi(M,"Promise"),Nn=Xi(M,"Set"),_r=Xi(M,"WeakMap"),oi=Xi(Object,"create"),lo=!ao.call({valueOf:1},"valueOf"),Ha=$i(pr),Wa=$i(fn),Va=$i(mr),qa=$i(Nn),uo=$i(_r),gr=oo?oo.prototype:e,Oi=gr?gr.valueOf:e,co=gr?gr.toString:e;function Zt(){}function Vi(w){var D=-1,j=w?w.length:0;for(this.clear();++D<j;){var at=w[D];this.set(at[0],at[1])}}function Ya(){this.__data__=oi?oi(null):{}}function ja(w){return this.has(w)&&delete this.__data__[w]}function hs(w){var D=this.__data__;if(oi){var j=D[w];return j===o?e:j}return ie.call(D,w)?D[w]:e}function Fn(w){var D=this.__data__;return oi?D[w]!==e:ie.call(D,w)}function fo(w,D){var j=this.__data__;return j[w]=oi&&D===e?o:D,this}Vi.prototype.clear=Ya,Vi.prototype.delete=ja,Vi.prototype.get=hs,Vi.prototype.has=Fn,Vi.prototype.set=fo;function ai(w){var D=-1,j=w?w.length:0;for(this.clear();++D<j;){var at=w[D];this.set(at[0],at[1])}}function Un(){this.__data__=[]}function jt(w){var D=this.__data__,j=Yi(D,w);if(j<0)return!1;var at=D.length-1;return j==at?D.pop():Ga.call(D,j,1),!0}function re(w){var D=this.__data__,j=Yi(D,w);return j<0?e:D[j][1]}function yr(w){return Yi(this.__data__,w)>-1}function dn(w,D){var j=this.__data__,at=Yi(j,w);return at<0?j.push([w,D]):j[at][1]=D,this}ai.prototype.clear=Un,ai.prototype.delete=jt,ai.prototype.get=re,ai.prototype.has=yr,ai.prototype.set=dn;function Ae(w){var D=-1,j=w?w.length:0;for(this.clear();++D<j;){var at=w[D];this.set(at[0],at[1])}}function ls(){this.__data__={hash:new Vi,map:new(fn||ai),string:new Vi}}function Ft(w){return Lr(this,w).delete(w)}function ae(w){return Lr(this,w).get(w)}function us(w){return Lr(this,w).has(w)}function vr(w,D){return Lr(this,w).set(w,D),this}Ae.prototype.clear=ls,Ae.prototype.delete=Ft,Ae.prototype.get=ae,Ae.prototype.has=us,Ae.prototype.set=vr;function Se(w){var D=-1,j=w?w.length:0;for(this.__data__=new Ae;++D<j;)this.add(w[D])}function Xa(w){return this.__data__.set(w,o),this}function xr(w){return this.__data__.has(w)}Se.prototype.add=Se.prototype.push=Xa,Se.prototype.has=xr;function we(w){this.__data__=new ai(w)}function ce(){this.__data__=new ai}function qi(w){return this.__data__.delete(w)}function Zn(w){return this.__data__.get(w)}function Gn(w){return this.__data__.has(w)}function cs(w,D){var j=this.__data__;if(j instanceof ai){var at=j.__data__;if(!fn||at.length<i-1)return at.push([w,D]),this;j=this.__data__=new Ae(at)}return j.set(w,D),this}we.prototype.clear=ce,we.prototype.delete=qi,we.prototype.get=Zn,we.prototype.has=Gn,we.prototype.set=cs;function pn(w,D){var j=ke(w)||Ce(w)?$t(w.length,String):[],at=j.length,bt=!!at;for(var yt in w)(D||ie.call(w,yt))&&!(bt&&(yt=="length"||_n(yt,at)))&&j.push(yt);return j}function Hn(w,D,j){(j!==e&&!yn(w[D],j)||typeof D=="number"&&j===e&&!(D in w))&&(w[D]=j)}function wr(w,D,j){var at=w[D];(!(ie.call(w,D)&&yn(at,j))||j===e&&!(D in w))&&(w[D]=j)}function Yi(w,D){for(var j=w.length;j--;)if(yn(w[j][0],D))return j;return-1}function fs(w,D){return w&&vs(D,Me(D),w)}function Ri(w,D,j,at,bt,yt,Lt){var Ct;if(at&&(Ct=yt?at(w,bt,yt,Lt):at(w)),Ct!==e)return Ct;if(!pe(w))return w;var Dt=ke(w);if(Dt){if(Ct=nh(w),!D)return Lo(w,Ct)}else{var Qt=ui(w),Ut=Qt==y||Qt==b;if(Ki(w))return Ka(w,D);if(Qt==N||Qt==d||Ut&&!yt){if(ye(w))return yt?w:{};if(Ct=ko(Ut?{}:w),!D)return xs(w,fs(Ct,w))}else{if(!vt[Qt])return yt?w:{};Ct=Ao(w,Qt,Ri,D)}}Lt||(Lt=new we);var te=Lt.get(w);if(te)return te;if(Lt.set(w,Ct),!Dt)var me=j?Eo(w):Me(w);return xt(me||w,function(de,Le){me&&(Le=de,de=w[Le]),wr(Ct,Le,Ri(de,D,j,at,Le,w,Lt))}),Ct}function br(w){return pe(w)?Za(w):{}}var po=li(Ja),ds=ih();function Ja(w,D){return w&&ds(w,D,Me)}function Rt(w,D){D=Mr(D,w)?[D]:Vt(D);for(var j=0,at=D.length;w!=null&&j<at;)w=w[Er(D[j++])];return j&&j==at?w:e}function hi(w,D,j){var at=D(w);return ke(w)?at:gt(at,j(w))}function Kt(w){return ri.call(w)}function mo(w,D){return w!=null&&D in Object(w)}function Wn(w,D,j,at,bt){return w===D?!0:w==null||D==null||!pe(w)&&!vi(D)?w!==w&&D!==D:ps(w,D,Wn,j,at,bt)}function ps(w,D,j,at,bt,yt){var Lt=ke(w),Ct=ke(D),Dt=p,Qt=p;Lt||(Dt=ui(w),Dt=Dt==d?N:Dt),Ct||(Qt=ui(D),Qt=Qt==d?N:Qt);var Ut=Dt==N&&!ye(w),te=Qt==N&&!ye(D),me=Dt==Qt;if(me&&!Ut)return yt||(yt=new we),Lt||Sr(w)?ws(w,D,j,at,bt,yt):Bi(w,D,Dt,j,at,bt,yt);if(!(bt&u)){var de=Ut&&ie.call(w,"__wrapped__"),Le=te&&ie.call(D,"__wrapped__");if(de||Le){var xi=de?w.value():w,wi=Le?D.value():D;return yt||(yt=new we),j(xi,wi,at,bt,yt)}}return me?(yt||(yt=new we),Mo(w,D,j,at,bt,yt)):!1}function ms(w,D,j,at){var bt=j.length,yt=bt;if(w==null)return!yt;for(w=Object(w);bt--;){var Lt=j[bt];if(Lt[2]?Lt[1]!==w[Lt[0]]:!(Lt[0]in w))return!1}for(;++bt<yt;){Lt=j[bt];var Ct=Lt[0],Dt=w[Ct],Qt=Lt[1];if(Lt[2]){if(Dt===e&&!(Ct in w))return!1}else{var Ut=new we,te;if(!(te===e?Wn(Qt,Dt,at,l|u,Ut):te))return!1}}return!0}function ji(w){if(!pe(w)||Ue(w))return!1;var D=Qi(w)||ye(w)?os:kt;return D.test($i(w))}function _s(w){return vi(w)&&Tr(w.length)&&!!wt[ri.call(w)]}function mn(w){return typeof w=="function"?w:w==null?kr:typeof w=="object"?ke(w)?go(w[0],w[1]):_o(w):Ar(w)}function be(w){if(!Yn(w))return At(w);var D=[];for(var j in Object(w))ie.call(w,j)&&j!="constructor"&&D.push(j);return D}function Di(w){if(!pe(w))return Es(w);var D=Yn(w),j=[];for(var at in w)at=="constructor"&&(D||!ie.call(w,at))||j.push(at);return j}function _o(w){var D=To(w);return D.length==1&&D[0][2]?Po(D[0][0],D[0][1]):function(j){return j===w||ms(j,w,D)}}function go(w,D){return Mr(w)&&Ms(D)?Po(Er(w),D):function(j){var at=tn(j,w);return at===e&&at===D?Do(j,w):Wn(D,at,e,l|u)}}function yo(w,D,j,at,bt){if(w!==D){if(!(ke(D)||Sr(D)))var yt=Di(D);xt(yt||D,function(Lt,Ct){if(yt&&(Ct=Lt,Lt=D[Ct]),pe(Lt))bt||(bt=new we),vo(w,D,Ct,j,yo,at,bt);else{var Dt=at?at(w[Ct],Lt,Ct+"",w,D,bt):e;Dt===e&&(Dt=Lt),Hn(w,Ct,Dt)}})}}function vo(w,D,j,at,bt,yt,Lt){var Ct=w[j],Dt=D[j],Qt=Lt.get(Dt);if(Qt){Hn(w,j,Qt);return}var Ut=yt?yt(Ct,Dt,j+"",w,D,Lt):e,te=Ut===e;te&&(Ut=Dt,ke(Dt)||Sr(Dt)?ke(Ct)?Ut=Ct:Ss(Ct)?Ut=Lo(Ct):(te=!1,Ut=Ri(Dt,!0)):Oo(Dt)||Ce(Dt)?Ce(Ct)?Ut=ci(Ct):!pe(Ct)||at&&Qi(Ct)?(te=!1,Ut=Ri(Dt,!0)):Ut=Ct:te=!1),te&&(Lt.set(Dt,Ut),bt(Ut,Dt,at,yt,Lt),Lt.delete(Dt)),Hn(w,j,Ut)}function gs(w){return function(D){return Rt(D,w)}}function $a(w,D){return D=as(D===e?w.length-1:D,0),function(){for(var j=arguments,at=-1,bt=as(j.length-D,0),yt=Array(bt);++at<bt;)yt[at]=j[D+at];at=-1;for(var Lt=Array(D+1);++at<D;)Lt[at]=j[at];return Lt[D]=yt,_t(w,this,Lt)}}function xo(w){if(typeof w=="string")return w;if(vn(w))return co?co.call(w):"";var D=w+"";return D=="0"&&1/w==-1/0?"-0":D}function Vt(w){return ke(w)?w:Ts(w)}function Ka(w,D){if(D)return w.slice();var j=new w.constructor(w.length);return w.copy(j),j}function Re(w){var D=new w.constructor(w.byteLength);return new fr(D).set(new fr(w)),D}function Vn(w,D){var j=D?Re(w.buffer):w.buffer;return new w.constructor(j,w.byteOffset,w.byteLength)}function wo(w,D,j){var at=D?j(Jt(w),!0):Jt(w);return Et(at,lt,new w.constructor)}function Qa(w){var D=new w.constructor(w.source,St.exec(w));return D.lastIndex=w.lastIndex,D}function ys(w,D,j){var at=D?j(oe(w),!0):oe(w);return Et(at,it,new w.constructor)}function th(w){return Oi?Object(Oi.call(w)):{}}function bo(w,D){var j=D?Re(w.buffer):w.buffer;return new w.constructor(j,w.byteOffset,w.length)}function Lo(w,D){var j=-1,at=w.length;for(D||(D=Array(at));++j<at;)D[j]=w[j];return D}function vs(w,D,j,at){j||(j={});for(var bt=-1,yt=D.length;++bt<yt;){var Lt=D[bt],Ct=e;wr(j,Lt,Ct===e?w[Lt]:Ct)}return j}function xs(w,D){return vs(w,So(w),D)}function eh(w){return $a(function(D,j){var at=-1,bt=j.length,yt=bt>1?j[bt-1]:e,Lt=bt>2?j[2]:e;for(yt=w.length>3&&typeof yt=="function"?(bt--,yt):e,Lt&&Ji(j[0],j[1],Lt)&&(yt=bt<3?e:yt,bt=1),D=Object(D);++at<bt;){var Ct=j[at];Ct&&w(D,Ct,at,yt)}return D})}function li(w,D){return function(j,at){if(j==null)return j;if(!Ze(j))return w(j,at);for(var bt=j.length,yt=-1,Lt=Object(j);++yt<bt&&at(Lt[yt],yt,Lt)!==!1;);return j}}function ih(w){return function(D,j,at){for(var bt=-1,yt=Object(D),Lt=at(D),Ct=Lt.length;Ct--;){var Dt=Lt[++bt];if(j(yt[Dt],Dt,yt)===!1)break}return D}}function ws(w,D,j,at,bt,yt){var Lt=bt&u,Ct=w.length,Dt=D.length;if(Ct!=Dt&&!(Lt&&Dt>Ct))return!1;var Qt=yt.get(w);if(Qt&&yt.get(D))return Qt==D;var Ut=-1,te=!0,me=bt&l?new Se:e;for(yt.set(w,D),yt.set(D,w);++Ut<Ct;){var de=w[Ut],Le=D[Ut];if(at)var xi=Lt?at(Le,de,Ut,D,w,yt):at(de,Le,Ut,w,D,yt);if(xi!==e){if(xi)continue;te=!1;break}if(me){if(!Wt(D,function(wi,Xe){if(!me.has(Xe)&&(de===wi||j(de,wi,at,bt,yt)))return me.add(Xe)})){te=!1;break}}else if(!(de===Le||j(de,Le,at,bt,yt))){te=!1;break}}return yt.delete(w),yt.delete(D),te}function Bi(w,D,j,at,bt,yt,Lt){switch(j){case F:if(w.byteLength!=D.byteLength||w.byteOffset!=D.byteOffset)return!1;w=w.buffer,D=D.buffer;case I:return!(w.byteLength!=D.byteLength||!at(new fr(w),new fr(D)));case g:case m:case A:return yn(+w,+D);case x:return w.name==D.name&&w.message==D.message;case z:case q:return w==D+"";case P:var Ct=Jt;case K:var Dt=yt&u;if(Ct||(Ct=oe),w.size!=D.size&&!Dt)return!1;var Qt=Lt.get(w);if(Qt)return Qt==D;yt|=l,Lt.set(w,D);var Ut=ws(Ct(w),Ct(D),at,bt,yt,Lt);return Lt.delete(w),Ut;case T:if(Oi)return Oi.call(w)==Oi.call(D)}return!1}function Mo(w,D,j,at,bt,yt){var Lt=bt&u,Ct=Me(w),Dt=Ct.length,Qt=Me(D),Ut=Qt.length;if(Dt!=Ut&&!Lt)return!1;for(var te=Dt;te--;){var me=Ct[te];if(!(Lt?me in D:ie.call(D,me)))return!1}var de=yt.get(w);if(de&&yt.get(D))return de==D;var Le=!0;yt.set(w,D),yt.set(D,w);for(var xi=Lt;++te<Dt;){me=Ct[te];var wi=w[me],Xe=D[me];if(at)var No=Lt?at(Xe,wi,me,D,w,yt):at(wi,Xe,me,w,D,yt);if(!(No===e?wi===Xe||j(wi,Xe,at,bt,yt):No)){Le=!1;break}xi||(xi=me=="constructor")}if(Le&&!xi){var bi=w.constructor,Jn=D.constructor;bi!=Jn&&"constructor"in w&&"constructor"in D&&!(typeof bi=="function"&&bi instanceof bi&&typeof Jn=="function"&&Jn instanceof Jn)&&(Le=!1)}return yt.delete(w),yt.delete(D),Le}function Eo(w){return hi(w,Me,So)}function bs(){var w=Zt.iteratee||xn;return w=w===xn?mn:w,arguments.length?w(arguments[0],arguments[1]):w}function Lr(w,D){var j=w.__data__;return qn(D)?j[typeof D=="string"?"string":"hash"]:j.map}function To(w){for(var D=Me(w),j=D.length;j--;){var at=D[j],bt=w[at];D[j]=[at,bt,Ms(bt)]}return D}function Xi(w,D){var j=se(w,D);return ji(j)?j:e}var So=ho?ve(ho,Object):Xn,ui=Kt;(pr&&ui(new pr(new ArrayBuffer(1)))!=F||fn&&ui(new fn)!=P||mr&&ui(mr.resolve())!=G||Nn&&ui(new Nn)!=K||_r&&ui(new _r)!=k)&&(ui=function(w){var D=ri.call(w),j=D==N?w.constructor:e,at=j?$i(j):e;if(at)switch(at){case Ha:return F;case Wa:return P;case Va:return G;case qa:return K;case uo:return k}return D});function Ls(w,D,j){D=Mr(D,w)?[D]:Vt(D);for(var at,bt=-1,Lt=D.length;++bt<Lt;){var yt=Er(D[bt]);if(!(at=w!=null&&j(w,yt)))break;w=w[yt]}if(at)return at;var Lt=w?w.length:0;return!!Lt&&Tr(Lt)&&_n(yt,Lt)&&(ke(w)||Ce(w))}function nh(w){var D=w.length,j=w.constructor(D);return D&&typeof w[0]=="string"&&ie.call(w,"index")&&(j.index=w.index,j.input=w.input),j}function ko(w){return typeof w.constructor=="function"&&!Yn(w)?br(dr(w)):{}}function Ao(w,D,j,at){var bt=w.constructor;switch(D){case I:return Re(w);case g:case m:return new bt(+w);case F:return Vn(w,at);case S:case O:case v:case C:case U:case H:case W:case V:case et:return bo(w,at);case P:return wo(w,at,j);case A:case q:return new bt(w);case z:return Qa(w);case K:return ys(w,at,j);case T:return th(w)}}function _n(w,D){return D=D??f,!!D&&(typeof w=="number"||It.test(w))&&w>-1&&w%1==0&&w<D}function Ji(w,D,j){if(!pe(j))return!1;var at=typeof D;return(at=="number"?Ze(j)&&_n(D,j.length):at=="string"&&D in j)?yn(j[D],w):!1}function Mr(w,D){if(ke(w))return!1;var j=typeof w;return j=="number"||j=="symbol"||j=="boolean"||w==null||vn(w)?!0:Q.test(w)||!Y.test(w)||D!=null&&w in Object(D)}function qn(w){var D=typeof w;return D=="string"||D=="number"||D=="symbol"||D=="boolean"?w!=="__proto__":w===null}function Ue(w){return!!yi&&yi in w}function Yn(w){var D=w&&w.constructor,j=typeof D=="function"&&D.prototype||ii;return w===j}function Ms(w){return w===w&&!pe(w)}function Po(w,D){return function(j){return j==null?!1:j[w]===D&&(D!==e||w in Object(j))}}function Es(w){var D=[];if(w!=null)for(var j in Object(w))D.push(j);return D}var Ts=Pe(function(w){w=Ro(w);var D=[];return pt.test(w)&&D.push(""),w.replace(ct,function(j,at,bt,yt){D.push(bt?yt.replace(mt,"$1"):at||j)}),D});function Er(w){if(typeof w=="string"||vn(w))return w;var D=w+"";return D=="0"&&1/w==-1/0?"-0":D}function $i(w){if(w!=null){try{return je.call(w)}catch{}try{return w+""}catch{}}return""}function Co(w){for(var D=-1,j=w?w.length:0,at=0,bt=[];++D<j;){var yt=w[D];yt&&(bt[at++]=yt)}return bt}function zo(w,D){var j=ke(w)?xt:po;return j(w,bs(D,3))}function Pe(w,D){if(typeof w!="function"||D&&typeof D!="function")throw new TypeError(s);var j=function(){var at=arguments,bt=D?D.apply(this,at):at[0],yt=j.cache;if(yt.has(bt))return yt.get(bt);var Lt=w.apply(this,at);return j.cache=yt.set(bt,Lt),Lt};return j.cache=new(Pe.Cache||Ae),j}Pe.Cache=Ae;function gn(w){return Ri(w,!1,!0)}function yn(w,D){return w===D||w!==w&&D!==D}function Ce(w){return Ss(w)&&ie.call(w,"callee")&&(!ao.call(w,"callee")||ri.call(w)==d)}var ke=Array.isArray;function Ze(w){return w!=null&&Tr(w.length)&&!Qi(w)}function Ss(w){return vi(w)&&Ze(w)}var Ki=si||en;function Io(w){if(Ze(w)&&(ke(w)||typeof w=="string"||typeof w.splice=="function"||Ki(w)||Ce(w)))return!w.length;var D=ui(w);if(D==P||D==K)return!w.size;if(lo||Yn(w))return!At(w).length;for(var j in w)if(ie.call(w,j))return!1;return!0}function Qi(w){var D=pe(w)?ri.call(w):"";return D==y||D==b}function Tr(w){return typeof w=="number"&&w>-1&&w%1==0&&w<=f}function pe(w){var D=typeof w;return!!w&&(D=="object"||D=="function")}function vi(w){return!!w&&typeof w=="object"}function Oo(w){if(!vi(w)||ri.call(w)!=N||ye(w))return!1;var D=dr(w);if(D===null)return!0;var j=ie.call(D,"constructor")&&D.constructor;return typeof j=="function"&&j instanceof j&&je.call(j)==Ii}function vn(w){return typeof w=="symbol"||vi(w)&&ri.call(w)==T}var Sr=ot?fe(ot):_s;function ci(w){return vs(w,jn(w))}function Ro(w){return w==null?"":xo(w)}function tn(w,D,j){var at=w==null?e:Rt(w,D);return at===e?j:at}function Do(w,D){return w!=null&&Ls(w,D,mo)}function Me(w){return Ze(w)?pn(w):be(w)}function jn(w){return Ze(w)?pn(w,!0):Di(w)}var Bo=eh(function(w,D,j){yo(w,D,j)});function kr(w){return w}function xn(w){return mn(typeof w=="function"?w:Ri(w,!0))}function Ar(w){return Mr(w)?Tt(Er(w)):gs(w)}function Xn(){return[]}function en(){return!1}Zt.compact=Co,Zt.iteratee=xn,Zt.keys=Me,Zt.keysIn=jn,Zt.memoize=Pe,Zt.merge=Bo,Zt.property=Ar,Zt.toPlainObject=ci,Zt.clone=gn,Zt.eq=yn,Zt.forEach=zo,Zt.get=tn,Zt.hasIn=Do,Zt.identity=kr,Zt.isArguments=Ce,Zt.isArray=ke,Zt.isArrayLike=Ze,Zt.isArrayLikeObject=Ss,Zt.isBuffer=Ki,Zt.isEmpty=Io,Zt.isFunction=Qi,Zt.isLength=Tr,Zt.isObject=pe,Zt.isObjectLike=vi,Zt.isPlainObject=Oo,Zt.isSymbol=vn,Zt.isTypedArray=Sr,Zt.stubArray=Xn,Zt.stubFalse=en,Zt.toString=Ro,Zt.each=zo,Zt.VERSION=r,$&&(($.exports=Zt)._=Zt,tt._=Zt)}).call(cp)}(Ns,Ns.exports)),Ns.exports}var oh,su;function dp(){if(su)return oh;su=1,oh=h;function h(r,i){var s=r&&r.type,o;if(s==="FeatureCollection")for(o=0;o<r.features.length;o++)h(r.features[o],i);else if(s==="GeometryCollection")for(o=0;o<r.geometries.length;o++)h(r.geometries[o],i);else if(s==="Feature")h(r.geometry,i);else if(s==="Polygon")t(r.coordinates,i);else if(s==="MultiPolygon")for(o=0;o<r.coordinates.length;o++)t(r.coordinates[o],i);return r}function t(r,i){if(r.length!==0){e(r[0],i);for(var s=1;s<r.length;s++)e(r[s],!i)}}function e(r,i){for(var s=0,o=0,l=0,u=r.length,f=u-1;l<u;f=l++){var d=(r[l][0]-r[f][0])*(r[f][1]+r[l][1]),p=s+d;o+=Math.abs(s)>=Math.abs(d)?s-p+d:d-p+s,s=p}s+o>=0!=!!i&&r.reverse()}return oh}const pp=[{key:"building",polygon:"all"},{key:"highway",polygon:"whitelist",values:["services","rest_area","escape","elevator"]},{key:"natural",polygon:"blacklist",values:["coastline","cliff","ridge","arete","tree_row"]},{key:"landuse",polygon:"all"},{key:"waterway",polygon:"whitelist",values:["riverbank","dock","boatyard","dam"]},{key:"amenity",polygon:"all"},{key:"leisure",polygon:"all"},{key:"barrier",polygon:"whitelist",values:["city_wall","ditch","hedge","retaining_wall","wall","spikes"]},{key:"railway",polygon:"whitelist",values:["station","turntable","roundhouse","platform"]},{key:"area",polygon:"all"},{key:"boundary",polygon:"all"},{key:"man_made",polygon:"blacklist",values:["cutline","embankment","pipeline"]},{key:"power",polygon:"whitelist",values:["plant","substation","generator","transformer"]},{key:"place",polygon:"all"},{key:"shop",polygon:"all"},{key:"aeroway",polygon:"blacklist",values:["taxiway"]},{key:"tourism",polygon:"all"},{key:"historic",polygon:"all"},{key:"public_transport",polygon:"all"},{key:"office",polygon:"all"},{key:"building:part",polygon:"all"},{key:"military",polygon:"all"},{key:"ruins",polygon:"all"},{key:"area:highway",polygon:"all"},{key:"craft",polygon:"all"},{key:"golf",polygon:"all"},{key:"indoor",polygon:"all"}];var ah,ou;function mp(){return ou||(ou=1,ah=pp),ah}var hh,au;function _p(){if(au)return hh;au=1;var h=fp(),t=dp(),e={};mp().forEach(function(o){if(o.polygon==="all")e[o.key]=!0;else{var l=o.polygon==="whitelist"?"included_values":"excluded_values",u={};o.values.forEach(function(f){u[f]=!0}),e[o.key]={},e[o.key][l]=u}});function r(o,l){return(o.version||l.version)&&o.version!==l.version?(+o.version||0)>(+l.version||0)?o:l:h.merge(o,l)}var i={};i=function(o,l,u){l=h.merge({verbose:!1,flatProperties:!0,uninterestingTags:{source:!0,source_ref:!0,"source:ref":!0,history:!0,attribution:!0,created_by:!0,"tiger:county":!0,"tiger:tlid":!0,"tiger:upload_uuid":!0},polygonFeatures:e,deduplicator:r},l);var f;return typeof XMLDocument<"u"&&o instanceof XMLDocument||typeof XMLDocument>"u"&&o.childNodes?f=p(o):f=d(o),f;function d(x){var y=new Array,b=new Array,P=new Array;function A(F){var S=h.clone(F);S.lat=F.center.lat,S.lon=F.center.lon,S.__is_center_placeholder=!0,y.push(S)}function N(F){var S=h.clone(F);S.nodes=[];function O(v,C,U){var H={type:"node",id:"_"+S.type+"/"+S.id+"bounds"+U,lat:v,lon:C};S.nodes.push(H.id),y.push(H)}O(S.bounds.minlat,S.bounds.minlon,1),O(S.bounds.maxlat,S.bounds.minlon,2),O(S.bounds.maxlat,S.bounds.maxlon,3),O(S.bounds.minlat,S.bounds.maxlon,4),S.nodes.push(S.nodes[0]),S.__is_bounds_placeholder=!0,b.push(S)}function G(F){function S(O,v,C){var U={type:"node",id:C,lat:O,lon:v};y.push(U)}h.isArray(F.nodes)||(F.nodes=F.geometry.map(function(O){return O!==null?"_anonymous@"+O.lat+"/"+O.lon:"_anonymous@unknown_location"})),F.geometry.forEach(function(O,v){O&&S(O.lat,O.lon,F.nodes[v])})}function z(F){function S(v,C,U){var H={type:"node",id:U,lat:v,lon:C};y.push(H)}function O(v,C){if(b.some(function(W){return W.type=="way"&&W.id==C}))return;var U={type:"way",id:C,nodes:[]};function H(W,V){var et={type:"node",id:"_anonymous@"+W+"/"+V,lat:W,lon:V};U.nodes.push(et.id),y.push(et)}v.forEach(function(W){W?H(W.lat,W.lon):U.nodes.push(void 0)}),b.push(U)}F.members.forEach(function(v,C){v.type=="node"?v.lat&&S(v.lat,v.lon,v.ref):v.type=="way"&&v.geometry&&(v.ref="_fullGeom"+v.ref,O(v.geometry,v.ref))})}for(var K=0;K<x.elements.length;K++)switch(x.elements[K].type){case"node":var q=x.elements[K];y.push(q);break;case"way":var T=h.clone(x.elements[K]);T.nodes=h.clone(T.nodes),b.push(T),T.center&&A(T),T.geometry?G(T):T.bounds&&N(T);break;case"relation":var k=h.clone(x.elements[K]);k.members=h.clone(k.members),P.push(k);var I=k.members&&k.members.some(function(F){return F.type=="node"&&F.lat||F.type=="way"&&F.geometry&&F.geometry.length>0});k.center&&A(k),I?z(k):k.bounds&&N(k);break}return g(y,b,P)}function p(x){var y=new Array,b=new Array,P=new Array;function A(k,I,F){k.hasAttribute(F)&&(I[F]=k.getAttribute(F))}function N(k,I){var F=h.clone(k);A(I,F,"lat"),A(I,F,"lon"),F.__is_center_placeholder=!0,y.push(F)}function G(k,I){var F=h.clone(k);F.nodes=[];function S(O,v,C){var U={type:"node",id:"_"+F.type+"/"+F.id+"bounds"+C,lat:O,lon:v};F.nodes.push(U.id),y.push(U)}S(I.getAttribute("minlat"),I.getAttribute("minlon"),1),S(I.getAttribute("maxlat"),I.getAttribute("minlon"),2),S(I.getAttribute("maxlat"),I.getAttribute("maxlon"),3),S(I.getAttribute("minlat"),I.getAttribute("maxlon"),4),F.nodes.push(F.nodes[0]),F.__is_bounds_placeholder=!0,b.push(F)}function z(k,I){function F(S,O,v){var C={type:"node",id:v,lat:S,lon:O};return y.push(C),C.id}h.isArray(k.nodes)||(k.nodes=[],h.each(I,function(S,O){k.nodes.push("_anonymous@"+S.getAttribute("lat")+"/"+S.getAttribute("lon"))})),h.each(I,function(S,O){S.getAttribute("lat")&&F(S.getAttribute("lat"),S.getAttribute("lon"),k.nodes[O])})}function K(k,I){function F(O,v,C){var U={type:"node",id:C,lat:O,lon:v};y.push(U)}function S(O,v){if(b.some(function(H){return H.type=="way"&&H.id==v}))return;var C={type:"way",id:v,nodes:[]};function U(H,W){var V={type:"node",id:"_anonymous@"+H+"/"+W,lat:H,lon:W};C.nodes.push(V.id),y.push(V)}h.each(O,function(H){H.getAttribute("lat")?U(H.getAttribute("lat"),H.getAttribute("lon")):C.nodes.push(void 0)}),b.push(C)}h.each(I,function(O,v){k.members[v].type=="node"?O.getAttribute("lat")&&F(O.getAttribute("lat"),O.getAttribute("lon"),k.members[v].ref):k.members[v].type=="way"&&O.getElementsByTagName("nd").length>0&&(k.members[v].ref="_fullGeom"+k.members[v].ref,S(O.getElementsByTagName("nd"),k.members[v].ref))})}h.each(x.getElementsByTagName("node"),function(k,I){var F={};h.each(k.getElementsByTagName("tag"),function(O){F[O.getAttribute("k")]=O.getAttribute("v")});var S={type:"node"};A(k,S,"id"),A(k,S,"lat"),A(k,S,"lon"),A(k,S,"version"),A(k,S,"timestamp"),A(k,S,"changeset"),A(k,S,"uid"),A(k,S,"user"),h.isEmpty(F)||(S.tags=F),y.push(S)});var q,T;return h.each(x.getElementsByTagName("way"),function(k,I){var F={},S=[];h.each(k.getElementsByTagName("tag"),function(C){F[C.getAttribute("k")]=C.getAttribute("v")});var O=!1;h.each(k.getElementsByTagName("nd"),function(C,U){var H;(H=C.getAttribute("ref"))&&(S[U]=H),!O&&C.getAttribute("lat")&&(O=!0)});var v={type:"way"};A(k,v,"id"),A(k,v,"version"),A(k,v,"timestamp"),A(k,v,"changeset"),A(k,v,"uid"),A(k,v,"user"),S.length>0&&(v.nodes=S),h.isEmpty(F)||(v.tags=F),(q=k.getElementsByTagName("center")[0])&&N(v,q),O?z(v,k.getElementsByTagName("nd")):(T=k.getElementsByTagName("bounds")[0])&&G(v,T),b.push(v)}),h.each(x.getElementsByTagName("relation"),function(k,I){var F={},S=[];h.each(k.getElementsByTagName("tag"),function(C){F[C.getAttribute("k")]=C.getAttribute("v")});var O=!1;h.each(k.getElementsByTagName("member"),function(C,U){S[U]={},A(C,S[U],"ref"),A(C,S[U],"role"),A(C,S[U],"type"),(!O&&S[U].type=="node"&&C.getAttribute("lat")||S[U].type=="way"&&C.getElementsByTagName("nd").length>0)&&(O=!0)});var v={type:"relation"};A(k,v,"id"),A(k,v,"version"),A(k,v,"timestamp"),A(k,v,"changeset"),A(k,v,"uid"),A(k,v,"user"),S.length>0&&(v.members=S),h.isEmpty(F)||(v.tags=F),(q=k.getElementsByTagName("center")[0])&&N(v,q),O?K(v,k.getElementsByTagName("member")):(T=k.getElementsByTagName("bounds")[0])&&G(v,T),P.push(v)}),g(y,b,P)}function g(x,y,b){function P(wt,vt){if(typeof vt!="object"&&(vt={}),typeof l.uninterestingTags=="function")return!l.uninterestingTags(wt,vt);for(var ht in wt)if(l.uninterestingTags[ht]!==!0&&!(vt[ht]===!0||vt[ht]===wt[ht]))return!0;return!1}function A(wt){var vt={timestamp:wt.timestamp,version:wt.version,changeset:wt.changeset,user:wt.user,uid:wt.uid};for(var ht in vt)vt[ht]===void 0&&delete vt[ht];return vt}for(var N=new Object,G=new Object,z=0;z<x.length;z++){var K=x[z];N[K.id]!==void 0&&(K=l.deduplicator(K,N[K.id])),N[K.id]=K,typeof K.tags<"u"&&P(K.tags)&&(G[K.id]=!0)}for(var z=0;z<b.length;z++)if(h.isArray(b[z].members))for(var q=0;q<b[z].members.length;q++)b[z].members[q].type=="node"&&(G[b[z].members[q].ref]=!0);for(var T=new Object,k=new Object,z=0;z<y.length;z++){var I=y[z];if(T[I.id]&&(I=l.deduplicator(I,T[I.id])),T[I.id]=I,h.isArray(I.nodes))for(var q=0;q<I.nodes.length;q++)typeof I.nodes[q]!="object"&&(k[I.nodes[q]]=!0,I.nodes[q]=N[I.nodes[q]])}var F=new Array;for(var S in N){var K=N[S];(!k[S]||G[S])&&F.push(K)}for(var O=new Array,z=0;z<b.length;z++){var v=b[z];O[v.id]&&(v=l.deduplicator(v,O[v.id])),O[v.id]=v}var C={node:{},way:{},relation:{}};for(var S in O){var v=O[S];if(!h.isArray(v.members)){l.verbose&&console.warn("Relation",v.type+"/"+v.id,"ignored because it has no members");continue}for(var q=0;q<v.members.length;q++){var U=v.members[q].type,H=v.members[q].ref;if(typeof H!="number"&&(H=H.replace("_fullGeom","")),!C[U]){l.verbose&&console.warn("Relation",v.type+"/"+v.id,"member",U+"/"+H,"ignored because it has an invalid type");continue}typeof C[U][H]>"u"&&(C[U][H]=[]),C[U][H].push({role:v.members[q].role,rel:v.id,reltags:v.tags})}}var W,V=[];for(z=0;z<F.length;z++){if(typeof F[z].lon>"u"||typeof F[z].lat>"u"){l.verbose&&console.warn("POI",F[z].type+"/"+F[z].id,"ignored because it lacks coordinates");continue}var et={type:"Feature",id:F[z].type+"/"+F[z].id,properties:{type:F[z].type,id:F[z].id,tags:F[z].tags||{},relations:C.node[F[z].id]||[],meta:A(F[z])},geometry:{type:"Point",coordinates:[+F[z].lon,+F[z].lat]}};F[z].__is_center_placeholder&&(et.properties.geometry="center"),u?u(et):V.push(et)}for(var Y=[],Q=[],z=0;z<b.length;z++)if(O[b[z].id]===b[z]){if(typeof b[z].tags<"u"&&(b[z].tags.type=="route"||b[z].tags.type=="waterway")){let vt=function(ht){var ft=!1,M;M=ht.members.filter(function(B){return B.type==="way"}),M=M.map(function(B){var X=T[B.ref];if(X===void 0||X.nodes===void 0){l.verbose&&console.warn("Route "+ht.type+"/"+ht.id,"tainted by a missing or incomplete  way",B.type+"/"+B.ref),ft=!0;return}return{id:B.ref,role:B.role,way:X,nodes:X.nodes.filter(function(ot){return ot!==void 0?!0:(ft=!0,l.verbose&&console.warn("Route",ht.type+"/"+ht.id,"tainted by a way",B.type+"/"+B.ref,"with a missing node"),!1)})}}),M=h.compact(M);var tt;tt=s(M);var $=[];if($=h.compact(tt.map(function(B){return h.compact(B.map(function(X){return[+X.lon,+X.lat]}))})),$.length==0)return l.verbose&&console.warn("Route",ht.type+"/"+ht.id,"contains no coordinates"),!1;var Z={type:"Feature",id:ht.type+"/"+ht.id,properties:{type:ht.type,id:ht.id,tags:ht.tags||{},relations:C[ht.type][ht.id]||[],meta:A(ht)},geometry:{type:$.length===1?"LineString":"MultiLineString",coordinates:$.length===1?$[0]:$}};return ft&&(l.verbose&&console.warn("Route",ht.type+"/"+ht.id,"is tainted"),Z.properties.tainted=!0),Z};var kt=vt;if(!h.isArray(b[z].members)){l.verbose&&console.warn("Route",b[z].type+"/"+b[z].id,"ignored because it has no members");continue}if(b[z].members.forEach(function(ht){T[ht.ref]&&!P(T[ht.ref].tags)&&(T[ht.ref].is_skippablerelationmember=!0)}),et=vt(b[z]),et===!1){l.verbose&&console.warn("Route relation",b[z].type+"/"+b[z].id,"ignored because it has invalid geometry");continue}u?u(t(et)):Q.push(et)}if(typeof b[z].tags<"u"&&(b[z].tags.type=="multipolygon"||b[z].tags.type=="boundary")){let ht=function(ft,M){var tt=!1,$=ct?"way":"relation",Z=typeof ft.id=="number"?ft.id:+ft.id.replace("_fullGeom",""),B;B=M.members.filter(function(Tt){return Tt.type==="way"}),B=B.map(function(Tt){var $t=T[Tt.ref];if($t===void 0||$t.nodes===void 0){l.verbose&&console.warn("Multipolygon",$+"/"+Z,"tainted by a missing or incomplete way",Tt.type+"/"+Tt.ref),tt=!0;return}return{id:Tt.ref,role:Tt.role||"outer",way:$t,nodes:$t.nodes.filter(function(fe){return fe!==void 0?!0:(tt=!0,l.verbose&&console.warn("Multipolygon",$+"/"+Z,"tainted by a way",Tt.type+"/"+Tt.ref,"with a missing node"),!1)})}}),B=h.compact(B);var X,ot;X=s(B.filter(function(Tt){return Tt.role==="outer"})),ot=s(B.filter(function(Tt){return Tt.role==="inner"}));var lt;function it(Tt){var $t=function(ve,oe){for(var xe=0;xe<oe.length;xe++)if(se(oe[xe],ve))return!0;return!1},fe=function(ve){return ve.map(function(oe){return[+oe.lat,+oe.lon]})},se=function(ve,oe){for(var xe=ve[0],Fe=ve[1],ii=!1,ni=0,yi=oe.length-1;ni<oe.length;yi=ni++){var je=oe[ni][0],ie=oe[ni][1],Ii=oe[yi][0],ri=oe[yi][1],os=ie>Fe!=ri>Fe&&xe<(Ii-je)*(Fe-ie)/(ri-ie)+je;os&&(ii=!ii)}return ii},ye,Jt;for(Tt=fe(Tt),ye=0;ye<X.length;ye++)if(Jt=fe(X[ye]),$t(Jt,Tt))return ye}lt=X.map(function(Tt){return[Tt]});for(var _t=0;_t<ot.length;_t++){var xt=it(ot[_t]);xt!==void 0?lt[xt].push(ot[_t]):l.verbose&&console.warn("Multipolygon",$+"/"+Z,"contains an inner ring with no containing outer")}var gt=[];if(gt=h.compact(lt.map(function(Tt){var $t=h.compact(Tt.map(function(fe){if(fe.length<4){l.verbose&&console.warn("Multipolygon",$+"/"+Z,"contains a ring with less than four nodes");return}return h.compact(fe.map(function(se){return[+se.lon,+se.lat]}))}));if($t.length==0){l.verbose&&console.warn("Multipolygon",$+"/"+Z,"contains an empty ring cluster");return}return $t})),gt.length==0)return l.verbose&&console.warn("Multipolygon",$+"/"+Z,"contains no coordinates"),!1;var Et="MultiPolygon";gt.length===1&&(Et="Polygon",gt=gt[0]);var Wt={type:"Feature",id:ft.type+"/"+Z,properties:{type:ft.type,id:Z,tags:ft.tags||{},relations:C[ft.type][ft.id]||[],meta:A(ft)},geometry:{type:Et,coordinates:gt}};return tt&&(l.verbose&&console.warn("Multipolygon",$+"/"+Z,"is tainted"),Wt.properties.tainted=!0),Wt};var It=ht;if(!h.isArray(b[z].members)){l.verbose&&console.warn("Multipolygon",b[z].type+"/"+b[z].id,"ignored because it has no members");continue}for(var pt=0,q=0;q<b[z].members.length;q++)b[z].members[q].role=="outer"?pt++:l.verbose&&b[z].members[q].role!="inner"&&console.warn("Multipolygon",b[z].type+"/"+b[z].id,"member",b[z].members[q].type+"/"+b[z].members[q].ref,'ignored because it has an invalid role: "'+b[z].members[q].role+'"');if(b[z].members.forEach(function(ft){T[ft.ref]&&(ft.role==="outer"&&!P(T[ft.ref].tags,b[z].tags)&&(T[ft.ref].is_skippablerelationmember=!0),ft.role==="inner"&&!P(T[ft.ref].tags)&&(T[ft.ref].is_skippablerelationmember=!0))}),pt==0){l.verbose&&console.warn("Multipolygon relation",b[z].type+"/"+b[z].id,"ignored because it has no outer ways");continue}var ct=!1;pt==1&&!P(b[z].tags,{type:!0})&&(ct=!0);var et=null;if(!ct)et=ht(b[z],b[z]);else{var rt=b[z].members.filter(function(ft){return ft.role==="outer"})[0];if(rt=T[rt.ref],rt===void 0){l.verbose&&console.warn("Multipolygon relation",b[z].type+"/"+b[z].id,"ignored because outer way",rt.type+"/"+rt.ref,"is missing");continue}rt.is_skippablerelationmember=!0,et=ht(rt,b[z])}if(et===!1){l.verbose&&console.warn("Multipolygon relation",b[z].type+"/"+b[z].id,"ignored because it has invalid geometry");continue}u?u(t(et)):Q.push(et)}}for(var z=0;z<y.length;z++)if(T[y[z].id]===y[z]){if(!h.isArray(y[z].nodes)){l.verbose&&console.warn("Way",y[z].type+"/"+y[z].id,"ignored because it has no nodes");continue}if(!y[z].is_skippablerelationmember){typeof y[z].id!="number"&&(y[z].id=+y[z].id.replace("_fullGeom","")),y[z].tainted=!1,y[z].hidden=!1;var mt=new Array;for(q=0;q<y[z].nodes.length;q++)typeof y[z].nodes[q]=="object"?mt.push([+y[z].nodes[q].lon,+y[z].nodes[q].lat]):(l.verbose&&console.warn("Way",y[z].type+"/"+y[z].id,"is tainted by an invalid node"),y[z].tainted=!0);if(mt.length<=1){l.verbose&&console.warn("Way",y[z].type+"/"+y[z].id,"ignored because it contains too few nodes");continue}var St="LineString";typeof y[z].nodes[0]<"u"&&typeof y[z].nodes[y[z].nodes.length-1]<"u"&&y[z].nodes[0].id===y[z].nodes[y[z].nodes.length-1].id&&(typeof y[z].tags<"u"&&m(y[z].tags)||y[z].__is_bounds_placeholder)&&(St="Polygon",mt=[mt]);var et={type:"Feature",id:y[z].type+"/"+y[z].id,properties:{type:y[z].type,id:y[z].id,tags:y[z].tags||{},relations:C.way[y[z].id]||[],meta:A(y[z])},geometry:{type:St,coordinates:mt}};y[z].tainted&&(l.verbose&&console.warn("Way",y[z].type+"/"+y[z].id,"is tainted"),et.properties.tainted=!0),y[z].__is_bounds_placeholder&&(et.properties.geometry="bounds"),u?u(t(et)):St=="LineString"?Y.push(et):Q.push(et)}}return u?!0:(W={type:"FeatureCollection",features:[]},W.features=W.features.concat(Q),W.features=W.features.concat(Y),W.features=W.features.concat(V),l.flatProperties&&W.features.forEach(function(wt){wt.properties=h.merge(wt.properties.meta,wt.properties.tags,{id:wt.properties.type+"/"+wt.properties.id})}),W=t(W),W)}function m(x){var y=l.polygonFeatures;if(typeof y=="function")return y(x);if(x.area==="no")return!1;for(var b in x){var P=x[b],A=y[b];if(!(typeof A>"u")&&P!=="no"&&(A===!0||A.included_values&&A.included_values[P]===!0||A.excluded_values&&A.excluded_values[P]!==!0))return!0}return!1}};function s(o){for(var l=function(P){return P[0]},u=function(P){return P[P.length-1]},f=function(P,A){return P!==void 0&&A!==void 0&&P.id===A.id},d=[],p,g,m,x,y,b;o.length;)for(p=o.pop().nodes.slice(),d.push(p);o.length&&!f(l(p),u(p));){for(g=l(p),m=u(p),x=0;x<o.length;x++)if(b=o[x].nodes,f(m,l(b))){y=p.push,b=b.slice(1);break}else if(f(m,u(b))){y=p.push,b=b.slice(0,-1).reverse();break}else if(f(g,u(b))){y=p.unshift,b=b.slice(0,-1);break}else if(f(g,l(b))){y=p.unshift,b=b.slice(1).reverse();break}else b=y=null;if(!b)break;o.splice(x,1),y.apply(p,b)}return d}return i.toGeojson=i,hh=i,hh}var gp=_p();const yp=yl(gp);var We=63710088e-1,Fc={centimeters:We*100,centimetres:We*100,degrees:360/(2*Math.PI),feet:We*3.28084,inches:We*39.37,kilometers:We/1e3,kilometres:We/1e3,meters:We,metres:We,miles:We/1609.344,millimeters:We*1e3,millimetres:We*1e3,nauticalmiles:We/1852,radians:1,yards:We*1.0936};function ur(h,t,e={}){const r={type:"Feature"};return(e.id===0||e.id)&&(r.id=e.id),e.bbox&&(r.bbox=e.bbox),r.properties=t||{},r.geometry=h,r}function vp(h,t,e={}){switch(h){case"Point":return vl(t).geometry;case"LineString":return xp(t).geometry;case"Polygon":return Na(t).geometry;case"MultiPoint":return Lp(t).geometry;case"MultiLineString":return bp(t).geometry;case"MultiPolygon":return Uc(t).geometry;default:throw new Error(h+" is invalid")}}function vl(h,t,e={}){if(!h)throw new Error("coordinates is required");if(!Array.isArray(h))throw new Error("coordinates must be an Array");if(h.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!hu(h[0])||!hu(h[1]))throw new Error("coordinates must contain numbers");return ur({type:"Point",coordinates:h},t,e)}function Na(h,t,e={}){for(const i of h){if(i.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");if(i[i.length-1].length!==i[0].length)throw new Error("First and last Position are not equivalent.");for(let s=0;s<i[i.length-1].length;s++)if(i[i.length-1][s]!==i[0][s])throw new Error("First and last Position are not equivalent.")}return ur({type:"Polygon",coordinates:h},t,e)}function xp(h,t,e={}){if(h.length<2)throw new Error("coordinates must be an array of two or more positions");return ur({type:"LineString",coordinates:h},t,e)}function wp(h,t={}){const e={type:"FeatureCollection"};return t.id&&(e.id=t.id),t.bbox&&(e.bbox=t.bbox),e.features=h,e}function bp(h,t,e={}){return ur({type:"MultiLineString",coordinates:h},t,e)}function Lp(h,t,e={}){return ur({type:"MultiPoint",coordinates:h},t,e)}function Uc(h,t,e={}){return ur({type:"MultiPolygon",coordinates:h},t,e)}function Mp(h,t="kilometers"){const e=Fc[t];if(!e)throw new Error(t+" units is invalid");return h*e}function Zc(h,t="kilometers"){const e=Fc[t];if(!e)throw new Error(t+" units is invalid");return h/e}function Vh(h){return h%(2*Math.PI)*180/Math.PI}function $r(h){return h%360*Math.PI/180}function Ep(h,t="kilometers",e="kilometers"){if(!(h>=0))throw new Error("length must be a positive number");return Mp(Zc(h,t),e)}function hu(h){return!isNaN(h)&&h!==null&&!Array.isArray(h)}function ir(h){if(!h)throw new Error("coord is required");if(!Array.isArray(h)){if(h.type==="Feature"&&h.geometry!==null&&h.geometry.type==="Point")return[...h.geometry.coordinates];if(h.type==="Point")return[...h.coordinates]}if(Array.isArray(h)&&h.length>=2&&!Array.isArray(h[0])&&!Array.isArray(h[1]))return[...h];throw new Error("coord must be GeoJSON Point or an Array of numbers")}function Tp(h,t,e,r={}){const i=ir(h),s=$r(i[0]),o=$r(i[1]),l=$r(e),u=Zc(t,r.units),f=Math.asin(Math.sin(o)*Math.cos(u)+Math.cos(o)*Math.sin(u)*Math.cos(l)),d=s+Math.atan2(Math.sin(l)*Math.sin(u)*Math.cos(o),Math.cos(u)-Math.sin(o)*Math.sin(f)),p=Vh(d),g=Vh(f);return vl([p,g],r.properties)}function Sp(h,t,e={}){let r;return e.final?r=lu(ir(t),ir(h)):r=lu(ir(h),ir(t)),r>180?-(360-r):r}function lu(h,t){const e=$r(h[1]),r=$r(t[1]);let i=$r(t[0]-h[0]);i>Math.PI&&(i-=2*Math.PI),i<-Math.PI&&(i+=2*Math.PI);const s=Math.log(Math.tan(r/2+Math.PI/4)/Math.tan(e/2+Math.PI/4)),o=Math.atan2(i,s);return(Vh(o)+360)%360}function Gc(h,t,e){if(h!==null)for(var r,i,s,o,l,u,f,d=0,p=0,g,m=h.type,x=m==="FeatureCollection",y=m==="Feature",b=x?h.features.length:1,P=0;P<b;P++){f=x?h.features[P].geometry:y?h.geometry:h,g=f?f.type==="GeometryCollection":!1,l=g?f.geometries.length:1;for(var A=0;A<l;A++){var N=0,G=0;if(o=g?f.geometries[A]:f,o!==null){u=o.coordinates;var z=o.type;switch(d=z==="Polygon"||z==="MultiPolygon"?1:0,z){case null:break;case"Point":if(t(u,p,P,N,G)===!1)return!1;p++,N++;break;case"LineString":case"MultiPoint":for(r=0;r<u.length;r++){if(t(u[r],p,P,N,G)===!1)return!1;p++,z==="MultiPoint"&&N++}z==="LineString"&&N++;break;case"Polygon":case"MultiLineString":for(r=0;r<u.length;r++){for(i=0;i<u[r].length-d;i++){if(t(u[r][i],p,P,N,G)===!1)return!1;p++}z==="MultiLineString"&&N++,z==="Polygon"&&G++}z==="Polygon"&&N++;break;case"MultiPolygon":for(r=0;r<u.length;r++){for(G=0,i=0;i<u[r].length;i++){for(s=0;s<u[r][i].length-d;s++){if(t(u[r][i][s],p,P,N,G)===!1)return!1;p++}G++}N++}break;case"GeometryCollection":for(r=0;r<o.geometries.length;r++)if(Gc(o.geometries[r],t)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function kp(h,t){var e,r,i,s,o,l,u,f,d,p,g=0,m=h.type==="FeatureCollection",x=h.type==="Feature",y=m?h.features.length:1;for(e=0;e<y;e++){for(l=m?h.features[e].geometry:x?h.geometry:h,f=m?h.features[e].properties:x?h.properties:{},d=m?h.features[e].bbox:x?h.bbox:void 0,p=m?h.features[e].id:x?h.id:void 0,u=l?l.type==="GeometryCollection":!1,o=u?l.geometries.length:1,i=0;i<o;i++){if(s=u?l.geometries[i]:l,s===null){if(t(null,g,f,d,p)===!1)return!1;continue}switch(s.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(t(s,g,f,d,p)===!1)return!1;break}case"GeometryCollection":{for(r=0;r<s.geometries.length;r++)if(t(s.geometries[r],g,f,d,p)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}g++}}function lh(h,t={}){let e=0,r=0,i=0;return Gc(h,function(s){e+=s[0],r+=s[1],i++}),vl([e/i,r/i],t.properties)}function uu(h,t,e={}){const r=e.steps||64,i=e.properties?e.properties:!Array.isArray(h)&&h.type==="Feature"&&h.properties?h.properties:{},s=[];for(let o=0;o<r;o++)s.push(Tp(h,t,o*-360/r,e).geometry.coordinates);return s.push(s[0]),Na([s],i)}var Ap=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,uh=Math.ceil,mi=Math.floor,Ve="[BigNumber Error] ",cu=Ve+"Number primitive has more than 15 significant digits: ",Mi=1e14,Nt=14,fu=9007199254740991,ch=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],wn=1e7,Je=1e9;function Hc(h){var t,e,r,i=A.prototype={constructor:A,toString:null,valueOf:null},s=new A(1),o=20,l=4,u=-7,f=21,d=-1e7,p=1e7,g=!1,m=1,x=0,y={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:"",suffix:""},b="0123456789abcdefghijklmnopqrstuvwxyz",P=!0;function A(T,k){var I,F,S,O,v,C,U,H,W=this;if(!(W instanceof A))return new A(T,k);if(k==null){if(T&&T._isBigNumber===!0){W.s=T.s,!T.c||T.e>p?W.c=W.e=null:T.e<d?W.c=[W.e=0]:(W.e=T.e,W.c=T.c.slice());return}if((C=typeof T=="number")&&T*0==0){if(W.s=1/T<0?(T=-T,-1):1,T===~~T){for(O=0,v=T;v>=10;v/=10,O++);O>p?W.c=W.e=null:(W.e=O,W.c=[T]);return}H=String(T)}else{if(!Ap.test(H=String(T)))return r(W,H,C);W.s=H.charCodeAt(0)==45?(H=H.slice(1),-1):1}(O=H.indexOf("."))>-1&&(H=H.replace(".","")),(v=H.search(/e/i))>0?(O<0&&(O=v),O+=+H.slice(v+1),H=H.substring(0,v)):O<0&&(O=H.length)}else{if(he(k,2,b.length,"Base"),k==10&&P)return W=new A(T),K(W,o+W.e+1,l);if(H=String(T),C=typeof T=="number"){if(T*0!=0)return r(W,H,C,k);if(W.s=1/T<0?(H=H.slice(1),-1):1,A.DEBUG&&H.replace(/^0\.0*|\./,"").length>15)throw Error(cu+T)}else W.s=H.charCodeAt(0)===45?(H=H.slice(1),-1):1;for(I=b.slice(0,k),O=v=0,U=H.length;v<U;v++)if(I.indexOf(F=H.charAt(v))<0){if(F=="."){if(v>O){O=U;continue}}else if(!S&&(H==H.toUpperCase()&&(H=H.toLowerCase())||H==H.toLowerCase()&&(H=H.toUpperCase()))){S=!0,v=-1,O=0;continue}return r(W,String(T),C,k)}C=!1,H=e(H,k,10,W.s),(O=H.indexOf("."))>-1?H=H.replace(".",""):O=H.length}for(v=0;H.charCodeAt(v)===48;v++);for(U=H.length;H.charCodeAt(--U)===48;);if(H=H.slice(v,++U)){if(U-=v,C&&A.DEBUG&&U>15&&(T>fu||T!==mi(T)))throw Error(cu+W.s*T);if((O=O-v-1)>p)W.c=W.e=null;else if(O<d)W.c=[W.e=0];else{if(W.e=O,W.c=[],v=(O+1)%Nt,O<0&&(v+=Nt),v<U){for(v&&W.c.push(+H.slice(0,v)),U-=Nt;v<U;)W.c.push(+H.slice(v,v+=Nt));v=Nt-(H=H.slice(v)).length}else v-=U;for(;v--;H+="0");W.c.push(+H)}}else W.c=[W.e=0]}A.clone=Hc,A.ROUND_UP=0,A.ROUND_DOWN=1,A.ROUND_CEIL=2,A.ROUND_FLOOR=3,A.ROUND_HALF_UP=4,A.ROUND_HALF_DOWN=5,A.ROUND_HALF_EVEN=6,A.ROUND_HALF_CEIL=7,A.ROUND_HALF_FLOOR=8,A.EUCLID=9,A.config=A.set=function(T){var k,I;if(T!=null)if(typeof T=="object"){if(T.hasOwnProperty(k="DECIMAL_PLACES")&&(I=T[k],he(I,0,Je,k),o=I),T.hasOwnProperty(k="ROUNDING_MODE")&&(I=T[k],he(I,0,8,k),l=I),T.hasOwnProperty(k="EXPONENTIAL_AT")&&(I=T[k],I&&I.pop?(he(I[0],-1e9,0,k),he(I[1],0,Je,k),u=I[0],f=I[1]):(he(I,-1e9,Je,k),u=-(f=I<0?-I:I))),T.hasOwnProperty(k="RANGE"))if(I=T[k],I&&I.pop)he(I[0],-1e9,-1,k),he(I[1],1,Je,k),d=I[0],p=I[1];else if(he(I,-1e9,Je,k),I)d=-(p=I<0?-I:I);else throw Error(Ve+k+" cannot be zero: "+I);if(T.hasOwnProperty(k="CRYPTO"))if(I=T[k],I===!!I)if(I)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))g=I;else throw g=!I,Error(Ve+"crypto unavailable");else g=I;else throw Error(Ve+k+" not true or false: "+I);if(T.hasOwnProperty(k="MODULO_MODE")&&(I=T[k],he(I,0,9,k),m=I),T.hasOwnProperty(k="POW_PRECISION")&&(I=T[k],he(I,0,Je,k),x=I),T.hasOwnProperty(k="FORMAT"))if(I=T[k],typeof I=="object")y=I;else throw Error(Ve+k+" not an object: "+I);if(T.hasOwnProperty(k="ALPHABET"))if(I=T[k],typeof I=="string"&&!/^.?$|[+\-.\s]|(.).*\1/.test(I))P=I.slice(0,10)=="0123456789",b=I;else throw Error(Ve+k+" invalid: "+I)}else throw Error(Ve+"Object expected: "+T);return{DECIMAL_PLACES:o,ROUNDING_MODE:l,EXPONENTIAL_AT:[u,f],RANGE:[d,p],CRYPTO:g,MODULO_MODE:m,POW_PRECISION:x,FORMAT:y,ALPHABET:b}},A.isBigNumber=function(T){if(!T||T._isBigNumber!==!0)return!1;if(!A.DEBUG)return!0;var k,I,F=T.c,S=T.e,O=T.s;t:if({}.toString.call(F)=="[object Array]"){if((O===1||O===-1)&&S>=-1e9&&S<=Je&&S===mi(S)){if(F[0]===0){if(S===0&&F.length===1)return!0;break t}if(k=(S+1)%Nt,k<1&&(k+=Nt),String(F[0]).length==k){for(k=0;k<F.length;k++)if(I=F[k],I<0||I>=Mi||I!==mi(I))break t;if(I!==0)return!0}}}else if(F===null&&S===null&&(O===null||O===1||O===-1))return!0;throw Error(Ve+"Invalid BigNumber: "+T)},A.maximum=A.max=function(){return G(arguments,-1)},A.minimum=A.min=function(){return G(arguments,1)},A.random=function(){var T=9007199254740992,k=Math.random()*T&2097151?function(){return mi(Math.random()*T)}:function(){return(Math.random()*1073741824|0)*8388608+(Math.random()*8388608|0)};return function(I){var F,S,O,v,C,U=0,H=[],W=new A(s);if(I==null?I=o:he(I,0,Je),v=uh(I/Nt),g)if(crypto.getRandomValues){for(F=crypto.getRandomValues(new Uint32Array(v*=2));U<v;)C=F[U]*131072+(F[U+1]>>>11),C>=9e15?(S=crypto.getRandomValues(new Uint32Array(2)),F[U]=S[0],F[U+1]=S[1]):(H.push(C%1e14),U+=2);U=v/2}else if(crypto.randomBytes){for(F=crypto.randomBytes(v*=7);U<v;)C=(F[U]&31)*281474976710656+F[U+1]*1099511627776+F[U+2]*4294967296+F[U+3]*16777216+(F[U+4]<<16)+(F[U+5]<<8)+F[U+6],C>=9e15?crypto.randomBytes(7).copy(F,U):(H.push(C%1e14),U+=7);U=v/7}else throw g=!1,Error(Ve+"crypto unavailable");if(!g)for(;U<v;)C=k(),C<9e15&&(H[U++]=C%1e14);for(v=H[--U],I%=Nt,v&&I&&(C=ch[Nt-I],H[U]=mi(v/C)*C);H[U]===0;H.pop(),U--);if(U<0)H=[O=0];else{for(O=-1;H[0]===0;H.splice(0,1),O-=Nt);for(U=1,C=H[0];C>=10;C/=10,U++);U<Nt&&(O-=Nt-U)}return W.e=O,W.c=H,W}}(),A.sum=function(){for(var T=1,k=arguments,I=new A(k[0]);T<k.length;)I=I.plus(k[T++]);return I},e=function(){var T="0123456789";function k(I,F,S,O){for(var v,C=[0],U,H=0,W=I.length;H<W;){for(U=C.length;U--;C[U]*=F);for(C[0]+=O.indexOf(I.charAt(H++)),v=0;v<C.length;v++)C[v]>S-1&&(C[v+1]==null&&(C[v+1]=0),C[v+1]+=C[v]/S|0,C[v]%=S)}return C.reverse()}return function(I,F,S,O,v){var C,U,H,W,V,et,Y,Q,pt=I.indexOf("."),ct=o,rt=l;for(pt>=0&&(W=x,x=0,I=I.replace(".",""),Q=new A(F),et=Q.pow(I.length-pt),x=W,Q.c=k(rn(di(et.c),et.e,"0"),10,S,T),Q.e=Q.c.length),Y=k(I,F,S,v?(C=b,T):(C=T,b)),H=W=Y.length;Y[--W]==0;Y.pop());if(!Y[0])return C.charAt(0);if(pt<0?--H:(et.c=Y,et.e=H,et.s=O,et=t(et,Q,ct,rt,S),Y=et.c,V=et.r,H=et.e),U=H+ct+1,pt=Y[U],W=S/2,V=V||U<0||Y[U+1]!=null,V=rt<4?(pt!=null||V)&&(rt==0||rt==(et.s<0?3:2)):pt>W||pt==W&&(rt==4||V||rt==6&&Y[U-1]&1||rt==(et.s<0?8:7)),U<1||!Y[0])I=V?rn(C.charAt(1),-ct,C.charAt(0)):C.charAt(0);else{if(Y.length=U,V)for(--S;++Y[--U]>S;)Y[U]=0,U||(++H,Y=[1].concat(Y));for(W=Y.length;!Y[--W];);for(pt=0,I="";pt<=W;I+=C.charAt(Y[pt++]));I=rn(I,H,C.charAt(0))}return I}}(),t=function(){function T(F,S,O){var v,C,U,H,W=0,V=F.length,et=S%wn,Y=S/wn|0;for(F=F.slice();V--;)U=F[V]%wn,H=F[V]/wn|0,v=Y*U+H*et,C=et*U+v%wn*wn+W,W=(C/O|0)+(v/wn|0)+Y*H,F[V]=C%O;return W&&(F=[W].concat(F)),F}function k(F,S,O,v){var C,U;if(O!=v)U=O>v?1:-1;else for(C=U=0;C<O;C++)if(F[C]!=S[C]){U=F[C]>S[C]?1:-1;break}return U}function I(F,S,O,v){for(var C=0;O--;)F[O]-=C,C=F[O]<S[O]?1:0,F[O]=C*v+F[O]-S[O];for(;!F[0]&&F.length>1;F.splice(0,1));}return function(F,S,O,v,C){var U,H,W,V,et,Y,Q,pt,ct,rt,mt,St,kt,It,wt,vt,ht,ft=F.s==S.s?1:-1,M=F.c,tt=S.c;if(!M||!M[0]||!tt||!tt[0])return new A(!F.s||!S.s||(M?tt&&M[0]==tt[0]:!tt)?NaN:M&&M[0]==0||!tt?ft*0:ft/0);for(pt=new A(ft),ct=pt.c=[],H=F.e-S.e,ft=O+H+1,C||(C=Mi,H=_i(F.e/Nt)-_i(S.e/Nt),ft=ft/Nt|0),W=0;tt[W]==(M[W]||0);W++);if(tt[W]>(M[W]||0)&&H--,ft<0)ct.push(1),V=!0;else{for(It=M.length,vt=tt.length,W=0,ft+=2,et=mi(C/(tt[0]+1)),et>1&&(tt=T(tt,et,C),M=T(M,et,C),vt=tt.length,It=M.length),kt=vt,rt=M.slice(0,vt),mt=rt.length;mt<vt;rt[mt++]=0);ht=tt.slice(),ht=[0].concat(ht),wt=tt[0],tt[1]>=C/2&&wt++;do{if(et=0,U=k(tt,rt,vt,mt),U<0){if(St=rt[0],vt!=mt&&(St=St*C+(rt[1]||0)),et=mi(St/wt),et>1)for(et>=C&&(et=C-1),Y=T(tt,et,C),Q=Y.length,mt=rt.length;k(Y,rt,Q,mt)==1;)et--,I(Y,vt<Q?ht:tt,Q,C),Q=Y.length,U=1;else et==0&&(U=et=1),Y=tt.slice(),Q=Y.length;if(Q<mt&&(Y=[0].concat(Y)),I(rt,Y,mt,C),mt=rt.length,U==-1)for(;k(tt,rt,vt,mt)<1;)et++,I(rt,vt<mt?ht:tt,mt,C),mt=rt.length}else U===0&&(et++,rt=[0]);ct[W++]=et,rt[0]?rt[mt++]=M[kt]||0:(rt=[M[kt]],mt=1)}while((kt++<It||rt[0]!=null)&&ft--);V=rt[0]!=null,ct[0]||ct.splice(0,1)}if(C==Mi){for(W=1,ft=ct[0];ft>=10;ft/=10,W++);K(pt,O+(pt.e=W+H*Nt-1)+1,v,V)}else pt.e=H,pt.r=+V;return pt}}();function N(T,k,I,F){var S,O,v,C,U;if(I==null?I=l:he(I,0,8),!T.c)return T.toString();if(S=T.c[0],v=T.e,k==null)U=di(T.c),U=F==1||F==2&&(v<=u||v>=f)?Wo(U,v):rn(U,v,"0");else if(T=K(new A(T),k,I),O=T.e,U=di(T.c),C=U.length,F==1||F==2&&(k<=O||O<=u)){for(;C<k;U+="0",C++);U=Wo(U,O)}else if(k-=v,U=rn(U,O,"0"),O+1>C){if(--k>0)for(U+=".";k--;U+="0");}else if(k+=O-C,k>0)for(O+1==C&&(U+=".");k--;U+="0");return T.s<0&&S?"-"+U:U}function G(T,k){for(var I,F,S=1,O=new A(T[0]);S<T.length;S++)F=new A(T[S]),(!F.s||(I=$n(O,F))===k||I===0&&O.s===k)&&(O=F);return O}function z(T,k,I){for(var F=1,S=k.length;!k[--S];k.pop());for(S=k[0];S>=10;S/=10,F++);return(I=F+I*Nt-1)>p?T.c=T.e=null:I<d?T.c=[T.e=0]:(T.e=I,T.c=k),T}r=function(){var T=/^(-?)0([xbo])(?=\w[\w.]*$)/i,k=/^([^.]+)\.$/,I=/^\.([^.]+)$/,F=/^-?(Infinity|NaN)$/,S=/^\s*\+(?=[\w.])|^\s+|\s+$/g;return function(O,v,C,U){var H,W=C?v:v.replace(S,"");if(F.test(W))O.s=isNaN(W)?null:W<0?-1:1;else{if(!C&&(W=W.replace(T,function(V,et,Y){return H=(Y=Y.toLowerCase())=="x"?16:Y=="b"?2:8,!U||U==H?et:V}),U&&(H=U,W=W.replace(k,"$1").replace(I,"0.$1")),v!=W))return new A(W,H);if(A.DEBUG)throw Error(Ve+"Not a"+(U?" base "+U:"")+" number: "+v);O.s=null}O.c=O.e=null}}();function K(T,k,I,F){var S,O,v,C,U,H,W,V=T.c,et=ch;if(V){t:{for(S=1,C=V[0];C>=10;C/=10,S++);if(O=k-S,O<0)O+=Nt,v=k,U=V[H=0],W=mi(U/et[S-v-1]%10);else if(H=uh((O+1)/Nt),H>=V.length)if(F){for(;V.length<=H;V.push(0));U=W=0,S=1,O%=Nt,v=O-Nt+1}else break t;else{for(U=C=V[H],S=1;C>=10;C/=10,S++);O%=Nt,v=O-Nt+S,W=v<0?0:mi(U/et[S-v-1]%10)}if(F=F||k<0||V[H+1]!=null||(v<0?U:U%et[S-v-1]),F=I<4?(W||F)&&(I==0||I==(T.s<0?3:2)):W>5||W==5&&(I==4||F||I==6&&(O>0?v>0?U/et[S-v]:0:V[H-1])%10&1||I==(T.s<0?8:7)),k<1||!V[0])return V.length=0,F?(k-=T.e+1,V[0]=et[(Nt-k%Nt)%Nt],T.e=-k||0):V[0]=T.e=0,T;if(O==0?(V.length=H,C=1,H--):(V.length=H+1,C=et[Nt-O],V[H]=v>0?mi(U/et[S-v]%et[v])*C:0),F)for(;;)if(H==0){for(O=1,v=V[0];v>=10;v/=10,O++);for(v=V[0]+=C,C=1;v>=10;v/=10,C++);O!=C&&(T.e++,V[0]==Mi&&(V[0]=1));break}else{if(V[H]+=C,V[H]!=Mi)break;V[H--]=0,C=1}for(O=V.length;V[--O]===0;V.pop());}T.e>p?T.c=T.e=null:T.e<d&&(T.c=[T.e=0])}return T}function q(T){var k,I=T.e;return I===null?T.toString():(k=di(T.c),k=I<=u||I>=f?Wo(k,I):rn(k,I,"0"),T.s<0?"-"+k:k)}return i.absoluteValue=i.abs=function(){var T=new A(this);return T.s<0&&(T.s=1),T},i.comparedTo=function(T,k){return $n(this,new A(T,k))},i.decimalPlaces=i.dp=function(T,k){var I,F,S,O=this;if(T!=null)return he(T,0,Je),k==null?k=l:he(k,0,8),K(new A(O),T+O.e+1,k);if(!(I=O.c))return null;if(F=((S=I.length-1)-_i(this.e/Nt))*Nt,S=I[S])for(;S%10==0;S/=10,F--);return F<0&&(F=0),F},i.dividedBy=i.div=function(T,k){return t(this,new A(T,k),o,l)},i.dividedToIntegerBy=i.idiv=function(T,k){return t(this,new A(T,k),0,1)},i.exponentiatedBy=i.pow=function(T,k){var I,F,S,O,v,C,U,H,W,V=this;if(T=new A(T),T.c&&!T.isInteger())throw Error(Ve+"Exponent not an integer: "+q(T));if(k!=null&&(k=new A(k)),C=T.e>14,!V.c||!V.c[0]||V.c[0]==1&&!V.e&&V.c.length==1||!T.c||!T.c[0])return W=new A(Math.pow(+q(V),C?T.s*(2-Ho(T)):+q(T))),k?W.mod(k):W;if(U=T.s<0,k){if(k.c?!k.c[0]:!k.s)return new A(NaN);F=!U&&V.isInteger()&&k.isInteger(),F&&(V=V.mod(k))}else{if(T.e>9&&(V.e>0||V.e<-1||(V.e==0?V.c[0]>1||C&&V.c[1]>=24e7:V.c[0]<8e13||C&&V.c[0]<=9999975e7)))return O=V.s<0&&Ho(T)?-0:0,V.e>-1&&(O=1/O),new A(U?1/O:O);x&&(O=uh(x/Nt+2))}for(C?(I=new A(.5),U&&(T.s=1),H=Ho(T)):(S=Math.abs(+q(T)),H=S%2),W=new A(s);;){if(H){if(W=W.times(V),!W.c)break;O?W.c.length>O&&(W.c.length=O):F&&(W=W.mod(k))}if(S){if(S=mi(S/2),S===0)break;H=S%2}else if(T=T.times(I),K(T,T.e+1,1),T.e>14)H=Ho(T);else{if(S=+q(T),S===0)break;H=S%2}V=V.times(V),O?V.c&&V.c.length>O&&(V.c.length=O):F&&(V=V.mod(k))}return F?W:(U&&(W=s.div(W)),k?W.mod(k):O?K(W,x,l,v):W)},i.integerValue=function(T){var k=new A(this);return T==null?T=l:he(T,0,8),K(k,k.e+1,T)},i.isEqualTo=i.eq=function(T,k){return $n(this,new A(T,k))===0},i.isFinite=function(){return!!this.c},i.isGreaterThan=i.gt=function(T,k){return $n(this,new A(T,k))>0},i.isGreaterThanOrEqualTo=i.gte=function(T,k){return(k=$n(this,new A(T,k)))===1||k===0},i.isInteger=function(){return!!this.c&&_i(this.e/Nt)>this.c.length-2},i.isLessThan=i.lt=function(T,k){return $n(this,new A(T,k))<0},i.isLessThanOrEqualTo=i.lte=function(T,k){return(k=$n(this,new A(T,k)))===-1||k===0},i.isNaN=function(){return!this.s},i.isNegative=function(){return this.s<0},i.isPositive=function(){return this.s>0},i.isZero=function(){return!!this.c&&this.c[0]==0},i.minus=function(T,k){var I,F,S,O,v=this,C=v.s;if(T=new A(T,k),k=T.s,!C||!k)return new A(NaN);if(C!=k)return T.s=-k,v.plus(T);var U=v.e/Nt,H=T.e/Nt,W=v.c,V=T.c;if(!U||!H){if(!W||!V)return W?(T.s=-k,T):new A(V?v:NaN);if(!W[0]||!V[0])return V[0]?(T.s=-k,T):new A(W[0]?v:l==3?-0:0)}if(U=_i(U),H=_i(H),W=W.slice(),C=U-H){for((O=C<0)?(C=-C,S=W):(H=U,S=V),S.reverse(),k=C;k--;S.push(0));S.reverse()}else for(F=(O=(C=W.length)<(k=V.length))?C:k,C=k=0;k<F;k++)if(W[k]!=V[k]){O=W[k]<V[k];break}if(O&&(S=W,W=V,V=S,T.s=-T.s),k=(F=V.length)-(I=W.length),k>0)for(;k--;W[I++]=0);for(k=Mi-1;F>C;){if(W[--F]<V[F]){for(I=F;I&&!W[--I];W[I]=k);--W[I],W[F]+=Mi}W[F]-=V[F]}for(;W[0]==0;W.splice(0,1),--H);return W[0]?z(T,W,H):(T.s=l==3?-1:1,T.c=[T.e=0],T)},i.modulo=i.mod=function(T,k){var I,F,S=this;return T=new A(T,k),!S.c||!T.s||T.c&&!T.c[0]?new A(NaN):!T.c||S.c&&!S.c[0]?new A(S):(m==9?(F=T.s,T.s=1,I=t(S,T,0,3),T.s=F,I.s*=F):I=t(S,T,0,m),T=S.minus(I.times(T)),!T.c[0]&&m==1&&(T.s=S.s),T)},i.multipliedBy=i.times=function(T,k){var I,F,S,O,v,C,U,H,W,V,et,Y,Q,pt,ct,rt=this,mt=rt.c,St=(T=new A(T,k)).c;if(!mt||!St||!mt[0]||!St[0])return!rt.s||!T.s||mt&&!mt[0]&&!St||St&&!St[0]&&!mt?T.c=T.e=T.s=null:(T.s*=rt.s,!mt||!St?T.c=T.e=null:(T.c=[0],T.e=0)),T;for(F=_i(rt.e/Nt)+_i(T.e/Nt),T.s*=rt.s,U=mt.length,V=St.length,U<V&&(Q=mt,mt=St,St=Q,S=U,U=V,V=S),S=U+V,Q=[];S--;Q.push(0));for(pt=Mi,ct=wn,S=V;--S>=0;){for(I=0,et=St[S]%ct,Y=St[S]/ct|0,v=U,O=S+v;O>S;)H=mt[--v]%ct,W=mt[v]/ct|0,C=Y*H+W*et,H=et*H+C%ct*ct+Q[O]+I,I=(H/pt|0)+(C/ct|0)+Y*W,Q[O--]=H%pt;Q[O]=I}return I?++F:Q.splice(0,1),z(T,Q,F)},i.negated=function(){var T=new A(this);return T.s=-T.s||null,T},i.plus=function(T,k){var I,F=this,S=F.s;if(T=new A(T,k),k=T.s,!S||!k)return new A(NaN);if(S!=k)return T.s=-k,F.minus(T);var O=F.e/Nt,v=T.e/Nt,C=F.c,U=T.c;if(!O||!v){if(!C||!U)return new A(S/0);if(!C[0]||!U[0])return U[0]?T:new A(C[0]?F:S*0)}if(O=_i(O),v=_i(v),C=C.slice(),S=O-v){for(S>0?(v=O,I=U):(S=-S,I=C),I.reverse();S--;I.push(0));I.reverse()}for(S=C.length,k=U.length,S-k<0&&(I=U,U=C,C=I,k=S),S=0;k;)S=(C[--k]=C[k]+U[k]+S)/Mi|0,C[k]=Mi===C[k]?0:C[k]%Mi;return S&&(C=[S].concat(C),++v),z(T,C,v)},i.precision=i.sd=function(T,k){var I,F,S,O=this;if(T!=null&&T!==!!T)return he(T,1,Je),k==null?k=l:he(k,0,8),K(new A(O),T,k);if(!(I=O.c))return null;if(S=I.length-1,F=S*Nt+1,S=I[S]){for(;S%10==0;S/=10,F--);for(S=I[0];S>=10;S/=10,F++);}return T&&O.e+1>F&&(F=O.e+1),F},i.shiftedBy=function(T){return he(T,-9007199254740991,fu),this.times("1e"+T)},i.squareRoot=i.sqrt=function(){var T,k,I,F,S,O=this,v=O.c,C=O.s,U=O.e,H=o+4,W=new A("0.5");if(C!==1||!v||!v[0])return new A(!C||C<0&&(!v||v[0])?NaN:v?O:1/0);if(C=Math.sqrt(+q(O)),C==0||C==1/0?(k=di(v),(k.length+U)%2==0&&(k+="0"),C=Math.sqrt(+k),U=_i((U+1)/2)-(U<0||U%2),C==1/0?k="5e"+U:(k=C.toExponential(),k=k.slice(0,k.indexOf("e")+1)+U),I=new A(k)):I=new A(C+""),I.c[0]){for(U=I.e,C=U+H,C<3&&(C=0);;)if(S=I,I=W.times(S.plus(t(O,S,H,1))),di(S.c).slice(0,C)===(k=di(I.c)).slice(0,C))if(I.e<U&&--C,k=k.slice(C-3,C+1),k=="9999"||!F&&k=="4999"){if(!F&&(K(S,S.e+o+2,0),S.times(S).eq(O))){I=S;break}H+=4,C+=4,F=1}else{(!+k||!+k.slice(1)&&k.charAt(0)=="5")&&(K(I,I.e+o+2,1),T=!I.times(I).eq(O));break}}return K(I,I.e+o+1,l,T)},i.toExponential=function(T,k){return T!=null&&(he(T,0,Je),T++),N(this,T,k,1)},i.toFixed=function(T,k){return T!=null&&(he(T,0,Je),T=T+this.e+1),N(this,T,k)},i.toFormat=function(T,k,I){var F,S=this;if(I==null)T!=null&&k&&typeof k=="object"?(I=k,k=null):T&&typeof T=="object"?(I=T,T=k=null):I=y;else if(typeof I!="object")throw Error(Ve+"Argument not an object: "+I);if(F=S.toFixed(T,k),S.c){var O,v=F.split("."),C=+I.groupSize,U=+I.secondaryGroupSize,H=I.groupSeparator||"",W=v[0],V=v[1],et=S.s<0,Y=et?W.slice(1):W,Q=Y.length;if(U&&(O=C,C=U,U=O,Q-=O),C>0&&Q>0){for(O=Q%C||C,W=Y.substr(0,O);O<Q;O+=C)W+=H+Y.substr(O,C);U>0&&(W+=H+Y.slice(O)),et&&(W="-"+W)}F=V?W+(I.decimalSeparator||"")+((U=+I.fractionGroupSize)?V.replace(new RegExp("\\d{"+U+"}\\B","g"),"$&"+(I.fractionGroupSeparator||"")):V):W}return(I.prefix||"")+F+(I.suffix||"")},i.toFraction=function(T){var k,I,F,S,O,v,C,U,H,W,V,et,Y=this,Q=Y.c;if(T!=null&&(C=new A(T),!C.isInteger()&&(C.c||C.s!==1)||C.lt(s)))throw Error(Ve+"Argument "+(C.isInteger()?"out of range: ":"not an integer: ")+q(C));if(!Q)return new A(Y);for(k=new A(s),H=I=new A(s),F=U=new A(s),et=di(Q),O=k.e=et.length-Y.e-1,k.c[0]=ch[(v=O%Nt)<0?Nt+v:v],T=!T||C.comparedTo(k)>0?O>0?k:H:C,v=p,p=1/0,C=new A(et),U.c[0]=0;W=t(C,k,0,1),S=I.plus(W.times(F)),S.comparedTo(T)!=1;)I=F,F=S,H=U.plus(W.times(S=H)),U=S,k=C.minus(W.times(S=k)),C=S;return S=t(T.minus(I),F,0,1),U=U.plus(S.times(H)),I=I.plus(S.times(F)),U.s=H.s=Y.s,O=O*2,V=t(H,F,O,l).minus(Y).abs().comparedTo(t(U,I,O,l).minus(Y).abs())<1?[H,F]:[U,I],p=v,V},i.toNumber=function(){return+q(this)},i.toPrecision=function(T,k){return T!=null&&he(T,1,Je),N(this,T,k,2)},i.toString=function(T){var k,I=this,F=I.s,S=I.e;return S===null?F?(k="Infinity",F<0&&(k="-"+k)):k="NaN":(T==null?k=S<=u||S>=f?Wo(di(I.c),S):rn(di(I.c),S,"0"):T===10&&P?(I=K(new A(I),o+S+1,l),k=rn(di(I.c),I.e,"0")):(he(T,2,b.length,"Base"),k=e(rn(di(I.c),S,"0"),10,T,F,!0)),F<0&&I.c[0]&&(k="-"+k)),k},i.valueOf=i.toJSON=function(){return q(this)},i._isBigNumber=!0,i[Symbol.toStringTag]="BigNumber",i[Symbol.for("nodejs.util.inspect.custom")]=i.valueOf,h!=null&&A.set(h),A}function _i(h){var t=h|0;return h>0||h===t?t:t-1}function di(h){for(var t,e,r=1,i=h.length,s=h[0]+"";r<i;){for(t=h[r++]+"",e=Nt-t.length;e--;t="0"+t);s+=t}for(i=s.length;s.charCodeAt(--i)===48;);return s.slice(0,i+1||1)}function $n(h,t){var e,r,i=h.c,s=t.c,o=h.s,l=t.s,u=h.e,f=t.e;if(!o||!l)return null;if(e=i&&!i[0],r=s&&!s[0],e||r)return e?r?0:-l:o;if(o!=l)return o;if(e=o<0,r=u==f,!i||!s)return r?0:!i^e?1:-1;if(!r)return u>f^e?1:-1;for(l=(u=i.length)<(f=s.length)?u:f,o=0;o<l;o++)if(i[o]!=s[o])return i[o]>s[o]^e?1:-1;return u==f?0:u>f^e?1:-1}function he(h,t,e,r){if(h<t||h>e||h!==mi(h))throw Error(Ve+(r||"Argument")+(typeof h=="number"?h<t||h>e?" out of range: ":" not an integer: ":" not a primitive number: ")+String(h))}function Ho(h){var t=h.c.length-1;return _i(h.e/Nt)==t&&h.c[t]%2!=0}function Wo(h,t){return(h.length>1?h.charAt(0)+"."+h.slice(1):h)+(t<0?"e":"e+")+t}function rn(h,t,e){var r,i;if(t<0){for(i=e+".";++t;i+=e);h=i+h}else if(r=h.length,++t>r){for(i=e,t-=r;--t;i+=e);h+=i}else t<r&&(h=h.slice(0,t)+"."+h.slice(t));return h}var Fi=Hc(),Pp=class{constructor(h){zt(this,"key");zt(this,"left",null);zt(this,"right",null);this.key=h}},Ps=class extends Pp{constructor(h){super(h)}},Cp=class{constructor(){zt(this,"size",0);zt(this,"modificationCount",0);zt(this,"splayCount",0)}splay(h){const t=this.root;if(t==null)return this.compare(h,h),-1;let e=null,r=null,i=null,s=null,o=t;const l=this.compare;let u;for(;;)if(u=l(o.key,h),u>0){let f=o.left;if(f==null||(u=l(f.key,h),u>0&&(o.left=f.right,f.right=o,o=f,f=o.left,f==null)))break;e==null?r=o:e.left=o,e=o,o=f}else if(u<0){let f=o.right;if(f==null||(u=l(f.key,h),u<0&&(o.right=f.left,f.left=o,o=f,f=o.right,f==null)))break;i==null?s=o:i.right=o,i=o,o=f}else break;return i!=null&&(i.right=o.left,o.left=s),e!=null&&(e.left=o.right,o.right=r),this.root!==o&&(this.root=o,this.splayCount++),u}splayMin(h){let t=h,e=t.left;for(;e!=null;){const r=e;t.left=r.right,r.right=t,t=r,e=t.left}return t}splayMax(h){let t=h,e=t.right;for(;e!=null;){const r=e;t.right=r.left,r.left=t,t=r,e=t.right}return t}_delete(h){if(this.root==null||this.splay(h)!=0)return null;let e=this.root;const r=e,i=e.left;if(this.size--,i==null)this.root=e.right;else{const s=e.right;e=this.splayMax(i),e.right=s,this.root=e}return this.modificationCount++,r}addNewRoot(h,t){this.size++,this.modificationCount++;const e=this.root;if(e==null){this.root=h;return}t<0?(h.left=e,h.right=e.right,e.right=null):(h.right=e,h.left=e.left,e.left=null),this.root=h}_first(){const h=this.root;return h==null?null:(this.root=this.splayMin(h),this.root)}_last(){const h=this.root;return h==null?null:(this.root=this.splayMax(h),this.root)}clear(){this.root=null,this.size=0,this.modificationCount++}has(h){return this.validKey(h)&&this.splay(h)==0}defaultCompare(){return(h,t)=>h<t?-1:h>t?1:0}wrap(){return{getRoot:()=>this.root,setRoot:h=>{this.root=h},getSize:()=>this.size,getModificationCount:()=>this.modificationCount,getSplayCount:()=>this.splayCount,setSplayCount:h=>{this.splayCount=h},splay:h=>this.splay(h),has:h=>this.has(h)}}},rc,sc,Ta=class Fs extends Cp{constructor(e,r){super();zt(this,"root",null);zt(this,"compare");zt(this,"validKey");zt(this,rc,"[object Set]");this.compare=e??this.defaultCompare(),this.validKey=r??(i=>i!=null&&i!=null)}delete(e){return this.validKey(e)?this._delete(e)!=null:!1}deleteAll(e){for(const r of e)this.delete(r)}forEach(e){const r=this[Symbol.iterator]();let i;for(;i=r.next(),!i.done;)e(i.value,i.value,this)}add(e){const r=this.splay(e);return r!=0&&this.addNewRoot(new Ps(e),r),this}addAndReturn(e){const r=this.splay(e);return r!=0&&this.addNewRoot(new Ps(e),r),this.root.key}addAll(e){for(const r of e)this.add(r)}isEmpty(){return this.root==null}isNotEmpty(){return this.root!=null}single(){if(this.size==0)throw"Bad state: No element";if(this.size>1)throw"Bad state: Too many element";return this.root.key}first(){if(this.size==0)throw"Bad state: No element";return this._first().key}last(){if(this.size==0)throw"Bad state: No element";return this._last().key}lastBefore(e){if(e==null)throw"Invalid arguments(s)";if(this.root==null)return null;if(this.splay(e)<0)return this.root.key;let i=this.root.left;if(i==null)return null;let s=i.right;for(;s!=null;)i=s,s=i.right;return i.key}firstAfter(e){if(e==null)throw"Invalid arguments(s)";if(this.root==null)return null;if(this.splay(e)>0)return this.root.key;let i=this.root.right;if(i==null)return null;let s=i.left;for(;s!=null;)i=s,s=i.left;return i.key}retainAll(e){const r=new Fs(this.compare,this.validKey),i=this.modificationCount;for(const s of e){if(i!=this.modificationCount)throw"Concurrent modification during iteration.";this.validKey(s)&&this.splay(s)==0&&r.add(this.root.key)}r.size!=this.size&&(this.root=r.root,this.size=r.size,this.modificationCount++)}lookup(e){return!this.validKey(e)||this.splay(e)!=0?null:this.root.key}intersection(e){const r=new Fs(this.compare,this.validKey);for(const i of this)e.has(i)&&r.add(i);return r}difference(e){const r=new Fs(this.compare,this.validKey);for(const i of this)e.has(i)||r.add(i);return r}union(e){const r=this.clone();return r.addAll(e),r}clone(){const e=new Fs(this.compare,this.validKey);return e.size=this.size,e.root=this.copyNode(this.root),e}copyNode(e){if(e==null)return null;function r(s,o){let l,u;do{if(l=s.left,u=s.right,l!=null){const f=new Ps(l.key);o.left=f,r(l,f)}if(u!=null){const f=new Ps(u.key);o.right=f,s=u,o=f}}while(u!=null)}const i=new Ps(e.key);return r(e,i),i}toSet(){return this.clone()}entries(){return new Ip(this.wrap())}keys(){return this[Symbol.iterator]()}values(){return this[Symbol.iterator]()}[(sc=Symbol.iterator,rc=Symbol.toStringTag,sc)](){return new zp(this.wrap())}},Wc=class{constructor(h){zt(this,"tree");zt(this,"path",new Array);zt(this,"modificationCount",null);zt(this,"splayCount");this.tree=h,this.splayCount=h.getSplayCount()}[Symbol.iterator](){return this}next(){return this.moveNext()?{done:!1,value:this.current()}:{done:!0,value:null}}current(){if(!this.path.length)return null;const h=this.path[this.path.length-1];return this.getValue(h)}rebuildPath(h){this.path.splice(0,this.path.length),this.tree.splay(h),this.path.push(this.tree.getRoot()),this.splayCount=this.tree.getSplayCount()}findLeftMostDescendent(h){for(;h!=null;)this.path.push(h),h=h.left}moveNext(){if(this.modificationCount!=this.tree.getModificationCount()){if(this.modificationCount==null){this.modificationCount=this.tree.getModificationCount();let e=this.tree.getRoot();for(;e!=null;)this.path.push(e),e=e.left;return this.path.length>0}throw"Concurrent modification during iteration."}if(!this.path.length)return!1;this.splayCount!=this.tree.getSplayCount()&&this.rebuildPath(this.path[this.path.length-1].key);let h=this.path[this.path.length-1],t=h.right;if(t!=null){for(;t!=null;)this.path.push(t),t=t.left;return!0}for(this.path.pop();this.path.length&&this.path[this.path.length-1].right===h;)h=this.path.pop();return this.path.length>0}},zp=class extends Wc{getValue(h){return h.key}},Ip=class extends Wc{getValue(h){return[h.key,h.key]}},Vc=h=>()=>h,qh=h=>{const t=h?(e,r)=>r.minus(e).abs().isLessThanOrEqualTo(h):Vc(!1);return(e,r)=>t(e,r)?0:e.comparedTo(r)};function Op(h){const t=h?(e,r,i,s,o)=>e.exponentiatedBy(2).isLessThanOrEqualTo(s.minus(r).exponentiatedBy(2).plus(o.minus(i).exponentiatedBy(2)).times(h)):Vc(!1);return(e,r,i)=>{const s=e.x,o=e.y,l=i.x,u=i.y,f=o.minus(u).times(r.x.minus(l)).minus(s.minus(l).times(r.y.minus(u)));return t(f,s,o,l,u)?0:f.comparedTo(0)}}var Rp=h=>h,Dp=h=>{if(h){const t=new Ta(qh(h)),e=new Ta(qh(h)),r=(s,o)=>o.addAndReturn(s),i=s=>({x:r(s.x,t),y:r(s.y,e)});return i({x:new Fi(0),y:new Fi(0)}),i}return Rp},Yh=h=>({set:t=>{cn=Yh(t)},reset:()=>Yh(h),compare:qh(h),snap:Dp(h),orient:Op(h)}),cn=Yh(),Cs=(h,t)=>h.ll.x.isLessThanOrEqualTo(t.x)&&t.x.isLessThanOrEqualTo(h.ur.x)&&h.ll.y.isLessThanOrEqualTo(t.y)&&t.y.isLessThanOrEqualTo(h.ur.y),jh=(h,t)=>{if(t.ur.x.isLessThan(h.ll.x)||h.ur.x.isLessThan(t.ll.x)||t.ur.y.isLessThan(h.ll.y)||h.ur.y.isLessThan(t.ll.y))return null;const e=h.ll.x.isLessThan(t.ll.x)?t.ll.x:h.ll.x,r=h.ur.x.isLessThan(t.ur.x)?h.ur.x:t.ur.x,i=h.ll.y.isLessThan(t.ll.y)?t.ll.y:h.ll.y,s=h.ur.y.isLessThan(t.ur.y)?h.ur.y:t.ur.y;return{ll:{x:e,y:i},ur:{x:r,y:s}}},ma=(h,t)=>h.x.times(t.y).minus(h.y.times(t.x)),qc=(h,t)=>h.x.times(t.x).plus(h.y.times(t.y)),Sa=h=>qc(h,h).sqrt(),Bp=(h,t,e)=>{const r={x:t.x.minus(h.x),y:t.y.minus(h.y)},i={x:e.x.minus(h.x),y:e.y.minus(h.y)};return ma(i,r).div(Sa(i)).div(Sa(r))},Np=(h,t,e)=>{const r={x:t.x.minus(h.x),y:t.y.minus(h.y)},i={x:e.x.minus(h.x),y:e.y.minus(h.y)};return qc(i,r).div(Sa(i)).div(Sa(r))},du=(h,t,e)=>t.y.isZero()?null:{x:h.x.plus(t.x.div(t.y).times(e.minus(h.y))),y:e},pu=(h,t,e)=>t.x.isZero()?null:{x:e,y:h.y.plus(t.y.div(t.x).times(e.minus(h.x)))},Fp=(h,t,e,r)=>{if(t.x.isZero())return pu(e,r,h.x);if(r.x.isZero())return pu(h,t,e.x);if(t.y.isZero())return du(e,r,h.y);if(r.y.isZero())return du(h,t,e.y);const i=ma(t,r);if(i.isZero())return null;const s={x:e.x.minus(h.x),y:e.y.minus(h.y)},o=ma(s,t).div(i),l=ma(s,r).div(i),u=h.x.plus(l.times(t.x)),f=e.x.plus(o.times(r.x)),d=h.y.plus(l.times(t.y)),p=e.y.plus(o.times(r.y)),g=u.plus(f).div(2),m=d.plus(p).div(2);return{x:g,y:m}},Ni=class Yc{constructor(t,e){zt(this,"point");zt(this,"isLeft");zt(this,"segment");zt(this,"otherSE");zt(this,"consumedBy");t.events===void 0?t.events=[this]:t.events.push(this),this.point=t,this.isLeft=e}static compare(t,e){const r=Yc.comparePoints(t.point,e.point);return r!==0?r:(t.point!==e.point&&t.link(e),t.isLeft!==e.isLeft?t.isLeft?1:-1:ka.compare(t.segment,e.segment))}static comparePoints(t,e){return t.x.isLessThan(e.x)?-1:t.x.isGreaterThan(e.x)?1:t.y.isLessThan(e.y)?-1:t.y.isGreaterThan(e.y)?1:0}link(t){if(t.point===this.point)throw new Error("Tried to link already linked events");const e=t.point.events;for(let r=0,i=e.length;r<i;r++){const s=e[r];this.point.events.push(s),s.point=this.point}this.checkForConsuming()}checkForConsuming(){const t=this.point.events.length;for(let e=0;e<t;e++){const r=this.point.events[e];if(r.segment.consumedBy===void 0)for(let i=e+1;i<t;i++){const s=this.point.events[i];s.consumedBy===void 0&&r.otherSE.point.events===s.otherSE.point.events&&r.segment.consume(s.segment)}}}getAvailableLinkedEvents(){const t=[];for(let e=0,r=this.point.events.length;e<r;e++){const i=this.point.events[e];i!==this&&!i.segment.ringOut&&i.segment.isInResult()&&t.push(i)}return t}getLeftmostComparator(t){const e=new Map,r=i=>{const s=i.otherSE;e.set(i,{sine:Bp(this.point,t.point,s.point),cosine:Np(this.point,t.point,s.point)})};return(i,s)=>{e.has(i)||r(i),e.has(s)||r(s);const{sine:o,cosine:l}=e.get(i),{sine:u,cosine:f}=e.get(s);return o.isGreaterThanOrEqualTo(0)&&u.isGreaterThanOrEqualTo(0)?l.isLessThan(f)?1:l.isGreaterThan(f)?-1:0:o.isLessThan(0)&&u.isLessThan(0)?l.isLessThan(f)?-1:l.isGreaterThan(f)?1:0:u.isLessThan(o)?-1:u.isGreaterThan(o)?1:0}}},Up=class Xh{constructor(t){zt(this,"events");zt(this,"poly");zt(this,"_isExteriorRing");zt(this,"_enclosingRing");this.events=t;for(let e=0,r=t.length;e<r;e++)t[e].segment.ringOut=this;this.poly=null}static factory(t){const e=[];for(let r=0,i=t.length;r<i;r++){const s=t[r];if(!s.isInResult()||s.ringOut)continue;let o=null,l=s.leftSE,u=s.rightSE;const f=[l],d=l.point,p=[];for(;o=l,l=u,f.push(l),l.point!==d;)for(;;){const g=l.getAvailableLinkedEvents();if(g.length===0){const y=f[0].point,b=f[f.length-1].point;throw new Error(`Unable to complete output ring starting at [${y.x}, ${y.y}]. Last matching segment found ends at [${b.x}, ${b.y}].`)}if(g.length===1){u=g[0].otherSE;break}let m=null;for(let y=0,b=p.length;y<b;y++)if(p[y].point===l.point){m=y;break}if(m!==null){const y=p.splice(m)[0],b=f.splice(y.index);b.unshift(b[0].otherSE),e.push(new Xh(b.reverse()));continue}p.push({index:f.length,point:l.point});const x=l.getLeftmostComparator(o);u=g.sort(x)[0].otherSE;break}e.push(new Xh(f))}return e}getGeom(){let t=this.events[0].point;const e=[t];for(let f=1,d=this.events.length-1;f<d;f++){const p=this.events[f].point,g=this.events[f+1].point;cn.orient(p,t,g)!==0&&(e.push(p),t=p)}if(e.length===1)return null;const r=e[0],i=e[1];cn.orient(r,t,i)===0&&e.shift(),e.push(e[0]);const s=this.isExteriorRing()?1:-1,o=this.isExteriorRing()?0:e.length-1,l=this.isExteriorRing()?e.length:-1,u=[];for(let f=o;f!=l;f+=s)u.push([e[f].x.toNumber(),e[f].y.toNumber()]);return u}isExteriorRing(){if(this._isExteriorRing===void 0){const t=this.enclosingRing();this._isExteriorRing=t?!t.isExteriorRing():!0}return this._isExteriorRing}enclosingRing(){return this._enclosingRing===void 0&&(this._enclosingRing=this._calcEnclosingRing()),this._enclosingRing}_calcEnclosingRing(){var i,s;let t=this.events[0];for(let o=1,l=this.events.length;o<l;o++){const u=this.events[o];Ni.compare(t,u)>0&&(t=u)}let e=t.segment.prevInResult(),r=e?e.prevInResult():null;for(;;){if(!e)return null;if(!r)return e.ringOut;if(r.ringOut!==e.ringOut)return((i=r.ringOut)==null?void 0:i.enclosingRing())!==e.ringOut?e.ringOut:(s=e.ringOut)==null?void 0:s.enclosingRing();e=r.prevInResult(),r=e?e.prevInResult():null}}},mu=class{constructor(h){zt(this,"exteriorRing");zt(this,"interiorRings");this.exteriorRing=h,h.poly=this,this.interiorRings=[]}addInterior(h){this.interiorRings.push(h),h.poly=this}getGeom(){const h=this.exteriorRing.getGeom();if(h===null)return null;const t=[h];for(let e=0,r=this.interiorRings.length;e<r;e++){const i=this.interiorRings[e].getGeom();i!==null&&t.push(i)}return t}},Zp=class{constructor(h){zt(this,"rings");zt(this,"polys");this.rings=h,this.polys=this._composePolys(h)}getGeom(){const h=[];for(let t=0,e=this.polys.length;t<e;t++){const r=this.polys[t].getGeom();r!==null&&h.push(r)}return h}_composePolys(h){var e;const t=[];for(let r=0,i=h.length;r<i;r++){const s=h[r];if(!s.poly)if(s.isExteriorRing())t.push(new mu(s));else{const o=s.enclosingRing();o!=null&&o.poly||t.push(new mu(o)),(e=o==null?void 0:o.poly)==null||e.addInterior(s)}}return t}},Gp=class{constructor(h,t=ka.compare){zt(this,"queue");zt(this,"tree");zt(this,"segments");this.queue=h,this.tree=new Ta(t),this.segments=[]}process(h){const t=h.segment,e=[];if(h.consumedBy)return h.isLeft?this.queue.delete(h.otherSE):this.tree.delete(t),e;h.isLeft&&this.tree.add(t);let r=t,i=t;do r=this.tree.lastBefore(r);while(r!=null&&r.consumedBy!=null);do i=this.tree.firstAfter(i);while(i!=null&&i.consumedBy!=null);if(h.isLeft){let s=null;if(r){const l=r.getIntersection(t);if(l!==null&&(t.isAnEndpoint(l)||(s=l),!r.isAnEndpoint(l))){const u=this._splitSafely(r,l);for(let f=0,d=u.length;f<d;f++)e.push(u[f])}}let o=null;if(i){const l=i.getIntersection(t);if(l!==null&&(t.isAnEndpoint(l)||(o=l),!i.isAnEndpoint(l))){const u=this._splitSafely(i,l);for(let f=0,d=u.length;f<d;f++)e.push(u[f])}}if(s!==null||o!==null){let l=null;s===null?l=o:o===null?l=s:l=Ni.comparePoints(s,o)<=0?s:o,this.queue.delete(t.rightSE),e.push(t.rightSE);const u=t.split(l);for(let f=0,d=u.length;f<d;f++)e.push(u[f])}e.length>0?(this.tree.delete(t),e.push(h)):(this.segments.push(t),t.prev=r)}else{if(r&&i){const s=r.getIntersection(i);if(s!==null){if(!r.isAnEndpoint(s)){const o=this._splitSafely(r,s);for(let l=0,u=o.length;l<u;l++)e.push(o[l])}if(!i.isAnEndpoint(s)){const o=this._splitSafely(i,s);for(let l=0,u=o.length;l<u;l++)e.push(o[l])}}}this.tree.delete(t)}return e}_splitSafely(h,t){this.tree.delete(h);const e=h.rightSE;this.queue.delete(e);const r=h.split(t);return r.push(e),h.consumedBy===void 0&&this.tree.add(h),r}},Hp=class{constructor(){zt(this,"type");zt(this,"numMultiPolys")}run(h,t,e){Us.type=h;const r=[new gu(t,!0)];for(let f=0,d=e.length;f<d;f++)r.push(new gu(e[f],!1));if(Us.numMultiPolys=r.length,Us.type==="difference"){const f=r[0];let d=1;for(;d<r.length;)jh(r[d].bbox,f.bbox)!==null?d++:r.splice(d,1)}if(Us.type==="intersection")for(let f=0,d=r.length;f<d;f++){const p=r[f];for(let g=f+1,m=r.length;g<m;g++)if(jh(p.bbox,r[g].bbox)===null)return[]}const i=new Ta(Ni.compare);for(let f=0,d=r.length;f<d;f++){const p=r[f].getSweepEvents();for(let g=0,m=p.length;g<m;g++)i.add(p[g])}const s=new Gp(i);let o=null;for(i.size!=0&&(o=i.first(),i.delete(o));o;){const f=s.process(o);for(let d=0,p=f.length;d<p;d++){const g=f[d];g.consumedBy===void 0&&i.add(g)}i.size!=0?(o=i.first(),i.delete(o)):o=null}cn.reset();const l=Up.factory(s.segments);return new Zp(l).getGeom()}},Us=new Hp,Jh=Us,Wp=0,ka=class _a{constructor(t,e,r,i){zt(this,"id");zt(this,"leftSE");zt(this,"rightSE");zt(this,"rings");zt(this,"windings");zt(this,"ringOut");zt(this,"consumedBy");zt(this,"prev");zt(this,"_prevInResult");zt(this,"_beforeState");zt(this,"_afterState");zt(this,"_isInResult");this.id=++Wp,this.leftSE=t,t.segment=this,t.otherSE=e,this.rightSE=e,e.segment=this,e.otherSE=t,this.rings=r,this.windings=i}static compare(t,e){const r=t.leftSE.point.x,i=e.leftSE.point.x,s=t.rightSE.point.x,o=e.rightSE.point.x;if(o.isLessThan(r))return 1;if(s.isLessThan(i))return-1;const l=t.leftSE.point.y,u=e.leftSE.point.y,f=t.rightSE.point.y,d=e.rightSE.point.y;if(r.isLessThan(i)){if(u.isLessThan(l)&&u.isLessThan(f))return 1;if(u.isGreaterThan(l)&&u.isGreaterThan(f))return-1;const p=t.comparePoint(e.leftSE.point);if(p<0)return 1;if(p>0)return-1;const g=e.comparePoint(t.rightSE.point);return g!==0?g:-1}if(r.isGreaterThan(i)){if(l.isLessThan(u)&&l.isLessThan(d))return-1;if(l.isGreaterThan(u)&&l.isGreaterThan(d))return 1;const p=e.comparePoint(t.leftSE.point);if(p!==0)return p;const g=t.comparePoint(e.rightSE.point);return g<0?1:g>0?-1:1}if(l.isLessThan(u))return-1;if(l.isGreaterThan(u))return 1;if(s.isLessThan(o)){const p=e.comparePoint(t.rightSE.point);if(p!==0)return p}if(s.isGreaterThan(o)){const p=t.comparePoint(e.rightSE.point);if(p<0)return 1;if(p>0)return-1}if(!s.eq(o)){const p=f.minus(l),g=s.minus(r),m=d.minus(u),x=o.minus(i);if(p.isGreaterThan(g)&&m.isLessThan(x))return 1;if(p.isLessThan(g)&&m.isGreaterThan(x))return-1}return s.isGreaterThan(o)?1:s.isLessThan(o)||f.isLessThan(d)?-1:f.isGreaterThan(d)?1:t.id<e.id?-1:t.id>e.id?1:0}static fromRing(t,e,r){let i,s,o;const l=Ni.comparePoints(t,e);if(l<0)i=t,s=e,o=1;else if(l>0)i=e,s=t,o=-1;else throw new Error(`Tried to create degenerate segment at [${t.x}, ${t.y}]`);const u=new Ni(i,!0),f=new Ni(s,!1);return new _a(u,f,[r],[o])}replaceRightSE(t){this.rightSE=t,this.rightSE.segment=this,this.rightSE.otherSE=this.leftSE,this.leftSE.otherSE=this.rightSE}bbox(){const t=this.leftSE.point.y,e=this.rightSE.point.y;return{ll:{x:this.leftSE.point.x,y:t.isLessThan(e)?t:e},ur:{x:this.rightSE.point.x,y:t.isGreaterThan(e)?t:e}}}vector(){return{x:this.rightSE.point.x.minus(this.leftSE.point.x),y:this.rightSE.point.y.minus(this.leftSE.point.y)}}isAnEndpoint(t){return t.x.eq(this.leftSE.point.x)&&t.y.eq(this.leftSE.point.y)||t.x.eq(this.rightSE.point.x)&&t.y.eq(this.rightSE.point.y)}comparePoint(t){return cn.orient(this.leftSE.point,t,this.rightSE.point)}getIntersection(t){const e=this.bbox(),r=t.bbox(),i=jh(e,r);if(i===null)return null;const s=this.leftSE.point,o=this.rightSE.point,l=t.leftSE.point,u=t.rightSE.point,f=Cs(e,l)&&this.comparePoint(l)===0,d=Cs(r,s)&&t.comparePoint(s)===0,p=Cs(e,u)&&this.comparePoint(u)===0,g=Cs(r,o)&&t.comparePoint(o)===0;if(d&&f)return g&&!p?o:!g&&p?u:null;if(d)return p&&s.x.eq(u.x)&&s.y.eq(u.y)?null:s;if(f)return g&&o.x.eq(l.x)&&o.y.eq(l.y)?null:l;if(g&&p)return null;if(g)return o;if(p)return u;const m=Fp(s,this.vector(),l,t.vector());return m===null||!Cs(i,m)?null:cn.snap(m)}split(t){const e=[],r=t.events!==void 0,i=new Ni(t,!0),s=new Ni(t,!1),o=this.rightSE;this.replaceRightSE(s),e.push(s),e.push(i);const l=new _a(i,o,this.rings.slice(),this.windings.slice());return Ni.comparePoints(l.leftSE.point,l.rightSE.point)>0&&l.swapEvents(),Ni.comparePoints(this.leftSE.point,this.rightSE.point)>0&&this.swapEvents(),r&&(i.checkForConsuming(),s.checkForConsuming()),e}swapEvents(){const t=this.rightSE;this.rightSE=this.leftSE,this.leftSE=t,this.leftSE.isLeft=!0,this.rightSE.isLeft=!1;for(let e=0,r=this.windings.length;e<r;e++)this.windings[e]*=-1}consume(t){let e=this,r=t;for(;e.consumedBy;)e=e.consumedBy;for(;r.consumedBy;)r=r.consumedBy;const i=_a.compare(e,r);if(i!==0){if(i>0){const s=e;e=r,r=s}if(e.prev===r){const s=e;e=r,r=s}for(let s=0,o=r.rings.length;s<o;s++){const l=r.rings[s],u=r.windings[s],f=e.rings.indexOf(l);f===-1?(e.rings.push(l),e.windings.push(u)):e.windings[f]+=u}r.rings=null,r.windings=null,r.consumedBy=e,r.leftSE.consumedBy=e.leftSE,r.rightSE.consumedBy=e.rightSE}}prevInResult(){return this._prevInResult!==void 0?this._prevInResult:(this.prev?this.prev.isInResult()?this._prevInResult=this.prev:this._prevInResult=this.prev.prevInResult():this._prevInResult=null,this._prevInResult)}beforeState(){if(this._beforeState!==void 0)return this._beforeState;if(!this.prev)this._beforeState={rings:[],windings:[],multiPolys:[]};else{const t=this.prev.consumedBy||this.prev;this._beforeState=t.afterState()}return this._beforeState}afterState(){if(this._afterState!==void 0)return this._afterState;const t=this.beforeState();this._afterState={rings:t.rings.slice(0),windings:t.windings.slice(0),multiPolys:[]};const e=this._afterState.rings,r=this._afterState.windings,i=this._afterState.multiPolys;for(let l=0,u=this.rings.length;l<u;l++){const f=this.rings[l],d=this.windings[l],p=e.indexOf(f);p===-1?(e.push(f),r.push(d)):r[p]+=d}const s=[],o=[];for(let l=0,u=e.length;l<u;l++){if(r[l]===0)continue;const f=e[l],d=f.poly;if(o.indexOf(d)===-1)if(f.isExterior)s.push(d);else{o.indexOf(d)===-1&&o.push(d);const p=s.indexOf(f.poly);p!==-1&&s.splice(p,1)}}for(let l=0,u=s.length;l<u;l++){const f=s[l].multiPoly;i.indexOf(f)===-1&&i.push(f)}return this._afterState}isInResult(){if(this.consumedBy)return!1;if(this._isInResult!==void 0)return this._isInResult;const t=this.beforeState().multiPolys,e=this.afterState().multiPolys;switch(Jh.type){case"union":{const r=t.length===0,i=e.length===0;this._isInResult=r!==i;break}case"intersection":{let r,i;t.length<e.length?(r=t.length,i=e.length):(r=e.length,i=t.length),this._isInResult=i===Jh.numMultiPolys&&r<i;break}case"xor":{const r=Math.abs(t.length-e.length);this._isInResult=r%2===1;break}case"difference":{const r=i=>i.length===1&&i[0].isSubject;this._isInResult=r(t)!==r(e);break}}return this._isInResult}},_u=class{constructor(h,t,e){zt(this,"poly");zt(this,"isExterior");zt(this,"segments");zt(this,"bbox");if(!Array.isArray(h)||h.length===0)throw new Error("Input geometry is not a valid Polygon or MultiPolygon");if(this.poly=t,this.isExterior=e,this.segments=[],typeof h[0][0]!="number"||typeof h[0][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");const r=cn.snap({x:new Fi(h[0][0]),y:new Fi(h[0][1])});this.bbox={ll:{x:r.x,y:r.y},ur:{x:r.x,y:r.y}};let i=r;for(let s=1,o=h.length;s<o;s++){if(typeof h[s][0]!="number"||typeof h[s][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");const l=cn.snap({x:new Fi(h[s][0]),y:new Fi(h[s][1])});l.x.eq(i.x)&&l.y.eq(i.y)||(this.segments.push(ka.fromRing(i,l,this)),l.x.isLessThan(this.bbox.ll.x)&&(this.bbox.ll.x=l.x),l.y.isLessThan(this.bbox.ll.y)&&(this.bbox.ll.y=l.y),l.x.isGreaterThan(this.bbox.ur.x)&&(this.bbox.ur.x=l.x),l.y.isGreaterThan(this.bbox.ur.y)&&(this.bbox.ur.y=l.y),i=l)}(!r.x.eq(i.x)||!r.y.eq(i.y))&&this.segments.push(ka.fromRing(i,r,this))}getSweepEvents(){const h=[];for(let t=0,e=this.segments.length;t<e;t++){const r=this.segments[t];h.push(r.leftSE),h.push(r.rightSE)}return h}},Vp=class{constructor(h,t){zt(this,"multiPoly");zt(this,"exteriorRing");zt(this,"interiorRings");zt(this,"bbox");if(!Array.isArray(h))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");this.exteriorRing=new _u(h[0],this,!0),this.bbox={ll:{x:this.exteriorRing.bbox.ll.x,y:this.exteriorRing.bbox.ll.y},ur:{x:this.exteriorRing.bbox.ur.x,y:this.exteriorRing.bbox.ur.y}},this.interiorRings=[];for(let e=1,r=h.length;e<r;e++){const i=new _u(h[e],this,!1);i.bbox.ll.x.isLessThan(this.bbox.ll.x)&&(this.bbox.ll.x=i.bbox.ll.x),i.bbox.ll.y.isLessThan(this.bbox.ll.y)&&(this.bbox.ll.y=i.bbox.ll.y),i.bbox.ur.x.isGreaterThan(this.bbox.ur.x)&&(this.bbox.ur.x=i.bbox.ur.x),i.bbox.ur.y.isGreaterThan(this.bbox.ur.y)&&(this.bbox.ur.y=i.bbox.ur.y),this.interiorRings.push(i)}this.multiPoly=t}getSweepEvents(){const h=this.exteriorRing.getSweepEvents();for(let t=0,e=this.interiorRings.length;t<e;t++){const r=this.interiorRings[t].getSweepEvents();for(let i=0,s=r.length;i<s;i++)h.push(r[i])}return h}},gu=class{constructor(h,t){zt(this,"isSubject");zt(this,"polys");zt(this,"bbox");if(!Array.isArray(h))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");try{typeof h[0][0][0]=="number"&&(h=[h])}catch{}this.polys=[],this.bbox={ll:{x:new Fi(Number.POSITIVE_INFINITY),y:new Fi(Number.POSITIVE_INFINITY)},ur:{x:new Fi(Number.NEGATIVE_INFINITY),y:new Fi(Number.NEGATIVE_INFINITY)}};for(let e=0,r=h.length;e<r;e++){const i=new Vp(h[e],this);i.bbox.ll.x.isLessThan(this.bbox.ll.x)&&(this.bbox.ll.x=i.bbox.ll.x),i.bbox.ll.y.isLessThan(this.bbox.ll.y)&&(this.bbox.ll.y=i.bbox.ll.y),i.bbox.ur.x.isGreaterThan(this.bbox.ur.x)&&(this.bbox.ur.x=i.bbox.ur.x),i.bbox.ur.y.isGreaterThan(this.bbox.ur.y)&&(this.bbox.ur.y=i.bbox.ur.y),this.polys.push(i)}this.isSubject=t}getSweepEvents(){const h=[];for(let t=0,e=this.polys.length;t<e;t++){const r=this.polys[t].getSweepEvents();for(let i=0,s=r.length;i<s;i++)h.push(r[i])}return h}},qp=(h,...t)=>Jh.run("intersection",h,t);cn.set;function Yp(h,t,e={}){const r=ir(h),i=ir(t);i[0]+=i[0]-r[0]>180?-360:r[0]-i[0]>180?360:0;const s=jp(r,i);return Ep(s,"meters",e.units)}function jp(h,t,e){e=e===void 0?We:Number(e);const r=e,i=h[1]*Math.PI/180,s=t[1]*Math.PI/180,o=s-i;let l=Math.abs(t[0]-h[0])*Math.PI/180;l>Math.PI&&(l-=2*Math.PI);const u=Math.log(Math.tan(s/2+Math.PI/4)/Math.tan(i/2+Math.PI/4)),f=Math.abs(u)>1e-11?o/u:Math.cos(i);return Math.sqrt(o*o+f*f*l*l)*r}function Xp(h,t={}){const e=[];if(kp(h,i=>{e.push(i.coordinates)}),e.length<2)throw new Error("Must specify at least 2 geometries");const r=qp(e[0],...e.slice(1));return r.length===0?null:r.length===1?Na(r[0],t.properties):Uc(r,t.properties)}/**
 * @license
 * Copyright 2010-2024 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const xl="172",$h=0,Jp=1,jc=2,yu=1,vu=100,xu=204,wu=205,bu=3,$p=0,Xc=300,Kh=1e3,Zs=1001,Qh=1002,Kp=1003,Qp=1004,tm=1005,Jc=1006,em=1007,$c=1008,im=1009,nm=1015,Kc=1023,rm=2300,sm=2301,om=0,wl="",gi="srgb",Lu="srgb-linear",Mu="linear",fh="srgb",Ir=7680,Eu=519,Tu=35044,Vo=2e3,Su=2001;class Fa{addEventListener(t,e){this._listeners===void 0&&(this._listeners={});const r=this._listeners;r[t]===void 0&&(r[t]=[]),r[t].indexOf(e)===-1&&r[t].push(e)}hasEventListener(t,e){if(this._listeners===void 0)return!1;const r=this._listeners;return r[t]!==void 0&&r[t].indexOf(e)!==-1}removeEventListener(t,e){if(this._listeners===void 0)return;const i=this._listeners[t];if(i!==void 0){const s=i.indexOf(e);s!==-1&&i.splice(s,1)}}dispatchEvent(t){if(this._listeners===void 0)return;const r=this._listeners[t.type];if(r!==void 0){t.target=this;const i=r.slice(0);for(let s=0,o=i.length;s<o;s++)i[s].call(this,t);t.target=null}}}const ze=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let ku=1234567;const Qc=Math.PI/180,tf=180/Math.PI;function cr(){const h=Math.random()*4294967295|0,t=Math.random()*4294967295|0,e=Math.random()*4294967295|0,r=Math.random()*4294967295|0;return(ze[h&255]+ze[h>>8&255]+ze[h>>16&255]+ze[h>>24&255]+"-"+ze[t&255]+ze[t>>8&255]+"-"+ze[t>>16&15|64]+ze[t>>24&255]+"-"+ze[e&63|128]+ze[e>>8&255]+"-"+ze[e>>16&255]+ze[e>>24&255]+ze[r&255]+ze[r>>8&255]+ze[r>>16&255]+ze[r>>24&255]).toLowerCase()}function Ht(h,t,e){return Math.max(t,Math.min(e,h))}function bl(h,t){return(h%t+t)%t}function am(h,t,e,r,i){return r+(h-t)*(i-r)/(e-t)}function hm(h,t,e){return h!==t?(e-h)/(t-h):0}function Vs(h,t,e){return(1-e)*h+e*t}function lm(h,t,e,r){return Vs(h,t,1-Math.exp(-e*r))}function um(h,t=1){return t-Math.abs(bl(h,t*2)-t)}function cm(h,t,e){return h<=t?0:h>=e?1:(h=(h-t)/(e-t),h*h*(3-2*h))}function fm(h,t,e){return h<=t?0:h>=e?1:(h=(h-t)/(e-t),h*h*h*(h*(h*6-15)+10))}function dm(h,t){return h+Math.floor(Math.random()*(t-h+1))}function pm(h,t){return h+Math.random()*(t-h)}function mm(h){return h*(.5-Math.random())}function _m(h){h!==void 0&&(ku=h);let t=ku+=1831565813;return t=Math.imul(t^t>>>15,t|1),t^=t+Math.imul(t^t>>>7,t|61),((t^t>>>14)>>>0)/4294967296}function gm(h){return h*Qc}function ym(h){return h*tf}function vm(h){return(h&h-1)===0&&h!==0}function xm(h){return Math.pow(2,Math.ceil(Math.log(h)/Math.LN2))}function wm(h){return Math.pow(2,Math.floor(Math.log(h)/Math.LN2))}function bm(h,t,e,r,i){const s=Math.cos,o=Math.sin,l=s(e/2),u=o(e/2),f=s((t+r)/2),d=o((t+r)/2),p=s((t-r)/2),g=o((t-r)/2),m=s((r-t)/2),x=o((r-t)/2);switch(i){case"XYX":h.set(l*d,u*p,u*g,l*f);break;case"YZY":h.set(u*g,l*d,u*p,l*f);break;case"ZXZ":h.set(u*p,u*g,l*d,l*f);break;case"XZX":h.set(l*d,u*x,u*m,l*f);break;case"YXY":h.set(u*m,l*d,u*x,l*f);break;case"ZYZ":h.set(u*x,u*m,l*d,l*f);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+i)}}function Vr(h,t){switch(t.constructor){case Float32Array:return h;case Uint32Array:return h/4294967295;case Uint16Array:return h/65535;case Uint8Array:return h/255;case Int32Array:return Math.max(h/2147483647,-1);case Int16Array:return Math.max(h/32767,-1);case Int8Array:return Math.max(h/127,-1);default:throw new Error("Invalid component type.")}}function Be(h,t){switch(t.constructor){case Float32Array:return h;case Uint32Array:return Math.round(h*4294967295);case Uint16Array:return Math.round(h*65535);case Uint8Array:return Math.round(h*255);case Int32Array:return Math.round(h*2147483647);case Int16Array:return Math.round(h*32767);case Int8Array:return Math.round(h*127);default:throw new Error("Invalid component type.")}}const tl={DEG2RAD:Qc,RAD2DEG:tf,generateUUID:cr,clamp:Ht,euclideanModulo:bl,mapLinear:am,inverseLerp:hm,lerp:Vs,damp:lm,pingpong:um,smoothstep:cm,smootherstep:fm,randInt:dm,randFloat:pm,randFloatSpread:mm,seededRandom:_m,degToRad:gm,radToDeg:ym,isPowerOfTwo:vm,ceilPowerOfTwo:xm,floorPowerOfTwo:wm,setQuaternionFromProperEuler:bm,normalize:Be,denormalize:Vr};class Pt{constructor(t=0,e=0){Pt.prototype.isVector2=!0,this.x=t,this.y=e}get width(){return this.x}set width(t){this.x=t}get height(){return this.y}set height(t){this.y=t}set(t,e){return this.x=t,this.y=e,this}setScalar(t){return this.x=t,this.y=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setComponent(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y)}copy(t){return this.x=t.x,this.y=t.y,this}add(t){return this.x+=t.x,this.y+=t.y,this}addScalar(t){return this.x+=t,this.y+=t,this}addVectors(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this}addScaledVector(t,e){return this.x+=t.x*e,this.y+=t.y*e,this}sub(t){return this.x-=t.x,this.y-=t.y,this}subScalar(t){return this.x-=t,this.y-=t,this}subVectors(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this}multiply(t){return this.x*=t.x,this.y*=t.y,this}multiplyScalar(t){return this.x*=t,this.y*=t,this}divide(t){return this.x/=t.x,this.y/=t.y,this}divideScalar(t){return this.multiplyScalar(1/t)}applyMatrix3(t){const e=this.x,r=this.y,i=t.elements;return this.x=i[0]*e+i[3]*r+i[6],this.y=i[1]*e+i[4]*r+i[7],this}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this}clamp(t,e){return this.x=Ht(this.x,t.x,e.x),this.y=Ht(this.y,t.y,e.y),this}clampScalar(t,e){return this.x=Ht(this.x,t,e),this.y=Ht(this.y,t,e),this}clampLength(t,e){const r=this.length();return this.divideScalar(r||1).multiplyScalar(Ht(r,t,e))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(t){return this.x*t.x+this.y*t.y}cross(t){return this.x*t.y-this.y*t.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(t){const e=Math.sqrt(this.lengthSq()*t.lengthSq());if(e===0)return Math.PI/2;const r=this.dot(t)/e;return Math.acos(Ht(r,-1,1))}distanceTo(t){return Math.sqrt(this.distanceToSquared(t))}distanceToSquared(t){const e=this.x-t.x,r=this.y-t.y;return e*e+r*r}manhattanDistanceTo(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this}lerpVectors(t,e,r){return this.x=t.x+(e.x-t.x)*r,this.y=t.y+(e.y-t.y)*r,this}equals(t){return t.x===this.x&&t.y===this.y}fromArray(t,e=0){return this.x=t[e],this.y=t[e+1],this}toArray(t=[],e=0){return t[e]=this.x,t[e+1]=this.y,t}fromBufferAttribute(t,e){return this.x=t.getX(e),this.y=t.getY(e),this}rotateAround(t,e){const r=Math.cos(e),i=Math.sin(e),s=this.x-t.x,o=this.y-t.y;return this.x=s*r-o*i+t.x,this.y=s*i+o*r+t.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class Bn{constructor(t,e,r,i,s,o,l,u,f){Bn.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],t!==void 0&&this.set(t,e,r,i,s,o,l,u,f)}set(t,e,r,i,s,o,l,u,f){const d=this.elements;return d[0]=t,d[1]=i,d[2]=l,d[3]=e,d[4]=s,d[5]=u,d[6]=r,d[7]=o,d[8]=f,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(t){const e=this.elements,r=t.elements;return e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=r[3],e[4]=r[4],e[5]=r[5],e[6]=r[6],e[7]=r[7],e[8]=r[8],this}extractBasis(t,e,r){return t.setFromMatrix3Column(this,0),e.setFromMatrix3Column(this,1),r.setFromMatrix3Column(this,2),this}setFromMatrix4(t){const e=t.elements;return this.set(e[0],e[4],e[8],e[1],e[5],e[9],e[2],e[6],e[10]),this}multiply(t){return this.multiplyMatrices(this,t)}premultiply(t){return this.multiplyMatrices(t,this)}multiplyMatrices(t,e){const r=t.elements,i=e.elements,s=this.elements,o=r[0],l=r[3],u=r[6],f=r[1],d=r[4],p=r[7],g=r[2],m=r[5],x=r[8],y=i[0],b=i[3],P=i[6],A=i[1],N=i[4],G=i[7],z=i[2],K=i[5],q=i[8];return s[0]=o*y+l*A+u*z,s[3]=o*b+l*N+u*K,s[6]=o*P+l*G+u*q,s[1]=f*y+d*A+p*z,s[4]=f*b+d*N+p*K,s[7]=f*P+d*G+p*q,s[2]=g*y+m*A+x*z,s[5]=g*b+m*N+x*K,s[8]=g*P+m*G+x*q,this}multiplyScalar(t){const e=this.elements;return e[0]*=t,e[3]*=t,e[6]*=t,e[1]*=t,e[4]*=t,e[7]*=t,e[2]*=t,e[5]*=t,e[8]*=t,this}determinant(){const t=this.elements,e=t[0],r=t[1],i=t[2],s=t[3],o=t[4],l=t[5],u=t[6],f=t[7],d=t[8];return e*o*d-e*l*f-r*s*d+r*l*u+i*s*f-i*o*u}invert(){const t=this.elements,e=t[0],r=t[1],i=t[2],s=t[3],o=t[4],l=t[5],u=t[6],f=t[7],d=t[8],p=d*o-l*f,g=l*u-d*s,m=f*s-o*u,x=e*p+r*g+i*m;if(x===0)return this.set(0,0,0,0,0,0,0,0,0);const y=1/x;return t[0]=p*y,t[1]=(i*f-d*r)*y,t[2]=(l*r-i*o)*y,t[3]=g*y,t[4]=(d*e-i*u)*y,t[5]=(i*s-l*e)*y,t[6]=m*y,t[7]=(r*u-f*e)*y,t[8]=(o*e-r*s)*y,this}transpose(){let t;const e=this.elements;return t=e[1],e[1]=e[3],e[3]=t,t=e[2],e[2]=e[6],e[6]=t,t=e[5],e[5]=e[7],e[7]=t,this}getNormalMatrix(t){return this.setFromMatrix4(t).invert().transpose()}transposeIntoArray(t){const e=this.elements;return t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8],this}setUvTransform(t,e,r,i,s,o,l){const u=Math.cos(s),f=Math.sin(s);return this.set(r*u,r*f,-r*(u*o+f*l)+o+t,-i*f,i*u,-i*(-f*o+u*l)+l+e,0,0,1),this}scale(t,e){return this.premultiply(dh.makeScale(t,e)),this}rotate(t){return this.premultiply(dh.makeRotation(-t)),this}translate(t,e){return this.premultiply(dh.makeTranslation(t,e)),this}makeTranslation(t,e){return t.isVector2?this.set(1,0,t.x,0,1,t.y,0,0,1):this.set(1,0,t,0,1,e,0,0,1),this}makeRotation(t){const e=Math.cos(t),r=Math.sin(t);return this.set(e,-r,0,r,e,0,0,0,1),this}makeScale(t,e){return this.set(t,0,0,0,e,0,0,0,1),this}equals(t){const e=this.elements,r=t.elements;for(let i=0;i<9;i++)if(e[i]!==r[i])return!1;return!0}fromArray(t,e=0){for(let r=0;r<9;r++)this.elements[r]=t[r+e];return this}toArray(t=[],e=0){const r=this.elements;return t[e]=r[0],t[e+1]=r[1],t[e+2]=r[2],t[e+3]=r[3],t[e+4]=r[4],t[e+5]=r[5],t[e+6]=r[6],t[e+7]=r[7],t[e+8]=r[8],t}clone(){return new this.constructor().fromArray(this.elements)}}const dh=new Bn;function Lm(h){for(let t=h.length-1;t>=0;--t)if(h[t]>=65535)return!0;return!1}function Au(h){return document.createElementNS("http://www.w3.org/1999/xhtml",h)}const Pu=new Bn().set(.4123908,.3575843,.1804808,.212639,.7151687,.0721923,.0193308,.1191948,.9505322),Cu=new Bn().set(3.2409699,-1.5373832,-.4986108,-.9692436,1.8759675,.0415551,.0556301,-.203977,1.0569715);function Mm(){const h={enabled:!0,workingColorSpace:Lu,spaces:{},convert:function(i,s,o){return this.enabled===!1||s===o||!s||!o||(this.spaces[s].transfer===fh&&(i.r=un(i.r),i.g=un(i.g),i.b=un(i.b)),this.spaces[s].primaries!==this.spaces[o].primaries&&(i.applyMatrix3(this.spaces[s].toXYZ),i.applyMatrix3(this.spaces[o].fromXYZ)),this.spaces[o].transfer===fh&&(i.r=Kr(i.r),i.g=Kr(i.g),i.b=Kr(i.b))),i},fromWorkingColorSpace:function(i,s){return this.convert(i,this.workingColorSpace,s)},toWorkingColorSpace:function(i,s){return this.convert(i,s,this.workingColorSpace)},getPrimaries:function(i){return this.spaces[i].primaries},getTransfer:function(i){return i===wl?Mu:this.spaces[i].transfer},getLuminanceCoefficients:function(i,s=this.workingColorSpace){return i.fromArray(this.spaces[s].luminanceCoefficients)},define:function(i){Object.assign(this.spaces,i)},_getMatrix:function(i,s,o){return i.copy(this.spaces[s].toXYZ).multiply(this.spaces[o].fromXYZ)},_getDrawingBufferColorSpace:function(i){return this.spaces[i].outputColorSpaceConfig.drawingBufferColorSpace},_getUnpackColorSpace:function(i=this.workingColorSpace){return this.spaces[i].workingColorSpaceConfig.unpackColorSpace}},t=[.64,.33,.3,.6,.15,.06],e=[.2126,.7152,.0722],r=[.3127,.329];return h.define({[Lu]:{primaries:t,whitePoint:r,transfer:Mu,toXYZ:Pu,fromXYZ:Cu,luminanceCoefficients:e,workingColorSpaceConfig:{unpackColorSpace:gi},outputColorSpaceConfig:{drawingBufferColorSpace:gi}},[gi]:{primaries:t,whitePoint:r,transfer:fh,toXYZ:Pu,fromXYZ:Cu,luminanceCoefficients:e,outputColorSpaceConfig:{drawingBufferColorSpace:gi}}}),h}const Ei=Mm();function un(h){return h<.04045?h*.0773993808:Math.pow(h*.9478672986+.0521327014,2.4)}function Kr(h){return h<.0031308?h*12.92:1.055*Math.pow(h,.41666)-.055}let Or;class Em{static getDataURL(t){if(/^data:/i.test(t.src)||typeof HTMLCanvasElement>"u")return t.src;let e;if(t instanceof HTMLCanvasElement)e=t;else{Or===void 0&&(Or=Au("canvas")),Or.width=t.width,Or.height=t.height;const r=Or.getContext("2d");t instanceof ImageData?r.putImageData(t,0,0):r.drawImage(t,0,0,t.width,t.height),e=Or}return e.width>2048||e.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",t),e.toDataURL("image/jpeg",.6)):e.toDataURL("image/png")}static sRGBToLinear(t){if(typeof HTMLImageElement<"u"&&t instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&t instanceof ImageBitmap){const e=Au("canvas");e.width=t.width,e.height=t.height;const r=e.getContext("2d");r.drawImage(t,0,0,t.width,t.height);const i=r.getImageData(0,0,t.width,t.height),s=i.data;for(let o=0;o<s.length;o++)s[o]=un(s[o]/255)*255;return r.putImageData(i,0,0),e}else if(t.data){const e=t.data.slice(0);for(let r=0;r<e.length;r++)e instanceof Uint8Array||e instanceof Uint8ClampedArray?e[r]=Math.floor(un(e[r]/255)*255):e[r]=un(e[r]);return{data:e,width:t.width,height:t.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),t}}let Tm=0;class ef{constructor(t=null){this.isSource=!0,Object.defineProperty(this,"id",{value:Tm++}),this.uuid=cr(),this.data=t,this.dataReady=!0,this.version=0}set needsUpdate(t){t===!0&&this.version++}toJSON(t){const e=t===void 0||typeof t=="string";if(!e&&t.images[this.uuid]!==void 0)return t.images[this.uuid];const r={uuid:this.uuid,url:""},i=this.data;if(i!==null){let s;if(Array.isArray(i)){s=[];for(let o=0,l=i.length;o<l;o++)i[o].isDataTexture?s.push(ph(i[o].image)):s.push(ph(i[o]))}else s=ph(i);r.url=s}return e||(t.images[this.uuid]=r),r}}function ph(h){return typeof HTMLImageElement<"u"&&h instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&h instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&h instanceof ImageBitmap?Em.getDataURL(h):h.data?{data:Array.from(h.data),width:h.width,height:h.height,type:h.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let Sm=0;class Cn extends Fa{constructor(t=Cn.DEFAULT_IMAGE,e=Cn.DEFAULT_MAPPING,r=Zs,i=Zs,s=Jc,o=$c,l=Kc,u=im,f=Cn.DEFAULT_ANISOTROPY,d=wl){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:Sm++}),this.uuid=cr(),this.name="",this.source=new ef(t),this.mipmaps=[],this.mapping=e,this.channel=0,this.wrapS=r,this.wrapT=i,this.magFilter=s,this.minFilter=o,this.anisotropy=f,this.format=l,this.internalFormat=null,this.type=u,this.offset=new Pt(0,0),this.repeat=new Pt(1,1),this.center=new Pt(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Bn,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.colorSpace=d,this.userData={},this.version=0,this.onUpdate=null,this.renderTarget=null,this.isRenderTargetTexture=!1,this.pmremVersion=0}get image(){return this.source.data}set image(t=null){this.source.data=t}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(t){return this.name=t.name,this.source=t.source,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.channel=t.channel,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.internalFormat=t.internalFormat,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.center.copy(t.center),this.rotation=t.rotation,this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrix.copy(t.matrix),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.colorSpace=t.colorSpace,this.renderTarget=t.renderTarget,this.isRenderTargetTexture=t.isRenderTargetTexture,this.userData=JSON.parse(JSON.stringify(t.userData)),this.needsUpdate=!0,this}toJSON(t){const e=t===void 0||typeof t=="string";if(!e&&t.textures[this.uuid]!==void 0)return t.textures[this.uuid];const r={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(t).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(r.userData=this.userData),e||(t.textures[this.uuid]=r),r}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(t){if(this.mapping!==Xc)return t;if(t.applyMatrix3(this.matrix),t.x<0||t.x>1)switch(this.wrapS){case Kh:t.x=t.x-Math.floor(t.x);break;case Zs:t.x=t.x<0?0:1;break;case Qh:Math.abs(Math.floor(t.x)%2)===1?t.x=Math.ceil(t.x)-t.x:t.x=t.x-Math.floor(t.x);break}if(t.y<0||t.y>1)switch(this.wrapT){case Kh:t.y=t.y-Math.floor(t.y);break;case Zs:t.y=t.y<0?0:1;break;case Qh:Math.abs(Math.floor(t.y)%2)===1?t.y=Math.ceil(t.y)-t.y:t.y=t.y-Math.floor(t.y);break}return this.flipY&&(t.y=1-t.y),t}set needsUpdate(t){t===!0&&(this.version++,this.source.needsUpdate=!0)}set needsPMREMUpdate(t){t===!0&&this.pmremVersion++}}Cn.DEFAULT_IMAGE=null;Cn.DEFAULT_MAPPING=Xc;Cn.DEFAULT_ANISOTROPY=1;class no{constructor(t=0,e=0,r=0,i=1){no.prototype.isVector4=!0,this.x=t,this.y=e,this.z=r,this.w=i}get width(){return this.z}set width(t){this.z=t}get height(){return this.w}set height(t){this.w=t}set(t,e,r,i){return this.x=t,this.y=e,this.z=r,this.w=i,this}setScalar(t){return this.x=t,this.y=t,this.z=t,this.w=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setZ(t){return this.z=t,this}setW(t){return this.w=t,this}setComponent(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;case 3:this.w=e;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=t.w!==void 0?t.w:1,this}add(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this}addScalar(t){return this.x+=t,this.y+=t,this.z+=t,this.w+=t,this}addVectors(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this.w=t.w+e.w,this}addScaledVector(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this.w+=t.w*e,this}sub(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this}subScalar(t){return this.x-=t,this.y-=t,this.z-=t,this.w-=t,this}subVectors(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this.w=t.w-e.w,this}multiply(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z,this.w*=t.w,this}multiplyScalar(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this}applyMatrix4(t){const e=this.x,r=this.y,i=this.z,s=this.w,o=t.elements;return this.x=o[0]*e+o[4]*r+o[8]*i+o[12]*s,this.y=o[1]*e+o[5]*r+o[9]*i+o[13]*s,this.z=o[2]*e+o[6]*r+o[10]*i+o[14]*s,this.w=o[3]*e+o[7]*r+o[11]*i+o[15]*s,this}divide(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this.w/=t.w,this}divideScalar(t){return this.multiplyScalar(1/t)}setAxisAngleFromQuaternion(t){this.w=2*Math.acos(t.w);const e=Math.sqrt(1-t.w*t.w);return e<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=t.x/e,this.y=t.y/e,this.z=t.z/e),this}setAxisAngleFromRotationMatrix(t){let e,r,i,s;const u=t.elements,f=u[0],d=u[4],p=u[8],g=u[1],m=u[5],x=u[9],y=u[2],b=u[6],P=u[10];if(Math.abs(d-g)<.01&&Math.abs(p-y)<.01&&Math.abs(x-b)<.01){if(Math.abs(d+g)<.1&&Math.abs(p+y)<.1&&Math.abs(x+b)<.1&&Math.abs(f+m+P-3)<.1)return this.set(1,0,0,0),this;e=Math.PI;const N=(f+1)/2,G=(m+1)/2,z=(P+1)/2,K=(d+g)/4,q=(p+y)/4,T=(x+b)/4;return N>G&&N>z?N<.01?(r=0,i=.707106781,s=.707106781):(r=Math.sqrt(N),i=K/r,s=q/r):G>z?G<.01?(r=.707106781,i=0,s=.707106781):(i=Math.sqrt(G),r=K/i,s=T/i):z<.01?(r=.707106781,i=.707106781,s=0):(s=Math.sqrt(z),r=q/s,i=T/s),this.set(r,i,s,e),this}let A=Math.sqrt((b-x)*(b-x)+(p-y)*(p-y)+(g-d)*(g-d));return Math.abs(A)<.001&&(A=1),this.x=(b-x)/A,this.y=(p-y)/A,this.z=(g-d)/A,this.w=Math.acos((f+m+P-1)/2),this}setFromMatrixPosition(t){const e=t.elements;return this.x=e[12],this.y=e[13],this.z=e[14],this.w=e[15],this}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this.w=Math.min(this.w,t.w),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this.w=Math.max(this.w,t.w),this}clamp(t,e){return this.x=Ht(this.x,t.x,e.x),this.y=Ht(this.y,t.y,e.y),this.z=Ht(this.z,t.z,e.z),this.w=Ht(this.w,t.w,e.w),this}clampScalar(t,e){return this.x=Ht(this.x,t,e),this.y=Ht(this.y,t,e),this.z=Ht(this.z,t,e),this.w=Ht(this.w,t,e),this}clampLength(t,e){const r=this.length();return this.divideScalar(r||1).multiplyScalar(Ht(r,t,e))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this.w+=(t.w-this.w)*e,this}lerpVectors(t,e,r){return this.x=t.x+(e.x-t.x)*r,this.y=t.y+(e.y-t.y)*r,this.z=t.z+(e.z-t.z)*r,this.w=t.w+(e.w-t.w)*r,this}equals(t){return t.x===this.x&&t.y===this.y&&t.z===this.z&&t.w===this.w}fromArray(t,e=0){return this.x=t[e],this.y=t[e+1],this.z=t[e+2],this.w=t[e+3],this}toArray(t=[],e=0){return t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t[e+3]=this.w,t}fromBufferAttribute(t,e){return this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this.w=t.getW(e),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class rs{constructor(t=0,e=0,r=0,i=1){this.isQuaternion=!0,this._x=t,this._y=e,this._z=r,this._w=i}static slerpFlat(t,e,r,i,s,o,l){let u=r[i+0],f=r[i+1],d=r[i+2],p=r[i+3];const g=s[o+0],m=s[o+1],x=s[o+2],y=s[o+3];if(l===0){t[e+0]=u,t[e+1]=f,t[e+2]=d,t[e+3]=p;return}if(l===1){t[e+0]=g,t[e+1]=m,t[e+2]=x,t[e+3]=y;return}if(p!==y||u!==g||f!==m||d!==x){let b=1-l;const P=u*g+f*m+d*x+p*y,A=P>=0?1:-1,N=1-P*P;if(N>Number.EPSILON){const z=Math.sqrt(N),K=Math.atan2(z,P*A);b=Math.sin(b*K)/z,l=Math.sin(l*K)/z}const G=l*A;if(u=u*b+g*G,f=f*b+m*G,d=d*b+x*G,p=p*b+y*G,b===1-l){const z=1/Math.sqrt(u*u+f*f+d*d+p*p);u*=z,f*=z,d*=z,p*=z}}t[e]=u,t[e+1]=f,t[e+2]=d,t[e+3]=p}static multiplyQuaternionsFlat(t,e,r,i,s,o){const l=r[i],u=r[i+1],f=r[i+2],d=r[i+3],p=s[o],g=s[o+1],m=s[o+2],x=s[o+3];return t[e]=l*x+d*p+u*m-f*g,t[e+1]=u*x+d*g+f*p-l*m,t[e+2]=f*x+d*m+l*g-u*p,t[e+3]=d*x-l*p-u*g-f*m,t}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get w(){return this._w}set w(t){this._w=t,this._onChangeCallback()}set(t,e,r,i){return this._x=t,this._y=e,this._z=r,this._w=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(t){return this._x=t.x,this._y=t.y,this._z=t.z,this._w=t.w,this._onChangeCallback(),this}setFromEuler(t,e=!0){const r=t._x,i=t._y,s=t._z,o=t._order,l=Math.cos,u=Math.sin,f=l(r/2),d=l(i/2),p=l(s/2),g=u(r/2),m=u(i/2),x=u(s/2);switch(o){case"XYZ":this._x=g*d*p+f*m*x,this._y=f*m*p-g*d*x,this._z=f*d*x+g*m*p,this._w=f*d*p-g*m*x;break;case"YXZ":this._x=g*d*p+f*m*x,this._y=f*m*p-g*d*x,this._z=f*d*x-g*m*p,this._w=f*d*p+g*m*x;break;case"ZXY":this._x=g*d*p-f*m*x,this._y=f*m*p+g*d*x,this._z=f*d*x+g*m*p,this._w=f*d*p-g*m*x;break;case"ZYX":this._x=g*d*p-f*m*x,this._y=f*m*p+g*d*x,this._z=f*d*x-g*m*p,this._w=f*d*p+g*m*x;break;case"YZX":this._x=g*d*p+f*m*x,this._y=f*m*p+g*d*x,this._z=f*d*x-g*m*p,this._w=f*d*p-g*m*x;break;case"XZY":this._x=g*d*p-f*m*x,this._y=f*m*p-g*d*x,this._z=f*d*x+g*m*p,this._w=f*d*p+g*m*x;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+o)}return e===!0&&this._onChangeCallback(),this}setFromAxisAngle(t,e){const r=e/2,i=Math.sin(r);return this._x=t.x*i,this._y=t.y*i,this._z=t.z*i,this._w=Math.cos(r),this._onChangeCallback(),this}setFromRotationMatrix(t){const e=t.elements,r=e[0],i=e[4],s=e[8],o=e[1],l=e[5],u=e[9],f=e[2],d=e[6],p=e[10],g=r+l+p;if(g>0){const m=.5/Math.sqrt(g+1);this._w=.25/m,this._x=(d-u)*m,this._y=(s-f)*m,this._z=(o-i)*m}else if(r>l&&r>p){const m=2*Math.sqrt(1+r-l-p);this._w=(d-u)/m,this._x=.25*m,this._y=(i+o)/m,this._z=(s+f)/m}else if(l>p){const m=2*Math.sqrt(1+l-r-p);this._w=(s-f)/m,this._x=(i+o)/m,this._y=.25*m,this._z=(u+d)/m}else{const m=2*Math.sqrt(1+p-r-l);this._w=(o-i)/m,this._x=(s+f)/m,this._y=(u+d)/m,this._z=.25*m}return this._onChangeCallback(),this}setFromUnitVectors(t,e){let r=t.dot(e)+1;return r<Number.EPSILON?(r=0,Math.abs(t.x)>Math.abs(t.z)?(this._x=-t.y,this._y=t.x,this._z=0,this._w=r):(this._x=0,this._y=-t.z,this._z=t.y,this._w=r)):(this._x=t.y*e.z-t.z*e.y,this._y=t.z*e.x-t.x*e.z,this._z=t.x*e.y-t.y*e.x,this._w=r),this.normalize()}angleTo(t){return 2*Math.acos(Math.abs(Ht(this.dot(t),-1,1)))}rotateTowards(t,e){const r=this.angleTo(t);if(r===0)return this;const i=Math.min(1,e/r);return this.slerp(t,i),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(t){return this._x*t._x+this._y*t._y+this._z*t._z+this._w*t._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let t=this.length();return t===0?(this._x=0,this._y=0,this._z=0,this._w=1):(t=1/t,this._x=this._x*t,this._y=this._y*t,this._z=this._z*t,this._w=this._w*t),this._onChangeCallback(),this}multiply(t){return this.multiplyQuaternions(this,t)}premultiply(t){return this.multiplyQuaternions(t,this)}multiplyQuaternions(t,e){const r=t._x,i=t._y,s=t._z,o=t._w,l=e._x,u=e._y,f=e._z,d=e._w;return this._x=r*d+o*l+i*f-s*u,this._y=i*d+o*u+s*l-r*f,this._z=s*d+o*f+r*u-i*l,this._w=o*d-r*l-i*u-s*f,this._onChangeCallback(),this}slerp(t,e){if(e===0)return this;if(e===1)return this.copy(t);const r=this._x,i=this._y,s=this._z,o=this._w;let l=o*t._w+r*t._x+i*t._y+s*t._z;if(l<0?(this._w=-t._w,this._x=-t._x,this._y=-t._y,this._z=-t._z,l=-l):this.copy(t),l>=1)return this._w=o,this._x=r,this._y=i,this._z=s,this;const u=1-l*l;if(u<=Number.EPSILON){const m=1-e;return this._w=m*o+e*this._w,this._x=m*r+e*this._x,this._y=m*i+e*this._y,this._z=m*s+e*this._z,this.normalize(),this}const f=Math.sqrt(u),d=Math.atan2(f,l),p=Math.sin((1-e)*d)/f,g=Math.sin(e*d)/f;return this._w=o*p+this._w*g,this._x=r*p+this._x*g,this._y=i*p+this._y*g,this._z=s*p+this._z*g,this._onChangeCallback(),this}slerpQuaternions(t,e,r){return this.copy(t).slerp(e,r)}random(){const t=2*Math.PI*Math.random(),e=2*Math.PI*Math.random(),r=Math.random(),i=Math.sqrt(1-r),s=Math.sqrt(r);return this.set(i*Math.sin(t),i*Math.cos(t),s*Math.sin(e),s*Math.cos(e))}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._w===this._w}fromArray(t,e=0){return this._x=t[e],this._y=t[e+1],this._z=t[e+2],this._w=t[e+3],this._onChangeCallback(),this}toArray(t=[],e=0){return t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._w,t}fromBufferAttribute(t,e){return this._x=t.getX(e),this._y=t.getY(e),this._z=t.getZ(e),this._w=t.getW(e),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class ut{constructor(t=0,e=0,r=0){ut.prototype.isVector3=!0,this.x=t,this.y=e,this.z=r}set(t,e,r){return r===void 0&&(r=this.z),this.x=t,this.y=e,this.z=r,this}setScalar(t){return this.x=t,this.y=t,this.z=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setZ(t){return this.z=t,this}setComponent(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(t){return this.x=t.x,this.y=t.y,this.z=t.z,this}add(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this}addScalar(t){return this.x+=t,this.y+=t,this.z+=t,this}addVectors(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this}addScaledVector(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this}sub(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this}subScalar(t){return this.x-=t,this.y-=t,this.z-=t,this}subVectors(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this}multiply(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z,this}multiplyScalar(t){return this.x*=t,this.y*=t,this.z*=t,this}multiplyVectors(t,e){return this.x=t.x*e.x,this.y=t.y*e.y,this.z=t.z*e.z,this}applyEuler(t){return this.applyQuaternion(zu.setFromEuler(t))}applyAxisAngle(t,e){return this.applyQuaternion(zu.setFromAxisAngle(t,e))}applyMatrix3(t){const e=this.x,r=this.y,i=this.z,s=t.elements;return this.x=s[0]*e+s[3]*r+s[6]*i,this.y=s[1]*e+s[4]*r+s[7]*i,this.z=s[2]*e+s[5]*r+s[8]*i,this}applyNormalMatrix(t){return this.applyMatrix3(t).normalize()}applyMatrix4(t){const e=this.x,r=this.y,i=this.z,s=t.elements,o=1/(s[3]*e+s[7]*r+s[11]*i+s[15]);return this.x=(s[0]*e+s[4]*r+s[8]*i+s[12])*o,this.y=(s[1]*e+s[5]*r+s[9]*i+s[13])*o,this.z=(s[2]*e+s[6]*r+s[10]*i+s[14])*o,this}applyQuaternion(t){const e=this.x,r=this.y,i=this.z,s=t.x,o=t.y,l=t.z,u=t.w,f=2*(o*i-l*r),d=2*(l*e-s*i),p=2*(s*r-o*e);return this.x=e+u*f+o*p-l*d,this.y=r+u*d+l*f-s*p,this.z=i+u*p+s*d-o*f,this}project(t){return this.applyMatrix4(t.matrixWorldInverse).applyMatrix4(t.projectionMatrix)}unproject(t){return this.applyMatrix4(t.projectionMatrixInverse).applyMatrix4(t.matrixWorld)}transformDirection(t){const e=this.x,r=this.y,i=this.z,s=t.elements;return this.x=s[0]*e+s[4]*r+s[8]*i,this.y=s[1]*e+s[5]*r+s[9]*i,this.z=s[2]*e+s[6]*r+s[10]*i,this.normalize()}divide(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this}divideScalar(t){return this.multiplyScalar(1/t)}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this}clamp(t,e){return this.x=Ht(this.x,t.x,e.x),this.y=Ht(this.y,t.y,e.y),this.z=Ht(this.z,t.z,e.z),this}clampScalar(t,e){return this.x=Ht(this.x,t,e),this.y=Ht(this.y,t,e),this.z=Ht(this.z,t,e),this}clampLength(t,e){const r=this.length();return this.divideScalar(r||1).multiplyScalar(Ht(r,t,e))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this}lerpVectors(t,e,r){return this.x=t.x+(e.x-t.x)*r,this.y=t.y+(e.y-t.y)*r,this.z=t.z+(e.z-t.z)*r,this}cross(t){return this.crossVectors(this,t)}crossVectors(t,e){const r=t.x,i=t.y,s=t.z,o=e.x,l=e.y,u=e.z;return this.x=i*u-s*l,this.y=s*o-r*u,this.z=r*l-i*o,this}projectOnVector(t){const e=t.lengthSq();if(e===0)return this.set(0,0,0);const r=t.dot(this)/e;return this.copy(t).multiplyScalar(r)}projectOnPlane(t){return mh.copy(this).projectOnVector(t),this.sub(mh)}reflect(t){return this.sub(mh.copy(t).multiplyScalar(2*this.dot(t)))}angleTo(t){const e=Math.sqrt(this.lengthSq()*t.lengthSq());if(e===0)return Math.PI/2;const r=this.dot(t)/e;return Math.acos(Ht(r,-1,1))}distanceTo(t){return Math.sqrt(this.distanceToSquared(t))}distanceToSquared(t){const e=this.x-t.x,r=this.y-t.y,i=this.z-t.z;return e*e+r*r+i*i}manhattanDistanceTo(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)}setFromSpherical(t){return this.setFromSphericalCoords(t.radius,t.phi,t.theta)}setFromSphericalCoords(t,e,r){const i=Math.sin(e)*t;return this.x=i*Math.sin(r),this.y=Math.cos(e)*t,this.z=i*Math.cos(r),this}setFromCylindrical(t){return this.setFromCylindricalCoords(t.radius,t.theta,t.y)}setFromCylindricalCoords(t,e,r){return this.x=t*Math.sin(e),this.y=r,this.z=t*Math.cos(e),this}setFromMatrixPosition(t){const e=t.elements;return this.x=e[12],this.y=e[13],this.z=e[14],this}setFromMatrixScale(t){const e=this.setFromMatrixColumn(t,0).length(),r=this.setFromMatrixColumn(t,1).length(),i=this.setFromMatrixColumn(t,2).length();return this.x=e,this.y=r,this.z=i,this}setFromMatrixColumn(t,e){return this.fromArray(t.elements,e*4)}setFromMatrix3Column(t,e){return this.fromArray(t.elements,e*3)}setFromEuler(t){return this.x=t._x,this.y=t._y,this.z=t._z,this}setFromColor(t){return this.x=t.r,this.y=t.g,this.z=t.b,this}equals(t){return t.x===this.x&&t.y===this.y&&t.z===this.z}fromArray(t,e=0){return this.x=t[e],this.y=t[e+1],this.z=t[e+2],this}toArray(t=[],e=0){return t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t}fromBufferAttribute(t,e){return this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const t=Math.random()*Math.PI*2,e=Math.random()*2-1,r=Math.sqrt(1-e*e);return this.x=r*Math.cos(t),this.y=e,this.z=r*Math.sin(t),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const mh=new ut,zu=new rs;class ro{constructor(t=new ut(1/0,1/0,1/0),e=new ut(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=t,this.max=e}set(t,e){return this.min.copy(t),this.max.copy(e),this}setFromArray(t){this.makeEmpty();for(let e=0,r=t.length;e<r;e+=3)this.expandByPoint(Ti.fromArray(t,e));return this}setFromBufferAttribute(t){this.makeEmpty();for(let e=0,r=t.count;e<r;e++)this.expandByPoint(Ti.fromBufferAttribute(t,e));return this}setFromPoints(t){this.makeEmpty();for(let e=0,r=t.length;e<r;e++)this.expandByPoint(t[e]);return this}setFromCenterAndSize(t,e){const r=Ti.copy(e).multiplyScalar(.5);return this.min.copy(t).sub(r),this.max.copy(t).add(r),this}setFromObject(t,e=!1){return this.makeEmpty(),this.expandByObject(t,e)}clone(){return new this.constructor().copy(this)}copy(t){return this.min.copy(t.min),this.max.copy(t.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(t){return this.isEmpty()?t.set(0,0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(t){return this.isEmpty()?t.set(0,0,0):t.subVectors(this.max,this.min)}expandByPoint(t){return this.min.min(t),this.max.max(t),this}expandByVector(t){return this.min.sub(t),this.max.add(t),this}expandByScalar(t){return this.min.addScalar(-t),this.max.addScalar(t),this}expandByObject(t,e=!1){t.updateWorldMatrix(!1,!1);const r=t.geometry;if(r!==void 0){const s=r.getAttribute("position");if(e===!0&&s!==void 0&&t.isInstancedMesh!==!0)for(let o=0,l=s.count;o<l;o++)t.isMesh===!0?t.getVertexPosition(o,Ti):Ti.fromBufferAttribute(s,o),Ti.applyMatrix4(t.matrixWorld),this.expandByPoint(Ti);else t.boundingBox!==void 0?(t.boundingBox===null&&t.computeBoundingBox(),qo.copy(t.boundingBox)):(r.boundingBox===null&&r.computeBoundingBox(),qo.copy(r.boundingBox)),qo.applyMatrix4(t.matrixWorld),this.union(qo)}const i=t.children;for(let s=0,o=i.length;s<o;s++)this.expandByObject(i[s],e);return this}containsPoint(t){return t.x>=this.min.x&&t.x<=this.max.x&&t.y>=this.min.y&&t.y<=this.max.y&&t.z>=this.min.z&&t.z<=this.max.z}containsBox(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y&&this.min.z<=t.min.z&&t.max.z<=this.max.z}getParameter(t,e){return e.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y),(t.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(t){return t.max.x>=this.min.x&&t.min.x<=this.max.x&&t.max.y>=this.min.y&&t.min.y<=this.max.y&&t.max.z>=this.min.z&&t.min.z<=this.max.z}intersectsSphere(t){return this.clampPoint(t.center,Ti),Ti.distanceToSquared(t.center)<=t.radius*t.radius}intersectsPlane(t){let e,r;return t.normal.x>0?(e=t.normal.x*this.min.x,r=t.normal.x*this.max.x):(e=t.normal.x*this.max.x,r=t.normal.x*this.min.x),t.normal.y>0?(e+=t.normal.y*this.min.y,r+=t.normal.y*this.max.y):(e+=t.normal.y*this.max.y,r+=t.normal.y*this.min.y),t.normal.z>0?(e+=t.normal.z*this.min.z,r+=t.normal.z*this.max.z):(e+=t.normal.z*this.max.z,r+=t.normal.z*this.min.z),e<=-t.constant&&r>=-t.constant}intersectsTriangle(t){if(this.isEmpty())return!1;this.getCenter(zs),Yo.subVectors(this.max,zs),Rr.subVectors(t.a,zs),Dr.subVectors(t.b,zs),Br.subVectors(t.c,zs),bn.subVectors(Dr,Rr),Ln.subVectors(Br,Dr),Kn.subVectors(Rr,Br);let e=[0,-bn.z,bn.y,0,-Ln.z,Ln.y,0,-Kn.z,Kn.y,bn.z,0,-bn.x,Ln.z,0,-Ln.x,Kn.z,0,-Kn.x,-bn.y,bn.x,0,-Ln.y,Ln.x,0,-Kn.y,Kn.x,0];return!_h(e,Rr,Dr,Br,Yo)||(e=[1,0,0,0,1,0,0,0,1],!_h(e,Rr,Dr,Br,Yo))?!1:(jo.crossVectors(bn,Ln),e=[jo.x,jo.y,jo.z],_h(e,Rr,Dr,Br,Yo))}clampPoint(t,e){return e.copy(t).clamp(this.min,this.max)}distanceToPoint(t){return this.clampPoint(t,Ti).distanceTo(t)}getBoundingSphere(t){return this.isEmpty()?t.makeEmpty():(this.getCenter(t.center),t.radius=this.getSize(Ti).length()*.5),t}intersect(t){return this.min.max(t.min),this.max.min(t.max),this.isEmpty()&&this.makeEmpty(),this}union(t){return this.min.min(t.min),this.max.max(t.max),this}applyMatrix4(t){return this.isEmpty()?this:(sn[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(t),sn[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(t),sn[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(t),sn[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(t),sn[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(t),sn[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(t),sn[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(t),sn[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(t),this.setFromPoints(sn),this)}translate(t){return this.min.add(t),this.max.add(t),this}equals(t){return t.min.equals(this.min)&&t.max.equals(this.max)}}const sn=[new ut,new ut,new ut,new ut,new ut,new ut,new ut,new ut],Ti=new ut,qo=new ro,Rr=new ut,Dr=new ut,Br=new ut,bn=new ut,Ln=new ut,Kn=new ut,zs=new ut,Yo=new ut,jo=new ut,Qn=new ut;function _h(h,t,e,r,i){for(let s=0,o=h.length-3;s<=o;s+=3){Qn.fromArray(h,s);const l=i.x*Math.abs(Qn.x)+i.y*Math.abs(Qn.y)+i.z*Math.abs(Qn.z),u=t.dot(Qn),f=e.dot(Qn),d=r.dot(Qn);if(Math.max(-Math.max(u,f,d),Math.min(u,f,d))>l)return!1}return!0}const km=new ro,Is=new ut,gh=new ut;class nf{constructor(t=new ut,e=-1){this.isSphere=!0,this.center=t,this.radius=e}set(t,e){return this.center.copy(t),this.radius=e,this}setFromPoints(t,e){const r=this.center;e!==void 0?r.copy(e):km.setFromPoints(t).getCenter(r);let i=0;for(let s=0,o=t.length;s<o;s++)i=Math.max(i,r.distanceToSquared(t[s]));return this.radius=Math.sqrt(i),this}copy(t){return this.center.copy(t.center),this.radius=t.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(t){return t.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(t){return t.distanceTo(this.center)-this.radius}intersectsSphere(t){const e=this.radius+t.radius;return t.center.distanceToSquared(this.center)<=e*e}intersectsBox(t){return t.intersectsSphere(this)}intersectsPlane(t){return Math.abs(t.distanceToPoint(this.center))<=this.radius}clampPoint(t,e){const r=this.center.distanceToSquared(t);return e.copy(t),r>this.radius*this.radius&&(e.sub(this.center).normalize(),e.multiplyScalar(this.radius).add(this.center)),e}getBoundingBox(t){return this.isEmpty()?(t.makeEmpty(),t):(t.set(this.center,this.center),t.expandByScalar(this.radius),t)}applyMatrix4(t){return this.center.applyMatrix4(t),this.radius=this.radius*t.getMaxScaleOnAxis(),this}translate(t){return this.center.add(t),this}expandByPoint(t){if(this.isEmpty())return this.center.copy(t),this.radius=0,this;Is.subVectors(t,this.center);const e=Is.lengthSq();if(e>this.radius*this.radius){const r=Math.sqrt(e),i=(r-this.radius)*.5;this.center.addScaledVector(Is,i/r),this.radius+=i}return this}union(t){return t.isEmpty()?this:this.isEmpty()?(this.copy(t),this):(this.center.equals(t.center)===!0?this.radius=Math.max(this.radius,t.radius):(gh.subVectors(t.center,this.center).setLength(t.radius),this.expandByPoint(Is.copy(t.center).add(gh)),this.expandByPoint(Is.copy(t.center).sub(gh))),this)}equals(t){return t.center.equals(this.center)&&t.radius===this.radius}clone(){return new this.constructor().copy(this)}}const on=new ut,yh=new ut,Xo=new ut,Mn=new ut,vh=new ut,Jo=new ut,xh=new ut;class Am{constructor(t=new ut,e=new ut(0,0,-1)){this.origin=t,this.direction=e}set(t,e){return this.origin.copy(t),this.direction.copy(e),this}copy(t){return this.origin.copy(t.origin),this.direction.copy(t.direction),this}at(t,e){return e.copy(this.origin).addScaledVector(this.direction,t)}lookAt(t){return this.direction.copy(t).sub(this.origin).normalize(),this}recast(t){return this.origin.copy(this.at(t,on)),this}closestPointToPoint(t,e){e.subVectors(t,this.origin);const r=e.dot(this.direction);return r<0?e.copy(this.origin):e.copy(this.origin).addScaledVector(this.direction,r)}distanceToPoint(t){return Math.sqrt(this.distanceSqToPoint(t))}distanceSqToPoint(t){const e=on.subVectors(t,this.origin).dot(this.direction);return e<0?this.origin.distanceToSquared(t):(on.copy(this.origin).addScaledVector(this.direction,e),on.distanceToSquared(t))}distanceSqToSegment(t,e,r,i){yh.copy(t).add(e).multiplyScalar(.5),Xo.copy(e).sub(t).normalize(),Mn.copy(this.origin).sub(yh);const s=t.distanceTo(e)*.5,o=-this.direction.dot(Xo),l=Mn.dot(this.direction),u=-Mn.dot(Xo),f=Mn.lengthSq(),d=Math.abs(1-o*o);let p,g,m,x;if(d>0)if(p=o*u-l,g=o*l-u,x=s*d,p>=0)if(g>=-x)if(g<=x){const y=1/d;p*=y,g*=y,m=p*(p+o*g+2*l)+g*(o*p+g+2*u)+f}else g=s,p=Math.max(0,-(o*g+l)),m=-p*p+g*(g+2*u)+f;else g=-s,p=Math.max(0,-(o*g+l)),m=-p*p+g*(g+2*u)+f;else g<=-x?(p=Math.max(0,-(-o*s+l)),g=p>0?-s:Math.min(Math.max(-s,-u),s),m=-p*p+g*(g+2*u)+f):g<=x?(p=0,g=Math.min(Math.max(-s,-u),s),m=g*(g+2*u)+f):(p=Math.max(0,-(o*s+l)),g=p>0?s:Math.min(Math.max(-s,-u),s),m=-p*p+g*(g+2*u)+f);else g=o>0?-s:s,p=Math.max(0,-(o*g+l)),m=-p*p+g*(g+2*u)+f;return r&&r.copy(this.origin).addScaledVector(this.direction,p),i&&i.copy(yh).addScaledVector(Xo,g),m}intersectSphere(t,e){on.subVectors(t.center,this.origin);const r=on.dot(this.direction),i=on.dot(on)-r*r,s=t.radius*t.radius;if(i>s)return null;const o=Math.sqrt(s-i),l=r-o,u=r+o;return u<0?null:l<0?this.at(u,e):this.at(l,e)}intersectsSphere(t){return this.distanceSqToPoint(t.center)<=t.radius*t.radius}distanceToPlane(t){const e=t.normal.dot(this.direction);if(e===0)return t.distanceToPoint(this.origin)===0?0:null;const r=-(this.origin.dot(t.normal)+t.constant)/e;return r>=0?r:null}intersectPlane(t,e){const r=this.distanceToPlane(t);return r===null?null:this.at(r,e)}intersectsPlane(t){const e=t.distanceToPoint(this.origin);return e===0||t.normal.dot(this.direction)*e<0}intersectBox(t,e){let r,i,s,o,l,u;const f=1/this.direction.x,d=1/this.direction.y,p=1/this.direction.z,g=this.origin;return f>=0?(r=(t.min.x-g.x)*f,i=(t.max.x-g.x)*f):(r=(t.max.x-g.x)*f,i=(t.min.x-g.x)*f),d>=0?(s=(t.min.y-g.y)*d,o=(t.max.y-g.y)*d):(s=(t.max.y-g.y)*d,o=(t.min.y-g.y)*d),r>o||s>i||((s>r||isNaN(r))&&(r=s),(o<i||isNaN(i))&&(i=o),p>=0?(l=(t.min.z-g.z)*p,u=(t.max.z-g.z)*p):(l=(t.max.z-g.z)*p,u=(t.min.z-g.z)*p),r>u||l>i)||((l>r||r!==r)&&(r=l),(u<i||i!==i)&&(i=u),i<0)?null:this.at(r>=0?r:i,e)}intersectsBox(t){return this.intersectBox(t,on)!==null}intersectTriangle(t,e,r,i,s){vh.subVectors(e,t),Jo.subVectors(r,t),xh.crossVectors(vh,Jo);let o=this.direction.dot(xh),l;if(o>0){if(i)return null;l=1}else if(o<0)l=-1,o=-o;else return null;Mn.subVectors(this.origin,t);const u=l*this.direction.dot(Jo.crossVectors(Mn,Jo));if(u<0)return null;const f=l*this.direction.dot(vh.cross(Mn));if(f<0||u+f>o)return null;const d=-l*Mn.dot(xh);return d<0?null:this.at(d/o,s)}applyMatrix4(t){return this.origin.applyMatrix4(t),this.direction.transformDirection(t),this}equals(t){return t.origin.equals(this.origin)&&t.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class qe{constructor(t,e,r,i,s,o,l,u,f,d,p,g,m,x,y,b){qe.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],t!==void 0&&this.set(t,e,r,i,s,o,l,u,f,d,p,g,m,x,y,b)}set(t,e,r,i,s,o,l,u,f,d,p,g,m,x,y,b){const P=this.elements;return P[0]=t,P[4]=e,P[8]=r,P[12]=i,P[1]=s,P[5]=o,P[9]=l,P[13]=u,P[2]=f,P[6]=d,P[10]=p,P[14]=g,P[3]=m,P[7]=x,P[11]=y,P[15]=b,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new qe().fromArray(this.elements)}copy(t){const e=this.elements,r=t.elements;return e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=r[3],e[4]=r[4],e[5]=r[5],e[6]=r[6],e[7]=r[7],e[8]=r[8],e[9]=r[9],e[10]=r[10],e[11]=r[11],e[12]=r[12],e[13]=r[13],e[14]=r[14],e[15]=r[15],this}copyPosition(t){const e=this.elements,r=t.elements;return e[12]=r[12],e[13]=r[13],e[14]=r[14],this}setFromMatrix3(t){const e=t.elements;return this.set(e[0],e[3],e[6],0,e[1],e[4],e[7],0,e[2],e[5],e[8],0,0,0,0,1),this}extractBasis(t,e,r){return t.setFromMatrixColumn(this,0),e.setFromMatrixColumn(this,1),r.setFromMatrixColumn(this,2),this}makeBasis(t,e,r){return this.set(t.x,e.x,r.x,0,t.y,e.y,r.y,0,t.z,e.z,r.z,0,0,0,0,1),this}extractRotation(t){const e=this.elements,r=t.elements,i=1/Nr.setFromMatrixColumn(t,0).length(),s=1/Nr.setFromMatrixColumn(t,1).length(),o=1/Nr.setFromMatrixColumn(t,2).length();return e[0]=r[0]*i,e[1]=r[1]*i,e[2]=r[2]*i,e[3]=0,e[4]=r[4]*s,e[5]=r[5]*s,e[6]=r[6]*s,e[7]=0,e[8]=r[8]*o,e[9]=r[9]*o,e[10]=r[10]*o,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this}makeRotationFromEuler(t){const e=this.elements,r=t.x,i=t.y,s=t.z,o=Math.cos(r),l=Math.sin(r),u=Math.cos(i),f=Math.sin(i),d=Math.cos(s),p=Math.sin(s);if(t.order==="XYZ"){const g=o*d,m=o*p,x=l*d,y=l*p;e[0]=u*d,e[4]=-u*p,e[8]=f,e[1]=m+x*f,e[5]=g-y*f,e[9]=-l*u,e[2]=y-g*f,e[6]=x+m*f,e[10]=o*u}else if(t.order==="YXZ"){const g=u*d,m=u*p,x=f*d,y=f*p;e[0]=g+y*l,e[4]=x*l-m,e[8]=o*f,e[1]=o*p,e[5]=o*d,e[9]=-l,e[2]=m*l-x,e[6]=y+g*l,e[10]=o*u}else if(t.order==="ZXY"){const g=u*d,m=u*p,x=f*d,y=f*p;e[0]=g-y*l,e[4]=-o*p,e[8]=x+m*l,e[1]=m+x*l,e[5]=o*d,e[9]=y-g*l,e[2]=-o*f,e[6]=l,e[10]=o*u}else if(t.order==="ZYX"){const g=o*d,m=o*p,x=l*d,y=l*p;e[0]=u*d,e[4]=x*f-m,e[8]=g*f+y,e[1]=u*p,e[5]=y*f+g,e[9]=m*f-x,e[2]=-f,e[6]=l*u,e[10]=o*u}else if(t.order==="YZX"){const g=o*u,m=o*f,x=l*u,y=l*f;e[0]=u*d,e[4]=y-g*p,e[8]=x*p+m,e[1]=p,e[5]=o*d,e[9]=-l*d,e[2]=-f*d,e[6]=m*p+x,e[10]=g-y*p}else if(t.order==="XZY"){const g=o*u,m=o*f,x=l*u,y=l*f;e[0]=u*d,e[4]=-p,e[8]=f*d,e[1]=g*p+y,e[5]=o*d,e[9]=m*p-x,e[2]=x*p-m,e[6]=l*d,e[10]=y*p+g}return e[3]=0,e[7]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this}makeRotationFromQuaternion(t){return this.compose(Pm,t,Cm)}lookAt(t,e,r){const i=this.elements;return $e.subVectors(t,e),$e.lengthSq()===0&&($e.z=1),$e.normalize(),En.crossVectors(r,$e),En.lengthSq()===0&&(Math.abs(r.z)===1?$e.x+=1e-4:$e.z+=1e-4,$e.normalize(),En.crossVectors(r,$e)),En.normalize(),$o.crossVectors($e,En),i[0]=En.x,i[4]=$o.x,i[8]=$e.x,i[1]=En.y,i[5]=$o.y,i[9]=$e.y,i[2]=En.z,i[6]=$o.z,i[10]=$e.z,this}multiply(t){return this.multiplyMatrices(this,t)}premultiply(t){return this.multiplyMatrices(t,this)}multiplyMatrices(t,e){const r=t.elements,i=e.elements,s=this.elements,o=r[0],l=r[4],u=r[8],f=r[12],d=r[1],p=r[5],g=r[9],m=r[13],x=r[2],y=r[6],b=r[10],P=r[14],A=r[3],N=r[7],G=r[11],z=r[15],K=i[0],q=i[4],T=i[8],k=i[12],I=i[1],F=i[5],S=i[9],O=i[13],v=i[2],C=i[6],U=i[10],H=i[14],W=i[3],V=i[7],et=i[11],Y=i[15];return s[0]=o*K+l*I+u*v+f*W,s[4]=o*q+l*F+u*C+f*V,s[8]=o*T+l*S+u*U+f*et,s[12]=o*k+l*O+u*H+f*Y,s[1]=d*K+p*I+g*v+m*W,s[5]=d*q+p*F+g*C+m*V,s[9]=d*T+p*S+g*U+m*et,s[13]=d*k+p*O+g*H+m*Y,s[2]=x*K+y*I+b*v+P*W,s[6]=x*q+y*F+b*C+P*V,s[10]=x*T+y*S+b*U+P*et,s[14]=x*k+y*O+b*H+P*Y,s[3]=A*K+N*I+G*v+z*W,s[7]=A*q+N*F+G*C+z*V,s[11]=A*T+N*S+G*U+z*et,s[15]=A*k+N*O+G*H+z*Y,this}multiplyScalar(t){const e=this.elements;return e[0]*=t,e[4]*=t,e[8]*=t,e[12]*=t,e[1]*=t,e[5]*=t,e[9]*=t,e[13]*=t,e[2]*=t,e[6]*=t,e[10]*=t,e[14]*=t,e[3]*=t,e[7]*=t,e[11]*=t,e[15]*=t,this}determinant(){const t=this.elements,e=t[0],r=t[4],i=t[8],s=t[12],o=t[1],l=t[5],u=t[9],f=t[13],d=t[2],p=t[6],g=t[10],m=t[14],x=t[3],y=t[7],b=t[11],P=t[15];return x*(+s*u*p-i*f*p-s*l*g+r*f*g+i*l*m-r*u*m)+y*(+e*u*m-e*f*g+s*o*g-i*o*m+i*f*d-s*u*d)+b*(+e*f*p-e*l*m-s*o*p+r*o*m+s*l*d-r*f*d)+P*(-i*l*d-e*u*p+e*l*g+i*o*p-r*o*g+r*u*d)}transpose(){const t=this.elements;let e;return e=t[1],t[1]=t[4],t[4]=e,e=t[2],t[2]=t[8],t[8]=e,e=t[6],t[6]=t[9],t[9]=e,e=t[3],t[3]=t[12],t[12]=e,e=t[7],t[7]=t[13],t[13]=e,e=t[11],t[11]=t[14],t[14]=e,this}setPosition(t,e,r){const i=this.elements;return t.isVector3?(i[12]=t.x,i[13]=t.y,i[14]=t.z):(i[12]=t,i[13]=e,i[14]=r),this}invert(){const t=this.elements,e=t[0],r=t[1],i=t[2],s=t[3],o=t[4],l=t[5],u=t[6],f=t[7],d=t[8],p=t[9],g=t[10],m=t[11],x=t[12],y=t[13],b=t[14],P=t[15],A=p*b*f-y*g*f+y*u*m-l*b*m-p*u*P+l*g*P,N=x*g*f-d*b*f-x*u*m+o*b*m+d*u*P-o*g*P,G=d*y*f-x*p*f+x*l*m-o*y*m-d*l*P+o*p*P,z=x*p*u-d*y*u-x*l*g+o*y*g+d*l*b-o*p*b,K=e*A+r*N+i*G+s*z;if(K===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const q=1/K;return t[0]=A*q,t[1]=(y*g*s-p*b*s-y*i*m+r*b*m+p*i*P-r*g*P)*q,t[2]=(l*b*s-y*u*s+y*i*f-r*b*f-l*i*P+r*u*P)*q,t[3]=(p*u*s-l*g*s-p*i*f+r*g*f+l*i*m-r*u*m)*q,t[4]=N*q,t[5]=(d*b*s-x*g*s+x*i*m-e*b*m-d*i*P+e*g*P)*q,t[6]=(x*u*s-o*b*s-x*i*f+e*b*f+o*i*P-e*u*P)*q,t[7]=(o*g*s-d*u*s+d*i*f-e*g*f-o*i*m+e*u*m)*q,t[8]=G*q,t[9]=(x*p*s-d*y*s-x*r*m+e*y*m+d*r*P-e*p*P)*q,t[10]=(o*y*s-x*l*s+x*r*f-e*y*f-o*r*P+e*l*P)*q,t[11]=(d*l*s-o*p*s-d*r*f+e*p*f+o*r*m-e*l*m)*q,t[12]=z*q,t[13]=(d*y*i-x*p*i+x*r*g-e*y*g-d*r*b+e*p*b)*q,t[14]=(x*l*i-o*y*i-x*r*u+e*y*u+o*r*b-e*l*b)*q,t[15]=(o*p*i-d*l*i+d*r*u-e*p*u-o*r*g+e*l*g)*q,this}scale(t){const e=this.elements,r=t.x,i=t.y,s=t.z;return e[0]*=r,e[4]*=i,e[8]*=s,e[1]*=r,e[5]*=i,e[9]*=s,e[2]*=r,e[6]*=i,e[10]*=s,e[3]*=r,e[7]*=i,e[11]*=s,this}getMaxScaleOnAxis(){const t=this.elements,e=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],r=t[4]*t[4]+t[5]*t[5]+t[6]*t[6],i=t[8]*t[8]+t[9]*t[9]+t[10]*t[10];return Math.sqrt(Math.max(e,r,i))}makeTranslation(t,e,r){return t.isVector3?this.set(1,0,0,t.x,0,1,0,t.y,0,0,1,t.z,0,0,0,1):this.set(1,0,0,t,0,1,0,e,0,0,1,r,0,0,0,1),this}makeRotationX(t){const e=Math.cos(t),r=Math.sin(t);return this.set(1,0,0,0,0,e,-r,0,0,r,e,0,0,0,0,1),this}makeRotationY(t){const e=Math.cos(t),r=Math.sin(t);return this.set(e,0,r,0,0,1,0,0,-r,0,e,0,0,0,0,1),this}makeRotationZ(t){const e=Math.cos(t),r=Math.sin(t);return this.set(e,-r,0,0,r,e,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(t,e){const r=Math.cos(e),i=Math.sin(e),s=1-r,o=t.x,l=t.y,u=t.z,f=s*o,d=s*l;return this.set(f*o+r,f*l-i*u,f*u+i*l,0,f*l+i*u,d*l+r,d*u-i*o,0,f*u-i*l,d*u+i*o,s*u*u+r,0,0,0,0,1),this}makeScale(t,e,r){return this.set(t,0,0,0,0,e,0,0,0,0,r,0,0,0,0,1),this}makeShear(t,e,r,i,s,o){return this.set(1,r,s,0,t,1,o,0,e,i,1,0,0,0,0,1),this}compose(t,e,r){const i=this.elements,s=e._x,o=e._y,l=e._z,u=e._w,f=s+s,d=o+o,p=l+l,g=s*f,m=s*d,x=s*p,y=o*d,b=o*p,P=l*p,A=u*f,N=u*d,G=u*p,z=r.x,K=r.y,q=r.z;return i[0]=(1-(y+P))*z,i[1]=(m+G)*z,i[2]=(x-N)*z,i[3]=0,i[4]=(m-G)*K,i[5]=(1-(g+P))*K,i[6]=(b+A)*K,i[7]=0,i[8]=(x+N)*q,i[9]=(b-A)*q,i[10]=(1-(g+y))*q,i[11]=0,i[12]=t.x,i[13]=t.y,i[14]=t.z,i[15]=1,this}decompose(t,e,r){const i=this.elements;let s=Nr.set(i[0],i[1],i[2]).length();const o=Nr.set(i[4],i[5],i[6]).length(),l=Nr.set(i[8],i[9],i[10]).length();this.determinant()<0&&(s=-s),t.x=i[12],t.y=i[13],t.z=i[14],Si.copy(this);const f=1/s,d=1/o,p=1/l;return Si.elements[0]*=f,Si.elements[1]*=f,Si.elements[2]*=f,Si.elements[4]*=d,Si.elements[5]*=d,Si.elements[6]*=d,Si.elements[8]*=p,Si.elements[9]*=p,Si.elements[10]*=p,e.setFromRotationMatrix(Si),r.x=s,r.y=o,r.z=l,this}makePerspective(t,e,r,i,s,o,l=Vo){const u=this.elements,f=2*s/(e-t),d=2*s/(r-i),p=(e+t)/(e-t),g=(r+i)/(r-i);let m,x;if(l===Vo)m=-(o+s)/(o-s),x=-2*o*s/(o-s);else if(l===Su)m=-o/(o-s),x=-o*s/(o-s);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+l);return u[0]=f,u[4]=0,u[8]=p,u[12]=0,u[1]=0,u[5]=d,u[9]=g,u[13]=0,u[2]=0,u[6]=0,u[10]=m,u[14]=x,u[3]=0,u[7]=0,u[11]=-1,u[15]=0,this}makeOrthographic(t,e,r,i,s,o,l=Vo){const u=this.elements,f=1/(e-t),d=1/(r-i),p=1/(o-s),g=(e+t)*f,m=(r+i)*d;let x,y;if(l===Vo)x=(o+s)*p,y=-2*p;else if(l===Su)x=s*p,y=-1*p;else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+l);return u[0]=2*f,u[4]=0,u[8]=0,u[12]=-g,u[1]=0,u[5]=2*d,u[9]=0,u[13]=-m,u[2]=0,u[6]=0,u[10]=y,u[14]=-x,u[3]=0,u[7]=0,u[11]=0,u[15]=1,this}equals(t){const e=this.elements,r=t.elements;for(let i=0;i<16;i++)if(e[i]!==r[i])return!1;return!0}fromArray(t,e=0){for(let r=0;r<16;r++)this.elements[r]=t[r+e];return this}toArray(t=[],e=0){const r=this.elements;return t[e]=r[0],t[e+1]=r[1],t[e+2]=r[2],t[e+3]=r[3],t[e+4]=r[4],t[e+5]=r[5],t[e+6]=r[6],t[e+7]=r[7],t[e+8]=r[8],t[e+9]=r[9],t[e+10]=r[10],t[e+11]=r[11],t[e+12]=r[12],t[e+13]=r[13],t[e+14]=r[14],t[e+15]=r[15],t}}const Nr=new ut,Si=new qe,Pm=new ut(0,0,0),Cm=new ut(1,1,1),En=new ut,$o=new ut,$e=new ut,Iu=new qe,Ou=new rs;class Dn{constructor(t=0,e=0,r=0,i=Dn.DEFAULT_ORDER){this.isEuler=!0,this._x=t,this._y=e,this._z=r,this._order=i}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get order(){return this._order}set order(t){this._order=t,this._onChangeCallback()}set(t,e,r,i=this._order){return this._x=t,this._y=e,this._z=r,this._order=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this._onChangeCallback(),this}setFromRotationMatrix(t,e=this._order,r=!0){const i=t.elements,s=i[0],o=i[4],l=i[8],u=i[1],f=i[5],d=i[9],p=i[2],g=i[6],m=i[10];switch(e){case"XYZ":this._y=Math.asin(Ht(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(-d,m),this._z=Math.atan2(-o,s)):(this._x=Math.atan2(g,f),this._z=0);break;case"YXZ":this._x=Math.asin(-Ht(d,-1,1)),Math.abs(d)<.9999999?(this._y=Math.atan2(l,m),this._z=Math.atan2(u,f)):(this._y=Math.atan2(-p,s),this._z=0);break;case"ZXY":this._x=Math.asin(Ht(g,-1,1)),Math.abs(g)<.9999999?(this._y=Math.atan2(-p,m),this._z=Math.atan2(-o,f)):(this._y=0,this._z=Math.atan2(u,s));break;case"ZYX":this._y=Math.asin(-Ht(p,-1,1)),Math.abs(p)<.9999999?(this._x=Math.atan2(g,m),this._z=Math.atan2(u,s)):(this._x=0,this._z=Math.atan2(-o,f));break;case"YZX":this._z=Math.asin(Ht(u,-1,1)),Math.abs(u)<.9999999?(this._x=Math.atan2(-d,f),this._y=Math.atan2(-p,s)):(this._x=0,this._y=Math.atan2(l,m));break;case"XZY":this._z=Math.asin(-Ht(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(g,f),this._y=Math.atan2(l,s)):(this._x=Math.atan2(-d,m),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+e)}return this._order=e,r===!0&&this._onChangeCallback(),this}setFromQuaternion(t,e,r){return Iu.makeRotationFromQuaternion(t),this.setFromRotationMatrix(Iu,e,r)}setFromVector3(t,e=this._order){return this.set(t.x,t.y,t.z,e)}reorder(t){return Ou.setFromEuler(this),this.setFromQuaternion(Ou,t)}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order}fromArray(t){return this._x=t[0],this._y=t[1],this._z=t[2],t[3]!==void 0&&(this._order=t[3]),this._onChangeCallback(),this}toArray(t=[],e=0){return t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._order,t}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}Dn.DEFAULT_ORDER="XYZ";class zm{constructor(){this.mask=1}set(t){this.mask=(1<<t|0)>>>0}enable(t){this.mask|=1<<t|0}enableAll(){this.mask=-1}toggle(t){this.mask^=1<<t|0}disable(t){this.mask&=~(1<<t|0)}disableAll(){this.mask=0}test(t){return(this.mask&t.mask)!==0}isEnabled(t){return(this.mask&(1<<t|0))!==0}}let Im=0;const Ru=new ut,Fr=new rs,an=new qe,Ko=new ut,Os=new ut,Om=new ut,Rm=new rs,Du=new ut(1,0,0),Bu=new ut(0,1,0),Nu=new ut(0,0,1),Fu={type:"added"},Dm={type:"removed"},Ur={type:"childadded",child:null},wh={type:"childremoved",child:null};class Gi extends Fa{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:Im++}),this.uuid=cr(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Gi.DEFAULT_UP.clone();const t=new ut,e=new Dn,r=new rs,i=new ut(1,1,1);function s(){r.setFromEuler(e,!1)}function o(){e.setFromQuaternion(r,void 0,!1)}e._onChange(s),r._onChange(o),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:t},rotation:{configurable:!0,enumerable:!0,value:e},quaternion:{configurable:!0,enumerable:!0,value:r},scale:{configurable:!0,enumerable:!0,value:i},modelViewMatrix:{value:new qe},normalMatrix:{value:new Bn}}),this.matrix=new qe,this.matrixWorld=new qe,this.matrixAutoUpdate=Gi.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=Gi.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new zm,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(t){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(t),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(t){return this.quaternion.premultiply(t),this}setRotationFromAxisAngle(t,e){this.quaternion.setFromAxisAngle(t,e)}setRotationFromEuler(t){this.quaternion.setFromEuler(t,!0)}setRotationFromMatrix(t){this.quaternion.setFromRotationMatrix(t)}setRotationFromQuaternion(t){this.quaternion.copy(t)}rotateOnAxis(t,e){return Fr.setFromAxisAngle(t,e),this.quaternion.multiply(Fr),this}rotateOnWorldAxis(t,e){return Fr.setFromAxisAngle(t,e),this.quaternion.premultiply(Fr),this}rotateX(t){return this.rotateOnAxis(Du,t)}rotateY(t){return this.rotateOnAxis(Bu,t)}rotateZ(t){return this.rotateOnAxis(Nu,t)}translateOnAxis(t,e){return Ru.copy(t).applyQuaternion(this.quaternion),this.position.add(Ru.multiplyScalar(e)),this}translateX(t){return this.translateOnAxis(Du,t)}translateY(t){return this.translateOnAxis(Bu,t)}translateZ(t){return this.translateOnAxis(Nu,t)}localToWorld(t){return this.updateWorldMatrix(!0,!1),t.applyMatrix4(this.matrixWorld)}worldToLocal(t){return this.updateWorldMatrix(!0,!1),t.applyMatrix4(an.copy(this.matrixWorld).invert())}lookAt(t,e,r){t.isVector3?Ko.copy(t):Ko.set(t,e,r);const i=this.parent;this.updateWorldMatrix(!0,!1),Os.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?an.lookAt(Os,Ko,this.up):an.lookAt(Ko,Os,this.up),this.quaternion.setFromRotationMatrix(an),i&&(an.extractRotation(i.matrixWorld),Fr.setFromRotationMatrix(an),this.quaternion.premultiply(Fr.invert()))}add(t){if(arguments.length>1){for(let e=0;e<arguments.length;e++)this.add(arguments[e]);return this}return t===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",t),this):(t&&t.isObject3D?(t.removeFromParent(),t.parent=this,this.children.push(t),t.dispatchEvent(Fu),Ur.child=t,this.dispatchEvent(Ur),Ur.child=null):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",t),this)}remove(t){if(arguments.length>1){for(let r=0;r<arguments.length;r++)this.remove(arguments[r]);return this}const e=this.children.indexOf(t);return e!==-1&&(t.parent=null,this.children.splice(e,1),t.dispatchEvent(Dm),wh.child=t,this.dispatchEvent(wh),wh.child=null),this}removeFromParent(){const t=this.parent;return t!==null&&t.remove(this),this}clear(){return this.remove(...this.children)}attach(t){return this.updateWorldMatrix(!0,!1),an.copy(this.matrixWorld).invert(),t.parent!==null&&(t.parent.updateWorldMatrix(!0,!1),an.multiply(t.parent.matrixWorld)),t.applyMatrix4(an),t.removeFromParent(),t.parent=this,this.children.push(t),t.updateWorldMatrix(!1,!0),t.dispatchEvent(Fu),Ur.child=t,this.dispatchEvent(Ur),Ur.child=null,this}getObjectById(t){return this.getObjectByProperty("id",t)}getObjectByName(t){return this.getObjectByProperty("name",t)}getObjectByProperty(t,e){if(this[t]===e)return this;for(let r=0,i=this.children.length;r<i;r++){const o=this.children[r].getObjectByProperty(t,e);if(o!==void 0)return o}}getObjectsByProperty(t,e,r=[]){this[t]===e&&r.push(this);const i=this.children;for(let s=0,o=i.length;s<o;s++)i[s].getObjectsByProperty(t,e,r);return r}getWorldPosition(t){return this.updateWorldMatrix(!0,!1),t.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Os,t,Om),t}getWorldScale(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Os,Rm,t),t}getWorldDirection(t){this.updateWorldMatrix(!0,!1);const e=this.matrixWorld.elements;return t.set(e[8],e[9],e[10]).normalize()}raycast(){}traverse(t){t(this);const e=this.children;for(let r=0,i=e.length;r<i;r++)e[r].traverse(t)}traverseVisible(t){if(this.visible===!1)return;t(this);const e=this.children;for(let r=0,i=e.length;r<i;r++)e[r].traverseVisible(t)}traverseAncestors(t){const e=this.parent;e!==null&&(t(e),e.traverseAncestors(t))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1,t=!0);const e=this.children;for(let r=0,i=e.length;r<i;r++)e[r].updateMatrixWorld(t)}updateWorldMatrix(t,e){const r=this.parent;if(t===!0&&r!==null&&r.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),e===!0){const i=this.children;for(let s=0,o=i.length;s<o;s++)i[s].updateWorldMatrix(!1,!0)}}toJSON(t){const e=t===void 0||typeof t=="string",r={};e&&(t={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},r.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});const i={};i.uuid=this.uuid,i.type=this.type,this.name!==""&&(i.name=this.name),this.castShadow===!0&&(i.castShadow=!0),this.receiveShadow===!0&&(i.receiveShadow=!0),this.visible===!1&&(i.visible=!1),this.frustumCulled===!1&&(i.frustumCulled=!1),this.renderOrder!==0&&(i.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(i.userData=this.userData),i.layers=this.layers.mask,i.matrix=this.matrix.toArray(),i.up=this.up.toArray(),this.matrixAutoUpdate===!1&&(i.matrixAutoUpdate=!1),this.isInstancedMesh&&(i.type="InstancedMesh",i.count=this.count,i.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(i.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(i.type="BatchedMesh",i.perObjectFrustumCulled=this.perObjectFrustumCulled,i.sortObjects=this.sortObjects,i.drawRanges=this._drawRanges,i.reservedRanges=this._reservedRanges,i.visibility=this._visibility,i.active=this._active,i.bounds=this._bounds.map(l=>({boxInitialized:l.boxInitialized,boxMin:l.box.min.toArray(),boxMax:l.box.max.toArray(),sphereInitialized:l.sphereInitialized,sphereRadius:l.sphere.radius,sphereCenter:l.sphere.center.toArray()})),i.maxInstanceCount=this._maxInstanceCount,i.maxVertexCount=this._maxVertexCount,i.maxIndexCount=this._maxIndexCount,i.geometryInitialized=this._geometryInitialized,i.geometryCount=this._geometryCount,i.matricesTexture=this._matricesTexture.toJSON(t),this._colorsTexture!==null&&(i.colorsTexture=this._colorsTexture.toJSON(t)),this.boundingSphere!==null&&(i.boundingSphere={center:i.boundingSphere.center.toArray(),radius:i.boundingSphere.radius}),this.boundingBox!==null&&(i.boundingBox={min:i.boundingBox.min.toArray(),max:i.boundingBox.max.toArray()}));function s(l,u){return l[u.uuid]===void 0&&(l[u.uuid]=u.toJSON(t)),u.uuid}if(this.isScene)this.background&&(this.background.isColor?i.background=this.background.toJSON():this.background.isTexture&&(i.background=this.background.toJSON(t).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(i.environment=this.environment.toJSON(t).uuid);else if(this.isMesh||this.isLine||this.isPoints){i.geometry=s(t.geometries,this.geometry);const l=this.geometry.parameters;if(l!==void 0&&l.shapes!==void 0){const u=l.shapes;if(Array.isArray(u))for(let f=0,d=u.length;f<d;f++){const p=u[f];s(t.shapes,p)}else s(t.shapes,u)}}if(this.isSkinnedMesh&&(i.bindMode=this.bindMode,i.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(s(t.skeletons,this.skeleton),i.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const l=[];for(let u=0,f=this.material.length;u<f;u++)l.push(s(t.materials,this.material[u]));i.material=l}else i.material=s(t.materials,this.material);if(this.children.length>0){i.children=[];for(let l=0;l<this.children.length;l++)i.children.push(this.children[l].toJSON(t).object)}if(this.animations.length>0){i.animations=[];for(let l=0;l<this.animations.length;l++){const u=this.animations[l];i.animations.push(s(t.animations,u))}}if(e){const l=o(t.geometries),u=o(t.materials),f=o(t.textures),d=o(t.images),p=o(t.shapes),g=o(t.skeletons),m=o(t.animations),x=o(t.nodes);l.length>0&&(r.geometries=l),u.length>0&&(r.materials=u),f.length>0&&(r.textures=f),d.length>0&&(r.images=d),p.length>0&&(r.shapes=p),g.length>0&&(r.skeletons=g),m.length>0&&(r.animations=m),x.length>0&&(r.nodes=x)}return r.object=i,r;function o(l){const u=[];for(const f in l){const d=l[f];delete d.metadata,u.push(d)}return u}}clone(t){return new this.constructor().copy(this,t)}copy(t,e=!0){if(this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.rotation.order=t.rotation.order,this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldAutoUpdate=t.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.animations=t.animations.slice(),this.userData=JSON.parse(JSON.stringify(t.userData)),e===!0)for(let r=0;r<t.children.length;r++){const i=t.children[r];this.add(i.clone())}return this}}Gi.DEFAULT_UP=new ut(0,1,0);Gi.DEFAULT_MATRIX_AUTO_UPDATE=!0;Gi.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const ki=new ut,hn=new ut,bh=new ut,ln=new ut,Zr=new ut,Gr=new ut,Uu=new ut,Lh=new ut,Mh=new ut,Eh=new ut,Th=new no,Sh=new no,kh=new no;class Ai{constructor(t=new ut,e=new ut,r=new ut){this.a=t,this.b=e,this.c=r}static getNormal(t,e,r,i){i.subVectors(r,e),ki.subVectors(t,e),i.cross(ki);const s=i.lengthSq();return s>0?i.multiplyScalar(1/Math.sqrt(s)):i.set(0,0,0)}static getBarycoord(t,e,r,i,s){ki.subVectors(i,e),hn.subVectors(r,e),bh.subVectors(t,e);const o=ki.dot(ki),l=ki.dot(hn),u=ki.dot(bh),f=hn.dot(hn),d=hn.dot(bh),p=o*f-l*l;if(p===0)return s.set(0,0,0),null;const g=1/p,m=(f*u-l*d)*g,x=(o*d-l*u)*g;return s.set(1-m-x,x,m)}static containsPoint(t,e,r,i){return this.getBarycoord(t,e,r,i,ln)===null?!1:ln.x>=0&&ln.y>=0&&ln.x+ln.y<=1}static getInterpolation(t,e,r,i,s,o,l,u){return this.getBarycoord(t,e,r,i,ln)===null?(u.x=0,u.y=0,"z"in u&&(u.z=0),"w"in u&&(u.w=0),null):(u.setScalar(0),u.addScaledVector(s,ln.x),u.addScaledVector(o,ln.y),u.addScaledVector(l,ln.z),u)}static getInterpolatedAttribute(t,e,r,i,s,o){return Th.setScalar(0),Sh.setScalar(0),kh.setScalar(0),Th.fromBufferAttribute(t,e),Sh.fromBufferAttribute(t,r),kh.fromBufferAttribute(t,i),o.setScalar(0),o.addScaledVector(Th,s.x),o.addScaledVector(Sh,s.y),o.addScaledVector(kh,s.z),o}static isFrontFacing(t,e,r,i){return ki.subVectors(r,e),hn.subVectors(t,e),ki.cross(hn).dot(i)<0}set(t,e,r){return this.a.copy(t),this.b.copy(e),this.c.copy(r),this}setFromPointsAndIndices(t,e,r,i){return this.a.copy(t[e]),this.b.copy(t[r]),this.c.copy(t[i]),this}setFromAttributeAndIndices(t,e,r,i){return this.a.fromBufferAttribute(t,e),this.b.fromBufferAttribute(t,r),this.c.fromBufferAttribute(t,i),this}clone(){return new this.constructor().copy(this)}copy(t){return this.a.copy(t.a),this.b.copy(t.b),this.c.copy(t.c),this}getArea(){return ki.subVectors(this.c,this.b),hn.subVectors(this.a,this.b),ki.cross(hn).length()*.5}getMidpoint(t){return t.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(t){return Ai.getNormal(this.a,this.b,this.c,t)}getPlane(t){return t.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(t,e){return Ai.getBarycoord(t,this.a,this.b,this.c,e)}getInterpolation(t,e,r,i,s){return Ai.getInterpolation(t,this.a,this.b,this.c,e,r,i,s)}containsPoint(t){return Ai.containsPoint(t,this.a,this.b,this.c)}isFrontFacing(t){return Ai.isFrontFacing(this.a,this.b,this.c,t)}intersectsBox(t){return t.intersectsTriangle(this)}closestPointToPoint(t,e){const r=this.a,i=this.b,s=this.c;let o,l;Zr.subVectors(i,r),Gr.subVectors(s,r),Lh.subVectors(t,r);const u=Zr.dot(Lh),f=Gr.dot(Lh);if(u<=0&&f<=0)return e.copy(r);Mh.subVectors(t,i);const d=Zr.dot(Mh),p=Gr.dot(Mh);if(d>=0&&p<=d)return e.copy(i);const g=u*p-d*f;if(g<=0&&u>=0&&d<=0)return o=u/(u-d),e.copy(r).addScaledVector(Zr,o);Eh.subVectors(t,s);const m=Zr.dot(Eh),x=Gr.dot(Eh);if(x>=0&&m<=x)return e.copy(s);const y=m*f-u*x;if(y<=0&&f>=0&&x<=0)return l=f/(f-x),e.copy(r).addScaledVector(Gr,l);const b=d*x-m*p;if(b<=0&&p-d>=0&&m-x>=0)return Uu.subVectors(s,i),l=(p-d)/(p-d+(m-x)),e.copy(i).addScaledVector(Uu,l);const P=1/(b+y+g);return o=y*P,l=g*P,e.copy(r).addScaledVector(Zr,o).addScaledVector(Gr,l)}equals(t){return t.a.equals(this.a)&&t.b.equals(this.b)&&t.c.equals(this.c)}}const rf={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Tn={h:0,s:0,l:0},Qo={h:0,s:0,l:0};function Ah(h,t,e){return e<0&&(e+=1),e>1&&(e-=1),e<1/6?h+(t-h)*6*e:e<1/2?t:e<2/3?h+(t-h)*6*(2/3-e):h}class or{constructor(t,e,r){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(t,e,r)}set(t,e,r){if(e===void 0&&r===void 0){const i=t;i&&i.isColor?this.copy(i):typeof i=="number"?this.setHex(i):typeof i=="string"&&this.setStyle(i)}else this.setRGB(t,e,r);return this}setScalar(t){return this.r=t,this.g=t,this.b=t,this}setHex(t,e=gi){return t=Math.floor(t),this.r=(t>>16&255)/255,this.g=(t>>8&255)/255,this.b=(t&255)/255,Ei.toWorkingColorSpace(this,e),this}setRGB(t,e,r,i=Ei.workingColorSpace){return this.r=t,this.g=e,this.b=r,Ei.toWorkingColorSpace(this,i),this}setHSL(t,e,r,i=Ei.workingColorSpace){if(t=bl(t,1),e=Ht(e,0,1),r=Ht(r,0,1),e===0)this.r=this.g=this.b=r;else{const s=r<=.5?r*(1+e):r+e-r*e,o=2*r-s;this.r=Ah(o,s,t+1/3),this.g=Ah(o,s,t),this.b=Ah(o,s,t-1/3)}return Ei.toWorkingColorSpace(this,i),this}setStyle(t,e=gi){function r(s){s!==void 0&&parseFloat(s)<1&&console.warn("THREE.Color: Alpha component of "+t+" will be ignored.")}let i;if(i=/^(\w+)\(([^\)]*)\)/.exec(t)){let s;const o=i[1],l=i[2];switch(o){case"rgb":case"rgba":if(s=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(l))return r(s[4]),this.setRGB(Math.min(255,parseInt(s[1],10))/255,Math.min(255,parseInt(s[2],10))/255,Math.min(255,parseInt(s[3],10))/255,e);if(s=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(l))return r(s[4]),this.setRGB(Math.min(100,parseInt(s[1],10))/100,Math.min(100,parseInt(s[2],10))/100,Math.min(100,parseInt(s[3],10))/100,e);break;case"hsl":case"hsla":if(s=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(l))return r(s[4]),this.setHSL(parseFloat(s[1])/360,parseFloat(s[2])/100,parseFloat(s[3])/100,e);break;default:console.warn("THREE.Color: Unknown color model "+t)}}else if(i=/^\#([A-Fa-f\d]+)$/.exec(t)){const s=i[1],o=s.length;if(o===3)return this.setRGB(parseInt(s.charAt(0),16)/15,parseInt(s.charAt(1),16)/15,parseInt(s.charAt(2),16)/15,e);if(o===6)return this.setHex(parseInt(s,16),e);console.warn("THREE.Color: Invalid hex color "+t)}else if(t&&t.length>0)return this.setColorName(t,e);return this}setColorName(t,e=gi){const r=rf[t.toLowerCase()];return r!==void 0?this.setHex(r,e):console.warn("THREE.Color: Unknown color "+t),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(t){return this.r=t.r,this.g=t.g,this.b=t.b,this}copySRGBToLinear(t){return this.r=un(t.r),this.g=un(t.g),this.b=un(t.b),this}copyLinearToSRGB(t){return this.r=Kr(t.r),this.g=Kr(t.g),this.b=Kr(t.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(t=gi){return Ei.fromWorkingColorSpace(Ie.copy(this),t),Math.round(Ht(Ie.r*255,0,255))*65536+Math.round(Ht(Ie.g*255,0,255))*256+Math.round(Ht(Ie.b*255,0,255))}getHexString(t=gi){return("000000"+this.getHex(t).toString(16)).slice(-6)}getHSL(t,e=Ei.workingColorSpace){Ei.fromWorkingColorSpace(Ie.copy(this),e);const r=Ie.r,i=Ie.g,s=Ie.b,o=Math.max(r,i,s),l=Math.min(r,i,s);let u,f;const d=(l+o)/2;if(l===o)u=0,f=0;else{const p=o-l;switch(f=d<=.5?p/(o+l):p/(2-o-l),o){case r:u=(i-s)/p+(i<s?6:0);break;case i:u=(s-r)/p+2;break;case s:u=(r-i)/p+4;break}u/=6}return t.h=u,t.s=f,t.l=d,t}getRGB(t,e=Ei.workingColorSpace){return Ei.fromWorkingColorSpace(Ie.copy(this),e),t.r=Ie.r,t.g=Ie.g,t.b=Ie.b,t}getStyle(t=gi){Ei.fromWorkingColorSpace(Ie.copy(this),t);const e=Ie.r,r=Ie.g,i=Ie.b;return t!==gi?`color(${t} ${e.toFixed(3)} ${r.toFixed(3)} ${i.toFixed(3)})`:`rgb(${Math.round(e*255)},${Math.round(r*255)},${Math.round(i*255)})`}offsetHSL(t,e,r){return this.getHSL(Tn),this.setHSL(Tn.h+t,Tn.s+e,Tn.l+r)}add(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this}addColors(t,e){return this.r=t.r+e.r,this.g=t.g+e.g,this.b=t.b+e.b,this}addScalar(t){return this.r+=t,this.g+=t,this.b+=t,this}sub(t){return this.r=Math.max(0,this.r-t.r),this.g=Math.max(0,this.g-t.g),this.b=Math.max(0,this.b-t.b),this}multiply(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this}multiplyScalar(t){return this.r*=t,this.g*=t,this.b*=t,this}lerp(t,e){return this.r+=(t.r-this.r)*e,this.g+=(t.g-this.g)*e,this.b+=(t.b-this.b)*e,this}lerpColors(t,e,r){return this.r=t.r+(e.r-t.r)*r,this.g=t.g+(e.g-t.g)*r,this.b=t.b+(e.b-t.b)*r,this}lerpHSL(t,e){this.getHSL(Tn),t.getHSL(Qo);const r=Vs(Tn.h,Qo.h,e),i=Vs(Tn.s,Qo.s,e),s=Vs(Tn.l,Qo.l,e);return this.setHSL(r,i,s),this}setFromVector3(t){return this.r=t.x,this.g=t.y,this.b=t.z,this}applyMatrix3(t){const e=this.r,r=this.g,i=this.b,s=t.elements;return this.r=s[0]*e+s[3]*r+s[6]*i,this.g=s[1]*e+s[4]*r+s[7]*i,this.b=s[2]*e+s[5]*r+s[8]*i,this}equals(t){return t.r===this.r&&t.g===this.g&&t.b===this.b}fromArray(t,e=0){return this.r=t[e],this.g=t[e+1],this.b=t[e+2],this}toArray(t=[],e=0){return t[e]=this.r,t[e+1]=this.g,t[e+2]=this.b,t}fromBufferAttribute(t,e){return this.r=t.getX(e),this.g=t.getY(e),this.b=t.getZ(e),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const Ie=new or;or.NAMES=rf;let Bm=0;class sf extends Fa{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:Bm++}),this.uuid=cr(),this.name="",this.type="Material",this.blending=yu,this.side=$h,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=xu,this.blendDst=wu,this.blendEquation=vu,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new or(0,0,0),this.blendAlpha=0,this.depthFunc=bu,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=Eu,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=Ir,this.stencilZFail=Ir,this.stencilZPass=Ir,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(t){this._alphaTest>0!=t>0&&this.version++,this._alphaTest=t}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(t){if(t!==void 0)for(const e in t){const r=t[e];if(r===void 0){console.warn(`THREE.Material: parameter '${e}' has value of undefined.`);continue}const i=this[e];if(i===void 0){console.warn(`THREE.Material: '${e}' is not a property of THREE.${this.type}.`);continue}i&&i.isColor?i.set(r):i&&i.isVector3&&r&&r.isVector3?i.copy(r):this[e]=r}}toJSON(t){const e=t===void 0||typeof t=="string";e&&(t={textures:{},images:{}});const r={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};r.uuid=this.uuid,r.type=this.type,this.name!==""&&(r.name=this.name),this.color&&this.color.isColor&&(r.color=this.color.getHex()),this.roughness!==void 0&&(r.roughness=this.roughness),this.metalness!==void 0&&(r.metalness=this.metalness),this.sheen!==void 0&&(r.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(r.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(r.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(r.emissive=this.emissive.getHex()),this.emissiveIntensity!==void 0&&this.emissiveIntensity!==1&&(r.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(r.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(r.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(r.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(r.shininess=this.shininess),this.clearcoat!==void 0&&(r.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(r.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(r.clearcoatMap=this.clearcoatMap.toJSON(t).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(r.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(t).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(r.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(t).uuid,r.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.dispersion!==void 0&&(r.dispersion=this.dispersion),this.iridescence!==void 0&&(r.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(r.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(r.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(r.iridescenceMap=this.iridescenceMap.toJSON(t).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(r.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(t).uuid),this.anisotropy!==void 0&&(r.anisotropy=this.anisotropy),this.anisotropyRotation!==void 0&&(r.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(r.anisotropyMap=this.anisotropyMap.toJSON(t).uuid),this.map&&this.map.isTexture&&(r.map=this.map.toJSON(t).uuid),this.matcap&&this.matcap.isTexture&&(r.matcap=this.matcap.toJSON(t).uuid),this.alphaMap&&this.alphaMap.isTexture&&(r.alphaMap=this.alphaMap.toJSON(t).uuid),this.lightMap&&this.lightMap.isTexture&&(r.lightMap=this.lightMap.toJSON(t).uuid,r.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(r.aoMap=this.aoMap.toJSON(t).uuid,r.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(r.bumpMap=this.bumpMap.toJSON(t).uuid,r.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(r.normalMap=this.normalMap.toJSON(t).uuid,r.normalMapType=this.normalMapType,r.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(r.displacementMap=this.displacementMap.toJSON(t).uuid,r.displacementScale=this.displacementScale,r.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(r.roughnessMap=this.roughnessMap.toJSON(t).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(r.metalnessMap=this.metalnessMap.toJSON(t).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(r.emissiveMap=this.emissiveMap.toJSON(t).uuid),this.specularMap&&this.specularMap.isTexture&&(r.specularMap=this.specularMap.toJSON(t).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(r.specularIntensityMap=this.specularIntensityMap.toJSON(t).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(r.specularColorMap=this.specularColorMap.toJSON(t).uuid),this.envMap&&this.envMap.isTexture&&(r.envMap=this.envMap.toJSON(t).uuid,this.combine!==void 0&&(r.combine=this.combine)),this.envMapRotation!==void 0&&(r.envMapRotation=this.envMapRotation.toArray()),this.envMapIntensity!==void 0&&(r.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(r.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(r.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(r.gradientMap=this.gradientMap.toJSON(t).uuid),this.transmission!==void 0&&(r.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(r.transmissionMap=this.transmissionMap.toJSON(t).uuid),this.thickness!==void 0&&(r.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(r.thicknessMap=this.thicknessMap.toJSON(t).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(r.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(r.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(r.size=this.size),this.shadowSide!==null&&(r.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(r.sizeAttenuation=this.sizeAttenuation),this.blending!==yu&&(r.blending=this.blending),this.side!==$h&&(r.side=this.side),this.vertexColors===!0&&(r.vertexColors=!0),this.opacity<1&&(r.opacity=this.opacity),this.transparent===!0&&(r.transparent=!0),this.blendSrc!==xu&&(r.blendSrc=this.blendSrc),this.blendDst!==wu&&(r.blendDst=this.blendDst),this.blendEquation!==vu&&(r.blendEquation=this.blendEquation),this.blendSrcAlpha!==null&&(r.blendSrcAlpha=this.blendSrcAlpha),this.blendDstAlpha!==null&&(r.blendDstAlpha=this.blendDstAlpha),this.blendEquationAlpha!==null&&(r.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(r.blendColor=this.blendColor.getHex()),this.blendAlpha!==0&&(r.blendAlpha=this.blendAlpha),this.depthFunc!==bu&&(r.depthFunc=this.depthFunc),this.depthTest===!1&&(r.depthTest=this.depthTest),this.depthWrite===!1&&(r.depthWrite=this.depthWrite),this.colorWrite===!1&&(r.colorWrite=this.colorWrite),this.stencilWriteMask!==255&&(r.stencilWriteMask=this.stencilWriteMask),this.stencilFunc!==Eu&&(r.stencilFunc=this.stencilFunc),this.stencilRef!==0&&(r.stencilRef=this.stencilRef),this.stencilFuncMask!==255&&(r.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==Ir&&(r.stencilFail=this.stencilFail),this.stencilZFail!==Ir&&(r.stencilZFail=this.stencilZFail),this.stencilZPass!==Ir&&(r.stencilZPass=this.stencilZPass),this.stencilWrite===!0&&(r.stencilWrite=this.stencilWrite),this.rotation!==void 0&&this.rotation!==0&&(r.rotation=this.rotation),this.polygonOffset===!0&&(r.polygonOffset=!0),this.polygonOffsetFactor!==0&&(r.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(r.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(r.linewidth=this.linewidth),this.dashSize!==void 0&&(r.dashSize=this.dashSize),this.gapSize!==void 0&&(r.gapSize=this.gapSize),this.scale!==void 0&&(r.scale=this.scale),this.dithering===!0&&(r.dithering=!0),this.alphaTest>0&&(r.alphaTest=this.alphaTest),this.alphaHash===!0&&(r.alphaHash=!0),this.alphaToCoverage===!0&&(r.alphaToCoverage=!0),this.premultipliedAlpha===!0&&(r.premultipliedAlpha=!0),this.forceSinglePass===!0&&(r.forceSinglePass=!0),this.wireframe===!0&&(r.wireframe=!0),this.wireframeLinewidth>1&&(r.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(r.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(r.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(r.flatShading=!0),this.visible===!1&&(r.visible=!1),this.toneMapped===!1&&(r.toneMapped=!1),this.fog===!1&&(r.fog=!1),Object.keys(this.userData).length>0&&(r.userData=this.userData);function i(s){const o=[];for(const l in s){const u=s[l];delete u.metadata,o.push(u)}return o}if(e){const s=i(t.textures),o=i(t.images);s.length>0&&(r.textures=s),o.length>0&&(r.images=o)}return r}clone(){return new this.constructor().copy(this)}copy(t){this.name=t.name,this.blending=t.blending,this.side=t.side,this.vertexColors=t.vertexColors,this.opacity=t.opacity,this.transparent=t.transparent,this.blendSrc=t.blendSrc,this.blendDst=t.blendDst,this.blendEquation=t.blendEquation,this.blendSrcAlpha=t.blendSrcAlpha,this.blendDstAlpha=t.blendDstAlpha,this.blendEquationAlpha=t.blendEquationAlpha,this.blendColor.copy(t.blendColor),this.blendAlpha=t.blendAlpha,this.depthFunc=t.depthFunc,this.depthTest=t.depthTest,this.depthWrite=t.depthWrite,this.stencilWriteMask=t.stencilWriteMask,this.stencilFunc=t.stencilFunc,this.stencilRef=t.stencilRef,this.stencilFuncMask=t.stencilFuncMask,this.stencilFail=t.stencilFail,this.stencilZFail=t.stencilZFail,this.stencilZPass=t.stencilZPass,this.stencilWrite=t.stencilWrite;const e=t.clippingPlanes;let r=null;if(e!==null){const i=e.length;r=new Array(i);for(let s=0;s!==i;++s)r[s]=e[s].clone()}return this.clippingPlanes=r,this.clipIntersection=t.clipIntersection,this.clipShadows=t.clipShadows,this.shadowSide=t.shadowSide,this.colorWrite=t.colorWrite,this.precision=t.precision,this.polygonOffset=t.polygonOffset,this.polygonOffsetFactor=t.polygonOffsetFactor,this.polygonOffsetUnits=t.polygonOffsetUnits,this.dithering=t.dithering,this.alphaTest=t.alphaTest,this.alphaHash=t.alphaHash,this.alphaToCoverage=t.alphaToCoverage,this.premultipliedAlpha=t.premultipliedAlpha,this.forceSinglePass=t.forceSinglePass,this.visible=t.visible,this.toneMapped=t.toneMapped,this.userData=JSON.parse(JSON.stringify(t.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(t){t===!0&&this.version++}onBuild(){console.warn("Material: onBuild() has been removed.")}}class Nm extends sf{constructor(t){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new or(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Dn,this.combine=$p,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.envMapRotation.copy(t.envMapRotation),this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.fog=t.fog,this}}const ge=new ut,ta=new Pt;class Ne{constructor(t,e,r=!1){if(Array.isArray(t))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=t,this.itemSize=e,this.count=t!==void 0?t.length/e:0,this.normalized=r,this.usage=Tu,this.updateRanges=[],this.gpuType=nm,this.version=0}onUploadCallback(){}set needsUpdate(t){t===!0&&this.version++}setUsage(t){return this.usage=t,this}addUpdateRange(t,e){this.updateRanges.push({start:t,count:e})}clearUpdateRanges(){this.updateRanges.length=0}copy(t){return this.name=t.name,this.array=new t.array.constructor(t.array),this.itemSize=t.itemSize,this.count=t.count,this.normalized=t.normalized,this.usage=t.usage,this.gpuType=t.gpuType,this}copyAt(t,e,r){t*=this.itemSize,r*=e.itemSize;for(let i=0,s=this.itemSize;i<s;i++)this.array[t+i]=e.array[r+i];return this}copyArray(t){return this.array.set(t),this}applyMatrix3(t){if(this.itemSize===2)for(let e=0,r=this.count;e<r;e++)ta.fromBufferAttribute(this,e),ta.applyMatrix3(t),this.setXY(e,ta.x,ta.y);else if(this.itemSize===3)for(let e=0,r=this.count;e<r;e++)ge.fromBufferAttribute(this,e),ge.applyMatrix3(t),this.setXYZ(e,ge.x,ge.y,ge.z);return this}applyMatrix4(t){for(let e=0,r=this.count;e<r;e++)ge.fromBufferAttribute(this,e),ge.applyMatrix4(t),this.setXYZ(e,ge.x,ge.y,ge.z);return this}applyNormalMatrix(t){for(let e=0,r=this.count;e<r;e++)ge.fromBufferAttribute(this,e),ge.applyNormalMatrix(t),this.setXYZ(e,ge.x,ge.y,ge.z);return this}transformDirection(t){for(let e=0,r=this.count;e<r;e++)ge.fromBufferAttribute(this,e),ge.transformDirection(t),this.setXYZ(e,ge.x,ge.y,ge.z);return this}set(t,e=0){return this.array.set(t,e),this}getComponent(t,e){let r=this.array[t*this.itemSize+e];return this.normalized&&(r=Vr(r,this.array)),r}setComponent(t,e,r){return this.normalized&&(r=Be(r,this.array)),this.array[t*this.itemSize+e]=r,this}getX(t){let e=this.array[t*this.itemSize];return this.normalized&&(e=Vr(e,this.array)),e}setX(t,e){return this.normalized&&(e=Be(e,this.array)),this.array[t*this.itemSize]=e,this}getY(t){let e=this.array[t*this.itemSize+1];return this.normalized&&(e=Vr(e,this.array)),e}setY(t,e){return this.normalized&&(e=Be(e,this.array)),this.array[t*this.itemSize+1]=e,this}getZ(t){let e=this.array[t*this.itemSize+2];return this.normalized&&(e=Vr(e,this.array)),e}setZ(t,e){return this.normalized&&(e=Be(e,this.array)),this.array[t*this.itemSize+2]=e,this}getW(t){let e=this.array[t*this.itemSize+3];return this.normalized&&(e=Vr(e,this.array)),e}setW(t,e){return this.normalized&&(e=Be(e,this.array)),this.array[t*this.itemSize+3]=e,this}setXY(t,e,r){return t*=this.itemSize,this.normalized&&(e=Be(e,this.array),r=Be(r,this.array)),this.array[t+0]=e,this.array[t+1]=r,this}setXYZ(t,e,r,i){return t*=this.itemSize,this.normalized&&(e=Be(e,this.array),r=Be(r,this.array),i=Be(i,this.array)),this.array[t+0]=e,this.array[t+1]=r,this.array[t+2]=i,this}setXYZW(t,e,r,i,s){return t*=this.itemSize,this.normalized&&(e=Be(e,this.array),r=Be(r,this.array),i=Be(i,this.array),s=Be(s,this.array)),this.array[t+0]=e,this.array[t+1]=r,this.array[t+2]=i,this.array[t+3]=s,this}onUpload(t){return this.onUploadCallback=t,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const t={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(t.name=this.name),this.usage!==Tu&&(t.usage=this.usage),t}}class Fm extends Ne{constructor(t,e,r){super(new Uint16Array(t),e,r)}}class Um extends Ne{constructor(t,e,r){super(new Uint32Array(t),e,r)}}class Qr extends Ne{constructor(t,e,r){super(new Float32Array(t),e,r)}}let Zm=0;const pi=new qe,Ph=new Gi,Hr=new ut,Ke=new ro,Rs=new ro,Te=new ut;class ss extends Fa{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:Zm++}),this.uuid=cr(),this.name="",this.type="BufferGeometry",this.index=null,this.indirect=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(t){return Array.isArray(t)?this.index=new(Lm(t)?Um:Fm)(t,1):this.index=t,this}setIndirect(t){return this.indirect=t,this}getIndirect(){return this.indirect}getAttribute(t){return this.attributes[t]}setAttribute(t,e){return this.attributes[t]=e,this}deleteAttribute(t){return delete this.attributes[t],this}hasAttribute(t){return this.attributes[t]!==void 0}addGroup(t,e,r=0){this.groups.push({start:t,count:e,materialIndex:r})}clearGroups(){this.groups=[]}setDrawRange(t,e){this.drawRange.start=t,this.drawRange.count=e}applyMatrix4(t){const e=this.attributes.position;e!==void 0&&(e.applyMatrix4(t),e.needsUpdate=!0);const r=this.attributes.normal;if(r!==void 0){const s=new Bn().getNormalMatrix(t);r.applyNormalMatrix(s),r.needsUpdate=!0}const i=this.attributes.tangent;return i!==void 0&&(i.transformDirection(t),i.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(t){return pi.makeRotationFromQuaternion(t),this.applyMatrix4(pi),this}rotateX(t){return pi.makeRotationX(t),this.applyMatrix4(pi),this}rotateY(t){return pi.makeRotationY(t),this.applyMatrix4(pi),this}rotateZ(t){return pi.makeRotationZ(t),this.applyMatrix4(pi),this}translate(t,e,r){return pi.makeTranslation(t,e,r),this.applyMatrix4(pi),this}scale(t,e,r){return pi.makeScale(t,e,r),this.applyMatrix4(pi),this}lookAt(t){return Ph.lookAt(t),Ph.updateMatrix(),this.applyMatrix4(Ph.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(Hr).negate(),this.translate(Hr.x,Hr.y,Hr.z),this}setFromPoints(t){const e=this.getAttribute("position");if(e===void 0){const r=[];for(let i=0,s=t.length;i<s;i++){const o=t[i];r.push(o.x,o.y,o.z||0)}this.setAttribute("position",new Qr(r,3))}else{const r=Math.min(t.length,e.count);for(let i=0;i<r;i++){const s=t[i];e.setXYZ(i,s.x,s.y,s.z||0)}t.length>e.count&&console.warn("THREE.BufferGeometry: Buffer size too small for points data. Use .dispose() and create a new geometry."),e.needsUpdate=!0}return this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new ro);const t=this.attributes.position,e=this.morphAttributes.position;if(t&&t.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box.",this),this.boundingBox.set(new ut(-1/0,-1/0,-1/0),new ut(1/0,1/0,1/0));return}if(t!==void 0){if(this.boundingBox.setFromBufferAttribute(t),e)for(let r=0,i=e.length;r<i;r++){const s=e[r];Ke.setFromBufferAttribute(s),this.morphTargetsRelative?(Te.addVectors(this.boundingBox.min,Ke.min),this.boundingBox.expandByPoint(Te),Te.addVectors(this.boundingBox.max,Ke.max),this.boundingBox.expandByPoint(Te)):(this.boundingBox.expandByPoint(Ke.min),this.boundingBox.expandByPoint(Ke.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new nf);const t=this.attributes.position,e=this.morphAttributes.position;if(t&&t.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere.",this),this.boundingSphere.set(new ut,1/0);return}if(t){const r=this.boundingSphere.center;if(Ke.setFromBufferAttribute(t),e)for(let s=0,o=e.length;s<o;s++){const l=e[s];Rs.setFromBufferAttribute(l),this.morphTargetsRelative?(Te.addVectors(Ke.min,Rs.min),Ke.expandByPoint(Te),Te.addVectors(Ke.max,Rs.max),Ke.expandByPoint(Te)):(Ke.expandByPoint(Rs.min),Ke.expandByPoint(Rs.max))}Ke.getCenter(r);let i=0;for(let s=0,o=t.count;s<o;s++)Te.fromBufferAttribute(t,s),i=Math.max(i,r.distanceToSquared(Te));if(e)for(let s=0,o=e.length;s<o;s++){const l=e[s],u=this.morphTargetsRelative;for(let f=0,d=l.count;f<d;f++)Te.fromBufferAttribute(l,f),u&&(Hr.fromBufferAttribute(t,f),Te.add(Hr)),i=Math.max(i,r.distanceToSquared(Te))}this.boundingSphere.radius=Math.sqrt(i),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const t=this.index,e=this.attributes;if(t===null||e.position===void 0||e.normal===void 0||e.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const r=e.position,i=e.normal,s=e.uv;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new Ne(new Float32Array(4*r.count),4));const o=this.getAttribute("tangent"),l=[],u=[];for(let T=0;T<r.count;T++)l[T]=new ut,u[T]=new ut;const f=new ut,d=new ut,p=new ut,g=new Pt,m=new Pt,x=new Pt,y=new ut,b=new ut;function P(T,k,I){f.fromBufferAttribute(r,T),d.fromBufferAttribute(r,k),p.fromBufferAttribute(r,I),g.fromBufferAttribute(s,T),m.fromBufferAttribute(s,k),x.fromBufferAttribute(s,I),d.sub(f),p.sub(f),m.sub(g),x.sub(g);const F=1/(m.x*x.y-x.x*m.y);isFinite(F)&&(y.copy(d).multiplyScalar(x.y).addScaledVector(p,-m.y).multiplyScalar(F),b.copy(p).multiplyScalar(m.x).addScaledVector(d,-x.x).multiplyScalar(F),l[T].add(y),l[k].add(y),l[I].add(y),u[T].add(b),u[k].add(b),u[I].add(b))}let A=this.groups;A.length===0&&(A=[{start:0,count:t.count}]);for(let T=0,k=A.length;T<k;++T){const I=A[T],F=I.start,S=I.count;for(let O=F,v=F+S;O<v;O+=3)P(t.getX(O+0),t.getX(O+1),t.getX(O+2))}const N=new ut,G=new ut,z=new ut,K=new ut;function q(T){z.fromBufferAttribute(i,T),K.copy(z);const k=l[T];N.copy(k),N.sub(z.multiplyScalar(z.dot(k))).normalize(),G.crossVectors(K,k);const F=G.dot(u[T])<0?-1:1;o.setXYZW(T,N.x,N.y,N.z,F)}for(let T=0,k=A.length;T<k;++T){const I=A[T],F=I.start,S=I.count;for(let O=F,v=F+S;O<v;O+=3)q(t.getX(O+0)),q(t.getX(O+1)),q(t.getX(O+2))}}computeVertexNormals(){const t=this.index,e=this.getAttribute("position");if(e!==void 0){let r=this.getAttribute("normal");if(r===void 0)r=new Ne(new Float32Array(e.count*3),3),this.setAttribute("normal",r);else for(let g=0,m=r.count;g<m;g++)r.setXYZ(g,0,0,0);const i=new ut,s=new ut,o=new ut,l=new ut,u=new ut,f=new ut,d=new ut,p=new ut;if(t)for(let g=0,m=t.count;g<m;g+=3){const x=t.getX(g+0),y=t.getX(g+1),b=t.getX(g+2);i.fromBufferAttribute(e,x),s.fromBufferAttribute(e,y),o.fromBufferAttribute(e,b),d.subVectors(o,s),p.subVectors(i,s),d.cross(p),l.fromBufferAttribute(r,x),u.fromBufferAttribute(r,y),f.fromBufferAttribute(r,b),l.add(d),u.add(d),f.add(d),r.setXYZ(x,l.x,l.y,l.z),r.setXYZ(y,u.x,u.y,u.z),r.setXYZ(b,f.x,f.y,f.z)}else for(let g=0,m=e.count;g<m;g+=3)i.fromBufferAttribute(e,g+0),s.fromBufferAttribute(e,g+1),o.fromBufferAttribute(e,g+2),d.subVectors(o,s),p.subVectors(i,s),d.cross(p),r.setXYZ(g+0,d.x,d.y,d.z),r.setXYZ(g+1,d.x,d.y,d.z),r.setXYZ(g+2,d.x,d.y,d.z);this.normalizeNormals(),r.needsUpdate=!0}}normalizeNormals(){const t=this.attributes.normal;for(let e=0,r=t.count;e<r;e++)Te.fromBufferAttribute(t,e),Te.normalize(),t.setXYZ(e,Te.x,Te.y,Te.z)}toNonIndexed(){function t(l,u){const f=l.array,d=l.itemSize,p=l.normalized,g=new f.constructor(u.length*d);let m=0,x=0;for(let y=0,b=u.length;y<b;y++){l.isInterleavedBufferAttribute?m=u[y]*l.data.stride+l.offset:m=u[y]*d;for(let P=0;P<d;P++)g[x++]=f[m++]}return new Ne(g,d,p)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const e=new ss,r=this.index.array,i=this.attributes;for(const l in i){const u=i[l],f=t(u,r);e.setAttribute(l,f)}const s=this.morphAttributes;for(const l in s){const u=[],f=s[l];for(let d=0,p=f.length;d<p;d++){const g=f[d],m=t(g,r);u.push(m)}e.morphAttributes[l]=u}e.morphTargetsRelative=this.morphTargetsRelative;const o=this.groups;for(let l=0,u=o.length;l<u;l++){const f=o[l];e.addGroup(f.start,f.count,f.materialIndex)}return e}toJSON(){const t={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(t.uuid=this.uuid,t.type=this.type,this.name!==""&&(t.name=this.name),Object.keys(this.userData).length>0&&(t.userData=this.userData),this.parameters!==void 0){const u=this.parameters;for(const f in u)u[f]!==void 0&&(t[f]=u[f]);return t}t.data={attributes:{}};const e=this.index;e!==null&&(t.data.index={type:e.array.constructor.name,array:Array.prototype.slice.call(e.array)});const r=this.attributes;for(const u in r){const f=r[u];t.data.attributes[u]=f.toJSON(t.data)}const i={};let s=!1;for(const u in this.morphAttributes){const f=this.morphAttributes[u],d=[];for(let p=0,g=f.length;p<g;p++){const m=f[p];d.push(m.toJSON(t.data))}d.length>0&&(i[u]=d,s=!0)}s&&(t.data.morphAttributes=i,t.data.morphTargetsRelative=this.morphTargetsRelative);const o=this.groups;o.length>0&&(t.data.groups=JSON.parse(JSON.stringify(o)));const l=this.boundingSphere;return l!==null&&(t.data.boundingSphere={center:l.center.toArray(),radius:l.radius}),t}clone(){return new this.constructor().copy(this)}copy(t){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const e={};this.name=t.name;const r=t.index;r!==null&&this.setIndex(r.clone(e));const i=t.attributes;for(const f in i){const d=i[f];this.setAttribute(f,d.clone(e))}const s=t.morphAttributes;for(const f in s){const d=[],p=s[f];for(let g=0,m=p.length;g<m;g++)d.push(p[g].clone(e));this.morphAttributes[f]=d}this.morphTargetsRelative=t.morphTargetsRelative;const o=t.groups;for(let f=0,d=o.length;f<d;f++){const p=o[f];this.addGroup(p.start,p.count,p.materialIndex)}const l=t.boundingBox;l!==null&&(this.boundingBox=l.clone());const u=t.boundingSphere;return u!==null&&(this.boundingSphere=u.clone()),this.drawRange.start=t.drawRange.start,this.drawRange.count=t.drawRange.count,this.userData=t.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const Zu=new qe,tr=new Am,ea=new nf,Gu=new ut,ia=new ut,na=new ut,ra=new ut,Ch=new ut,sa=new ut,Hu=new ut,oa=new ut;class Wu extends Gi{constructor(t=new ss,e=new Nm){super(),this.isMesh=!0,this.type="Mesh",this.geometry=t,this.material=e,this.updateMorphTargets()}copy(t,e){return super.copy(t,e),t.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=t.morphTargetInfluences.slice()),t.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},t.morphTargetDictionary)),this.material=Array.isArray(t.material)?t.material.slice():t.material,this.geometry=t.geometry,this}updateMorphTargets(){const e=this.geometry.morphAttributes,r=Object.keys(e);if(r.length>0){const i=e[r[0]];if(i!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=i.length;s<o;s++){const l=i[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[l]=s}}}}getVertexPosition(t,e){const r=this.geometry,i=r.attributes.position,s=r.morphAttributes.position,o=r.morphTargetsRelative;e.fromBufferAttribute(i,t);const l=this.morphTargetInfluences;if(s&&l){sa.set(0,0,0);for(let u=0,f=s.length;u<f;u++){const d=l[u],p=s[u];d!==0&&(Ch.fromBufferAttribute(p,t),o?sa.addScaledVector(Ch,d):sa.addScaledVector(Ch.sub(e),d))}e.add(sa)}return e}raycast(t,e){const r=this.geometry,i=this.material,s=this.matrixWorld;i!==void 0&&(r.boundingSphere===null&&r.computeBoundingSphere(),ea.copy(r.boundingSphere),ea.applyMatrix4(s),tr.copy(t.ray).recast(t.near),!(ea.containsPoint(tr.origin)===!1&&(tr.intersectSphere(ea,Gu)===null||tr.origin.distanceToSquared(Gu)>(t.far-t.near)**2))&&(Zu.copy(s).invert(),tr.copy(t.ray).applyMatrix4(Zu),!(r.boundingBox!==null&&tr.intersectsBox(r.boundingBox)===!1)&&this._computeIntersections(t,e,tr)))}_computeIntersections(t,e,r){let i;const s=this.geometry,o=this.material,l=s.index,u=s.attributes.position,f=s.attributes.uv,d=s.attributes.uv1,p=s.attributes.normal,g=s.groups,m=s.drawRange;if(l!==null)if(Array.isArray(o))for(let x=0,y=g.length;x<y;x++){const b=g[x],P=o[b.materialIndex],A=Math.max(b.start,m.start),N=Math.min(l.count,Math.min(b.start+b.count,m.start+m.count));for(let G=A,z=N;G<z;G+=3){const K=l.getX(G),q=l.getX(G+1),T=l.getX(G+2);i=aa(this,P,t,r,f,d,p,K,q,T),i&&(i.faceIndex=Math.floor(G/3),i.face.materialIndex=b.materialIndex,e.push(i))}}else{const x=Math.max(0,m.start),y=Math.min(l.count,m.start+m.count);for(let b=x,P=y;b<P;b+=3){const A=l.getX(b),N=l.getX(b+1),G=l.getX(b+2);i=aa(this,o,t,r,f,d,p,A,N,G),i&&(i.faceIndex=Math.floor(b/3),e.push(i))}}else if(u!==void 0)if(Array.isArray(o))for(let x=0,y=g.length;x<y;x++){const b=g[x],P=o[b.materialIndex],A=Math.max(b.start,m.start),N=Math.min(u.count,Math.min(b.start+b.count,m.start+m.count));for(let G=A,z=N;G<z;G+=3){const K=G,q=G+1,T=G+2;i=aa(this,P,t,r,f,d,p,K,q,T),i&&(i.faceIndex=Math.floor(G/3),i.face.materialIndex=b.materialIndex,e.push(i))}}else{const x=Math.max(0,m.start),y=Math.min(u.count,m.start+m.count);for(let b=x,P=y;b<P;b+=3){const A=b,N=b+1,G=b+2;i=aa(this,o,t,r,f,d,p,A,N,G),i&&(i.faceIndex=Math.floor(b/3),e.push(i))}}}}function Gm(h,t,e,r,i,s,o,l){let u;if(t.side===Jp?u=r.intersectTriangle(o,s,i,!0,l):u=r.intersectTriangle(i,s,o,t.side===$h,l),u===null)return null;oa.copy(l),oa.applyMatrix4(h.matrixWorld);const f=e.ray.origin.distanceTo(oa);return f<e.near||f>e.far?null:{distance:f,point:oa.clone(),object:h}}function aa(h,t,e,r,i,s,o,l,u,f){h.getVertexPosition(l,ia),h.getVertexPosition(u,na),h.getVertexPosition(f,ra);const d=Gm(h,t,e,r,ia,na,ra,Hu);if(d){const p=new ut;Ai.getBarycoord(Hu,ia,na,ra,p),i&&(d.uv=Ai.getInterpolatedAttribute(i,l,u,f,p,new Pt)),s&&(d.uv1=Ai.getInterpolatedAttribute(s,l,u,f,p,new Pt)),o&&(d.normal=Ai.getInterpolatedAttribute(o,l,u,f,p,new ut),d.normal.dot(r.direction)>0&&d.normal.multiplyScalar(-1));const g={a:l,b:u,c:f,normal:new ut,materialIndex:0};Ai.getNormal(ia,na,ra,g.normal),d.face=g,d.barycoord=p}return d}class el extends Gi{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.backgroundRotation=new Dn,this.environmentIntensity=1,this.environmentRotation=new Dn,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(t,e){return super.copy(t,e),t.background!==null&&(this.background=t.background.clone()),t.environment!==null&&(this.environment=t.environment.clone()),t.fog!==null&&(this.fog=t.fog.clone()),this.backgroundBlurriness=t.backgroundBlurriness,this.backgroundIntensity=t.backgroundIntensity,this.backgroundRotation.copy(t.backgroundRotation),this.environmentIntensity=t.environmentIntensity,this.environmentRotation.copy(t.environmentRotation),t.overrideMaterial!==null&&(this.overrideMaterial=t.overrideMaterial.clone()),this.matrixAutoUpdate=t.matrixAutoUpdate,this}toJSON(t){const e=super.toJSON(t);return this.fog!==null&&(e.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(e.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(e.object.backgroundIntensity=this.backgroundIntensity),e.object.backgroundRotation=this.backgroundRotation.toArray(),this.environmentIntensity!==1&&(e.object.environmentIntensity=this.environmentIntensity),e.object.environmentRotation=this.environmentRotation.toArray(),e}}class zh extends Cn{constructor(t,e,r,i,s,o,l,u,f,d,p,g){super(null,o,l,u,f,d,i,s,p,g),this.isCompressedTexture=!0,this.image={width:e,height:r},this.mipmaps=t,this.flipY=!1,this.generateMipmaps=!1}}class Wi{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(t,e){const r=this.getUtoTmapping(t);return this.getPoint(r,e)}getPoints(t=5){const e=[];for(let r=0;r<=t;r++)e.push(this.getPoint(r/t));return e}getSpacedPoints(t=5){const e=[];for(let r=0;r<=t;r++)e.push(this.getPointAt(r/t));return e}getLength(){const t=this.getLengths();return t[t.length-1]}getLengths(t=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===t+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const e=[];let r,i=this.getPoint(0),s=0;e.push(0);for(let o=1;o<=t;o++)r=this.getPoint(o/t),s+=r.distanceTo(i),e.push(s),i=r;return this.cacheArcLengths=e,e}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(t,e){const r=this.getLengths();let i=0;const s=r.length;let o;e?o=e:o=t*r[s-1];let l=0,u=s-1,f;for(;l<=u;)if(i=Math.floor(l+(u-l)/2),f=r[i]-o,f<0)l=i+1;else if(f>0)u=i-1;else{u=i;break}if(i=u,r[i]===o)return i/(s-1);const d=r[i],g=r[i+1]-d,m=(o-d)/g;return(i+m)/(s-1)}getTangent(t,e){let i=t-1e-4,s=t+1e-4;i<0&&(i=0),s>1&&(s=1);const o=this.getPoint(i),l=this.getPoint(s),u=e||(o.isVector2?new Pt:new ut);return u.copy(l).sub(o).normalize(),u}getTangentAt(t,e){const r=this.getUtoTmapping(t);return this.getTangent(r,e)}computeFrenetFrames(t,e){const r=new ut,i=[],s=[],o=[],l=new ut,u=new qe;for(let m=0;m<=t;m++){const x=m/t;i[m]=this.getTangentAt(x,new ut)}s[0]=new ut,o[0]=new ut;let f=Number.MAX_VALUE;const d=Math.abs(i[0].x),p=Math.abs(i[0].y),g=Math.abs(i[0].z);d<=f&&(f=d,r.set(1,0,0)),p<=f&&(f=p,r.set(0,1,0)),g<=f&&r.set(0,0,1),l.crossVectors(i[0],r).normalize(),s[0].crossVectors(i[0],l),o[0].crossVectors(i[0],s[0]);for(let m=1;m<=t;m++){if(s[m]=s[m-1].clone(),o[m]=o[m-1].clone(),l.crossVectors(i[m-1],i[m]),l.length()>Number.EPSILON){l.normalize();const x=Math.acos(Ht(i[m-1].dot(i[m]),-1,1));s[m].applyMatrix4(u.makeRotationAxis(l,x))}o[m].crossVectors(i[m],s[m])}if(e===!0){let m=Math.acos(Ht(s[0].dot(s[t]),-1,1));m/=t,i[0].dot(l.crossVectors(s[0],s[t]))>0&&(m=-m);for(let x=1;x<=t;x++)s[x].applyMatrix4(u.makeRotationAxis(i[x],m*x)),o[x].crossVectors(i[x],s[x])}return{tangents:i,normals:s,binormals:o}}clone(){return new this.constructor().copy(this)}copy(t){return this.arcLengthDivisions=t.arcLengthDivisions,this}toJSON(){const t={metadata:{version:4.6,type:"Curve",generator:"Curve.toJSON"}};return t.arcLengthDivisions=this.arcLengthDivisions,t.type=this.type,t}fromJSON(t){return this.arcLengthDivisions=t.arcLengthDivisions,this}}class Ll extends Wi{constructor(t=0,e=0,r=1,i=1,s=0,o=Math.PI*2,l=!1,u=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=t,this.aY=e,this.xRadius=r,this.yRadius=i,this.aStartAngle=s,this.aEndAngle=o,this.aClockwise=l,this.aRotation=u}getPoint(t,e=new Pt){const r=e,i=Math.PI*2;let s=this.aEndAngle-this.aStartAngle;const o=Math.abs(s)<Number.EPSILON;for(;s<0;)s+=i;for(;s>i;)s-=i;s<Number.EPSILON&&(o?s=0:s=i),this.aClockwise===!0&&!o&&(s===i?s=-i:s=s-i);const l=this.aStartAngle+t*s;let u=this.aX+this.xRadius*Math.cos(l),f=this.aY+this.yRadius*Math.sin(l);if(this.aRotation!==0){const d=Math.cos(this.aRotation),p=Math.sin(this.aRotation),g=u-this.aX,m=f-this.aY;u=g*d-m*p+this.aX,f=g*p+m*d+this.aY}return r.set(u,f)}copy(t){return super.copy(t),this.aX=t.aX,this.aY=t.aY,this.xRadius=t.xRadius,this.yRadius=t.yRadius,this.aStartAngle=t.aStartAngle,this.aEndAngle=t.aEndAngle,this.aClockwise=t.aClockwise,this.aRotation=t.aRotation,this}toJSON(){const t=super.toJSON();return t.aX=this.aX,t.aY=this.aY,t.xRadius=this.xRadius,t.yRadius=this.yRadius,t.aStartAngle=this.aStartAngle,t.aEndAngle=this.aEndAngle,t.aClockwise=this.aClockwise,t.aRotation=this.aRotation,t}fromJSON(t){return super.fromJSON(t),this.aX=t.aX,this.aY=t.aY,this.xRadius=t.xRadius,this.yRadius=t.yRadius,this.aStartAngle=t.aStartAngle,this.aEndAngle=t.aEndAngle,this.aClockwise=t.aClockwise,this.aRotation=t.aRotation,this}}class Hm extends Ll{constructor(t,e,r,i,s,o){super(t,e,r,r,i,s,o),this.isArcCurve=!0,this.type="ArcCurve"}}function Ml(){let h=0,t=0,e=0,r=0;function i(s,o,l,u){h=s,t=l,e=-3*s+3*o-2*l-u,r=2*s-2*o+l+u}return{initCatmullRom:function(s,o,l,u,f){i(o,l,f*(l-s),f*(u-o))},initNonuniformCatmullRom:function(s,o,l,u,f,d,p){let g=(o-s)/f-(l-s)/(f+d)+(l-o)/d,m=(l-o)/d-(u-o)/(d+p)+(u-l)/p;g*=d,m*=d,i(o,l,g,m)},calc:function(s){const o=s*s,l=o*s;return h+t*s+e*o+r*l}}}const ha=new ut,Ih=new Ml,Oh=new Ml,Rh=new Ml;class Wm extends Wi{constructor(t=[],e=!1,r="centripetal",i=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=t,this.closed=e,this.curveType=r,this.tension=i}getPoint(t,e=new ut){const r=e,i=this.points,s=i.length,o=(s-(this.closed?0:1))*t;let l=Math.floor(o),u=o-l;this.closed?l+=l>0?0:(Math.floor(Math.abs(l)/s)+1)*s:u===0&&l===s-1&&(l=s-2,u=1);let f,d;this.closed||l>0?f=i[(l-1)%s]:(ha.subVectors(i[0],i[1]).add(i[0]),f=ha);const p=i[l%s],g=i[(l+1)%s];if(this.closed||l+2<s?d=i[(l+2)%s]:(ha.subVectors(i[s-1],i[s-2]).add(i[s-1]),d=ha),this.curveType==="centripetal"||this.curveType==="chordal"){const m=this.curveType==="chordal"?.5:.25;let x=Math.pow(f.distanceToSquared(p),m),y=Math.pow(p.distanceToSquared(g),m),b=Math.pow(g.distanceToSquared(d),m);y<1e-4&&(y=1),x<1e-4&&(x=y),b<1e-4&&(b=y),Ih.initNonuniformCatmullRom(f.x,p.x,g.x,d.x,x,y,b),Oh.initNonuniformCatmullRom(f.y,p.y,g.y,d.y,x,y,b),Rh.initNonuniformCatmullRom(f.z,p.z,g.z,d.z,x,y,b)}else this.curveType==="catmullrom"&&(Ih.initCatmullRom(f.x,p.x,g.x,d.x,this.tension),Oh.initCatmullRom(f.y,p.y,g.y,d.y,this.tension),Rh.initCatmullRom(f.z,p.z,g.z,d.z,this.tension));return r.set(Ih.calc(u),Oh.calc(u),Rh.calc(u)),r}copy(t){super.copy(t),this.points=[];for(let e=0,r=t.points.length;e<r;e++){const i=t.points[e];this.points.push(i.clone())}return this.closed=t.closed,this.curveType=t.curveType,this.tension=t.tension,this}toJSON(){const t=super.toJSON();t.points=[];for(let e=0,r=this.points.length;e<r;e++){const i=this.points[e];t.points.push(i.toArray())}return t.closed=this.closed,t.curveType=this.curveType,t.tension=this.tension,t}fromJSON(t){super.fromJSON(t),this.points=[];for(let e=0,r=t.points.length;e<r;e++){const i=t.points[e];this.points.push(new ut().fromArray(i))}return this.closed=t.closed,this.curveType=t.curveType,this.tension=t.tension,this}}function Vu(h,t,e,r,i){const s=(r-t)*.5,o=(i-e)*.5,l=h*h,u=h*l;return(2*e-2*r+s+o)*u+(-3*e+3*r-2*s-o)*l+s*h+e}function Vm(h,t){const e=1-h;return e*e*t}function qm(h,t){return 2*(1-h)*h*t}function Ym(h,t){return h*h*t}function qs(h,t,e,r){return Vm(h,t)+qm(h,e)+Ym(h,r)}function jm(h,t){const e=1-h;return e*e*e*t}function Xm(h,t){const e=1-h;return 3*e*e*h*t}function Jm(h,t){return 3*(1-h)*h*h*t}function $m(h,t){return h*h*h*t}function Ys(h,t,e,r,i){return jm(h,t)+Xm(h,e)+Jm(h,r)+$m(h,i)}class of extends Wi{constructor(t=new Pt,e=new Pt,r=new Pt,i=new Pt){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=t,this.v1=e,this.v2=r,this.v3=i}getPoint(t,e=new Pt){const r=e,i=this.v0,s=this.v1,o=this.v2,l=this.v3;return r.set(Ys(t,i.x,s.x,o.x,l.x),Ys(t,i.y,s.y,o.y,l.y)),r}copy(t){return super.copy(t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this.v3.copy(t.v3),this}toJSON(){const t=super.toJSON();return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t.v3=this.v3.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this.v3.fromArray(t.v3),this}}class Km extends Wi{constructor(t=new ut,e=new ut,r=new ut,i=new ut){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=t,this.v1=e,this.v2=r,this.v3=i}getPoint(t,e=new ut){const r=e,i=this.v0,s=this.v1,o=this.v2,l=this.v3;return r.set(Ys(t,i.x,s.x,o.x,l.x),Ys(t,i.y,s.y,o.y,l.y),Ys(t,i.z,s.z,o.z,l.z)),r}copy(t){return super.copy(t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this.v3.copy(t.v3),this}toJSON(){const t=super.toJSON();return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t.v3=this.v3.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this.v3.fromArray(t.v3),this}}class af extends Wi{constructor(t=new Pt,e=new Pt){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=t,this.v2=e}getPoint(t,e=new Pt){const r=e;return t===1?r.copy(this.v2):(r.copy(this.v2).sub(this.v1),r.multiplyScalar(t).add(this.v1)),r}getPointAt(t,e){return this.getPoint(t,e)}getTangent(t,e=new Pt){return e.subVectors(this.v2,this.v1).normalize()}getTangentAt(t,e){return this.getTangent(t,e)}copy(t){return super.copy(t),this.v1.copy(t.v1),this.v2.copy(t.v2),this}toJSON(){const t=super.toJSON();return t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this}}class Qm extends Wi{constructor(t=new ut,e=new ut){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=t,this.v2=e}getPoint(t,e=new ut){const r=e;return t===1?r.copy(this.v2):(r.copy(this.v2).sub(this.v1),r.multiplyScalar(t).add(this.v1)),r}getPointAt(t,e){return this.getPoint(t,e)}getTangent(t,e=new ut){return e.subVectors(this.v2,this.v1).normalize()}getTangentAt(t,e){return this.getTangent(t,e)}copy(t){return super.copy(t),this.v1.copy(t.v1),this.v2.copy(t.v2),this}toJSON(){const t=super.toJSON();return t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this}}class hf extends Wi{constructor(t=new Pt,e=new Pt,r=new Pt){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=t,this.v1=e,this.v2=r}getPoint(t,e=new Pt){const r=e,i=this.v0,s=this.v1,o=this.v2;return r.set(qs(t,i.x,s.x,o.x),qs(t,i.y,s.y,o.y)),r}copy(t){return super.copy(t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this}toJSON(){const t=super.toJSON();return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this}}class t_ extends Wi{constructor(t=new ut,e=new ut,r=new ut){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=t,this.v1=e,this.v2=r}getPoint(t,e=new ut){const r=e,i=this.v0,s=this.v1,o=this.v2;return r.set(qs(t,i.x,s.x,o.x),qs(t,i.y,s.y,o.y),qs(t,i.z,s.z,o.z)),r}copy(t){return super.copy(t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this}toJSON(){const t=super.toJSON();return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this}}class lf extends Wi{constructor(t=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=t}getPoint(t,e=new Pt){const r=e,i=this.points,s=(i.length-1)*t,o=Math.floor(s),l=s-o,u=i[o===0?o:o-1],f=i[o],d=i[o>i.length-2?i.length-1:o+1],p=i[o>i.length-3?i.length-1:o+2];return r.set(Vu(l,u.x,f.x,d.x,p.x),Vu(l,u.y,f.y,d.y,p.y)),r}copy(t){super.copy(t),this.points=[];for(let e=0,r=t.points.length;e<r;e++){const i=t.points[e];this.points.push(i.clone())}return this}toJSON(){const t=super.toJSON();t.points=[];for(let e=0,r=this.points.length;e<r;e++){const i=this.points[e];t.points.push(i.toArray())}return t}fromJSON(t){super.fromJSON(t),this.points=[];for(let e=0,r=t.points.length;e<r;e++){const i=t.points[e];this.points.push(new Pt().fromArray(i))}return this}}var il=Object.freeze({__proto__:null,ArcCurve:Hm,CatmullRomCurve3:Wm,CubicBezierCurve:of,CubicBezierCurve3:Km,EllipseCurve:Ll,LineCurve:af,LineCurve3:Qm,QuadraticBezierCurve:hf,QuadraticBezierCurve3:t_,SplineCurve:lf});class e_ extends Wi{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(t){this.curves.push(t)}closePath(){const t=this.curves[0].getPoint(0),e=this.curves[this.curves.length-1].getPoint(1);if(!t.equals(e)){const r=t.isVector2===!0?"LineCurve":"LineCurve3";this.curves.push(new il[r](e,t))}return this}getPoint(t,e){const r=t*this.getLength(),i=this.getCurveLengths();let s=0;for(;s<i.length;){if(i[s]>=r){const o=i[s]-r,l=this.curves[s],u=l.getLength(),f=u===0?0:1-o/u;return l.getPointAt(f,e)}s++}return null}getLength(){const t=this.getCurveLengths();return t[t.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const t=[];let e=0;for(let r=0,i=this.curves.length;r<i;r++)e+=this.curves[r].getLength(),t.push(e);return this.cacheLengths=t,t}getSpacedPoints(t=40){const e=[];for(let r=0;r<=t;r++)e.push(this.getPoint(r/t));return this.autoClose&&e.push(e[0]),e}getPoints(t=12){const e=[];let r;for(let i=0,s=this.curves;i<s.length;i++){const o=s[i],l=o.isEllipseCurve?t*2:o.isLineCurve||o.isLineCurve3?1:o.isSplineCurve?t*o.points.length:t,u=o.getPoints(l);for(let f=0;f<u.length;f++){const d=u[f];r&&r.equals(d)||(e.push(d),r=d)}}return this.autoClose&&e.length>1&&!e[e.length-1].equals(e[0])&&e.push(e[0]),e}copy(t){super.copy(t),this.curves=[];for(let e=0,r=t.curves.length;e<r;e++){const i=t.curves[e];this.curves.push(i.clone())}return this.autoClose=t.autoClose,this}toJSON(){const t=super.toJSON();t.autoClose=this.autoClose,t.curves=[];for(let e=0,r=this.curves.length;e<r;e++){const i=this.curves[e];t.curves.push(i.toJSON())}return t}fromJSON(t){super.fromJSON(t),this.autoClose=t.autoClose,this.curves=[];for(let e=0,r=t.curves.length;e<r;e++){const i=t.curves[e];this.curves.push(new il[i.type]().fromJSON(i))}return this}}class qu extends e_{constructor(t){super(),this.type="Path",this.currentPoint=new Pt,t&&this.setFromPoints(t)}setFromPoints(t){this.moveTo(t[0].x,t[0].y);for(let e=1,r=t.length;e<r;e++)this.lineTo(t[e].x,t[e].y);return this}moveTo(t,e){return this.currentPoint.set(t,e),this}lineTo(t,e){const r=new af(this.currentPoint.clone(),new Pt(t,e));return this.curves.push(r),this.currentPoint.set(t,e),this}quadraticCurveTo(t,e,r,i){const s=new hf(this.currentPoint.clone(),new Pt(t,e),new Pt(r,i));return this.curves.push(s),this.currentPoint.set(r,i),this}bezierCurveTo(t,e,r,i,s,o){const l=new of(this.currentPoint.clone(),new Pt(t,e),new Pt(r,i),new Pt(s,o));return this.curves.push(l),this.currentPoint.set(s,o),this}splineThru(t){const e=[this.currentPoint.clone()].concat(t),r=new lf(e);return this.curves.push(r),this.currentPoint.copy(t[t.length-1]),this}arc(t,e,r,i,s,o){const l=this.currentPoint.x,u=this.currentPoint.y;return this.absarc(t+l,e+u,r,i,s,o),this}absarc(t,e,r,i,s,o){return this.absellipse(t,e,r,r,i,s,o),this}ellipse(t,e,r,i,s,o,l,u){const f=this.currentPoint.x,d=this.currentPoint.y;return this.absellipse(t+f,e+d,r,i,s,o,l,u),this}absellipse(t,e,r,i,s,o,l,u){const f=new Ll(t,e,r,i,s,o,l,u);if(this.curves.length>0){const p=f.getPoint(0);p.equals(this.currentPoint)||this.lineTo(p.x,p.y)}this.curves.push(f);const d=f.getPoint(1);return this.currentPoint.copy(d),this}copy(t){return super.copy(t),this.currentPoint.copy(t.currentPoint),this}toJSON(){const t=super.toJSON();return t.currentPoint=this.currentPoint.toArray(),t}fromJSON(t){return super.fromJSON(t),this.currentPoint.fromArray(t.currentPoint),this}}class Aa extends qu{constructor(t){super(t),this.uuid=cr(),this.type="Shape",this.holes=[]}getPointsHoles(t){const e=[];for(let r=0,i=this.holes.length;r<i;r++)e[r]=this.holes[r].getPoints(t);return e}extractPoints(t){return{shape:this.getPoints(t),holes:this.getPointsHoles(t)}}copy(t){super.copy(t),this.holes=[];for(let e=0,r=t.holes.length;e<r;e++){const i=t.holes[e];this.holes.push(i.clone())}return this}toJSON(){const t=super.toJSON();t.uuid=this.uuid,t.holes=[];for(let e=0,r=this.holes.length;e<r;e++){const i=this.holes[e];t.holes.push(i.toJSON())}return t}fromJSON(t){super.fromJSON(t),this.uuid=t.uuid,this.holes=[];for(let e=0,r=t.holes.length;e<r;e++){const i=t.holes[e];this.holes.push(new qu().fromJSON(i))}return this}}const i_={triangulate:function(h,t,e=2){const r=t&&t.length,i=r?t[0]*e:h.length;let s=uf(h,0,i,e,!0);const o=[];if(!s||s.next===s.prev)return o;let l,u,f,d,p,g,m;if(r&&(s=a_(h,t,s,e)),h.length>80*e){l=f=h[0],u=d=h[1];for(let x=e;x<i;x+=e)p=h[x],g=h[x+1],p<l&&(l=p),g<u&&(u=g),p>f&&(f=p),g>d&&(d=g);m=Math.max(f-l,d-u),m=m!==0?32767/m:0}return Js(s,o,e,l,u,m,0),o}};function uf(h,t,e,r,i){let s,o;if(i===y_(h,t,e,r)>0)for(s=t;s<e;s+=r)o=Yu(s,h[s],h[s+1],o);else for(s=e-r;s>=t;s-=r)o=Yu(s,h[s],h[s+1],o);return o&&Ua(o,o.next)&&(Ks(o),o=o.next),o}function ar(h,t){if(!h)return h;t||(t=h);let e=h,r;do if(r=!1,!e.steiner&&(Ua(e,e.next)||ue(e.prev,e,e.next)===0)){if(Ks(e),e=t=e.prev,e===e.next)break;r=!0}else e=e.next;while(r||e!==t);return t}function Js(h,t,e,r,i,s,o){if(!h)return;!o&&s&&f_(h,r,i,s);let l=h,u,f;for(;h.prev!==h.next;){if(u=h.prev,f=h.next,s?r_(h,r,i,s):n_(h)){t.push(u.i/e|0),t.push(h.i/e|0),t.push(f.i/e|0),Ks(h),h=f.next,l=f.next;continue}if(h=f,h===l){o?o===1?(h=s_(ar(h),t,e),Js(h,t,e,r,i,s,2)):o===2&&o_(h,t,e,r,i,s):Js(ar(h),t,e,r,i,s,1);break}}}function n_(h){const t=h.prev,e=h,r=h.next;if(ue(t,e,r)>=0)return!1;const i=t.x,s=e.x,o=r.x,l=t.y,u=e.y,f=r.y,d=i<s?i<o?i:o:s<o?s:o,p=l<u?l<f?l:f:u<f?u:f,g=i>s?i>o?i:o:s>o?s:o,m=l>u?l>f?l:f:u>f?u:f;let x=r.next;for(;x!==t;){if(x.x>=d&&x.x<=g&&x.y>=p&&x.y<=m&&qr(i,l,s,u,o,f,x.x,x.y)&&ue(x.prev,x,x.next)>=0)return!1;x=x.next}return!0}function r_(h,t,e,r){const i=h.prev,s=h,o=h.next;if(ue(i,s,o)>=0)return!1;const l=i.x,u=s.x,f=o.x,d=i.y,p=s.y,g=o.y,m=l<u?l<f?l:f:u<f?u:f,x=d<p?d<g?d:g:p<g?p:g,y=l>u?l>f?l:f:u>f?u:f,b=d>p?d>g?d:g:p>g?p:g,P=nl(m,x,t,e,r),A=nl(y,b,t,e,r);let N=h.prevZ,G=h.nextZ;for(;N&&N.z>=P&&G&&G.z<=A;){if(N.x>=m&&N.x<=y&&N.y>=x&&N.y<=b&&N!==i&&N!==o&&qr(l,d,u,p,f,g,N.x,N.y)&&ue(N.prev,N,N.next)>=0||(N=N.prevZ,G.x>=m&&G.x<=y&&G.y>=x&&G.y<=b&&G!==i&&G!==o&&qr(l,d,u,p,f,g,G.x,G.y)&&ue(G.prev,G,G.next)>=0))return!1;G=G.nextZ}for(;N&&N.z>=P;){if(N.x>=m&&N.x<=y&&N.y>=x&&N.y<=b&&N!==i&&N!==o&&qr(l,d,u,p,f,g,N.x,N.y)&&ue(N.prev,N,N.next)>=0)return!1;N=N.prevZ}for(;G&&G.z<=A;){if(G.x>=m&&G.x<=y&&G.y>=x&&G.y<=b&&G!==i&&G!==o&&qr(l,d,u,p,f,g,G.x,G.y)&&ue(G.prev,G,G.next)>=0)return!1;G=G.nextZ}return!0}function s_(h,t,e){let r=h;do{const i=r.prev,s=r.next.next;!Ua(i,s)&&cf(i,r,r.next,s)&&$s(i,s)&&$s(s,i)&&(t.push(i.i/e|0),t.push(r.i/e|0),t.push(s.i/e|0),Ks(r),Ks(r.next),r=h=s),r=r.next}while(r!==h);return ar(r)}function o_(h,t,e,r,i,s){let o=h;do{let l=o.next.next;for(;l!==o.prev;){if(o.i!==l.i&&m_(o,l)){let u=ff(o,l);o=ar(o,o.next),u=ar(u,u.next),Js(o,t,e,r,i,s,0),Js(u,t,e,r,i,s,0);return}l=l.next}o=o.next}while(o!==h)}function a_(h,t,e,r){const i=[];let s,o,l,u,f;for(s=0,o=t.length;s<o;s++)l=t[s]*r,u=s<o-1?t[s+1]*r:h.length,f=uf(h,l,u,r,!1),f===f.next&&(f.steiner=!0),i.push(p_(f));for(i.sort(h_),s=0;s<i.length;s++)e=l_(i[s],e);return e}function h_(h,t){return h.x-t.x}function l_(h,t){const e=u_(h,t);if(!e)return t;const r=ff(e,h);return ar(r,r.next),ar(e,e.next)}function u_(h,t){let e=t,r=-1/0,i;const s=h.x,o=h.y;do{if(o<=e.y&&o>=e.next.y&&e.next.y!==e.y){const g=e.x+(o-e.y)*(e.next.x-e.x)/(e.next.y-e.y);if(g<=s&&g>r&&(r=g,i=e.x<e.next.x?e:e.next,g===s))return i}e=e.next}while(e!==t);if(!i)return null;const l=i,u=i.x,f=i.y;let d=1/0,p;e=i;do s>=e.x&&e.x>=u&&s!==e.x&&qr(o<f?s:r,o,u,f,o<f?r:s,o,e.x,e.y)&&(p=Math.abs(o-e.y)/(s-e.x),$s(e,h)&&(p<d||p===d&&(e.x>i.x||e.x===i.x&&c_(i,e)))&&(i=e,d=p)),e=e.next;while(e!==l);return i}function c_(h,t){return ue(h.prev,h,t.prev)<0&&ue(t.next,h,h.next)<0}function f_(h,t,e,r){let i=h;do i.z===0&&(i.z=nl(i.x,i.y,t,e,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next;while(i!==h);i.prevZ.nextZ=null,i.prevZ=null,d_(i)}function d_(h){let t,e,r,i,s,o,l,u,f=1;do{for(e=h,h=null,s=null,o=0;e;){for(o++,r=e,l=0,t=0;t<f&&(l++,r=r.nextZ,!!r);t++);for(u=f;l>0||u>0&&r;)l!==0&&(u===0||!r||e.z<=r.z)?(i=e,e=e.nextZ,l--):(i=r,r=r.nextZ,u--),s?s.nextZ=i:h=i,i.prevZ=s,s=i;e=r}s.nextZ=null,f*=2}while(o>1);return h}function nl(h,t,e,r,i){return h=(h-e)*i|0,t=(t-r)*i|0,h=(h|h<<8)&16711935,h=(h|h<<4)&252645135,h=(h|h<<2)&858993459,h=(h|h<<1)&1431655765,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,h|t<<1}function p_(h){let t=h,e=h;do(t.x<e.x||t.x===e.x&&t.y<e.y)&&(e=t),t=t.next;while(t!==h);return e}function qr(h,t,e,r,i,s,o,l){return(i-o)*(t-l)>=(h-o)*(s-l)&&(h-o)*(r-l)>=(e-o)*(t-l)&&(e-o)*(s-l)>=(i-o)*(r-l)}function m_(h,t){return h.next.i!==t.i&&h.prev.i!==t.i&&!__(h,t)&&($s(h,t)&&$s(t,h)&&g_(h,t)&&(ue(h.prev,h,t.prev)||ue(h,t.prev,t))||Ua(h,t)&&ue(h.prev,h,h.next)>0&&ue(t.prev,t,t.next)>0)}function ue(h,t,e){return(t.y-h.y)*(e.x-t.x)-(t.x-h.x)*(e.y-t.y)}function Ua(h,t){return h.x===t.x&&h.y===t.y}function cf(h,t,e,r){const i=ua(ue(h,t,e)),s=ua(ue(h,t,r)),o=ua(ue(e,r,h)),l=ua(ue(e,r,t));return!!(i!==s&&o!==l||i===0&&la(h,e,t)||s===0&&la(h,r,t)||o===0&&la(e,h,r)||l===0&&la(e,t,r))}function la(h,t,e){return t.x<=Math.max(h.x,e.x)&&t.x>=Math.min(h.x,e.x)&&t.y<=Math.max(h.y,e.y)&&t.y>=Math.min(h.y,e.y)}function ua(h){return h>0?1:h<0?-1:0}function __(h,t){let e=h;do{if(e.i!==h.i&&e.next.i!==h.i&&e.i!==t.i&&e.next.i!==t.i&&cf(e,e.next,h,t))return!0;e=e.next}while(e!==h);return!1}function $s(h,t){return ue(h.prev,h,h.next)<0?ue(h,t,h.next)>=0&&ue(h,h.prev,t)>=0:ue(h,t,h.prev)<0||ue(h,h.next,t)<0}function g_(h,t){let e=h,r=!1;const i=(h.x+t.x)/2,s=(h.y+t.y)/2;do e.y>s!=e.next.y>s&&e.next.y!==e.y&&i<(e.next.x-e.x)*(s-e.y)/(e.next.y-e.y)+e.x&&(r=!r),e=e.next;while(e!==h);return r}function ff(h,t){const e=new rl(h.i,h.x,h.y),r=new rl(t.i,t.x,t.y),i=h.next,s=t.prev;return h.next=t,t.prev=h,e.next=i,i.prev=e,r.next=e,e.prev=r,s.next=r,r.prev=s,r}function Yu(h,t,e,r){const i=new rl(h,t,e);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function Ks(h){h.next.prev=h.prev,h.prev.next=h.next,h.prevZ&&(h.prevZ.nextZ=h.nextZ),h.nextZ&&(h.nextZ.prevZ=h.prevZ)}function rl(h,t,e){this.i=h,this.x=t,this.y=e,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function y_(h,t,e,r){let i=0;for(let s=t,o=e-r;s<e;s+=r)i+=(h[o]-h[s])*(h[s+1]+h[o+1]),o=s;return i}class zn{static area(t){const e=t.length;let r=0;for(let i=e-1,s=0;s<e;i=s++)r+=t[i].x*t[s].y-t[s].x*t[i].y;return r*.5}static isClockWise(t){return zn.area(t)<0}static triangulateShape(t,e){const r=[],i=[],s=[];ju(t),Xu(r,t);let o=t.length;e.forEach(ju);for(let u=0;u<e.length;u++)i.push(o),o+=e[u].length,Xu(r,e[u]);const l=i_.triangulate(r,i);for(let u=0;u<l.length;u+=3)s.push(l.slice(u,u+3));return s}}function ju(h){const t=h.length;t>2&&h[t-1].equals(h[0])&&h.pop()}function Xu(h,t){for(let e=0;e<t.length;e++)h.push(t[e].x),h.push(t[e].y)}class El extends ss{constructor(t=new Aa([new Pt(.5,.5),new Pt(-.5,.5),new Pt(-.5,-.5),new Pt(.5,-.5)]),e={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:t,options:e},t=Array.isArray(t)?t:[t];const r=this,i=[],s=[];for(let l=0,u=t.length;l<u;l++){const f=t[l];o(f)}this.setAttribute("position",new Qr(i,3)),this.setAttribute("uv",new Qr(s,2)),this.computeVertexNormals();function o(l){const u=[],f=e.curveSegments!==void 0?e.curveSegments:12,d=e.steps!==void 0?e.steps:1,p=e.depth!==void 0?e.depth:1;let g=e.bevelEnabled!==void 0?e.bevelEnabled:!0,m=e.bevelThickness!==void 0?e.bevelThickness:.2,x=e.bevelSize!==void 0?e.bevelSize:m-.1,y=e.bevelOffset!==void 0?e.bevelOffset:0,b=e.bevelSegments!==void 0?e.bevelSegments:3;const P=e.extrudePath,A=e.UVGenerator!==void 0?e.UVGenerator:v_;let N,G=!1,z,K,q,T;P&&(N=P.getSpacedPoints(d),G=!0,g=!1,z=P.computeFrenetFrames(d,!1),K=new ut,q=new ut,T=new ut),g||(b=0,m=0,x=0,y=0);const k=l.extractPoints(f);let I=k.shape;const F=k.holes;if(!zn.isClockWise(I)){I=I.reverse();for(let ht=0,ft=F.length;ht<ft;ht++){const M=F[ht];zn.isClockWise(M)&&(F[ht]=M.reverse())}}const O=zn.triangulateShape(I,F),v=I;for(let ht=0,ft=F.length;ht<ft;ht++){const M=F[ht];I=I.concat(M)}function C(ht,ft,M){return ft||console.error("THREE.ExtrudeGeometry: vec does not exist"),ht.clone().addScaledVector(ft,M)}const U=I.length,H=O.length;function W(ht,ft,M){let tt,$,Z;const B=ht.x-ft.x,X=ht.y-ft.y,ot=M.x-ht.x,lt=M.y-ht.y,it=B*B+X*X,_t=B*lt-X*ot;if(Math.abs(_t)>Number.EPSILON){const xt=Math.sqrt(it),gt=Math.sqrt(ot*ot+lt*lt),Et=ft.x-X/xt,Wt=ft.y+B/xt,Tt=M.x-lt/gt,$t=M.y+ot/gt,fe=((Tt-Et)*lt-($t-Wt)*ot)/(B*lt-X*ot);tt=Et+B*fe-ht.x,$=Wt+X*fe-ht.y;const se=tt*tt+$*$;if(se<=2)return new Pt(tt,$);Z=Math.sqrt(se/2)}else{let xt=!1;B>Number.EPSILON?ot>Number.EPSILON&&(xt=!0):B<-Number.EPSILON?ot<-Number.EPSILON&&(xt=!0):Math.sign(X)===Math.sign(lt)&&(xt=!0),xt?(tt=-X,$=B,Z=Math.sqrt(it)):(tt=B,$=X,Z=Math.sqrt(it/2))}return new Pt(tt/Z,$/Z)}const V=[];for(let ht=0,ft=v.length,M=ft-1,tt=ht+1;ht<ft;ht++,M++,tt++)M===ft&&(M=0),tt===ft&&(tt=0),V[ht]=W(v[ht],v[M],v[tt]);const et=[];let Y,Q=V.concat();for(let ht=0,ft=F.length;ht<ft;ht++){const M=F[ht];Y=[];for(let tt=0,$=M.length,Z=$-1,B=tt+1;tt<$;tt++,Z++,B++)Z===$&&(Z=0),B===$&&(B=0),Y[tt]=W(M[tt],M[Z],M[B]);et.push(Y),Q=Q.concat(Y)}for(let ht=0;ht<b;ht++){const ft=ht/b,M=m*Math.cos(ft*Math.PI/2),tt=x*Math.sin(ft*Math.PI/2)+y;for(let $=0,Z=v.length;$<Z;$++){const B=C(v[$],V[$],tt);St(B.x,B.y,-M)}for(let $=0,Z=F.length;$<Z;$++){const B=F[$];Y=et[$];for(let X=0,ot=B.length;X<ot;X++){const lt=C(B[X],Y[X],tt);St(lt.x,lt.y,-M)}}}const pt=x+y;for(let ht=0;ht<U;ht++){const ft=g?C(I[ht],Q[ht],pt):I[ht];G?(q.copy(z.normals[0]).multiplyScalar(ft.x),K.copy(z.binormals[0]).multiplyScalar(ft.y),T.copy(N[0]).add(q).add(K),St(T.x,T.y,T.z)):St(ft.x,ft.y,0)}for(let ht=1;ht<=d;ht++)for(let ft=0;ft<U;ft++){const M=g?C(I[ft],Q[ft],pt):I[ft];G?(q.copy(z.normals[ht]).multiplyScalar(M.x),K.copy(z.binormals[ht]).multiplyScalar(M.y),T.copy(N[ht]).add(q).add(K),St(T.x,T.y,T.z)):St(M.x,M.y,p/d*ht)}for(let ht=b-1;ht>=0;ht--){const ft=ht/b,M=m*Math.cos(ft*Math.PI/2),tt=x*Math.sin(ft*Math.PI/2)+y;for(let $=0,Z=v.length;$<Z;$++){const B=C(v[$],V[$],tt);St(B.x,B.y,p+M)}for(let $=0,Z=F.length;$<Z;$++){const B=F[$];Y=et[$];for(let X=0,ot=B.length;X<ot;X++){const lt=C(B[X],Y[X],tt);G?St(lt.x,lt.y+N[d-1].y,N[d-1].x+M):St(lt.x,lt.y,p+M)}}}ct(),rt();function ct(){const ht=i.length/3;if(g){let ft=0,M=U*ft;for(let tt=0;tt<H;tt++){const $=O[tt];kt($[2]+M,$[1]+M,$[0]+M)}ft=d+b*2,M=U*ft;for(let tt=0;tt<H;tt++){const $=O[tt];kt($[0]+M,$[1]+M,$[2]+M)}}else{for(let ft=0;ft<H;ft++){const M=O[ft];kt(M[2],M[1],M[0])}for(let ft=0;ft<H;ft++){const M=O[ft];kt(M[0]+U*d,M[1]+U*d,M[2]+U*d)}}r.addGroup(ht,i.length/3-ht,0)}function rt(){const ht=i.length/3;let ft=0;mt(v,ft),ft+=v.length;for(let M=0,tt=F.length;M<tt;M++){const $=F[M];mt($,ft),ft+=$.length}r.addGroup(ht,i.length/3-ht,1)}function mt(ht,ft){let M=ht.length;for(;--M>=0;){const tt=M;let $=M-1;$<0&&($=ht.length-1);for(let Z=0,B=d+b*2;Z<B;Z++){const X=U*Z,ot=U*(Z+1),lt=ft+tt+X,it=ft+$+X,_t=ft+$+ot,xt=ft+tt+ot;It(lt,it,_t,xt)}}}function St(ht,ft,M){u.push(ht),u.push(ft),u.push(M)}function kt(ht,ft,M){wt(ht),wt(ft),wt(M);const tt=i.length/3,$=A.generateTopUV(r,i,tt-3,tt-2,tt-1);vt($[0]),vt($[1]),vt($[2])}function It(ht,ft,M,tt){wt(ht),wt(ft),wt(tt),wt(ft),wt(M),wt(tt);const $=i.length/3,Z=A.generateSideWallUV(r,i,$-6,$-3,$-2,$-1);vt(Z[0]),vt(Z[1]),vt(Z[3]),vt(Z[1]),vt(Z[2]),vt(Z[3])}function wt(ht){i.push(u[ht*3+0]),i.push(u[ht*3+1]),i.push(u[ht*3+2])}function vt(ht){s.push(ht.x),s.push(ht.y)}}}copy(t){return super.copy(t),this.parameters=Object.assign({},t.parameters),this}toJSON(){const t=super.toJSON(),e=this.parameters.shapes,r=this.parameters.options;return x_(e,r,t)}static fromJSON(t,e){const r=[];for(let s=0,o=t.shapes.length;s<o;s++){const l=e[t.shapes[s]];r.push(l)}const i=t.options.extrudePath;return i!==void 0&&(t.options.extrudePath=new il[i.type]().fromJSON(i)),new El(r,t.options)}}const v_={generateTopUV:function(h,t,e,r,i){const s=t[e*3],o=t[e*3+1],l=t[r*3],u=t[r*3+1],f=t[i*3],d=t[i*3+1];return[new Pt(s,o),new Pt(l,u),new Pt(f,d)]},generateSideWallUV:function(h,t,e,r,i,s){const o=t[e*3],l=t[e*3+1],u=t[e*3+2],f=t[r*3],d=t[r*3+1],p=t[r*3+2],g=t[i*3],m=t[i*3+1],x=t[i*3+2],y=t[s*3],b=t[s*3+1],P=t[s*3+2];return Math.abs(l-d)<Math.abs(o-f)?[new Pt(o,1-u),new Pt(f,1-p),new Pt(g,1-x),new Pt(y,1-P)]:[new Pt(l,1-u),new Pt(d,1-p),new Pt(m,1-x),new Pt(b,1-P)]}};function x_(h,t,e){if(e.shapes=[],Array.isArray(h))for(let r=0,i=h.length;r<i;r++){const s=h[r];e.shapes.push(s.uuid)}else e.shapes.push(h.uuid);return e.options=Object.assign({},t),t.extrudePath!==void 0&&(e.options.extrudePath=t.extrudePath.toJSON()),e}class Tl extends ss{constructor(t=new Aa([new Pt(0,.5),new Pt(-.5,-.5),new Pt(.5,-.5)]),e=12){super(),this.type="ShapeGeometry",this.parameters={shapes:t,curveSegments:e};const r=[],i=[],s=[],o=[];let l=0,u=0;if(Array.isArray(t)===!1)f(t);else for(let d=0;d<t.length;d++)f(t[d]),this.addGroup(l,u,d),l+=u,u=0;this.setIndex(r),this.setAttribute("position",new Qr(i,3)),this.setAttribute("normal",new Qr(s,3)),this.setAttribute("uv",new Qr(o,2));function f(d){const p=i.length/3,g=d.extractPoints(e);let m=g.shape;const x=g.holes;zn.isClockWise(m)===!1&&(m=m.reverse());for(let b=0,P=x.length;b<P;b++){const A=x[b];zn.isClockWise(A)===!0&&(x[b]=A.reverse())}const y=zn.triangulateShape(m,x);for(let b=0,P=x.length;b<P;b++){const A=x[b];m=m.concat(A)}for(let b=0,P=m.length;b<P;b++){const A=m[b];i.push(A.x,A.y,0),s.push(0,0,1),o.push(A.x,A.y)}for(let b=0,P=y.length;b<P;b++){const A=y[b],N=A[0]+p,G=A[1]+p,z=A[2]+p;r.push(N,G,z),u+=3}}}copy(t){return super.copy(t),this.parameters=Object.assign({},t.parameters),this}toJSON(){const t=super.toJSON(),e=this.parameters.shapes;return w_(e,t)}static fromJSON(t,e){const r=[];for(let i=0,s=t.shapes.length;i<s;i++){const o=e[t.shapes[i]];r.push(o)}return new Tl(r,t.curveSegments)}}function w_(h,t){if(t.shapes=[],Array.isArray(h))for(let e=0,r=h.length;e<r;e++){const i=h[e];t.shapes.push(i.uuid)}else t.shapes.push(h.uuid);return t}class Ju extends sf{constructor(t){super(),this.isMeshStandardMaterial=!0,this.type="MeshStandardMaterial",this.defines={STANDARD:""},this.color=new or(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new or(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=om,this.normalScale=new Pt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Dn,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.defines={STANDARD:""},this.color.copy(t.color),this.roughness=t.roughness,this.metalness=t.metalness,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.roughnessMap=t.roughnessMap,this.metalnessMap=t.metalnessMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.envMapRotation.copy(t.envMapRotation),this.envMapIntensity=t.envMapIntensity,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.flatShading=t.flatShading,this.fog=t.fog,this}}const Sl="\\[\\]\\.:\\/",b_=new RegExp("["+Sl+"]","g"),kl="[^"+Sl+"]",L_="[^"+Sl.replace("\\.","")+"]",M_=/((?:WC+[\/:])*)/.source.replace("WC",kl),E_=/(WCOD+)?/.source.replace("WCOD",L_),T_=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",kl),S_=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",kl),k_=new RegExp("^"+M_+E_+T_+S_+"$"),A_=["material","materials","bones","map"];class P_{constructor(t,e,r){const i=r||Xt.parseTrackName(e);this._targetGroup=t,this._bindings=t.subscribe_(e,i)}getValue(t,e){this.bind();const r=this._targetGroup.nCachedObjects_,i=this._bindings[r];i!==void 0&&i.getValue(t,e)}setValue(t,e){const r=this._bindings;for(let i=this._targetGroup.nCachedObjects_,s=r.length;i!==s;++i)r[i].setValue(t,e)}bind(){const t=this._bindings;for(let e=this._targetGroup.nCachedObjects_,r=t.length;e!==r;++e)t[e].bind()}unbind(){const t=this._bindings;for(let e=this._targetGroup.nCachedObjects_,r=t.length;e!==r;++e)t[e].unbind()}}class Xt{constructor(t,e,r){this.path=e,this.parsedPath=r||Xt.parseTrackName(e),this.node=Xt.findNode(t,this.parsedPath.nodeName),this.rootNode=t,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(t,e,r){return t&&t.isAnimationObjectGroup?new Xt.Composite(t,e,r):new Xt(t,e,r)}static sanitizeNodeName(t){return t.replace(/\s/g,"_").replace(b_,"")}static parseTrackName(t){const e=k_.exec(t);if(e===null)throw new Error("PropertyBinding: Cannot parse trackName: "+t);const r={nodeName:e[2],objectName:e[3],objectIndex:e[4],propertyName:e[5],propertyIndex:e[6]},i=r.nodeName&&r.nodeName.lastIndexOf(".");if(i!==void 0&&i!==-1){const s=r.nodeName.substring(i+1);A_.indexOf(s)!==-1&&(r.nodeName=r.nodeName.substring(0,i),r.objectName=s)}if(r.propertyName===null||r.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+t);return r}static findNode(t,e){if(e===void 0||e===""||e==="."||e===-1||e===t.name||e===t.uuid)return t;if(t.skeleton){const r=t.skeleton.getBoneByName(e);if(r!==void 0)return r}if(t.children){const r=function(s){for(let o=0;o<s.length;o++){const l=s[o];if(l.name===e||l.uuid===e)return l;const u=r(l.children);if(u)return u}return null},i=r(t.children);if(i)return i}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(t,e){t[e]=this.targetObject[this.propertyName]}_getValue_array(t,e){const r=this.resolvedProperty;for(let i=0,s=r.length;i!==s;++i)t[e++]=r[i]}_getValue_arrayElement(t,e){t[e]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(t,e){this.resolvedProperty.toArray(t,e)}_setValue_direct(t,e){this.targetObject[this.propertyName]=t[e]}_setValue_direct_setNeedsUpdate(t,e){this.targetObject[this.propertyName]=t[e],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(t,e){this.targetObject[this.propertyName]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(t,e){const r=this.resolvedProperty;for(let i=0,s=r.length;i!==s;++i)r[i]=t[e++]}_setValue_array_setNeedsUpdate(t,e){const r=this.resolvedProperty;for(let i=0,s=r.length;i!==s;++i)r[i]=t[e++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(t,e){const r=this.resolvedProperty;for(let i=0,s=r.length;i!==s;++i)r[i]=t[e++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(t,e){this.resolvedProperty[this.propertyIndex]=t[e]}_setValue_arrayElement_setNeedsUpdate(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(t,e){this.resolvedProperty.fromArray(t,e)}_setValue_fromArray_setNeedsUpdate(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(t,e){this.bind(),this.getValue(t,e)}_setValue_unbound(t,e){this.bind(),this.setValue(t,e)}bind(){let t=this.node;const e=this.parsedPath,r=e.objectName,i=e.propertyName;let s=e.propertyIndex;if(t||(t=Xt.findNode(this.rootNode,e.nodeName),this.node=t),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!t){console.warn("THREE.PropertyBinding: No target node found for track: "+this.path+".");return}if(r){let f=e.objectIndex;switch(r){case"materials":if(!t.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!t.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}t=t.material.materials;break;case"bones":if(!t.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}t=t.skeleton.bones;for(let d=0;d<t.length;d++)if(t[d].name===f){f=d;break}break;case"map":if("map"in t){t=t.map;break}if(!t.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!t.material.map){console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);return}t=t.material.map;break;default:if(t[r]===void 0){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}t=t[r]}if(f!==void 0){if(t[f]===void 0){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,t);return}t=t[f]}}const o=t[i];if(o===void 0){const f=e.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+f+"."+i+" but it wasn't found.",t);return}let l=this.Versioning.None;this.targetObject=t,t.isMaterial===!0?l=this.Versioning.NeedsUpdate:t.isObject3D===!0&&(l=this.Versioning.MatrixWorldNeedsUpdate);let u=this.BindingType.Direct;if(s!==void 0){if(i==="morphTargetInfluences"){if(!t.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(!t.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}t.morphTargetDictionary[s]!==void 0&&(s=t.morphTargetDictionary[s])}u=this.BindingType.ArrayElement,this.resolvedProperty=o,this.propertyIndex=s}else o.fromArray!==void 0&&o.toArray!==void 0?(u=this.BindingType.HasFromToArray,this.resolvedProperty=o):Array.isArray(o)?(u=this.BindingType.EntireArray,this.resolvedProperty=o):this.propertyName=i;this.getValue=this.GetterByBindingType[u],this.setValue=this.SetterByBindingTypeAndVersioning[u][l]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}Xt.Composite=P_;Xt.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3};Xt.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2};Xt.prototype.GetterByBindingType=[Xt.prototype._getValue_direct,Xt.prototype._getValue_array,Xt.prototype._getValue_arrayElement,Xt.prototype._getValue_toArray];Xt.prototype.SetterByBindingTypeAndVersioning=[[Xt.prototype._setValue_direct,Xt.prototype._setValue_direct_setNeedsUpdate,Xt.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[Xt.prototype._setValue_array,Xt.prototype._setValue_array_setNeedsUpdate,Xt.prototype._setValue_array_setMatrixWorldNeedsUpdate],[Xt.prototype._setValue_arrayElement,Xt.prototype._setValue_arrayElement_setNeedsUpdate,Xt.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[Xt.prototype._setValue_fromArray,Xt.prototype._setValue_fromArray_setNeedsUpdate,Xt.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:xl}}));typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=xl);const $u={POSITION:["byte","byte normalized","unsigned byte","unsigned byte normalized","short","short normalized","unsigned short","unsigned short normalized"],NORMAL:["byte normalized","short normalized"],TANGENT:["byte normalized","short normalized"],TEXCOORD:["byte","byte normalized","unsigned byte","short","short normalized","unsigned short"]};class Pa{constructor(){this.textureUtils=null,this.pluginCallbacks=[],this.register(function(t){return new U_(t)}),this.register(function(t){return new Z_(t)}),this.register(function(t){return new V_(t)}),this.register(function(t){return new q_(t)}),this.register(function(t){return new Y_(t)}),this.register(function(t){return new j_(t)}),this.register(function(t){return new G_(t)}),this.register(function(t){return new H_(t)}),this.register(function(t){return new W_(t)}),this.register(function(t){return new X_(t)}),this.register(function(t){return new J_(t)}),this.register(function(t){return new $_(t)}),this.register(function(t){return new K_(t)}),this.register(function(t){return new Q_(t)})}register(t){return this.pluginCallbacks.indexOf(t)===-1&&this.pluginCallbacks.push(t),this}unregister(t){return this.pluginCallbacks.indexOf(t)!==-1&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(t),1),this}setTextureUtils(t){return this.textureUtils=t,this}parse(t,e,r,i){const s=new F_,o=[];for(let l=0,u=this.pluginCallbacks.length;l<u;l++)o.push(this.pluginCallbacks[l](s));s.setPlugins(o),s.setTextureUtils(this.textureUtils),s.writeAsync(t,e,i).catch(r)}parseAsync(t,e){const r=this;return new Promise(function(i,s){r.parse(t,i,s,e)})}}const qt={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,BYTE:5120,UNSIGNED_BYTE:5121,SHORT:5122,UNSIGNED_SHORT:5123,INT:5124,UNSIGNED_INT:5125,FLOAT:5126,ARRAY_BUFFER:34962,ELEMENT_ARRAY_BUFFER:34963,NEAREST:9728,LINEAR:9729,NEAREST_MIPMAP_NEAREST:9984,LINEAR_MIPMAP_NEAREST:9985,NEAREST_MIPMAP_LINEAR:9986,LINEAR_MIPMAP_LINEAR:9987,CLAMP_TO_EDGE:33071,MIRRORED_REPEAT:33648,REPEAT:10497},Dh="KHR_mesh_quantization",ei={};ei[Kp]=qt.NEAREST;ei[Qp]=qt.NEAREST_MIPMAP_NEAREST;ei[tm]=qt.NEAREST_MIPMAP_LINEAR;ei[Jc]=qt.LINEAR;ei[em]=qt.LINEAR_MIPMAP_NEAREST;ei[$c]=qt.LINEAR_MIPMAP_LINEAR;ei[Zs]=qt.CLAMP_TO_EDGE;ei[Kh]=qt.REPEAT;ei[Qh]=qt.MIRRORED_REPEAT;const Ku={scale:"scale",position:"translation",quaternion:"rotation",morphTargetInfluences:"weights"},C_=new or,Qu=12,z_=1179937895,I_=2,tc=8,O_=1313821514,R_=5130562;function Gs(h,t){return h.length===t.length&&h.every(function(e,r){return e===t[r]})}function D_(h){return new TextEncoder().encode(h).buffer}function B_(h){return Gs(h.elements,[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}function N_(h,t,e){const r={min:new Array(h.itemSize).fill(Number.POSITIVE_INFINITY),max:new Array(h.itemSize).fill(Number.NEGATIVE_INFINITY)};for(let i=t;i<t+e;i++)for(let s=0;s<h.itemSize;s++){let o;h.itemSize>4?o=h.array[i*h.itemSize+s]:(s===0?o=h.getX(i):s===1?o=h.getY(i):s===2?o=h.getZ(i):s===3&&(o=h.getW(i)),h.normalized===!0&&(o=tl.normalize(o,h.array))),r.min[s]=Math.min(r.min[s],o),r.max[s]=Math.max(r.max[s],o)}return r}function df(h){return Math.ceil(h/4)*4}function Bh(h,t=0){const e=df(h.byteLength);if(e!==h.byteLength){const r=new Uint8Array(e);if(r.set(new Uint8Array(h)),t!==0)for(let i=h.byteLength;i<e;i++)r[i]=t;return r.buffer}return h}function ec(){return typeof document>"u"&&typeof OffscreenCanvas<"u"?new OffscreenCanvas(1,1):document.createElement("canvas")}function ic(h,t){if(h.toBlob!==void 0)return new Promise(r=>h.toBlob(r,t));let e;return t==="image/jpeg"?e=.92:t==="image/webp"&&(e=.8),h.convertToBlob({type:t,quality:e})}class F_{constructor(){this.plugins=[],this.options={},this.pending=[],this.buffers=[],this.byteOffset=0,this.buffers=[],this.nodeMap=new Map,this.skins=[],this.extensionsUsed={},this.extensionsRequired={},this.uids=new Map,this.uid=0,this.json={asset:{version:"2.0",generator:"THREE.GLTFExporter r"+xl}},this.cache={meshes:new Map,attributes:new Map,attributesNormalized:new Map,materials:new Map,textures:new Map,images:new Map},this.textureUtils=null}setPlugins(t){this.plugins=t}setTextureUtils(t){this.textureUtils=t}async writeAsync(t,e,r={}){this.options=Object.assign({binary:!1,trs:!1,onlyVisible:!0,maxTextureSize:1/0,animations:[],includeCustomExtensions:!1},r),this.options.animations.length>0&&(this.options.trs=!0),await this.processInputAsync(t),await Promise.all(this.pending);const i=this,s=i.buffers,o=i.json;r=i.options;const l=i.extensionsUsed,u=i.extensionsRequired,f=new Blob(s,{type:"application/octet-stream"}),d=Object.keys(l),p=Object.keys(u);if(d.length>0&&(o.extensionsUsed=d),p.length>0&&(o.extensionsRequired=p),o.buffers&&o.buffers.length>0&&(o.buffers[0].byteLength=f.size),r.binary===!0){const g=new FileReader;g.readAsArrayBuffer(f),g.onloadend=function(){const m=Bh(g.result),x=new DataView(new ArrayBuffer(tc));x.setUint32(0,m.byteLength,!0),x.setUint32(4,R_,!0);const y=Bh(D_(JSON.stringify(o)),32),b=new DataView(new ArrayBuffer(tc));b.setUint32(0,y.byteLength,!0),b.setUint32(4,O_,!0);const P=new ArrayBuffer(Qu),A=new DataView(P);A.setUint32(0,z_,!0),A.setUint32(4,I_,!0);const N=Qu+b.byteLength+y.byteLength+x.byteLength+m.byteLength;A.setUint32(8,N,!0);const G=new Blob([P,b,y,x,m],{type:"application/octet-stream"}),z=new FileReader;z.readAsArrayBuffer(G),z.onloadend=function(){e(z.result)}}}else if(o.buffers&&o.buffers.length>0){const g=new FileReader;g.readAsDataURL(f),g.onloadend=function(){const m=g.result;o.buffers[0].uri=m,e(o)}}else e(o)}serializeUserData(t,e){if(Object.keys(t.userData).length===0)return;const r=this.options,i=this.extensionsUsed;try{const s=JSON.parse(JSON.stringify(t.userData));if(r.includeCustomExtensions&&s.gltfExtensions){e.extensions===void 0&&(e.extensions={});for(const o in s.gltfExtensions)e.extensions[o]=s.gltfExtensions[o],i[o]=!0;delete s.gltfExtensions}Object.keys(s).length>0&&(e.extras=s)}catch(s){console.warn("THREE.GLTFExporter: userData of '"+t.name+"' won't be serialized because of JSON.stringify error - "+s.message)}}getUID(t,e=!1){if(this.uids.has(t)===!1){const i=new Map;i.set(!0,this.uid++),i.set(!1,this.uid++),this.uids.set(t,i)}return this.uids.get(t).get(e)}isNormalizedNormalAttribute(t){if(this.cache.attributesNormalized.has(t))return!1;const r=new ut;for(let i=0,s=t.count;i<s;i++)if(Math.abs(r.fromBufferAttribute(t,i).length()-1)>5e-4)return!1;return!0}createNormalizedNormalAttribute(t){const e=this.cache;if(e.attributesNormalized.has(t))return e.attributesNormalized.get(t);const r=t.clone(),i=new ut;for(let s=0,o=r.count;s<o;s++)i.fromBufferAttribute(r,s),i.x===0&&i.y===0&&i.z===0?i.setX(1):i.normalize(),r.setXYZ(s,i.x,i.y,i.z);return e.attributesNormalized.set(t,r),r}applyTextureTransform(t,e){let r=!1;const i={};(e.offset.x!==0||e.offset.y!==0)&&(i.offset=e.offset.toArray(),r=!0),e.rotation!==0&&(i.rotation=e.rotation,r=!0),(e.repeat.x!==1||e.repeat.y!==1)&&(i.scale=e.repeat.toArray(),r=!0),r&&(t.extensions=t.extensions||{},t.extensions.KHR_texture_transform=i,this.extensionsUsed.KHR_texture_transform=!0)}async buildMetalRoughTextureAsync(t,e){if(t===e)return t;function r(m){return m.colorSpace===gi?function(y){return y<.04045?y*.0773993808:Math.pow(y*.9478672986+.0521327014,2.4)}:function(y){return y}}t instanceof zh&&(t=await this.decompressTextureAsync(t)),e instanceof zh&&(e=await this.decompressTextureAsync(e));const i=t?t.image:null,s=e?e.image:null,o=Math.max(i?i.width:0,s?s.width:0),l=Math.max(i?i.height:0,s?s.height:0),u=ec();u.width=o,u.height=l;const f=u.getContext("2d",{willReadFrequently:!0});f.fillStyle="#00ffff",f.fillRect(0,0,o,l);const d=f.getImageData(0,0,o,l);if(i){f.drawImage(i,0,0,o,l);const m=r(t),x=f.getImageData(0,0,o,l).data;for(let y=2;y<x.length;y+=4)d.data[y]=m(x[y]/256)*256}if(s){f.drawImage(s,0,0,o,l);const m=r(e),x=f.getImageData(0,0,o,l).data;for(let y=1;y<x.length;y+=4)d.data[y]=m(x[y]/256)*256}f.putImageData(d,0,0);const g=(t||e).clone();return g.source=new ef(u),g.colorSpace=wl,g.channel=(t||e).channel,t&&e&&t.channel!==e.channel&&console.warn("THREE.GLTFExporter: UV channels for metalnessMap and roughnessMap textures must match."),console.warn("THREE.GLTFExporter: Merged metalnessMap and roughnessMap textures."),g}async decompressTextureAsync(t,e=1/0){if(this.textureUtils===null)throw new Error("THREE.GLTFExporter: setTextureUtils() must be called to process compressed textures.");return await this.textureUtils.decompress(t,e)}processBuffer(t){const e=this.json,r=this.buffers;return e.buffers||(e.buffers=[{byteLength:0}]),r.push(t),0}processBufferView(t,e,r,i,s){const o=this.json;o.bufferViews||(o.bufferViews=[]);let l;switch(e){case qt.BYTE:case qt.UNSIGNED_BYTE:l=1;break;case qt.SHORT:case qt.UNSIGNED_SHORT:l=2;break;default:l=4}let u=t.itemSize*l;s===qt.ARRAY_BUFFER&&(u=Math.ceil(u/4)*4);const f=df(i*u),d=new DataView(new ArrayBuffer(f));let p=0;for(let x=r;x<r+i;x++){for(let y=0;y<t.itemSize;y++){let b;t.itemSize>4?b=t.array[x*t.itemSize+y]:(y===0?b=t.getX(x):y===1?b=t.getY(x):y===2?b=t.getZ(x):y===3&&(b=t.getW(x)),t.normalized===!0&&(b=tl.normalize(b,t.array))),e===qt.FLOAT?d.setFloat32(p,b,!0):e===qt.INT?d.setInt32(p,b,!0):e===qt.UNSIGNED_INT?d.setUint32(p,b,!0):e===qt.SHORT?d.setInt16(p,b,!0):e===qt.UNSIGNED_SHORT?d.setUint16(p,b,!0):e===qt.BYTE?d.setInt8(p,b):e===qt.UNSIGNED_BYTE&&d.setUint8(p,b),p+=l}p%u!==0&&(p+=u-p%u)}const g={buffer:this.processBuffer(d.buffer),byteOffset:this.byteOffset,byteLength:f};return s!==void 0&&(g.target=s),s===qt.ARRAY_BUFFER&&(g.byteStride=u),this.byteOffset+=f,o.bufferViews.push(g),{id:o.bufferViews.length-1,byteLength:0}}processBufferViewImage(t){const e=this,r=e.json;return r.bufferViews||(r.bufferViews=[]),new Promise(function(i){const s=new FileReader;s.readAsArrayBuffer(t),s.onloadend=function(){const o=Bh(s.result),l={buffer:e.processBuffer(o),byteOffset:e.byteOffset,byteLength:o.byteLength};e.byteOffset+=o.byteLength,i(r.bufferViews.push(l)-1)}})}processAccessor(t,e,r,i){const s=this.json,o={1:"SCALAR",2:"VEC2",3:"VEC3",4:"VEC4",9:"MAT3",16:"MAT4"};let l;if(t.array.constructor===Float32Array)l=qt.FLOAT;else if(t.array.constructor===Int32Array)l=qt.INT;else if(t.array.constructor===Uint32Array)l=qt.UNSIGNED_INT;else if(t.array.constructor===Int16Array)l=qt.SHORT;else if(t.array.constructor===Uint16Array)l=qt.UNSIGNED_SHORT;else if(t.array.constructor===Int8Array)l=qt.BYTE;else if(t.array.constructor===Uint8Array)l=qt.UNSIGNED_BYTE;else throw new Error("THREE.GLTFExporter: Unsupported bufferAttribute component type: "+t.array.constructor.name);if(r===void 0&&(r=0),(i===void 0||i===1/0)&&(i=t.count),i===0)return null;const u=N_(t,r,i);let f;e!==void 0&&(f=t===e.index?qt.ELEMENT_ARRAY_BUFFER:qt.ARRAY_BUFFER);const d=this.processBufferView(t,l,r,i,f),p={bufferView:d.id,byteOffset:d.byteOffset,componentType:l,count:i,max:u.max,min:u.min,type:o[t.itemSize]};return t.normalized===!0&&(p.normalized=!0),s.accessors||(s.accessors=[]),s.accessors.push(p)-1}processImage(t,e,r,i="image/png"){if(t!==null){const s=this,o=s.cache,l=s.json,u=s.options,f=s.pending;o.images.has(t)||o.images.set(t,{});const d=o.images.get(t),p=i+":flipY/"+r.toString();if(d[p]!==void 0)return d[p];l.images||(l.images=[]);const g={mimeType:i},m=ec();m.width=Math.min(t.width,u.maxTextureSize),m.height=Math.min(t.height,u.maxTextureSize);const x=m.getContext("2d",{willReadFrequently:!0});if(r===!0&&(x.translate(0,m.height),x.scale(1,-1)),t.data!==void 0){e!==Kc&&console.error("GLTFExporter: Only RGBAFormat is supported.",e),(t.width>u.maxTextureSize||t.height>u.maxTextureSize)&&console.warn("GLTFExporter: Image size is bigger than maxTextureSize",t);const b=new Uint8ClampedArray(t.height*t.width*4);for(let P=0;P<b.length;P+=4)b[P+0]=t.data[P+0],b[P+1]=t.data[P+1],b[P+2]=t.data[P+2],b[P+3]=t.data[P+3];x.putImageData(new ImageData(b,t.width,t.height),0,0)}else if(typeof HTMLImageElement<"u"&&t instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&t instanceof ImageBitmap||typeof OffscreenCanvas<"u"&&t instanceof OffscreenCanvas)x.drawImage(t,0,0,m.width,m.height);else throw new Error("THREE.GLTFExporter: Invalid image type. Use HTMLImageElement, HTMLCanvasElement, ImageBitmap or OffscreenCanvas.");u.binary===!0?f.push(ic(m,i).then(b=>s.processBufferViewImage(b)).then(b=>{g.bufferView=b})):m.toDataURL!==void 0?g.uri=m.toDataURL(i):f.push(ic(m,i).then(b=>new FileReader().readAsDataURL(b)).then(b=>{g.uri=b}));const y=l.images.push(g)-1;return d[p]=y,y}else throw new Error("THREE.GLTFExporter: No valid image data found. Unable to process texture.")}processSampler(t){const e=this.json;e.samplers||(e.samplers=[]);const r={magFilter:ei[t.magFilter],minFilter:ei[t.minFilter],wrapS:ei[t.wrapS],wrapT:ei[t.wrapT]};return e.samplers.push(r)-1}async processTextureAsync(t){const r=this.options,i=this.cache,s=this.json;if(i.textures.has(t))return i.textures.get(t);s.textures||(s.textures=[]),t instanceof zh&&(t=await this.decompressTextureAsync(t,r.maxTextureSize));let o=t.userData.mimeType;o==="image/webp"&&(o="image/png");const l={sampler:this.processSampler(t),source:this.processImage(t.image,t.format,t.flipY,o)};t.name&&(l.name=t.name),await this._invokeAllAsync(async function(f){f.writeTexture&&await f.writeTexture(t,l)});const u=s.textures.push(l)-1;return i.textures.set(t,u),u}async processMaterialAsync(t){const e=this.cache,r=this.json;if(e.materials.has(t))return e.materials.get(t);if(t.isShaderMaterial)return console.warn("GLTFExporter: THREE.ShaderMaterial not supported."),null;r.materials||(r.materials=[]);const i={pbrMetallicRoughness:{}};t.isMeshStandardMaterial!==!0&&t.isMeshBasicMaterial!==!0&&console.warn("GLTFExporter: Use MeshStandardMaterial or MeshBasicMaterial for best results.");const s=t.color.toArray().concat([t.opacity]);if(Gs(s,[1,1,1,1])||(i.pbrMetallicRoughness.baseColorFactor=s),t.isMeshStandardMaterial?(i.pbrMetallicRoughness.metallicFactor=t.metalness,i.pbrMetallicRoughness.roughnessFactor=t.roughness):(i.pbrMetallicRoughness.metallicFactor=0,i.pbrMetallicRoughness.roughnessFactor=1),t.metalnessMap||t.roughnessMap){const l=await this.buildMetalRoughTextureAsync(t.metalnessMap,t.roughnessMap),u={index:await this.processTextureAsync(l),texCoord:l.channel};this.applyTextureTransform(u,l),i.pbrMetallicRoughness.metallicRoughnessTexture=u}if(t.map){const l={index:await this.processTextureAsync(t.map),texCoord:t.map.channel};this.applyTextureTransform(l,t.map),i.pbrMetallicRoughness.baseColorTexture=l}if(t.emissive){const l=t.emissive;if(Math.max(l.r,l.g,l.b)>0&&(i.emissiveFactor=t.emissive.toArray()),t.emissiveMap){const f={index:await this.processTextureAsync(t.emissiveMap),texCoord:t.emissiveMap.channel};this.applyTextureTransform(f,t.emissiveMap),i.emissiveTexture=f}}if(t.normalMap){const l={index:await this.processTextureAsync(t.normalMap),texCoord:t.normalMap.channel};t.normalScale&&t.normalScale.x!==1&&(l.scale=t.normalScale.x),this.applyTextureTransform(l,t.normalMap),i.normalTexture=l}if(t.aoMap){const l={index:await this.processTextureAsync(t.aoMap),texCoord:t.aoMap.channel};t.aoMapIntensity!==1&&(l.strength=t.aoMapIntensity),this.applyTextureTransform(l,t.aoMap),i.occlusionTexture=l}t.transparent?i.alphaMode="BLEND":t.alphaTest>0&&(i.alphaMode="MASK",i.alphaCutoff=t.alphaTest),t.side===jc&&(i.doubleSided=!0),t.name!==""&&(i.name=t.name),this.serializeUserData(t,i),await this._invokeAllAsync(async function(l){l.writeMaterialAsync&&await l.writeMaterialAsync(t,i)});const o=r.materials.push(i)-1;return e.materials.set(t,o),o}async processMeshAsync(t){const e=this.cache,r=this.json,i=[t.geometry.uuid];if(Array.isArray(t.material))for(let G=0,z=t.material.length;G<z;G++)i.push(t.material[G].uuid);else i.push(t.material.uuid);const s=i.join(":");if(e.meshes.has(s))return e.meshes.get(s);const o=t.geometry;let l;t.isLineSegments?l=qt.LINES:t.isLineLoop?l=qt.LINE_LOOP:t.isLine?l=qt.LINE_STRIP:t.isPoints?l=qt.POINTS:l=t.material.wireframe?qt.LINES:qt.TRIANGLES;const u={},f={},d=[],p=[],g={uv:"TEXCOORD_0",uv1:"TEXCOORD_1",uv2:"TEXCOORD_2",uv3:"TEXCOORD_3",color:"COLOR_0",skinWeight:"WEIGHTS_0",skinIndex:"JOINTS_0"},m=o.getAttribute("normal");m!==void 0&&!this.isNormalizedNormalAttribute(m)&&(console.warn("THREE.GLTFExporter: Creating normalized normal attribute from the non-normalized one."),o.setAttribute("normal",this.createNormalizedNormalAttribute(m)));let x=null;for(let G in o.attributes){if(G.slice(0,5)==="morph")continue;const z=o.attributes[G];if(G=g[G]||G.toUpperCase(),/^(POSITION|NORMAL|TANGENT|TEXCOORD_\d+|COLOR_\d+|JOINTS_\d+|WEIGHTS_\d+)$/.test(G)||(G="_"+G),e.attributes.has(this.getUID(z))){f[G]=e.attributes.get(this.getUID(z));continue}x=null;const q=z.array;G==="JOINTS_0"&&!(q instanceof Uint16Array)&&!(q instanceof Uint8Array)?(console.warn('GLTFExporter: Attribute "skinIndex" converted to type UNSIGNED_SHORT.'),x=new Ne(new Uint16Array(q),z.itemSize,z.normalized)):(q instanceof Uint32Array||q instanceof Int32Array)&&!G.startsWith("_")&&(console.warn(`GLTFExporter: Attribute "${G}" converted to type FLOAT.`),x=Pa.Utils.toFloat32BufferAttribute(z));const T=this.processAccessor(x||z,o);T!==null&&(G.startsWith("_")||this.detectMeshQuantization(G,z),f[G]=T,e.attributes.set(this.getUID(z),T))}if(m!==void 0&&o.setAttribute("normal",m),Object.keys(f).length===0)return null;if(t.morphTargetInfluences!==void 0&&t.morphTargetInfluences.length>0){const G=[],z=[],K={};if(t.morphTargetDictionary!==void 0)for(const q in t.morphTargetDictionary)K[t.morphTargetDictionary[q]]=q;for(let q=0;q<t.morphTargetInfluences.length;++q){const T={};let k=!1;for(const I in o.morphAttributes){if(I!=="position"&&I!=="normal"){k||(console.warn("GLTFExporter: Only POSITION and NORMAL morph are supported."),k=!0);continue}const F=o.morphAttributes[I][q],S=I.toUpperCase(),O=o.attributes[I];if(e.attributes.has(this.getUID(F,!0))){T[S]=e.attributes.get(this.getUID(F,!0));continue}const v=F.clone();if(!o.morphTargetsRelative)for(let C=0,U=F.count;C<U;C++)for(let H=0;H<F.itemSize;H++)H===0&&v.setX(C,F.getX(C)-O.getX(C)),H===1&&v.setY(C,F.getY(C)-O.getY(C)),H===2&&v.setZ(C,F.getZ(C)-O.getZ(C)),H===3&&v.setW(C,F.getW(C)-O.getW(C));T[S]=this.processAccessor(v,o),e.attributes.set(this.getUID(O,!0),T[S])}p.push(T),G.push(t.morphTargetInfluences[q]),t.morphTargetDictionary!==void 0&&z.push(K[q])}u.weights=G,z.length>0&&(u.extras={},u.extras.targetNames=z)}const y=Array.isArray(t.material);if(y&&o.groups.length===0)return null;let b=!1;if(y&&o.index===null){const G=[];for(let z=0,K=o.attributes.position.count;z<K;z++)G[z]=z;o.setIndex(G),b=!0}const P=y?t.material:[t.material],A=y?o.groups:[{materialIndex:0,start:void 0,count:void 0}];for(let G=0,z=A.length;G<z;G++){const K={mode:l,attributes:f};if(this.serializeUserData(o,K),p.length>0&&(K.targets=p),o.index!==null){let T=this.getUID(o.index);(A[G].start!==void 0||A[G].count!==void 0)&&(T+=":"+A[G].start+":"+A[G].count),e.attributes.has(T)?K.indices=e.attributes.get(T):(K.indices=this.processAccessor(o.index,o,A[G].start,A[G].count),e.attributes.set(T,K.indices)),K.indices===null&&delete K.indices}const q=await this.processMaterialAsync(P[A[G].materialIndex]);q!==null&&(K.material=q),d.push(K)}b===!0&&o.setIndex(null),u.primitives=d,r.meshes||(r.meshes=[]),await this._invokeAllAsync(function(G){G.writeMesh&&G.writeMesh(t,u)});const N=r.meshes.push(u)-1;return e.meshes.set(s,N),N}detectMeshQuantization(t,e){if(this.extensionsUsed[Dh])return;let r;switch(e.array.constructor){case Int8Array:r="byte";break;case Uint8Array:r="unsigned byte";break;case Int16Array:r="short";break;case Uint16Array:r="unsigned short";break;default:return}e.normalized&&(r+=" normalized");const i=t.split("_",1)[0];$u[i]&&$u[i].includes(r)&&(this.extensionsUsed[Dh]=!0,this.extensionsRequired[Dh]=!0)}processCamera(t){const e=this.json;e.cameras||(e.cameras=[]);const r=t.isOrthographicCamera,i={type:r?"orthographic":"perspective"};return r?i.orthographic={xmag:t.right*2,ymag:t.top*2,zfar:t.far<=0?.001:t.far,znear:t.near<0?0:t.near}:i.perspective={aspectRatio:t.aspect,yfov:tl.degToRad(t.fov),zfar:t.far<=0?.001:t.far,znear:t.near<0?0:t.near},t.name!==""&&(i.name=t.type),e.cameras.push(i)-1}processAnimation(t,e){const r=this.json,i=this.nodeMap;r.animations||(r.animations=[]),t=Pa.Utils.mergeMorphTargetTracks(t.clone(),e);const s=t.tracks,o=[],l=[];for(let u=0;u<s.length;++u){const f=s[u],d=Xt.parseTrackName(f.name);let p=Xt.findNode(e,d.nodeName);const g=Ku[d.propertyName];if(d.objectName==="bones"&&(p.isSkinnedMesh===!0?p=p.skeleton.getBoneByName(d.objectIndex):p=void 0),!p||!g){console.warn('THREE.GLTFExporter: Could not export animation track "%s".',f.name);continue}const m=1;let x=f.values.length/f.times.length;g===Ku.morphTargetInfluences&&(x/=p.morphTargetInfluences.length);let y;f.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline===!0?(y="CUBICSPLINE",x/=3):f.getInterpolation()===rm?y="STEP":y="LINEAR",l.push({input:this.processAccessor(new Ne(f.times,m)),output:this.processAccessor(new Ne(f.values,x)),interpolation:y}),o.push({sampler:l.length-1,target:{node:i.get(p),path:g}})}return r.animations.push({name:t.name||"clip_"+r.animations.length,samplers:l,channels:o}),r.animations.length-1}processSkin(t){const e=this.json,r=this.nodeMap,i=e.nodes[r.get(t)],s=t.skeleton;if(s===void 0)return null;const o=t.skeleton.bones[0];if(o===void 0)return null;const l=[],u=new Float32Array(s.bones.length*16),f=new qe;for(let p=0;p<s.bones.length;++p)l.push(r.get(s.bones[p])),f.copy(s.boneInverses[p]),f.multiply(t.bindMatrix).toArray(u,p*16);return e.skins===void 0&&(e.skins=[]),e.skins.push({inverseBindMatrices:this.processAccessor(new Ne(u,16)),joints:l,skeleton:r.get(o)}),i.skin=e.skins.length-1}async processNodeAsync(t){const e=this.json,r=this.options,i=this.nodeMap;e.nodes||(e.nodes=[]);const s={};if(r.trs){const l=t.quaternion.toArray(),u=t.position.toArray(),f=t.scale.toArray();Gs(l,[0,0,0,1])||(s.rotation=l),Gs(u,[0,0,0])||(s.translation=u),Gs(f,[1,1,1])||(s.scale=f)}else t.matrixAutoUpdate&&t.updateMatrix(),B_(t.matrix)===!1&&(s.matrix=t.matrix.elements);if(t.name!==""&&(s.name=String(t.name)),this.serializeUserData(t,s),t.isMesh||t.isLine||t.isPoints){const l=await this.processMeshAsync(t);l!==null&&(s.mesh=l)}else t.isCamera&&(s.camera=this.processCamera(t));if(t.isSkinnedMesh&&this.skins.push(t),t.children.length>0){const l=[];for(let u=0,f=t.children.length;u<f;u++){const d=t.children[u];if(d.visible||r.onlyVisible===!1){const p=await this.processNodeAsync(d);p!==null&&l.push(p)}}l.length>0&&(s.children=l)}await this._invokeAllAsync(function(l){l.writeNode&&l.writeNode(t,s)});const o=e.nodes.push(s)-1;return i.set(t,o),o}async processSceneAsync(t){const e=this.json,r=this.options;e.scenes||(e.scenes=[],e.scene=0);const i={};t.name!==""&&(i.name=t.name),e.scenes.push(i);const s=[];for(let o=0,l=t.children.length;o<l;o++){const u=t.children[o];if(u.visible||r.onlyVisible===!1){const f=await this.processNodeAsync(u);f!==null&&s.push(f)}}s.length>0&&(i.nodes=s),this.serializeUserData(t,i)}async processObjectsAsync(t){const e=new el;e.name="AuxScene";for(let r=0;r<t.length;r++)e.children.push(t[r]);await this.processSceneAsync(e)}async processInputAsync(t){const e=this.options;t=t instanceof Array?t:[t],await this._invokeAllAsync(function(i){i.beforeParse&&i.beforeParse(t)});const r=[];for(let i=0;i<t.length;i++)t[i]instanceof el?await this.processSceneAsync(t[i]):r.push(t[i]);r.length>0&&await this.processObjectsAsync(r);for(let i=0;i<this.skins.length;++i)this.processSkin(this.skins[i]);for(let i=0;i<e.animations.length;++i)this.processAnimation(e.animations[i],t[0]);await this._invokeAllAsync(function(i){i.afterParse&&i.afterParse(t)})}async _invokeAllAsync(t){for(let e=0,r=this.plugins.length;e<r;e++)await t(this.plugins[e])}}class U_{constructor(t){this.writer=t,this.name="KHR_lights_punctual"}writeNode(t,e){if(!t.isLight)return;if(!t.isDirectionalLight&&!t.isPointLight&&!t.isSpotLight){console.warn("THREE.GLTFExporter: Only directional, point, and spot lights are supported.",t);return}const r=this.writer,i=r.json,s=r.extensionsUsed,o={};t.name&&(o.name=t.name),o.color=t.color.toArray(),o.intensity=t.intensity,t.isDirectionalLight?o.type="directional":t.isPointLight?(o.type="point",t.distance>0&&(o.range=t.distance)):t.isSpotLight&&(o.type="spot",t.distance>0&&(o.range=t.distance),o.spot={},o.spot.innerConeAngle=(1-t.penumbra)*t.angle,o.spot.outerConeAngle=t.angle),t.decay!==void 0&&t.decay!==2&&console.warn("THREE.GLTFExporter: Light decay may be lost. glTF is physically-based, and expects light.decay=2."),t.target&&(t.target.parent!==t||t.target.position.x!==0||t.target.position.y!==0||t.target.position.z!==-1)&&console.warn("THREE.GLTFExporter: Light direction may be lost. For best results, make light.target a child of the light with position 0,0,-1."),s[this.name]||(i.extensions=i.extensions||{},i.extensions[this.name]={lights:[]},s[this.name]=!0);const l=i.extensions[this.name].lights;l.push(o),e.extensions=e.extensions||{},e.extensions[this.name]={light:l.length-1}}}class Z_{constructor(t){this.writer=t,this.name="KHR_materials_unlit"}async writeMaterialAsync(t,e){if(!t.isMeshBasicMaterial)return;const i=this.writer.extensionsUsed;e.extensions=e.extensions||{},e.extensions[this.name]={},i[this.name]=!0,e.pbrMetallicRoughness.metallicFactor=0,e.pbrMetallicRoughness.roughnessFactor=.9}}class G_{constructor(t){this.writer=t,this.name="KHR_materials_clearcoat"}async writeMaterialAsync(t,e){if(!t.isMeshPhysicalMaterial||t.clearcoat===0)return;const r=this.writer,i=r.extensionsUsed,s={};if(s.clearcoatFactor=t.clearcoat,t.clearcoatMap){const o={index:await r.processTextureAsync(t.clearcoatMap),texCoord:t.clearcoatMap.channel};r.applyTextureTransform(o,t.clearcoatMap),s.clearcoatTexture=o}if(s.clearcoatRoughnessFactor=t.clearcoatRoughness,t.clearcoatRoughnessMap){const o={index:await r.processTextureAsync(t.clearcoatRoughnessMap),texCoord:t.clearcoatRoughnessMap.channel};r.applyTextureTransform(o,t.clearcoatRoughnessMap),s.clearcoatRoughnessTexture=o}if(t.clearcoatNormalMap){const o={index:await r.processTextureAsync(t.clearcoatNormalMap),texCoord:t.clearcoatNormalMap.channel};t.clearcoatNormalScale.x!==1&&(o.scale=t.clearcoatNormalScale.x),r.applyTextureTransform(o,t.clearcoatNormalMap),s.clearcoatNormalTexture=o}e.extensions=e.extensions||{},e.extensions[this.name]=s,i[this.name]=!0}}class H_{constructor(t){this.writer=t,this.name="KHR_materials_dispersion"}async writeMaterialAsync(t,e){if(!t.isMeshPhysicalMaterial||t.dispersion===0)return;const i=this.writer.extensionsUsed,s={};s.dispersion=t.dispersion,e.extensions=e.extensions||{},e.extensions[this.name]=s,i[this.name]=!0}}class W_{constructor(t){this.writer=t,this.name="KHR_materials_iridescence"}async writeMaterialAsync(t,e){if(!t.isMeshPhysicalMaterial||t.iridescence===0)return;const r=this.writer,i=r.extensionsUsed,s={};if(s.iridescenceFactor=t.iridescence,t.iridescenceMap){const o={index:await r.processTextureAsync(t.iridescenceMap),texCoord:t.iridescenceMap.channel};r.applyTextureTransform(o,t.iridescenceMap),s.iridescenceTexture=o}if(s.iridescenceIor=t.iridescenceIOR,s.iridescenceThicknessMinimum=t.iridescenceThicknessRange[0],s.iridescenceThicknessMaximum=t.iridescenceThicknessRange[1],t.iridescenceThicknessMap){const o={index:await r.processTextureAsync(t.iridescenceThicknessMap),texCoord:t.iridescenceThicknessMap.channel};r.applyTextureTransform(o,t.iridescenceThicknessMap),s.iridescenceThicknessTexture=o}e.extensions=e.extensions||{},e.extensions[this.name]=s,i[this.name]=!0}}class V_{constructor(t){this.writer=t,this.name="KHR_materials_transmission"}async writeMaterialAsync(t,e){if(!t.isMeshPhysicalMaterial||t.transmission===0)return;const r=this.writer,i=r.extensionsUsed,s={};if(s.transmissionFactor=t.transmission,t.transmissionMap){const o={index:await r.processTextureAsync(t.transmissionMap),texCoord:t.transmissionMap.channel};r.applyTextureTransform(o,t.transmissionMap),s.transmissionTexture=o}e.extensions=e.extensions||{},e.extensions[this.name]=s,i[this.name]=!0}}class q_{constructor(t){this.writer=t,this.name="KHR_materials_volume"}async writeMaterialAsync(t,e){if(!t.isMeshPhysicalMaterial||t.transmission===0)return;const r=this.writer,i=r.extensionsUsed,s={};if(s.thicknessFactor=t.thickness,t.thicknessMap){const o={index:await r.processTextureAsync(t.thicknessMap),texCoord:t.thicknessMap.channel};r.applyTextureTransform(o,t.thicknessMap),s.thicknessTexture=o}t.attenuationDistance!==1/0&&(s.attenuationDistance=t.attenuationDistance),s.attenuationColor=t.attenuationColor.toArray(),e.extensions=e.extensions||{},e.extensions[this.name]=s,i[this.name]=!0}}class Y_{constructor(t){this.writer=t,this.name="KHR_materials_ior"}async writeMaterialAsync(t,e){if(!t.isMeshPhysicalMaterial||t.ior===1.5)return;const i=this.writer.extensionsUsed,s={};s.ior=t.ior,e.extensions=e.extensions||{},e.extensions[this.name]=s,i[this.name]=!0}}class j_{constructor(t){this.writer=t,this.name="KHR_materials_specular"}async writeMaterialAsync(t,e){if(!t.isMeshPhysicalMaterial||t.specularIntensity===1&&t.specularColor.equals(C_)&&!t.specularIntensityMap&&!t.specularColorMap)return;const r=this.writer,i=r.extensionsUsed,s={};if(t.specularIntensityMap){const o={index:await r.processTextureAsync(t.specularIntensityMap),texCoord:t.specularIntensityMap.channel};r.applyTextureTransform(o,t.specularIntensityMap),s.specularTexture=o}if(t.specularColorMap){const o={index:await r.processTextureAsync(t.specularColorMap),texCoord:t.specularColorMap.channel};r.applyTextureTransform(o,t.specularColorMap),s.specularColorTexture=o}s.specularFactor=t.specularIntensity,s.specularColorFactor=t.specularColor.toArray(),e.extensions=e.extensions||{},e.extensions[this.name]=s,i[this.name]=!0}}class X_{constructor(t){this.writer=t,this.name="KHR_materials_sheen"}async writeMaterialAsync(t,e){if(!t.isMeshPhysicalMaterial||t.sheen==0)return;const r=this.writer,i=r.extensionsUsed,s={};if(t.sheenRoughnessMap){const o={index:await r.processTextureAsync(t.sheenRoughnessMap),texCoord:t.sheenRoughnessMap.channel};r.applyTextureTransform(o,t.sheenRoughnessMap),s.sheenRoughnessTexture=o}if(t.sheenColorMap){const o={index:await r.processTextureAsync(t.sheenColorMap),texCoord:t.sheenColorMap.channel};r.applyTextureTransform(o,t.sheenColorMap),s.sheenColorTexture=o}s.sheenRoughnessFactor=t.sheenRoughness,s.sheenColorFactor=t.sheenColor.toArray(),e.extensions=e.extensions||{},e.extensions[this.name]=s,i[this.name]=!0}}class J_{constructor(t){this.writer=t,this.name="KHR_materials_anisotropy"}async writeMaterialAsync(t,e){if(!t.isMeshPhysicalMaterial||t.anisotropy==0)return;const r=this.writer,i=r.extensionsUsed,s={};if(t.anisotropyMap){const o={index:await r.processTextureAsync(t.anisotropyMap)};r.applyTextureTransform(o,t.anisotropyMap),s.anisotropyTexture=o}s.anisotropyStrength=t.anisotropy,s.anisotropyRotation=t.anisotropyRotation,e.extensions=e.extensions||{},e.extensions[this.name]=s,i[this.name]=!0}}class $_{constructor(t){this.writer=t,this.name="KHR_materials_emissive_strength"}async writeMaterialAsync(t,e){if(!t.isMeshStandardMaterial||t.emissiveIntensity===1)return;const i=this.writer.extensionsUsed,s={};s.emissiveStrength=t.emissiveIntensity,e.extensions=e.extensions||{},e.extensions[this.name]=s,i[this.name]=!0}}class K_{constructor(t){this.writer=t,this.name="EXT_materials_bump"}async writeMaterialAsync(t,e){if(!t.isMeshStandardMaterial||t.bumpScale===1&&!t.bumpMap)return;const r=this.writer,i=r.extensionsUsed,s={};if(t.bumpMap){const o={index:await r.processTextureAsync(t.bumpMap),texCoord:t.bumpMap.channel};r.applyTextureTransform(o,t.bumpMap),s.bumpTexture=o}s.bumpFactor=t.bumpScale,e.extensions=e.extensions||{},e.extensions[this.name]=s,i[this.name]=!0}}class Q_{constructor(t){this.writer=t,this.name="EXT_mesh_gpu_instancing"}writeNode(t,e){if(!t.isInstancedMesh)return;const r=this.writer,i=t,s=new Float32Array(i.count*3),o=new Float32Array(i.count*4),l=new Float32Array(i.count*3),u=new qe,f=new ut,d=new rs,p=new ut;for(let m=0;m<i.count;m++)i.getMatrixAt(m,u),u.decompose(f,d,p),f.toArray(s,m*3),d.toArray(o,m*4),p.toArray(l,m*3);const g={TRANSLATION:r.processAccessor(new Ne(s,3)),ROTATION:r.processAccessor(new Ne(o,4)),SCALE:r.processAccessor(new Ne(l,3))};i.instanceColor&&(g._COLOR_0=r.processAccessor(i.instanceColor)),e.extensions=e.extensions||{},e.extensions[this.name]={attributes:g},r.extensionsUsed[this.name]=!0,r.extensionsRequired[this.name]=!0}}Pa.Utils={insertKeyframe:function(h,t){const r=h.getValueSize(),i=new h.TimeBufferType(h.times.length+1),s=new h.ValueBufferType(h.values.length+r),o=h.createInterpolant(new h.ValueBufferType(r));let l;if(h.times.length===0){i[0]=t;for(let u=0;u<r;u++)s[u]=0;l=0}else if(t<h.times[0]){if(Math.abs(h.times[0]-t)<.001)return 0;i[0]=t,i.set(h.times,1),s.set(o.evaluate(t),0),s.set(h.values,r),l=0}else if(t>h.times[h.times.length-1]){if(Math.abs(h.times[h.times.length-1]-t)<.001)return h.times.length-1;i[i.length-1]=t,i.set(h.times,0),s.set(h.values,0),s.set(o.evaluate(t),h.values.length),l=i.length-1}else for(let u=0;u<h.times.length;u++){if(Math.abs(h.times[u]-t)<.001)return u;if(h.times[u]<t&&h.times[u+1]>t){i.set(h.times.slice(0,u+1),0),i[u+1]=t,i.set(h.times.slice(u+1),u+2),s.set(h.values.slice(0,(u+1)*r),0),s.set(o.evaluate(t),(u+1)*r),s.set(h.values.slice((u+1)*r),(u+2)*r),l=u+1;break}}return h.times=i,h.values=s,l},mergeMorphTargetTracks:function(h,t){const e=[],r={},i=h.tracks;for(let s=0;s<i.length;++s){let o=i[s];const l=Xt.parseTrackName(o.name),u=Xt.findNode(t,l.nodeName);if(l.propertyName!=="morphTargetInfluences"||l.propertyIndex===void 0){e.push(o);continue}if(o.createInterpolant!==o.InterpolantFactoryMethodDiscrete&&o.createInterpolant!==o.InterpolantFactoryMethodLinear){if(o.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline)throw new Error("THREE.GLTFExporter: Cannot merge tracks with glTF CUBICSPLINE interpolation.");console.warn("THREE.GLTFExporter: Morph target interpolation mode not yet supported. Using LINEAR instead."),o=o.clone(),o.setInterpolation(sm)}const f=u.morphTargetInfluences.length,d=u.morphTargetDictionary[l.propertyIndex];if(d===void 0)throw new Error("THREE.GLTFExporter: Morph target name not found: "+l.propertyIndex);let p;if(r[u.uuid]===void 0){p=o.clone();const m=new p.ValueBufferType(f*p.times.length);for(let x=0;x<p.times.length;x++)m[x*f+d]=p.values[x];p.name=(l.nodeName||"")+".morphTargetInfluences",p.values=m,r[u.uuid]=p,e.push(p);continue}const g=o.createInterpolant(new o.ValueBufferType(1));p=r[u.uuid];for(let m=0;m<p.times.length;m++)p.values[m*f+d]=g.evaluate(p.times[m]);for(let m=0;m<o.times.length;m++){const x=this.insertKeyframe(p,o.times[m]);p.values[x*f+d]=o.values[m]}}return h.tracks=e,h},toFloat32BufferAttribute:function(h){const t=new Ne(new Float32Array(h.count*h.itemSize),h.itemSize,!1);if(!h.normalized&&!h.isInterleavedBufferAttribute)return t.array.set(h.array),t;for(let e=0,r=h.count;e<r;e++)for(let i=0;i<h.itemSize;i++)t.setComponent(e,i,h.getComponent(e,i));return t}};function tg(h,t=!1){const e=h[0].index!==null,r=new Set(Object.keys(h[0].attributes)),i=new Set(Object.keys(h[0].morphAttributes)),s={},o={},l=h[0].morphTargetsRelative,u=new ss;let f=0;for(let d=0;d<h.length;++d){const p=h[d];let g=0;if(e!==(p.index!==null))return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+d+". All geometries must have compatible attributes; make sure index attribute exists among all geometries, or in none of them."),null;for(const m in p.attributes){if(!r.has(m))return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+d+'. All geometries must have compatible attributes; make sure "'+m+'" attribute exists among all geometries, or in none of them.'),null;s[m]===void 0&&(s[m]=[]),s[m].push(p.attributes[m]),g++}if(g!==r.size)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+d+". Make sure all geometries have the same number of attributes."),null;if(l!==p.morphTargetsRelative)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+d+". .morphTargetsRelative must be consistent throughout all geometries."),null;for(const m in p.morphAttributes){if(!i.has(m))return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+d+".  .morphAttributes must be consistent throughout all geometries."),null;o[m]===void 0&&(o[m]=[]),o[m].push(p.morphAttributes[m])}if(t){let m;if(e)m=p.index.count;else if(p.attributes.position!==void 0)m=p.attributes.position.count;else return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed with geometry at index "+d+". The geometry must have either an index or a position attribute"),null;u.addGroup(f,m,d),f+=m}}if(e){let d=0;const p=[];for(let g=0;g<h.length;++g){const m=h[g].index;for(let x=0;x<m.count;++x)p.push(m.getX(x)+d);d+=h[g].attributes.position.count}u.setIndex(p)}for(const d in s){const p=nc(s[d]);if(!p)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed while trying to merge the "+d+" attribute."),null;u.setAttribute(d,p)}for(const d in o){const p=o[d][0].length;if(p===0)break;u.morphAttributes=u.morphAttributes||{},u.morphAttributes[d]=[];for(let g=0;g<p;++g){const m=[];for(let y=0;y<o[d].length;++y)m.push(o[d][y][g]);const x=nc(m);if(!x)return console.error("THREE.BufferGeometryUtils: .mergeGeometries() failed while trying to merge the "+d+" morphAttribute."),null;u.morphAttributes[d].push(x)}}return u}function nc(h){let t,e,r,i=-1,s=0;for(let f=0;f<h.length;++f){const d=h[f];if(t===void 0&&(t=d.array.constructor),t!==d.array.constructor)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.array must be of consistent array types across matching attributes."),null;if(e===void 0&&(e=d.itemSize),e!==d.itemSize)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.itemSize must be consistent across matching attributes."),null;if(r===void 0&&(r=d.normalized),r!==d.normalized)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.normalized must be consistent across matching attributes."),null;if(i===-1&&(i=d.gpuType),i!==d.gpuType)return console.error("THREE.BufferGeometryUtils: .mergeAttributes() failed. BufferAttribute.gpuType must be consistent across matching attributes."),null;s+=d.count*e}const o=new t(s),l=new Ne(o,e,r);let u=0;for(let f=0;f<h.length;++f){const d=h[f];if(d.isInterleavedBufferAttribute){const p=u/e;for(let g=0,m=d.count;g<m;g++)for(let x=0;x<e;x++){const y=d.getComponent(g,x);l.setComponent(g+p,x,y)}}else o.set(d.array,u);u+=d.count*e}return i!==void 0&&(l.gpuType=i),l}var eg=lr('<p class="svelte-1tmczmq">Draw a shape on the map.</p>'),ig=lr('<p class="svelte-1tmczmq">The selected area is too large. Please reduce the area.</p>'),ng=lr('<div class="svelte-1tmczmq"><!> <!> <button class="svelte-1tmczmq">Fetch Data</button> <button class="svelte-1tmczmq">Clip Data</button> <button class="svelte-1tmczmq">Download Data</button></div>');function rg(h,t){Da(t,!1);const e=Dc(),r=()=>tu(Ea,"$clippedGeoJSON",e),i=()=>tu(pa,"$osmGeoJSON",e);let s=Ws(t,"area",8),o=Ws(t,"latlngs",8),l=Ws(t,"selectedLayer",8),u,f,d;const p=8e6;let g=Xr(!1);const m=C=>{const U=L.latLngBounds(C);return[U.getSouthWest(),U.getNorthEast()]},x=async()=>{if(o()){if(o().center&&o().radius){const C=o().center,U=o().radius/111320;f={lat:C.lat-U,lng:C.lng-U},d={lat:C.lat+U,lng:C.lng+U}}else if(Array.isArray(o()))[f,d]=m(o());else return;try{const C="https://overpass-api.de/api/interpreter",U=`
            [out:json];
            (
                way["building"](${f.lat},${f.lng},${d.lat},${d.lng});
                relation["building"](${f.lat},${f.lng},${d.lat},${d.lng});
            );
            out body;
            >;
            out skel qt;
        `,H=await fetch(C,{method:"POST",body:U,headers:{"Content-Type":"application/x-www-form-urlencoded"}});if(!H.ok)return;const W=await H.json(),V=yp(W);pa.set(V)}catch(C){console.error("Error fetching data:",C)}}},y=()=>{let C;if(pa.subscribe(U=>{C=U})(),!(!C||!o()))try{if(o().center&&o().radius){const W=[o().center.lng,o().center.lat],V=o().radius/1e3;u=uu(W,V,{steps:64})}else{const W=[...o()];o().length>0&&(o()[0].lat!==o()[o().length-1].lat||o()[0].lng!==o()[o().length-1].lng)&&W.push(o()[0]),u=Na([W.map(V=>[V.lng,V.lat])])}const U=C.features.map(W=>{const V=W.geometry;if(!V||!V.coordinates||V.type!=="Polygon"&&V.type!=="MultiPolygon")return null;const et=vp(V.type,V.coordinates),Y=wp([ur(et),u]);try{const Q=Xp(Y);if(Q&&Q.geometry)return{...W,geometry:Q.geometry}}catch(Q){console.warn("Error clipping feature:",W,"Error:",Q)}return null}).filter(Boolean);if(U.length===0)return;const H={type:"FeatureCollection",features:U};Ea.set(H)}catch(U){console.error("Error during clipping:",U)}},b=async()=>{const C=r();if(C)try{const U=new up;U.file("buildings.geojson",JSON.stringify(C,null,2));const H=await P();if(H){const ct=await new Promise(rt=>H.toBlob(rt,"image/png"));U.file("map.png",ct)}const V={bbox:[f.lng,f.lat,d.lng,d.lat],clipPath:o(),referencePoint:lh(r()).geometry.coordinates},et=JSON.stringify(V,null,2);navigator.clipboard.writeText(`${lh(r()).geometry.coordinates}`),U.file("config.json",JSON.stringify(V,null,2));try{const ct=lh(C).geometry.coordinates,rt=A(C,ct),mt=new el,St=new Ju({color:10066329}),kt=new Wu(rt,St);mt.add(kt);let It;if(o().center&&o().radius){const $=[o().center.lng,o().center.lat],Z=o().radius;It=uu($,Z/1e3,{steps:64}).geometry.coordinates[0].map(X=>K(X,ct))}else if(Array.isArray(o()))It=o().map($=>{const Z=[$.lng,$.lat];return K(Z,ct)});else{console.error("Invalid latlngs format");return}const wt=new Aa(It.map($=>new Pt($.x,$.y))),vt=new Tl(wt),ht=new Ju({color:14540253,side:jc}),ft=new Wu(vt,ht);ft.rotation.x=-Math.PI/2,ft.rotation.z=Math.PI,ft.position.y=-.01,mt.add(ft);const M=new Pa,tt=await new Promise(($,Z)=>{M.parse(mt,B=>$(new Blob([JSON.stringify(B)],{type:"application/json"})),Z)});U.file("scene.gltf",tt)}catch(ct){console.error("Error generating 3D model:",ct)}const Y=await U.generateAsync({type:"blob"}),Q=URL.createObjectURL(Y),pt=document.createElement("a");pt.href=Q,pt.download="vantage-scene-setup.zip",pt.click(),URL.revokeObjectURL(Q)}catch(U){console.error("Error during download:",U)}},P=async()=>{if(!o()||!l())return null;const C=256,U=17,H=(Z,B,X)=>{const ot=Math.pow(2,X),lt=Math.floor((B+180)/360*ot),it=Math.floor((1-Math.log(Math.tan(Z*Math.PI/180)+1/Math.cos(Z*Math.PI/180))/Math.PI)/2*ot);return{x:lt,y:it}},W=H(f.lat,f.lng,U),V=H(d.lat,d.lng,U),et={x:Math.min(W.x,V.x),y:Math.min(W.y,V.y)},Y={x:Math.max(W.x,V.x),y:Math.max(W.y,V.y)},Q=Y.x-et.x+1,pt=Y.y-et.y+1,ct=document.createElement("canvas"),rt=ct.getContext("2d");ct.width=Q*C,ct.height=pt*C;const mt=[];for(let Z=et.x;Z<=Y.x;Z++)for(let B=et.y;B<=Y.y;B++){const X=l().value.replace("{z}",U).replace("{x}",Z).replace("{y}",B);mt.push({url:X,x:Z-et.x,y:B-et.y})}(await Promise.all(mt.map(Z=>fetch(Z.url).then(B=>{if(!B.ok)throw new Error(`Failed to fetch tile: ${Z.url}`);return B.blob()}).then(B=>createImageBitmap(B)).then(B=>({img:B,x:Z.x,y:Z.y}))))).forEach(({img:Z,x:B,y:X})=>{const ot=B*C,lt=X*C;rt.drawImage(Z,ot,lt,C,C)});const kt=(Z,B,X)=>{const ot=Math.pow(2,X)*C,lt=(B+180)/360*ot,it=(1-Math.log(Math.tan(Z*Math.PI/180)+1/Math.cos(Z*Math.PI/180))/Math.PI)/2*ot;return{x:lt,y:it}},It=kt(d.lat,f.lng,U),wt=kt(f.lat,d.lng,U),vt=It.x-et.x*C,ht=It.y-et.y*C,ft=wt.x-It.x,M=wt.y-It.y,tt=document.createElement("canvas");return tt.width=ft,tt.height=M,tt.getContext("2d").drawImage(ct,vt,ht,ft,M,0,0,ft,M),tt},A=(C,U)=>{const H=C.features.filter(({properties:W})=>W.building).flatMap(W=>{const V=W.geometry.coordinates;return V?W.geometry.type==="Polygon"?N(V,U,W.properties):W.geometry.type==="MultiPolygon"?V.flatMap(et=>N(et,U,W.properties)):(console.warn("Unsupported geometry type:",W.geometry.type),null):null}).filter(Boolean);return tg(H)},N=(C,U,H)=>{const W=z(C[0],U);if(!W)return null;W.holes=C.slice(1).map(et=>z(et,U));const V=new El(W,{curveSegments:1,depth:G(H),bevelEnabled:!1});return V.rotateX(Math.PI/2),V.rotateZ(Math.PI),V},G=C=>C["building:height"]??C.height??(C["building:levels"]?C["building:levels"]*4:4),z=(C,U)=>{try{return new Aa(C.map(H=>K(H,U)))}catch(H){return console.error("Error generating shape from coordinates:",C,H),null}},K=(C,U,H=!0)=>{if(!Array.isArray(C)||C.length!==2)throw new Error("Invalid coordinate format. Expected [longitude, latitude].");const W=Yp(C,U)*1e3,V=Sp(C,U)*Math.PI/180,et=W*Math.cos(V)*(H?-1:1),Y=W*Math.sin(V);return new Pt(et,Y)};ca(()=>_l(s()),()=>{s()&&le(g,s()<=p)}),bc(),gl();var q=ng(),T=ya(q);{var k=C=>{var U=eg();rr(C,U)};Jl(T,C=>{s()||C(k)})}var I=kn(T,2);{var F=C=>{var U=ig();rr(C,U)};Jl(I,C=>{s()&&!Bt(g)&&C(F)})}var S=kn(I,2),O=kn(S,2),v=kn(O,2);Lc(()=>{S.disabled=!s(),O.disabled=!i(),v.disabled=!r()}),da("click",S,x),da("click",O,y),da("click",v,b),rr(h,q),Ba()}var sg=lr("<div><h1>Vantage Scene Setup</h1> <p>Export the relevant data to setup Vantage.</p> <!> <!> <!></div>");function og(h){Dc();let t=Xr(null),e=Xr(),r=Xr([]);const i=p=>{le(e,p.detail.layer)},s=p=>{const g=p.detail.layer;if(g instanceof L.Circle){const m=g.getLatLng(),x=g.getRadius();le(t,Math.PI*Math.pow(x,2)),le(r,{center:m,radius:x})}else le(t,L.GeometryUtil.geodesicArea(g._latlngs[0])),le(r,g._latlngs[0])},o=p=>{le(t,p.detail.area),le(r,p.detail.latlngs),Yd(Ea,Bt(r))};var l=sg(),u=kn(ya(l),4);ep(u,{get selectedLayer(){return Bt(e)},set selectedLayer(p){le(e,p)},$$events:{change:i},$$legacy:!0});var f=kn(u,2);ap(f,{get selectedLayer(){return Bt(e)},$$events:{shapeDrawn:s,shapeEdited:o}});var d=kn(f,2);rg(d,{get area(){return Bt(t)},get latlngs(){return Bt(r)},get selectedLayer(){return Bt(e)}}),rr(h,l)}Od(og,{target:document.getElementById("app")});
